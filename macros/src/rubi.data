(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.1 (a+b x)^m.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.1 (a+b x)^m *)
Int[1/x_, x_Symbol] := Log[x]
Int[x_^m_., x_Symbol] := x^(m + 1)/(m + 1) /; FreeQ[m, x] && NeQ[m, -1]
Int[1/(a_ + b_.*x_), x_Symbol] := Log[RemoveContent[a + b*x, x]]/b /; FreeQ[{a, b}, x]
Int[(a_. + b_.*x_)^m_, x_Symbol] := (a + b*x)^(m + 1)/(b*(m + 1)) /; FreeQ[{a, b, m}, x] && NeQ[m, -1]
Int[(a_. + b_.*u_)^m_, x_Symbol] := 1/Coefficient[u, x, 1]*Subst[Int[(a + b*x)^m, x], x, u] /; FreeQ[{a, b, m}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.2 (a+b x)^m (c+d x)^n.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.2 (a+b x)^m (c+d x)^n *)
Int[(a_ + b_.*x_)^m_.*(c_ + d_.*x_), x_Symbol] := d*x*(a + b*x)^(m + 1)/(b*(m + 2)) /; FreeQ[{a, b, c, d, m}, x] && EqQ[a*d - b*c*(m + 2), 0]
Int[1/((a_ + b_.*x_)*(c_ + d_.*x_)), x_Symbol] := Int[1/(a*c + b*d*x^2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0]
Int[1/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := b/(b*c - a*d)*Int[1/(a + b*x), x] - d/(b*c - a*d)*Int[1/(c + d*x), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^(n + 1)/((b*c - a*d)*(m + 1)) /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n + 2, 0] && NeQ[m, -1]
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^m_, x_Symbol] := x*(a + b*x)^m*(c + d*x)^m/(2*m + 1) + 2*a*c*m/(2*m + 1)*Int[(a + b*x)^(m - 1)*(c + d*x)^(m - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && IGtQ[m + 1/2, 0]
Int[1/((a_ + b_.*x_)^(3/2)*(c_ + d_.*x_)^(3/2)), x_Symbol] := x/(a*c*Sqrt[a + b*x]*Sqrt[c + d*x]) /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0]
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^m_, x_Symbol] := -x*(a + b*x)^(m + 1)*(c + d*x)^(m + 1)/(2*a*c*(m + 1)) + (2*m + 3)/(2*a*c*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^(m + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && ILtQ[m + 3/2, 0]
Int[(a_ + b_.*x_)^m_.*(c_ + d_.*x_)^m_., x_Symbol] := Int[(a*c + b*d*x^2)^m, x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b*c + a*d, 0] && (IntegerQ[m] || GtQ[a, 0] && GtQ[c, 0])
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^m_, x_Symbol] := (a + b*x)^ FracPart[m]*(c + d*x)^FracPart[m]/(a*c + b*d*x^2)^FracPart[m]* Int[(a*c + b*d*x^2)^m, x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b*c + a*d, 0] && Not[IntegerQ[2*m]]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^n/(b*(m + 1)) - d*n/(b*(m + 1))*Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1), x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && ILtQ[m, -1] && Not[IntegerQ[n]] && GtQ[n, 0]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^(n + 1)/((b*c - a*d)*(m + 1)) - d*(m + n + 2)/((b*c - a*d)*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && ILtQ[m, -1] && Not[IntegerQ[n]] && LtQ[n, 0]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n, x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[m, 0] && (Not[IntegerQ[n]] || EqQ[c, 0] && LeQ[7*m + 4*n + 4, 0] || LtQ[9*m + 5*(n + 1), 0] || GtQ[m + n + 2, 0])
Int[(a_ + b_.*x_)^m_*(c_. + d_.*x_)^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && ILtQ[m, 0] && IntegerQ[n] && Not[IGtQ[n, 0] && LtQ[m + n + 2, 0]]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^(n + 1)/((b*c - a*d)*(m + 1)) - d*Simplify[m + n + 2]/((b*c - a*d)*(m + 1))* Int[(a + b*x)^Simplify[m + 1]*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[b*c - a*d, 0] && ILtQ[Simplify[m + n + 2], 0] && NeQ[m, -1] && Not[ LtQ[m, -1] && LtQ[n, -1] && (EqQ[a, 0] || NeQ[c, 0] && LtQ[m - n, 0] && IntegerQ[n])] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]])
Int[1/((a_ + b_.*x_)^(9/4)*(c_ + d_.*x_)^(1/4)), x_Symbol] := -4/(5*b*(a + b*x)^(5/4)*(c + d*x)^(1/4)) - d/(5*b)*Int[1/((a + b*x)^(5/4)*(c + d*x)^(5/4)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && NegQ[a^2*b^2]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^n/(b*(m + 1)) - d*n/(b*(m + 1))*Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && GtQ[n, 0] && LtQ[m, -1] && Not[IntegerQ[n] && Not[IntegerQ[m]]] && Not[ ILeQ[m + n + 2, 0] && (FractionQ[m] || GeQ[2*n + m + 1, 0])] && IntLinearQ[a, b, c, d, m, n, x]
Int[1/((a_ + b_.*x_)^(5/4)*(c_ + d_.*x_)^(1/4)), x_Symbol] := -2/(b*(a + b*x)^(1/4)*(c + d*x)^(1/4)) + c*Int[1/((a + b*x)^(5/4)*(c + d*x)^(5/4)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && NegQ[a^2*b^2]
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^n/(b*(m + n + 1)) + 2*c*n/(m + n + 1)*Int[(a + b*x)^m*(c + d*x)^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && IGtQ[m + 1/2, 0] && IGtQ[n + 1/2, 0] && LtQ[m, n]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^n/(b*(m + n + 1)) + n*(b*c - a*d)/(b*(m + n + 1))* Int[(a + b*x)^m*(c + d*x)^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && GtQ[n, 0] && NeQ[m + n + 1, 0] && Not[ IGtQ[m, 0] && (Not[IntegerQ[n]] || GtQ[m, 0] && LtQ[m - n, 0])] && Not[ILtQ[m + n + 2, 0]] && IntLinearQ[a, b, c, d, m, n, x]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^(n + 1)/((b*c - a*d)*(m + 1)) - d*(m + n + 2)/((b*c - a*d)*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && Not[ LtQ[n, -1] && (EqQ[a, 0] || NeQ[c, 0] && LtQ[m - n, 0] && IntegerQ[n])] && IntLinearQ[a, b, c, d, m, n, x]
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]), x_Symbol] := ArcCosh[b*x/a]/b /; FreeQ[{a, b, c, d}, x] && EqQ[a + c, 0] && EqQ[b - d, 0] && GtQ[a, 0]
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_. + d_.*x_]), x_Symbol] := Int[1/Sqrt[a*c - b*(a - c)*x - b^2*x^2], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b + d, 0] && GtQ[a + c, 0]
Int[1/(Sqrt[a_. + b_.*x_]*Sqrt[c_. + d_.*x_]), x_Symbol] := 2/Sqrt[b]* Subst[Int[1/Sqrt[b*c - a*d + d*x^2], x], x, Sqrt[a + b*x]] /; FreeQ[{a, b, c, d}, x] && GtQ[b*c - a*d, 0] && GtQ[b, 0]
Int[1/((a_. + b_.*x_)*(c_. + d_.*x_)^(1/3)), x_Symbol] := With[{q = Rt[(b*c - a*d)/b, 3]}, -Log[RemoveContent[a + b*x, x]]/(2*b*q) - 3/(2*b*q)*Subst[Int[1/(q - x), x], x, (c + d*x)^(1/3)] + 3/(2*b)* Subst[Int[1/(q^2 + q*x + x^2), x], x, (c + d*x)^(1/3)]] /; FreeQ[{a, b, c, d}, x] && PosQ[(b*c - a*d)/b]
Int[1/((a_. + b_.*x_)*(c_. + d_.*x_)^(1/3)), x_Symbol] := With[{q = Rt[-(b*c - a*d)/b, 3]}, Log[RemoveContent[a + b*x, x]]/(2*b*q) - 3/(2*b*q)*Subst[Int[1/(q + x), x], x, (c + d*x)^(1/3)] + 3/(2*b)* Subst[Int[1/(q^2 - q*x + x^2), x], x, (c + d*x)^(1/3)]] /; FreeQ[{a, b, c, d}, x] && NegQ[(b*c - a*d)/b]
Int[1/((a_. + b_.*x_)*(c_. + d_.*x_)^(2/3)), x_Symbol] := With[{q = Rt[(b*c - a*d)/b, 3]}, -Log[RemoveContent[a + b*x, x]]/(2*b*q^2) - 3/(2*b*q^2)*Subst[Int[1/(q - x), x], x, (c + d*x)^(1/3)] - 3/(2*b*q)* Subst[Int[1/(q^2 + q*x + x^2), x], x, (c + d*x)^(1/3)]] /; FreeQ[{a, b, c, d}, x] && PosQ[(b*c - a*d)/b]
Int[1/((a_. + b_.*x_)*(c_. + d_.*x_)^(2/3)), x_Symbol] := With[{q = Rt[-(b*c - a*d)/b, 3]}, -Log[RemoveContent[a + b*x, x]]/(2*b*q^2) + 3/(2*b*q^2)*Subst[Int[1/(q + x), x], x, (c + d*x)^(1/3)] + 3/(2*b*q)* Subst[Int[1/(q^2 - q*x + x^2), x], x, (c + d*x)^(1/3)]] /; FreeQ[{a, b, c, d}, x] && NegQ[(b*c - a*d)/b]
Int[1/((a_. + b_.*x_)^(1/3)*(c_. + d_.*x_)^(2/3)), x_Symbol] := With[{q = Rt[d/b, 3]}, -Sqrt[3]*q/d* ArcTan[2*q*(a + b*x)^(1/3)/(Sqrt[3]*(c + d*x)^(1/3)) + 1/Sqrt[3]] - q/(2*d)*Log[c + d*x] - 3*q/(2*d)*Log[q*(a + b*x)^(1/3)/(c + d*x)^(1/3) - 1]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && PosQ[d/b]
Int[1/((a_. + b_.*x_)^(1/3)*(c_. + d_.*x_)^(2/3)), x_Symbol] := With[{q = Rt[-d/b, 3]}, Sqrt[3]*q/d* ArcTan[1/Sqrt[3] - 2*q*(a + b*x)^(1/3)/(Sqrt[3]*(c + d*x)^(1/3))] + q/(2*d)*Log[c + d*x] + 3*q/(2*d)*Log[q*(a + b*x)^(1/3)/(c + d*x)^(1/3) + 1]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && NegQ[d/b]
Int[(a_. + b_.*x_)^m_*(c_ + d_.*x_)^m_, x_Symbol] := (a + b*x)^m*(c + d*x)^m/(a*c + (b*c + a*d)*x + b*d*x^2)^m* Int[(a*c + (b*c + a*d)*x + b*d*x^2)^m, x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && LtQ[-1, m, 0] && LeQ[3, Denominator[m], 4] && AtomQ[b*c + a*d]
Int[(a_. + b_.*x_)^m_*(c_ + d_.*x_)^m_, x_Symbol] := (a + b*x)^m*(c + d*x)^m/((a + b*x)*(c + d*x))^m* Int[(a*c + (b*c + a*d)*x + b*d*x^2)^m, x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && LtQ[-1, m, 0] && LeQ[3, Denominator[m], 4]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := With[{p = Denominator[m]}, p/b* Subst[Int[x^(p*(m + 1) - 1)*(c - a*d/b + d*x^p/b)^n, x], x, (a + b*x)^(1/p)]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && LtQ[-1, m, 0] && LeQ[-1, n, 0] && LeQ[Denominator[n], Denominator[m]] && IntLinearQ[a, b, c, d, m, n, x]
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := c^n*(b*x)^(m + 1)/(b*(m + 1))* Hypergeometric2F1[-n, m + 1, m + 2, -d*x/c] /; FreeQ[{b, c, d, m, n}, x] && Not[IntegerQ[m]] && (IntegerQ[n] || GtQ[c, 0] && Not[EqQ[n, -1/2] && EqQ[c^2 - d^2, 0] && GtQ[-d/(b*c), 0]])
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := (c + d*x)^(n + 1)/(d*(n + 1)*(-d/(b*c))^m)* Hypergeometric2F1[-m, n + 1, n + 2, 1 + d*x/c] /; FreeQ[{b, c, d, m, n}, x] && Not[IntegerQ[n]] && (IntegerQ[m] || GtQ[-d/(b*c), 0])
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := c^IntPart[n]*(c + d*x)^FracPart[n]/(1 + d*x/c)^FracPart[n]* Int[(b*x)^m*(1 + d*x/c)^n, x] /; FreeQ[{b, c, d, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[GtQ[c, 0]] && Not[GtQ[-d/(b*c), 0]] && (RationalQ[m] && Not[EqQ[n, -1/2] && EqQ[c^2 - d^2, 0]] || Not[RationalQ[n]])
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := (-b*c/d)^IntPart[m]*(b*x)^FracPart[m]/(-d*x/c)^FracPart[m]* Int[(-d*x/c)^m*(c + d*x)^n, x] /; FreeQ[{b, c, d, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[GtQ[c, 0]] && Not[GtQ[-d/(b*c), 0]]
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := (b*c - a*d)^n*(a + b*x)^(m + 1)/(b^(n + 1)*(m + 1))* Hypergeometric2F1[-n, m + 1, m + 2, -d*(a + b*x)/(b*c - a*d)] /; FreeQ[{a, b, c, d, m}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[m]] && IntegerQ[n]
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := (a + b*x)^(m + 1)/(b*(m + 1)*(b/(b*c - a*d))^n)* Hypergeometric2F1[-n, m + 1, m + 2, -d*(a + b*x)/(b*c - a*d)] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[b/(b*c - a*d), 0] && (RationalQ[m] || Not[RationalQ[n] && GtQ[-d/(b*c - a*d), 0]])
Int[(a_ + b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := (c + d*x)^ FracPart[ n]/((b/(b*c - a*d))^IntPart[n]*(b*(c + d*x)/(b*c - a*d))^ FracPart[n])* Int[(a + b*x)^m*Simp[b*c/(b*c - a*d) + b*d*x/(b*c - a*d), x]^n, x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && (RationalQ[m] || Not[SimplerQ[n + 1, m + 1]])
Int[(a_. + b_.*u_)^m_.*(c_. + d_.*u_)^n_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x)^m*(c + d*x)^n, x], x, u] /; FreeQ[{a, b, c, d, m, n}, x] && LinearQ[u, x] && NeQ[Coefficient[u, x, 0], 0]
(* IntLinearQ[a,b,c,d,m,n,x] returns True iff (a+b*x)^m*(c+d*x)^n is  integrable wrt x in terms of non-hypergeometric functions. *) IntLinearQ[a_, b_, c_, d_, m_, n_, x_] := IGtQ[m, 0] || IGtQ[n, 0] || IntegersQ[3*m, 3*n] || IntegersQ[4*m, 4*n] || IntegersQ[2*m, 6*n] || IntegersQ[6*m, 2*n] || ILtQ[m + n, -1] || IntegerQ[m + n] && RationalQ[m]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.3 (a+b x)^m (c+d x)^n (e+f x)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.3 (a+b x)^m (c+d x)^n (e+f x)^p *)
Int[(a_ + b_.*x_)^m_.*(c_ + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[(a*c + b*d*x^2)^m*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[n, m] && IntegerQ[ m] && (NeQ[m, -1] || EqQ[e, 0] && (EqQ[p, 1] || Not[IntegerQ[p]]))
Int[(a_. + b_.*x_)*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d*f*(n + p + 2)) /; FreeQ[{a, b, c, d, e, f, n, p}, x] && NeQ[n + p + 2, 0] && EqQ[a*d*f*(n + p + 2) - b*(d*e*(n + 1) + c*f*(p + 1)), 0]
Int[(a_ + b_.*x_)*(d_.*x_)^n_.*(e_ + f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)*(d*x)^n*(e + f*x)^p, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && IGtQ[p, 0] && EqQ[b*e + a*f, 0] && Not[ILtQ[n + p + 2, 0] && GtQ[n + 2*p, 0]]
Int[(a_ + b_.*x_)*(d_.*x_)^n_.*(e_ + f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)*(d*x)^n*(e + f*x)^p, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && IGtQ[p, 0] && (NeQ[n, -1] || EqQ[p, 1]) && NeQ[b*e + a*f, 0] && (Not[IntegerQ[n]] || LtQ[9*p + 5*n, 0] || GeQ[n + p + 1, 0] || GeQ[n + p + 2, 0] && RationalQ[a, b, d, e, f]) && (NeQ[n + p + 3, 0] || EqQ[p, 1])
Int[(a_. + b_.*x_)*(c_ + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)*(c + d*x)^n*(e + f*x)^p, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && (ILtQ[n, 0] && ILtQ[p, 0] || EqQ[p, 1] || IGtQ[p, 0] && (Not[IntegerQ[n]] || LeQ[9*p + 5*(n + 2), 0] || GeQ[n + p + 1, 0] || GeQ[n + p + 2, 0] && RationalQ[a, b, c, d, e, f]))
Int[(a_. + b_.*x_)*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := -(b*e - a*f)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(f*(p + 1)*(c*f - d*e)) - (a*d*f*(n + p + 2) - b*(d*e*(n + 1) + c*f*(p + 1)))/(f*(p + 1)*(c*f - d*e))* Int[(c + d*x)^n*(e + f*x)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && LtQ[p, -1] && (Not[LtQ[n, -1]] || IntegerQ[p] || Not[IntegerQ[n] || Not[EqQ[e, 0] || Not[EqQ[c, 0] || LtQ[p, n]]]])
Int[(a_. + b_.*x_)*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := -(b*e - a*f)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(f*(p + 1)*(c*f - d*e)) - (a*d*f*(n + p + 2) - b*(d*e*(n + 1) + c*f*(p + 1)))/(f*(p + 1)*(c*f - d*e))* Int[(c + d*x)^n*(e + f*x)^Simplify[p + 1], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && Not[RationalQ[p]] && SumSimplerQ[p, 1]
Int[(a_. + b_.*x_)*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d*f*(n + p + 2)) + (a*d*f*(n + p + 2) - b*(d*e*(n + 1) + c*f*(p + 1)))/(d* f*(n + p + 2))*Int[(c + d*x)^n*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && NeQ[n + p + 2, 0]
Int[(a_. + b_.*x_)^2*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)*(2*a*d*f*(n + p + 3) - b*(d*e*(n + 2) + c*f*(p + 2)) + b*d*f*(n + p + 2)*x)/(d^2* f^2*(n + p + 2)*(n + p + 3)) /; FreeQ[{a, b, c, d, e, f, n, p}, x] && NeQ[n + p + 2, 0] && NeQ[n + p + 3, 0] && EqQ[ d*f*(n + p + 2)*(a^2*d*f*(n + p + 3) - b*(b*c*e + a*(d*e*(n + 1) + c*f*(p + 1)))) - b*(d*e*(n + 1) + c*f*(p + 1))*(a*d*f*(n + p + 4) - b*(d*e*(n + 2) + c*f*(p + 2))), 0]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(f_.*x_)^p_., x_Symbol] := a*Int[(a + b*x)^n*(c + d*x)^n*(f*x)^p, x] + b/f*Int[(a + b*x)^n*(c + d*x)^n*(f*x)^(p + 1), x] /; FreeQ[{a, b, c, d, f, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[m - n - 1, 0] && Not[RationalQ[p]] && Not[IGtQ[m, 0]] && NeQ[m + n + p + 2, 0]
Int[(e_. + f_.*x_)^p_./((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := Int[ExpandIntegrand[(e + f*x)^p/((a + b*x)*(c + d*x)), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IntegerQ[p]
Int[(e_. + f_.*x_)^p_/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := (b*e - a*f)/(b*c - a*d)*Int[(e + f*x)^(p - 1)/(a + b*x), x] - (d*e - c*f)/(b*c - a*d)*Int[(e + f*x)^(p - 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && LtQ[0, p, 1]
Int[(e_. + f_.*x_)^p_/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := f*(e + f*x)^(p - 1)/(b*d*(p - 1)) + 1/(b*d)* Int[(b*d*e^2 - a*c*f^2 + f*(2*b*d*e - b*c*f - a*d*f)* x)*(e + f*x)^(p - 2)/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 1]
Int[(e_. + f_.*x_)^p_/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := f*(e + f*x)^(p + 1)/((p + 1)*(b*e - a*f)*(d*e - c*f)) + 1/((b*e - a*f)*(d*e - c*f))* Int[(b*d*e - b*c*f - a*d*f - b*d*f*x)*(e + f*x)^(p + 1)/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && LtQ[p, -1]
Int[(e_. + f_.*x_)^p_/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := b/(b*c - a*d)*Int[(e + f*x)^p/(a + b*x), x] - d/(b*c - a*d)*Int[(e + f*x)^p/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && Not[IntegerQ[p]]
Int[(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_/(a_. + b_.*x_), x_Symbol] := Int[ExpandIntegrand[(e + f*x)^ FractionalPart[p], (c + d*x)^ n*(e + f*x)^IntegerPart[p]/(a + b*x), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 0] && LtQ[p, -1] && FractionQ[p]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && IntegersQ[m, n] && (IntegerQ[p] || GtQ[m, 0] && GeQ[n, -1])
Int[(a_. + b_.*x_)^2*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := (b*c - a*d)^2*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d^2*(d*e - c*f)*(n + 1)) - 1/(d^2*(d*e - c*f)*(n + 1))*Int[(c + d*x)^(n + 1)*(e + f*x)^p* Simp[a^2*d^2*f*(n + p + 2) + b^2*c*(d*e*(n + 1) + c*f*(p + 1)) - 2*a*b*d*(d*e*(n + 1) + c*f*(p + 1)) - b^2*d*(d*e - c*f)*(n + 1)*x, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && (LtQ[n, -1] || EqQ[n + p + 3, 0] && NeQ[n, -1] && (SumSimplerQ[n, 1] || Not[SumSimplerQ[p, 1]]))
Int[(a_. + b_.*x_)^2*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d*f*(n + p + 3)) + 1/(d*f*(n + p + 3))*Int[(c + d*x)^n*(e + f*x)^p* Simp[a^2*d*f*(n + p + 3) - b*(b*c*e + a*(d*e*(n + 1) + c*f*(p + 1))) + b*(a*d*f*(n + p + 4) - b*(d*e*(n + 2) + c*f*(p + 2)))*x, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && NeQ[n + p + 3, 0]
Int[1/((a_. + b_.*x_)^(1/3)*(c_. + d_.*x_)^(2/3)*(e_. + f_.*x_)), x_Symbol] := With[{q = Rt[(d*e - c*f)/(b*e - a*f), 3]}, -Sqrt[3]*q* ArcTan[1/Sqrt[3] + 2*q*(a + b*x)^(1/3)/(Sqrt[3]*(c + d*x)^(1/3))]/(d*e - c*f) + q*Log[e + f*x]/(2*(d*e - c*f)) - 3*q*Log[q*(a + b*x)^(1/3) - (c + d*x)^(1/3)]/(2*(d*e - c*f))] /; FreeQ[{a, b, c, d, e, f}, x]
Int[1/(Sqrt[a_. + b_.*x_]*Sqrt[c_. + d_.*x_]*(e_. + f_.*x_)), x_Symbol] := b*f*Subst[Int[1/(d*(b*e - a*f)^2 + b*f^2*x^2), x], x, Sqrt[a + b*x]*Sqrt[c + d*x]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[2*b*d*e - f*(b*c + a*d), 0]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_/(e_. + f_.*x_), x_Symbol] := With[{q = Denominator[m]}, q*Subst[Int[x^(q*(m + 1) - 1)/(b*e - a*f - (d*e - c*f)*x^q), x], x, (a + b*x)^(1/q)/(c + d*x)^(1/q)]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[m + n + 1, 0] && RationalQ[n] && LtQ[-1, m, 0] && SimplerQ[a + b*x, c + d*x]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^(p + 1)/((m + 1)*(b*e - a*f)) - n*(d*e - c*f)/((m + 1)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1)*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[m + n + p + 2, 0] && GtQ[n, 0] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[p, 1]]) && NeQ[m, -1]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[Simplify[m + n + p + 3], 0] && EqQ[a*d*f*(m + 1) + b*c*f*(n + 1) + b*d*e*(p + 1), 0] && NeQ[m, -1]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + (a*d*f*(m + 1) + b*c*f*(n + 1) + b*d*e*(p + 1))/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[Simplify[m + n + p + 3], 0] && (LtQ[m, -1] || SumSimplerQ[m, 1])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p/(b*(m + 1)) - 1/(b*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1)*(e + f*x)^(p - 1)* Simp[d*e*n + c*f*p + d*f*(n + p)*x, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && LtQ[m, -1] && GtQ[n, 0] && GtQ[p, 0] && (IntegersQ[2*m, 2*n, 2*p] || IntegersQ[m, n + p] || IntegersQ[p, m + n])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := (b*c - a*d)*(a + b*x)^(m + 1)*(c + d*x)^(n - 1)*(e + f*x)^(p + 1)/(b*(b*e - a*f)*(m + 1)) + 1/(b*(b*e - a*f)*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 2)*(e + f*x)^p* Simp[a*d*(d*e*(n - 1) + c*f*(p + 1)) + b*c*(d*e*(m - n + 2) - c*f*(m + p + 2)) + d*(a*d*f*(n + p) + b*(d*e*(m + 1) - c*f*(m + n + p + 1)))*x, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && LtQ[m, -1] && GtQ[n, 1] && (IntegersQ[2*m, 2*n, 2*p] || IntegersQ[m, n + p] || IntegersQ[p, m + n])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^(p + 1)/((m + 1)*(b*e - a*f)) - 1/((m + 1)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1)*(e + f*x)^p* Simp[d*e*n + c*f*(m + p + 2) + d*f*(m + n + p + 2)*x, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && LtQ[m, -1] && GtQ[n, 0] && (IntegersQ[2*m, 2*n, 2*p] || IntegersQ[m, n + p] || IntegersQ[p, m + n])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m - 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d* f*(m + n + p + 1)) + 1/(d*f*(m + n + p + 1))* Int[(a + b*x)^(m - 2)*(c + d*x)^n*(e + f*x)^p* Simp[a^2*d*f*(m + n + p + 1) - b*(b*c*e*(m - 1) + a*(d*e*(n + 1) + c*f*(p + 1))) + b*(a*d*f*(2*m + n + p) - b*(d*e*(m + n) + c*f*(m + p)))*x, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && GtQ[m, 1] && NeQ[m + n + p + 1, 0] && IntegerQ[m]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := (a + b*x)^m*(c + d*x)^n*(e + f*x)^(p + 1)/(f*(m + n + p + 1)) - 1/(f*(m + n + p + 1))* Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1)*(e + f*x)^p* Simp[c*m*(b*e - a*f) + a*n*(d*e - c*f) + (d*m*(b*e - a*f) + b*n*(d*e - c*f))*x, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && GtQ[m, 0] && GtQ[n, 0] && NeQ[m + n + p + 1, 0] && (IntegersQ[2*m, 2*n, 2*p] || (IntegersQ[m, n + p] || IntegersQ[p, m + n]))
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m - 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d* f*(m + n + p + 1)) + 1/(d*f*(m + n + p + 1))* Int[(a + b*x)^(m - 2)*(c + d*x)^n*(e + f*x)^p* Simp[a^2*d*f*(m + n + p + 1) - b*(b*c*e*(m - 1) + a*(d*e*(n + 1) + c*f*(p + 1))) + b*(a*d*f*(2*m + n + p) - b*(d*e*(m + n) + c*f*(m + p)))*x, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && GtQ[m, 1] && NeQ[m + n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* Simp[a*d*f*(m + 1) - b*(d*e*(m + n + 2) + c*f*(m + p + 2)) - b*d*f*(m + n + p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && ILtQ[m, -1] && (IntegerQ[n] || IntegersQ[2*n, 2*p] || ILtQ[m + n + p + 3, 0])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* Simp[a*d*f*(m + 1) - b*(d*e*(m + n + 2) + c*f*(m + p + 2)) - b*d*f*(m + n + p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n, 2*p] 
Int[1/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]*(e_. + f_.*x_)^(1/4)), x_Symbol] := -4*Subst[ Int[x^2/((b*e - a*f - b*x^4)*Sqrt[c - d*e/f + d*x^4/f]), x], x, (e + f*x)^(1/4)] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[-f/(d*e - c*f), 0]
Int[1/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]*(e_. + f_.*x_)^(1/4)), x_Symbol] := Sqrt[-f*(c + d*x)/(d*e - c*f)]/Sqrt[c + d*x]* Int[1/((a + b*x)* Sqrt[-c*f/(d*e - c*f) - d*f*x/(d*e - c*f)]*(e + f*x)^(1/4)), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[-f/(d*e - c*f), 0]]
Int[1/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]*(e_. + f_.*x_)^(3/4)), x_Symbol] := -4*Subst[Int[1/((b*e - a*f - b*x^4)*Sqrt[c - d*e/f + d*x^4/f]), x], x, (e + f*x)^(1/4)] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[-f/(d*e - c*f), 0]
Int[1/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]*(e_. + f_.*x_)^(3/4)), x_Symbol] := Sqrt[-f*(c + d*x)/(d*e - c*f)]/Sqrt[c + d*x]* Int[1/((a + b*x)* Sqrt[-c*f/(d*e - c*f) - d*f*x/(d*e - c*f)]*(e + f*x)^(3/4)), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[-f/(d*e - c*f), 0]]
Int[Sqrt[e_ + f_.*x_]/(Sqrt[b_.*x_]*Sqrt[c_ + d_.*x_]), x_Symbol] := 2*Sqrt[e]/b*Rt[-b/d, 2]* EllipticE[ArcSin[Sqrt[b*x]/(Sqrt[c]*Rt[-b/d, 2])], c*f/(d*e)] /; FreeQ[{b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && GtQ[c, 0] && GtQ[e, 0] && Not[LtQ[-b/d, 0]]
Int[Sqrt[e_ + f_.*x_]/(Sqrt[b_.*x_]*Sqrt[c_ + d_.*x_]), x_Symbol] := Sqrt[-b*x]/Sqrt[b*x]* Int[Sqrt[e + f*x]/(Sqrt[-b*x]*Sqrt[c + d*x]), x] /; FreeQ[{b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && GtQ[c, 0] && GtQ[e, 0] && LtQ[-b/d, 0]
Int[Sqrt[e_ + f_.*x_]/(Sqrt[b_.*x_]*Sqrt[c_ + d_.*x_]), x_Symbol] := Sqrt[e + f*x]*Sqrt[1 + d*x/c]/(Sqrt[c + d*x]*Sqrt[1 + f*x/e])* Int[Sqrt[1 + f*x/e]/(Sqrt[b*x]*Sqrt[1 + d*x/c]), x] /; FreeQ[{b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && Not[GtQ[c, 0] && GtQ[e, 0]]
(* Int[Sqrt[e_.+f_.*x_]/(Sqrt[a_+b_.*x_]*Sqrt[c_+d_.*x_]),x_Symbol] := f/b*Int[Sqrt[a+b*x]/(Sqrt[c+d*x]*Sqrt[e+f*x]),x] - f/b*Int[1/(Sqrt[a+b*x]*Sqrt[c+d*x]*Sqrt[e+f*x]),x] /; FreeQ[{a,b,c,d,e,f},x] && EqQ[b*e-f*(a-1),0] *)
(* Int[Sqrt[e_.+f_.*x_]/(Sqrt[a_+b_.*x_]*Sqrt[c_+d_.*x_]),x_Symbol] := 2/b*Rt[-(b*c-a*d)/d,2]*Sqrt[(b*e-a*f)/(b*c-a*d)]* EllipticE[ArcSin[Sqrt[a+b*x]/Rt[-(b*c-a*d)/d,2]],f*(b*c-a*d)/(d*( b*e-a*f))] /; FreeQ[{a,b,c,d,e,f},x] && GtQ[b/(b*c-a*d),0] && GtQ[b/(b*e-a*f),0] &&  Not[LtQ[-(b*c-a*d)/d,0]] && Not[SimplerQ[c+d*x,a+b*x] && GtQ[-d/(b*c-a*d),0] &&  GtQ[d/(d*e-c*f),0] && Not[LtQ[(b*c-a*d)/b,0]]] *)
Int[Sqrt[e_. + f_.*x_]/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]), x_Symbol] := 2/b*Rt[-(b*e - a*f)/d, 2]* EllipticE[ArcSin[Sqrt[a + b*x]/Rt[-(b*c - a*d)/d, 2]], f*(b*c - a*d)/(d*(b*e - a*f))] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[b/(b*c - a*d), 0] && GtQ[b/(b*e - a*f), 0] && Not[LtQ[-(b*c - a*d)/d, 0]] && Not[ SimplerQ[c + d*x, a + b*x] && GtQ[-d/(b*c - a*d), 0] && GtQ[d/(d*e - c*f), 0] && Not[LtQ[(b*c - a*d)/b, 0]]]
Int[Sqrt[e_. + f_.*x_]/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]), x_Symbol] := Sqrt[e + f*x]* Sqrt[b*(c + d*x)/(b*c - a*d)]/(Sqrt[c + d*x]* Sqrt[b*(e + f*x)/(b*e - a*f)])* Int[ Sqrt[b*e/(b*e - a*f) + b*f*x/(b*e - a*f)]/(Sqrt[a + b*x]* Sqrt[b*c/(b*c - a*d) + b*d*x/(b*c - a*d)]), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[b/(b*c - a*d), 0] && GtQ[b/(b*e - a*f), 0]] && Not[LtQ[-(b*c - a*d)/d, 0]]
Int[1/(Sqrt[b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := 2/(b*Sqrt[e])*Rt[-b/d, 2]* EllipticF[ArcSin[Sqrt[b*x]/(Sqrt[c]*Rt[-b/d, 2])], c*f/(d*e)] /; FreeQ[{b, c, d, e, f}, x] && GtQ[c, 0] && GtQ[e, 0] && (GtQ[-b/d, 0] || LtQ[-b/f, 0])
Int[1/(Sqrt[b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := 2/(b*Sqrt[e])*Rt[-b/d, 2]* EllipticF[ArcSin[Sqrt[b*x]/(Sqrt[c]*Rt[-b/d, 2])], c*f/(d*e)] /; FreeQ[{b, c, d, e, f}, x] && GtQ[c, 0] && GtQ[e, 0] && (PosQ[-b/d] || NegQ[-b/f])
Int[1/(Sqrt[b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := Sqrt[1 + d*x/c]*Sqrt[1 + f*x/e]/(Sqrt[c + d*x]*Sqrt[e + f*x])* Int[1/(Sqrt[b*x]*Sqrt[1 + d*x/c]*Sqrt[1 + f*x/e]), x] /; FreeQ[{b, c, d, e, f}, x] && Not[GtQ[c, 0] && GtQ[e, 0]]
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := -2*Sqrt[d/f]/(d*Rt[-(b*e - a*f)/f, 2])* EllipticF[ArcSin[Rt[-(b*e - a*f)/f, 2]/Sqrt[a + b*x]], f*(b*c - a*d)/(d*(b*e - a*f))] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[d/b, 0] && GtQ[f/b, 0] && LeQ[c, a*d/b] && LeQ[e, a*f/b]
(* Int[1/(Sqrt[a_+b_.*x_]*Sqrt[c_+d_.*x_]*Sqrt[e_+f_.*x_]),x_Symbol] := -2*Sqrt[c+d*x]*Sqrt[b*(e+f*x)/(f*(a+b*x))]/(d*Rt[-(b*e-a*f)/f,2]* Sqrt[e+f*x]*Sqrt[b*(c+d*x)/(d*(a+b*x))])* EllipticF[ArcSin[Rt[-(b*e-a*f)/f,2]/Sqrt[a+b*x]],f*(b*c-a*d)/(d*( b*e-a*f))] /; FreeQ[{a,b,c,d,e,f},x] && PosQ[-(b*e-a*f)/f] && (*  (LtQ[-a/b,-c/d,-e/f] || GtQ[-a/b,-c/d,-e/f]) *) Not[SimplerQ[c+d*x,a+b*x] && (PosQ[(-d*e+c*f)/f] ||  PosQ[(b*e-a*f)/b])] && Not[SimplerQ[e+f*x,a+b*x] && (PosQ[(b*e-a*f)/b] ||  PosQ[(b*c-a*d)/b])] *)
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := 2*Rt[-b/d, 2]/(b*Sqrt[(b*e - a*f)/b])* EllipticF[ArcSin[Sqrt[a + b*x]/(Rt[-b/d, 2]*Sqrt[(b*c - a*d)/b])], f*(b*c - a*d)/(d*(b*e - a*f))] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[(b*c - a*d)/b, 0] && GtQ[(b*e - a*f)/b, 0] && PosQ[-b/d] && Not[ SimplerQ[c + d*x, a + b*x] && GtQ[(d*e - c*f)/d, 0] && GtQ[-d/b, 0]] && Not[ SimplerQ[c + d*x, a + b*x] && GtQ[(-b*e + a*f)/f, 0] && GtQ[-f/b, 0]] && Not[ SimplerQ[e + f*x, a + b*x] && GtQ[(-d*e + c*f)/f, 0] && GtQ[(-b*e + a*f)/f, 0] && (PosQ[-f/d] || PosQ[-f/b])]
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := 2*Rt[-b/d, 2]/(b*Sqrt[(b*e - a*f)/b])* EllipticF[ArcSin[Sqrt[a + b*x]/(Rt[-b/d, 2]*Sqrt[(b*c - a*d)/b])], f*(b*c - a*d)/(d*(b*e - a*f))] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[b/(b*c - a*d), 0] && GtQ[b/(b*e - a*f), 0] && SimplerQ[a + b*x, c + d*x] && SimplerQ[a + b*x, e + f*x] && (PosQ[-(b*c - a*d)/d] || NegQ[-(b*e - a*f)/f]) (* && PosQ[-b/d] *)
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := Sqrt[b*(c + d*x)/(b*c - a*d)]/Sqrt[c + d*x]* Int[1/(Sqrt[a + b*x]*Sqrt[b*c/(b*c - a*d) + b*d*x/(b*c - a*d)]* Sqrt[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[(b*c - a*d)/b, 0]] && SimplerQ[a + b*x, c + d*x] && SimplerQ[a + b*x, e + f*x]
Int[1/(Sqrt[a_ + b_.*x_]*Sqrt[c_ + d_.*x_]*Sqrt[e_ + f_.*x_]), x_Symbol] := Sqrt[b*(e + f*x)/(b*e - a*f)]/Sqrt[e + f*x]* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]* Sqrt[b*e/(b*e - a*f) + b*f*x/(b*e - a*f)]), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[(b*e - a*f)/b, 0]]
Int[1/((a_. + b_.*x_)*(c_. + d_.*x_)^(1/3)*(e_. + f_.*x_)^(1/3)), x_Symbol] := With[{q = Rt[b*(b*e - a*f)/(b*c - a*d)^2, 3]}, -Log[a + b*x]/(2*q*(b*c - a*d)) - Sqrt[3]* ArcTan[1/Sqrt[3] + 2*q*(c + d*x)^(2/3)/(Sqrt[3]*(e + f*x)^(1/3))]/(2* q*(b*c - a*d)) + 3*Log[q*(c + d*x)^(2/3) - (e + f*x)^(1/3)]/(4*q*(b*c - a*d))] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[2*b*d*e - b*c*f - a*d*f, 0]
Int[(a_. + b_.*x_)^m_/((c_. + d_.*x_)^(1/3)*(e_. + f_.*x_)^(1/3)), x_Symbol] := b*(a + b*x)^(m + 1)*(c + d*x)^(2/ 3)*(e + f*x)^(2/3)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + f/(6*(m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(a*d*(3*m + 1) - 3*b*c*(3*m + 5) - 2*b*d*(3*m + 7)*x)/((c + d*x)^(1/3)*(e + f*x)^(1/3)), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[2*b*d*e - b*c*f - a*d*f, 0] && ILtQ[m, -1]
(* Int[(a_.+b_.*x_)^m_.*(c_.+d_.*x_)^n_.*(f_.*x_)^p_.,x_Symbol] := Simp[(a+b*x)^m*(c+d*x)^m/(a*c+b*d*x^2)^m]*Int[(a*c+b*d*x^2)^m*(f*x)^ p,x] /; FreeQ[{a,b,c,d,f,m,n,p},x] && EqQ[b*c+a*d,0] && EqQ[n,m] *)
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(f_.*x_)^p_., x_Symbol] := Int[(a*c + b*d*x^2)^m*(f*x)^p, x] /; FreeQ[{a, b, c, d, f, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[n, m] && GtQ[a, 0] && GtQ[c, 0]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(f_.*x_)^p_., x_Symbol] := (a + b*x)^ FracPart[m]*(c + d*x)^FracPart[m]/(a*c + b*d*x^2)^FracPart[m]* Int[(a*c + b*d*x^2)^m*(f*x)^p, x] /; FreeQ[{a, b, c, d, f, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[n, m]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && (IGtQ[m, 0] || ILtQ[m, 0] && ILtQ[n, 0])
Int[(e_.*x_)^p_*(a_ + b_.*x_)^m_*(c_ + d_.*x_)^n_, x_Symbol] := With[{k = Denominator[p]}, k/e* Subst[Int[x^(k*(p + 1) - 1)*(a + b*x^k/e)^m*(c + d*x^k/e)^n, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && FractionQ[p] && IntegerQ[m]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_/(e_. + f_.*x_)^2, x_Symbol] := b*d/f^2*Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1), x] + (b*e - a*f)*(d*e - c*f)/f^2* Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1)/(e + f*x)^2, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[m + n, 0] && EqQ[2*b*d*e - f*(b*c + a*d), 0]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_, x_Symbol] := f^(p - 1)/d^p* Int[(a + b*x)^m*(d*e*p - c*f*(p - 1) + d*f*x)/(c + d*x)^(m + 1), x] + f^(p - 1)*Int[(a + b*x)^m*(e + f*x)^p/(c + d*x)^(m + 1)* ExpandToSum[ f^(-p + 1)*(c + d*x)^(-p + 1) - (d*e*p - c*f*(p - 1) + d*f*x)/(d^p*(e + f*x)^p), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[m + n + p, 0] && ILtQ[p, 0] && (LtQ[m, 0] || SumSimplerQ[m, 1] || Not[LtQ[n, 0] || SumSimplerQ[n, 1]])
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_, x_Symbol] := b*d^(m + n)*f^p*Int[(a + b*x)^(m - 1)/(c + d*x)^m, x] + Int[(a + b*x)^(m - 1)*(e + f*x)^p/(c + d*x)^m* ExpandToSum[(a + b*x)*(c + d*x)^(-p - 1) - (b*d^(-p - 1)* f^p)/(e + f*x)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[m + n + p + 1, 0] && ILtQ[p, 0] && (GtQ[m, 0] || SumSimplerQ[m, -1] || Not[GtQ[n, 0] || SumSimplerQ[n, -1]])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_, x_Symbol] := (b*c - a*d)^ n*(a + b*x)^(m + 1)/((m + 1)*(b*e - a*f)^(n + 1)*(e + f*x)^(m + 1))* Hypergeometric2F1[m + 1, -n, m + 2, -(d*e - c*f)*(a + b*x)/((b*c - a*d)*(e + f*x))] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[m + n + p + 2, 0] && ILtQ[n, 0] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[p, 1]]) && Not[ILtQ[m, 0]]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_, x_Symbol] := (a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^(p + 1)/((b*e - a*f)*(m + 1))*((b*e - a*f)*(c + d*x)/((b*c - a*d)*(e + f*x)))^(-n)* Hypergeometric2F1[m + 1, -n, m + 2, -(d*e - c*f)*(a + b*x)/((b*c - a*d)*(e + f*x))] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[m + n + p + 2, 0] && Not[IntegerQ[n]]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_/(e_. + f_.*x_), x_Symbol] := (c*f - d*e)^(m + n + 1)/f^(m + n + 1)* Int[(a + b*x)^m/((c + d*x)^(m + 1)*(e + f*x)), x] + 1/f^(m + n + 1)* Int[(a + b*x)^m/(c + d*x)^(m + 1)* ExpandToSum[(f^(m + n + 1)*(c + d*x)^(m + n + 1) - (c*f - d*e)^(m + n + 1))/(e + f*x), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[m + n + 1, 0] && (LtQ[m, 0] || SumSimplerQ[m, 1] || Not[LtQ[n, 0] || SumSimplerQ[n, 1]])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := b*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* Simp[a*d*f*(m + 1) - b*(d*e*(m + n + 2) + c*f*(m + p + 2)) - b*d*f*(m + n + p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && ILtQ[m + n + p + 2, 0] && NeQ[m, -1] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]] && Not[SumSimplerQ[p, 1]])
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x)^n*(c + d*x)^n*(f*x)^ p, (a + b*x)^(m - n), x], x] /; FreeQ[{a, b, c, d, f, m, n, p}, x] && EqQ[b*c + a*d, 0] && IGtQ[m - n, 0] && NeQ[m + n + p + 2, 0]
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_*(e_ + f_.*x_)^p_, x_Symbol] := c^n*e^p*(b*x)^(m + 1)/(b*(m + 1))* AppellF1[m + 1, -n, -p, m + 2, -d*x/c, -f*x/e] /; FreeQ[{b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[c, 0] && (IntegerQ[p] || GtQ[e, 0])
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_*(e_ + f_.*x_)^p_, x_Symbol] := (c + d*x)^(n + 1)/(d*(n + 1)*(-d/(b*c))^m*(d/(d*e - c*f))^p)* AppellF1[n + 1, -m, -p, n + 2, 1 + d*x/c, -f*(c + d*x)/(d*e - c*f)] /; FreeQ[{b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[-d/(b*c), 0] && (IntegerQ[p] || GtQ[d/(d*e - c*f), 0])
Int[(b_.*x_)^m_*(c_ + d_.*x_)^n_*(e_ + f_.*x_)^p_, x_Symbol] := c^IntPart[n]*(c + d*x)^FracPart[n]/(1 + d*x/c)^FracPart[n]* Int[(b*x)^m*(1 + d*x/c)^n*(e + f*x)^p, x] /; FreeQ[{b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[GtQ[c, 0]]
Int[(a_ + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_, x_Symbol] := (b*e - a*f)^ p*(a + b*x)^(m + 1)/(b^(p + 1)*(m + 1)*(b/(b*c - a*d))^n)* AppellF1[m + 1, -n, -p, m + 2, -d*(a + b*x)/(b*c - a*d), -f*(a + b*x)/(b*e - a*f)] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && IntegerQ[p] && GtQ[b/(b*c - a*d), 0] && Not[GtQ[d/(d*a - c*b), 0] && SimplerQ[c + d*x, a + b*x]]
Int[(a_ + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_, x_Symbol] := (c + d*x)^ FracPart[ n]/((b/(b*c - a*d))^IntPart[n]*(b*(c + d*x)/(b*c - a*d))^ FracPart[n])* Int[(a + b*x)^m*(b*c/(b*c - a*d) + b*d*x/(b*c - a*d))^ n*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && IntegerQ[p] && Not[GtQ[b/(b*c - a*d), 0]] && Not[SimplerQ[c + d*x, a + b*x]]
Int[(a_ + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_, x_Symbol] := (a + b*x)^(m + 1)/(b*(m + 1)*(b/(b*c - a*d))^n*(b/(b*e - a*f))^p)* AppellF1[m + 1, -n, -p, m + 2, -d*(a + b*x)/(b*c - a*d), -f*(a + b*x)/(b*e - a*f)] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && GtQ[b/(b*c - a*d), 0] && GtQ[b/(b*e - a*f), 0] && Not[ GtQ[d/(d*a - c*b), 0] && GtQ[d/(d*e - c*f), 0] && SimplerQ[c + d*x, a + b*x]] && Not[ GtQ[f/(f*a - e*b), 0] && GtQ[f/(f*c - e*d), 0] && SimplerQ[e + f*x, a + b*x]]
Int[(a_ + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_, x_Symbol] := (e + f*x)^ FracPart[ p]/((b/(b*e - a*f))^IntPart[p]*(b*(e + f*x)/(b*e - a*f))^ FracPart[p])* Int[(a + b*x)^m*(c + d*x)^ n*(b*e/(b*e - a*f) + b*f*x/(b*e - a*f))^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && GtQ[b/(b*c - a*d), 0] && Not[GtQ[b/(b*e - a*f), 0]]
Int[(a_ + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_, x_Symbol] := (c + d*x)^ FracPart[ n]/((b/(b*c - a*d))^IntPart[n]*(b*(c + d*x)/(b*c - a*d))^ FracPart[n])* Int[(a + b*x)^m*(b*c/(b*c - a*d) + b*d*x/(b*c - a*d))^ n*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && Not[GtQ[b/(b*c - a*d), 0]] && Not[SimplerQ[c + d*x, a + b*x]] && Not[SimplerQ[e + f*x, a + b*x]]
Int[(a_. + b_.*u_)^m_.*(c_. + d_.*u_)^n_.*(e_ + f_.*u_)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p, x], x, u] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.4 (a+b x)^m (c+d x)^n (e+f x)^p (g+h x)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.4 (a+b x)^m (c+d x)^n (e+f x)^p (g+h x)^q *)
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^ n_.*(e_ + f_.*x_)*(g_. + h_.*x_), x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n*(e + f*x)*(g + h*x), x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && (IGtQ[m, 0] || IntegersQ[m, n])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_ + f_.*x_)*(g_. + h_.*x_), x_Symbol] := (b^2*d*e*g - a^2*d*f*h*m - a*b*(d*(f*g + e*h) - c*f*h*(m + 1)) + b*f*h*(b*c - a*d)*(m + 1)*x)*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)/ (b^2*d*(b*c - a*d)*(m + 1)) + (a*d*f*h*m + b*(d*(f*g + e*h) - c*f*h*(m + 2)))/(b^2*d)* Int[(a + b*x)^(m + 1)*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[m + n + 2, 0] && NeQ[m, -1] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_ + f_.*x_)*(g_. + h_.*x_), x_Symbol] := (b^2*c*d*e*g*(n + 1) + a^2*c*d*f*h*(n + 1) + a*b*(d^2*e*g*(m + 1) + c^2*f*h*(m + 1) - c*d*(f*g + e*h)*(m + n + 2)) + (a^2*d^2*f*h*(n + 1) - a*b*d^2*(f*g + e*h)*(n + 1) + b^2*(c^2*f*h*(m + 1) - c*d*(f*g + e*h)*(m + 1) + d^2*e*g*(m + n + 2)))*x)/ (b*d*(b*c - a*d)^2*(m + 1)*(n + 1))*(a + b*x)^(m + 1)*(c + d*x)^(n + 1) - (a^2*d^2*f*h*(2 + 3*n + n^2) + a*b*d*(n + 1)*(2*c*f*h*(m + 1) - d*(f*g + e*h)*(m + n + 3)) + b^2*(c^2*f*h*(2 + 3*m + m^2) - c*d*(f*g + e*h)*(m + 1)*(m + n + 3) + d^2*e*g*(6 + m^2 + 5*n + n^2 + m*(2*n + 5))))/ (b*d*(b*c - a*d)^2*(m + 1)*(n + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && LtQ[m, -1] && LtQ[n, -1]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_ + f_.*x_)*(g_. + h_.*x_), x_Symbol] := (b^3*c*e*g*(m + 2) - a^3*d*f*h*(n + 2) - a^2*b*(c*f*h*m - d*(f*g + e*h)*(m + n + 3)) - a*b^2*(c*(f*g + e*h) + d*e*g*(2*m + n + 4)) + b*(a^2*d*f*h*(m - n) - a*b*(2*c*f*h*(m + 1) - d*(f*g + e*h)*(n + 1)) + b^2*(c*(f*g + e*h)*(m + 1) - d*e*g*(m + n + 2)))*x)/ (b^2*(b*c - a*d)^2*(m + 1)*(m + 2))*(a + b*x)^(m + 1)*(c + d*x)^(n + 1) + (f*h/ b^2 - (d*(m + n + 3)*(a^2*d*f*h*(m - n) - a*b*(2*c*f*h*(m + 1) - d*(f*g + e*h)*(n + 1)) + b^2*(c*(f*g + e*h)*(m + 1) - d*e*g*(m + n + 2))))/ (b^2*(b*c - a*d)^2*(m + 1)*(m + 2)))* Int[(a + b*x)^(m + 2)*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && (LtQ[m, -2] || EqQ[m + n + 3, 0] && Not[LtQ[n, -2]])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_ + f_.*x_)*(g_. + h_.*x_), x_Symbol] := (a^2*d*f*h*(n + 2) + b^2*d*e*g*(m + n + 3) + a*b*(c*f*h*(m + 1) - d*(f*g + e*h)*(m + n + 3)) + b*f*h*(b*c - a*d)*(m + 1)*x)/ (b^2*d*(b*c - a*d)*(m + 1)*(m + n + 3))*(a + b*x)^(m + 1)*(c + d*x)^(n + 1) - (a^2*d^2*f*h*(n + 1)*(n + 2) + a*b*d*(n + 1)*(2*c*f*h*(m + 1) - d*(f*g + e*h)*(m + n + 3)) + b^2*(c^2*f*h*(m + 1)*(m + 2) - c*d*(f*g + e*h)*(m + 1)*(m + n + 3) + d^2*e*g*(m + n + 2)*(m + n + 3)))/ (b^2*d*(b*c - a*d)*(m + 1)*(m + n + 3))* Int[(a + b*x)^(m + 1)*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && (GeQ[m, -2] && LtQ[m, -1] || SumSimplerQ[m, 1]) && NeQ[m, -1] && NeQ[m + n + 3, 0]
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^ n_.*(e_ + f_.*x_)*(g_. + h_.*x_), x_Symbol] := -(a*d*f*h*(n + 2) + b*c*f*h*(m + 2) - b*d*(f*g + e*h)*(m + n + 3) - b*d*f*h*(m + n + 2)*x)*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)/ (b^2*d^2*(m + n + 2)*(m + n + 3)) + (a^2*d^2*f*h*(n + 1)*(n + 2) + a*b*d*(n + 1)*(2*c*f*h*(m + 1) - d*(f*g + e*h)*(m + n + 3)) + b^2*(c^2*f*h*(m + 1)*(m + 2) - c*d*(f*g + e*h)*(m + 1)*(m + n + 3) + d^2*e*g*(m + n + 2)*(m + n + 3)))/ (b^2*d^2*(m + n + 2)*(m + n + 3))* Int[(a + b*x)^m*(c + d*x)^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && NeQ[m + n + 2, 0] && NeQ[m + n + 3, 0]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x), x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && (IntegersQ[m, n, p] || IGtQ[n, 0] && IGtQ[p, 0])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := (b*g - a*h)*(a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^(p + 1)/(b*(b*e - a*f)*(m + 1)) - 1/(b*(b*e - a*f)*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1)*(e + f*x)^p* Simp[b*c*(f*g - e*h)*(m + 1) + (b*g - a*h)*(d*e*n + c*f*(p + 1)) + d*(b*(f*g - e*h)*(m + 1) + f*(b*g - a*h)*(n + p + 1))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, p}, x] && ILtQ[m, -1] && GtQ[n, 0]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := (b*g - a*h)*(a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^(p + 1)/(b*(b*e - a*f)*(m + 1)) - 1/(b*(b*e - a*f)*(m + 1))* Int[(a + b*x)^(m + 1)*(c + d*x)^(n - 1)*(e + f*x)^p* Simp[b*c*(f*g - e*h)*(m + 1) + (b*g - a*h)*(d*e*n + c*f*(p + 1)) + d*(b*(f*g - e*h)*(m + 1) + f*(b*g - a*h)*(n + p + 1))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, p}, x] && LtQ[m, -1] && GtQ[n, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := (b*g - a*h)*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* Simp[(a*d*f*g - b*(d*e + c*f)*g + b*c*e*h)*(m + 1) - (b*g - a*h)*(d*e*(n + 1) + c*f*(p + 1)) - d*f*(b*g - a*h)*(m + n + p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n, p}, x] && ILtQ[m, -1]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := (b*g - a*h)*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* Simp[(a*d*f*g - b*(d*e + c*f)*g + b*c*e*h)*(m + 1) - (b*g - a*h)*(d*e*(n + 1) + c*f*(p + 1)) - d*f*(b*g - a*h)*(m + n + p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n, p}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n, 2*p]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := h*(a + b*x)^ m*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d*f*(m + n + p + 2)) + 1/(d*f*(m + n + p + 2))* Int[(a + b*x)^(m - 1)*(c + d*x)^n*(e + f*x)^p* Simp[a*d*f*g*(m + n + p + 2) - h*(b*c*e*m + a*(d*e*(n + 1) + c*f*(p + 1))) + (b*d*f*g*(m + n + p + 2) + h*(a*d*f*m - b*(d*e*(m + n + 1) + c*f*(m + p + 1))))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n, p}, x] && GtQ[m, 0] && NeQ[m + n + p + 2, 0] && IntegerQ[m]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := h*(a + b*x)^ m*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d*f*(m + n + p + 2)) + 1/(d*f*(m + n + p + 2))* Int[(a + b*x)^(m - 1)*(c + d*x)^n*(e + f*x)^p* Simp[a*d*f*g*(m + n + p + 2) - h*(b*c*e*m + a*(d*e*(n + 1) + c*f*(p + 1))) + (b*d*f*g*(m + n + p + 2) + h*(a*d*f*m - b*(d*e*(m + n + 1) + c*f*(m + p + 1))))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n, p}, x] && GtQ[m, 0] && NeQ[m + n + p + 2, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := (b*g - a*h)*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* Simp[(a*d*f*g - b*(d*e + c*f)*g + b*c*e*h)*(m + 1) - (b*g - a*h)*(d*e*(n + 1) + c*f*(p + 1)) - d*f*(b*g - a*h)*(m + n + p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n, p}, x] && ILtQ[m + n + p + 2, 0] && NeQ[m, -1] && (SumSimplerQ[m, 1] || Not[NeQ[n, -1] && SumSimplerQ[n, 1]] && Not[NeQ[p, -1] && SumSimplerQ[p, 1]])
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(g_. + h_.*x_)/(e_. + f_.*x_), x_Symbol] := (f*g - e*h)*(c*f - d*e)^(m + n + 1)/f^(m + n + 2)* Int[(a + b*x)^m/((c + d*x)^(m + 1)*(e + f*x)), x] + 1/f^(m + n + 2)*Int[(a + b*x)^m/(c + d*x)^(m + 1)* ExpandToSum[(f^(m + n + 2)*(c + d*x)^(m + n + 1)*(g + h*x) - (f*g - e*h)*(c*f - d*e)^(m + n + 1))/(e + f*x), x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[m + n + 1, 0] && (LtQ[m, 0] || SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]])
Int[(e_. + f_.*x_)^p_*(g_. + h_.*x_)/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := (b*g - a*h)/(b*c - a*d)*Int[(e + f*x)^p/(a + b*x), x] - (d*g - c*h)/(b*c - a*d)*Int[(e + f*x)^p/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_*(g_. + h_.*x_)/(a_. + b_.*x_), x_Symbol] := h/b*Int[(c + d*x)^n*(e + f*x)^p, x] + (b*g - a*h)/b* Int[(c + d*x)^n*(e + f*x)^p/(a + b*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, n, p}, x]
Int[(g_. + h_.*x_)/(Sqrt[a_. + b_.*x_]*Sqrt[c_ + d_.*x_]* Sqrt[e_ + f_.*x_]), x_Symbol] := h/f*Int[Sqrt[e + f*x]/(Sqrt[a + b*x]*Sqrt[c + d*x]), x] + (f*g - e*h)/f* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && SimplerQ[a + b*x, e + f*x] && SimplerQ[c + d*x, e + f*x]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_), x_Symbol] := h/b*Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p, x] + (b*g - a*h)/b*Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]] && Not[SumSimplerQ[p, 1]])
Int[(a_. + b_.*x_)^m_*Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_], x_Symbol] := (a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(b*(m + 1)) - 1/(2*b*(m + 1))* Int[(a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x])* Simp[d*e*g + c*f*g + c*e*h + 2*(d*f*g + d*e*h + c*f*h)*x + 3*d*f*h*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IntegerQ[2*m] && LtQ[m, -1]
Int[(a_. + b_.*x_)^m_*Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_], x_Symbol] := 2*(a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(b*(2*m + 5)) + 1/(b*(2*m + 5))* Int[((a + b*x)^m)/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x])* Simp[3*b*c*e*g - a*(d*e*g + c*f*g + c*e*h) + 2*(b*(d*e*g + c*f*g + c*e*h) - a*(d*f*g + d*e*h + c*f*h))* x - (3*a*d*f*h - b*(d*f*g + d*e*h + c*f*h))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IntegerQ[2*m] && Not[LtQ[m, -1]]
Int[(a_. + b_.*x_)^m_*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]/Sqrt[c_. + d_.*x_], x_Symbol] := 2*(a + b*x)^m*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(d*(2*m + 3)) - 1/(d*(2*m + 3))* Int[((a + b*x)^(m - 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[2*b*c*e*g*m + a*(c*(f*g + e*h) - 2*d*e*g*(m + 1)) - (b*(2*d*e*g - c*(f*g + e*h)*(2*m + 1)) - a*(2*c*f*h - d*(2*m + 1)*(f*g + e*h)))*x - (2*a*d*f*h*m + b*(d*(f*g + e*h) - 2*c*f*h*(m + 1)))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IntegerQ[2*m] && GtQ[m, 0]
Int[Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]), x_Symbol] := (b*e - a*f)*(b*g - a*h)/b^2* Int[1/((a + b*x)*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + 1/b^2* Int[Simp[b*f*g + b*e*h - a*f*h + b*f*h*x, x]/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(a_. + b_.*x_)^m_*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]/Sqrt[c_. + d_.*x_], x_Symbol] := (a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/((m + 1)*(b*c - a*d)) - 1/(2*(m + 1)*(b*c - a*d))* Int[((a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[c*(f*g + e*h) + d*e*g*(2*m + 3) + 2*(c*f*h + d*(m + 2)*(f*g + e*h))*x + d*f*h*(2*m + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IntegerQ[2*m] && LtQ[m, -1]
Int[Sqrt[ a_. + b_.*x_]/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := 2*(a + b*x)*Sqrt[(b*g - a*h)*(c + d*x)/((d*g - c*h)*(a + b*x))]* Sqrt[(b*g - a*h)*(e + f*x)/((f*g - e*h)*(a + b*x))]/(Sqrt[c + d*x]* Sqrt[e + f*x])* Subst[ Int[1/((h - b*x^2)*Sqrt[1 + (b*c - a*d)*x^2/(d*g - c*h)]* Sqrt[1 + (b*e - a*f)*x^2/(f*g - e*h)]), x], x, Sqrt[g + h*x]/Sqrt[a + b*x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(a_. + b_.*x_)^(3/2)/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := b/d*Int[Sqrt[a + b*x]*Sqrt[c + d*x]/(Sqrt[e + f*x]*Sqrt[g + h*x]), x] - (b*c - a*d)/d* Int[Sqrt[a + b*x]/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(a_. + b_.*x_)^ m_/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := 2*b^2*(a + b*x)^(m - 2)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(d*f*h*(2*m - 1)) - 1/(d*f*h*(2*m - 1))* Int[((a + b*x)^(m - 3)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[a*b^2*(d*e*g + c*f*g + c*e*h) + 2*b^3*c*e*g*(m - 2) - a^3*d*f*h*(2*m - 1) + b*(2*a*b*(d*f*g + d*e*h + c*f*h) + b^2*(2*m - 3)*(d*e*g + c*f*g + c*e*h) - 3*a^2*d*f*h*(2*m - 1))*x - 2*b^2*(m - 1)*(3*a*d*f*h - b*(d*f*g + d*e*h + c*f*h))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IntegerQ[2*m] && GeQ[m, 2]
Int[1/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := -2*Subst[ Int[1/(Simp[b*c - a*d - b*x^2, x]* Sqrt[Simp[(d*e - c*f)/d + f*x^2/d, x]]* Sqrt[Simp[(d*g - c*h)/d + h*x^2/d, x]]), x], x, Sqrt[c + d*x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && GtQ[(d*e - c*f)/d, 0]
Int[1/((a_. + b_.*x_)*Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := -2*Subst[ Int[1/(Simp[b*c - a*d - b*x^2, x]* Sqrt[Simp[(d*e - c*f)/d + f*x^2/d, x]]* Sqrt[Simp[(d*g - c*h)/d + h*x^2/d, x]]), x], x, Sqrt[c + d*x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && Not[SimplerQ[e + f*x, c + d*x]] && Not[SimplerQ[g + h*x, c + d*x]]
(* Int[1/(Sqrt[a_.+b_.*x_]*Sqrt[c_.+d_.*x_]*Sqrt[e_.+f_.*x_]*Sqrt[g_.+ h_.*x_]),x_Symbol] := -2*(a+b*x)*Sqrt[(b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x))]*Sqrt[(b*g-a* h)*(e+f*x)/((f*g-e*h)*(a+b*x))]/ ((b*g-a*h)*Sqrt[c+d*x]*Sqrt[e+f*x])* Subst[Int[1/(Sqrt[1+(b*c-a*d)*x^2/(d*g-c*h)]*Sqrt[1+(b*e-a*f)*x^2/ (f*g-e*h)]),x],x,Sqrt[g+h*x]/Sqrt[a+b*x]] /; FreeQ[{a,b,c,d,e,f,g,h},x] *)
Int[1/(Sqrt[a_. + b_.*x_]*Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := 2*Sqrt[g + h*x]*Sqrt[(b*e - a*f)*(c + d*x)/((d*e - c*f)*(a + b*x))]/ ((f*g - e*h)*Sqrt[c + d*x]* Sqrt[-(b*e - a*f)*(g + h*x)/((f*g - e*h)*(a + b*x))])* Subst[ Int[1/(Sqrt[1 + (b*c - a*d)*x^2/(d*e - c*f)]* Sqrt[1 - (b*g - a*h)*x^2/(f*g - e*h)]), x], x, Sqrt[e + f*x]/Sqrt[a + b*x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[1/((a_. + b_.*x_)^(3/2)*Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := -d/(b*c - a*d)* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + b/(b*c - a*d)* Int[Sqrt[c + d*x]/((a + b*x)^(3/2)*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(a_. + b_.*x_)^ m_/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := b^2*(a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/((m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h)) - 1/(2*(m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h))* Int[((a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[2*a^2*d*f*h*(m + 1) - 2*a*b*(m + 1)*(d*f*g + d*e*h + c*f*h) + b^2*(2*m + 3)*(d*e*g + c*f*g + c*e*h) - 2*b*(a*d*f*h*(m + 1) - b*(m + 2)*(d*f*g + d*e*h + c*f*h))*x + d*f*h*(2*m + 5)*b^2*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IntegerQ[2*m] && LeQ[m, -2]
Int[Sqrt[a_. + b_.*x_]* Sqrt[c_. + d_.*x_]/(Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[g + h*x]/(h*Sqrt[e + f*x]) + (d*e - c*f)*(b*f*g + b*e*h - 2*a*f*h)/(2*f^2*h)* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + (a*d*f*h - b*(d*f*g + d*e*h - c*f*h))/(2*f^2*h)* Int[Sqrt[e + f*x]/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[g + h*x]), x] - (d*e - c*f)*(f*g - e*h)/(2*f*h)* Int[Sqrt[a + b*x]/(Sqrt[c + d*x]*(e + f*x)^(3/2)*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(a_. + b_.*x_)^m_* Sqrt[c_. + d_.*x_]/(Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := 2*b*(a + b*x)^(m - 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(f*h*(2*m + 1)) - 1/(f*h*(2*m + 1))* Int[((a + b*x)^(m - 2)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[a*b*(d*e*g + c*(f*g + e*h)) + 2*b^2*c*e*g*(m - 1) - a^2*c*f*h*(2*m + 1) + (b^2*(2*m - 1)*(d*e*g + c*(f*g + e*h)) - a^2*d*f*h*(2*m + 1) + 2*a*b*(d*f*g + d*e*h - 2*c*f*h*m))* x - b*(a*d*f*h*(4*m - 1) + b*(c*f*h - 2*d*(f*g + e*h)*m))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IntegerQ[2*m] && GtQ[m, 1]
Int[Sqrt[ c_. + d_.*x_]/((a_. + b_.*x_)*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := d/b*Int[1/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + (b*c - a*d)/b* Int[1/((a + b*x)*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
(* Int[Sqrt[c_.+d_.*x_]/((a_.+b_.*x_)^(3/2)*Sqrt[e_.+f_.*x_]*Sqrt[g_.+ h_.*x_]),x_Symbol] := -2*Sqrt[c+d*x]*Sqrt[(b*g-a*h)*(e+f*x)/((f*g-e*h)*(a+b*x))]/ ((b*g-a*h)*Sqrt[e+f*x]*Sqrt[(b*g-a*h)*(c+d*x)/((d*g-c*h)*(a+b*x))] )* Subst[Int[Sqrt[1+(b*c-a*d)*x^2/(d*g-c*h)]/Sqrt[1+(b*e-a*f)*x^2/(f* g-e*h)],x],x,Sqrt[g+h*x]/Sqrt[a+b*x]] /; FreeQ[{a,b,c,d,e,f,g,h},x] *)
Int[Sqrt[ c_. + d_.*x_]/((a_. + b_.*x_)^(3/2)*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := -2*Sqrt[c + d*x]* Sqrt[-(b*e - a*f)*(g + h*x)/((f*g - e*h)*(a + b*x))]/ ((b*e - a*f)*Sqrt[g + h*x]* Sqrt[(b*e - a*f)*(c + d*x)/((d*e - c*f)*(a + b*x))])* Subst[ Int[Sqrt[1 + (b*c - a*d)*x^2/(d*e - c*f)]/ Sqrt[1 - (b*g - a*h)*x^2/(f*g - e*h)], x], x, Sqrt[e + f*x]/Sqrt[a + b*x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x]
Int[(a_. + b_.*x_)^m_* Sqrt[c_. + d_.*x_]/(Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := b*(a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/((m + 1)*(b*e - a*f)*(b*g - a*h)) + 1/(2*(m + 1)*(b*e - a*f)*(b*g - a*h))* Int[((a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[2*a*c*f*h*(m + 1) - b*(d*e*g + c*(2*m + 3)*(f*g + e*h)) + 2*(a*d*f*h*(m + 1) - b*(m + 2)*(d*f*g + d*e*h + c*f*h))*x - b*d*f*h*(2*m + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IntegerQ[2*m] && LeQ[m, -2]
Int[(e_. + f_.*x_)^ p_*(g_. + h_.*x_)^q_/((a_. + b_.*x_)*(c_. + d_.*x_)), x_Symbol] := (b*e - a*f)/(b*c - a*d)* Int[(e + f*x)^(p - 1)*(g + h*x)^q/(a + b*x), x] - (d*e - c*f)/(b*c - a*d)* Int[(e + f*x)^(p - 1)*(g + h*x)^q/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, q}, x] && LtQ[0, p, 1]
Int[(a_. + b_.*x_)^ m_.*(c_. + d_.*x_)^n_/(Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := Int[ExpandIntegrand[ 1/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), (a + b*x)^ m*(c + d*x)^(n + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IntegerQ[m] && IntegerQ[n + 1/2]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_)^q_, x_Symbol] := Int[ExpandIntegrand[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^ q, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && IntegersQ[p, q]
Int[(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_)^q_, x_Symbol] := h/b*Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^ p*(g + h*x)^(q - 1), x] + (b*g - a*h)/b* Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^(q - 1), x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x] && IGtQ[q, 0] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]] && Not[SumSimplerQ[p, 1]])
Int[(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^ p_.*(g_. + h_.*x_)^q_., x_Symbol] := CannotIntegrate[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q}, x]
Int[(a_. + b_.*u_)^m_.*(c_. + d_.*u_)^n_.*(e_. + f_.*u_)^ p_.*(g_. + h_.*u_)^q_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q, x], x, u] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(i_.*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^ p_*(g_. + h_.*x_)^q_)^r_, x_Symbol] := (i*(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q)^ r/((a + b*x)^(m*r)*(c + d*x)^(n*r)*(e + f*x)^(p*r)*(g + h*x)^(q* r))* Int[(a + b*x)^(m*r)*(c + d*x)^(n*r)*(e + f*x)^(p*r)*(g + h*x)^(q*r), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, p, q, r}, x]
Int[u_^m_, x_Symbol] := Int[ExpandToSum[u, x]^m, x] /; FreeQ[m, x] && LinearQ[u, x] && Not[LinearMatchQ[u, x]]
Int[u_^m_.*v_^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n, x] /; FreeQ[{m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*v_^n_.*w_^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n*ExpandToSum[w, x]^p, x] /; FreeQ[{m, n, p}, x] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]
Int[u_^m_.*v_^n_.*w_^p_.*z_^q_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n*ExpandToSum[w, x]^p* ExpandToSum[z, x]^q, x] /; FreeQ[{m, n, p, q}, x] && LinearQ[{u, v, w, z}, x] && Not[LinearMatchQ[{u, v, w, z}, x]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.5 P(x) (a+b x)^m (c+d x)^n.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.5 P(x) (a+b x)^m (c+d x)^n *)
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_., x_Symbol] := Int[Px*(a*c + b*d*x^2)^m, x] /; FreeQ[{a, b, c, d, m, n}, x] && PolyQ[Px, x] && EqQ[b*c + a*d, 0] && EqQ[m, n] && (IntegerQ[m] || GtQ[a, 0] && GtQ[c, 0])
Int[Px_*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_, x_Symbol] := (a + b*x)^ FracPart[m]*(c + d*x)^FracPart[m]/(a*c + b*d*x^2)^FracPart[m]* Int[Px*(a*c + b*d*x^2)^m, x] /; FreeQ[{a, b, c, d, m, n}, x] && PolyQ[Px, x] && EqQ[b*c + a*d, 0] && EqQ[m, n] && Not[IntegerQ[m]]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_., x_Symbol] := Int[PolynomialQuotient[Px, a + b*x, x]*(a + b*x)^(m + 1)*(c + d*x)^ n, x] /; FreeQ[{a, b, c, d, m, n}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, a + b*x, x], 0]
Int[Px_*(c_. + d_.*x_)^n_./(a_. + b_.*x_), x_Symbol] := Int[ExpandIntegrand[1/Sqrt[c + d*x], Px*(c + d*x)^(n + 1/2)/(a + b*x), x], x] /; FreeQ[{a, b, c, d, n}, x] && PolyQ[Px, x] && ILtQ[n + 1/2, 0] && GtQ[Expon[Px, x], 2]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_., x_Symbol] := Int[ExpandIntegrand[Px*(a + b*x)^m*(c + d*x)^n, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && PolyQ[Px, x] && (IntegersQ[m, n] || IGtQ[m, -2]) && GtQ[Expon[Px, x], 2]
Int[Px_*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_., x_Symbol] := With[{Qx = PolynomialQuotient[Px, a + b*x, x], R = PolynomialRemainder[Px, a + b*x, x]}, R*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)/((m + 1)*(b*c - a*d)) + 1/((m + 1)*(b*c - a*d))* Int[(a + b*x)^(m + 1)*(c + d*x)^n* ExpandToSum[(m + 1)*(b*c - a*d)*Qx - d*R*(m + n + 2), x], x]] /; FreeQ[{a, b, c, d, n}, x] && PolyQ[Px, x] && ILtQ[m, -1] && GtQ[Expon[Px, x], 2]
Int[Px_*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_., x_Symbol] := With[{Qx = PolynomialQuotient[Px, a + b*x, x], R = PolynomialRemainder[Px, a + b*x, x]}, R*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)/((m + 1)*(b*c - a*d)) + 1/((m + 1)*(b*c - a*d))* Int[(a + b*x)^(m + 1)*(c + d*x)^n* ExpandToSum[(m + 1)*(b*c - a*d)*Qx - d*R*(m + n + 2), x], x]] /; FreeQ[{a, b, c, d, n}, x] && PolyQ[Px, x] && LtQ[m, -1] && GtQ[Expon[Px, x], 2]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_., x_Symbol] := With[{q = Expon[Px, x], k = Coeff[Px, x, Expon[Px, x]]}, k*(a + b*x)^(m + q)*(c + d*x)^(n + 1)/(d*b^q*(m + n + q + 1)) + 1/(d*b^q*(m + n + q + 1))*Int[(a + b*x)^m*(c + d*x)^n* ExpandToSum[ d*b^q*(m + n + q + 1)*Px - d*k*(m + n + q + 1)*(a + b*x)^q - k*(b*c - a*d)*(m + q)*(a + b*x)^(q - 1), x], x] /; NeQ[m + n + q + 1, 0]] /; FreeQ[{a, b, c, d, m, n}, x] && PolyQ[Px, x] && GtQ[Expon[Px, x], 2]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.6 P(x) (a+b x)^m (c+d x)^n (e+f x)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.6 P(x) (a+b x)^m (c+d x)^n (e+f x)^p *)
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[Px*(a*c + b*d*x^2)^m*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && PolyQ[Px, x] && EqQ[b*c + a*d, 0] && EqQ[m, n] && (IntegerQ[m] || GtQ[a, 0] && GtQ[c, 0])
Int[Px_*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_*(e_. + f_.*x_)^p_., x_Symbol] := (a + b*x)^ FracPart[m]*(c + d*x)^FracPart[m]/(a*c + b*d*x^2)^FracPart[m]* Int[Px*(a*c + b*d*x^2)^m*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && PolyQ[Px, x] && EqQ[b*c + a*d, 0] && EqQ[m, n] && Not[IntegerQ[m]]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[PolynomialQuotient[Px, a + b*x, x]*(a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, a + b*x, x], 0]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := Int[ExpandIntegrand[Px*(a + b*x)^m*(c + d*x)^n*(e + f*x)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && PolyQ[Px, x] && IntegersQ[m, n]
Int[Px_*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[Px, a + b*x, x], R = PolynomialRemainder[Px, a + b*x, x]}, b*R*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* ExpandToSum[(m + 1)*(b*c - a*d)*(b*e - a*f)*Qx + a*d*f*R*(m + 1) - b*R*(d*e*(m + n + 2) + c*f*(m + p + 2)) - b*d*f*R*(m + n + p + 3)*x, x], x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && PolyQ[Px, x] && ILtQ[m, -1]
Int[Px_*(a_. + b_.*x_)^m_*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[Px, a + b*x, x], R = PolynomialRemainder[Px, a + b*x, x]}, b*R*(a + b*x)^(m + 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/((m + 1)*(b*c - a*d)*(b*e - a*f)) + 1/((m + 1)*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x)^(m + 1)*(c + d*x)^n*(e + f*x)^p* ExpandToSum[(m + 1)*(b*c - a*d)*(b*e - a*f)*Qx + a*d*f*R*(m + 1) - b*R*(d*e*(m + n + 2) + c*f*(m + p + 2)) - b*d*f*R*(m + n + p + 3)*x, x], x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && PolyQ[Px, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n, 2*p]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^p_., x_Symbol] := With[{q = Expon[Px, x], k = Coeff[Px, x, Expon[Px, x]]}, k*(a + b*x)^(m + q - 1)*(c + d*x)^(n + 1)*(e + f*x)^(p + 1)/(d*f* b^(q - 1)*(m + n + p + q + 1)) + 1/(d*f*b^q*(m + n + p + q + 1))* Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p* ExpandToSum[ d*f*b^q*(m + n + p + q + 1)*Px - d*f*k*(m + n + p + q + 1)*(a + b*x)^q + k*(a + b*x)^(q - 2)*(a^2*d*f*(m + n + p + q + 1) - b*(b*c*e*(m + q - 1) + a*(d*e*(n + 1) + c*f*(p + 1))) + b*(a*d*f*(2*(m + q) + n + p) - b*(d*e*(m + q + n) + c*f*(m + q + p)))*x), x], x] /; NeQ[m + n + p + q + 1, 0]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && PolyQ[Px, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.1 Linear/1.1.1.7 P(x) (a+b x)^m (c+d x)^n (e+f x)^p (g+h x)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.1.7 P(x) (a+b x)^m (c+d x)^n (e+f x)^p (g+h x)^q *)
Int[Px_*(a_ + b_.*x_^n_)^p_, x_Symbol] := Coeff[Px, x, n - 1]*(a + b*x^n)^(p + 1)/(b*n*(p + 1)) + Int[(Px - Coeff[Px, x, n - 1]*x^(n - 1))*(a + b*x^n)^p, x] /; FreeQ[{a, b}, x] && PolyQ[Px, x] && IGtQ[p, 1] && IGtQ[n, 1] && NeQ[Coeff[Px, x, n - 1], 0] && NeQ[Px, Coeff[Px, x, n - 1]*x^(n - 1)] && Not[MatchQ[Px, Qx_.*(c_ + d_.*x^m_)^q_ /; FreeQ[{c, d}, x] && PolyQ[Qx, x] && IGtQ[q, 1] && IGtQ[m, 1] && NeQ[Coeff[Qx*(a + b*x^n)^p, x, m - 1], 0] && GtQ[m*q, n*p]]]
Int[Px_*x_^m_.*(a_ + b_.*x_^n_.)^p_, x_Symbol] := Coeff[Px, x, n - m - 1]*(a + b*x^n)^(p + 1)/(b*n*(p + 1)) + Int[(Px - Coeff[Px, x, n - m - 1]*x^(n - m - 1))* x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, m, n}, x] && PolyQ[Px, x] && IGtQ[p, 1] && IGtQ[n - m, 0] && NeQ[Coeff[Px, x, n - m - 1], 0]
Int[u_.*x_^m_.*(a_.*x_^p_. + b_.*x_^q_.)^n_., x_Symbol] := Int[u*x^(m + n*p)*(a + b*x^(q - p))^n, x] /; FreeQ[{a, b, m, p, q}, x] && IntegerQ[n] && PosQ[q - p]
Int[u_.*x_^m_.*(a_.*x_^p_. + b_.*x_^q_. + c_.*x_^r_.)^n_., x_Symbol] := Int[u*x^(m + n*p)*(a + b*x^(q - p) + c*x^(r - p))^n, x] /; FreeQ[{a, b, c, m, p, q, r}, x] && IntegerQ[n] && PosQ[q - p] && PosQ[r - p]
Int[u_.*Px_^p_.*Qx_^q_., x_Symbol] := Int[u*PolynomialQuotient[Px, Qx, x]^p*Qx^(p + q), x] /; FreeQ[q, x] && PolyQ[Px, x] && PolyQ[Qx, x] && EqQ[PolynomialRemainder[Px, Qx, x], 0] && IntegerQ[p] && LtQ[p*q, 0]
Int[Pp_/Qq_, x_Symbol] := With[{p = Expon[Pp, x], q = Expon[Qq, x]}, Coeff[Pp, x, p]*Log[RemoveContent[Qq, x]]/(q*Coeff[Qq, x, q]) /; EqQ[p, q - 1] && EqQ[Pp, Simplify[ Coeff[Pp, x, p]/(q*Coeff[Qq, x, q])*D[Qq, x]]]] /; PolyQ[Pp, x] && PolyQ[Qq, x]
Int[Pp_*Qq_^m_., x_Symbol] := With[{p = Expon[Pp, x], q = Expon[Qq, x]}, Coeff[Pp, x, p]*x^(p - q + 1)* Qq^(m + 1)/((p + m*q + 1)*Coeff[Qq, x, q]) /; NeQ[p + m*q + 1, 0] && EqQ[(p + m*q + 1)*Coeff[Qq, x, q]*Pp, Coeff[Pp, x, p]* x^(p - q)*((p - q + 1)*Qq + (m + 1)*x*D[Qq, x])]] /; FreeQ[m, x] && PolyQ[Pp, x] && PolyQ[Qq, x] && NeQ[m, -1]
Int[x_^m_.*(a1_ + b1_.*x_^n_.)^p_*(a2_ + b2_.*x_^n_.)^p_, x_Symbol] := (a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*b1*b2*n*(p + 1)) /; FreeQ[{a1, b1, a2, b2, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && EqQ[m - 2*n + 1, 0] && NeQ[p, -1]
Int[Pp_*Qq_^m_.*Rr_^n_., x_Symbol] := With[{p = Expon[Pp, x], q = Expon[Qq, x], r = Expon[Rr, x]}, Coeff[Pp, x, p]*x^(p - q - r + 1)*Qq^(m + 1)* Rr^(n + 1)/((p + m*q + n*r + 1)*Coeff[Qq, x, q]* Coeff[Rr, x, r]) /; NeQ[p + m*q + n*r + 1, 0] && EqQ[(p + m*q + n*r + 1)*Coeff[Qq, x, q]*Coeff[Rr, x, r]*Pp, Coeff[Pp, x, p]* x^(p - q - r)*((p - q - r + 1)*Qq*Rr + (m + 1)*x*Rr* D[Qq, x] + (n + 1)*x*Qq*D[Rr, x])]] /; FreeQ[{m, n}, x] && PolyQ[Pp, x] && PolyQ[Qq, x] && PolyQ[Rr, x] && NeQ[m, -1] && NeQ[n, -1]
Int[Qr_*(a_. + b_.*Pq_^n_.)^p_., x_Symbol] := With[{q = Expon[Pq, x], r = Expon[Qr, x]}, Coeff[Qr, x, r]/(q*Coeff[Pq, x, q])* Subst[Int[(a + b*x^n)^p, x], x, Pq] /; EqQ[r, q - 1] && EqQ[Coeff[Qr, x, r]*D[Pq, x], q*Coeff[Pq, x, q]*Qr]] /; FreeQ[{a, b, n, p}, x] && PolyQ[Pq, x] && PolyQ[Qr, x]
Int[Qr_*(a_. + b_.*Pq_^n_. + c_.*Pq_^n2_.)^p_., x_Symbol] := Module[{q = Expon[Pq, x], r = Expon[Qr, x]}, Coeff[Qr, x, r]/(q*Coeff[Pq, x, q])* Subst[Int[(a + b*x^n + c*x^(2*n))^p, x], x, Pq] /; EqQ[r, q - 1] && EqQ[Coeff[Qr, x, r]*D[Pq, x], q*Coeff[Pq, x, q]*Qr]] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && PolyQ[Qr, x]
Int[u_.*(a_.*x_^p_. + b_.*x_^q_.)^n_., x_Symbol] := Int[u*x^(n*p)*(a + b*x^(q - p))^n, x] /; FreeQ[{a, b, p, q}, x] && IntegerQ[n] && PosQ[q - p]
Int[u_.*(a_.*x_^p_. + b_.*x_^q_. + c_.*x_^r_.)^n_., x_Symbol] := Int[u*x^(n*p)*(a + b*x^(q - p) + c*x^(r - p))^n, x] /; FreeQ[{a, b, c, p, q, r}, x] && IntegerQ[n] && PosQ[q - p] && PosQ[r - p]
(* Int[Sqrt[a_.+b_.*x_]*(A_.+B_.*x_)/(Sqrt[c_.+d_.*x_]*Sqrt[e_.+f_.*x_ ]*Sqrt[g_.+h_.*x_]),x_Symbol] := B*Sqrt[a+b*x]*Sqrt[e+f*x]*Sqrt[g+h*x]/(f*h*Sqrt[c+d*x]) - B*(b*g-a*h)/(2*f*h)*Int[Sqrt[e+f*x]/(Sqrt[a+b*x]*Sqrt[c+d*x]*Sqrt[g+ h*x]),x] + B*(d*e-c*f)*(d*g-c*h)/(2*d*f*h)*Int[Sqrt[a+b*x]/((c+d*x)^(3/2)*Sqrt[ e+f*x]*Sqrt[g+h*x]),x] /; FreeQ[{a,b,c,d,e,f,g,h,A,B},x] && EqQ[2*A*d*f-B*(d*e+c*f),0] *)
Int[Sqrt[ a_. + b_.*x_]*(A_. + B_.*x_)/(Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := b*B*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(d*f*h*Sqrt[a + b*x]) - B*(b*g - a*h)/(2*f*h)* Int[Sqrt[e + f*x]/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[g + h*x]), x] + B*(b*e - a*f)*(b*g - a*h)/(2*d*f*h)* Int[Sqrt[c + d*x]/((a + b*x)^(3/2)*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B}, x] && EqQ[2*A*d*f - B*(d*e + c*f), 0]
(* Int[Sqrt[a_.+b_.*x_]*(A_.+B_.*x_)/(Sqrt[c_.+d_.*x_]*Sqrt[e_.+f_.*x_ ]*Sqrt[g_.+h_.*x_]),x_Symbol] := (2*A*d*f-B*(d*e+c*f))/(2*d*f)*Int[Sqrt[a+b*x]/(Sqrt[c+d*x]*Sqrt[e+f* x]*Sqrt[g+h*x]),x] + B/(2*d*f)*Int[(Sqrt[a+b*x]*(d*e+c*f+2*d*f*x))/(Sqrt[c+d*x]*Sqrt[e+f* x]*Sqrt[g+h*x]),x] /; FreeQ[{a,b,c,d,e,f,g,h,A,B},x] && NeQ[2*A*d*f-B*(d*e+c*f),0] *)
Int[Sqrt[ a_. + b_.*x_]*(A_. + B_.*x_)/(Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := B*Sqrt[a + b*x]*Sqrt[e + f*x]*Sqrt[g + h*x]/(f*h*Sqrt[c + d*x]) + B*(d*e - c*f)*(d*g - c*h)/(2*d*f*h)* Int[Sqrt[a + b*x]/((c + d*x)^(3/2)*Sqrt[e + f*x]*Sqrt[g + h*x]), x] - B*(b*e - a*f)*(b*g - a*h)/(2*b*f*h)* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + (2*A*b*d*f*h + B*(a*d*f*h - b*(d*f*g + d*e*h + c*f*h)))/(2*b*d*f* h)*Int[Sqrt[ a + b*x]/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B}, x] && NeQ[2*A*d*f - B*(d*e + c*f), 0]
Int[(a_. + b_.*x_)^ m_.*(A_. + B_.*x_)/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := 1/(d*f*h*(2*m + 3))* Int[((a + b*x)^(m - 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]))* Simp[a*A*d*f*h*(2*m + 3) + (A*b + a*B)*d*f*h*(2*m + 3)*x + b*B*d*f*h*(2*m + 3)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B}, x] && IntegerQ[2*m] && GtQ[m, 0]
Int[(A_. + B_.*x_)/(Sqrt[a_. + b_.*x_]*Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := (A*b - a*B)/b* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + B/b* Int[Sqrt[a + b*x]/(Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x]), x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B}, x]
Int[(a_. + b_.*x_)^ m_*(A_. + B_.*x_)/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := (A*b^2 - a*b*B)*(a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/((m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h)) - 1/(2*(m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h))* Int[((a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[A*(2*a^2*d*f*h*(m + 1) - 2*a*b*(m + 1)*(d*f*g + d*e*h + c*f*h) + b^2*(2*m + 3)*(d*e*g + c*f*g + c*e*h)) - b*B*(a*(d*e*g + c*f*g + c*e*h) + 2*b*c*e*g*(m + 1)) - 2*((A*b - a*B)*(a*d*f*h*(m + 1) - b*(m + 2)*(d*f*g + d*e*h + c*f*h)))*x + d*f*h*(2*m + 5)*(A*b^2 - a*b*B)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B}, x] && IntegerQ[2*m] && LtQ[m, -1]
Int[(a_. + b_.*x_)^ m_.*(A_. + B_.*x_ + C_.*x_^2)/(Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := 2*C*(a + b*x)^m*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(d*f*h*(2*m + 3)) + 1/(d*f*h*(2*m + 3))* Int[((a + b*x)^(m - 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[a*A*d*f*h*(2*m + 3) - C*(a*(d*e*g + c*f*g + c*e*h) + 2*b*c*e*g*m) + ((A*b + a*B)*d*f*h*(2*m + 3) - C*(2*a*(d*f*g + d*e*h + c*f*h) + b*(2*m + 1)*(d*e*g + c*f*g + c*e*h)))*x + (b*B*d*f*h*(2*m + 3) + 2*C*(a*d*f*h*m - b*(m + 1)*(d*f*g + d*e*h + c*f*h)))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B, C}, x] && IntegerQ[2*m] && GtQ[m, 0]
Int[(a_. + b_.*x_)^ m_.*(A_. + C_.*x_^2)/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := 2*C*(a + b*x)^m*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/(d*f*h*(2*m + 3)) + 1/(d*f*h*(2*m + 3))* Int[((a + b*x)^(m - 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[a*A*d*f*h*(2*m + 3) - C*(a*(d*e*g + c*f*g + c*e*h) + 2*b*c*e*g*m) + (A*b*d*f*h*(2*m + 3) - C*(2*a*(d*f*g + d*e*h + c*f*h) + b*(2*m + 1)*(d*e*g + c*f*g + c*e*h)))*x + 2*C*(a*d*f*h*m - b*(m + 1)*(d*f*g + d*e*h + c*f*h))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, C}, x] && IntegerQ[2*m] && GtQ[m, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)/(Sqrt[a_. + b_.*x_]*Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := C*Sqrt[a + b*x]*Sqrt[e + f*x]*Sqrt[g + h*x]/(b*f*h*Sqrt[c + d*x]) + C*(d*e - c*f)*(d*g - c*h)/(2*b*d*f*h)* Int[Sqrt[a + b*x]/((c + d*x)^(3/2)*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + 1/(2*b*d*f*h)* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x])* Simp[2*A*b*d*f*h - C*(b*d*e*g + a*c*f*h) + (2*b*B*d*f*h - C*(a*d*f*h + b*(d*f*g + d*e*h + c*f*h)))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B, C}, x]
Int[(A_. + C_.*x_^2)/(Sqrt[a_. + b_.*x_]*Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := C*Sqrt[a + b*x]*Sqrt[e + f*x]*Sqrt[g + h*x]/(b*f*h*Sqrt[c + d*x]) + C*(d*e - c*f)*(d*g - c*h)/(2*b*d*f*h)* Int[Sqrt[a + b*x]/((c + d*x)^(3/2)*Sqrt[e + f*x]*Sqrt[g + h*x]), x] + 1/(2*b*d*f*h)* Int[1/(Sqrt[a + b*x]*Sqrt[c + d*x]*Sqrt[e + f*x]*Sqrt[g + h*x])* Simp[2*A*b*d*f*h - C*(b*d*e*g + a*c*f*h) - C*(a*d*f*h + b*(d*f*g + d*e*h + c*f*h))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, C}, x]
Int[(a_. + b_.*x_)^ m_*(A_. + B_.*x_ + C_.*x_^2)/(Sqrt[c_. + d_.*x_]* Sqrt[e_. + f_.*x_]*Sqrt[g_. + h_.*x_]), x_Symbol] := (A*b^2 - a*b*B + a^2*C)*(a + b*x)^(m + 1)*Sqrt[c + d*x]* Sqrt[e + f*x]* Sqrt[g + h*x]/((m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h)) - 1/(2*(m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h))* Int[((a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[A*(2*a^2*d*f*h*(m + 1) - 2*a*b*(m + 1)*(d*f*g + d*e*h + c*f*h) + b^2*(2*m + 3)*(d*e*g + c*f*g + c*e*h)) - (b*B - a*C)*(a*(d*e*g + c*f*g + c*e*h) + 2*b*c*e*g*(m + 1)) - 2*((A*b - a*B)*(a*d*f*h*(m + 1) - b*(m + 2)*(d*f*g + d*e*h + c*f*h)) - C*(a^2*(d*f*g + d*e*h + c*f*h) - b^2*c*e*g*(m + 1) + a*b*(m + 1)*(d*e*g + c*f*g + c*e*h)))*x + d*f*h*(2*m + 5)*(A*b^2 - a*b*B + a^2*C)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B, C}, x] && IntegerQ[2*m] && LtQ[m, -1]
Int[(a_. + b_.*x_)^ m_*(A_. + C_.*x_^2)/(Sqrt[c_. + d_.*x_]*Sqrt[e_. + f_.*x_]* Sqrt[g_. + h_.*x_]), x_Symbol] := (A*b^2 + a^2*C)*(a + b*x)^(m + 1)*Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]/((m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h)) - 1/(2*(m + 1)*(b*c - a*d)*(b*e - a*f)*(b*g - a*h))* Int[((a + b*x)^(m + 1)/(Sqrt[c + d*x]*Sqrt[e + f*x]* Sqrt[g + h*x]))* Simp[A*(2*a^2*d*f*h*(m + 1) - 2*a*b*(m + 1)*(d*f*g + d*e*h + c*f*h) + b^2*(2*m + 3)*(d*e*g + c*f*g + c*e*h)) + a*C*(a*(d*e*g + c*f*g + c*e*h) + 2*b*c*e*g*(m + 1)) - 2*(A*b*(a*d*f*h*(m + 1) - b*(m + 2)*(d*f*g + d*e*h + c*f*h)) - C*(a^2*(d*f*g + d*e*h + c*f*h) - b^2*c*e*g*(m + 1) + a*b*(m + 1)*(d*e*g + c*f*g + c*e*h)))*x + d*f*h*(2*m + 5)*(A*b^2 + a^2*C)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, A, C}, x] && IntegerQ[2*m] && LtQ[m, -1]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^ p_.*(g_. + h_.*x_)^q_., x_Symbol] := Int[ExpandIntegrand[ Px*(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q}, x] && PolyQ[Px, x] && IntegersQ[m, n]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^ p_.*(g_. + h_.*x_)^q_., x_Symbol] := PolynomialRemainder[Px, a + b*x, x]* Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q, x] + Int[ PolynomialQuotient[Px, a + b*x, x]*(a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^p*(g + h*x)^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q}, x] && PolyQ[Px, x] && EqQ[m, -1]
Int[Px_*(a_. + b_.*x_)^m_.*(c_. + d_.*x_)^n_.*(e_. + f_.*x_)^ p_.*(g_. + h_.*x_)^q_., x_Symbol] := PolynomialRemainder[Px, a + b*x, x]* Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q, x] + Int[ PolynomialQuotient[Px, a + b*x, x]*(a + b*x)^(m + 1)*(c + d*x)^ n*(e + f*x)^p*(g + h*x)^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q}, x] && PolyQ[Px, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.1 (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(b_.*x_^2)^p_,x_Symbol] :=
  b^IntPart[p]*(b*x^2)^FracPart[p]/x^(2*FracPart[p]) \[Star] Int[x^(2*p),x] /;
FreeQ[{b,p},x]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(3/2),x_Symbol] :=
  x/(a*Sqrt[a+b*x^2]) /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_,x_Symbol] :=
  -x*(a+b*x^2)^(p+1)/(2*a*(p+1)) +
  (2*p+3)/(2*a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b},x] && ILtQ[p+3/2,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p,x],x] /;
FreeQ[{a,b},x] && IGtQ[p,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_,x_Symbol] :=
  x*(a+b*x^2)^p/(2*p+1) +
  2*a*p/(2*p+1) \[Star] Int[(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b},x] && GtQ[p,0] && (IntegerQ[4*p] || IntegerQ[6*p])


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(5/4),x_Symbol] :=
  2/(a^(5/4)*Rt[b/a,2])*EllipticE[1/2*ArcTan[Rt[b/a,2]*x],2] /;
FreeQ[{a,b},x] && GtQ[a,0] && PosQ[b/a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(5/4),x_Symbol] :=
  (1+b*x^2/a)^(1/4)/(a*(a+b*x^2)^(1/4)) \[Star] Int[1/(1+b*x^2/a)^(5/4),x] /;
FreeQ[{a,b},x] && PosQ[a] && PosQ[b/a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(7/6),x_Symbol] :=
  1/((a +b*x^2)^(2/3)*(a/(a+b*x^2))^(2/3)) \[Star] Subst[Int[1/(1-b*x^2)^(1/3),x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_,x_Symbol] :=
  -x*(a+b*x^2)^(p+1)/(2*a*(p+1)) +
  (2*p+3)/(2*a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b},x] && LtQ[p,-1] && (IntegerQ[4*p] || IntegerQ[6*p])


(* ::Code:: *)
Int[1/(a_+b_.*x_^2),x_Symbol] :=
  1/(Rt[a,2]*Rt[b,2])*ArcTan[Rt[b,2]*x/Rt[a,2]] /;
FreeQ[{a,b},x] && PosQ[a/b] && (GtQ[a,0] || GtQ[b,0])


(* ::Code:: *)
Int[1/(a_+b_.*x_^2),x_Symbol] :=
  -1/(Rt[-a,2]*Rt[-b,2])*ArcTan[Rt[-b,2]*x/Rt[-a,2]] /;
FreeQ[{a,b},x] && PosQ[a/b] && (LtQ[a,0] || LtQ[b,0])


(* ::Code:: *)
Int[1/(a_+b_.*x_^2),x_Symbol] :=
(*Rt[b/a,2]/b*ArcTan[Rt[b/a,2]*x] /; *)
  Rt[a/b,2]/a*ArcTan[x/Rt[a/b,2]] /;
FreeQ[{a,b},x] && PosQ[a/b]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2),x_Symbol] :=
  1/(Rt[a,2]*Rt[-b,2])*ArcTanh[Rt[-b,2]*x/Rt[a,2]] /;
FreeQ[{a,b},x] && NegQ[a/b] && (GtQ[a,0] || LtQ[b,0])


(* ::Code:: *)
Int[1/(a_+b_.*x_^2),x_Symbol] :=
  -1/(Rt[-a,2]*Rt[b,2])*ArcTanh[Rt[b,2]*x/Rt[-a,2]] /;
FreeQ[{a,b},x] && NegQ[a/b] && (LtQ[a,0] || GtQ[b,0])


(* ::Code:: *)
Int[1/(a_+b_.*x_^2),x_Symbol] :=
(*-Rt[-b/a,2]/b*ArcTanh[Rt[-b/a,2]*x] /; *)
  Rt[-a/b,2]/a*ArcTanh[x/Rt[-a/b,2]] /;
FreeQ[{a,b},x] && NegQ[a/b]


(* ::Code:: *)
Int[1/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  ArcSinh[Rt[b,2]*x/Sqrt[a]]/Rt[b,2] /;
FreeQ[{a,b},x] && GtQ[a,0] && PosQ[b]


(* ::Code:: *)
Int[1/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  ArcSin[Rt[-b,2]*x/Sqrt[a]]/Rt[-b,2] /;
FreeQ[{a,b},x] && GtQ[a,0] && NegQ[b]


(* ::Code:: *)
Int[1/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  Subst[Int[1/(1-b*x^2),x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b},x] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(1/4),x_Symbol] :=
  2*x/(a+b*x^2)^(1/4) - a \[Star] Int[1/(a+b*x^2)^(5/4),x] /;
FreeQ[{a,b},x] && GtQ[a,0] && PosQ[b/a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(1/4),x_Symbol] :=
  2/(a^(1/4)*Rt[-b/a,2])*EllipticE[1/2*ArcSin[Rt[-b/a,2]*x],2] /;
FreeQ[{a,b},x] && GtQ[a,0] && NegQ[b/a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(1/4),x_Symbol] :=
  (1+b*x^2/a)^(1/4)/(a+b*x^2)^(1/4) \[Star] Int[1/(1+b*x^2/a)^(1/4),x] /;
FreeQ[{a,b},x] && PosQ[a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(1/4),x_Symbol] :=
  2*Sqrt[-b*x^2/a]/(b*x) \[Star] Subst[Int[x^2/Sqrt[1-x^4/a],x],x,(a+b*x^2)^(1/4)] /;
FreeQ[{a,b},x] && NegQ[a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(3/4),x_Symbol] :=
  2/(a^(3/4)*Rt[b/a,2])*EllipticF[1/2*ArcTan[Rt[b/a,2]*x],2] /;
FreeQ[{a,b},x] && GtQ[a,0] && PosQ[b/a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(3/4),x_Symbol] :=
  2/(a^(3/4)*Rt[-b/a,2])*EllipticF[1/2*ArcSin[Rt[-b/a,2]*x],2] /;
FreeQ[{a,b},x] && GtQ[a,0] && NegQ[b/a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(3/4),x_Symbol] :=
  (1+b*x^2/a)^(3/4)/(a+b*x^2)^(3/4) \[Star] Int[1/(1+b*x^2/a)^(3/4),x] /;
FreeQ[{a,b},x] && PosQ[a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(3/4),x_Symbol] :=
  2*Sqrt[-b*x^2/a]/(b*x) \[Star] Subst[Int[1/Sqrt[1-x^4/a],x],x,(a+b*x^2)^(1/4)] /;
FreeQ[{a,b},x] && NegQ[a]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(1/3),x_Symbol] :=
  3*Sqrt[b*x^2]/(2*b*x) \[Star] Subst[Int[x/Sqrt[-a+x^3],x],x,(a+b*x^2)^(1/3)] /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(2/3),x_Symbol] :=
  3*Sqrt[b*x^2]/(2*b*x) \[Star] Subst[Int[1/Sqrt[-a+x^3],x],x,(a+b*x^2)^(1/3)] /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(1/6),x_Symbol] :=
  3*x/(2*(a+b*x^2)^(1/6)) - a/2 \[Star] Int[1/(a+b*x^2)^(7/6),x] /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[1/(a_+b_.*x_^2)^(5/6),x_Symbol] :=
  1/((a/(a+b*x^2))^(1/3)*(a+b*x^2)^(1/3)) \[Star] Subst[Int[1/(1-b*x^2)^(2/3),x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^p*x*Hypergeometric2F1[-p,1/2,1/2+1,-b*x^2/a] /;
FreeQ[{a,b,p},x] && Not[IntegerQ[2*p]] && GtQ[a,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^IntPart[p]*(a+b*x^2)^FracPart[p]/(1+b*x^2/a)^FracPart[p] \[Star] Int[(1+b*x^2/a)^p,x] /;
FreeQ[{a,b,p},x] && Not[IntegerQ[2*p]] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[(a_.+b_.*v_^n_)^p_,x_Symbol] :=
  1/Coefficient[v,x,1] \[Star] Subst[Int[(a+b*x^n)^p,x],x,v] /;
FreeQ[{a,b,n,p},x] && LinearQ[v,x] && NeQ[v,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.10 P(x) (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[Pq*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b},x] && PolyQ[Pq,x] && IGtQ[p,-2]


(* ::Code:: *)
Int[Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[x*PolynomialQuotient[Pq,x,x]*(a+b*x^2)^p,x] /;
FreeQ[{a,b,p},x] && PolyQ[Pq,x] && EqQ[Coeff[Pq,x,0],0] && Not[MatchQ[Pq,x^m_.*u_. /; IntegerQ[m]]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,a+b*x^2,x]*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,p},x] && PolyQ[Px,x] && EqQ[PolynomialRemainder[Px,a+b*x^2,x],0]


(* ::Code:: *)
Int[Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{A=Coeff[Pq,x,0],Q=PolynomialQuotient[Pq-Coeff[Pq,x,0],x^2,x]},
  A*x*(a+b*x^2)^(p+1)/a + 1/a \[Star] Int[x^2*(a+b*x^2)^p*(a*Q-A*b*(2*p+3)),x]] /;
FreeQ[{a,b},x] && PolyQ[Pq,x^2] && ILtQ[p+1/2,0] && LtQ[Expon[Pq,x]+2*p+1,0]


(* ::Code:: *)
Int[Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[Pq,a+b*x^2,x],
        f=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,0],
        g=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,1]},
  (a*g-b*f*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*Q+f*(2*p+3),x],x]] /;
FreeQ[{a,b},x] && PolyQ[Pq,x] && LtQ[p,-1]


(* ::Code:: *)
Int[Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],e=Coeff[Pq,x,Expon[Pq,x]]},
  e*x^(q-1)*(a+b*x^2)^(p+1)/(b*(q+2*p+1)) + 
  1/(b*(q+2*p+1)) \[Star] Int[(a+b*x^2)^p*ExpandToSum[b*(q+2*p+1)*Pq-a*e*(q-1)*x^(q-2)-b*e*(q+2*p+1)*x^q,x],x]] /;
FreeQ[{a,b,p},x] && PolyQ[Pq,x] && Not[LeQ[p,-1]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.11 P(x) (c x)^m (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[x_^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  1/2 \[Star] Subst[Int[x^((m-1)/2)*SubstFor[x^2,Pq,x]*(a+b*x)^p,x],x,x^2] /;
FreeQ[{a,b,p},x] && PolyQ[Pq,x^2] && IntegerQ[(m-1)/2]


(* ::Code:: *)
Int[(c_.*x_)^m_.*P2_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{f=Coeff[P2,x,0],g=Coeff[P2,x,1],h=Coeff[P2,x,2]},
  h*(c*x)^(m+1)*(a+b*x^2)^(p+1)/(b*c*(m+2*p+3)) /;
 EqQ[g,0] && EqQ[a*h*(m+1)-b*f*(m+2*p+3),0]] /;
FreeQ[{a,b,c,m,p},x] && PolyQ[P2,x,2] && NeQ[m,-1]


(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(c*x)^m*Pq*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,m},x] && PolyQ[Pq,x] && IGtQ[p,-2]


(* ::Code:: *)
Int[x_^m_*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{A=Coeff[Pq,x,0],Q=PolynomialQuotient[Pq-Coeff[Pq,x,0],x^2,x]},
  A*x^(m+1)*(a+b*x^2)^(p+1)/(a*(m+1)) + 
  1/(a*(m+1)) \[Star] Int[x^(m+2)*(a+b*x^2)^p*(a*(m+1)*Q-A*b*(m+2*(p+1)+1)),x]] /;
FreeQ[{a,b},x] && PolyQ[Pq,x^2] && IntegerQ[m/2] && ILtQ[(m+1)/2+p,0] && LtQ[m+Expon[Pq,x]+2*p+1,0]


(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[Pq,a+b*x^2,x],
        f=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,0],
        g=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,1]},
  (c*x)^m*(a+b*x^2)^(p+1)*(a*g-b*f*x)/(2*a*b*(p+1)) + 
  c/(2*a*b*(p+1)) \[Star] Int[(c*x)^(m-1)*(a+b*x^2)^(p+1)*ExpandToSum[2*a*b*(p+1)*x*Q-a*g*m+b*f*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c},x] && PolyQ[Pq,x] && LtQ[p,-1] && GtQ[m,0]


(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(c*x)^m*Pq,a+b*x^2,x],
        f=Coeff[PolynomialRemainder[(c*x)^m*Pq,a+b*x^2,x],x,0],
        g=Coeff[PolynomialRemainder[(c*x)^m*Pq,a+b*x^2,x],x,1]},
  (a*g-b*f*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(c*x)^m*(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*(c*x)^(-m)*Q+f*(2*p+3)*(c*x)^(-m),x],x]] /;
FreeQ[{a,b,c},x] && PolyQ[Pq,x] && LtQ[p,-1] && ILtQ[m,0]


(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[Pq,a+b*x^2,x],
        f=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,0],
        g=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,1]},
  -(c*x)^(m+1)*(f+g*x)*(a+b*x^2)^(p+1)/(2*a*c*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(c*x)^m*(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*Q+f*(m+2*p+3)+g*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,b,c,m},x] && PolyQ[Pq,x] && LtQ[p,-1] && Not[GtQ[m,0]]


(* ::Code:: *)
Int[(c_.*x_)^m_*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[Pq,c*x,x], R=PolynomialRemainder[Pq,c*x,x]},
  R*(c*x)^(m+1)*(a+b*x^2)^(p+1)/(a*c*(m+1)) + 
  1/(a*c*(m+1)) \[Star] Int[(c*x)^(m+1)*(a+b*x^2)^p*ExpandToSum[a*c*(m+1)*Q-b*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,p},x] && PolyQ[Pq,x] && LtQ[m,-1] && (IntegerQ[2*p] || NeQ[Expon[Pq,x],1])


(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Expon[Pq,x]},
  Coeff[Pq,x,q]/c^q \[Star] Int[(c*x)^(m+q)*(a+b*x^2)^p,x] + 
  1/c^q \[Star] Int[(c*x)^m*(a+b*x^2)^p*ExpandToSum[c^q*Pq-Coeff[Pq,x,q]*(c*x)^q,x],x] /;
 EqQ[q,1] || EqQ[m+q+2*p+1,0]] /;
FreeQ[{a,b,c,m,p},x] && PolyQ[Pq,x] && Not[IGtQ[m,0] && ILtQ[p+1/2,0]]


(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(c*x)^(m+q-1)*(a+b*x^2)^(p+1)/(b*c^(q-1)*(m+q+2*p+1)) + 
  1/(b*(m+q+2*p+1)) \[Star] Int[(c*x)^m*(a+b*x^2)^p*ExpandToSum[b*(m+q+2*p+1)*Pq-b*f*(m+q+2*p+1)*x^q-a*f*(m+q-1)*x^(q-2),x],x] /;
 GtQ[q,1] && NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,b,c,m,p},x] && PolyQ[Pq,x] && (Not[IGtQ[m,0]] || IGtQ[p+1/2,-1])




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.12 P(x) (c+d x)^n (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[(d+e*x)^(m+1)*PolynomialQuotient[Pq,d+e*x,x]*(a+b*x^2)^p,x] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[PolynomialRemainder[Pq,d+e*x,x],0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*P2_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{f=Coeff[P2,x,0],g=Coeff[P2,x,1],h=Coeff[P2,x,2]},
  h*(d+e*x)^(m+1)*(a+b*x^2)^(p+1)/(b*e*(m+2*p+3)) /;
 EqQ[2*d*h*(p+1)-e*g*(m+2*p+3),0] && EqQ[a*h*(m+1)-b*f*(m+2*p+3),0]] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[P2,x,2] && NeQ[m+2*p+3,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*Pq*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,d,e,m},x] && PolyQ[Pq,x] && IGtQ[p,-2]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  d*e \[Star] Int[(d+e*x)^(m-1)*PolynomialQuotient[Pq,a*e+b*d*x,x]*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[b*d^2+a*e^2,0] && EqQ[PolynomialRemainder[Pq,a*e+b*d*x,x],0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a*e+b*d*x,x], R=PolynomialRemainder[Pq,a*e+b*d*x,x]},
  -d*R*(d+e*x)^m*(a+b*x^2)^(p+1)/(2*a*e*(p+1)) + 
  d/(2*a*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x^2)^(p+1)*ExpandToSum[2*a*e*(p+1)*Qx+R*(m+2*p+2),x],x]] /;
FreeQ[{a,b,d,e},x] && PolyQ[Pq,x] && EqQ[b*d^2+a*e^2,0] && ILtQ[p+1/2,0] && GtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p,(d+e*x)^m*Pq,x],x] /;
FreeQ[{a,b,d,e},x] && PolyQ[Pq,x] && EqQ[b*d^2+a*e^2,0] && EqQ[m+Expon[Pq,x]+2*p+1,0] && ILtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(d+e*x)^(m+q-1)*(a+b*x^2)^(p+1)/(b*e^(q-1)*(m+q+2*p+1)) + 
  1/(b*e^q*(m+q+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x^2)^p*
    ExpandToSum[b*e^q*(m+q+2*p+1)*Pq-b*f*(m+q+2*p+1)*(d+e*x)^q-2*e*f*(m+p+q)*(d+e*x)^(q-2)*(a*e-b*d*x),x],x] /;
 NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[b*d^2+a*e^2,0] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[(d+e*x)^(m+p)*(a/d+b/e*x)^p*Pq,x] /;
FreeQ[{a,b,d,e,m},x] && PolyQ[Pq,x] && EqQ[b*d^2+a*e^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^FracPart[p]/((d+e*x)^FracPart[p]*(a/d+(b*x)/e)^FracPart[p]) \[Star] Int[(d+e*x)^(m+p)*(a/d+b/e*x)^p*Pq,x] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[b*d^2+a*e^2,0] && Not[IntegerQ[p]] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a+b*x^2,x],
        R=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,1]},
  (d+e*x)^m*(a+b*x^2)^(p+1)*(a*S-b*R*x)/(2*a*b*(p+1)) + 
  1/(2*a*b*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x^2)^(p+1)*
    ExpandToSum[2*a*b*(p+1)*(d+e*x)*Qx-a*e*S*m+b*d*R*(2*p+3)+b*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,d,e},x] && PolyQ[Pq,x] && NeQ[b*d^2+a*e^2,0] && LtQ[p,-1] && GtQ[m,0] && 
  Not[IGtQ[m,0] && RationalQ[a,b,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(d+e*x)^m*Pq,a+b*x^2,x],
        R=Coeff[PolynomialRemainder[(d+e*x)^m*Pq,a+b*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(d+e*x)^m*Pq,a+b*x^2,x],x,1]},
  (a*S-b*R*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*b*(p+1)) \[Star] Int[(d+e*x)^m*(a+b*x^2)^(p+1)*
    ExpandToSum[2*a*b*(p+1)*(d+e*x)^(-m)*Qx+b*R*(2*p+3)*(d+e*x)^(-m),x],x]] /;
FreeQ[{a,b,d,e},x] && PolyQ[Pq,x] && NeQ[b*d^2+a*e^2,0] && LtQ[p,-1] && ILtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a+b*x^2,x],
        R=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[Pq,a+b*x^2,x],x,1]},
  -(d+e*x)^(m+1)*(a+b*x^2)^(p+1)*(a*(e*R-d*S)+(b*d*R+a*e*S)*x)/(2*a*(p+1)*(b*d^2+a*e^2)) + 
  1/(2*a*(p+1)*(b*d^2+a*e^2)) \[Star] Int[(d+e*x)^m*(a+b*x^2)^(p+1)*
   ExpandToSum[2*a*(p+1)*(b*d^2+a*e^2)*Qx+b*d^2*R*(2*p+3)-a*e*(d*S*m-e*R*(m+2*p+3))+e*(b*d*R+a*e*S)*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,b,d,e,m},x] && PolyQ[Pq,x] && NeQ[b*d^2+a*e^2,0] && LtQ[p,-1] && 
  Not[IGtQ[m,0] && RationalQ[a,b,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,d+e*x,x], R=PolynomialRemainder[Pq,d+e*x,x]},
  e*R*(d+e*x)^(m+1)*(a+b*x^2)^(p+1)/((m+1)*(b*d^2+a*e^2)) + 
  1/((m+1)*(b*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x^2)^p*
     ExpandToSum[(m+1)*(b*d^2+a*e^2)*Qx+b*d*R*(m+1)-b*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,d,e,p},x] && PolyQ[Pq,x] && NeQ[b*d^2+a*e^2,0] && LtQ[m,-1]


(* ::Code:: *)
Int[x_^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Module[{q=Expon[Pq,x],k},
  Int[x^m*Sum[Coeff[Pq,x,2*k]*x^(2*k),{k,0,q/2}]*(a+b*x^2)^p,x] + 
  Int[x^(m+1)*Sum[Coeff[Pq,x,2*k+1]*x^(2*k),{k,0,(q-1)/2}]*(a+b*x^2)^p,x]] /;
FreeQ[{a,b,p},x] && PolyQ[Pq,x] && Not[PolyQ[Pq,x^2]] && IGtQ[m,-2] && Not[IntegerQ[2*p]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(d+e*x)^(m+q-1)*(a+b*x^2)^(p+1)/(b*e^(q-1)*(m+q+2*p+1)) + 
  1/(b*e^q*(m+q+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x^2)^p*
    ExpandToSum[b*e^q*(m+q+2*p+1)*Pq-b*f*(m+q+2*p+1)*(d+e*x)^q-f*(d+e*x)^(q-2)*(a*e^2*(m+q-1)-b*d^2*(m+q+2*p+1)-2*b*d*e*(m+q+p)*x),x],x] /;
 GtQ[q,1] && NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b*d^2+a*e^2,0] && Not[EqQ[d,0] && True] && 
  Not[IGtQ[m,0] && RationalQ[a,b,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Expon[Pq,x]},
  Coeff[Pq,x,q]/e^q \[Star] Int[(d+e*x)^(m+q)*(a+b*x^2)^p,x] + 
  1/e^q \[Star] Int[(d+e*x)^m*(a+b*x^2)^p*ExpandToSum[e^q*Pq-Coeff[Pq,x,q]*(d+e*x)^q,x],x]] /;
FreeQ[{a,b,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b*d^2+a*e^2,0] && 
  Not[IGtQ[m,0] && RationalQ[a,b,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.13 P(x) (e x)^m (c+d x)^n (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Px_*(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,c+d*x,x]*(e*x)^m*(c+d*x)^(n+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && PolynomialQ[Px,x] && EqQ[PolynomialRemainder[Px,c+d*x,x],0]


(* ::Code:: *)
Int[Px_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_./x_,x_Symbol] :=
  Int[PolynomialQuotient[Px,x,x]*(c+d*x)^n*(a+b*x^2)^p,x] + 
  PolynomialRemainder[Px,x,x] \[Star] Int[(c+d*x)^n*(a+b*x^2)^p/x,x]/;
FreeQ[{a,b,c,d,n,p},x] && PolynomialQ[Px,x]


(* ::Code:: *)
Int[(e_.*x_)^m_*Px_/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{Px0=Coefficient[Px,x,0]},
  Px0*(e*x)^(m+1)*Sqrt[c+d*x]*Sqrt[a+b*x^2]/(a*c*e*(m+1)) + 
  1/(2*a*c*e*(m+1)) \[Star] Int[(e*x)^(m+1)/(Sqrt[c+d*x]*Sqrt[a+b*x^2])*
    ExpandToSum[2*a*c*(m+1)*((Px-Px0)/x)-Px0*(a*d*(2*m+3)+2*b*c*(m+2)*x+b*d*(2*m+5)*x^2),x],x]]/;
FreeQ[{a,b,c,d,e},x] && PolynomialQ[Px,x] && LtQ[m,-1]


(* ::Code:: *)
Int[Px_*(e_.*x_)^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[Px*(e*x)^m*(c+d*x)^n*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && PolyQ[Px,x] && (IntegerQ[p] || IntegerQ[2*p] && IntegerQ[m] && ILtQ[n,0])


(* ::Code:: *)
Int[Px_*(e_.*x_)^m_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{k=Denominator[m]},
  k/e \[Star] Subst[Int[ReplaceAll[Px,x->x^k/e]*x^(k*(m+1)-1)*(c+d*x^k/e)^n*(a+b*x^(2*k)/e^2)^p,x],x,(e*x)^(1/k)]] /;
FreeQ[{a,b,c,d,e,n,p},x] && PolyQ[Px,x] && FractionQ[m]


(* ::Code:: *)
Int[Px_*(e_.*x_)^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,c+d*x,x]*(e*x)^m*(c+d*x)^(n+1)*(a+b*x^2)^p,x] + 
  PolynomialRemainder[Px,c+d*x,x] \[Star] Int[(e*x)^m*(c+d*x)^n*(a+b*x^2)^p,x]/;
FreeQ[{a,b,c,d,e,m,p},x] && PolynomialQ[Px,x] && LtQ[n,0]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.14 P(x) (c+d x)^m (e+f x)^n (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Px_*(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,c+d*x,x]*(c+d*x)^(m+1)*(e+f*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && PolynomialQ[Px,x] && EqQ[PolynomialRemainder[Px,c+d*x,x],0]


(* ::Code:: *)
Int[Px_*(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[Px*(c+d*x)^m*(e+f*x)^n*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && PolyQ[Px,x] && (IntegerQ[p] || IntegerQ[2*p] && IntegerQ[m] && ILtQ[n,0]) && Not[IGtQ[m,0] && IGtQ[n,0]]


(* ::Code:: *)
Int[Px_*(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,c+d*x,x]*(c+d*x)^(m+1)*(e+f*x)^n*(a+b*x^2)^p,x] + 
  PolynomialRemainder[Px,c+d*x,x] \[Star] Int[(c+d*x)^m*(e+f*x)^n*(a+b*x^2)^p,x]/;
FreeQ[{a,b,c,d,e,f,n,p},x] && PolynomialQ[Px,x] && LtQ[m,0] && Not[IntegerQ[n]] && IntegersQ[2*m,2*n,2*p]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.2 (c x)^m (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[x_/(a_+b_.*x_^2),x_Symbol] :=
  Log[RemoveContent[a+b*x^2,x]]/(2*b) /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[x_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^(p+1)/(2*b*(p+1)) /;
FreeQ[{a,b,p},x] && NeQ[p,-1]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c*x)^(m+1)*(a+b*x^2)^(p+1)/(a*c*(m+1)) /;
FreeQ[{a,b,c,m,p},x] && EqQ[m+2*p+3,0] && NeQ[m,-1]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  1/2 \[Star] Subst[Int[x^((m-1)/2)*(a+b*x)^p,x],x,x^2] /;
FreeQ[{a,b,m,p},x] && IntegerQ[(m-1)/2]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(c*x)^m*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,m},x] && IGtQ[p,0]


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  x^(m+1)*(a+b*x^2)^(p+1)/(a*(m+1)) - 
  b*(m+2*(p+1)+1)/(a*(m+1)) \[Star] Int[x^(m+2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,m,p},x] && ILtQ[Simplify[(m+1)/2+p+1],0] && NeQ[m,-1]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(c*x)^(m+1)*(a+b*x^2)^(p+1)/(a*c*2*(p+1)) +
  (m+2*p+3)/(a*2*(p+1)) \[Star] Int[(c*x)^m*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,m,p},x] && ILtQ[Simplify[(m+1)/2+p+1],0] && NeQ[p,-1]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c*x)^(m+1)*(a+b*x^2)^p/(c*(m+1)) - 
  2*b*p/(c^2*(m+1)) \[Star] Int[(c*x)^(m+2)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c},x] && GtQ[p,0] && LtQ[m,-1] && Not[ILtQ[(m+2*p+3)/2,0]] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c*x)^(m+1)*(a+b*x^2)^p/(c*(m+2*p+1)) +
  2*a*p/(m+2*p+1) \[Star] Int[(c*x)^m*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,m},x] && GtQ[p,0] && NeQ[m+2*p+1,0] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[Sqrt[c_.*x_]/(a_+b_.*x_^2)^(5/4),x_Symbol] :=
  Sqrt[c*x]*(1+a/(b*x^2))^(1/4)/(b*(a+b*x^2)^(1/4)) \[Star] Int[1/(x^2*(1+a/(b*x^2))^(5/4)),x] /;
FreeQ[{a,b,c},x] && PosQ[b/a]


(* ::Code:: *)
Int[(c_.*x_)^m_/(a_+b_.*x_^2)^(5/4),x_Symbol] :=
  2*c*(c*x)^(m-1)/(b*(2*m-3)*(a+b*x^2)^(1/4)) - 2*a*c^2*(m-1)/(b*(2*m-3)) \[Star] Int[(c*x)^(m-2)/(a+b*x^2)^(5/4),x] /;
FreeQ[{a,b,c},x] && PosQ[b/a] && IntegerQ[2*m] && GtQ[m,3/2] 


(* ::Code:: *)
Int[(c_.*x_)^m_/(a_+b_.*x_^2)^(5/4),x_Symbol] :=
  (c*x)^(m+1)/(a*c*(m+1)*(a+b*x^2)^(1/4)) - b*(2*m+1)/(2*a*c^2*(m+1)) \[Star] Int[(c*x)^(m+2)/(a+b*x^2)^(5/4),x] /;
FreeQ[{a,b,c},x] && PosQ[b/a] && IntegerQ[2*m] && LtQ[m,-1]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c*(c*x)^(m-1)*(a+b*x^2)^(p+1)/(2*b*(p+1)) -
  c^2*(m-1)/(2*b*(p+1)) \[Star] Int[(c*x)^(m-2)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c},x] && LtQ[p,-1] && GtQ[m,1] && Not[ILtQ[(m+2*p+3)/2,0]] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(c*x)^(m+1)*(a+b*x^2)^(p+1)/(2*a*c*(p+1)) +
  (m+2*p+3)/(2*a*(p+1)) \[Star] Int[(c*x)^m*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,m},x] && LtQ[p,-1] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[x_^m_/(a_+b_.*x_^2),x_Symbol] :=
  Int[PolynomialDivide[x^m,(a+b*x^2),x],x] /;
FreeQ[{a,b},x] && IGtQ[m,3]


(* ::Code:: *)
Int[Sqrt[c_*x_]/(a_+b_.*x_^2)^(1/4),x_Symbol] :=
  x*Sqrt[c*x]/(a+b*x^2)^(1/4) - a/2 \[Star] Int[Sqrt[c*x]/(a+b*x^2)^(5/4),x] /;
FreeQ[{a,b,c},x] && PosQ[b/a]


(* ::Code:: *)
Int[Sqrt[c_*x_]/(a_+b_.*x_^2)^(1/4),x_Symbol] :=
  c*(a+b*x^2)^(3/4)/(b*Sqrt[c*x]) + a*c^2/(2*b) \[Star] Int[1/((c*x)^(3/2)*(a+b*x^2)^(1/4)),x] /;
FreeQ[{a,b,c},x] && NegQ[b/a]


(* ::Code:: *)
Int[1/((c_.*x_)^(3/2)*(a_+b_.*x_^2)^(1/4)),x_Symbol] :=
  -2/(c*Sqrt[c*x]*(a+b*x^2)^(1/4)) - b/c^2 \[Star] Int[Sqrt[c*x]/(a+b*x^2)^(5/4),x] /;
FreeQ[{a,b,c},x] && PosQ[b/a]


(* ::Code:: *)
Int[1/((c_.*x_)^(3/2)*(a_+b_.*x_^2)^(1/4)),x_Symbol] :=
  Sqrt[c*x]*(1+a/(b*x^2))^(1/4)/(c^2*(a+b*x^2)^(1/4)) \[Star] Int[1/(x^2*(1+a/(b*x^2))^(1/4)),x] /;
FreeQ[{a,b,c},x] && NegQ[b/a]


(* ::Code:: *)
Int[Sqrt[x_]/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  -2/(Sqrt[a]*(-b/a)^(3/4)) \[Star] Subst[Int[Sqrt[1-2*x^2]/Sqrt[1-x^2],x],x,Sqrt[1-Sqrt[-b/a]*x]/Sqrt[2]] /;
FreeQ[{a,b},x] && GtQ[-b/a,0] && GtQ[a,0]


(* ::Code:: *)
Int[Sqrt[x_]/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  Sqrt[1+b*x^2/a]/Sqrt[a+b*x^2] \[Star] Int[Sqrt[x]/Sqrt[1+b*x^2/a],x] /;
FreeQ[{a,b},x] && GtQ[-b/a,0] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[Sqrt[c_*x_]/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  Sqrt[c*x]/Sqrt[x] \[Star] Int[Sqrt[x]/Sqrt[a+b*x^2],x] /;
FreeQ[{a,b,c},x] && GtQ[-b/a,0]


(* ::Code:: *)
Int[(c_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c*(c*x)^(m-1)*(a+b*x^2)^(p+1)/(b*(m+2*p+1)) -
  a*c^2*(m-1)/(b*(m+2*p+1)) \[Star] Int[(c*x)^(m-2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,p},x] && GtQ[m,2-1] && NeQ[m+2*p+1,0] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[(c_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c*(c*x)^(m-1)*(a+b*x^2)^(p+1)/(b*(m+2*p+1)) -
  a*c^2*(m-1)/(b*(m+2*p+1)) \[Star] Int[(c*x)^(m-2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,m,p},x] && SumSimplerQ[m,-2] && NeQ[m+2*p+1,0] && ILtQ[Simplify[(m+1)/2+p],0]


(* ::Code:: *)
Int[(c_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c*x)^(m+1)*(a+b*x^2)^(p+1)/(a*c*(m+1)) -
  b*(m+2*p+3)/(a*c^2*(m+1)) \[Star] Int[(c*x)^(m+2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,p},x] && LtQ[m,-1] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[(c_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c*x)^(m+1)*(a+b*x^2)^(p+1)/(a*c*(m+1)) -
  b*(m+2*p+3)/(a*c^2*(m+1)) \[Star] Int[(c*x)^(m+2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,m,p},x] && SumSimplerQ[m,2] && ILtQ[Simplify[(m+1)/2+p],0]


(* ::Code:: *)
Int[(c_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{k=Denominator[m]},
  k/c \[Star] Subst[Int[x^(k*(m+1)-1)*(a+b*x^(2*k)/c^2)^p,x],x,(c*x)^(1/k)]] /;
FreeQ[{a,b,c,p},x] && FractionQ[m] && IntBinomialQ[a,b,c,2,m,p,x]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^(p+(m+1)/2) \[Star] Subst[Int[x^m/(1-b*x^2)^(p+(m+1)/2+1),x],x,x/(a+b*x^2)^(1/2)] /;
FreeQ[{a,b},x] && LtQ[-1,p,0] && NeQ[p,-1/2] && IntegersQ[m,p+(m+1)/2]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a/(a+b*x^2))^(p+(m+1)/2)*(a+b*x^2)^(p+(m+1)/2) \[Star] Subst[Int[x^m/(1-b*x^2)^(p+(m+1)/2+1),x],x,x/(a+b*x^2)^(1/2)] /;
FreeQ[{a,b},x] && LtQ[-1,p,0] && NeQ[p,-1/2] && IntegerQ[m] && LtQ[Denominator[p+(m+1)/2],Denominator[p]]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  x^(m+1)*(a+b*x^2)^p/(m+1) - 
  2*b*p/(m+1) \[Star] Int[x^(m+2)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,m},x] && EqQ[(m+1)/2+p,0] && GtQ[p,0]


(* ::Code:: *)
Int[(c_*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m] \[Star] Int[x^m*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,m},x] && EqQ[(m+1)/2+p,0] && GtQ[p,0]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c*x)^(m+1)*(a+b*x^2)^p/(c*(m+2*p+1)) +
  2*a*p/(m+2*p+1) \[Star] Int[(c*x)^m*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,m},x] && IntegerQ[p+Simplify[(m+1)/2]] && GtQ[p,0] && NeQ[m+2*p+1,0]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{k=Denominator[p]},
  k*a^(p+Simplify[(m+1)/2])/2 \[Star] 
    Subst[Int[x^(k*Simplify[(m+1)/2]-1)/(1-b*x^k)^(p+Simplify[(m+1)/2]+1),x],x,x^(2/k)/(a+b*x^2)^(1/k)]] /;
FreeQ[{a,b,m},x] && IntegerQ[p+Simplify[(m+1)/2]] && LtQ[-1,p,0]


(* ::Code:: *)
Int[(c_*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m] \[Star] Int[x^m*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,m},x] && IntegerQ[p+Simplify[(m+1)/2]] && LtQ[-1,p,0]


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(c*x)^(m+1)*(a+b*x^2)^(p+1)/(a*c*2*(p+1)) +
  (m+2*(p+1)+1)/(a*2*(p+1)) \[Star] Int[(c*x)^m*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,m},x] && IntegerQ[p+Simplify[(m+1)/2]] && LtQ[p,-1]


(* ::Code:: *)
Int[x_^m_./(a_+b_.*x_^2),x_Symbol] :=
  x^(m-1)/(b*(m-1)) -
  a/b \[Star] Int[x^(m-2)/(a+b*x^2),x] /;
FreeQ[{a,b,m},x] && FractionQ[(m+1)/2] && SumSimplerQ[m,-2]


(* ::Code:: *)
Int[x_^m_/(a_+b_.*x_^2),x_Symbol] :=
  x^(m+1)/(a*(m+1)) -
  b/a \[Star] Int[x^Simplify[m+2]/(a+b*x^2),x] /;
FreeQ[{a,b,m},x] && FractionQ[(m+1)/2] && SumSimplerQ[m,2]


(* ::Code:: *)
Int[(c_*x_)^m_/(a_+b_.*x_^2),x_Symbol] :=
  c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m] \[Star] Int[x^m/(a+b*x^2),x] /;
FreeQ[{a,b,c,m},x] && FractionQ[(m+1)/2] && (SumSimplerQ[m,2] || SumSimplerQ[m,-2])


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^p*(c*x)^(m+1)/(c*(m+1))*Hypergeometric2F1[-p,(m+1)/2,(m+1)/2+1,-b*x^2/a] /;
FreeQ[{a,b,c,m,p},x] && Not[IGtQ[p,0]] && (ILtQ[p,0] || GtQ[a,0])


(* ::Code:: *)
Int[(c_.*x_)^m_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^IntPart[p]*(a+b*x^2)^FracPart[p]/(1+b*x^2/a)^FracPart[p] \[Star] Int[(c*x)^m*(1+b*x^2/a)^p,x] /;
FreeQ[{a,b,c,m,p},x] && Not[IGtQ[p,0]] && Not[ILtQ[p,0] || GtQ[a,0]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.3 (a+b x^2)^p (c+d x^2)^q.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_.*(b_.*x_^n_)^p_*(d_.*x_^n_)^q_,x_Symbol] :=
  b^IntPart[p]*d^IntPart[q]*(b*x^n)^FracPart[p]*(d*x^n)^FracPart[q]/x^(n*(FracPart[p]+FracPart[q])) \[Star] Int[u*x^(n*(p+q)),x] /;
FreeQ[{b,d,n,p,q},x]


(* ::Code:: *)
Int[u_.*(a_+b_.*x_^n_)^p_.*(c_+d_.*x_^n_)^q_.,x_Symbol] :=
  (b/d)^p \[Star] Int[u*(c+d*x^n)^(p+q),x] /;
FreeQ[{a,b,c,d,n,p,q},x] && EqQ[b*c-a*d,0] && IntegerQ[p] && Not[IntegerQ[q] && SimplerQ[a+b*x^n,c+d*x^n]]


(* ::Code:: *)
Int[u_.*(a_+b_.*x_^n_)^p_*(c_+d_.*x_^n_)^q_,x_Symbol] :=
  (b/d)^p \[Star] Int[u*(c+d*x^n)^(p+q),x] /;
FreeQ[{a,b,c,d,n,p,q},x] && EqQ[b*c-a*d,0] && GtQ[b/d,0] && Not[SimplerQ[a+b*x^n,c+d*x^n]]


(* ::Code:: *)
Int[u_.*(a_+b_.*x_^n_)^p_*(c_+d_.*x_^n_)^q_,x_Symbol] :=
  (a+b*x^n)^p/(c+d*x^n)^p \[Star] Int[u*(c+d*x^n)^(p+q),x] /;
FreeQ[{a,b,c,d,n,p,q},x] && EqQ[b*c-a*d,0] && Not[SimplerQ[a+b*x^n,c+d*x^n]]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^p_.,x_Symbol] :=
  Int[(a*c+b*d*x^4)^p,x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c+a*d,0] && (IntegerQ[p] || GtQ[a,0] && GtQ[c,0])


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  x*(a+b*x^2)^p*(c+d*x^2)^p/(4*p+1) + 
  4*a*c*p/(4*p+1) \[Star] Int[(a+b*x^2)^(p-1)*(c+d*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c+a*d,0] && GtQ[p,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  -x*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1)/(4*a*c*(p+1)) + 
  (4*p+5)/(4*a*c*(p+1)) \[Star] Int[(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c+a*d,0] && LtQ[p,-1]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  1/Sqrt[2*a*d]*EllipticF[ArcSin[Sqrt[2*d]*x/Sqrt[c+d*x^2]],1/2] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c+a*d,0] && GtQ[a,0] && GtQ[d,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (c+d*x^2)^FracPart[p]/((-1)^IntPart[p]*(-c-d*x^2)^FracPart[p]) \[Star] Int[(-a*c-b*d*x^4)^p,x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c+a*d,0] && GtQ[a,0] && LtQ[c,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^FracPart[p]*(c+d*x^2)^FracPart[p]/(a*c+b*d*x^4)^FracPart[p] \[Star] Int[(a*c+b*d*x^4)^p,x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c+a*d,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p*(c+d*x^2)^q,x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && IGtQ[p,0] && IGtQ[q,0]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*(c_+d_.*x_^2)),x_Symbol] :=
  Subst[Int[1/(c-(b*c-a*d)*x^2),x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  -x*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(2*a*(p+1)) - 
  c*q/(a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1),x] /;
FreeQ[{a,b,c,d,p},x] && NeQ[b*c-a*d,0] && EqQ[2*(p+q+1)+1,0] && GtQ[q,0] && NeQ[p,-1]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  a^p*x/(c^(p+1)*Sqrt[c+d*x^2])*Hypergeometric2F1[1/2,-p,3/2,-(b*c-a*d)*x^2/(a*(c+d*x^2))] /;
FreeQ[{a,b,c,d,q},x] && NeQ[b*c-a*d,0] && EqQ[2*(p+q+1)+1,0] && ILtQ[p,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  x*(a+b*x^2)^p/(c*(c*(a+b*x^2)/(a*(c+d*x^2)))^p*(c+d*x^2)^(1/2+p))*
    Hypergeometric2F1[1/2,-p,3/2,-(b*c-a*d)*x^2/(a*(c+d*x^2))] /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0] && EqQ[2*(p+q+1)+1,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  x*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*c) /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0] && EqQ[2*(p+q+2)+1,0] && EqQ[a*d*(p+1)+b*c*(q+1),0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -b*x*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(2*a*(p+1)*(b*c-a*d)) + 
  (b*c+2*(p+1)*(b*c-a*d))/(2*a*(p+1)*(b*c-a*d)) \[Star] Int[(a+b*x^2)^(p+1)*(c+d*x^2)^q,x] /;
FreeQ[{a,b,c,d,q},x] && NeQ[b*c-a*d,0] && EqQ[2*(p+q+2)+1,0] && (LtQ[p,-1] || Not[LtQ[q,-1]]) && NeQ[p,-1]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2),x_Symbol] :=
  c*x*(a+b*x^2)^(p+1)/a /;
FreeQ[{a,b,c,d,p},x] && NeQ[b*c-a*d,0] && EqQ[a*d-b*c*(2*p+3),0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2),x_Symbol] :=
  -(b*c-a*d)*x*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) - 
  (a*d-b*c*(2*p+3))/(2*a*b*(p+1)) \[Star] Int[(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,p},x] && NeQ[b*c-a*d,0] && (LtQ[p,-1] || ILtQ[1/2+p,0])


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2),x_Symbol] :=
  d*x*(a+b*x^2)^(p+1)/(b*(2*p+3)) - 
  (a*d-b*c*(2*p+3))/(b*(2*p+3)) \[Star] Int[(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && NeQ[2*p+3,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  Int[PolynomialDivide[(a+b*x^2)^p,(c+d*x^2)^(-q),x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && IGtQ[p,0] && ILtQ[q,0] && GeQ[p,-q]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_./(c_+d_.*x_^2),x_Symbol] :=
  b/d \[Star] Int[(a+b*x^2)^(p-1),x] - (b*c-a*d)/d \[Star] Int[(a+b*x^2)^(p-1)/(c+d*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && GtQ[p,0] && (EqQ[p,1/2] || EqQ[Denominator[p],4] || EqQ[p,2/3] && EqQ[b*c+3*a*d,0])


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_/(c_+d_.*x_^2),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[(a+b*x^2)^p,x] - d/(b*c-a*d) \[Star] Int[(a+b*x^2)^(p+1)/(c+d*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && EqQ[Denominator[p],4] && (EqQ[p,-5/4] || EqQ[p,-7/4])


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)*(c_+d_.*x_^2)),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[1/(a+b*x^2),x] - d/(b*c-a*d) \[Star] Int[1/(c+d*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/3)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[b/a,2]},
  q*ArcTanh[Sqrt[3]/(q*x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) + 
  q*ArcTanh[Sqrt[3]*(a^(1/3)-2^(1/3)*(a+b*x^2)^(1/3))/(a^(1/3)*q*x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) + 
  q*ArcTan[q*x]/(6*2^(2/3)*a^(1/3)*d) - 
  q*ArcTan[(a^(1/3)*q*x)/(a^(1/3)+2^(1/3)*(a+b*x^2)^(1/3))]/(2*2^(2/3)*a^(1/3)*d)] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && EqQ[b*c+3*a*d,0] && PosQ[b/a]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/3)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  q*ArcTan[Sqrt[3]/(q*x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) + 
  q*ArcTan[Sqrt[3]*(a^(1/3)-2^(1/3)*(a+b*x^2)^(1/3))/(a^(1/3)*q*x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) - 
  q*ArcTanh[q*x]/(6*2^(2/3)*a^(1/3)*d) + 
  q*ArcTanh[(a^(1/3)*q*x)/(a^(1/3)+2^(1/3)*(a+b*x^2)^(1/3))]/(2*2^(2/3)*a^(1/3)*d)] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && EqQ[b*c+3*a*d,0] && NegQ[b/a]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/3)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[b/a,2]},
  q*ArcTan[q*x/3]/(12*Rt[a,3]*d) +  
  q*ArcTan[(Rt[a,3]-(a+b*x^2)^(1/3))^2/(3*Rt[a,3]^2*q*x)]/(12*Rt[a,3]*d) - 
  q*ArcTanh[(Sqrt[3]*(Rt[a,3]-(a+b*x^2)^(1/3)))/(Rt[a,3]*q*x)]/(4*Sqrt[3]*Rt[a,3]*d)] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && EqQ[b*c-9*a*d,0] && PosQ[b/a]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/3)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  -q*ArcTanh[q*x/3]/(12*Rt[a,3]*d) +  
  q*ArcTanh[(Rt[a,3]-(a+b*x^2)^(1/3))^2/(3*Rt[a,3]^2*q*x)]/(12*Rt[a,3]*d) - 
  q*ArcTan[(Sqrt[3]*(Rt[a,3]-(a+b*x^2)^(1/3)))/(Rt[a,3]*q*x)]/(4*Sqrt[3]*Rt[a,3]*d)] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && EqQ[b*c-9*a*d,0] && NegQ[b/a]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[b^2/a,4]},
  -b/(2*a*d*q)*ArcTan[(b+q^2*Sqrt[a+b*x^2])/(q^3*x*(a+b*x^2)^(1/4))] - 
  b/(2*a*d*q)*ArcTanh[(b-q^2*Sqrt[a+b*x^2])/(q^3*x*(a+b*x^2)^(1/4))]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && PosQ[b^2/a]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[-b^2/a,4]},
  b/(2*Sqrt[2]*a*d*q)*ArcTan[q*x/(Sqrt[2]*(a+b*x^2)^(1/4))] + 
  b/(2*Sqrt[2]*a*d*q)*ArcTanh[q*x/(Sqrt[2]*(a+b*x^2)^(1/4))]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && NegQ[b^2/a]


(* ::Code:: *)
(* Int[1/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] :=
  With[{q=Rt[-b^2/a,4]},
  b/(2*Sqrt[2]*a*d*q)*ArcTan[q*x/(Sqrt[2]*(a+b*x^2)^(1/4))] + 
  b/(4*Sqrt[2]*a*d*q)*Log[(Sqrt[2]*q*x+2*(a+b*x^2)^(1/4))/(Sqrt[2]*q*x-2*(a+b*x^2)^(1/4))]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && NegQ[b^2/a] *)


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] :=
  2*Sqrt[-b*x^2/a]/x \[Star] Subst[Int[x^2/(Sqrt[1-x^4/a]*(b*c-a*d+d*x^4)),x],x,(a+b*x^2)^(1/4)] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(3/4)*(c_+d_.*x_^2)),x_Symbol] :=
  1/c \[Star] Int[1/(a+b*x^2)^(3/4),x] - d/c \[Star] Int[x^2/((a+b*x^2)^(3/4)*(c+d*x^2)),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^(3/4)*(c_+d_.*x_^2)),x_Symbol] :=
  Sqrt[-b*x^2/a]/(2*x) \[Star] Subst[Int[1/(Sqrt[-b*x/a]*(a+b*x)^(3/4)*(c+d*x)),x],x,x^2] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/(c_+d_.*x_^2)^(3/2),x_Symbol] :=
  Sqrt[a+b*x^2]/(c*Rt[d/c,2]*Sqrt[c+d*x^2]*Sqrt[c*(a+b*x^2)/(a*(c+d*x^2))])*EllipticE[ArcTan[Rt[d/c,2]*x],1-b*c/(a*d)] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a] && PosQ[d/c]


(* ::Code:: *)
(* Int[Sqrt[a_+b_.*x_^2]/(c_+d_.*x_^2)^(3/2),x_Symbol] :=
  a*Sqrt[c+d*x^2]*Sqrt[(c*(a+b*x^2))/(a*(c+d*x^2))]/(c^2*Rt[d/c,2]*Sqrt[a+b*x^2])*EllipticE[ArcTan[Rt[d/c,2]*x],1-b*c/(a*d)] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a] && PosQ[d/c] *)


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -x*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(2*a*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*Simp[c*(2*p+3)+d*(2*(p+q+1)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && LtQ[0,q,1] && IntBinomialQ[a,b,c,d,2,p,q,x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  (a*d-c*b)*x*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(2*a*b*(p+1)) - 
  1/(2*a*b*(p+1)) \[Star] 
    Int[(a+b*x^2)^(p+1)*(c+d*x^2)^(q-2)*Simp[c*(a*d-c*b*(2*p+3))+d*(a*d*(2*(q-1)+1)-b*c*(2*(p+q)+1))*x^2,x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && GtQ[q,1] && IntBinomialQ[a,b,c,d,2,p,q,x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -b*x*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(2*a*(p+1)*(b*c-a*d)) + 
  1/(2*a*(p+1)*(b*c-a*d)) \[Star] 
    Int[(a+b*x^2)^(p+1)*(c+d*x^2)^q*Simp[b*c+2*(p+1)*(b*c-a*d)+d*b*(2*(p+q+2)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,q},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && Not[Not[IntegerQ[p]] && IntegerQ[q] && LtQ[q,-1]] && 
  IntBinomialQ[a,b,c,d,2,p,q,x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p*(c+d*x^2)^q,x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && IntegersQ[p,q] && GtQ[p+q,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  d*x*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(b*(2*(p+q)+1)) + 
  1/(b*(2*(p+q)+1)) \[Star] 
    Int[(a+b*x^2)^p*(c+d*x^2)^(q-2)*Simp[c*(b*c*(2*(p+q)+1)-a*d)+d*(b*c*(2*(p+2*q-1)+1)-a*d*(2*(q-1)+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,p},x] && NeQ[b*c-a*d,0] && GtQ[q,1] && NeQ[2*(p+q)+1,0] && Not[IGtQ[p,1]] && IntBinomialQ[a,b,c,d,2,p,q,x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  x*(a+b*x^2)^p*(c+d*x^2)^q/(2*(p+q)+1) + 
  2/(2*(p+q)+1) \[Star] Int[(a+b*x^2)^(p-1)*(c+d*x^2)^(q-1)*Simp[a*c*(p+q)+(q*(b*c-a*d)+a*d*(p+q))*x^2,x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && GtQ[q,0] && GtQ[p,0] && IntBinomialQ[a,b,c,d,2,p,q,x]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  Sqrt[a+b*x^2]/(a*Rt[d/c,2]*Sqrt[c+d*x^2]*Sqrt[c*(a+b*x^2)/(a*(c+d*x^2))])*EllipticF[ArcTan[Rt[d/c,2]*x],1-b*c/(a*d)] /;
FreeQ[{a,b,c,d},x] && PosQ[d/c] && PosQ[b/a] && Not[SimplerSqrtQ[b/a,d/c]]


(* ::Code:: *)
(* Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  Sqrt[c+d*x^2]*Sqrt[c*(a+b*x^2)/(a*(c+d*x^2))]/(c*Rt[d/c,2]*Sqrt[a+b*x^2])*EllipticF[ArcTan[Rt[d/c,2]*x],1-b*c/(a*d)] /;
FreeQ[{a,b,c,d},x] && PosQ[d/c] && PosQ[b/a] && Not[SimplerSqrtQ[b/a,d/c]] *)


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  1/(Sqrt[a]*Sqrt[c]*Rt[-d/c,2])*EllipticF[ArcSin[Rt[-d/c,2]*x],b*c/(a*d)] /;
FreeQ[{a,b,c,d},x] && NegQ[d/c] && GtQ[c,0] && GtQ[a,0] && Not[NegQ[b/a] && SimplerSqrtQ[-b/a,-d/c]]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  -1/(Sqrt[c]*Rt[-d/c,2]*Sqrt[a-b*c/d])*EllipticF[ArcCos[Rt[-d/c,2]*x],b*c/(b*c-a*d)] /;
FreeQ[{a,b,c,d},x] && NegQ[d/c] && GtQ[c,0] && GtQ[a-b*c/d,0]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  Sqrt[1+d/c*x^2]/Sqrt[c+d*x^2] \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[1+d/c*x^2]),x] /;
FreeQ[{a,b,c,d},x] && Not[GtQ[c,0]]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  a \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] + b \[Star] Int[x^2/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d},x] && PosQ[d/c] && PosQ[b/a]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  x*Sqrt[a+b*x^2]/Sqrt[c+d*x^2] + Sqrt[-2*a]*x/Sqrt[d*x^2]*EllipticE[ArcSin[Sqrt[2*c]/Sqrt[c+d*x^2]],1/2] /;
FreeQ[{a,b,c,d},x] && PosQ[d/c] && EqQ[b*c+a*d,0] && LtQ[a,0] && GtQ[c,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  b/d \[Star] Int[Sqrt[c+d*x^2]/Sqrt[a+b*x^2],x] - (b*c-a*d)/d \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d},x] && PosQ[d/c] && NegQ[b/a]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  Sqrt[a]/(Sqrt[c]*Rt[-d/c,2])*EllipticE[ArcSin[Rt[-d/c,2]*x],b*c/(a*d)] /;
FreeQ[{a,b,c,d},x] && NegQ[d/c] && GtQ[c,0] && GtQ[a,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  -Sqrt[a-b*c/d]/(Sqrt[c]*Rt[-d/c,2])*EllipticE[ArcCos[Rt[-d/c,2]*x],b*c/(b*c-a*d)] /;
FreeQ[{a,b,c,d},x] && NegQ[d/c] && GtQ[c,0] && GtQ[a-b*c/d,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  a*Sqrt[1-b^2*x^4/a^2]/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]) \[Star] Int[Sqrt[1+b*x^2/a]/Sqrt[1-b*x^2/a],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c+a*d,0] && Not[LtQ[a*c,0] && GtQ[a*b,0]]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  Sqrt[a+b*x^2]/Sqrt[1+b/a*x^2] \[Star] Int[Sqrt[1+b/a*x^2]/Sqrt[c+d*x^2],x] /;
FreeQ[{a,b,c,d},x] && NegQ[d/c] && GtQ[c,0] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/Sqrt[c_+d_.*x_^2],x_Symbol] :=
  Sqrt[1+d/c*x^2]/Sqrt[c+d*x^2] \[Star] Int[Sqrt[a+b*x^2]/Sqrt[1+d/c*x^2],x] /;
FreeQ[{a,b,c,d},x] && NegQ[d/c] && Not[GtQ[c,0]]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p*(c+d*x^2)^q,x],x] /;
FreeQ[{a,b,c,d,q},x] && NeQ[b*c-a*d,0] && IGtQ[p,0]


(* ::Code:: *)
(* Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  Sqrt[x^2]/(2*x) \[Star] Subst[Int[(a+b*x)^p*(c+d*x)^q/Sqrt[x],x],x,x^2] /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0] *)


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  a^p*c^q*x*AppellF1[1/2,-p,-q,3/2,-b*x^2/a,-d*x^2/c] /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0] && (IntegerQ[p] || GtQ[a,0]) && (IntegerQ[q] || GtQ[c,0])


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  a^IntPart[p]*(a+b*x^2)^FracPart[p]/(1+b*x^2/a)^FracPart[p] \[Star] Int[(1+b*x^2/a)^p*(c+d*x^2)^q,x] /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0] && Not[IntegerQ[p] || GtQ[a,0]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.4 (e x)^m (a+b x^2)^p (c+d x^2)^q.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^p_.,x_Symbol] :=
  Int[(e*x)^m*(a*c+b*d*x^4)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && EqQ[b*c+a*d,0] && (IntegerQ[p] || GtQ[a,0] && GtQ[c,0])


(* ::Code:: *)
Int[x_^3*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^(p+1)*(c+d*x^2)^(p+1)/(4*b*d*(p+1)) /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c+a*d,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  -(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1)/(4*a*c*e*(p+1)) /;
FreeQ[{a,b,c,d,e,m,p},x] && EqQ[b*c+a*d,0] && EqQ[m+4*p+5,0]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  1/2 \[Star] Subst[Int[x^((m-1)/2)*(a+b*x)^p*(c+d*x)^p,x],x,x^2] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c+a*d,0] && IntegerQ[(m-1)/2]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^p*(c+d*x^2)^p/(e*(m+1)) - 
  4*b*d*p/(e^4*(m+1)) \[Star] Int[(e*x)^(m+4)*(a+b*x^2)^(p-1)*(c+d*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[b*c+a*d,0] && GtQ[p,0] && LtQ[m,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^p*(c+d*x^2)^p/(e*(m+4*p+1)) + 
  4*a*c*p/(m+4*p+1) \[Star] Int[(e*x)^m*(a+b*x^2)^(p-1)*(c+d*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[b*c+a*d,0] && GtQ[p,0] && NeQ[m+4*p+1,0] && IntegerQ[2*m]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  e^3*(e*x)^(m-3)*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1)/(4*b*d*(p+1)) - 
  e^4*(m-3)/(4*b*d*(p+1)) \[Star] Int[(e*x)^(m-4)*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[b*c+a*d,0] && LtQ[p,-1] && GtQ[m,3]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  -(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1)/(4*a*c*e*(p+1)) + 
  (m+4*p+5)/(4*a*c*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[b*c+a*d,0] && LtQ[p,-1] && IntegerQ[2*m]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(p+1)/(a*c*e*(m+1)) - 
  b*d*(m+4*p+5)/(a*c*e^4*(m+1)) \[Star] Int[(e*x)^(m+4)*(a+b*x^2)^p*(c+d*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,p},x] && EqQ[b*c+a*d,0] && LtQ[m,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^FracPart[p]*(c+d*x^2)^FracPart[p]/(a*c+b*d*x^4)^FracPart[p] \[Star] Int[(e*x)^m*(a*c+b*d*x^4)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && EqQ[b*c+a*d,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[x_^m_.*(b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  1/(2*b^((m-1)/2)) \[Star] Subst[Int[(b*x)^(p+(m-1)/2)*(c+d*x)^q,x],x,x^2] /;
FreeQ[{b,c,d,m,p,q},x] && IntegerQ[(m-1)/2]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(b_.*x_^2.)^p_*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  e^m*b^IntPart[p]*(b*x^2)^FracPart[p]/x^(2*FracPart[p]) \[Star] Int[x^(m+2*p)*(c+d*x^2)^q,x] /;
FreeQ[{b,c,d,e,m,p,q},x] && (IntegerQ[m] || GtQ[e,0])


(* ::Code:: *)
Int[(e_*x_)^m_*(b_.*x_^2.)^p_*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m] \[Star] Int[x^m*(b*x^2)^p*(c+d*x^2)^q,x] /;
FreeQ[{b,c,d,e,m,p,q},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[x_/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] :=
  -1/(Sqrt[2]*Rt[a,4]*d)*ArcTan[(Rt[a,4]^2-Sqrt[a+b*x^2])/(Sqrt[2]*Rt[a,4]*(a+b*x^2)^(1/4))] - 
  1/(Sqrt[2]*Rt[a,4]*d)*ArcTanh[(Rt[a,4]^2+Sqrt[a+b*x^2])/(Sqrt[2]*Rt[a,4]*(a+b*x^2)^(1/4))] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && PosQ[a]


(* ::Code:: *)
Int[x_^m_/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] :=
  Int[ExpandIntegrand[x^m/((a+b*x^2)^(1/4)*(c+d*x^2)),x],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && IntegerQ[m] && (PosQ[a] || IntegerQ[m/2])


(* ::Code:: *)
Int[x_^2/((a_+b_.*x_^2)^(3/4)*(c_+d_.*x_^2)),x_Symbol] :=
  -b/(a*d*Rt[b^2/a,4]^3)*ArcTan[(b+Rt[b^2/a,4]^2*Sqrt[a+b*x^2])/(Rt[b^2/a,4]^3*x*(a+b*x^2)^(1/4))] + 
  b/(a*d*Rt[b^2/a,4]^3)*ArcTanh[(b-Rt[b^2/a,4]^2*Sqrt[a+b*x^2])/(Rt[b^2/a,4]^3*x*(a+b*x^2)^(1/4))] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && PosQ[b^2/a]


(* ::Code:: *)
Int[x_^2/((a_+b_.*x_^2)^(3/4)*(c_+d_.*x_^2)),x_Symbol] :=
  -b/(Sqrt[2]*a*d*Rt[-b^2/a,4]^3)*ArcTan[(Rt[-b^2/a,4]*x)/(Sqrt[2]*(a+b*x^2)^(1/4))] + 
  b/(Sqrt[2]*a*d*Rt[-b^2/a,4]^3)*ArcTanh[(Rt[-b^2/a,4]*x)/(Sqrt[2]*(a+b*x^2)^(1/4))] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && NegQ[b^2/a]


(* ::Code:: *)
Int[x_^m_/((a_+b_.*x_^2)^(3/4)*(c_+d_.*x_^2)),x_Symbol] :=
  Int[ExpandIntegrand[x^m/((a+b*x^2)^(3/4)*(c+d*x^2)),x],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && IntegerQ[m] && (PosQ[a] || IntegerQ[m/2])


(* ::Code:: *)
Int[x_*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  1/2 \[Star] Subst[Int[(a+b*x)^p*(c+d*x)^q,x],x,x^2] /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  1/2 \[Star] Subst[Int[x^((m-1)/2)*(a+b*x)^p*(c+d*x)^q,x],x,x^2] /;
FreeQ[{a,b,c,d,p,q},x] && NeQ[b*c-a*d,0] && IntegerQ[(m-1)/2]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  Int[ExpandIntegrand[(e*x)^m*(a+b*x^2)^p*(c+d*x^2)^q,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && IGtQ[p,0] && IGtQ[q,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2),x_Symbol] :=
  c*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(a*e*(m+1)) /;
FreeQ[{a,b,c,d,e,m,p},x] && NeQ[b*c-a*d,0] && EqQ[a*d*(m+1)-b*c*(m+2*p+3),0] && NeQ[m,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2),x_Symbol] :=
  (b*c-a*d)*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(a*b*e*(m+1)) + d/b \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e},x] && NeQ[b*c-a*d,0] && EqQ[m+2*p+3,0] && LtQ[p,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2),x_Symbol] :=
  c*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(a*e*(m+1)) + d/e^2 \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && NeQ[b*c-a*d,0] && EqQ[Simplify[m+2*p+3],0] && NeQ[m,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2),x_Symbol] :=
  c*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(a*e*(m+1)) + 
  (a*d*(m+1)-b*c*(m+2*p+3))/(a*e^2*(m+1)) \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,p},x] && NeQ[b*c-a*d,0] && LtQ[m,-1] && Not[ILtQ[p,-1]]


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2),x_Symbol] :=
  (-a)^(m/2-1)*(b*c-a*d)*x*(a+b*x^2)^(p+1)/(2*b^(m/2+1)*(p+1)) + 
  1/(2*b^(m/2+1)*(p+1)) \[Star] Int[(a+b*x^2)^(p+1)*
    ExpandToSum[2*b*(p+1)*x^2*Together[(b^(m/2)*x^(m-2)*(c+d*x^2)-(-a)^(m/2-1)*(b*c-a*d))/(a+b*x^2)]-(-a)^(m/2-1)*(b*c-a*d),x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && IGtQ[m/2,0] && (IntegerQ[p] || EqQ[m+2*p+1,0])


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2),x_Symbol] :=
  (-a)^(m/2-1)*(b*c-a*d)*x*(a+b*x^2)^(p+1)/(2*b^(m/2+1)*(p+1)) + 
  1/(2*b^(m/2+1)*(p+1)) \[Star] Int[x^m*(a+b*x^2)^(p+1)*
    ExpandToSum[2*b*(p+1)*Together[(b^(m/2)*(c+d*x^2)-(-a)^(m/2-1)*(b*c-a*d)*x^(-m+2))/(a+b*x^2)]-
      (-a)^(m/2-1)*(b*c-a*d)*x^(-m),x],x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && ILtQ[m/2,0] && (IntegerQ[p] || EqQ[m+2*p+1,0])


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2),x_Symbol] :=
  -(b*c-a*d)*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(2*a*b*e*(p+1)) - 
  (a*d*(m+1)-b*c*(m+2*p+3))/(2*a*b*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && 
  (Not[IntegerQ[p+1/2]] && NeQ[p,-5/4] || Not[RationalQ[m]] || ILtQ[p+1/2,0] && LeQ[-1,m,-2*(p+1)])


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2),x_Symbol] :=
  d*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(b*e*(m+2*p+3)) - 
  (a*d*(m+1)-b*c*(m+2*p+3))/(b*(m+2*p+3)) \[Star] Int[(e*x)^m*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && NeQ[b*c-a*d,0] && NeQ[m+2*p+3,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_/(c_+d_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(e*x)^m*(a+b*x^2)^p/(c+d*x^2),x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && IGtQ[p,0] && (IntegerQ[m] || IGtQ[2*(m+1),0] || Not[RationalQ[m]])


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^2,x_Symbol] :=
  c^2*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(a*e*(m+1)) - 
  1/(a*e^2*(m+1)) \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^p*Simp[2*b*c^2*(p+1)+c*(b*c-2*a*d)*(m+1)-a*d^2*(m+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,p},x] && NeQ[b*c-a*d,0] && LtQ[m,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^2,x_Symbol] :=
  -(b*c-a*d)^2*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(2*a*b^2*e*(p+1)) + 
  1/(2*a*b^2*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*Simp[(b*c-a*d)^2*(m+1)+2*b^2*c^2*(p+1)+2*a*b*d^2*(p+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LtQ[p,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^2,x_Symbol] :=
  d^2*(e*x)^(m+3)*(a+b*x^2)^(p+1)/(b*e^3*(m+2*p+5)) + 
  1/(b*(m+2*p+5)) \[Star] Int[(e*x)^m*(a+b*x^2)^p*Simp[b*c^2*(m+2*p+5)-d*(a*d*(m+3)-2*b*c*(m+2*p+5))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m,p},x] && NeQ[b*c-a*d,0] && NeQ[m+2*p+5,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  With[{k=Denominator[m]},
  k/e \[Star] Subst[Int[x^(k*(m+1)-1)*(a+b*x^(k*2)/e^2)^p*(c+d*x^(k*2)/e^2)^q,x],x,(e*x)^(1/k)]] /;
FreeQ[{a,b,c,d,e,p,q},x] && NeQ[b*c-a*d,0] && FractionQ[m] && IntegerQ[p]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  e*(e*x)^(m-1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(2*b*(p+1)) - 
  e^2/(2*b*(p+1)) \[Star] Int[(e*x)^(m-2)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*Simp[c*(m-1)+d*(m+2*q-1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && GtQ[q,0] && GtQ[m,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -(b*c-a*d)*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(2*a*b*e*(p+1)) + 
  1/(2*a*b*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-2)*
    Simp[c*(2*b*c*(p+1)+(b*c-a*d)*(m+1))+d*(2*b*c*(p+1)+(b*c-a*d)*(m+2*q-1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && GtQ[q,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(2*a*e*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*Simp[c*(m+2*p+3)+d*(m+2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && LtQ[0,q,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -a*e^3*(e*x)^(m-3)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(2*b*(b*c-a*d)*(p+1)) + 
  e^4/(2*b*(b*c-a*d)*(p+1)) \[Star] Int[(e*x)^(m-4)*(a+b*x^2)^(p+1)*(c+d*x^2)^q*
    Simp[a*c*(m-3)+(a*d*(m+2*q-1)+2*b*c*(p+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,q},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && GtQ[m,3] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  e*(e*x)^(m-1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(2*(b*c-a*d)*(p+1)) - 
  e^2/(2*(b*c-a*d)*(p+1)) \[Star] Int[(e*x)^(m-2)*(a+b*x^2)^(p+1)*(c+d*x^2)^q*Simp[c*(m-1)+d*(m+2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,q},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && GtQ[m,1] && LeQ[m,3] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -b*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(2*a*e*(b*c-a*d)*(p+1)) + 
  1/(2*a*(b*c-a*d)*(p+1)) \[Star] 
    Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^q*Simp[b*c*(m+1)+2*(b*c-a*d)*(p+1)+b*d*(m+2*p+2*q+5)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m,q},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^p*(c+d*x^2)^q/(e*(m+1)) - 
  2/(e^2*(m+1)) \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^(p-1)*(c+d*x^2)^(q-1)*Simp[b*c*p+a*d*q+b*d*(p+q)*x^2,x],x] /;
FreeQ[{a,b,c,d,e},x] && NeQ[b*c-a*d,0] && GtQ[q,0] && LtQ[m,-1] && GtQ[p,0] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  c*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(a*e*(m+1)) - 
  1/(a*e^2*(m+1)) \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^(q-2)*
    Simp[c*(b*c-a*d)*(m+1)+2*c*(b*c*(p+1)+a*d*(q-1))+d*((b*c-a*d)*(m+1)+2*b*c*(p+q))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,p},x] && NeQ[b*c-a*d,0] && GtQ[q,1] && LtQ[m,-1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(a*e*(m+1)) - 
  1/(a*e^2*(m+1)) \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^(q-1)*
    Simp[b*c*(m+1)+2*(b*c*(p+1)+a*d*q)+d*(b*(m+1)+2*b*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,p},x] && NeQ[b*c-a*d,0] && LtQ[0,q,1] && LtQ[m,-1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^p*(c+d*x^2)^q/(e*(m+2*(p+q)+1)) + 
  2/(m+2*(p+q)+1) \[Star] Int[(e*x)^m*(a+b*x^2)^(p-1)*(c+d*x^2)^(q-1)*Simp[a*c*(p+q)+(q*(b*c-a*d)+a*d*(p+q))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && GtQ[q,0] && GtQ[p,0] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  d*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(b*e*(m+2*(p+q)+1)) + 
  1/(b*(m+2*(p+q)+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^p*(c+d*x^2)^(q-2)*
    Simp[c*((b*c-a*d)*(m+1)+2*b*c*(p+q))+(d*(b*c-a*d)*(m+1)+2*d*(q-1)*(b*c-a*d)+2*b*c*d*(p+q))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m,p},x] && NeQ[b*c-a*d,0] && GtQ[q,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  e*(e*x)^(m-1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(b*(m+2*(p+q)+1)) - 
  e^2/(b*(m+2*(p+q)+1)) \[Star] 
    Int[(e*x)^(m-2)*(a+b*x^2)^p*(c+d*x^2)^(q-1)*Simp[a*c*(m-1)+(a*d*(m-1)-2*q*(b*c-a*d))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,p},x] && NeQ[b*c-a*d,0] && GtQ[q,0] && GtQ[m,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  e^3*(e*x)^(m-3)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(b*d*(m+2*(p+q)+1)) - 
  e^4/(b*d*(m+2*(p+q)+1)) \[Star] 
    Int[(e*x)^(m-4)*(a+b*x^2)^p*(c+d*x^2)^q*Simp[a*c*(m-3)+(a*d*(m+2*q-1)+b*c*(m+2*p-1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,p,q},x] && NeQ[b*c-a*d,0] && GtQ[m,3] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*c*e*(m+1)) - 
  1/(a*c*e^2*(m+1)) \[Star] 
    Int[(e*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^q*Simp[(b*c+a*d)*(m+3)+2*(b*c*p+a*d*q)+b*d*(m+2*p+2*q+5)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,p,q},x] && NeQ[b*c-a*d,0] && LtQ[m,-1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_./((a_+b_.*x_^2)*(c_+d_.*x_^2)),x_Symbol] :=
  -a*e^2/(b*c-a*d) \[Star] Int[(e*x)^(m-2)/(a+b*x^2),x] + c*e^2/(b*c-a*d) \[Star] Int[(e*x)^(m-2)/(c+d*x^2),x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LeQ[2,m,3]


(* ::Code:: *)
Int[(e_.*x_)^m_./((a_+b_.*x_^2)*(c_+d_.*x_^2)),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[(e*x)^m/(a+b*x^2),x] - d/(b*c-a*d) \[Star] Int[(e*x)^m/(c+d*x^2),x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_^2)^q_./(a_+b_.*x_^2),x_Symbol] :=
  e^2/b \[Star] Int[(e*x)^(m-2)*(c+d*x^2)^q,x] - a*e^2/b \[Star] Int[(e*x)^(m-2)*(c+d*x^2)^q/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e,m,q},x] && NeQ[b*c-a*d,0] && LeQ[2,m,3] && IntBinomialQ[a,b,c,d,e,m,2,-1,q,x]


(* ::Code:: *)
Int[x_*(a_+b_.*x_^2)^p_/(c_+d_.*x_^2),x_Symbol] :=
  b/d \[Star] Int[x*(a+b*x^2)^(p-1),x] - (b*c-a*d)/d \[Star] Int[x*(a+b*x^2)^(p-1)/(c+d*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && GtQ[p,0] && IntBinomialQ[a,b,c,d,1,1,2,p,-1,x]


(* ::Code:: *)
Int[x_*(a_+b_.*x_^2)^p_/(c_+d_.*x_^2),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[x*(a+b*x^2)^(p-1),x] - d/(b*c-a*d) \[Star] Int[x*(a+b*x^2)^(p+1)/(c+d*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && IntBinomialQ[a,b,c,d,1,1,2,p,-1,x]


(* ::Code:: *)
Int[x_^2/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  x*Sqrt[a+b*x^2]/(b*Sqrt[c+d*x^2]) - c/b \[Star] Int[Sqrt[a+b*x^2]/(c+d*x^2)^(3/2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && PosQ[b/a] && PosQ[d/c] && Not[SimplerSqrtQ[b/a,d/c]]


(* ::Code:: *)
Int[x_^2/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  1/b \[Star] Int[Sqrt[a+b*x^2]/Sqrt[c+d*x^2],x] - a/b \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c-a*d,0] && Not[SimplerSqrtQ[-b/a,-d/c]]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  With[{k=Denominator[p]},
  k*a^(p+(m+1)/2)/2 \[Star] 
    Subst[Int[x^(k*(m+1)/2-1)*(c-(b*c-a*d)*x^k)^q/(1-b*x^k)^(p+q+(m+1)/2+1),x],x,x^(2/k)/(a+b*x^2)^(1/k)]] /;
FreeQ[{a,b,c,d},x] && RationalQ[m,p] && IntegersQ[p+(m+1)/2,q] && LtQ[-1,p,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -(b*c-a*d)*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(a*b*e*2*(p+1)) + 
  1/(a*b*2*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-2)*
    Simp[c*(b*c*2*(p+1)+(b*c-a*d)*(m+1))+d*(b*c*2*(p+1)+(b*c-a*d)*(m+2*(q-1)+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && GtQ[q,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(a*e*2*(p+1)) + 
  1/(a*2*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*Simp[c*(m+2*(p+1)+1)+d*(m+2*(p+q+1)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && LtQ[0,q,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  -b*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*e*2*(b*c-a*d)*(p+1)) + 
  1/(a*2*(b*c-a*d)*(p+1)) \[Star] 
    Int[(e*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^q*Simp[b*c*(m+1)+2*(b*c-a*d)*(p+1)+d*b*(m+2*(p+q+2)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m,q},x] && NeQ[b*c-a*d,0] && LtQ[p,-1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  (e*x)^(m+1)*(a+b*x^2)^p*(c+d*x^2)^q/(e*(m+2*(p+q)+1)) + 
  2/(m+2*(p+q)+1) \[Star] Int[(e*x)^m*(a+b*x^2)^(p-1)*(c+d*x^2)^(q-1)*Simp[a*c*(p+q)+(q*(b*c-a*d)+a*d*(p+q))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && GtQ[q,0] && GtQ[p,0] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  d*(e*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)/(b*e*(m+2*(p+q)+1)) + 
  1/(b*(m+2*(p+q)+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^p*(c+d*x^2)^(q-2)*
    Simp[c*((b*c-a*d)*(m+1)+b*c*2*(p+q))+(d*(b*c-a*d)*(m+1)+d*2*(q-1)*(b*c-a*d)+b*c*d*2*(p+q))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,m,p},x] && NeQ[b*c-a*d,0] && GtQ[q,1] && IntBinomialQ[a,b,c,d,e,m,2,p,q,x]


(* ::Code:: *)
Int[x_^m_/((a_+b_.*x_^2)*(c_+d_.*x_^2)),x_Symbol] :=
  -a/(b*c-a*d) \[Star] Int[x^(m-2)/(a+b*x^2),x] + c/(b*c-a*d) \[Star] Int[x^(m-2)/(c+d*x^2),x] /;
FreeQ[{a,b,c,d,m},x] && NeQ[b*c-a*d,0] && (EqQ[m,2] || EqQ[m,3])


(* ::Code:: *)
Int[(e_.*x_)^m_./((a_+b_.*x_^2)*(c_+d_.*x_^2)),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[(e*x)^m/(a+b*x^2),x] - d/(b*c-a*d) \[Star] Int[(e*x)^m/(c+d*x^2),x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  Int[ExpandIntegrand[(e*x)^m*(a+b*x^2)^p*(c+d*x^2)^q,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && NeQ[b*c-a*d,0] && IGtQ[p,-2] && (IGtQ[q,-2] || EqQ[q,-3] && IntegerQ[(m-1)/2])


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.,x_Symbol] :=
  (e*x)^m/(2*x*(x^2)^(Simplify[(m+1)/2]-1)) \[Star] Subst[Int[x^(Simplify[(m+1)/2]-1)*(a+b*x)^p*(c+d*x)^q,x],x,x^2] /;
FreeQ[{a,b,c,d,e,m,p,q},x] && NeQ[b*c-a*d,0] && IntegerQ[Simplify[m+2*p]] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  a^p*c^q*(e*x)^(m+1)/(e*(m+1))*AppellF1[(m+1)/2,-p,-q,1+(m+1)/2,-b*x^2/a,-d*x^2/c] /;
FreeQ[{a,b,c,d,e,m,p,q},x] && NeQ[b*c-a*d,0] && NeQ[m,-1] && NeQ[m,1] && (IntegerQ[p] || GtQ[a,0]) && (IntegerQ[q] || GtQ[c,0])


(* ::Code:: *)
Int[(e_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_,x_Symbol] :=
  a^IntPart[p]*(a+b*x^2)^FracPart[p]/(1+b*x^2/a)^FracPart[p] \[Star] Int[(e*x)^m*(1+b*x^2/a)^p*(c+d*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,m,p,q},x] && NeQ[b*c-a*d,0] && NeQ[m,-1] && NeQ[m,1] && Not[IntegerQ[p] || GtQ[a,0]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.5 (a+b x^2)^p (c+d x^2)^q (e+f x^2)^r.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2)^r_.,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^r,x],x] /;
FreeQ[{a,b,c,d,e,f},x] && IGtQ[p,0] && IGtQ[q,0] && IGtQ[r,0]


(* ::Code:: *)
Int[(e_+f_.*x_^2)/((a_+b_.*x_^2)*(c_+d_.*x_^2)),x_Symbol] :=
  (b*e-a*f)/(b*c-a*d) \[Star] Int[1/(a+b*x^2),x] - 
  (d*e-c*f)/(b*c-a*d) \[Star] Int[1/(c+d*x^2),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(e_+f_.*x_^2)/((a_+b_.*x_^2)*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  f/b \[Star] Int[1/Sqrt[c+d*x^2],x] + 
  (b*e-a*f)/b \[Star] Int[1/((a+b*x^2)*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(e_+f_.*x_^2)/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  f/b \[Star] Int[Sqrt[a+b*x^2]/Sqrt[c+d*x^2],x] + 
  (b*e-a*f)/b \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && 
  Not[PosQ[b/a] && PosQ[d/c] || NegQ[b/a] && (PosQ[d/c] || GtQ[a,0] && (Not[GtQ[c,0]] || SimplerSqrtQ[-b/a,-d/c]))]


(* ::Code:: *)
Int[(e_+f_.*x_^2)/(Sqrt[a_+b_.*x_^2]*(c_+d_.*x_^2)^(3/2)),x_Symbol] :=
  (b*e-a*f)/(b*c-a*d) \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] - 
  (d*e-c*f)/(b*c-a*d) \[Star] Int[Sqrt[a+b*x^2]/(c+d*x^2)^(3/2),x] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[b/a] && PosQ[d/c]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  -(b*e-a*f)*x*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(a*b*2*(p+1)) + 
  1/(a*b*2*(p+1)) \[Star] 
    Int[(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*Simp[c*(b*e*2*(p+1)+b*e-a*f)+d*(b*e*2*(p+1)+(b*e-a*f)*(2*q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f},x] && LtQ[p,-1] && GtQ[q,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  -(b*e-a*f)*x*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*2*(b*c-a*d)*(p+1)) + 
  1/(a*2*(b*c-a*d)*(p+1)) \[Star] 
    Int[(a+b*x^2)^(p+1)*(c+d*x^2)^q*Simp[c*(b*e-a*f)+e*2*(b*c-a*d)*(p+1)+d*(b*e-a*f)*(2*(p+q+2)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,q},x] && LtQ[p,-1]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  f*x*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(b*(2*(p+q+1)+1)) + 
  1/(b*(2*(p+q+1)+1)) \[Star] 
    Int[(a+b*x^2)^p*(c+d*x^2)^(q-1)*Simp[c*(b*e-a*f+b*e*2*(p+q+1))+(d*(b*e-a*f)+f*2*q*(b*c-a*d)+b*d*e*2*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,p},x] && GtQ[q,0] && NeQ[2*(p+q+1)+1,0]


(* ::Code:: *)
Int[(e_+f_.*x_^4)/((a_+b_.*x_^4)^(3/4)*(c_+d_.*x_^4)),x_Symbol] :=
  (b*e-a*f)/(b*c-a*d) \[Star] Int[1/(a+b*x^4)^(3/4),x] - (d*e-c*f)/(b*c-a*d) \[Star] Int[(a+b*x^4)^(1/4)/(c+d*x^4),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(e_+f_.*x_^2)/(c_+d_.*x_^2),x_Symbol] :=
  f/d \[Star] Int[(a+b*x^2)^p,x] + (d*e-c*f)/d \[Star] Int[(a+b*x^2)^p/(c+d*x^2),x] /;
FreeQ[{a,b,c,d,e,f,p},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  e \[Star] Int[(a+b*x^2)^p*(c+d*x^2)^q,x] + f \[Star] Int[x^2*(a+b*x^2)^p*(c+d*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,p,q},x]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)*(c_+d_.*x_^2)*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[1/((a+b*x^2)*Sqrt[e+f*x^2]),x] - 
  d/(b*c-a*d) \[Star] Int[1/((c+d*x^2)*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[1/(x_^2*(c_+d_.*x_^2)*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  1/c \[Star] Int[1/(x^2*Sqrt[e+f*x^2]),x] - 
  d/c \[Star] Int[1/((c+d*x^2)*Sqrt[e+f*x^2]),x] /;
FreeQ[{c,d,e,f},x] && NeQ[d*e-c*f,0]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]/(a_+b_.*x_^2),x_Symbol] :=
  d/b \[Star] Int[Sqrt[e+f*x^2]/Sqrt[c+d*x^2],x] + (b*c-a*d)/b \[Star] Int[Sqrt[e+f*x^2]/((a+b*x^2)*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && GtQ[d/c,0] && GtQ[f/e,0] && Not[SimplerSqrtQ[d/c,f/e]]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]/(a_+b_.*x_^2),x_Symbol] :=
  d/b \[Star] Int[Sqrt[e+f*x^2]/Sqrt[c+d*x^2],x] + (b*c-a*d)/b \[Star] Int[Sqrt[e+f*x^2]/((a+b*x^2)*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && Not[SimplerSqrtQ[-f/e,-d/c]]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)*Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  -f/(b*e-a*f) \[Star] Int[1/(Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] + 
  b/(b*e-a*f) \[Star] Int[Sqrt[e+f*x^2]/((a+b*x^2)*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && GtQ[d/c,0] && GtQ[f/e,0] && Not[SimplerSqrtQ[d/c,f/e]]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)*Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  1/(a*Sqrt[c]*Sqrt[e]*Rt[-d/c,2])*EllipticPi[b*c/(a*d), ArcSin[Rt[-d/c,2]*x], c*f/(d*e)] /;
FreeQ[{a,b,c,d,e,f},x] && Not[GtQ[d/c,0]] && GtQ[c,0] && GtQ[e,0] && Not[Not[GtQ[f/e,0]] && SimplerSqrtQ[-f/e,-d/c]]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)*Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  Sqrt[1+d/c*x^2]/Sqrt[c+d*x^2] \[Star] Int[1/((a+b*x^2)*Sqrt[1+d/c*x^2]*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && Not[GtQ[c,0]]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_^2]/((a_+b_.*x_^2)*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  c*Sqrt[e+f*x^2]/(a*e*Rt[d/c,2]*Sqrt[c+d*x^2]*Sqrt[c*(e+f*x^2)/(e*(c+d*x^2))])*
    EllipticPi[1-b*c/(a*d),ArcTan[Rt[d/c,2]*x],1-c*f/(d*e)] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[d/c]


(* ::Code:: *)
(* Int[Sqrt[c_+d_.*x_^2]/((a_+b_.*x_^2)*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  Sqrt[c+d*x^2]*Sqrt[c*(e+f*x^2)/(e*(c+d*x^2))]/(a*Rt[d/c,2]*Sqrt[e+f*x^2])*
    EllipticPi[1-b*c/(a*d),ArcTan[Rt[d/c,2]*x],1-c*f/(d*e)] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[d/c] *)


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_^2]/((a_+b_.*x_^2)*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  d/b \[Star] Int[1/(Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] + 
  (b*c-a*d)/b \[Star] Int[1/((a+b*x^2)*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && NegQ[d/c]


(* ::Code:: *)
Int[Sqrt[e_+f_.*x_^2]/((a_+b_.*x_^2)*(c_+d_.*x_^2)^(3/2)),x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[Sqrt[e+f*x^2]/((a+b*x^2)*Sqrt[c+d*x^2]),x] - 
  d/(b*c-a*d) \[Star] Int[Sqrt[e+f*x^2]/(c+d*x^2)^(3/2),x] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[d/c] && PosQ[f/e]


(* ::Code:: *)
Int[(e_+f_.*x_^2)^(3/2)/((a_+b_.*x_^2)*(c_+d_.*x_^2)^(3/2)),x_Symbol] :=
  (b*e-a*f)/(b*c-a*d) \[Star] Int[Sqrt[e+f*x^2]/((a+b*x^2)*Sqrt[c+d*x^2]),x] - 
  (d*e-c*f)/(b*c-a*d) \[Star] Int[Sqrt[e+f*x^2]/(c+d*x^2)^(3/2),x] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[d/c] && PosQ[f/e]


(* ::Code:: *)
Int[(c_+d_.*x_^2)^(3/2)*Sqrt[e_+f_.*x_^2]/(a_+b_.*x_^2),x_Symbol] :=
  (b*c-a*d)^2/b^2 \[Star] Int[Sqrt[e+f*x^2]/((a+b*x^2)*Sqrt[c+d*x^2]),x] + 
  d/b^2 \[Star] Int[(2*b*c-a*d+b*d*x^2)*Sqrt[e+f*x^2]/Sqrt[c+d*x^2],x] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[d/c] && PosQ[f/e]


(* ::Code:: *)
Int[(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_/(a_+b_.*x_^2),x_Symbol] :=
  b*(b*e-a*f)/(b*c-a*d)^2 \[Star] Int[(c+d*x^2)^(q+2)*(e+f*x^2)^(r-1)/(a+b*x^2),x] - 
  1/(b*c-a*d)^2 \[Star] Int[(c+d*x^2)^q*(e+f*x^2)^(r-1)*(2*b*c*d*e-a*d^2*e-b*c^2*f+d^2*(b*e-a*f)*x^2),x] /;
FreeQ[{a,b,c,d,e,f},x] && LtQ[q,-1] && GtQ[r,1]


(* ::Code:: *)
Int[(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_/(a_+b_.*x_^2),x_Symbol] :=
  d/b \[Star] Int[(c+d*x^2)^(q-1)*(e+f*x^2)^r,x] + 
  (b*c-a*d)/b \[Star] Int[(c+d*x^2)^(q-1)*(e+f*x^2)^r/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e,f,r},x] && GtQ[q,1]


(* ::Code:: *)
Int[(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_/(a_+b_.*x_^2),x_Symbol] :=
  b^2/(b*c-a*d)^2 \[Star] Int[(c+d*x^2)^(q+2)*(e+f*x^2)^r/(a+b*x^2),x] - 
  d/(b*c-a*d)^2 \[Star] Int[(c+d*x^2)^q*(e+f*x^2)^r*(2*b*c-a*d+b*d*x^2),x] /;
FreeQ[{a,b,c,d,e,f,r},x] && LtQ[q,-1]


(* ::Code:: *)
Int[(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_/(a_+b_.*x_^2),x_Symbol] :=
  -d/(b*c-a*d) \[Star] Int[(c+d*x^2)^q*(e+f*x^2)^r,x] + 
  b/(b*c-a*d) \[Star] Int[(c+d*x^2)^(q+1)*(e+f*x^2)^r/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e,f,r},x] && LeQ[q,-1]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]/(a_+b_.*x_^2)^2,x_Symbol] :=
  x*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]/(2*a*(a+b*x^2)) + 
  d*f/(2*a*b^2) \[Star] Int[(a-b*x^2)/(Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] + 
  (b^2*c*e-a^2*d*f)/(2*a*b^2) \[Star] Int[1/((a+b*x^2)*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[1/((a_+b_.*x_^2)^2*Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  b^2*x*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]/(2*a*(b*c-a*d)*(b*e-a*f)*(a+b*x^2)) - 
  d*f/(2*a*(b*c-a*d)*(b*e-a*f)) \[Star] Int[(a+b*x^2)/(Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] + 
  (b^2*c*e+3*a^2*d*f-2*a*b*(d*e+c*f))/(2*a*(b*c-a*d)*(b*e-a*f)) \[Star] Int[1/((a+b*x^2)*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_,x_Symbol] :=
  d/b \[Star] Int[(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*(e+f*x^2)^r,x] + 
  (b*c-a*d)/b \[Star] Int[(a+b*x^2)^p*(c+d*x^2)^(q-1)*(e+f*x^2)^r,x] /;
FreeQ[{a,b,c,d,e,f,r},x] && ILtQ[p,0] && GtQ[q,0]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_,x_Symbol] :=
  b/(b*c-a*d) \[Star] Int[(a+b*x^2)^p*(c+d*x^2)^(q+1)*(e+f*x^2)^r,x] - 
  d/(b*c-a*d) \[Star] Int[(a+b*x^2)^(p+1)*(c+d*x^2)^q*(e+f*x^2)^r,x] /;
FreeQ[{a,b,c,d,e,f,q},x] && ILtQ[p,0] && LeQ[q,-1]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  Sqrt[c+d*x^2]*Sqrt[a*(e+f*x^2)/(e*(a+b*x^2))]/(c*Sqrt[e+f*x^2]*Sqrt[a*(c+d*x^2)/(c*(a+b*x^2))]) \[Star] 
    Subst[Int[1/(Sqrt[1-(b*c-a*d)*x^2/c]*Sqrt[1-(b*e-a*f)*x^2/e]),x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/(Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  a*Sqrt[c+d*x^2]*Sqrt[a*(e+f*x^2)/(e*(a+b*x^2))]/(c*Sqrt[e+f*x^2]*Sqrt[a*(c+d*x^2)/(c*(a+b*x^2))]) \[Star] 
    Subst[Int[1/((1-b*x^2)*Sqrt[1-(b*c-a*d)*x^2/c]*Sqrt[1-(b*e-a*f)*x^2/e]),x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_^2]/((a_+b_.*x_^2)^(3/2)*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  Sqrt[c+d*x^2]*Sqrt[a*(e+f*x^2)/(e*(a+b*x^2))]/(a*Sqrt[e+f*x^2]*Sqrt[a*(c+d*x^2)/(c*(a+b*x^2))]) \[Star] 
    Subst[Int[Sqrt[1-(b*c-a*d)*x^2/c]/Sqrt[1-(b*e-a*f)*x^2/e],x],x,x/Sqrt[a+b*x^2]] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]/Sqrt[e_+f_.*x_^2],x_Symbol] :=
  d*x*Sqrt[a+b*x^2]*Sqrt[e+f*x^2]/(2*f*Sqrt[c+d*x^2]) - 
  c*(d*e-c*f)/(2*f) \[Star] Int[Sqrt[a+b*x^2]/((c+d*x^2)^(3/2)*Sqrt[e+f*x^2]),x] + 
  b*c*(d*e-c*f)/(2*d*f) \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] - 
  (b*d*e-b*c*f-a*d*f)/(2*d*f) \[Star] Int[Sqrt[c+d*x^2]/(Sqrt[a+b*x^2]*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[(d*e-c*f)/c]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]/Sqrt[e_+f_.*x_^2],x_Symbol] :=
  x*Sqrt[a+b*x^2]*Sqrt[c+d*x^2]/(2*Sqrt[e+f*x^2]) + 
  e*(b*e-a*f)/(2*f) \[Star] Int[Sqrt[c+d*x^2]/(Sqrt[a+b*x^2]*(e+f*x^2)^(3/2)),x] + 
  (b*e-a*f)*(d*e-2*c*f)/(2*f^2) \[Star] Int[1/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] - 
  (b*d*e-b*c*f-a*d*f)/(2*f^2) \[Star] Int[Sqrt[e+f*x^2]/(Sqrt[a+b*x^2]*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x] && NegQ[(d*e-c*f)/c]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]/(e_+f_.*x_^2)^(3/2),x_Symbol] :=
  b/f \[Star] Int[Sqrt[c+d*x^2]/(Sqrt[a+b*x^2]*Sqrt[e+f*x^2]),x] - 
  (b*e-a*f)/f \[Star] Int[Sqrt[c+d*x^2]/(Sqrt[a+b*x^2]*(e+f*x^2)^(3/2)),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_,x_Symbol] :=
  With[{u=ExpandIntegrand[(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^r,x]},
  Int[u,x] /;
 SumQ[u]] /;
FreeQ[{a,b,c,d,e,f,p,q,r},x]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2)^r_.,x_Symbol] :=
  Unintegrable[(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^r,x] /;
FreeQ[{a,b,c,d,e,f,p,q,r},x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.6 (g x)^m (a+b x^2)^p (c+d x^2)^q (e+f x^2)^r.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[x_^m_.*(a_.+b_.*x_^2)^p_.*(c_.+d_.*x_^2)^q_.*(e_.+f_.*x_^2)^r_.,x_Symbol] :=
  1/2 \[Star] Subst[Int[x^((m-1)/2)*(a+b*x)^p*(c+d*x)^q*(e+f*x)^r,x],x,x^2] /;
FreeQ[{a,b,c,d,e,f,p,q,r},x] && IntegerQ[(m-1)/2]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(b_.*x_^2.)^p_.*(c_.+d_.*x_^2)^q_.*(e_.+f_.*x_^2)^r_.,x_Symbol] :=
  (g*x)^m*(b*x^2)^p/x^(m+2*p) \[Star] Int[x^(m+2*p)*(c+d*x^2)^q*(e+f*x^2)^r,x] /;
FreeQ[{b,c,d,e,f,g,m,p,q,r},x]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2)^r_.,x_Symbol] :=
  Int[ExpandIntegrand[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^r,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && IGtQ[p,-2] && IGtQ[q,0] && IGtQ[r,0]


(* ::Code:: *)
Int[(g_.*x_)^m_*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2)^r_,x_Symbol] :=
  With[{k=Denominator[m]},
  k/g \[Star] Subst[Int[x^(k*(m+1)-1)*(a+b*x^(k*2)/g^2)^p*(c+d*x^(k*2)/g^2)^q*(e+f*x^(k*2)/g^2)^r,x],x,(g*x)^(1/k)]] /;
FreeQ[{a,b,c,d,e,f,g,p,q,r},x] && FractionQ[m]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  -(b*e-a*f)*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(2*a*b*g*(p+1)) + 
  1/(2*a*b*(p+1)) \[Star] Int[(g*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*
    Simp[c*(2*b*e*(p+1)+(b*e-a*f)*(m+1))+d*(2*b*e*(p+1)+(b*e-a*f)*(m+2*q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && LtQ[p,-1] && GtQ[q,0] && Not[EqQ[q,1] && SimplerQ[b*c-a*d,b*e-a*f]]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2),x_Symbol] :=
  g*(b*e-a*f)*(g*x)^(m-1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(2*b*(b*c-a*d)*(p+1)) - 
  g^2/(2*b*(b*c-a*d)*(p+1)) \[Star] Int[(g*x)^(m-2)*(a+b*x^2)^(p+1)*(c+d*x^2)^q*
    Simp[c*(b*e-a*f)*(m-1)+(d*(b*e-a*f)*(m+2*q+1)-b*2*(c*f-d*e)*(p+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,q},x] && LtQ[p,-1] && GtQ[m,1]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2),x_Symbol] :=
  -(b*e-a*f)*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*g*2*(b*c-a*d)*(p+1)) + 
  1/(a*2*(b*c-a*d)*(p+1)) \[Star] Int[(g*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^q*
    Simp[c*(b*e-a*f)*(m+1)+e*2*(b*c-a*d)*(p+1)+d*(b*e-a*f)*(m+2*(p+q+2)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,q},x] && LtQ[p,-1]


(* ::Code:: *)
Int[(g_.*x_)^m_*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  e*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(a*g*(m+1)) - 
  1/(a*g^2*(m+1)) \[Star] Int[(g*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^(q-1)*
    Simp[c*(b*e-a*f)*(m+1)+e*2*(b*c*(p+1)+a*d*q)+d*((b*e-a*f)*(m+1)+b*e*2*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,p},x] && GtQ[q,0] && LtQ[m,-1] && Not[EqQ[q,1] && SimplerQ[e+f*x^2,c+d*x^2]]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  f*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(b*g*(m+2*(p+q+1)+1)) + 
  1/(b*(m+2*(p+q+1)+1)) \[Star] Int[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^(q-1)*
    Simp[c*((b*e-a*f)*(m+1)+b*e*2*(p+q+1))+(d*(b*e-a*f)*(m+1)+f*2*q*(b*c-a*d)+b*e*d*2*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && GtQ[q,0] && Not[EqQ[q,1] && SimplerQ[e+f*x^2,c+d*x^2]]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  f*g*(g*x)^(m-1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(b*d*(m+2*(p+q+1)+1)) - 
  g^2/(b*d*(m+2*(p+q+1)+1)) \[Star] Int[(g*x)^(m-2)*(a+b*x^2)^p*(c+d*x^2)^q*
    Simp[a*f*c*(m-1)+(a*f*d*(m+2*q+1)+b*(f*c*(m+2*p+1)-e*d*(m+2*(p+q+1)+1)))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,p,q},x] && GtQ[m,1]


(* ::Code:: *)
Int[(g_.*x_)^m_*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  e*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*c*g*(m+1)) + 
  1/(a*c*g^2*(m+1)) \[Star] Int[(g*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^q*
    Simp[a*f*c*(m+1)-e*(b*c+a*d)*(m+2+1)-e*2*(b*c*p+a*d*q)-b*e*d*(m+2*(p+q+2)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,p,q},x] && LtQ[m,-1]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(e_+f_.*x_^2)/(c_+d_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(g*x)^m*(a+b*x^2)^p*(e+f*x^2)/(c+d*x^2),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  e \[Star] Int[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^q,x] + 
  f/e^2 \[Star] Int[(g*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p,q},x]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2)^r_.,x_Symbol] :=
  e \[Star] Int[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^(r-1),x] + 
  f/e^2 \[Star] Int[(g*x)^(m+2)*(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^(r-1),x] /;
FreeQ[{a,b,c,d,e,f,g,m,p,q},x] && IGtQ[r,0]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  -(b*e-a*f)*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(2*a*b*g*(p+1)) + 
  1/(2*a*b*(p+1)) \[Star] Int[(g*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^(q-1)*
    Simp[c*(2*b*e*(p+1)+(b*e-a*f)*(m+1))+d*(2*b*e*(p+1)+(b*e-a*f)*(m+2*q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && LtQ[p,-1] && GtQ[q,0] && Not[EqQ[q,1] && SimplerQ[b*c-a*d,b*e-a*f]]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2),x_Symbol] :=
  -(b*e-a*f)*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^(q+1)/(a*g*2*(b*c-a*d)*(p+1)) + 
  1/(a*2*(b*c-a*d)*(p+1)) \[Star] Int[(g*x)^m*(a+b*x^2)^(p+1)*(c+d*x^2)^q*
    Simp[c*(b*e-a*f)*(m+1)+e*2*(b*c-a*d)*(p+1)+d*(b*e-a*f)*(m+2*(p+q+2)+1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,q},x] && LtQ[p,-1]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_.*(c_+d_.*x_^2)^q_.*(e_+f_.*x_^2),x_Symbol] :=
  f*(g*x)^(m+1)*(a+b*x^2)^(p+1)*(c+d*x^2)^q/(b*g*(m+2*(p+q+1)+1)) + 
  1/(b*(m+2*(p+q+1)+1)) \[Star] Int[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^(q-1)*
    Simp[c*((b*e-a*f)*(m+1)+b*e*2*(p+q+1))+(d*(b*e-a*f)*(m+1)+f*2*q*(b*c-a*d)+b*e*d*2*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && GtQ[q,0] && Not[EqQ[q,1] && SimplerQ[e+f*x^2,c+d*x^2]]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(e_+f_.*x_^2)/(c_+d_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(g*x)^m*(a+b*x^2)^p*(e+f*x^2)/(c+d*x^2),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_+b_.*x_^2)^p_*(c_+d_.*x_^2)^q_*(e_+f_.*x_^2),x_Symbol] :=
  e \[Star] Int[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^q,x] + 
  f*(g*x)^m/x^m \[Star] Int[x^(m+2)*(a+b*x^2)^p*(c+d*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p,q},x]


(* ::Code:: *)
Int[(g_.*x_)^m_.*(a_.+b_.*x_^2)^p_.*(c_.+d_.*x_^2)^q_.*(e_.+f_.*x_^2)^r_.,x_Symbol] :=
  Unintegrable[(g*x)^m*(a+b*x^2)^p*(c+d*x^2)^q*(e+f*x^2)^r,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p,q,r},x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.7 (c+d x)^n (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(c_+d_.*x_)/(a_+b_.*x_^2),x_Symbol] :=
  c^2/a \[Star] Int[1/(c-d*x),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)/(a_+b_.*x_^2),x_Symbol] :=
  c \[Star] Int[1/(a+b*x^2),x] + d \[Star] Int[x/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)/(a_+b_.*x_^2)^(3/2),x_Symbol] :=
  -(a*d-b*c*x)/(a*b*Sqrt[a+b*x^2]) /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a*d-b*c*x)/(2*a*b*(p+1))*(a+b*x^2)^(p+1) + 
  c*(2*p+3)/(2*a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d},x] && LtQ[p,-1] && NeQ[p,-3/2]


(* ::Code:: *)
Int[(c_+d_.*x_)*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  d*(a+b*x^2)^(p+1)/(2*b*(p+1)) + c \[Star] Int[(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,p},x] && Not[LeQ[p,-1]]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[(c+d*x)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && (IntegerQ[p] || GtQ[a,0] && GtQ[c,0] && Not[IntegerQ[n]])


(* ::Code:: *)
Int[(c_+d_.*x_)^2*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)*(a+b*x^2)^(p+1)/(b*(p+1)) - d^2*(p+2)/(b*(p+1)) \[Star] Int[(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c^2+a*d^2,0] && LtQ[p,-1]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(p+1)) /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(n+2*p+1)) + 
  2*c*Simplify[n+p]/(n+2*p+1) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[Simplify[n+p],0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -d*(c+d*x)^n*(a+b*x^2)^(p+1)/(b*c*n) /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+2*p+2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -d*(c+d*x)^n*(a+b*x^2)^(p+1)/(2*b*c*(n+p+1)) + 
  Simplify[n+2*p+2]/(2*c*(n+p+1)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && ILtQ[Simplify[n+2*p+2],0] && (LtQ[n,-1] || GtQ[n+p,0])


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(a_+b_.*x_^2)^(3/2),x_Symbol] :=
  -2^(n-1)*d*c^(n-2)*(c+d*x)/(b*Sqrt[a+b*x^2]) + 
  d^2/b \[Star] Int[1/Sqrt[a+b*x^2]*ExpandToSum[(2^(n-1)*c^(n-1)-(c+d*x)^(n-1))/(c-d*x),x],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[n,2]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(-c)^(-n-2)*d^(2*n+3)*Sqrt[a+b*x^2]/(2^(n+1)*b^(n+2)*(c+d*x)) - 
  d^(2*n+2)/b^(n+1) \[Star] Int[1/Sqrt[a+b*x^2]*ExpandToSum[(2^(-n-1)*(-c)^(-n-1)-(-c+d*x)^(-n-1))/(c+d*x),x],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && ILtQ[n,0] && EqQ[n+p,-3/2]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
(* c^(2*n)/a^n \[Star] Int[(a+b*x^2)^(n+p)/(c-d*x)^n,x] /; *)
  Int[(a+b*x^2)^(n+p)/(a/c+b*x/d)^n,x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && IntegerQ[n] && RationalQ[p] && (LtQ[0,-n,p] || LtQ[p,-n,0]) && NeQ[n,2] && NeQ[n,-1]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n+1)*(a+b*x^2)^p/(d*(n+p+1)) - 
  b*p/(d^2*(n+p+1)) \[Star] Int[(c+d*x)^(n+2)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && GtQ[p,0] && (LtQ[n,-2] || EqQ[n+2*p+1,0]) && NeQ[n+p+1,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n+1)*(a+b*x^2)^p/(d*(n+2*p+1)) - 
  2*b*c*p/(d^2*(n+2*p+1)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && GtQ[p,0] && (LeQ[-2,n,0] || EqQ[n+p+1,0]) && NeQ[n+2*p+1,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -c*(c+d*x)^n*(a+b*x^2)^(p+1)/(2*a*d*(p+1)) + 
  c*(n+2*p+2)/(2*a*(p+1)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && LtQ[p,-1] && LtQ[0,n,1] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(p+1)) - 
  d^2*(n+p)/(b*(p+1)) \[Star] Int[(c+d*x)^(n-2)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && LtQ[p,-1] && GtQ[n,1] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(n+2*p+1)) + 
  2*c*(n+p)/(n+2*p+1) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c^2+a*d^2,0] && GtQ[n,0] && NeQ[n+2*p+1,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -d*(c+d*x)^n*(a+b*x^2)^(p+1)/(2*b*c*(n+p+1)) + 
  (n+2*p+2)/(2*c*(n+p+1)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c^2+a*d^2,0] && LtQ[n,0] && NeQ[n+p+1,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[1/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  2*d \[Star] Subst[Int[1/(2*b*c+d^2*x^2),x],x,Sqrt[a+b*x^2]/Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^(p+1)*c^(n-1)*((c-d*x)/c)^(p+1)/(a/c+b*x/d)^(p+1) \[Star] Int[(1+d*x/c)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,n},x] && EqQ[b*c^2+a*d^2,0] && (IntegerQ[n] || GtQ[c,0]) && GtQ[a,0] && 
  Not[IntegerQ[n] && (IntegerQ[3*p] || IntegerQ[4*p])]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^(n-1)*(a+b*x^2)^(p+1)/((1+d*x/c)^(p+1)*(a/c+(b*x)/d)^(p+1)) \[Star] Int[(1+d*x/c)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,n},x] && EqQ[b*c^2+a*d^2,0] && (IntegerQ[n] || GtQ[c,0]) && Not[GtQ[a,0]] && 
  Not[IntegerQ[n] && (IntegerQ[3*p] || IntegerQ[4*p])]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^IntPart[n]*(c+d*x)^FracPart[n]/(1+d*x/c)^FracPart[n] \[Star] Int[(1+d*x/c)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n},x] && EqQ[b*c^2+a*d^2,0] && Not[IntegerQ[n] || GtQ[c,0]]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  d*n*c^(n-1)*(a+b*x^2)^(p+1)/(2*b*(p+1)) + 
  Int[ExpandIntegrand[((c+d*x)^n-d*n*c^(n-1)*x)*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d},x] && IGtQ[p,0] && IGtQ[n,0] && LeQ[n,p]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(c+d*x)^n*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,n},x] && IGtQ[p,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^p \[Star] Int[ExpandIntegrand[(c+d*x)^n*(1-Rt[-b/a,2]*x)^p*(1+Rt[-b/a,2]*x)^p,x],x] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[n] && NiceSqrtQ[-b/a] && Not[FractionalPowerFactorQ[Rt[-b/a,2]]]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(c+d*x)^n/(a+b*x^2),x],x] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,1]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)),x_Symbol] :=
  d*Log[RemoveContent[c+d*x,x]]/(b*c^2+a*d^2) + 
  b/(b*c^2+a*d^2) \[Star] Int[(c-d*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  d*(c+d*x)^(n+1)/((n+1)*(b*c^2+a*d^2)) + 
  b/(b*c^2+a*d^2) \[Star] Int[(c+d*x)^(n+1)*(c-d*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x] && ILtQ[n,-1]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  d*(c+d*x)^(n-1)/(b*(n-1)) + 
  1/b \[Star] Int[(c+d*x)^(n-2)*Simp[b*c^2-a*d^2+2*b*c*d*x,x]/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x] && GtQ[n,1]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  d*(c+d*x)^(n+1)/((n+1)*(b*c^2+a*d^2)) + 
  b/(b*c^2+a*d^2) \[Star] Int[(c+d*x)^(n+1)*(c-d*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,n},x] && LtQ[n,-1]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]/(a_+b_.*x_^2),x_Symbol] :=
  2*d \[Star] Subst[Int[x^2/(b*c^2+a*d^2-2*b*c*x^2+b*x^4),x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[1/(Sqrt[c_+d_.*x_]*(a_+b_.*x_^2)),x_Symbol] :=
  2*d \[Star] Subst[Int[1/(b*c^2+a*d^2-2*b*c*x^2+b*x^4),x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(c+d*x)^n,1/(a+b*x^2),x],x] /;
FreeQ[{a,b,c,d,n},x] && Not[IntegerQ[2*n]]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n+1)*(a*d-b*c*x)*(a+b*x^2)^p/((n+1)*(b*c^2+a*d^2)) - 
  2*a*b*p/((n+1)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^(n+2)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[n+2*p+2,0] && GtQ[p,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n-1)*(a*d-b*c*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  (2*p+3)*(b*c^2+a*d^2)/(2*a*b*(p+1)) \[Star] Int[(c+d*x)^(n-2)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[n+2*p+2,0] && LtQ[p,-1]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  -Subst[Int[1/(b*c^2+a*d^2-x^2),x],x,(a*d-b*c*x)/Sqrt[a+b*x^2]] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Rt[-a*b,2]},
  (q-b*x)*(c+d*x)^(n+1)*(a+b*x^2)^p/((n+1)*(b*c+d*q)*((b*c+d*q)*(q+b*x)/((b*c-d*q)*(-q+b*x)))^p)*
    Hypergeometric2F1[n+1,-p,n+2,2*b*q*(c+d*x)/((b*c-d*q)*(q-b*x))]] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n+2*p+2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -x*(c+d*x)^n*(a+b*x^2)^(p+1)/(2*a*(p+1)) - 
  c*n/(2*a*(p+1)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n+2*p+3,0] && LtQ[p,-1]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n+1)*(a+b*x^2)^(p+1)/((n+1)*(b*c^2+a*d^2)) + 
  b*c/(b*c^2+a*d^2) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n+2*p+3,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n+1)*(a+b*x^2)^p/(d*(n+1)) - 
  2*b*p/(d*(n+1)) \[Star] Int[x*(c+d*x)^(n+1)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,n},x] && GtQ[p,0] && (IntegerQ[p] || LtQ[n,-1]) && NeQ[n,-1] && Not[ILtQ[n+2*p+1,0]] && IntQuadraticQ[a,0,b,c,d,n,p,x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n+1)*(a+b*x^2)^p/(d*(n+2*p+1)) + 
  2*p/(d*(n+2*p+1)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^(p-1)*(a*d-b*c*x),x] /;
FreeQ[{a,b,c,d,n},x] && GtQ[p,0] && NeQ[n+2*p+1,0] && (Not[RationalQ[n]] || LtQ[n,1]) && Not[ILtQ[n+2*p,0]] && IntQuadraticQ[a,0,b,c,d,n,p,x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -x*(c+d*x)^n*(a+b*x^2)^(p+1)/(2*a*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^(p+1)*(c*(2*p+3)+d*(n+2*p+3)*x),x] /;
FreeQ[{a,b,c,d},x] && LtQ[p,-1] && GtQ[n,0] && (LtQ[n,1] || ILtQ[n+2*p+3,0] && NeQ[n,2]) && IntQuadraticQ[a,0,b,c,d,n,p,x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a*d-b*c*x)*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) - 
  1/(2*a*b*(p+1)) \[Star] Int[(c+d*x)^(n-2)*(a+b*x^2)^(p+1)*Simp[a*d^2*(n-1)-b*c^2*(2*p+3)-b*c*d*(n+2*p+2)*x,x],x] /;
FreeQ[{a,b,c,d},x] && LtQ[p,-1] && GtQ[n,1] && IntQuadraticQ[a,0,b,c,d,n,p,x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(a*d+b*c*x)*(c+d*x)^(n+1)*(a+b*x^2)^(p+1)/(2*a*(p+1)*(b*c^2+a*d^2)) + 
  1/(2*a*(p+1)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^(p+1)*Simp[b*c^2*(2*p+3)+a*d^2*(n+2*p+3)+b*c*d*(n+2*p+4)*x,x],x] /;
FreeQ[{a,b,c,d,n},x] && LtQ[p,-1] && IntQuadraticQ[a,0,b,c,d,n,p,x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(n+2*p+1)) + 
  1/(b*(n+2*p+1)) \[Star] Int[(c+d*x)^(n-2)*(a+b*x^2)^p*Simp[b*c^2*(n+2*p+1)-a*d^2*(n-1)+2*b*c*d*(n+p)*x,x],x] /;
FreeQ[{a,b,c,d,n,p},x] && If[RationalQ[n], GtQ[n,1], SumSimplerQ[n,-2]] && NeQ[n+2*p+1,0] && IntQuadraticQ[a,0,b,c,d,n,p,x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(c+d*x)^(n+1)*(a+b*x^2)^(p+1)/((n+1)*(b*c^2+a*d^2)) + 
  b/((n+1)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p*(c*(n+1)-d*(n+2*p+3)*x),x] /;
FreeQ[{a,b,c,d,n,p},x] && NeQ[n,-1] && (LtQ[n,-1] && IntQuadraticQ[a,0,b,c,d,n,p,x] || SumSimplerQ[n,1] && IntegerQ[p] || ILtQ[Simplify[n+2*p+3],0])


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)^(1/4)),x_Symbol] :=
  With[{q=Rt[-a,4]},
  1/(2*d*q)*ArcTan[c*q*(a+b*x^2)^(1/4)/(q^2*(c+d*x)-c*Sqrt[a+b*x^2])] - 
  1/(2*d*q)*ArcTanh[c*q*(a+b*x^2)^(1/4)/(q^2*(c+d*x)+c*Sqrt[a+b*x^2])]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+2*a*d^2,0] && NegQ[a]


(* ::Code:: *)
(* Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)^(1/4)),x_Symbol] :=
  With[{q=Rt[-a,4]},
  1/(2*d*q)*ArcTan[c*q*(a+b*x^2)^(1/4)/(q^2*(c+d*x)-c*Sqrt[a+b*x^2])] - 
  1/(4*q*d)*Log[(q^2*(c+d*x)+c*Sqrt[a+b*x^2]+c*q*(a+b*x^2)^(1/4))/(q^2*(c+d*x)+c*Sqrt[a+b*x^2]-c*q*(a+b*x^2)^(1/4))]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+2*a*d^2,0] && NegQ[a] *)


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)^(1/4)),x_Symbol] :=
  (-a-b*x^2)^(1/4)/(a+b*x^2)^(1/4) \[Star] Int[1/((c+d*x)*(-a-b*x^2)^(1/4)),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+2*a*d^2,0] && PosQ[a]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)^(1/3)),x_Symbol] :=
  With[{q=Rt[6*b^2*d^2/c^2,3]},
  -Sqrt[3]*b*d*ArcTan[1/Sqrt[3]+2*b*(c-d*x)/(Sqrt[3]*c*q*(a+b*x^2)^(1/3))]/(c^2*q^2) - 
  3*b*d*Log[c+d*x]/(2*c^2*q^2) + 
  3*b*d*Log[b*c-b*d*x-c*q*(a+b*x^2)^(1/3)]/(2*c^2*q^2)] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2-3*a*d^2,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)^(1/3)),x_Symbol] :=
  a^(1/3) \[Star] Int[1/((c+d*x)*(1-3*d*x/c)^(1/3)*(1+3*d*x/c)^(1/3)),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+9*a*d^2,0] && GtQ[a,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^2)^(1/3)),x_Symbol] :=
  (1+b*x^2/a)^(1/3)/(a+b*x^2)^(1/3) \[Star] Int[1/((c+d*x)*(1+b*x^2/a)^(1/3)),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+9*a*d^2,0] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  c \[Star] Int[(a+b*x^2)^p/(c^2-d^2*x^2),x] - d \[Star] Int[x*(a+b*x^2)^p/(c^2-d^2*x^2),x] /;
FreeQ[{a,b,c,d,p},x]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p,(c/(c^2-d^2*x^2)-d*x/(c^2-d^2*x^2))^(-n),x],x] /;
FreeQ[{a,b,c,d,p},x] && ILtQ[n,-1] && PosQ[a/b]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Rt[-a/b,2]},
  -(a+b*x^2)^p*(1/(c+d*x))^(2*p)/(d*(1-(c-d*q)/(c+d*x))^p*(1-(c+d*q)/(c+d*x))^p) \[Star] 
    Subst[Int[(1-(c-d*q)*x)^p*(1-(c+d*q)*x)^p/x^(n+2*p+2),x],x,1/(c+d*x)]] /;
FreeQ[{a,b,c,d,p},x] && ILtQ[n,-1] && NegQ[a/b]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  2/d \[Star] Subst[Int[x^2/Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2],x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  -2*Sqrt[c+d*x]/(Sqrt[a]*q*Sqrt[q*(c+d*x)/(d+c*q)]) \[Star] 
    Subst[Int[Sqrt[1-2*d*x^2/(d+c*q)]/Sqrt[1-x^2],x],x,Sqrt[(1-q*x)/2]]] /;
FreeQ[{a,b,c,d},x] && NegQ[b/a] && GtQ[a,0]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  Sqrt[1+b*x^2/a]/Sqrt[a+b*x^2] \[Star] Int[Sqrt[c+d*x]/Sqrt[1+b*x^2/a],x] /;
FreeQ[{a,b,c,d},x] && NegQ[b/a] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[1/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  2/d \[Star] Subst[Int[1/Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2],x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a]


(* ::Code:: *)
Int[1/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  -2*Sqrt[q*(c+d*x)/(d+c*q)]/(Sqrt[a]*q*Sqrt[c+d*x]) \[Star] 
    Subst[Int[1/(Sqrt[1-2*d*x^2/(d+c*q)]*Sqrt[1-x^2]),x],x,Sqrt[(1-q*x)/2]]] /;
FreeQ[{a,b,c,d},x] && NegQ[b/a] && GtQ[a,0]


(* ::Code:: *)
Int[1/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  Sqrt[1+b*x^2/a]/Sqrt[a+b*x^2] \[Star] Int[1/(Sqrt[c+d*x]*Sqrt[1+b*x^2/a]),x] /;
FreeQ[{a,b,c,d},x] && NegQ[b/a] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^p \[Star] Int[(c+d*x)^n*(1+Rt[-b/a,2]*x)^p*(1-Rt[-b/a,2]*x)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && GtQ[a,0] && NegQ[b/a]


(* ::Code:: *)
(* Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^p/(1+b/a*x^2)^p \[Star] Int[(c+d*x)^n*(1+b/a*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && Not[GtQ[a,0]] *)


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{q=Rt[-a/b,2]},
  (a+b*x^2)^p/(d*(1-(c+d*x)/(c-d*q))^p*(1-(c+d*x)/(c+d*q))^p) \[Star] 
    Subst[Int[x^n*Simp[1-x/(c+d*q),x]^p*Simp[1-x/(c-d*q),x]^p,x],x,c+d*x]] /;
FreeQ[{a,b,c,d,n,p},x] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[(c_+d_.*u_)^n_.*(a_+b_.*u_^2)^p_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(c+d*x)^n*(a+b*x^2)^p,x],x,u] /;
FreeQ[{a,b,c,d,n,p},x] && LinearQ[u,x] && NeQ[u,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.8 (e x)^m (c+d x)^n (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[(e*x)^m*(c+d*x)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && EqQ[b*c^2+a*d^2,0] && (IntegerQ[p] || GtQ[a,0] && GtQ[c,0] && Not[IntegerQ[n]])


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  2*e^m/d^(m+2*p+1) \[Star] Subst[Int[x^(2*n+1)*(-c+x^2)^m*(b*c^2+a*d^2-2*b*c*x^2+b*x^4)^p,x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[p,0] && ILtQ[m,0] && IntegerQ[n+1/2]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  2/e^(n+2*p+1) \[Star] Subst[Int[x^(2*m+1)*(e*c+d*x^2)^n*(a*e^2+b*x^4)^p,x],x,Sqrt[e*x]] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[p,0] && ILtQ[n,0] && IntegerQ[m+1/2]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(a+b*x^2)^p,c+d*x,x],R=PolynomialRemainder[(a+b*x^2)^p,c+d*x,x]},
  -R*(e*x)^(m+1)*(c+d*x)^(n+1)/(c*e*(n+1)) + 
  1/(c*(n+1)) \[Star] Int[(e*x)^m*(c+d*x)^(n+1)*ExpandToSum[c*(n+1)*Qx+R*(m+n+2),x],x]] /;
FreeQ[{a,b,c,d,e,m},x] && IGtQ[p,0] && LtQ[n,-1] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(a+b*x^2)^p,e*x,x],R=PolynomialRemainder[(a+b*x^2)^p,e*x,x]},
  R*(e*x)^(m+1)*(c+d*x)^(n+1)/((m+1)*(e*c)) + 
  1/((m+1)*(e*c)) \[Star] Int[(e*x)^(m+1)*(c+d*x)^n*ExpandToSum[(m+1)*(e*c)*Qx-d*R*(m+n+2),x],x]] /;
FreeQ[{a,b,c,d,e,n},x] && IGtQ[p,0] && LtQ[m,-1] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  b^p*(e*x)^(m+2*p)*(c+d*x)^(n+1)/(d*e^(2*p)*(m+n+2*p+1)) + 
  1/(d*e^(2*p)*(m+n+2*p+1)) \[Star] Int[(e*x)^m*(c+d*x)^n*
    ExpandToSum[d*(m+n+2*p+1)*(e^(2*p)*(a+b*x^2)^p-b^p*(e*x)^(2*p))-b^p*(e*c)*(m+2*p)*(e*x)^(2*p-1),x],x] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[p,0] && NeQ[m+n+2*p+1,0] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(e*x)^m*(c+d*x)^n*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,m,n},x] && IGtQ[p,0]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)/(a_+b_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[x^m*(c+d*x)/(a+b*x^2),x],x] /;
FreeQ[{a,b,c,d},x] && IntegerQ[m]


(* ::Code:: *)
Int[(c_+d_.*x_)^2/(x_*(a_+b_.*x_^2)),x_Symbol] :=
  c^2/a*Log[x] + 2*c*d \[Star] Int[1/(a+b*x^2),x] - (b*c^2-a*d^2)/a \[Star] Int[x/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  d^n*x^(m+n-1)/(b*(m+n-1)) + 
  1/b \[Star] Int[x^m*ExpandToSum[b*(c+d*x)^n-b*d^n*x^n-a*d^n*x^(n-2),x]/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,1] && IGtQ[m,-2] && NeQ[m+n-1,0]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  With[{Qx=PolynomialQuotient[(c+d*x)^n,x,x], R=PolynomialRemainder[(c+d*x)^n,x,x]},
  R*x^(m+1)/(a*(m+1)) + 
  1/a \[Star] Int[x^(m+1)*ExpandToSum[a*Qx-b*R*x,x]/(a+b*x^2),x]] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,1] && ILtQ[m,-1]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_./(a_+b_.*x_^2)^(3/2),x_Symbol] :=
  -2^(n-1)*c^(m+n-2)*(c+d*x)/(b*d^(m-1)*Sqrt[a+b*x^2]) + 
  1/(b*d^(m-2)) \[Star] Int[(1/Sqrt[a+b*x^2])*ExpandToSum[(2^(n-1)*c^(m+n-1)-d^m*x^m*(c+d*x)^(n-1))/(c-d*x),x],x] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && IGtQ[m,0] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_./(a_+b_.*x_^2)^(3/2),x_Symbol] :=
  -2^(n-1)*c^(m+n-2)*(c+d*x)/(b*d^(m-1)*Sqrt[a+b*x^2]) + 
  c^2/a \[Star] Int[x^m/Sqrt[a+b*x^2]*ExpandToSum[((c+d*x)^(n-1)-2^(n-1)*c^(m+n-1)*d^(-m)*x^(-m))/(c-d*x),x],x] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && ILtQ[m,0] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m,a*d+b*c*x,x], R=PolynomialRemainder[x^m,a*d+b*c*x,x]},
  -c*R*(c+d*x)^n*(a+b*x^2)^(p+1)/(2*a*d*(p+1)) + 
  c/(2*a*(p+1)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^(p+1)*ExpandToSum[2*a*d*(p+1)*Qx+R*(n+2*p+2),x],x]] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && IGtQ[m,1] && LtQ[p,-1] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m*(c+d*x)^n,a+b*x^2,x],
        e=Coeff[PolynomialRemainder[x^m*(c+d*x)^n,a+b*x^2,x],x,0],
        f=Coeff[PolynomialRemainder[x^m*(c+d*x)^n,a+b*x^2,x],x,1]},
  (a*f-b*e*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*Qx+e*(2*p+3),x],x]] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && IGtQ[m,0] && LtQ[p,-1] && EqQ[n,1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m,a+b*x^2,x],
        e=Coeff[PolynomialRemainder[x^m,a+b*x^2,x],x,0],
        f=Coeff[PolynomialRemainder[x^m,a+b*x^2,x],x,1]},
  (c+d*x)^n*(a*f-b*e*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*b*(p +1)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^(p+1)*
    ExpandToSum[2*a*b*(p+1)*(c+d*x)*Qx-a*d*f*n+b*c*e*(2*p+3)+b*d*e*(n+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && IGtQ[m,0] && LtQ[p,-1] && GtQ[n,1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m*(c+d*x)^n,a+b*x^2,x],
        e=Coeff[PolynomialRemainder[x^m*(c+d*x)^n,a+b*x^2,x],x,0],
        f=Coeff[PolynomialRemainder[x^m*(c+d*x)^n,a+b*x^2,x],x,1]},
  (a*f-b*e*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[x^m*(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*Qx/x^m+e*(2*p+3)/x^m,x],x]] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && ILtQ[m,0] && LtQ[p,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*x^m*(a+b*x^2)^(p+1)/(b*(m+2*p+2)) - 
  1/(b*(m+2*p+2)) \[Star] Int[x^(m-1)*(a+b*x^2)^p*Simp[a*d*m-b*c*(m+2*p+2)*x,x],x] /;
FreeQ[{a,b,c,d,p},x] && IGtQ[m,0] && GtQ[p,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -c*x^(m+1)*(a+b*x^2)^(p+1)/(2*a*(p+1)) + d \[Star] Int[x^(m+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,m,p},x] && ILtQ[m,0] && GtQ[p,-1] && EqQ[m+2*p+3,0]


(* ::Code:: *)
Int[(c_+d_.*x_)*(a_+b_.*x_^2)^p_/x_,x_Symbol] :=
  (c*(2*p+1)+2*d*p*x)*(a+b*x^2)^p/(2*p*(2*p+1)) + 
  a/(2*p+1) \[Star] Int[(c*(2*p+1)+2*d*p*x)*(a+b*x^2)^(p-1)/x,x] /;
FreeQ[{a,b,c,d},x] && GtQ[p,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)*(a_+b_.*x_^2)^p_/x_^2,x_Symbol] :=
  -(2*c*p-d*x)*(a+b*x^2)^p/(2*p*x) + Int[(a*d+2*b*c*p*x)*(a+b*x^2)^(p-1)/x,x] /;
FreeQ[{a,b,c,d},x] && GtQ[p,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  x^(m+1)*(c*(m+2)+d*(m+1)*x)*(a+b*x^2)^p/((m+1)*(m+2)) - 
  2*b*p/((m+1)*(m+2)) \[Star] Int[x^(m+2)*(c*(m+2)+d*(m+1)*x)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && ILtQ[m,-2] && GtQ[p,0] && Not[ILtQ[m+2*p+3,0]] && IntegerQ[2*p]


(* ::Code:: *)
Int[(c_+d_.*x_)/(x_*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  c \[Star] Int[1/(x*Sqrt[a+b*x^2]),x] + d \[Star] Int[1/Sqrt[a+b*x^2],x] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c*x^(m+1)*(a+b*x^2)^(p+1)/(a*(m+1)) + 
  1/(a*(m+1))\[Star]Int[x^(m+1)*(a+b*x^2)^p*(a*d*(m+1)-b*c*(m+2*p+3)*x),x] /;
FreeQ[{a,b,c,d,p},x] && ILtQ[m,-1] && GtQ[p,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(c+d*x)^n,x,x], R=PolynomialRemainder[(c+d*x)^n,x,x]},
  R*x^(m+1)*(a+b*x^2)^(p+1)/(a*(m+1)) + 
  1/(a*(m+1)) \[Star] Int[x^(m+1)*(a+b*x^2)^p*ExpandToSum[a*(m+1)*Qx-b*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,p},x] && IGtQ[n,1] && ILtQ[m,-1] && GtQ[p,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d^n*x^(m+n-1)*(a+b*x^2)^(p+1)/(b*(m+n+2*p+1)) + 
  1/(b*(m+n+2*p+1)) \[Star] Int[x^m*(a+b*x^2)^p*
    ExpandToSum[b*(m+n+2*p+1)*(c+d*x)^n-b*d^n*(m+n+2*p+1)*x^n-a*d^n*(m+n-1)*x^(n-2),x],x] /;
FreeQ[{a,b,c,d,m,p},x] && IGtQ[n,1] && IGtQ[m,-2] && GtQ[p,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c \[Star] Int[x^m*(a+b*x^2)^p,x] + d \[Star] Int[x^(m+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,p},x] && IntegerQ[m] && Not[IntegerQ[2*p]]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Module[{k},
  Int[x^m*Sum[Binomial[n,2*k]*c^(n-2*k)*d^(2*k)*x^(2*k),{k,0,n/2}]*(a+b*x^2)^p,x] + 
  Int[x^(m+1)*Sum[Binomial[n,2*k+1]*c^(n-2*k-1)*d^(2*k+1)*x^(2*k),{k,0,(n-1)/2}]*(a+b*x^2)^p,x]] /;
FreeQ[{a,b,c,d,p},x] && IGtQ[n,1] && IntegerQ[m] && Not[IntegerQ[2*p]] && Not[EqQ[m,1] && EqQ[b*c^2+a*d^2,0]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^m*(a*d-b*c*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) - 
  e*d*m/(2*b*(p+1))*Int[(e*x)^(m-1)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[Simplify[m+2*p+3],0] && LtQ[p,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -c*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(2*a*e*(p+1)) + 
  d/e \[Star] Int[(e*x)^(m+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && EqQ[Simplify[m+2*p+3],0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(c*(m+2)+d*(m+1)*x)*(a+b*x^2)^p/(e*(m+1)*(m+2)) - 
  2*b*p/(e^2*(m+1)*(m+2)) \[Star] Int[(e*x)^(m+2)*(a+b*x^2)^(p-1)*(c*(m+2)+d*(m+1)*x),x] /;
FreeQ[{a,b,c,d,e},x] && GtQ[p,0] && LtQ[m,-2] && Not[ILtQ[m+2*p+3,0]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(c*(m+2*p+2)+d*(m+1)*x)*(a+b*x^2)^p/(e*(m+1)*(m+2*p+2)) + 
  2*p/(e*(m+1)*(m+2*p+2)) \[Star] Int[(e*x)^(m+1)*(a*d*(m+1)-b*c*(m+2*p+2)*x)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e},x] && GtQ[p,0] && LtQ[m,-1] && Not[ILtQ[m+2*p+1,0]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(c*(m+2*p+2)+d*(m+2*p+1)*x)*(a+b*x^2)^p/(e*(m+2*p+1)*(m+2*p+2)) + 
  2*a*p/((m+2*p+1)*(m+2*p+2)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p-1)*(c*(m+2*p+2)+d*(m+2*p+1)*x),x] /;
FreeQ[{a,b,c,d,e,m},x] && GtQ[p,0] && (IntegerQ[p] || Not[RationalQ[m]] || GeQ[m,-1] && LtQ[m,0]) && Not[ILtQ[m+2*p,0]] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  e*(e*x)^(m-1)*(c+d*x)*(a+b*x^2)^(p+1)/(2*b*(p+1)) - 
  e^2/(2*b*(p+1)) \[Star] Int[(e*x)^(m-2)*(c*(m-1)+d*m*x)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e},x] && LtQ[p,-1] && GtQ[m,1]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^m*(a*d-b*c*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) - 
  e/(2*a*b*(p+1)) \[Star] Int[(e*x)^(m-1)*(a*d*m-b*c*(m+2*p+3)*x)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e},x] && LtQ[p,-1] && LtQ[0,m,1]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(e*x)^(m+1)*(c+d*x)*(a+b*x^2)^(p+1)/(2*a*e*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(e*x)^m*(c*(m+2*p+3)+d*(m+2*p+4)*x)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m},x] && LtQ[p,-1] && LtQ[m,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(e*x)^m*(a+b*x^2)^(p+1)/(b*(m+2*p+2)) - 
  e/(b*(m+2*p+2)) \[Star] Int[(e*x)^(m-1)*(a+b*x^2)^p*Simp[a*d*m-b*c*(m+2*p+2)*x,x],x] /;
FreeQ[{a,b,c,d,e,p},x] && GtQ[m,0] && NeQ[m+2*p+2,0] && (IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c*(e*x)^(m+1)*(a+b*x^2)^(p+1)/(a*e*(m+1)) + 
  1/(a*e*(m+1))\[Star]Int[(e*x)^(m+1)*(a+b*x^2)^p*(a*d*(m+1)-b*c*(m+2*p+3)*x),x] /;
FreeQ[{a,b,c,d,e,p},x] && LtQ[m,-1]


(* ::Code:: *)
Int[(c_+d_.*x_)/(Sqrt[e_.*x_]*(a_+b_.*x_^2)),x_Symbol] :=
  2 \[Star] Subst[Int[(e*c+d*x^2)/(a*e^2+b*x^4),x],x,Sqrt[e*x]] /;
FreeQ[{a,b,c,d,e},x]


(* ::Code:: *)
(* Int[(e_.*x_)^m_*(c_+d_.*x_)/(a_+b_.*x_^2),x_Symbol] :=
  c*(e*x)^(m+1)/(a*e*(m+1)) + 
  1/(a*e) \[Star] Int[(e*x)^(m+1)*Simp[a*d-b*c*x,x]/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e},x] && FractionQ[m] && LtQ[m,-1] *)


(* ::Code:: *)
Int[(c_+d_.*x_)/(Sqrt[x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  2 \[Star] Subst[Int[(c+d*x^2)/Sqrt[a+b*x^4],x],x,Sqrt[x]] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[(c_+d_.*x_)/(Sqrt[e_*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  Sqrt[x]/Sqrt[e*x] \[Star] Int[(c+d*x)/(Sqrt[x]*Sqrt[a+b*x^2]),x] /;
FreeQ[{a,b,c,d,e},x]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c \[Star] Int[(e*x)^m*(a+b*x^2)^p,x] + d/e \[Star] Int[(e*x)^(m+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(c+d*x)^n,a+b*x^2,x],
        f=Coeff[PolynomialRemainder[(c+d*x)^n,a+b*x^2,x],x,0],
        g=Coeff[PolynomialRemainder[(c+d*x)^n,a+b*x^2,x],x,1]},
  -(e*x)^(m+1)*(f+g*x)*(a+b*x^2)^(p+1)/(2*a*e*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*Qx+f*(m+2*p+3)+g*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,b,c,d,e,m},x] && IGtQ[n,1] && Not[IntegerQ[m]] && LtQ[p,-1]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d^n*(e*x)^(m+n-1)*(a+b*x^2)^(p+1)/(b*e^(n-1)*(m+n+2*p+1)) + 
  1/(b*(m+n+2*p+1)) \[Star] Int[(e*x)^m*(a+b*x^2)^p*
    ExpandToSum[b*(m+n+2*p+1)*(c+d*x)^n-b*d^n*(m+n+2*p+1)*x^n-a*d^n*(m+n-1)*x^(n-2),x],x] /;
FreeQ[{a,b,c,d,e,m,p},x] && IGtQ[n,1] && Not[IntegerQ[m]] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Module[{k},
  Int[(e*x)^m*Sum[Binomial[n,2*k]*c^(n-2*k)*d^(2*k)*x^(2*k),{k,0,n/2}]*(a+b*x^2)^p,x] + 
  1/e \[Star] Int[(e*x)^(m+1)*Sum[Binomial[n,2*k+1]*c^(n-2*k-1)*d^(2*k+1)*x^(2*k),{k,0,(n-1)/2}]*(a+b*x^2)^p,x]] /;
FreeQ[{a,b,c,d,e,p},x] && IGtQ[n,1] && Not[IntegerQ[m]] && EqQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{k=Denominator[n]},
  k/d \[Star] Subst[Int[x^(k*(n+1)-1)*(-c/d+x^k/d)^m*Simp[(b*c^2+a*d^2)/d^2-2*b*c*x^k/d^2+b*x^(2*k)/d^2,x]^p,x],x,(c+d*x)^(1/k)]] /;
FreeQ[{a,b,c,d,m,p},x] && FractionQ[n] && IntegerQ[p] && IntegerQ[m]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^(2*n)/a^n \[Star] Int[x^m*(a+b*x^2)^(n+p)/(c-d*x)^n,x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[m,0] && ILtQ[n,0] && IGtQ[n+p+1/2,0]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(-c)^(m-n-2)*d^(2*n-m+3)*Sqrt[a+b*x^2]/(2^(n+1)*b^(n+2)*(c+d*x)) - 
  d^(2*n-m+2)/b^(n+1) \[Star] Int[1/Sqrt[a+b*x^2]*ExpandToSum[(2^(-n-1)*(-c)^(m-n-1)-d^m*x^m*(-c+d*x)^(-n-1))/(c+d*x),x],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[m,0] && ILtQ[n,0] && EqQ[n+p,-3/2]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(-c)^(m-n-2)*d^(2*n-m+3)*Sqrt[a+b*x^2]/(2^(n+1)*b^(n+2)*(c+d*x)) - 
  d^(2*n+2)/b^(n+1) \[Star] Int[x^m/Sqrt[a+b*x^2]*ExpandToSum[(2^(-n-1)*(-c)^(m-n-1)*d^(-m)*x^(-m)-(-c+d*x)^(-n-1))/(c+d*x),x],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && ILtQ[m,0] && ILtQ[n,0] && EqQ[n+p,-3/2]


(* ::Code:: *)
Int[x_*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  a*(a+b*x^2)^p/(2*b*c*p) + b/d \[Star] Int[x^2*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  Int[x^m*(a/c+b*x/d)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && GtQ[p,0]


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  c*x^m*(a+b*x^2)^(p+1)/(2*a*d*p*(c+d*x)) - 
  m/(2*d*p) \[Star] Int[x^(m-1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[m,1] && LtQ[p,-1] && EqQ[m+2*p+1,0]


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  x^(m-1)*(a+b*x^2)^(p+1)/(2*b*p*(c+d*x)) + 
  1/(2*d^2*p) \[Star] Int[x^(m-2)*(a+b*x^2)^p*(c*(m-1)-d*m*x),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[m,1] && LtQ[p,-1]


(* ::Code:: *)
Int[x_^m_*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  -x^(m+1)*(a+b*x^2)^(p+1)/(2*a*p*(c+d*x)) + 
  1/(2*c^2*p) \[Star] Int[x^m*(a+b*x^2)^p*(c*(m+2*p+1)-d*(m+2*p+2)*x),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0] && ILtQ[m+2*p,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^(2*n)/a^n \[Star] Int[(e*x)^m*(a+b*x^2)^(n+p)/(c-d*x)^n,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && EqQ[b*c^2+a*d^2,0] && ILtQ[n,-1] && Not[IGtQ[m,0] && ILtQ[m+n,0] && Not[GtQ[p,1]]]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^n*(a+b*x^2)^(p+1)/(2*b*(n+p+1)) + 
  n/(2*d*(n+p+1)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && (LtQ[n,-1] && Not[IGtQ[n+p+1,0]] || LtQ[n,0] && LtQ[p,-1] || EqQ[n+2*p+2,0]) && NeQ[n+p+1,0]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^n*(a+b*x^2)^(p+1)/(b*(n+2*p+2)) + 
  c*n/(d*(n+2*p+2)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && NeQ[n+2*p+2,0]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]/(x_*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  -2*c \[Star] Subst[Int[1/(a-c*x^2),x],x,Sqrt[a+b*x^2]/Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[(e_.*x_)^n_*(c_+d_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d^2*(e*x)^(n+1)*(c+d*x)^(m-2)*(a+b*x^2)^(p+1)/(b*e*(n+p+2)) + 
  c*(2*n+p+3)/(n+p+2) \[Star] Int[(e*x)^n*(c+d*x)^(m-1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && EqQ[b*c^2+a*d^2,0] && EqQ[m+p-1,0] && Not[LtQ[n,-1]] && IntegerQ[2*p]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^(m+1)*(c+d*x)^n*(a+b*x^2)^p/(e*(m+1)) + 
  b*n/(d*e*(m+1)) \[Star] Int[(e*x)^(m+1)*(c+d*x)^(n+1)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0] && GtQ[p,0] && LtQ[m,-1] && Not[IntegerQ[m+p] && LeQ[m+p+2,0]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(e*x)^(m+1)*(c+d*x)^n*(a+b*x^2)^p/(e*(n-m-1)) - 
  b*c*n/(d^2*(n-m-1)) \[Star] Int[(e*x)^m*(c+d*x)^(n+1)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0] && GtQ[p,0] && NeQ[m-n+1,0] && 
  Not[IGtQ[m,0]] && Not[IntegerQ[m+p] && LtQ[m+p+2,0]] && RationalQ[m]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(e*x)^m*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(p+1)) - 
  d*e*m/(b*(p+1)) \[Star] Int[(e*x)^(m-1)*(c+d*x)^(n-1)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0] && LtQ[p,-1] && GtQ[m,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -c*(e*x)^(m+1)*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(a*e*(p+1)) + 
  c*(m-n+2)/(a*(p+1)) \[Star] Int[(e*x)^m*(c+d*x)^(n-1)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0] && LtQ[p,-1] && RationalQ[m]


(* ::Code:: *)
(* Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  d*(e*x)^m*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*(m-n+1)) + 
  c*e*m/(d*(m-n+1)) \[Star] Int[(e*x)^(m-1)*(c+d*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0] && GtQ[m,0] && NeQ[m-n+1,0] && (IntegerQ[2*p] || IntegerQ[m]) *)


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(e_.*x_)^m_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -d^2*(e*x)^(m+1)*(c+d*x)^(n-1)*(a+b*x^2)^(p+1)/(b*c*e*(m+1)) - 
  d*(n-m-2)/(c*e*(m+1)) \[Star] Int[(e*x)^(m+1)*(c+d*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p,0] && LtQ[m,-1] && (IntegerQ[2*p] || IntegerQ[m])


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -d^2*(e*x)^(m+1)*(c+d*x)^(n-2)*(a+b*x^2)^(p+1)/(b*e*(m+1)) + 
  d*(2*m+p+3)/(e*(m+1)) \[Star] Int[(e*x)^(m+1)*(c+d*x)^(n-1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c^2+a*d^2,0] && EqQ[n+p-1,0] && LtQ[m,-1] && IntegerQ[p+1/2]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(m+n-1)*(a+b*x^2)^(p+1)/(b*d^(m-1)*(m+n+2*p+1)) + 
  1/(d^m*(m+n+2*p+1)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^p*
    ExpandToSum[(d^m*(m+n+2*p+1)*x^m-(m+n+2*p+1)*(c+d*x)^m+c*(c+d*x)^(m-2)*(c*(m+n-1)+c*(m+n+2*p+1)+2*d*(m+n+p)*x)),x],x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && IGtQ[m,1] && NeQ[m+n+2*p+1,0] && (IntegerQ[2*p] || ILtQ[m+n,0])


(* ::Code:: *)
(* Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[IncrementalExpand[(a+b*x^2)^p,x^m*(c+d*x)^n,x],x] /;
FreeQ[{a,b,c,d,m,n,p},x] && EqQ[b*c^2+a*d^2,0] && IntegerQ[2*p] && IGtQ[m,0] && ILtQ[n,0] *)


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[x^m*(c+d*x)^n*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,p},x] && EqQ[b*c^2+a*d^2,0] && IntegerQ[2*p] && IntegerQ[m] && ILtQ[n,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c^(2*n)/a^n \[Star] Int[(e*x)^m*(a+b*x^2)^(n+p)/(c-d*x)^n,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && EqQ[b*c^2+a*d^2,0] && ILtQ[n,0] (* && Not[IGtQ[m,0] && ILtQ[m+n,0] && Not[GtQ[p,1]]] *)


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[(e*x)^m*(c+d*x)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,e,m,n},x] && EqQ[b*c^2+a*d^2,0] && GtQ[a,0] && GtQ[c,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  a^p*c^IntPart[n]*(c+d*x)^FracPart[n]/(1+d*x/c)^FracPart[n] \[Star] Int[(e*x)^m*(1-d*x/c)^p*(1+d*x/c)^(n+p),x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && EqQ[b*c^2+a*d^2,0] && GtQ[a,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (a+b*x^2)^FracPart[p]/((c+d*x)^FracPart[p]*(a/c+(b*x)/d)^FracPart[p]) \[Star] Int[(e*x)^m*(c+d*x)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && EqQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_./((c_+d_.*x_)*(a_+b_.*x_^2)),x_Symbol] :=
  -c*d/(b*c^2+a*d^2) \[Star] Int[1/(c+d*x),x] + 1/(b*c^2+a*d^2) \[Star] Int[(a*d+b*c*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  c*(c+d*x)^(n+1)*(a+b*x^2)^(p+1)/(2*(p+1)*(b*c^2+a*d^2)) + 
  a*d/(b*c^2+a*d^2) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[Simplify[n+2*p+3],0] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(c+d*x)^(n+1)*(a+b*x^2)^p*(c*(a*d^2+b*c^2*(2*p+1))-d*(a*d^2*(n+1)+b*c^2*(n-2*p+1))*x)/
    (d^2*(n+1)*(n+2)*(b*c^2+a*d^2)) + 
  b*p/(d^2*(n+1)*(n+2)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^(n+2)*(a+b*x^2)^(p-1)*
    Simp[2*a*c*d*(n+2)-(2*a*d^2*(n+1)-2*b*c^2*(2*p+1))*x,x],x] /;
FreeQ[{a,b,c,d},x] && GtQ[p,0] && LtQ[n,-2] && LtQ[n+2*p,0] && Not[ILtQ[n+2*p+3,0]]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(c+d*x)^(n+1)*(a+b*x^2)^p*(c*(2*p+1)-d*(n+1)*x)/(d^2*(n+1)*(n+2*p+2)) + 
  2*p/(d^2*(n+1)*(n+2*p+2)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^(p-1)*(a*d*(n+1)+b*c*(2*p+1)*x),x] /;
FreeQ[{a,b,c,d},x] && GtQ[p,0] && LtQ[n,-1] && Not[ILtQ[n+2*p+1,0]]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -(c+d*x)^(n+1)*(a+b*x^2)^p*(c*(2*p+1)-d*(n+2*p+1)*x)/(d^2*(n+2*p+1)*(n+2*p+2)) + 
  2*p/(d^2*(n+2*p+1)*(n+2*p+2)) \[Star] 
    Int[(c+d*x)^n*(a+b*x^2)^(p-1)*Simp[a*c*d*n+(b*c^2*(2*p+1)+a*d^2*(n+2*p+1))*x,x],x] /;
FreeQ[{a,b,c,d,n},x] && GtQ[p,0] && LeQ[-1,n,0] && Not[ILtQ[n+2*p,0]]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^n*(a+b*x^2)^(p+1)/(2*b*(p+1)) - d*n/(2*b*(p+1)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d},x] && LtQ[p,-1] && GtQ[n,0] && (IntegerQ[n] || IntegerQ[p] || IntegersQ[2*n,2*p])


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(n+1)*(c-d*x)*(a+b*x^2)^(p+1)/(2*(p+1)*(b*c^2+a*d^2)) - 
  d/(2*(p+1)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^(p+1)*(c*n-d*(n+2*p+4)*x),x] /;
FreeQ[{a,b,c,d,n},x] && LtQ[p,-1] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  -c*(c+d*x)^(n+1)*(a+b*x^2)^(p+1)/((n+1)*(b*c^2+a*d^2)) + 
  1/((n+1)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^p*(a*d*(n+1)+b*c*(n+2*p+3)*x),x] /;
FreeQ[{a,b,c,d,p},x] && LtQ[n,-1] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  (c+d*x)^n/(b*n) - 1/b \[Star] Int[(c+d*x)^(n-1)*(a*d-b*c*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d},x] && GtQ[n,0]


(* ::Code:: *)
Int[x_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^n*(a+b*x^2)^(p+1)/(b*(n+2*p+2)) - 
  n/(b*(n+2*p+2)) \[Star] Int[(c+d*x)^(n-1)*(a+b*x^2)^p*(a*d-b*c*x),x] /;
FreeQ[{a,b,c,d,p},x] && GtQ[n,0] && NeQ[n+2*p+2,0]


(* ::Code:: *)
Int[x_/((c_+d_.*x_)*(a_+b_.*x_^2)^(3/4)),x_Symbol] :=
  With[{q=Rt[-a,4]},
  c/(2*d^2*q^3)*ArcTan[c*q*(a+b*x^2)^(1/4)/(q^2*(c+d*x)-c*Sqrt[a+b*x^2])] + 
  c/(2*d^2*q^3)*ArcTanh[c*q*(a+b*x^2)^(1/4)/(q^2*(c+d*x)+c*Sqrt[a+b*x^2])]] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+2*a*d^2,0] && NegQ[a]


(* ::Code:: *)
Int[x_/((c_+d_.*x_)*(a_+b_.*x_^2)^(3/4)),x_Symbol] :=
  (-a-b*x^2)^(3/4)/(a+b*x^2)^(3/4) \[Star] Int[x/((c+d*x)*(-a-b*x^2)^(3/4)),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^2+2*a*d^2,0] && PosQ[a]


(* ::Code:: *)
Int[(A_.+B_.*x_)/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  -2/d^2 \[Star] Subst[Int[(B*c-A*d-B*x^2)/Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2],x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d,A,B},x] && PosQ[b/a]


(* ::Code:: *)
Int[(A_.+B_.*x_)/(Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  B/d \[Star] Int[Sqrt[c+d*x]/Sqrt[a+b*x^2],x] - (B*c-A*d)/d \[Star] Int[1/(Sqrt[c+d*x]*Sqrt[a+b*x^2]),x] /;
FreeQ[{a,b,c,d,A,B},x] && NegQ[b/a]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m*(c+d*x)^n,a+b*x^2,x],
        e=Coeff[PolynomialRemainder[x^m*(c+d*x)^n,a+b*x^2,x],x,0],
        f=Coeff[PolynomialRemainder[x^m*(c+d*x)^n,a+b*x^2,x],x,1]},
  (a*f-b*e*x)*(a+b*x^2)^(p+1)/(2*a*b*(p+1)) + 
  1/(2*a*(p+1)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^(p+1)*ExpandToSum[2*a*(p+1)*(c+d*x)^(-n)*Qx+e*(2*p+3)*(c+d*x)^(-n),x],x]] /;
FreeQ[{a,b,c,d},x] && IGtQ[m,1] && LtQ[p,-1] && ILtQ[n,0] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m,a+b*x^2,x],
        e=Coeff[PolynomialRemainder[x^m,a+b*x^2,x],x,0],
        f=Coeff[PolynomialRemainder[x^m,a+b*x^2,x],x,1]},
  -(c+d*x)^(n+1)*(a+b*x^2)^(p+1)*(a*(d*e-c*f)+(b*c*e+a*d*f)*x)/(2*a*(p+1)*(b*c^2+a*d^2)) + 
  1/(2*a*(p+1)*(b*c^2+a*d^2)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^(p+1)*
    ExpandToSum[2*a*(p+1)*(b*c^2+a*d^2)*Qx+e*(b*c^2*(2*p+3)+a*d^2*(n+2*p+3))-a*c*d*f*n+d*(b*c*e+a*d*f)*(n+2*p+4)*x,x],x]] /;
FreeQ[{a,b,c,d,n},x] && IGtQ[m,1] && LtQ[p,-1] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[x^m,c+d*x,x], R=PolynomialRemainder[x^m,c+d*x,x]},
  d*R*(c+d*x)^(n+1)*(a+b*x^2)^(p+1)/((n+1)*(b*c^2+a*d^2)) + 
  1/((n+1)*(b*c^2+a*d^2)) \[Star] 
    Int[(c+d*x)^(n+1)*(a+b*x^2)^p*ExpandToSum[(n+1)*(b*c^2+a*d^2)*Qx+b*c*R*(n+1)-b*d*R*(n+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,p},x] && IGtQ[m,1] && LtQ[n,-1] && NeQ[b*c^2+a*d^2,0]


(* ::Code:: *)
Int[x_^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^(m+n-1)*(a+b*x^2)^(p+1)/(b*d^(m-1)*(m+n+2*p+1)) + 
  1/(b*d^m*(m+n+2*p+1)) \[Star] Int[(c+d*x)^n*(a+b*x^2)^p*
    ExpandToSum[(b*d^m*(m+n+2*p+1)*x^m-b*(m+n+2*p+1)*(c+d*x)^m-(c+d*x)^(m-2)*(a*d^2*(m+n-1)-b*c^2*(m+n+2*p+1)-2*b*c*d*(m+n+p)*x)),x],x] /;
FreeQ[{a,b,c,d,n,p},x] && IGtQ[m,1] && NeQ[m+n+2*p+1,0] && IntegerQ[2*p]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  1/d \[Star] Int[x^(m-1)*(a+b*x^2)^p,x] - c/d \[Star] Int[x^(m-1)*(a+b*x^2)^p/(c+d*x),x] /;
FreeQ[{a,b,c,d,p},x] && IGtQ[m,0] && LtQ[-1,p,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_/x_,x_Symbol] :=
  a/c \[Star] Int[(c+d*x)^(n+1)*(a+b*x^2)^(p-1)/x,x] - 
  1/c \[Star] Int[(c+d*x)^n*(a*d-b*c*x)*(a+b*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d},x] && GtQ[p,0] && ILtQ[n,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  e*d/b \[Star] Int[(e*x)^(m-1)*(c+d*x)^(n-2)*(2*c+d*x),x] - 
  e/b \[Star] Int[(e*x)^(m-1)*(c+d*x)^(n-2)*Simp[2*a*c*d-(b*c^2-a*d^2)*x,x]/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e},x] && GtQ[n,1] && GtQ[m,0] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  e^2/b \[Star] Int[(e*x)^(m-2)*(c+d*x)^n,x] - a*e^2/b \[Star] Int[(e*x)^(m-2)*(c+d*x)^n/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e},x] && LtQ[0,n,1] && GtQ[m,1] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  d*e/b \[Star] Int[(e*x)^(m-1)*(c+d*x)^(n-1),x] - 
  e/b \[Star] Int[(e*x)^(m-1)*(c+d*x)^(n-1)*(a*d-b*c*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e},x] && LtQ[0,n,1] && LtQ[0,m,1] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  e^(m+1/2) \[Star] Int[ExpandIntegrand[1/(Sqrt[e*x]*Sqrt[c+d*x]),x^(m+1/2)*(c+d*x)^(n+1/2)/(a+b*x^2),x],x] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[n+1/2,0] && ILtQ[m-1/2,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  c/a \[Star] Int[(e*x)^m*(c+d*x)^(n-1),x] + 
  1/(a*e) \[Star] Int[((e*x)^(m+1)*(c+d*x)^(n-1)*(a*d-b*c*x))/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e},x] && GtQ[n,0] && LtQ[m,-1] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/(a_+b_.*x_^2),x_Symbol] :=
  -e*c*d/(b*c^2+a*d^2) \[Star] Int[(e*x)^(m-1)*(c+d*x)^n,x] + 
  e/(b*c^2+a*d^2) \[Star] Int[(e*x)^(m-1)*(c+d*x)^(n+1)*(a*d+b*c*x)/(a+b*x^2),x] /;
FreeQ[{a,b,c,d,e},x] && LtQ[n,-1] && GtQ[m,0] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[Sqrt[e_.*x_]/(Sqrt[c_+d_.*x_]*(a_+b_.*x_^2)),x_Symbol] :=
  e/(2*b) \[Star] Int[1/(Sqrt[e*x]*Sqrt[c+d*x]*(Rt[-a/b,2]+x)),x] - 
  e/(2*b) \[Star] Int[1/(Sqrt[e*x]*Sqrt[c+d*x]*(Rt[-a/b,2]-x)),x] /;
FreeQ[{a,b,c,d,e},x]


(* ::Code:: *)
Int[(e_.*x_)^m_/(Sqrt[c_+d_.*x_]*(a_+b_.*x_^2)),x_Symbol] :=
  e^(m+1/2) \[Star] Int[ExpandIntegrand[1/(Sqrt[e*x]*Sqrt[c+d*x]),x^(m+1/2)/(a+b*x^2),x],x] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[m-1/2,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(e*x)^m*(c+d*x)^n*(a+b*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,m,n},x] && ILtQ[p,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  With[{k=Denominator[m]},
  k/e \[Star] Subst[Int[x^(k*(m+1)-1)*(c+d*x^k/e)^n*(a+b*x^(2*k)/e^2)^p,x],x,(e*x)^(1/k)]] /;
FreeQ[{a,b,c,d,e,p},x] && ILtQ[n,0] && FractionQ[m]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p,x^m*(c+d*x)^n,x],x] /;
FreeQ[{a,b,c,d,p},x] && ILtQ[n,0] && IntegerQ[m] && IntegerQ[2*p]


(* ::Code:: *)
Int[Sqrt[e_.*x_]/((c_+d_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  e/d \[Star] Int[1/(Sqrt[e*x]*Sqrt[a+b*x^2]),x] - 
  c*e/d \[Star] Int[1/(Sqrt[e*x]*(c+d*x)*Sqrt[a+b*x^2]),x] /;
FreeQ[{a,b,c,d,e},x]


(* ::Code:: *)
Int[1/(Sqrt[e_.*x_]*(c_+d_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  1/Sqrt[a] \[Star] Int[1/(Sqrt[e*x]*(c+d*x)*Sqrt[1-Rt[-b/a,2]*x]*Sqrt[1+Rt[-b/a,2]*x]),x] /;
FreeQ[{a,b,c,d,e},x] && GtQ[a,0]


(* ::Code:: *)
Int[1/(Sqrt[e_.*x_]*(c_+d_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  Sqrt[1+b*x^2/a]/Sqrt[a+b*x^2] \[Star] Int[1/(Sqrt[e*x]*(c+d*x)*Sqrt[1+b*x^2/a]),x] /;
FreeQ[{a,b,c,d,e},x] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^2)^p_/(c_+d_.*x_),x_Symbol] :=
  c \[Star] Int[x^m*(a+b*x^2)^p/(c^2-d^2*x^2),x] - d \[Star] Int[x^(m+1)*(a+b*x^2)^p/(c^2-d^2*x^2),x] /;
FreeQ[{a,b,c,d,m,p},x]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[x^m*(a+b*x^2)^p,(c/(c^2-d^2*x^2)-d*x/(c^2-d^2*x^2))^(-n),x],x] /;
FreeQ[{a,b,c,d,m,p},x] && ILtQ[n,-1]


(* ::Code:: *)
Int[(e_*x_)^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  (e*x)^m/x^m \[Star] Int[x^m*(c+d*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && ILtQ[n,0]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  1/d \[Star] Int[x^(m-1)*(c+d*x)^(n+1)*(a+b*x^2)^p,x] - c/d \[Star] Int[x^(m-1)*(c+d*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && IGtQ[m,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2]/(x_*Sqrt[c_+d_.*x_]),x_Symbol] :=
  -2 \[Star] Subst[Int[Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2]/(c-x^2),x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*Sqrt[a_+b_.*x_^2]/x_,x_Symbol] :=
  a*c^(n+1/2) \[Star] Int[1/(x*Sqrt[c+d*x]*Sqrt[a+b*x^2]),x] + 
  Int[1/(Sqrt[c+d*x]*Sqrt[a+b*x^2])*ExpandToSum[(-a*c^(n+1/2)+a*(c+d*x)^(n+1/2)+b*x^2*(c+d*x)^(n+1/2))/x,x],x] /;
FreeQ[{a,b,c,d},x] && IGtQ[n+3/2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_*Sqrt[a_+b_.*x_^2]/x_,x_Symbol] :=
  a*c^(n+1/2) \[Star] Int[1/(x*Sqrt[c+d*x]*Sqrt[a+b*x^2]),x] + 
  Int[(c+d*x)^n/Sqrt[a+b*x^2]*ExpandToSum[(a+b*x^2-a*c^(n+1/2)*(c+d*x)^(-n-1/2))/x,x],x] /;
FreeQ[{a,b,c,d},x] && ILtQ[n+1/2,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_*Sqrt[a_+b_.*x_^2],x_Symbol] :=
  c^(n-1/2)*(e*x)^(m+1)*Sqrt[c+d*x]*Sqrt[a+b*x^2]/(e*(m+1)) - 
  1/(2*e*(m+1)) \[Star] Int[(e*x)^(m+1)/(Sqrt[c+d*x]*Sqrt[a+b*x^2])*
    ExpandToSum[(2*a*c^(n+1/2)*(m+1)+a*c^(n-1/2)*d*(2*m+3)*x+2*b*c^(n+1/2)*(m+2)*x^2+b*c^(n-1/2)*d*(2*m+5)*x^3-
      2*a*(m+1)*(c+d*x)^(n+1/2)-2*b*(m+1)*x^2*(c+d*x)^(n+1/2))/x,x],x] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[n+3/2,0] && LtQ[m,-1] && IntegerQ[2*m]


(* ::Code:: *)
Int[(e_.*x_)^m_.*Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2],x_Symbol] :=
  2*(e*x)^(m+1)*Sqrt[c+d*x]*Sqrt[a+b*x^2]/(e*(2*m+5)) + 
  1/(2*m+5) \[Star] Int[(e*x)^m*(3*a*c+2*a*d*x+b*c*x^2)/(Sqrt[c+d*x]*Sqrt[a+b*x^2]),x] /;
FreeQ[{a,b,c,d,e,m},x] && Not[LtQ[m,-1]] && IntegerQ[2*m]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]/(x_*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  -2 \[Star] Subst[Int[x^2/((c-x^2)*Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2]),x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a]


(* ::Code:: *)
Int[1/(x_*Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  -2 \[Star] Subst[Int[1/((c-x^2)*Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2]),x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d},x] && PosQ[b/a]


(* ::Code:: *)
Int[1/(x_*Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  1/Sqrt[a] \[Star] Int[1/(x*Sqrt[c+d*x]*Sqrt[1-q*x]*Sqrt[1+q*x]),x]] /;
FreeQ[{a,b,c,d},x] && NegQ[b/a] && GtQ[a,0]


(* ::Code:: *)
Int[1/(x_*Sqrt[c_+d_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  Sqrt[1+b*x^2/a]/Sqrt[a+b*x^2] \[Star] Int[1/(x*Sqrt[c+d*x]*Sqrt[1+b*x^2/a]),x] /;
FreeQ[{a,b,c,d},x] && NegQ[b/a] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(x_*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  c^(n+1/2) \[Star] Int[1/(x*Sqrt[c+d*x]*Sqrt[a+b*x^2]),x] - 
  Int[1/(Sqrt[c+d*x]*Sqrt[a+b*x^2])*ExpandToSum[(c^(n+1/2)-(c+d*x)^(n+1/2))/x,x],x] /;
FreeQ[{a,b,c,d},x] && IGtQ[n-1/2,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^n_/(x_*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  c^(n+1/2) \[Star] Int[1/(x*Sqrt[c+d*x]*Sqrt[a+b*x^2]),x] + 
  Int[(c+d*x)^n/Sqrt[a+b*x^2]*ExpandToSum[(1-c^(n+1/2)*(c+d*x)^(-n-1/2))/x,x],x] /;
FreeQ[{a,b,c,d},x] && ILtQ[n+1/2,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(c_+d_.*x_)^n_/Sqrt[a_+b_.*x_^2],x_Symbol] :=
  c^(n-1/2)*(e*x)^(m+1)*Sqrt[c+d*x]*Sqrt[a+b*x^2]/(a*e*(m+1)) - 
  1/(2*a*e*(m+1)) \[Star] Int[(e*x)^(m+1)/(Sqrt[c+d*x]*Sqrt[a+b*x^2])*
     ExpandToSum[(2*a*c^(n+1/2)*(m+1)+a*c^(n-1/2)*d*(2*m+3)*x+2*b*c^(n+1/2)*(m+2)*x^2+b*c^(n-1/2)*d*(2*m+5)*x^3-2*a*(m+1)*(c+d*x)^(n+1/2))/x,x],x] /;
FreeQ[{a,b,c,d,e},x] && IGtQ[n+3/2,0] && LtQ[m,-1] && IntegerQ[2*m]


(* ::Code:: *)
Int[x_^m_.*(c_+d_.*x_)^n_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x^2)^p/Sqrt[c+d*x],x^m*(c+d*x)^(n+1/2),x],x] /;
FreeQ[{a,b,c,d,m},x] && IntegerQ[p+1/2] && IntegerQ[n+1/2] && IntegerQ[m]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Unintegrable[(e*x)^m*(c+d*x)^n*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,n,p},x]


(* ::Code:: *)
(* Int[(g_.*x_)^n_*(d_+e_.*x_)^m_.*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(d+e*x)^m,g*x,x], R=PolynomialRemainder[(d+e*x)^m,g*x,x]},
  R*(g*x)^(n+1)*(a+c*x^2)^(p+1)/(a*g*(n+1)) + 
  1/(a*g*(n+1)) \[Star] Int[(g*x)^(n+1)*(a+c*x^2)^p*ExpandToSum[a*g*(n+1)*Qx-c*R*(n+2*p+3)*x,x],x]] /;
FreeQ[{a,c,d,e,g,p},x] && IGtQ[m,0] && LtQ[n,-1] && (IntegerQ[2*p] || NeQ[m,1]) *)


(* ::Code:: *)
(* Int[(g_.*x_)^n_.*(a_+c_.*x_^2)^p_./(d_+e_.*x_),x_Symbol] :=
  a/d \[Star] Int[(g*x)^n*(a+c*x^2)^(p-1),x] + c/(e*g) \[Star] Int[(g*x)^(n+1)*(a+c*x^2)^(p-1),x] /;
FreeQ[{a,c,d,e,g,n,p},x] && EqQ[c*d^2+a*e^2,0] && Not[GtQ[p,0] && IGtQ[n,0]] *)


(* ::Code:: *)
(* Int[x_^2*(f_+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  f*(f+g*x)*(a+c*x^2)^(p+1)/(2*c*g*(p+1)) - 1/(2*c*(p+1)) \[Star] Int[(f-2*g*(p+1)*x)*(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,f,g},x] && EqQ[c*f^2+a*g^2,0] && LtQ[p,-1] *)


(* ::Code:: *)
(* Int[x_^2*(f_+g_.*x_)/Sqrt[a_+c_.*x_^2],x_Symbol] :=
  g*(a+c*x^2)^(3/2)/(3*c^2) + f/g \[Star] Int[(x*(f+g*x))/Sqrt[a+c*x^2],x] /;
FreeQ[{a,c,f,g},x] && EqQ[c*f^2+a*g^2,0] *)


(* ::Code:: *)
(* Int[x_^2*(f_+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  g*x^2*(a+c*x^2)^(p+1)/(2*c*(p+2)) - 1/(c*(p+2)) \[Star] Int[x*(a*g-c*f*(p+2)*x)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,f,g,p},x] && EqQ[c*f^2+a*g^2,0] *)




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.9 (c+d x)^m (e+f x)^n (a+b x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[(c+d*x)^(m+p)*(e+f*x)^n*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && EqQ[b*c^2+a*d^2,0] && (IntegerQ[p] || GtQ[a,0] && GtQ[c,0] && Not[IntegerQ[m]])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (g/e)^n \[Star] Int[(d+e*x)^(m+n)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[e*f-d*g,0] && IntegerQ[n] && Not[IntegerQ[m] && SimplerQ[f+g*x,d+e*x]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (e/g)^m \[Star] Int[(f+g*x)^(m+n)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && EqQ[e*f-d*g,0] && GtQ[e/g,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^m/(f+g*x)^m \[Star] Int[(f+g*x)^(m+n)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && EqQ[e*f-d*g,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2)^p_.,x_Symbol] :=
  Int[(c*e+d*f*x^2)^m*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && EqQ[m,n] && EqQ[d*e+c*f,0] && (IntegerQ[m] || GtQ[c,0] && GtQ[e,0])


(* ::Code:: *)
Int[(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2),x_Symbol] :=
  a*x*(c+d*x)^(m+1)*(e+f*x)^(n+1)/(c*e) /;
FreeQ[{a,b,c,d,e,f,m,n},x] && EqQ[m,n] && EqQ[d*e+c*f,0] && EqQ[b*c*e-a*d*f*(2*m+3),0]


(* ::Code:: *)
Int[(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2),x_Symbol] :=
  (b*c*e-a*d*f)*x*(c+d*x)^(m+1)*(e+f*x)^(n+1)/(2*c*d*e*f*(m+1)) - 
  (b*c*e-a*d*f*(2*m+3))/(2*c*d*e*f*(m+1)) \[Star] Int[(c+d*x)^(m+1)*(e+f*x)^(n+1),x] /;
FreeQ[{a,b,c,d,e,f,m,n},x] && EqQ[m,n] && EqQ[d*e+c*f,0] && LtQ[m,-1]


(* ::Code:: *)
Int[(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2),x_Symbol] :=
  b*x*(c+d*x)^(m+1)*(e+f*x)^(n+1)/(d*f*(2*m+3)) - 
  (b*c*e-a*d*f*(2*m+3))/(d*f*(2*m+3)) \[Star] Int[(c+d*x)^m*(e+f*x)^n,x] /;
FreeQ[{a,b,c,d,e,f,m,n},x] && EqQ[m,n] && EqQ[d*e+c*f,0] && Not[LtQ[m,-1]]


(* ::Code:: *)
Int[Sqrt[c_+d_.*x_]*Sqrt[e_+f_.*x_]/(a_.+b_.*x_^2),x_Symbol] :=
  d*f/b \[Star] Int[1/(Sqrt[c+d*x]*Sqrt[e+f*x]),x] + 
  1/b \[Star] Int[(b*c*e-a*d*f)/(Sqrt[c+d*x]*Sqrt[e+f*x]*(a+b*x^2)),x] /;
FreeQ[{a,b,c,d,e,f},x] && EqQ[d*e+c*f,0]


(* ::Code:: *)
Int[(c_+d_.*x_)^m_.*(e_+f_.*x_)^n_.*(a_.+b_.*x_^2)^p_,x_Symbol] :=
  (c+d*x)^FracPart[m]*(e+f*x)^FracPart[m]/(c*e+d*f*x^2)^FracPart[m] \[Star] Int[(c*e+d*f*x^2)^m*(a+b*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && EqQ[m,n] && EqQ[d*e+c*f,0] && Not[EqQ[p,2] && LtQ[m,-1]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  2/e^(n+2*p+1) \[Star] Subst[Int[x^(2*m+1)*(e*f-d*g+g*x^2)^n*(c*d^2+a*e^2-2*c*d*x^2+c*x^4)^p,x],x,Sqrt[d+e*x]] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[p,0] && ILtQ[n,0] && IntegerQ[m+1/2]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(a+c*x^2)^p,d+e*x,x],R=PolynomialRemainder[(a+c*x^2)^p,d+e*x,x]},
  R*(d+e*x)^(m+1)*(f+g*x)^(n+1)/((m+1)*(e*f-d*g)) + 
  1/((m+1)*(e*f-d*g)) \[Star] Int[(d+e*x)^(m+1)*(f+g*x)^n*ExpandToSum[(m+1)*(e*f-d*g)*Qx-g*R*(m+n+2),x],x]] /;
FreeQ[{a,c,d,e,f,g,n},x] && IGtQ[p,0] && ILtQ[2*m,-2] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  c^p*(d+e*x)^(m+2*p)*(f+g*x)^(n+1)/(g*e^(2*p)*(m+n+2*p+1)) + 
  1/(g*e^(2*p)*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(f+g*x)^n*
    ExpandToSum[g*(m+n+2*p+1)*(e^(2*p)*(a+c*x^2)^p-c^p*(d+e*x)^(2*p))-c^p*(e*f-d*g)*(m+2*p)*(d+e*x)^(2*p-1),x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[p,0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(a+c*x^2)^p,x],x] /;
FreeQ[{a,c,d,e,f,g,m,n},x] && IGtQ[p,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)/(a_+c_.*x_^2),x_Symbol] :=
  g*(d+e*x)^m/(c*m) + 
  1/c \[Star] Int[(d+e*x)^(m-1)*Simp[c*d*f-a*e*g+(g*c*d+c*e*f)*x,x]/(a+c*x^2),x] /;
FreeQ[{a,c,d,e,f,g},x] && FractionQ[m] && GtQ[m,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)/(Sqrt[d_.+e_.*x_]*(a_+c_.*x_^2)),x_Symbol] :=
  2 \[Star] Subst[Int[(e*f-d*g+g*x^2)/(c*d^2+a*e^2-2*c*d*x^2+c*x^4),x],x,Sqrt[d+e*x]] /;
FreeQ[{a,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)/(a_+c_.*x_^2),x_Symbol] :=
  (e*f-d*g)*(d+e*x)^(m+1)/((m+1)*(c*d^2+a*e^2)) + 
  1/(c*d^2+a*e^2) \[Star] Int[(d+e*x)^(m+1)*Simp[c*d*f+a*e*g-c*(e*f-d*g)*x,x]/(a+c*x^2),x] /;
FreeQ[{a,c,d,e,f,g},x] && FractionQ[m] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_+c_.*x_^2),x_Symbol] :=
  With[{q=Denominator[m]},
  q/e \[Star] Subst[Int[ExpandIntegrand[x^(q*(m+1)-1)*((e*f-d*g)/e+g*x^q/e)^n/((c*d^2+a*e^2)/e^2-2*c*d*x^q/e^2+c*x^(2*q)/e^2),x],x],x,(d+e*x)^(1/q)]] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[n] && FractionQ[m]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_./(a_+c_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n/(a+c*x^2),x],x] /;
FreeQ[{a,c,d,e,f,g,m},x] && IntegersQ[n]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_+c_.*x_^2),x_Symbol] :=
  g/c \[Star] Int[Simp[2*e*f+d*g+e*g*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n-2),x] + 
  1/c \[Star] Int[Simp[c*d*f^2-2*a*e*f*g-a*d*g^2+(c*e*f^2+2*c*d*f*g-a*e*g^2)*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n-2)/(a+c*x^2),x] /;
FreeQ[{a,c,d,e,f,g},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m,0] && GtQ[n,1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_+c_.*x_^2),x_Symbol] :=
  e*g/c \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^(n-1),x] + 
  1/c \[Star] Int[Simp[c*d*f-a*e*g+(c*e*f+c*d*g)*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n-1)/(a+c*x^2),x] /;
FreeQ[{a,c,d,e,f,g},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m,0] && GtQ[n,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_+c_.*x_^2),x_Symbol] :=
  -g*(e*f-d*g)/(c*f^2+a*g^2) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^n,x] + 
  1/(c*f^2+a*g^2) \[Star] 
    Int[Simp[c*d*f+a*e*g+c*(e*f-d*g)*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n+1)/(a+c*x^2),x] /;
FreeQ[{a,c,d,e,f,g},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m,0] && LtQ[n,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_/(Sqrt[f_.+g_.*x_]*(a_.+c_.*x_^2)),x_Symbol] :=
  Int[ExpandIntegrand[1/(Sqrt[d+e*x]*Sqrt[f+g*x]),(d+e*x)^(m+1/2)/(a+c*x^2),x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[m+1/2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_+c_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n,1/(a+c*x^2),x],x] /;
FreeQ[{a,c,d,e,f,g,m,n},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Rt[-a*c,2]},
    1/c^p \[Star] Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(-q+c*x)^p*(q+c*x)^p,x],x] /;
 Not[FractionalPowerFactorQ[q]]] /;
FreeQ[{a,c,d,e,f,g},x] && ILtQ[p,-1] && IntegersQ[m,n] && NiceSqrtQ[-a*c]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^2*(a_.+c_.*x_^2)^p_.,x_Symbol] :=
  g^2*(d+e*x)^(m+1)*(a+c*x^2)^(p+1)/(c*e*(m+2*p+3)) /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[d*g*(p+1)-e*f*(m+2*p+3),0] && 
  EqQ[e*(c*f^2+a*g^2)*(m+1)+2*c*f*(e*f-d*g)*(p+1),0] && NeQ[m+2*p+3,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_./(a_+c_.*x_^2)^(3/2),x_Symbol] :=
  -2^(m-1)*d^(m-2)*(e*f+d*g)^n*(d+e*x)/(c*e^(n-1)*Sqrt[a+c*x^2]) + 
  1/(c*e^(n-2)) \[Star] Int[ExpandToSum[(2^(m-1)*d^(m-1)*(e*f+d*g)^n-e^n*(d+e*x)^(m-1)*(f+g*x)^n)/(d-e*x),x]/Sqrt[a+c*x^2],x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && IGtQ[m,0] && IGtQ[n,0]


(* ::Code:: *)
Int[x_^n_.*(d_.+e_.*x_)^m_./(a_+c_.*x_^2)^(3/2),x_Symbol] :=
  -2^(m-1)*d^(m+n-2)*(d+e*x)/(c*e^(n-1)*Sqrt[a+c*x^2]) + 
  d^2/a \[Star] Int[ExpandToSum[((d+e*x)^(m-1)-2^(m-1)*d^(m+n-1)*e^(-n)*x^(-n))/(d-e*x),x]/(x^(-n)*Sqrt[a+c*x^2]),x] /;
FreeQ[{a,c,d,e},x] && EqQ[c*d^2+a*e^2,0] && IGtQ[m,0] && ILtQ[n,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  Int[(a/d+c*x/e)*(f+g*x)^n*(a+c*x^2)^(p-1),x] /;
FreeQ[{a,c,d,e,f,g,n,p},x] && EqQ[c*d^2+a*e^2,0] && GtQ[p,0]


(* ::Code:: *)
(* Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_.*Sqrt[a_+c_.*x_^2],x_Symbol] :=
  d^(2*m)/a^m \[Star] Int[(d-e*x)^(-m)*(f+g*x)^n*(a+c*x^2)^(m+1/2),x] /;
FreeQ[{a,c,d,e,f,g,n},x] && EqQ[c*d^2+a*e^2,0] && ILtQ[m,0] && IntegerQ[n] *)


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  g*(d+e*x)^m*(a+c*x^2)^(p+1)/(c*(m+2*p+2)) /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[c*e*f*(m+2*p+2)+c*d*g*m,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d*g+e*f)*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*c*d*(p+1)) - 
  e*(m*(d*g+e*f)+2*e*f*(p+1))/(2*c*d*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && LtQ[p,-1] && GtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d*g+e*f)*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*c*d*(p+1)) - 
  e*(m*(d*g+e*f)+2*e*f*(p+1))/(2*c*d*(p+1)) \[Star] Int[(d+e*x)^Simplify[m-1]*(a+c*x^2)^Simplify[p+1],x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && SumSimplerQ[p,1] && SumSimplerQ[m,-1] && NeQ[p,-1] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d*g-e*f)*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*c*d*(m+p+1)) + 
  (m*(g*c*d+c*e*f)+2*e*c*f*(p+1))/(e*(2*c*d)*(m+p+1)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && 
  (LtQ[m,-1] && Not[IGtQ[m+p+1,0]] || LtQ[m,0] && LtQ[p,-1] || EqQ[m+2*p+2,0]) && NeQ[m+p+1,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  g*(d+e*x)^m*(a+c*x^2)^(p+1)/(c*(m+2*p+2)) + 
  (m*(d*g+e*f)+2*e*f*(p+1))/(e*(m+2*p+2)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && NeQ[m+2*p+2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  ((e*f+d*g)*(2*p+3)+2*e*g*(p+1)*x)*(a+c*x^2)^(p+1)/(2*c*(p+1)*(2*p+3)) /;
FreeQ[{a,c,d,e,f,g,p},x] && EqQ[a*e*g-c*d*f*(2*p+3),0] && NeQ[p,-1]


(* ::Code:: *)
Int[x_*(d_+e_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)*(a+c*x^2)^(p+1)/(2*c*(p+1)) - 
  e/(2*c*(p+1)) \[Star] Int[(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e},x] && LtQ[p,-1] && Not[IntegerQ[p] && NiceSqrtQ[-a*c]]


(* ::Code:: *)
Int[(d_+e_.*x_)*(f_+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  a*(e*f+d*g)*(a+c*x^2)^(p+1)/(2*a*c*(p+1)) - 
  (c*d*f-a*e*g)*x*(a+c*x^2)^(p+1)/(2*a*c*(p+1)) - 
  (a*e*g-c*d*f*(2*p+3))/(2*a*c*(p+1)) \[Star] Int[(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e,f,g},x] && LtQ[p,-1] && Not[IntegerQ[p] && NiceSqrtQ[-a*c]]


(* ::Code:: *)
Int[(d_.+e_.*x_)*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (e*f+d*g)*(a+c*x^2)^(p+1)/(2*c*(p+1)) + 
  e*g*x*(a+c*x^2)^(p+1)/(c*(2*p+3)) - 
  (a*e*g-c*d*f*(2*p+3))/(c*(2*p+3)) \[Star] Int[(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,p},x] && Not[LeQ[p,-1]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  -(e*f-d*g)*(d+e*x)^(m+1)*(a+c*x^2)^(p+1)/(2*(p+1)*(c*d^2+a*e^2)) /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[Simplify[m+2*p+3],0] && EqQ[c*d*f+a*e*g,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^m*(a+c*x^2)^(p+1)*(a*g-c*f*x)/(2*a*c*(p+1)) - 
  m*(c*d*f+a*e*g)/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[Simplify[m+2*p+3],0] && LtQ[p,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  -(e*f-d*g)*(d+e*x)^(m+1)*(a+c*x^2)^(p+1)/(2*(p+1)*(c*d^2+a*e^2)) + 
  (c*d*f+a*e*g)/(c*d^2+a*e^2) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[Simplify[m+2*p+3],0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  -(d+e*x)^(m+1)*(a+c*x^2)^p/(e^2*(m+1)*(m+2)*(c*d^2+a*e^2))*
    ((d*g-e*f*(m+2))*(c*d^2+a*e^2)-2*c*d^2*p*(e*f-d*g)-e*(g*(m+1)*(c*d^2+a*e^2)+2*c*d*p*(e*f-d*g))*x) - 
  p/(e^2*(m+1)*(m+2)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+2)*(a+c*x^2)^(p-1)*
    Simp[2*a*c*e*(e*f-d*g)*(m+2)-c*(2*c*d*(d*g*(2*p+1)-e*f*(m+2*p+2))-2*a*e^2*g*(m+1))*x,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && GtQ[p,0] && LtQ[m,-2] && LtQ[m+2*p,0] && Not[ILtQ[m+2*p+3,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^(m+1)*(e*f*(m+2*p+2)-d*g*(2*p+1)+e*g*(m+1)*x)*(a+c*x^2)^p/(e^2*(m+1)*(m+2*p+2)) + 
  p/(e^2*(m+1)*(m+2*p+2)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^(p-1)*
    Simp[g*(2*a*e+2*a*e*m)+(g*(2*c*d+4*c*d*p)-2*c*e*f*(m+2*p+2))*x,x],x] /;
FreeQ[{a,c,d,e,f,g,m},x] && GtQ[p,0] && 
  (LtQ[m,-1] || EqQ[p,1] || IntegerQ[p] && Not[RationalQ[m]]) && NeQ[m,-1] && Not[ILtQ[m+2*p+1,0]] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^(m+1)*(c*e*f*(m+2*p+2)-g*c*d*(2*p+1)+g*c*e*(m+2*p+1)*x)*(a+c*x^2)^p/
    (c*e^2*(m+2*p+1)*(m+2*p+2)) + 
  2*p/(c*e^2*(m+2*p+1)*(m+2*p+2)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^(p-1)*
    Simp[f*a*c*e^2*(m+2*p+2)+a*c*d*e*g*m-(c^2*f*d*e*(m+2*p+2)-g*(c^2*d^2*(2*p+1)+a*c*e^2*(m+2*p+1)))*x,x],x] /;
FreeQ[{a,c,d,e,f,g,m},x] && 
  GtQ[p,0] && (IntegerQ[p] || Not[RationalQ[m]] || GeQ[m,-1] && LtQ[m,0]) && Not[ILtQ[m+2*p,0]] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Int[(a+c*x^2)^p*ExpandIntegrand[(d+e*x)^m*(f+g*x),x],x] /;
FreeQ[{a,c,d,e,f,g},x] && ILtQ[p,-1] && IGtQ[m,0] && RationalQ[a,c,d,e,f,g]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^(m-1)*(a+c*x^2)^(p+1)*(a*(e*f+d*g)-(c*d*f-a*e*g)*x)/(2*a*c*(p+1)) - 
  1/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^(m-2)*(a+c*x^2)^(p+1)*
    Simp[a*e*(e*f*(m-1)+d*g*m)-c*d^2*f*(2*p+3)+e*(a*e*g*m-c*d*f*(m+2*p+2))*x,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && LtQ[p,-1] && GtQ[m,1] && 
  (EqQ[d,0] || EqQ[m,2] && EqQ[p,-3] && RationalQ[a,c,d,e,f,g] || Not[ILtQ[m+2*p+3,0]])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^m*(a+c*x^2)^(p+1)*(a*g-c*f*x)/(2*a*c*(p+1)) - 
  1/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1)*Simp[a*e*g*m-c*d*f*(2*p+3)-c*e*f*(m+2*p+3)*x,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && LtQ[p,-1] && GtQ[m,0] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -(d+e*x)^(m+1)*(f*a*c*e-a*g*c*d+c*(c*d*f+a*e*g)*x)*(a+c*x^2)^(p+1)/(2*a*c*(p+1)*(c*d^2+a*e^2)) + 
  1/(2*a*c*(p+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^(p+1)*
    Simp[f*(c^2*d^2*(2*p+3)+a*c*e^2*(m+2*p+3))-a*c*d*e*g*m+c*e*(c*d*f+a*e*g)*(m+2*p+4)*x,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && LtQ[p,-1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  g*(d+e*x)^m*(a+c*x^2)^(p+1)/(c*(m+2*p+2)) + 
  1/(c*(m+2*p+2)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^p*
    Simp[c*d*f*(m+2*p+2)-a*e*g*m+c*(e*f*(m+2*p+2)+d*g*m)*x,x],x] /;
FreeQ[{a,c,d,e,f,g,p},x] && GtQ[m,0] && NeQ[m+2*p+2,0] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p]) && Not[IGtQ[m,0] && EqQ[f,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (e*f-d*g)*(d+e*x)^(m+1)*(a+c*x^2)^(p+1)/((m+1)*(c*d^2+a*e^2)) + 
  1/((m+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p*Simp[(c*d*f+a*e*g)*(m+1)-c*(e*f-d*g)*(m+2*p+3)*x,x],x] /;
FreeQ[{a,c,d,e,f,g,p},x] && LtQ[m,-1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  (e*f-d*g)*(d+e*x)^(m+1)*(a+c*x^2)^(p+1)/((m+1)*(c*d^2+a*e^2)) + 
  1/((m+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p*Simp[(c*d*f+a*e*g)*(m+1)-c*(e*f-d*g)*(m+2*p+3)*x,x],x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && ILtQ[Simplify[m+2*p+3],0] && NeQ[m,-1]


(* ::Code:: *)
Int[(f_+g_.*x_)/(Sqrt[x_]*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  2 \[Star] Subst[Int[(f+g*x^2)/Sqrt[a+c*x^4],x],x,Sqrt[x]] /;
FreeQ[{a,c,f,g},x]


(* ::Code:: *)
Int[(f_+g_.*x_)/(Sqrt[e_*x_]*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  Sqrt[x]/Sqrt[e*x] \[Star] Int[(f+g*x)/(Sqrt[x]*Sqrt[a+c*x^2]),x] /;
FreeQ[{a,c,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a*e+c*d*x,x], R=PolynomialRemainder[(f+g*x)^n,a*e+c*d*x,x]},
  -d*R*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*a*e*(p+1)) + 
  d/(2*a*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1)*ExpandToSum[2*a*e*(p+1)*Q+R*(m+2*p+2),x],x]] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[n,1] && IGtQ[m,0] && LtQ[p,-1] && EqQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_.*(a_.+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  d*(f+g*x)^n*(a+c*x^2)^(p+1)/(2*a*e*p*(d+e*x)) - 
  n*(e*f+d*g)/(2*d*e*p) \[Star] Int[(f+g*x)^(n-1)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && IGtQ[n,1] && LtQ[p,-1] && EqQ[n+2*p+1,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  -(e*f-d*g)*(f+g*x)^(n-1)*(a+c*x^2)^(p+1)/(2*c*d*p*(d+e*x)) + 
  1/(2*d*e^2*p) \[Star] Int[(f+g*x)^(n-2)*(a+c*x^2)^p*Simp[(e*f-d*g)*(e*f+d*g-d*g*n)+2*e^2*f^2*p+e*g*((e*f-d*g)*n+2*e*f*p)*x,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && EqQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(d_+e_.*x_)^m_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -(e*f-d*g)^n*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*c*d*e^(n-1)*(m+p+1)) + 
  1/(2*d*e^n*(m+p+1)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p*
    ExpandToSum[(2*d*e^n*(m+p+1)*(f+g*x)^n-(e*f-d*g)^n*(d*m-e*(m+2*p+2)*x))/(d+e*x),x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[n,1] && ILtQ[m,-1] && LtQ[p,-1] && EqQ[c*d^2+a*e^2,0]


(* ::Code:: *)
(* Int[(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  d*(f+g*x)^n*(a+c*x^2)^(p+1)/(2*a*e*p*(d+e*x)) - 
  1/(2*d*e*p) \[Star] Int[(f+g*x)^(n-1)*(a+c*x^2)^p*Simp[d*g*n-e*f*(2*p+1)-e*g*(n+2*p+1)*x,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && EqQ[c*d^2+a*e^2,0] *)


(* ::Code:: *)
(* Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  d^(2*m)/a^m \[Star] Int[(f+g*x)^n*(a+c*x^2)^(m+p)/(d-e*x)^m,x] /;
FreeQ[{a,c,d,e,f,g,n,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[f,0] && ILtQ[m,-1] && Not[IGtQ[n,0] && ILtQ[m+n,0] && Not[GtQ[p,1]]] *)


(* ::Code:: *)
(* Int[(d_+e_.*x_)^m_*(f_+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  d^(2*m)/a^m \[Star] Int[(f+g*x)^n*(a+c*x^2)^(m+p)/(d-e*x)^m,x] /;
FreeQ[{a,c,d,e,f,g,n,p},x] && EqQ[c*d^2+a*e^2,0] && ILtQ[m,0] && IntegerQ[n] *)


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  d*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/(2*a*p*(e*f-d*g)*(d+e*x)) + 
  1/(p*(2*c*d)*(e*f-d*g)) \[Star] Int[(f+g*x)^n*(a+c*x^2)^p*(c*e*f*(2*p+1)-c*d*g*(n+2*p+1)+c*e*g*(n+2*p+2)*x),x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && ILtQ[n,0] && ILtQ[n+2*p,0] && Not[IGtQ[n,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -e*(d+e*x)^(m-1)*(f+g*x)^n*(a+c*x^2)^(p+1)/(c*(m-n-1)) /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && EqQ[e*f+d*g,0] && NeQ[m-n-1,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -e^2*(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/(c*(n+1)*(e*f+d*g)) /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && EqQ[m-n-2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^m*(f+g*x)^(n+1)*(a+c*x^2)^p/(g*(n+1)) + 
  c*m/(e*g*(n+1)) \[Star] Int[(d+e*x)^(m+1)*(f+g*x)^(n+1)*(a+c*x^2)^(p-1),x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && GtQ[p,0] && LtQ[n,-1] && Not[IntegerQ[n+p] && LeQ[n+p+2,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -(d+e*x)^m*(f+g*x)^(n+1)*(a+c*x^2)^p/(g*(m-n-1)) - 
  c*m*(e*f+d*g)/(e^2*g*(m-n-1)) \[Star] Int[(d+e*x)^(m+1)*(f+g*x)^n*(a+c*x^2)^(p-1),x] /;
FreeQ[{a,c,d,e,f,g,n},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && GtQ[p,0] && NeQ[m-n-1,0] && Not[IGtQ[n,0]] && Not[IntegerQ[n+p] && LtQ[n+p+2,0]] && RationalQ[n]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  e*(d+e*x)^(m-1)*(f+g*x)^n*(a+c*x^2)^(p+1)/(c*(p+1)) - 
  e*g*n/(c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^(n-1)*(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && LtQ[p,-1] && GtQ[n,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/(c*(p+1)*(e*f+d*g)) + 
  e^2*g*(m-n-2)/(c*(p+1)*(e*f+d*g)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^n*(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e,f,g,n},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && LtQ[p,-1] && RationalQ[n]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -e*(d+e*x)^(m-1)*(f+g*x)^n*(a+c*x^2)^(p+1)/(c*(m-n-1)) - 
  n*(e*f+d*g)/(e*(m-n-1)) \[Star] Int[(d+e*x)^m*(f+g*x)^(n-1)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && GtQ[n,0] && NeQ[m-n-1,0] && (IntegerQ[2*p] || IntegerQ[n])


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  -e^2*(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/((n+1)*(c*e*f+c*d*g)) - 
  e*(m-n-2)/((n+1)*(e*f+d*g)) \[Star] Int[(d+e*x)^m*(f+g*x)^(n+1)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p,0] && LtQ[n,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[Sqrt[d_+e_.*x_]/((f_.+g_.*x_)*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  2*e^2 \[Star] Subst[Int[1/(c*(e*f+d*g)+e^2*g*x^2),x],x,Sqrt[a+c*x^2]/Sqrt[d+e*x]] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(d+e*x)^(m-2)*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/(c*g*(n+p+2)) /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p-1,0] && EqQ[e*f*(p+1)-d*g*(2*n+p+3),0] && NeQ[n+p+2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(e*f-d*g)*(d+e*x)^(m-2)*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/(c*g*(n+1)*(e*f+d*g)) - 
  e*(e*f*(p+1)-d*g*(2*n+p+3))/(g*(n+1)*(e*f+d*g)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p-1,0] && LtQ[n,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(d+e*x)^(m-2)*(f+g*x)^(n+1)*(a+c*x^2)^(p+1)/(c*g*(n+p+2)) - 
  (e*f*(p+1)-d*g*(2*n+p+3))/(g*(n+p+2)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^n*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+p-1,0] && Not[LtQ[n,-1]] && IntegerQ[2*p]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[1/Sqrt[a+c*x^2],(d+e*x)^m*(f+g*x)^n*(a+c*x^2)^(p+1/2),x],x] /;
FreeQ[{a,c,d,e,f,g,n,p},x] && EqQ[c*d^2+a*e^2,0] && IntegerQ[p-1/2] && ILtQ[m,0] && ILtQ[n,0] && Not[IGtQ[n,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(a+c*x^2)^p,x],x] /;
FreeQ[{a,c,d,e,f,g,n,p},x] && EqQ[c*d^2+a*e^2,0] && ILtQ[m,0] && (ILtQ[n,0] || IGtQ[n,0] && ILtQ[p+1/2,0]) && Not[IGtQ[n,0]]


(* ::Code:: *)
(* Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a*e+c*d*x,x], R=PolynomialRemainder[(f+g*x)^n,a*e+c*d*x,x]},
  -d*R*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*a*e*(p+1)) + 
  d/(2*a*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1)*ExpandToSum[2*a*e*(p+1)*Q+R*(m+2*p+2),x],x]] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && ILtQ[p+1/2,0] && IGtQ[m,0] && IGtQ[n,0] *)


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+c*x^2)^p,(d+e*x)^m*(f+g*x)^n,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+n+2*p+1,0] && ILtQ[m,0] && ILtQ[n,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_+g_.*x_)^n_.*(a_.+c_.*x_^2)^p_,x_Symbol] :=
  g^n*(d+e*x)^(m+n-1)*(a+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 
  1/(c*e^n*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^p*
    ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^n-2*e*g^n*(m+p+n)*(d+e*x)^(n-2)*(a*e-c*d*x),x],x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && EqQ[c*d^2+a*e^2,0] && IGtQ[n,0] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a+c*x^2,x],
        R=Coeff[PolynomialRemainder[(f+g*x)^n,a+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(f+g*x)^n,a+c*x^2,x],x,1]},
  (d+e*x)^m*(a+c*x^2)^(p+1)*(a*S-c*R*x)/(2*a*c*(p+1)) + 
  1/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1)*
    ExpandToSum[2*a*c*(p+1)*(d+e*x)*Q-a*e*S*m+c*d*R*(2*p+3)+c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && GtQ[m,0] && NeQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(d+e*x)^m*(f+g*x)^n,a+c*x^2,x],
        R=Coeff[PolynomialRemainder[(d+e*x)^m*(f+g*x)^n,a+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(d+e*x)^m*(f+g*x)^n,a+c*x^2,x],x,1]},
  (a*S-c*R*x)*(a+c*x^2)^(p+1)/(2*a*c*(p+1)) + 
  1/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^(p+1)*
    ExpandToSum[2*a*c*(p+1)*(d+e*x)^(-m)*Q+c*R*(2*p+3)*(d+e*x)^(-m),x],x]] /;
FreeQ[{a,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && ILtQ[m,0] && NeQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a+c*x^2,x],
        R=Coeff[PolynomialRemainder[(f+g*x)^n,a+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(f+g*x)^n,a+c*x^2,x],x,1]},
  -(d+e*x)^(m+1)*(a+c*x^2)^(p+1)*(a*(e*R-d*S)+(c*d*R+a*e*S)*x)/(2*a*(p+1)*(c*d^2+a*e^2)) + 
  1/(2*a*(p+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^(p+1)*
   ExpandToSum[2*a*(p+1)*(c*d^2+a*e^2)*Q+c*d^2*R*(2*p+3)-a*e*(d*S*m-e*R*(m+2*p+3))+e*(c*d*R+a*e*S)*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,c,d,e,f,g,m},x] && IGtQ[n,1] && LtQ[p,-1] && NeQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,d+e*x,x], R=PolynomialRemainder[(f+g*x)^n,d+e*x,x]},
  (e*R*(d+e*x)^(m+1)*(a+c*x^2)^(p+1))/((m+1)*(c*d^2+a*e^2)) + 
  1/((m+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p*
     ExpandToSum[(m+1)*(c*d^2+a*e^2)*Q+c*d*R*(m+1)-c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,c,d,e,f,g,p},x] && IGtQ[n,1] && ILtQ[m,-1] && NeQ[c*d^2+a*e^2,0] && (NeQ[m+n,0] || EqQ[p,-1/2])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  g^n*(d+e*x)^(m+n-1)*(a+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 
  1/(c*e^n*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^p*ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^n-
    g^n*(d+e*x)^(n-2)*(a*e^2*(m+n-1)-c*d^2*(m+n+2*p+1)-2*c*d*e*(m+n+p)*x),x],x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && IGtQ[n,1] && IntegerQ[m] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Int[(d+e*x)^(m+p)*(f+g*x)^n*(a/d+c/e*x)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,n},x] && EqQ[c*d^2+a*e^2,0] && GtQ[a,0] && GtQ[d,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (a+c*x^2)^FracPart[p]/((d+e*x)^FracPart[p]*(a/d+(c*x)/e)^FracPart[p]) \[Star] Int[(d+e*x)^(m+p)*(f+g*x)^n*(a/d+c/e*x)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,n},x] && EqQ[c*d^2+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  g/e \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p,x] + (e*f-d*g)/e \[Star] Int[(d+e*x)^m*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(a_+c_.*x_^2)^p_/((d_.+e_.*x_)*(f_.+g_.*x_)),x_Symbol] :=
  (c*d^2+a*e^2)/(e*(e*f-d*g)) \[Star] Int[(a+c*x^2)^(p-1)/(d+e*x),x] - 
  1/(e*(e*f-d*g)) \[Star] Int[Simp[c*d*f+a*e*g-c*(e*f-d*g)*x,x]*(a+c*x^2)^(p-1)/(f+g*x),x] /;
FreeQ[{a,c,d,e,f,g},x] && FractionQ[p] && GtQ[p,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[f_.+g_.*x_]*Sqrt[a_+c_.*x_^2],x_Symbol] :=
  (d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/(e*(m+1)) - 
  1/(2*e*(m+1)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*Simp[a*g+2*c*f*x+3*c*g*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[f_.+g_.*x_]*Sqrt[a_+c_.*x_^2],x_Symbol] :=
  2*(d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/(e*(2*m+5)) + 
  1/(e*(2*m+5)) \[Star] Int[(d+e*x)^m/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[3*a*e*f-a*d*g-2*(c*d*f-a*e*g)*x+(c*e*f-3*c*d*g)*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g,m},x] && IntegerQ[2*m] && Not[LtQ[m,-1]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[a_+c_.*x_^2]/Sqrt[f_.+g_.*x_],x_Symbol] :=
  2*(d+e*x)^m*Sqrt[f+g*x]*Sqrt[a+c*x^2]/(g*(2*m+3)) - 
  1/(g*(2*m+3)) \[Star] Int[(d+e*x)^(m-1)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[2*a*(e*f*m-d*g*(m+1))+(2*c*d*f-2*a*e*g)*x-(2*c*(d*g*m-e*f*(m+1)))*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && GtQ[m,0]


(* ::Code:: *)
Int[Sqrt[a_+c_.*x_^2]/((d_.+e_.*x_)*Sqrt[f_.+g_.*x_]),x_Symbol] :=
  (c*d^2+a*e^2)/e^2 \[Star] Int[1/((d+e*x)*Sqrt[f+g*x]*Sqrt[a+c*x^2]),x] - 
  1/e^2 \[Star] Int[(c*d-c*e*x)/(Sqrt[f+g*x]*Sqrt[a+c*x^2]),x] /;
FreeQ[{a,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[a_+c_.*x_^2]/Sqrt[f_.+g_.*x_],x_Symbol] :=
  (d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/((m+1)*(e*f-d*g)) - 
  1/(2*(m+1)*(e*f-d*g)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[a*g*(2*m+3)+2*(c*f)*x+c*g*(2*m+5)*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && LtQ[m,-1]


(* ::Code:: *)
Int[Sqrt[d_.+e_.*x_]/(Sqrt[f_.+g_.*x_]*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  With[{q=Rt[-4*a*c,2]},
  Sqrt[2]*Sqrt[2*c*f-g*q]*Sqrt[-q+2*c*x]*(d+e*x)*
    Sqrt[(e*f-d*g)*(q+2*c*x)/((2*c*f-g*q)*(d+e*x))]*
    Sqrt[(e*f-d*g)*(2*a+q*x)/((q*f-2*a*g)*(d+e*x))]/
   (g*Sqrt[2*c*d-e*q]*Sqrt[2*a*c/q+c*x]*Sqrt[a+c*x^2])*
    EllipticPi[e*(2*c*f-g*q)/(g*(2*c*d-e*q)),
      ArcSin[Sqrt[2*c*d-e*q]*Sqrt[f+g*x]/(Sqrt[2*c*f-g*q]*Sqrt[d+e*x])],
      (q*d-2*a*e)*(2*c*f-g*q)/((q*f-2*a*g)*(2*c*d-e*q))]] /;
FreeQ[{a,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^(3/2)/(Sqrt[f_.+g_.*x_]*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  e/g \[Star] Int[Sqrt[d+e*x]*Sqrt[f+g*x]/Sqrt[a+c*x^2],x] - 
  (e*f-d*g)/g \[Star] Int[Sqrt[d+e*x]/(Sqrt[f+g*x]*Sqrt[a+c*x^2]),x] /;
FreeQ[{a,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_/(Sqrt[f_.+g_.*x_]*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  2*e^2*(d+e*x)^(m-2)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/(c*g*(2*m-1)) - 
  1/(c*g*(2*m-1)) \[Star] Int[(d+e*x)^(m-3)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[a*e^2*(d*g+2*e*f*(m-2))-c*d^3*g*(2*m-1)+e*(e*(a*e*g*(2*m-3))+c*d*(2*e*f-3*d*g*(2*m-1)))*x+2*e^2*(c*e*f-3*c*d*g)*(m-1)*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && GeQ[m,2]


(* ::Code:: *)
(* Int[1/(Sqrt[c_.+d_.*x_]*(e_.+f_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{q=Rt[c^2+a*d^2/b,4],r=Rt[(b*e^2+a*f^2)/(f*(d*e-c*f)),2]},
  ArcTan[r*(Sqrt[c+d*x]/Sqrt[a+b*x^2])]/(r*(d*e-c*f)) - 
  b*(q^2*f+d*e-c*f)*(c+q^2+d*x)*Sqrt[d^2*(a+b*x^2)/(b*(c+q^2+d*x)^2)]/(d*q*(a*d*f^2-b*e*(d*e-2*c*f))*Sqrt[a+b*x^2])*
    EllipticF[2*ArcTan[Sqrt[c+d*x]/q],(1+c/q^2)/2] + 
  b*(q^2*f+d*e-c*f)^2*(c+q^2+d*x)*Sqrt[d^2*(a+b*x^2)/(b*(c+q^2+d*x)^2)]/(2*d*q*(d*e-c*f)*(a*d*f^2-b*e*(d*e-2*c*f))*Sqrt[a+b*x^2])*
    EllipticPi[-(q^2*f-d*e+c*f)^2/(4*q^2*f*(d*e-c*f)),2*ArcTan[Sqrt[c+d*x]/q],(1+c/q^2)/2]] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[b/a] && PosQ[(b*e^2+a*f^2)/(f*(d*e-c*f))] && NeQ[a*d*f^2-b*e*(d*e-2*c*f),0] *)


(* ::Code:: *)
(* Int[1/(Sqrt[c_.+d_.*x_]*(e_.+f_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{q=Rt[c^2+a*d^2/b,4],r=Rt[-(b*e^2+a*f^2)/(f*(d*e-c*f)),2]},
  ArcTanh[r*(Sqrt[c+d*x]/Sqrt[a+b*x^2])]/(r*(d*e-c*f)) - 
  b*(q^2*f+d*e-c*f)*(c+q^2+d*x)*Sqrt[d^2*(a+b*x^2)/(b*(c+q^2+d*x)^2)]/(d*q*(a*d*f^2-b*e*(d*e-2*c*f))*Sqrt[a+b*x^2])*
    EllipticF[2*ArcTan[Sqrt[c+d*x]/q],(1+c/q^2)/2] + 
  b*(q^2*f+d*e-c*f)^2*(c+q^2+d*x)*Sqrt[d^2*(a+b*x^2)/(b*(c+q^2+d*x)^2)]/(2*d*q*(d*e-c*f)*(a*d*f^2-b*e*(d*e-2*c*f))*Sqrt[a+b*x^2])*
    EllipticPi[-(q^2*f-d*e+c*f)^2/(4*q^2*f*(d*e-c*f)),2*ArcTan[Sqrt[c+d*x]/q],(1+c/q^2)/2]] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[b/a] && NegQ[(b*e^2+a*f^2)/(f*(d*e-c*f))] && NeQ[a*d*f^2-b*e*(d*e-2*c*f),0] *)


(* ::Code:: *)
Int[1/(Sqrt[c_.+d_.*x_]*(e_.+f_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  2 \[Star] Subst[Int[1/((d*e-c*f+f*x^2)*Sqrt[(b*c^2+a*d^2)/d^2-2*b*c*x^2/d^2+b*x^4/d^2]),x],x,Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d,e,f},x] && PosQ[b/a]


(* ::Code:: *)
Int[1/(Sqrt[c_.+d_.*x_]*(e_.+f_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  1/Sqrt[a] \[Star] Int[1/((e+f*x)*Sqrt[c+d*x]*Sqrt[1-q*x]*Sqrt[1+q*x]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && NegQ[b/a] && GtQ[a,0]


(* ::Code:: *)
Int[1/(Sqrt[c_.+d_.*x_]*(e_.+f_.*x_)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  With[{q=Rt[-b/a,2]},
  Sqrt[1+b*x^2/a]/Sqrt[a+b*x^2] \[Star] Int[1/((e+f*x)*Sqrt[c+d*x]*Sqrt[1-q*x]*Sqrt[1+q*x]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && NegQ[b/a] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[1/(Sqrt[c_.+d_.*x_]*Sqrt[e_.+f_.*x_]*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  -2*(c+d*x)*Sqrt[(d*e-c*f)^2*(a+b*x^2)/((b*e^2+a*f^2)*(c+d*x)^2)]/((d*e-c*f)*Sqrt[a+b*x^2]) \[Star] 
  Subst[Int[1/Sqrt[Simp[1-(2*b*c*e+2*a*d*f)*x^2/(b*e^2+a*f^2)+(b*c^2+a*d^2)*x^4/(b*e^2+a*f^2),x]],x],x,Sqrt[e+f*x]/Sqrt[c+d*x]] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[1/(Sqrt[c_.+d_.*x_]*(e_.+f_.*x_)^(3/2)*Sqrt[a_+b_.*x_^2]),x_Symbol] :=
  d/(d*e-c*f) \[Star] Int[1/(Sqrt[c+d*x]*Sqrt[e+f*x]*Sqrt[a+b*x^2]),x] - 
  f/(d*e-c*f) \[Star] Int[Sqrt[c+d*x]/((e+f*x)^(3/2)*Sqrt[a+b*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_/(Sqrt[f_.+g_.*x_]*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  e^2*(d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/((m+1)*(e*f-d*g)*(c*d^2+a*e^2)) + 
  1/(2*(m+1)*(e*f-d*g)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[2*c*d*(e*f-d*g)*(m+1)-a*e^2*g*(2*m+3)+2*c*e*(d*g*(m+1)-e*f*(m+2))*x-c*e^2*g*(2*m+5)*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && LeQ[m,-2]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*Sqrt[f_.+g_.*x_]/Sqrt[a_+c_.*x_^2],x_Symbol] :=
  2*e*(d+e*x)^(m-1)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/(c*(2*m+1)) - 
  1/(c*(2*m+1)) \[Star] Int[(d+e*x)^(m-2)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[a*e*(d*g+2*e*f*(m-1))-c*d^2*f*(2*m+1)+(a*e^2*g*(2*m-1)-c*d*(4*e*f*m+d*g*(2*m+1)))*x-c*e*(e*f+d*g*(4*m-1))*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && GtQ[m,1]


(* ::Code:: *)
Int[Sqrt[f_.+g_.*x_]/((d_.+e_.*x_)*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  g/e \[Star] Int[1/(Sqrt[f+g*x]*Sqrt[a+c*x^2]),x] + 
  (e*f-d*g)/e \[Star] Int[1/((d+e*x)*Sqrt[f+g*x]*Sqrt[a+c*x^2]),x] /;
FreeQ[{a,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*Sqrt[f_.+g_.*x_]/Sqrt[a_+c_.*x_^2],x_Symbol] :=
  e*(d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+c*x^2]/((m+1)*(c*d^2+a*e^2)) + 
  1/(2*(m+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+c*x^2])*
    Simp[2*c*d*f*(m+1)-e*(a*g)+2*c*(d*g*(m+1)-e*f*(m+2))*x-c*e*g*(2*m+5)*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[2*m] && LeQ[m,-2]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_/(d_.+e_.*x_),x_Symbol] :=
  (c*d^2+a*e^2)/(e*(e*f-d*g)) \[Star] Int[(f+g*x)^(n+1)*(a+c*x^2)^(p-1)/(d+e*x),x] - 
  1/(e*(e*f-d*g)) \[Star] Int[(f+g*x)^n*(c*d*f+a*e*g-c*(e*f-d*g)*x)*(a+c*x^2)^(p-1),x] /;
FreeQ[{a,c,d,e,f,g},x] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && GtQ[p,0] && LtQ[n,-1]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_/(d_.+e_.*x_),x_Symbol] :=
  e*(e*f-d*g)/(c*d^2+a*e^2) \[Star] Int[(f+g*x)^(n-1)*(a+c*x^2)^(p+1)/(d+e*x),x] + 
  1/(c*d^2+a*e^2) \[Star] Int[(f+g*x)^(n-1)*(c*d*f+a*e*g-c*(e*f-d*g)*x)*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g},x] && 
  Not[IntegerQ[n]] && Not[IntegerQ[p]] && LtQ[p,-1] && GtQ[n,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_/((d_.+e_.*x_)*Sqrt[a_+c_.*x_^2]),x_Symbol] :=
  Int[ExpandIntegrand[1/(Sqrt[f+g*x]*Sqrt[a+c*x^2]),(f+g*x)^(n+1/2)/(d+e*x),x],x] /;
FreeQ[{a,c,d,e,f,g},x] && IntegerQ[n+1/2]


(* ::Code:: *)
(* Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Denominator[m]},
  q/e \[Star] Subst[Int[x^(q*(m+1)-1)*((e*f-d*g)/e+g*x^q/e)^n*((c*d^2+a*e^2)/e^2-2*c*d*x^q/e^2+c*x^(2*q)/e^2)^p,x],x,(d+e*x)^(1/q)]] /;
FreeQ[{a,c,d,e,f,g},x] && IntegersQ[n,p] && FractionQ[m] *)


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(a+c*x^2)^p,x],x] /;
FreeQ[{a,c,d,e,f,g},x] && (IntegerQ[p] || ILtQ[m,0] && ILtQ[n,0])


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,d+e*x,x], R=PolynomialRemainder[(f+g*x)^n,d+e*x,x]},
  (e*R*(d+e*x)^(m+1)*(a+c*x^2)^(p+1))/((m+1)*(c*d^2+a*e^2)) + 
  1/((m+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p*
     ExpandToSum[(m+1)*(c*d^2+a*e^2)*Q+c*d*R*(m+1)-c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,c,d,e,f,g,p},x] && IGtQ[n,1] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  g^n*(d+e*x)^(m+n-1)*(a+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 
  1/(c*e^n*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^p*ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^n-
    g^n*(d+e*x)^(n-2)*(a*e^2*(m+n-1)-c*d^2*(m+n+2*p+1)-2*c*d*e*(m+n+p)*x),x],x] /;
FreeQ[{a,c,d,e,f,g,m,p},x] && IGtQ[n,1] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Unintegrable[(d+e*x)^m*(f+g*x)^n*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,f,g,m,n,p},x]


(* ::Code:: *)
Int[(d_.+e_.*u_)^m_.*(f_.+g_.*u_)^n_.*(a_+c_.*u_^2)^p_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(d+e*x)^m*(f+g*x)^n*(a+c*x^2)^p,x],x,u] /;
FreeQ[{a,c,d,e,f,g,m,n,p},x] && LinearQ[u,x] && NeQ[u,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.x P(x) (a+b x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.2.x P(x) (a+b x^2)^p *)
Int[Pq_*(a_ + b_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x^2)^p, x], x] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[p, -2]
Int[Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := Int[x*PolynomialQuotient[Pq, x, x]*(a + b*x^2)^p, x] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0] && Not[MatchQ[Pq, x^m_.*u_. /; IntegerQ[m]]]
Int[Px_*(a_ + b_.*x_^2)^p_., x_Symbol] := Int[PolynomialQuotient[Px, a + b*x^2, x]*(a + b*x^2)^(p + 1), x] /; FreeQ[{a, b, p}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, a + b*x^2, x], 0]
Int[Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{A = Coeff[Pq, x, 0], Q = PolynomialQuotient[Pq - Coeff[Pq, x, 0], x^2, x]}, A*x*(a + b*x^2)^(p + 1)/a + 1/a*Int[x^2*(a + b*x^2)^p*(a*Q - A*b*(2*p + 3)), x]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x^2] && ILtQ[p + 1/2, 0] && LtQ[Expon[Pq, x] + 2*p + 1, 0]
Int[Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + b*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + b*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + b*x^2, x], x, 1]}, (a*g - b*f*x)*(a + b*x^2)^(p + 1)/(2*a*b*(p + 1)) + 1/(2*a*(p + 1))* Int[(a + b*x^2)^(p + 1)* ExpandToSum[2*a*(p + 1)*Q + f*(2*p + 3), x], x]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && LtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], e = Coeff[Pq, x, Expon[Pq, x]]}, e*x^(q - 1)*(a + b*x^2)^(p + 1)/(b*(q + 2*p + 1)) + 1/(b*(q + 2*p + 1))* Int[(a + b*x^2)^p* ExpandToSum[ b*(q + 2*p + 1)*Pq - a*e*(q - 1)*x^(q - 2) - b*e*(q + 2*p + 1)*x^q, x], x]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && Not[LeQ[p, -1]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.2 Quadratic/1.1.2.y P(x) (c x)^m (a+b x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.2.y P(x) (c x)^m (a+b x^2)^p *)
Int[x_^m_.*Pq_*(a_ + b_.*x_^2)^p_., x_Symbol] := 1/2*Subst[Int[x^((m - 1)/2)*SubstFor[x^2, Pq, x]*(a + b*x)^p, x], x, x^2] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x^2] && IntegerQ[(m - 1)/2]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_., x_Symbol] := 1/c*Int[(c*x)^(m + 1)*PolynomialQuotient[Pq, x, x]*(a + b*x^2)^p, x] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0]
Int[(c_.*x_)^m_.*P2_*(a_ + b_.*x_^2)^p_., x_Symbol] := With[{f = Coeff[P2, x, 0], g = Coeff[P2, x, 1], h = Coeff[P2, x, 2]}, h*(c*x)^(m + 1)*(a + b*x^2)^(p + 1)/(b*c*(m + 2*p + 3)) /; EqQ[g, 0] && EqQ[a*h*(m + 1) - b*f*(m + 2*p + 3), 0]] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[P2, x, 2] && NeQ[m, -1]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(c*x)^m*Pq*(a + b*x^2)^p, x], x] /; FreeQ[{a, b, c, m}, x] && PolyQ[Pq, x] && IGtQ[p, -2]
Int[x_^m_*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{A = Coeff[Pq, x, 0], Q = PolynomialQuotient[Pq - Coeff[Pq, x, 0], x^2, x]}, A*x^(m + 1)*(a + b*x^2)^(p + 1)/(a*(m + 1)) + 1/(a*(m + 1))* Int[x^(m + 2)*(a + b*x^2)^ p*(a*(m + 1)*Q - A*b*(m + 2*(p + 1) + 1)), x]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x^2] && IntegerQ[m/2] && ILtQ[(m + 1)/2 + p, 0] && LtQ[m + Expon[Pq, x] + 2*p + 1, 0]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + b*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + b*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + b*x^2, x], x, 1]}, (c*x)^m*(a + b*x^2)^(p + 1)*(a*g - b*f*x)/(2*a*b*(p + 1)) + c/(2*a*b*(p + 1))* Int[(c*x)^(m - 1)*(a + b*x^2)^(p + 1)* ExpandToSum[2*a*b*(p + 1)*x*Q - a*g*m + b*f*(m + 2*p + 3)*x, x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && LtQ[p, -1] && GtQ[m, 0]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[(c*x)^m*Pq, a + b*x^2, x], f = Coeff[PolynomialRemainder[(c*x)^m*Pq, a + b*x^2, x], x, 0], g = Coeff[PolynomialRemainder[(c*x)^m*Pq, a + b*x^2, x], x, 1]}, (a*g - b*f*x)*(a + b*x^2)^(p + 1)/(2*a*b*(p + 1)) + 1/(2*a*(p + 1))* Int[(c*x)^m*(a + b*x^2)^(p + 1)* ExpandToSum[2*a*(p + 1)*(c*x)^(-m)*Q + f*(2*p + 3)*(c*x)^(-m), x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && LtQ[p, -1] && ILtQ[m, 0]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + b*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + b*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + b*x^2, x], x, 1]}, -(c*x)^(m + 1)*(f + g*x)*(a + b*x^2)^(p + 1)/(2*a*c*(p + 1)) + 1/(2*a*(p + 1))* Int[(c*x)^m*(a + b*x^2)^(p + 1)* ExpandToSum[ 2*a*(p + 1)*Q + f*(m + 2*p + 3) + g*(m + 2*p + 4)*x, x], x]] /; FreeQ[{a, b, c, m}, x] && PolyQ[Pq, x] && LtQ[p, -1] && Not[GtQ[m, 0]]
Int[(c_.*x_)^m_*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, c*x, x], R = PolynomialRemainder[Pq, c*x, x]}, R*(c*x)^(m + 1)*(a + b*x^2)^(p + 1)/(a*c*(m + 1)) + 1/(a*c*(m + 1))* Int[(c*x)^(m + 1)*(a + b*x^2)^p* ExpandToSum[a*c*(m + 1)*Q - b*R*(m + 2*p + 3)*x, x], x]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && LtQ[m, -1] && (IntegerQ[2*p] || NeQ[Expon[Pq, x], 1])
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_., x_Symbol] := With[{q = Expon[Pq, x]}, Coeff[Pq, x, q]/c^q*Int[(c*x)^(m + q)*(a + b*x^2)^p, x] + 1/c^q* Int[(c*x)^m*(a + b*x^2)^p* ExpandToSum[c^q*Pq - Coeff[Pq, x, q]*(c*x)^q, x], x] /; EqQ[q, 1] || EqQ[m + q + 2*p + 1, 0]] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && Not[IGtQ[m, 0] && ILtQ[p + 1/2, 0]]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], f = Coeff[Pq, x, Expon[Pq, x]]}, f*(c*x)^(m + q - 1)*(a + b*x^2)^(p + 1)/(b* c^(q - 1)*(m + q + 2*p + 1)) + 1/(b*(m + q + 2*p + 1))* Int[(c*x)^m*(a + b*x^2)^p* ExpandToSum[ b*(m + q + 2*p + 1)*Pq - b*f*(m + q + 2*p + 1)*x^q - a*f*(m + q - 1)*x^(q - 2), x], x] /; GtQ[q, 1] && NeQ[m + q + 2*p + 1, 0]] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && (Not[IGtQ[m, 0]] || IGtQ[p + 1/2, -1])

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.1 (a+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.1 (a+b x^n)^p *)
Int[(b_.*x_^n_)^p_, x_Symbol] := b^IntPart[p]*(b*x^n)^FracPart[p]/x^(n*FracPart[p])* Int[x^(n*p), x] /; FreeQ[{b, n, p}, x]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*x)^p, x], x, x^n] /; FreeQ[{a, b, p}, x] && FractionQ[n] && IntegerQ[1/n]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := x*(a + b*x^n)^(p + 1)/a /; FreeQ[{a, b, n, p}, x] && EqQ[1/n + p + 1, 0]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := -x*(a + b*x^n)^(p + 1)/(a*n*(p + 1)) + (n*(p + 1) + 1)/(a*n*(p + 1))*Int[(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, n, p}, x] && ILtQ[Simplify[1/n + p + 1], 0] && NeQ[p, -1]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := Int[x^(n*p)*(b + a*x^(-n))^p, x] /; FreeQ[{a, b}, x] && LtQ[n, 0] && IntegerQ[p]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^n)^p, x], x] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := x*(a + b*x^n)^p/(n*p + 1) + a*n*p/(n*p + 1)*Int[(a + b*x^n)^(p - 1), x] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && GtQ[p, 0] && (IntegerQ[2*p] || EqQ[n, 2] && IntegerQ[4*p] || EqQ[n, 2] && IntegerQ[3*p] || LtQ[Denominator[p + 1/n], Denominator[p]])
Int[1/(a_ + b_.*x_^2)^(5/4), x_Symbol] := 2/(a^(5/4)*Rt[b/a, 2])*EllipticE[1/2*ArcTan[Rt[b/a, 2]*x], 2] /; FreeQ[{a, b}, x] && GtQ[a, 0] && PosQ[b/a]
Int[1/(a_ + b_.*x_^2)^(5/4), x_Symbol] := (1 + b*x^2/a)^(1/4)/(a*(a + b*x^2)^(1/4))* Int[1/(1 + b*x^2/a)^(5/4), x] /; FreeQ[{a, b}, x] && PosQ[a] && PosQ[b/a]
Int[1/(a_ + b_.*x_^2)^(7/6), x_Symbol] := 1/((a + b*x^2)^(2/3)*(a/(a + b*x^2))^(2/3))* Subst[Int[1/(1 - b*x^2)^(1/3), x], x, x/Sqrt[a + b*x^2]] /; FreeQ[{a, b}, x]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := -x*(a + b*x^n)^(p + 1)/(a*n*(p + 1)) + (n*(p + 1) + 1)/(a*n*(p + 1))*Int[(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && LtQ[p, -1] && (IntegerQ[2*p] || n == 2 && IntegerQ[4*p] || n == 2 && IntegerQ[3*p] || Denominator[p + 1/n] < Denominator[p])
Int[1/(a_ + b_.*x_^3), x_Symbol] := 1/(3*Rt[a, 3]^2)*Int[1/(Rt[a, 3] + Rt[b, 3]*x), x] + 1/(3*Rt[a, 3]^2)* Int[(2*Rt[a, 3] - Rt[b, 3]*x)/(Rt[a, 3]^2 - Rt[a, 3]*Rt[b, 3]*x + Rt[b, 3]^2*x^2), x] /; FreeQ[{a, b}, x]
(* Int[1/(a_+b_.*x_^5),x_Symbol] := With[{r=Numerator[Rt[a/b,5]], s=Denominator[Rt[a/b,5]]}, r/(5*a)*Int[1/(r+s*x),x] + 2*r/(5*a)*Int[(r-1/4*(1-Sqrt[5])*s*x)/(r^2-1/2*(1-Sqrt[5])*r*s*x+s^ 2*x^2),x] + 2*r/(5*a)*Int[(r-1/4*(1+Sqrt[5])*s*x)/(r^2-1/2*(1+Sqrt[5])*r*s*x+s^ 2*x^2),x]] /; FreeQ[{a,b},x] && PosQ[a/b] *)
(* Int[1/(a_+b_.*x_^5),x_Symbol] := With[{r=Numerator[Rt[-a/b,5]], s=Denominator[Rt[-a/b,5]]}, r/(5*a)*Int[1/(r-s*x),x] + 2*r/(5*a)*Int[(r+1/4*(1-Sqrt[5])*s*x)/(r^2+1/2*(1-Sqrt[5])*r*s*x+s^ 2*x^2),x] + 2*r/(5*a)*Int[(r+1/4*(1+Sqrt[5])*s*x)/(r^2+1/2*(1+Sqrt[5])*r*s*x+s^ 2*x^2),x]] /; FreeQ[{a,b},x] && NegQ[a/b] *)
Int[1/(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[a/b, n]], s = Denominator[Rt[a/b, n]], k, u}, u = Int[(r - s*Cos[(2*k - 1)*Pi/n]*x)/(r^2 - 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x]; r/(a*n)*Int[1/(r + s*x), x] + Dist[2*r/(a*n), Sum[u, {k, 1, (n - 1)/2}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 3)/2, 0] && PosQ[a/b]
Int[1/(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[-a/b, n]], s = Denominator[Rt[-a/b, n]], k, u}, u = Int[(r + s*Cos[(2*k - 1)*Pi/n]*x)/(r^2 + 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x]; r/(a*n)*Int[1/(r - s*x), x] + Dist[2*r/(a*n), Sum[u, {k, 1, (n - 1)/2}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 3)/2, 0] && NegQ[a/b]
Int[1/(a_ + b_.*x_^2), x_Symbol] := 1/(Rt[a, 2]*Rt[b, 2])*ArcTan[Rt[b, 2]*x/Rt[a, 2]] /; FreeQ[{a, b}, x] && PosQ[a/b] && (GtQ[a, 0] || GtQ[b, 0])
Int[1/(a_ + b_.*x_^2), x_Symbol] := -1/(Rt[-a, 2]*Rt[-b, 2])*ArcTan[Rt[-b, 2]*x/Rt[-a, 2]] /; FreeQ[{a, b}, x] && PosQ[a/b] && (LtQ[a, 0] || LtQ[b, 0])
Int[1/(a_ + b_.*x_^2), x_Symbol] := (*Rt[b/a,2]/b*ArcTan[Rt[b/a,2]*x] /; *) Rt[a/b, 2]/a*ArcTan[x/Rt[a/b, 2]] /; FreeQ[{a, b}, x] && PosQ[a/b]
Int[1/(a_ + b_.*x_^2), x_Symbol] := 1/(Rt[a, 2]*Rt[-b, 2])*ArcTanh[Rt[-b, 2]*x/Rt[a, 2]] /; FreeQ[{a, b}, x] && NegQ[a/b] && (GtQ[a, 0] || LtQ[b, 0])
Int[1/(a_ + b_.*x_^2), x_Symbol] := -1/(Rt[-a, 2]*Rt[b, 2])*ArcTanh[Rt[b, 2]*x/Rt[-a, 2]] /; FreeQ[{a, b}, x] && NegQ[a/b] && (LtQ[a, 0] || GtQ[b, 0])
Int[1/(a_ + b_.*x_^2), x_Symbol] := (*-Rt[-b/a,2]/b*ArcTanh[Rt[-b/a,2]*x] /; *) Rt[-a/b, 2]/a*ArcTanh[x/Rt[-a/b, 2]] /; FreeQ[{a, b}, x] && NegQ[a/b]
Int[1/(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[a/b, n]], s = Denominator[Rt[a/b, n]], k, u, v}, u = Int[(r - s*Cos[(2*k - 1)*Pi/n]*x)/(r^2 - 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x] + Int[(r + s*Cos[(2*k - 1)*Pi/n]*x)/(r^2 + 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x]; 2*r^2/(a*n)*Int[1/(r^2 + s^2*x^2), x] + Dist[2*r/(a*n), Sum[u, {k, 1, (n - 2)/4}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 2)/4, 0] && PosQ[a/b]
Int[1/(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[-a/b, n]], s = Denominator[Rt[-a/b, n]], k, u}, u = Int[(r - s*Cos[(2*k*Pi)/n]*x)/(r^2 - 2*r*s*Cos[(2*k*Pi)/n]*x + s^2*x^2), x] + Int[(r + s*Cos[(2*k*Pi)/n]*x)/(r^2 + 2*r*s*Cos[(2*k*Pi)/n]*x + s^2*x^2), x]; 2*r^2/(a*n)*Int[1/(r^2 - s^2*x^2), x] + Dist[2*r/(a*n), Sum[u, {k, 1, (n - 2)/4}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 2)/4, 0] && NegQ[a/b]
Int[1/(a_ + b_.*x_^4), x_Symbol] := With[{r = Numerator[Rt[a/b, 2]], s = Denominator[Rt[a/b, 2]]}, 1/(2*r)*Int[(r - s*x^2)/(a + b*x^4), x] + 1/(2*r)*Int[(r + s*x^2)/(a + b*x^4), x]] /; FreeQ[{a, b}, x] && (GtQ[a/b, 0] || PosQ[a/b] && AtomQ[SplitProduct[SumBaseQ, a]] && AtomQ[SplitProduct[SumBaseQ, b]])
Int[1/(a_ + b_.*x_^4), x_Symbol] := With[{r = Numerator[Rt[-a/b, 2]], s = Denominator[Rt[-a/b, 2]]}, r/(2*a)*Int[1/(r - s*x^2), x] + r/(2*a)*Int[1/(r + s*x^2), x]] /; FreeQ[{a, b}, x] && Not[GtQ[a/b, 0]]
Int[1/(a_ + b_.*x_^n_), x_Symbol] := With[{r = Numerator[Rt[a/b, 4]], s = Denominator[Rt[a/b, 4]]}, r/(2*Sqrt[2]*a)* Int[(Sqrt[2]*r - s*x^(n/4))/(r^2 - Sqrt[2]*r*s*x^(n/4) + s^2*x^(n/2)), x] + r/(2*Sqrt[2]*a)* Int[(Sqrt[2]*r + s*x^(n/4))/(r^2 + Sqrt[2]*r*s*x^(n/4) + s^2*x^(n/2)), x]] /; FreeQ[{a, b}, x] && IGtQ[n/4, 1] && GtQ[a/b, 0]
Int[1/(a_ + b_.*x_^n_), x_Symbol] := With[{r = Numerator[Rt[-a/b, 2]], s = Denominator[Rt[-a/b, 2]]}, r/(2*a)*Int[1/(r - s*x^(n/2)), x] + r/(2*a)*Int[1/(r + s*x^(n/2)), x]] /; FreeQ[{a, b}, x] && IGtQ[n/4, 1] && Not[GtQ[a/b, 0]]
Int[1/Sqrt[a_ + b_.*x_^2], x_Symbol] := ArcSinh[Rt[b, 2]*x/Sqrt[a]]/Rt[b, 2] /; FreeQ[{a, b}, x] && GtQ[a, 0] && PosQ[b]
Int[1/Sqrt[a_ + b_.*x_^2], x_Symbol] := ArcSin[Rt[-b, 2]*x/Sqrt[a]]/Rt[-b, 2] /; FreeQ[{a, b}, x] && GtQ[a, 0] && NegQ[b]
Int[1/Sqrt[a_ + b_.*x_^2], x_Symbol] := Subst[Int[1/(1 - b*x^2), x], x, x/Sqrt[a + b*x^2]] /; FreeQ[{a, b}, x] && Not[GtQ[a, 0]]
(* Int[1/Sqrt[a_+b_.*x_^3],x_Symbol] := With[{q=Rt[b/a,3]}, -Sqrt[2]*(1+Sqrt[3])*(1+Sqrt[3]+q*x)^2*Sqrt[(1+q^3*x^3)/(1+Sqrt[3]+ q*x)^4]/(3^(1/4)*q*Sqrt[a+b*x^3])* EllipticF[ArcSin[(-1+Sqrt[3]-q*x)/(1+Sqrt[3]+q*x)],-7-4*Sqrt[3]]]  /; FreeQ[{a,b},x] && PosQ[a] *)
(* Int[1/Sqrt[a_+b_.*x_^3],x_Symbol] := With[{q=Rt[a/b,3]}, 2*Sqrt[2+Sqrt[3]]*(q+x)*Sqrt[(q^2-q*x+x^2)/((1+Sqrt[3])*q+x)^2]/ (3^(1/4)*Sqrt[a+b*x^3]*Sqrt[q*(q+x)/((1+Sqrt[3])*q+x)^2])* EllipticF[ArcSin[((1-Sqrt[3])*q+x)/((1+Sqrt[3])*q+x)],-7-4*Sqrt[3] ]] /; FreeQ[{a,b},x] && PosQ[a] && EqQ[b^2,1] *)
(* Int[1/Sqrt[a_+b_.*x_^3],x_Symbol] := With[{q=Rt[b/a,3]}, -2*Sqrt[2+Sqrt[3]]*(1+q*x)*Sqrt[(1-q*x+q^2*x^2)/(1+Sqrt[3]+q*x)^2]/ (3^(1/4)*q*Sqrt[a+b*x^3]*Sqrt[(1+q*x)/(1+Sqrt[3]+q*x)^2])* EllipticF[ArcSin[(-1+Sqrt[3]-q*x)/(1+Sqrt[3]+q*x)],-7-4*Sqrt[3]]]  /; FreeQ[{a,b},x] && PosQ[a] *)
Int[1/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, 2*Sqrt[2 + Sqrt[3]]*(s + r*x)* Sqrt[(s^2 - r*s*x + r^2*x^2)/((1 + Sqrt[3])*s + r*x)^2]/ (3^(1/4)*r*Sqrt[a + b*x^3]* Sqrt[s*(s + r*x)/((1 + Sqrt[3])*s + r*x)^2])* EllipticF[ ArcSin[((1 - Sqrt[3])*s + r*x)/((1 + Sqrt[3])*s + r*x)], -7 - 4*Sqrt[3]]] /; FreeQ[{a, b}, x] && PosQ[a]
(* Int[1/Sqrt[a_+b_.*x_^3],x_Symbol] := With[{q=Rt[a/b,3]}, 2*Sqrt[2-Sqrt[3]]*(q+x)*Sqrt[(q^2-q*x+x^2)/((1-Sqrt[3])*q+x)^2]/ (3^(1/4)*Sqrt[a+b*x^3]*Sqrt[-q*(q+x)/((1-Sqrt[3])*q+x)^2])* EllipticF[ArcSin[((1+Sqrt[3])*q+x)/((1-Sqrt[3])*q+x)],-7+4*Sqrt[3] ]] /; FreeQ[{a,b},x] && NegQ[a] && EqQ[b^2,1] *)
(* Int[1/Sqrt[a_+b_.*x_^3],x_Symbol] := With[{q=Rt[b/a,3]}, -2*Sqrt[2-Sqrt[3]]*(1+q*x)*Sqrt[(1-q*x+q^2*x^2)/(1-Sqrt[3]+q*x)^2]/ (3^(1/4)*q*Sqrt[a+b*x^3]*Sqrt[-(1+q*x)/(1-Sqrt[3]+q*x)^2])* EllipticF[ArcSin[(1+Sqrt[3]+q*x)/(-1+Sqrt[3]-q*x)],-7+4*Sqrt[3]]]  /; FreeQ[{a,b},x] && NegQ[a] *)
Int[1/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, 2*Sqrt[2 - Sqrt[3]]*(s + r*x)* Sqrt[(s^2 - r*s*x + r^2*x^2)/((1 - Sqrt[3])*s + r*x)^2]/ (3^(1/4)*r*Sqrt[a + b*x^3]* Sqrt[-s*(s + r*x)/((1 - Sqrt[3])*s + r*x)^2])* EllipticF[ ArcSin[((1 + Sqrt[3])*s + r*x)/((1 - Sqrt[3])*s + r*x)], -7 + 4*Sqrt[3]]] /; FreeQ[{a, b}, x] && NegQ[a]
Int[1/Sqrt[a_ + b_.*x_^4], x_Symbol] := With[{q = Rt[b/a, 4]}, (1 + q^2*x^2)* Sqrt[(a + b*x^4)/(a*(1 + q^2*x^2)^2)]/(2*q*Sqrt[a + b*x^4])* EllipticF[2*ArcTan[q*x], 1/2]] /; FreeQ[{a, b}, x] && PosQ[b/a]
Int[1/Sqrt[a_ + b_.*x_^4], x_Symbol] := EllipticF[ArcSin[Rt[-b, 4]*x/Rt[a, 4]], -1]/(Rt[a, 4]*Rt[-b, 4]) /; FreeQ[{a, b}, x] && NegQ[b/a] && GtQ[a, 0]
Int[1/Sqrt[a_ + b_.*x_^4], x_Symbol] := With[{q = Rt[-a*b, 2]}, Sqrt[-a + q*x^2]* Sqrt[(a + q*x^2)/q]/(Sqrt[2]*Sqrt[-a]*Sqrt[a + b*x^4])* EllipticF[ArcSin[x/Sqrt[(a + q*x^2)/(2*q)]], 1/2] /; IntegerQ[q]] /; FreeQ[{a, b}, x] && LtQ[a, 0] && GtQ[b, 0]
Int[1/Sqrt[a_ + b_.*x_^4], x_Symbol] := With[{q = Rt[-a*b, 2]}, Sqrt[(a - q*x^2)/(a + q*x^2)]* Sqrt[(a + q*x^2)/q]/(Sqrt[2]*Sqrt[a + b*x^4]* Sqrt[a/(a + q*x^2)])* EllipticF[ArcSin[x/Sqrt[(a + q*x^2)/(2*q)]], 1/2]] /; FreeQ[{a, b}, x] && LtQ[a, 0] && GtQ[b, 0]
Int[1/Sqrt[a_ + b_.*x_^4], x_Symbol] := Sqrt[1 + b*x^4/a]/Sqrt[a + b*x^4]*Int[1/Sqrt[1 + b*x^4/a], x] /; FreeQ[{a, b}, x] && NegQ[b/a] && Not[GtQ[a, 0]]
Int[1/Sqrt[a_ + b_.*x_^6], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, x*(s + r*x^2)* Sqrt[(s^2 - r*s*x^2 + r^2*x^4)/(s + (1 + Sqrt[3])*r*x^2)^2]/ (2*3^(1/4)*s*Sqrt[a + b*x^6]* Sqrt[r*x^2*(s + r*x^2)/(s + (1 + Sqrt[3])*r*x^2)^2])* EllipticF[ ArcCos[(s + (1 - Sqrt[3])*r*x^2)/(s + (1 + Sqrt[3])*r*x^2)], (2 + Sqrt[3])/4]] /; FreeQ[{a, b}, x]
Int[1/Sqrt[a_ + b_.*x_^8], x_Symbol] := 1/2*Int[(1 - Rt[b/a, 4]*x^2)/Sqrt[a + b*x^8], x] + 1/2*Int[(1 + Rt[b/a, 4]*x^2)/Sqrt[a + b*x^8], x] /; FreeQ[{a, b}, x]
Int[1/(a_ + b_.*x_^2)^(1/4), x_Symbol] := 2*x/(a + b*x^2)^(1/4) - a*Int[1/(a + b*x^2)^(5/4), x] /; FreeQ[{a, b}, x] && GtQ[a, 0] && PosQ[b/a]
Int[1/(a_ + b_.*x_^2)^(1/4), x_Symbol] := 2/(a^(1/4)*Rt[-b/a, 2])*EllipticE[1/2*ArcSin[Rt[-b/a, 2]*x], 2] /; FreeQ[{a, b}, x] && GtQ[a, 0] && NegQ[b/a]
Int[1/(a_ + b_.*x_^2)^(1/4), x_Symbol] := (1 + b*x^2/a)^(1/4)/(a + b*x^2)^(1/4)* Int[1/(1 + b*x^2/a)^(1/4), x] /; FreeQ[{a, b}, x] && PosQ[a]
Int[1/(a_ + b_.*x_^2)^(1/4), x_Symbol] := 2*Sqrt[-b*x^2/a]/(b*x)* Subst[Int[x^2/Sqrt[1 - x^4/a], x], x, (a + b*x^2)^(1/4)] /; FreeQ[{a, b}, x] && NegQ[a]
Int[1/(a_ + b_.*x_^2)^(3/4), x_Symbol] := 2/(a^(3/4)*Rt[b/a, 2])*EllipticF[1/2*ArcTan[Rt[b/a, 2]*x], 2] /; FreeQ[{a, b}, x] && GtQ[a, 0] && PosQ[b/a]
Int[1/(a_ + b_.*x_^2)^(3/4), x_Symbol] := 2/(a^(3/4)*Rt[-b/a, 2])*EllipticF[1/2*ArcSin[Rt[-b/a, 2]*x], 2] /; FreeQ[{a, b}, x] && GtQ[a, 0] && NegQ[b/a]
Int[1/(a_ + b_.*x_^2)^(3/4), x_Symbol] := (1 + b*x^2/a)^(3/4)/(a + b*x^2)^(3/4)* Int[1/(1 + b*x^2/a)^(3/4), x] /; FreeQ[{a, b}, x] && PosQ[a]
Int[1/(a_ + b_.*x_^2)^(3/4), x_Symbol] := 2*Sqrt[-b*x^2/a]/(b*x)* Subst[Int[1/Sqrt[1 - x^4/a], x], x, (a + b*x^2)^(1/4)] /; FreeQ[{a, b}, x] && NegQ[a]
Int[1/(a_ + b_.*x_^2)^(1/3), x_Symbol] := 3*Sqrt[b*x^2]/(2*b*x)* Subst[Int[x/Sqrt[-a + x^3], x], x, (a + b*x^2)^(1/3)] /; FreeQ[{a, b}, x]
Int[1/(a_ + b_.*x_^2)^(2/3), x_Symbol] := 3*Sqrt[b*x^2]/(2*b*x)* Subst[Int[1/Sqrt[-a + x^3], x], x, (a + b*x^2)^(1/3)] /; FreeQ[{a, b}, x]
Int[1/(a_ + b_.*x_^4)^(3/4), x_Symbol] := x^3*(1 + a/(b*x^4))^(3/4)/(a + b*x^4)^(3/4)* Int[1/(x^3*(1 + a/(b*x^4))^(3/4)), x] /; FreeQ[{a, b}, x]
Int[1/(a_ + b_.*x_^2)^(1/6), x_Symbol] := 3*x/(2*(a + b*x^2)^(1/6)) - a/2*Int[1/(a + b*x^2)^(7/6), x] /; FreeQ[{a, b}, x]
Int[1/(a_ + b_.*x_^3)^(1/3), x_Symbol] := ArcTan[(1 + 2*Rt[b, 3]*x/(a + b*x^3)^(1/3))/Sqrt[3]]/(Sqrt[3]* Rt[b, 3]) - Log[(a + b*x^3)^(1/3) - Rt[b, 3]*x]/(2*Rt[b, 3]) /; FreeQ[{a, b}, x]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := a^(p + 1/n)* Subst[Int[1/(1 - b*x^n)^(p + 1/n + 1), x], x, x/(a + b*x^n)^(1/n)] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && LtQ[-1, p, 0] && NeQ[p, -1/2] && IntegerQ[p + 1/n]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := (a/(a + b*x^n))^(p + 1/n)*(a + b*x^n)^(p + 1/n)* Subst[Int[1/(1 - b*x^n)^(p + 1/n + 1), x], x, x/(a + b*x^n)^(1/n)] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && LtQ[-1, p, 0] && NeQ[p, -1/2] && LtQ[Denominator[p + 1/n], Denominator[p]]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := -Subst[Int[(a + b*x^(-n))^p/x^2, x], x, 1/x] /; FreeQ[{a, b, p}, x] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*x^(k*n))^p, x], x, x^(1/k)]] /; FreeQ[{a, b, p}, x] && FractionQ[n]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^n)^p, x], x] /; FreeQ[{a, b, n}, x] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := a^p*x*Hypergeometric2F1[-p, 1/n, 1/n + 1, -b*x^n/a] /; FreeQ[{a, b, n, p}, x] && Not[IGtQ[p, 0]] && Not[IntegerQ[1/n]] && Not[ILtQ[Simplify[1/n + p], 0]] && (IntegerQ[p] || GtQ[a, 0])
(* Int[(a_+b_.*x_^n_)^p_,x_Symbol] := x*(a+b*x^n)^(p+1)/a*Hypergeometric2F1[1,1/n+p+1,1/n+1,-b*x^n/a] /; FreeQ[{a,b,n,p},x] && Not[IGtQ[p,0]] && Not[IntegerQ[1/n]] &&  Not[ILtQ[Simplify[1/n+p],0]] && Not[IntegerQ[p] || GtQ[a,0]] *)
Int[(a_ + b_.*x_^n_)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^n)^FracPart[p]/(1 + b*x^n/a)^FracPart[p]* Int[(1 + b*x^n/a)^p, x] /; FreeQ[{a, b, n, p}, x] && Not[IGtQ[p, 0]] && Not[IntegerQ[1/n]] && Not[ILtQ[Simplify[1/n + p], 0]] && Not[IntegerQ[p] || GtQ[a, 0]]
Int[(a_. + b_.*v_^n_)^p_, x_Symbol] := 1/Coefficient[v, x, 1]*Subst[Int[(a + b*x^n)^p, x], x, v] /; FreeQ[{a, b, n, p}, x] && LinearQ[v, x] && NeQ[v, x]
Int[(a1_. + b1_.*x_^n_)^p_.*(a2_. + b2_.*x_^n_)^p_., x_Symbol] := Int[(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[p] || GtQ[a1, 0] && GtQ[a2, 0])
Int[(a1_ + b1_.*x_^n_.)^p_.*(a2_ + b2_.*x_^n_.)^p_., x_Symbol] := x*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p/(2*n*p + 1) + 2*a1*a2*n*p/(2*n*p + 1)* Int[(a1 + b1*x^n)^(p - 1)*(a2 + b2*x^n)^(p - 1), x] /; FreeQ[{a1, b1, a2, b2}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && GtQ[p, 0] && (IntegerQ[2*p] || Denominator[p + 1/n] < Denominator[p])
Int[(a1_ + b1_.*x_^n_.)^p_*(a2_ + b2_.*x_^n_.)^p_, x_Symbol] := -x*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*a1*a2* n*(p + 1)) + (2*n*(p + 1) + 1)/(2*a1*a2*n*(p + 1))* Int[(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1), x] /; FreeQ[{a1, b1, a2, b2}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && LtQ[p, -1] && (IntegerQ[2*p] || Denominator[p + 1/n] < Denominator[p])
Int[(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := -Subst[Int[(a1 + b1*x^(-n))^p*(a2 + b2*x^(-n))^p/x^2, x], x, 1/x] /; FreeQ[{a1, b1, a2, b2, p}, x] && EqQ[a2*b1 + a1*b2, 0] && ILtQ[2*n, 0]
Int[(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[2*n]}, k*Subst[ Int[x^(k - 1)*(a1 + b1*x^(k*n))^p*(a2 + b2*x^(k*n))^p, x], x, x^(1/k)]] /; FreeQ[{a1, b1, a2, b2, p}, x] && EqQ[a2*b1 + a1*b2, 0] && FractionQ[2*n]
Int[(a1_. + b1_.*x_^n_)^p_*(a2_. + b2_.*x_^n_)^p_, x_Symbol] := (a1 + b1*x^n)^ FracPart[p]*(a2 + b2*x^n)^FracPart[p]/(a1*a2 + b1*b2*x^(2*n))^ FracPart[p]*Int[(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && Not[IntegerQ[p]]
Int[(a_ + b_.*(c_.*x_^q_.)^n_)^p_., x_Symbol] := x/(c*x^q)^(1/q)* Subst[Int[(a + b*x^(n*q))^p, x], x, (c*x^q)^(1/q)] /; FreeQ[{a, b, c, n, p, q}, x] && IntegerQ[n*q] && NeQ[x, (c*x^q)^(1/q)]
Int[(a_ + b_.*(c_.*x_^q_.)^n_)^p_., x_Symbol] := With[{k = Denominator[n]}, Subst[Int[(a + b*c^n*x^(n*q))^p, x], x^(1/k), (c*x^q)^(1/k)/(c^(1/k)*(x^(1/k))^(q - 1))]] /; FreeQ[{a, b, c, p, q}, x] && FractionQ[n]
Int[(a_ + b_.*(c_.*x_^q_.)^n_)^p_., x_Symbol] := Subst[Int[(a + b*c^n*x^(n*q))^p, x], x^(n*q), (c*x^q)^n/c^n] /; FreeQ[{a, b, c, n, p, q}, x] && Not[RationalQ[n]]
Int[(a_ + b_.*(d_.*x_^q_.)^n_)^p_., x_Symbol] := -Subst[Int[(a + b*(d*x^(-q))^n)^p/x^2, x], x, 1/x] /; FreeQ[{a, b, d, n, p}, x] && ILtQ[q, 0]
Int[(a_ + b_.*(d_.*x_^q_.)^n_)^p_., x_Symbol] := With[{s = Denominator[q]}, s*Subst[Int[x^(s - 1)*(a + b*(d*x^(q*s))^n)^p, x], x, x^(1/s)]] /; FreeQ[{a, b, d, n, p}, x] && FractionQ[q]
(* Int[(a_+b_.*(d_.*x_^q_.)^n_)^p_.,x_Symbol] := Subst[Int[(a+b*x^(n*q))^p,x],x^(n*q),(d*x^q)^n] /; FreeQ[{a,b,d,n,p,q},x] && Not[IntegerQ[n*q]] &&  NeQ[x^(n*q),(d*x^q)^n] *)

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.2 (c x)^m (a+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.2 (c x)^m (a+b x^n)^p *)
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := Int[(c*x)^m*(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[p] || GtQ[a1, 0] && GtQ[a2, 0])
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := Log[RemoveContent[a + b*x^n, x]]/(b*n) /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := (a + b*x^n)^(p + 1)/(b*n*(p + 1)) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[x_^m_.*(a1_ + b1_.*x_^n_.)^p_*(a2_ + b2_.*x_^n_.)^p_, x_Symbol] := (a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*b1*b2*n*(p + 1)) /; FreeQ[{a1, b1, a2, b2, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && EqQ[m, 2*n - 1] && NeQ[p, -1]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := Int[x^(m + n*p)*(b + a*x^(-n))^p, x] /; FreeQ[{a, b, m, n}, x] && IntegerQ[p] && NegQ[n]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*(m + 1)) /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[(m + 1)/n + p + 1, 0] && NeQ[m, -1]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(a1*a2* c*(m + 1)) /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && EqQ[(m + 1)/(2*n) + p + 1, 0] && NeQ[m, -1]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := 1/n*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*x)^p, x], x, x^n] /; FreeQ[{a, b, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a1 + b1*x)^p*(a2 + b2*x)^p, x], x, x^n] /; FreeQ[{a1, b1, a2, b2, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[Simplify[(m + 1)/(2*n)]]
Int[(c_*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(c_*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[Simplify[(m + 1)/(2*n)]]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_., x_Symbol] := Int[ExpandIntegrand[(c*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 0]
Int[x_^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := x^(m + 1)*(a + b*x^n)^(p + 1)/(a*(m + 1)) - b*(m + n*(p + 1) + 1)/(a*(m + 1))* Int[x^(m + n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, m, n, p}, x] && ILtQ[Simplify[(m + 1)/n + p + 1], 0] && NeQ[m, -1]
Int[x_^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := x^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(a1* a2*(m + 1)) - b1*b2*(m + 2*n*(p + 1) + 1)/(a1*a2*(m + 1))* Int[x^(m + 2*n)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && ILtQ[Simplify[(m + 1)/(2*n) + p + 1], 0] && NeQ[m, -1]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := -(c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*n*(p + 1)) + (m + n*(p + 1) + 1)/(a*n*(p + 1))* Int[(c*x)^m*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, m, n, p}, x] && ILtQ[Simplify[(m + 1)/n + p + 1], 0] && NeQ[p, -1]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := -(c*x)^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*a1* a2*c*n*(p + 1)) + (m + 2*n*(p + 1) + 1)/(2*a1*a2*n*(p + 1))* Int[(c*x)^m*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1), x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && ILtQ[Simplify[(m + 1)/(2*n) + p + 1], 0] && NeQ[p, -1]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{k = GCD[m + 1, n]}, 1/k*Subst[Int[x^((m + 1)/k - 1)*(a + b*x^(n/k))^p, x], x, x^k] /; k != 1] /; FreeQ[{a, b, p}, x] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := With[{k = GCD[m + 1, 2*n]}, 1/k* Subst[Int[ x^((m + 1)/k - 1)*(a1 + b1*x^(n/k))^p*(a2 + b2*x^(n/k))^p, x], x, x^k] /; k != 1] /; FreeQ[{a1, b1, a2, b2, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && IntegerQ[m]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a + b*x^n)^p/(c*(m + 1)) - b*n*p/(c^n*(m + 1))*Int[(c*x)^(m + n)*(a + b*x^n)^(p - 1), x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1] && Not[ILtQ[(m + n*p + n + 1)/n, 0]] && IntBinomialQ[a, b, c, n, m, p, x]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p/(c*(m + 1)) - 2*b1*b2*n*p/(c^(2*n)*(m + 1))* Int[(c*x)^(m + 2*n)*(a1 + b1*x^n)^(p - 1)*(a2 + b2*x^n)^(p - 1), x] /; FreeQ[{a1, b1, a2, b2, c, m}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m + 2*n*p + 1, 0] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a + b*x^n)^p/(c*(m + n*p + 1)) + a*n*p/(m + n*p + 1)*Int[(c*x)^m*(a + b*x^n)^(p - 1), x] /; FreeQ[{a, b, c, m}, x] && IGtQ[n, 0] && GtQ[p, 0] && NeQ[m + n*p + 1, 0] && IntBinomialQ[a, b, c, n, m, p, x]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p/(c*(m + 2*n*p + 1)) + 2*a1*a2*n*p/(m + 2*n*p + 1)* Int[(c*x)^m*(a1 + b1*x^n)^(p - 1)*(a2 + b2*x^n)^(p - 1), x] /; FreeQ[{a1, b1, a2, b2, c, m}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && GtQ[p, 0] && NeQ[m + 2*n*p + 1, 0] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[x_^2/(a_ + b_.*x_^4)^(5/4), x_Symbol] := x*(1 + a/(b*x^4))^(1/4)/(b*(a + b*x^4)^(1/4))* Int[1/(x^3*(1 + a/(b*x^4))^(5/4)), x] /; FreeQ[{a, b}, x] && PosQ[b/a]
Int[x_^m_/(a_ + b_.*x_^4)^(5/4), x_Symbol] := x^(m - 3)/(b*(m - 4)*(a + b*x^4)^(1/4)) - a*(m - 3)/(b*(m - 4))*Int[x^(m - 4)/(a + b*x^4)^(5/4), x] /; FreeQ[{a, b}, x] && PosQ[b/a] && IGtQ[(m - 2)/4, 0]
Int[x_^m_/(a_ + b_.*x_^4)^(5/4), x_Symbol] := x^(m + 1)/(a*(m + 1)*(a + b*x^4)^(1/4)) - b*m/(a*(m + 1))*Int[x^(m + 4)/(a + b*x^4)^(5/4), x] /; FreeQ[{a, b}, x] && PosQ[b/a] && ILtQ[(m - 2)/4, 0]
Int[Sqrt[c_.*x_]/(a_ + b_.*x_^2)^(5/4), x_Symbol] := Sqrt[c*x]*(1 + a/(b*x^2))^(1/4)/(b*(a + b*x^2)^(1/4))* Int[1/(x^2*(1 + a/(b*x^2))^(5/4)), x] /; FreeQ[{a, b, c}, x] && PosQ[b/a]
Int[(c_.*x_)^m_/(a_ + b_.*x_^2)^(5/4), x_Symbol] := 2*c*(c*x)^(m - 1)/(b*(2*m - 3)*(a + b*x^2)^(1/4)) - 2*a*c^2*(m - 1)/(b*(2*m - 3))* Int[(c*x)^(m - 2)/(a + b*x^2)^(5/4), x] /; FreeQ[{a, b, c}, x] && PosQ[b/a] && IntegerQ[2*m] && GtQ[m, 3/2] 
Int[(c_.*x_)^m_/(a_ + b_.*x_^2)^(5/4), x_Symbol] := (c*x)^(m + 1)/(a*c*(m + 1)*(a + b*x^2)^(1/4)) - b*(2*m + 1)/(2*a*c^2*(m + 1))* Int[(c*x)^(m + 2)/(a + b*x^2)^(5/4), x] /; FreeQ[{a, b, c}, x] && PosQ[b/a] && IntegerQ[2*m] && LtQ[m, -1]
Int[x_^2/(a_ + b_.*x_^4)^(5/4), x_Symbol] := -1/(b*x*(a + b*x^4)^(1/4)) - 1/b*Int[1/(x^2*(a + b*x^4)^(1/4)), x] /; FreeQ[{a, b}, x] && NegQ[b/a]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^(n - 1)*(c*x)^(m - n + 1)*(a + b*x^n)^(p + 1)/(b*n*(p + 1)) - c^n*(m - n + 1)/(b*n*(p + 1))* Int[(c*x)^(m - n)*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m + 1, n] && Not[ILtQ[(m + n*(p + 1) + 1)/n, 0]] && IntBinomialQ[a, b, c, n, m, p, x]
(* Int[(c_.*x_)^m_.*u_^p_*v_^p_,x_Symbol] := With[{a=BinomialParts[u,x][[1]],b=BinomialParts[u,x][[2]],n= BinomialParts[u,x][[3]]}, c^(n-1)*(c*x)^(m-n+1)*u^(p+1)*v^(p+1)/(b*n*(p+1)) - c^n*(m-n+1)/(b*n*(p+1))*Int[(c*x)^(m-n)*u^(p+1)*v^(p+1),x] /; IGtQ[n,0] && m+1>n && Not[ILtQ[(m+n*(p+1)+1)/n,0]] && IntBinomialQ[a,b,c,n,m,p,x]] /; FreeQ[c,x] && BinomialQ[u*v,x] && LtQ[p,-1] *)
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^(2*n - 1)*(c*x)^(m - 2*n + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*b1*b2*n*(p + 1)) - c^(2*n)*(m - 2*n + 1)/(2*b1*b2*n*(p + 1))* Int[(c*x)^(m - 2*n)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1), x] /; FreeQ[{a1, b1, a2, b2, c}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && LtQ[p, -1] && m + 1 > 2*n && Not[ILtQ[(m + 2*n*(p + 1) + 1)/(2*n), 0]] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := -(c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*n*(p + 1)) + (m + n*(p + 1) + 1)/(a*n*(p + 1))* Int[(c*x)^m*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, m}, x] && IGtQ[n, 0] && LtQ[p, -1] && IntBinomialQ[a, b, c, n, m, p, x]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := -(c*x)^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*a1* a2*c*n*(p + 1)) + (m + 2*n*(p + 1) + 1)/(2*a1*a2*n*(p + 1))* Int[(c*x)^m*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1), x] /; FreeQ[{a1, b1, a2, b2, c, m}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && LtQ[p, -1] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[x_/(a_ + b_.*x_^3), x_Symbol] := -1/(3*Rt[a, 3]*Rt[b, 3])*Int[1/(Rt[a, 3] + Rt[b, 3]*x), x] + 1/(3*Rt[a, 3]*Rt[b, 3])* Int[(Rt[a, 3] + Rt[b, 3]*x)/(Rt[a, 3]^2 - Rt[a, 3]*Rt[b, 3]*x + Rt[b, 3]^2*x^2), x] /; FreeQ[{a, b}, x]
(* Int[x_^m_./(a_+b_.*x_^5),x_Symbol] := With[{r=Numerator[Rt[a/b,5]], s=Denominator[Rt[a/b,5]]}, (-1)^m*r^(m+1)/(5*a*s^m)*Int[1/(r+s*x),x] + 2*r^(m+1)/(5*a*s^m)*Int[(r*Cos[m*Pi/5]-s*Cos[(m+1)*Pi/5]*x)/(r^2-1/ 2*(1+Sqrt[5])*r*s*x+s^2*x^2),x] + 2*r^(m+1)/(5*a*s^m)*Int[(r*Cos[3*m*Pi/5]-s*Cos[3*(m+1)*Pi/5]*x)/(r^ 2-1/2*(1-Sqrt[5])*r*s*x+s^2*x^2),x]] /; FreeQ[{a,b},x] && IGtQ[m,0] && LtQ[m,4] && PosQ[a/b] *)
(* Int[x_^m_./(a_+b_.*x_^5),x_Symbol] := With[{r=Numerator[Rt[-a/b,5]], s=Denominator[Rt[-a/b,5]]}, (r^(m+1)/(5*a*s^m))*Int[1/(r-s*x),x] + 2*(-1)^m*r^(m+1)/(5*a*s^m)*Int[(r*Cos[m*Pi/5]+s*Cos[(m+1)*Pi/5]*x)/( r^2+1/2*(1+Sqrt[5])*r*s*x+s^2*x^2),x] + 2*(-1)^m*r^(m+1)/(5*a*s^m)*Int[(r*Cos[3*m*Pi/5]+s*Cos[3*(m+1)*Pi/5]* x)/(r^2+1/2*(1-Sqrt[5])*r*s*x+s^2*x^2),x]] /; FreeQ[{a,b},x] && IGtQ[m,0] && LtQ[m,4] && NegQ[a/b] *)
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[a/b, n]], s = Denominator[Rt[a/b, n]], k, u}, u = Int[(r*Cos[(2*k - 1)*m*Pi/n] - s*Cos[(2*k - 1)*(m + 1)*Pi/n]*x)/(r^2 - 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x]; -(-r)^(m + 1)/(a*n*s^m)*Int[1/(r + s*x), x] + Dist[2*r^(m + 1)/(a*n*s^m), Sum[u, {k, 1, (n - 1)/2}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 1)/2, 0] && IGtQ[m, 0] && LtQ[m, n - 1] && PosQ[a/b]
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[-a/b, n]], s = Denominator[Rt[-a/b, n]], k, u}, u = Int[(r*Cos[(2*k - 1)*m*Pi/n] + s*Cos[(2*k - 1)*(m + 1)*Pi/n]*x)/(r^2 + 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x]; r^(m + 1)/(a*n*s^m)*Int[1/(r - s*x), x] - Dist[2*(-r)^(m + 1)/(a*n*s^m), Sum[u, {k, 1, (n - 1)/2}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 1)/2, 0] && IGtQ[m, 0] && LtQ[m, n - 1] && NegQ[a/b]
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[a/b, n]], s = Denominator[Rt[a/b, n]], k, u}, u = Int[(r*Cos[(2*k - 1)*m*Pi/n] - s*Cos[(2*k - 1)*(m + 1)*Pi/n]*x)/(r^2 - 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x] + Int[(r*Cos[(2*k - 1)*m*Pi/n] + s*Cos[(2*k - 1)*(m + 1)*Pi/n]*x)/(r^2 + 2*r*s*Cos[(2*k - 1)*Pi/n]*x + s^2*x^2), x]; 2*(-1)^(m/2)*r^(m + 2)/(a*n*s^m)*Int[1/(r^2 + s^2*x^2), x] + Dist[2*r^(m + 1)/(a*n*s^m), Sum[u, {k, 1, (n - 2)/4}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 2)/4, 0] && IGtQ[m, 0] && LtQ[m, n - 1] && PosQ[a/b]
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := Module[{r = Numerator[Rt[-a/b, n]], s = Denominator[Rt[-a/b, n]], k, u}, u = Int[(r*Cos[2*k*m*Pi/n] - s*Cos[2*k*(m + 1)*Pi/n]*x)/(r^2 - 2*r*s*Cos[2*k*Pi/n]*x + s^2*x^2), x] + Int[(r*Cos[2*k*m*Pi/n] + s*Cos[2*k*(m + 1)*Pi/n]*x)/(r^2 + 2*r*s*Cos[2*k*Pi/n]*x + s^2*x^2), x]; 2*r^(m + 2)/(a*n*s^m)*Int[1/(r^2 - s^2*x^2), x] + Dist[2*r^(m + 1)/(a*n*s^m), Sum[u, {k, 1, (n - 2)/4}], x]] /; FreeQ[{a, b}, x] && IGtQ[(n - 2)/4, 0] && IGtQ[m, 0] && LtQ[m, n - 1] && NegQ[a/b]
Int[x_^2/(a_ + b_.*x_^4), x_Symbol] := With[{r = Numerator[Rt[a/b, 2]], s = Denominator[Rt[a/b, 2]]}, 1/(2*s)*Int[(r + s*x^2)/(a + b*x^4), x] - 1/(2*s)*Int[(r - s*x^2)/(a + b*x^4), x]] /; FreeQ[{a, b}, x] && (GtQ[a/b, 0] || PosQ[a/b] && AtomQ[SplitProduct[SumBaseQ, a]] && AtomQ[SplitProduct[SumBaseQ, b]])
Int[x_^2/(a_ + b_.*x_^4), x_Symbol] := With[{r = Numerator[Rt[-a/b, 2]], s = Denominator[Rt[-a/b, 2]]}, s/(2*b)*Int[1/(r + s*x^2), x] - s/(2*b)*Int[1/(r - s*x^2), x]] /; FreeQ[{a, b}, x] && Not[GtQ[a/b, 0]]
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := With[{r = Numerator[Rt[a/b, 4]], s = Denominator[Rt[a/b, 4]]}, s^3/(2*Sqrt[2]*b*r)* Int[x^(m - n/4)/(r^2 - Sqrt[2]*r*s*x^(n/4) + s^2*x^(n/2)), x] - s^3/(2*Sqrt[2]*b*r)* Int[x^(m - n/4)/(r^2 + Sqrt[2]*r*s*x^(n/4) + s^2*x^(n/2)), x]] /; FreeQ[{a, b}, x] && IGtQ[n/4, 0] && IGtQ[m, 0] && LtQ[m, n - 1] && GtQ[a/b, 0]
Int[x_^m_/(a_ + b_.*x_^n_), x_Symbol] := With[{r = Numerator[Rt[-a/b, 2]], s = Denominator[Rt[-a/b, 2]]}, r/(2*a)*Int[x^m/(r + s*x^(n/2)), x] + r/(2*a)*Int[x^m/(r - s*x^(n/2)), x]] /; FreeQ[{a, b}, x] && IGtQ[n/4, 0] && IGtQ[m, 0] && LtQ[m, n/2] && Not[GtQ[a/b, 0]]
Int[x_^m_/(a_ + b_.*x_^n_), x_Symbol] := With[{r = Numerator[Rt[-a/b, 2]], s = Denominator[Rt[-a/b, 2]]}, s/(2*b)*Int[x^(m - n/2)/(r + s*x^(n/2)), x] - s/(2*b)*Int[x^(m - n/2)/(r - s*x^(n/2)), x]] /; FreeQ[{a, b}, x] && IGtQ[n/4, 0] && IGtQ[m, 0] && LeQ[n/2, m] && LtQ[m, n] && Not[GtQ[a/b, 0]]
Int[x_^m_/(a_ + b_.*x_^n_), x_Symbol] := Int[PolynomialDivide[x^m, (a + b*x^n), x], x] /; FreeQ[{a, b}, x] && IGtQ[m, 0] && IGtQ[n, 0] && GtQ[m, 2*n - 1]
Int[x_/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, -(1 - Sqrt[3])*s/r*Int[1/Sqrt[a + b*x^3], x] + 1/r*Int[((1 - Sqrt[3])*s + r*x)/Sqrt[a + b*x^3], x]] /; FreeQ[{a, b}, x] && PosQ[a]
Int[x_/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, -(1 + Sqrt[3])*s/r*Int[1/Sqrt[a + b*x^3], x] + 1/r*Int[((1 + Sqrt[3])*s + r*x)/Sqrt[a + b*x^3], x]] /; FreeQ[{a, b}, x] && NegQ[a]
Int[x_^2/Sqrt[a_ + b_.*x_^4], x_Symbol] := With[{q = Rt[b/a, 2]}, 1/q*Int[1/Sqrt[a + b*x^4], x] - 1/q*Int[(1 - q*x^2)/Sqrt[a + b*x^4], x]] /; FreeQ[{a, b}, x] && PosQ[b/a]
Int[x_^2/Sqrt[a_ + b_.*x_^4], x_Symbol] := With[{q = Rt[-b/a, 2]}, 1/q*Int[1/Sqrt[a + b*x^4], x] - 1/q*Int[(1 - q*x^2)/Sqrt[a + b*x^4], x]] /; FreeQ[{a, b}, x] && LtQ[a, 0] && GtQ[b, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^4], x_Symbol] := With[{q = Rt[-b/a, 2]}, -1/q*Int[1/Sqrt[a + b*x^4], x] + 1/q*Int[(1 + q*x^2)/Sqrt[a + b*x^4], x]] /; FreeQ[{a, b}, x] && NegQ[b/a]
Int[x_^4/Sqrt[a_ + b_.*x_^6], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, (Sqrt[3] - 1)*s^2/(2*r^2)*Int[1/Sqrt[a + b*x^6], x] - 1/(2*r^2)* Int[((Sqrt[3] - 1)*s^2 - 2*r^2*x^4)/Sqrt[a + b*x^6], x]] /; FreeQ[{a, b}, x]
(* Int[x_^4/Sqrt[a_+b_.*x_^6],x_Symbol] := With[{r=Numer[Rt[b/a,3]], s=Denom[Rt[b/a,3]]}, (1+Sqrt[3])*r*x*Sqrt[a+b*x^6]/(2*b*(s+(1+Sqrt[3])*r*x^2)) - 3^(1/4)*s*x*(s+r*x^2)*Sqrt[(s^2-r*s*x^2+r^2*x^4)/(s+(1+Sqrt[3])*r*x^ 2)^2]/ (2*r^2*Sqrt[a+b*x^6]*Sqrt[r*x^2*(s+r*x^2)/(s+(1+Sqrt[3])*r*x^2)^2] )* EllipticE[ArcCos[(s+(1-Sqrt[3])*r*x^2)/(s+(1+Sqrt[3])*r*x^2)],(2+ Sqrt[3])/4] - (1-Sqrt[3])*s*x*(s+r*x^2)*Sqrt[(s^2-r*s*x^2+r^2*x^4)/(s+(1+Sqrt[3])* r*x^2)^2]/ (4*3^(1/4)*r^2*Sqrt[a+b*x^6]*Sqrt[r*x^2*(s+r*x^2)/(s+(1+Sqrt[3])* r*x^2)^2])* EllipticF[ArcCos[(s+(1-Sqrt[3])*r*x^2)/(s+(1+Sqrt[3])*r*x^2)],(2+ Sqrt[3])/4]] /; FreeQ[{a,b},x] *)
Int[x_^2/Sqrt[a_ + b_.*x_^8], x_Symbol] := 1/(2*Rt[b/a, 4])*Int[(1 + Rt[b/a, 4]*x^2)/Sqrt[a + b*x^8], x] - 1/(2*Rt[b/a, 4])*Int[(1 - Rt[b/a, 4]*x^2)/Sqrt[a + b*x^8], x] /; FreeQ[{a, b}, x]
Int[x_^2/(a_ + b_.*x_^4)^(1/4), x_Symbol] := x^3/(2*(a + b*x^4)^(1/4)) - a/2*Int[x^2/(a + b*x^4)^(5/4), x] /; FreeQ[{a, b}, x] && PosQ[b/a]
Int[x_^2/(a_ + b_.*x_^4)^(1/4), x_Symbol] := (a + b*x^4)^(3/4)/(2*b*x) + a/(2*b)*Int[1/(x^2*(a + b*x^4)^(1/4)), x] /; FreeQ[{a, b}, x] && NegQ[b/a]
Int[1/(x_^2*(a_ + b_.*x_^4)^(1/4)), x_Symbol] := -1/(x*(a + b*x^4)^(1/4)) - b*Int[x^2/(a + b*x^4)^(5/4), x] /; FreeQ[{a, b}, x] && PosQ[b/a]
Int[1/(x_^2*(a_ + b_.*x_^4)^(1/4)), x_Symbol] := x*(1 + a/(b*x^4))^(1/4)/(a + b*x^4)^(1/4)* Int[1/(x^3*(1 + a/(b*x^4))^(1/4)), x] /; FreeQ[{a, b}, x] && NegQ[b/a]
Int[Sqrt[c_*x_]/(a_ + b_.*x_^2)^(1/4), x_Symbol] := x*Sqrt[c*x]/(a + b*x^2)^(1/4) - a/2*Int[Sqrt[c*x]/(a + b*x^2)^(5/4), x] /; FreeQ[{a, b, c}, x] && PosQ[b/a]
Int[Sqrt[c_*x_]/(a_ + b_.*x_^2)^(1/4), x_Symbol] := c*(a + b*x^2)^(3/4)/(b*Sqrt[c*x]) + a*c^2/(2*b)*Int[1/((c*x)^(3/2)*(a + b*x^2)^(1/4)), x] /; FreeQ[{a, b, c}, x] && NegQ[b/a]
Int[1/((c_.*x_)^(3/2)*(a_ + b_.*x_^2)^(1/4)), x_Symbol] := -2/(c*Sqrt[c*x]*(a + b*x^2)^(1/4)) - b/c^2*Int[Sqrt[c*x]/(a + b*x^2)^(5/4), x] /; FreeQ[{a, b, c}, x] && PosQ[b/a]
Int[1/((c_.*x_)^(3/2)*(a_ + b_.*x_^2)^(1/4)), x_Symbol] := Sqrt[c*x]*(1 + a/(b*x^2))^(1/4)/(c^2*(a + b*x^2)^(1/4))* Int[1/(x^2*(1 + a/(b*x^2))^(1/4)), x] /; FreeQ[{a, b, c}, x] && NegQ[b/a]
Int[Sqrt[x_]/Sqrt[a_ + b_.*x_^2], x_Symbol] := -2/(Sqrt[a]*(-b/a)^(3/4))* Subst[Int[Sqrt[1 - 2*x^2]/Sqrt[1 - x^2], x], x, Sqrt[1 - Sqrt[-b/a]*x]/Sqrt[2]] /; FreeQ[{a, b}, x] && GtQ[-b/a, 0] && GtQ[a, 0]
Int[Sqrt[x_]/Sqrt[a_ + b_.*x_^2], x_Symbol] := Sqrt[1 + b*x^2/a]/Sqrt[a + b*x^2]* Int[Sqrt[x]/Sqrt[1 + b*x^2/a], x] /; FreeQ[{a, b}, x] && GtQ[-b/a, 0] && Not[GtQ[a, 0]]
Int[Sqrt[c_*x_]/Sqrt[a_ + b_.*x_^2], x_Symbol] := Sqrt[c*x]/Sqrt[x]*Int[Sqrt[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && GtQ[-b/a, 0]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^(n - 1)*(c*x)^(m - n + 1)*(a + b*x^n)^(p + 1)/(b*(m + n*p + 1)) - a*c^n*(m - n + 1)/(b*(m + n*p + 1))* Int[(c*x)^(m - n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, p}, x] && IGtQ[n, 0] && GtQ[m, n - 1] && NeQ[m + n*p + 1, 0] && IntBinomialQ[a, b, c, n, m, p, x]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^(n - 1)*(c*x)^(m - n + 1)*(a + b*x^n)^(p + 1)/(b*(m + n*p + 1)) - a*c^n*(m - n + 1)/(b*(m + n*p + 1))* Int[(c*x)^(m - n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, p}, x] && IGtQ[n, 0] && SumSimplerQ[m, -n] && NeQ[m + n*p + 1, 0] && ILtQ[Simplify[(m + 1)/n + p], 0]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^(2*n - 1)*(c*x)^(m - 2*n + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(b1*b2*(m + 2*n*p + 1)) - a1*a2*c^(2*n)*(m - 2*n + 1)/(b1*b2*(m + 2*n*p + 1))* Int[(c*x)^(m - 2*n)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && GtQ[m, 2*n - 1] && NeQ[m + 2*n*p + 1, 0] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^(2*n - 1)*(c*x)^(m - 2*n + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(b1*b2*(m + 2*n*p + 1)) - a1*a2*c^(2*n)*(m - 2*n + 1)/(b1*b2*(m + 2*n*p + 1))* Int[(c*x)^(m - 2*n)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && SumSimplerQ[m, -2*n] && NeQ[m + 2*n*p + 1, 0] && ILtQ[Simplify[(m + 1)/(2*n) + p], 0]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*(m + 1)) - b*(m + n*(p + 1) + 1)/(a*c^n*(m + 1))* Int[(c*x)^(m + n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, p}, x] && IGtQ[n, 0] && LtQ[m, -1] && IntBinomialQ[a, b, c, n, m, p, x]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*(m + 1)) - b*(m + n*(p + 1) + 1)/(a*c^n*(m + 1))* Int[(c*x)^(m + n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, p}, x] && IGtQ[n, 0] && SumSimplerQ[m, n] && ILtQ[Simplify[(m + 1)/n + p], 0]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(a1*a2* c*(m + 1)) - b1*b2*(m + 2*n*(p + 1) + 1)/(a1*a2*c^(2*n)*(m + 1))* Int[(c*x)^(m + 2*n)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && LtQ[m, -1] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(a1*a2* c*(m + 1)) - b1*b2*(m + 2*n*(p + 1) + 1)/(a1*a2*c^(2*n)*(m + 1))* Int[(c*x)^(m + 2*n)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && SumSimplerQ[m, 2*n] && ILtQ[Simplify[(m + 1)/(2*n) + p], 0]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[m]}, k/c* Subst[Int[x^(k*(m + 1) - 1)*(a + b*x^(k*n)/c^n)^p, x], x, (c*x)^(1/k)]] /; FreeQ[{a, b, c, p}, x] && IGtQ[n, 0] && FractionQ[m] && IntBinomialQ[a, b, c, n, m, p, x]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[m]}, k/c* Subst[Int[ x^(k*(m + 1) - 1)*(a1 + b1*x^(k*n)/c^n)^p*(a2 + b2*x^(k*n)/c^n)^ p, x], x, (c*x)^(1/k)]] /; FreeQ[{a1, b1, a2, b2, c, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && FractionQ[m] && IntBinomialQ[a1*a2, b1*b2, c, 2*n, m, p, x]
Int[x_/(a_ + b_.*x_^3)^(2/3), x_Symbol] := With[{q = Rt[b, 3]}, -ArcTan[(1 + 2*q*x/(a + b*x^3)^(1/3))/Sqrt[3]]/(Sqrt[3]*q^2) - Log[q*x - (a + b*x^3)^(1/3)]/(2*q^2)] /; FreeQ[{a, b}, x]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := a^(p + (m + 1)/n)* Subst[Int[x^m/(1 - b*x^n)^(p + (m + 1)/n + 1), x], x, x/(a + b*x^n)^(1/n)] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && LtQ[-1, p, 0] && NeQ[p, -1/2] && IntegersQ[m, p + (m + 1)/n]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (a1*a2)^(p + (m + 1)/(2*n))* Subst[ Int[x^m/((1 - b1*x^n)^(p + (m + 1)/(2*n) + 1)*(1 - b2*x^n)^(p + (m + 1)/(2*n) + 1)), x], x, x/((a1 + b1*x^n)^(1/(2*n))*(a2 + b2*x^n)^(1/(2*n)))] /; FreeQ[{a1, b1, a2, b2}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && LtQ[-1, p, 0] && NeQ[p, -1/2] && IntegersQ[m, p + (m + 1)/(2*n)]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := (a/(a + b*x^n))^(p + (m + 1)/n)*(a + b*x^n)^(p + (m + 1)/n)* Subst[Int[x^m/(1 - b*x^n)^(p + (m + 1)/n + 1), x], x, x/(a + b*x^n)^(1/n)] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && LtQ[-1, p, 0] && NeQ[p, -1/2] && IntegerQ[m] && LtQ[Denominator[p + (m + 1)/n], Denominator[p]]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (a1/(a1 + b1*x^n))^(p + (m + 1)/(2*n))*(a1 + b1*x^n)^(p + (m + 1)/(2*n))*(a2/(a2 + b2*x^n))^(p + (m + 1)/(2*n))*(a2 + b2*x^n)^(p + (m + 1)/(2*n))* Subst[ Int[x^m/((1 - b1*x^n)^(p + (m + 1)/(2*n) + 1)*(1 - b2*x^n)^(p + (m + 1)/(2*n) + 1)), x], x, x/((a1 + b1*x^n)^(1/(2*n))*(a2 + b2*x^n)^(1/(2*n)))] /; FreeQ[{a1, b1, a2, b2}, x] && EqQ[a2*b1 + a1*b2, 0] && IGtQ[2*n, 0] && LtQ[-1, p, 0] && NeQ[p, -1/2] && IntegerQ[m] && LtQ[Denominator[p + (m + 1)/(2*n)], Denominator[p]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := -Subst[Int[(a + b*x^(-n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, p}, x] && ILtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := -Subst[Int[(a1 + b1*x^(-n))^p*(a2 + b2*x^(-n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a1, b1, a2, b2, p}, x] && EqQ[a2*b1 + a1*b2, 0] && ILtQ[2*n, 0] && IntegerQ[m]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[m]}, -k/c* Subst[Int[(a + b*c^(-n)*x^(-k*n))^p/x^(k*(m + 1) + 1), x], x, 1/(c*x)^(1/k)]] /; FreeQ[{a, b, c, p}, x] && ILtQ[n, 0] && FractionQ[m]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[m]}, -k/c* Subst[Int[(a1 + b1*c^(-n)*x^(-k*n))^p*(a2 + b2*c^(-n)*x^(-k*n))^p/ x^(k*(m + 1) + 1), x], x, 1/(c*x)^(1/k)]] /; FreeQ[{a1, b1, a2, b2, c, p}, x] && EqQ[a2*b1 + a1*b2, 0] && ILtQ[2*n, 0] && FractionQ[m]
Int[(c_.*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := -1/c*(c*x)^(m + 1)*(1/x)^(m + 1)* Subst[Int[(a + b*x^(-n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, m, p}, x] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[(c_.*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := -1/c*(c*x)^(m + 1)*(1/x)^(m + 1)* Subst[Int[(a1 + b1*x^(-n))^p*(a2 + b2*x^(-n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a1, b1, a2, b2, c, m, p}, x] && EqQ[a2*b1 + a1*b2, 0] && ILtQ[2*n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*x^(k*n))^p, x], x, x^(1/k)]] /; FreeQ[{a, b, m, p}, x] && FractionQ[n]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[2*n]}, k*Subst[ Int[x^(k*(m + 1) - 1)*(a1 + b1*x^(k*n))^p*(a2 + b2*x^(k*n))^p, x], x, x^(1/k)]] /; FreeQ[{a1, b1, a2, b2, m, p}, x] && EqQ[a2*b1 + a1*b2, 0] && FractionQ[2*n]
Int[(c_*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, p}, x] && FractionQ[n]
Int[(c_*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, p}, x] && EqQ[a2*b1 + a1*b2, 0] && FractionQ[2*n]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*x^Simplify[n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, m, n, p}, x] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[(a1 + b1*x^Simplify[n/(m + 1)])^ p*(a2 + b2*x^Simplify[n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a1, b1, a2, b2, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[Simplify[2*n/(m + 1)]] && Not[IntegerQ[2*n]]
Int[(c_*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[Simplify[2*n/(m + 1)]] && Not[IntegerQ[2*n]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := x^(m + 1)*(a + b*x^n)^p/(m + 1) - b*n*p/(m + 1)*Int[x^(m + n)*(a + b*x^n)^(p - 1), x] /; FreeQ[{a, b, m, n}, x] && EqQ[(m + 1)/n + p, 0] && GtQ[p, 0]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := x^(m + 1)*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p/(m + 1) - 2*b1*b2*n*p/(m + 1)* Int[x^(m + 2*n)*(a1 + b1*x^n)^(p - 1)*(a2 + b2*x^n)^(p - 1), x] /; FreeQ[{a1, b1, a2, b2, m, n}, x] && EqQ[a2*b1 + a1*b2, 0] && EqQ[(m + 1)/(2*n) + p, 0] && GtQ[p, 0]
Int[(c_*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, n}, x] && EqQ[(m + 1)/n + p, 0] && GtQ[p, 0]
Int[(c_*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n}, x] && EqQ[a2*b1 + a1*b2, 0] && EqQ[(m + 1)/(2*n) + p, 0] && GtQ[p, 0]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a + b*x^n)^p/(c*(m + n*p + 1)) + a*n*p/(m + n*p + 1)*Int[(c*x)^m*(a + b*x^n)^(p - 1), x] /; FreeQ[{a, b, c, m, n}, x] && IntegerQ[p + Simplify[(m + 1)/n]] && GtQ[p, 0] && NeQ[m + n*p + 1, 0]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (c*x)^(m + 1)*(a1 + b1*x^n)^ p*(a2 + b2*x^n)^p/(c*(m + 2*n*p + 1)) + 2*a1*a2*n*p/(m + 2*n*p + 1)* Int[(c*x)^m*(a1 + b1*x^n)^(p - 1)*(a2 + b2*x^n)^(p - 1), x] /; FreeQ[{a1, b1, a2, b2, c, m, n}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[p + Simplify[(m + 1)/(2*n)]] && GtQ[p, 0] && NeQ[m + 2*n*p + 1, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[p]}, k*a^(p + Simplify[(m + 1)/n])/n* Subst[ Int[x^(k*Simplify[(m + 1)/n] - 1)/(1 - b*x^k)^(p + Simplify[(m + 1)/n] + 1), x], x, x^(n/k)/(a + b*x^n)^(1/k)]] /; FreeQ[{a, b, m, n}, x] && IntegerQ[p + Simplify[(m + 1)/n]] && LtQ[-1, p, 0]
Int[x_^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := With[{k = Denominator[p]}, k*(a1*a2)^(p + Simplify[(m + 1)/(2*n)])/(2*n)* Subst[ Int[x^(k*Simplify[(m + 1)/(2*n)] - 1)/(1 - b1*b2*x^k)^(p + Simplify[(m + 1)/(2*n)] + 1), x], x, x^(2*n/k)/((a1 + b1*x^n)^(1/k)*(a2 + b2*x^n)^(1/k))]] /; FreeQ[{a1, b1, a2, b2, m, n}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[p + Simplify[(m + 1)/(2*n)]] && LtQ[-1, p, 0]
Int[(c_*x_)^m_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, n}, x] && IntegerQ[p + Simplify[(m + 1)/n]] && LtQ[-1, p, 0]
Int[(c_*x_)^m_*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a1 + b1*x^n)^p*(a2 + b2*x^n)^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[p + Simplify[(m + 1)/(2*n)]] && LtQ[-1, p, 0]
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := -(c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*n*(p + 1)) + (m + n*(p + 1) + 1)/(a*n*(p + 1))* Int[(c*x)^m*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, m, n}, x] && IntegerQ[p + Simplify[(m + 1)/n]] && LtQ[p, -1]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := -(c*x)^(m + 1)*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1)/(2*a1* a2*c*n*(p + 1)) + (m + 2*n*(p + 1) + 1)/(2*a1*a2*n*(p + 1))* Int[(c*x)^m*(a1 + b1*x^n)^(p + 1)*(a2 + b2*x^n)^(p + 1), x] /; FreeQ[{a1, b1, a2, b2, c, m, n}, x] && EqQ[a2*b1 + a1*b2, 0] && IntegerQ[p + Simplify[(m + 1)/(2*n)]] && LtQ[p, -1]
Int[x_^m_./(a_ + b_.*x_^n_), x_Symbol] := With[{mn = Simplify[m - n]}, x^(mn + 1)/(b*(mn + 1)) - a/b*Int[x^mn/(a + b*x^n), x]] /; FreeQ[{a, b, m, n}, x] && FractionQ[Simplify[(m + 1)/n]] && SumSimplerQ[m, -n]
Int[x_^m_/(a_ + b_.*x_^n_), x_Symbol] := x^(m + 1)/(a*(m + 1)) - b/a*Int[x^Simplify[m + n]/(a + b*x^n), x] /; FreeQ[{a, b, m, n}, x] && FractionQ[Simplify[(m + 1)/n]] && SumSimplerQ[m, n]
Int[(c_*x_)^m_/(a_ + b_.*x_^n_), x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m/(a + b*x^n), x] /; FreeQ[{a, b, c, m, n}, x] && FractionQ[ Simplify[(m + 1)/n]] && (SumSimplerQ[m, n] || SumSimplerQ[m, -n])
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := a^p*(c*x)^(m + 1)/(c*(m + 1))* Hypergeometric2F1[-p, (m + 1)/n, (m + 1)/n + 1, -b*x^n/a] /; FreeQ[{a, b, c, m, n, p}, x] && Not[IGtQ[p, 0]] && (ILtQ[p, 0] || GtQ[a, 0])
(* Int[(c_.*x_)^m_.*(a_+b_.*x_^n_)^p_,x_Symbol] := (c*x)^(m+1)*(a+b*x^n)^(p+1)/(a*c*(m+1))*Hypergeometric2F1[1,(m+1)/n+ p+1,(m+1)/n+1,-b*x^n/a] /; FreeQ[{a,b,c,m,n,p},x] && Not[IGtQ[p,0]] && Not[ILtQ[p,0] ||  GtQ[a,0]] *)
Int[(c_.*x_)^m_.*(a_ + b_.*x_^n_)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^n)^FracPart[p]/(1 + b*x^n/a)^FracPart[p]* Int[(c*x)^m*(1 + b*x^n/a)^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && Not[IGtQ[p, 0]] && Not[ILtQ[p, 0] || GtQ[a, 0]]
Int[(c_.*x_)^m_.*(a1_ + b1_.*x_^n_)^p_*(a2_ + b2_.*x_^n_)^p_, x_Symbol] := (a1 + b1*x^n)^ FracPart[p]*(a2 + b2*x^n)^FracPart[p]/(a1*a2 + b1*b2*x^(2*n))^ FracPart[p]*Int[(c*x)^m*(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && EqQ[a2*b1 + a1*b2, 0] && Not[IntegerQ[p]]
(* IntBinomialQ[a,b,c,n,m,p,x] returns True iff (c*x)^m*(a+b*x^n)^p  is integrable wrt x in terms of non-hypergeometric functions. *) IntBinomialQ[a_, b_, c_, n_, m_, p_, x_] := IGtQ[p, 0] || RationalQ[m] && IntegersQ[n, 2*p] || IntegerQ[(m + 1)/n + p] || (EqQ[n, 2] || EqQ[n, 4]) && IntegersQ[2*m, 4*p] || EqQ[n, 2] && IntegerQ[6*p] && (IntegerQ[m] || IntegerQ[m - p])
Int[(d_.*x_)^m_.*(a_ + b_.*(c_*x_)^n_)^p_., x_Symbol] := 1/c*Subst[Int[(d*x/c)^m*(a + b*x^n)^p, x], x, c*x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(d_.*x_)^m_.*(a_ + b_.*(c_.*x_^q_)^n_)^p_., x_Symbol] := (d*x)^(m + 1)/(d*((c*x^q)^(1/q))^(m + 1))* Subst[Int[x^m*(a + b*x^(n*q))^p, x], x, (c*x^q)^(1/q)] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && IntegerQ[n*q] && NeQ[x, (c*x^q)^(1/q)]
Int[(d_.*x_)^m_.*(a_ + b_.*(c_.*x_^q_)^n_)^p_., x_Symbol] := With[{k = Denominator[n]}, Subst[Int[(d*x)^m*(a + b*c^n*x^(n*q))^p, x], x^(1/k), (c*x^q)^(1/k)/(c^(1/k)*(x^(1/k))^(q - 1))]] /; FreeQ[{a, b, c, d, m, p, q}, x] && FractionQ[n]
Int[(d_.*x_)^m_.*(a_ + b_.*(c_.*x_^q_)^n_)^p_., x_Symbol] := Subst[Int[(d*x)^m*(a + b*c^n*x^(n*q))^p, x], x^(n*q), (c*x^q)^n/c^n] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && Not[RationalQ[n]]
Int[x_^m_.*(a_ + b_.*v_^n_)^p_., x_Symbol] := With[{c = Coefficient[v, x, 0], d = Coefficient[v, x, 1]}, 1/d^(m + 1)* Subst[Int[SimplifyIntegrand[(x - c)^m*(a + b*x^n)^p, x], x], x, v] /; NeQ[c, 0]] /; FreeQ[{a, b, n, p}, x] && LinearQ[v, x] && IntegerQ[m]
Int[u_^m_.*(a_ + b_.*v_^n_)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(a + b*x^n)^p, x], x, v] /; FreeQ[{a, b, m, n, p}, x] && LinearPairQ[u, v, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.3 (a+b x^n)^p (c+d x^n)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.3 (a+b x^n)^p (c+d x^n)^q *)
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := Int[ExpandIntegrand[(a + b*x^n)^p*(c + d*x^n)^q, x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[p, 0] && IGtQ[q, 0]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := Int[x^(n*(p + q))*(b + a*x^(-n))^p*(d + c*x^(-n))^q, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && IntegersQ[p, q] && NegQ[n]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := -Subst[Int[(a + b*x^(-n))^p*(c + d*x^(-n))^q/x^2, x], x, 1/x] /; FreeQ[{a, b, c, d, p, q}, x] && NeQ[b*c - a*d, 0] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := With[{g = Denominator[n]}, g*Subst[Int[x^(g - 1)*(a + b*x^(g*n))^p*(c + d*x^(g*n))^q, x], x, x^(1/g)]] /; FreeQ[{a, b, c, d, p, q}, x] && NeQ[b*c - a*d, 0] && FractionQ[n]
Int[1/((a_ + b_.*x_^3)^(1/3)*(c_ + d_.*x_^3)), x_Symbol] := With[{q = Rt[(b*c - a*d)/c, 3]}, ArcTan[(1 + (2*q*x)/(a + b*x^3)^(1/3))/Sqrt[3]]/(Sqrt[3]*c*q) + Log[c + d*x^3]/(6*c*q) - Log[q*x - (a + b*x^3)^(1/3)]/(2*c*q)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*x_^n_)^p_/(c_ + d_.*x_^n_), x_Symbol] := Subst[Int[1/(c - (b*c - a*d)*x^n), x], x, x/(a + b*x^n)^(1/n)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[n*p + 1, 0] && IntegerQ[n]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_., x_Symbol] := -x*(a + b*x^n)^(p + 1)*(c + d*x^n)^q/(a*n*(p + 1)) - c*q/(a*(p + 1))*Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1), x] /; FreeQ[{a, b, c, d, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[n*(p + q + 1) + 1, 0] && GtQ[q, 0] && NeQ[p, -1]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := a^p*x/(c^(p + 1)*(c + d*x^n)^(1/n))* Hypergeometric2F1[1/n, -p, 1 + 1/n, -(b*c - a*d)*x^n/(a*(c + d*x^n))] /; FreeQ[{a, b, c, d, n, q}, x] && NeQ[b*c - a*d, 0] && EqQ[n*(p + q + 1) + 1, 0] && ILtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := x*(a + b*x^n)^ p/(c*(c*(a + b*x^n)/(a*(c + d*x^n)))^p*(c + d*x^n)^(1/n + p))* Hypergeometric2F1[1/n, -p, 1 + 1/n, -(b*c - a*d)*x^n/(a*(c + d*x^n))] /; FreeQ[{a, b, c, d, n, p, q}, x] && NeQ[b*c - a*d, 0] && EqQ[n*(p + q + 1) + 1, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*c) /; FreeQ[{a, b, c, d, n, p, q}, x] && NeQ[b*c - a*d, 0] && EqQ[n*(p + q + 2) + 1, 0] && EqQ[a*d*(p + 1) + b*c*(q + 1), 0]
(* Int[(a1_+b1_.*x_^n2_.)^p_*(a2_+b2_.*x_^n2_.)^p_*(c_+d_.*x_^n_)^q_, x_Symbol] := x*(a1+b1*x^(n/2))^(p+1)*(a2+b2*x^(n/2))^(p+1)*(c+d*x^n)^(q+1)/(a1* a2*c) /; FreeQ[{a1,b1,a2,b2,c,d,n,p,q},x] && EqQ[n2,n/2] && EqQ[a2*b1+a1*b2,0]  && EqQ[n*(p+q+2)+1,0] && EqQ[a1*a2*d*(p+1)+b1*b2*c*(q+1),0] *)
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -b*x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a* n*(p + 1)*(b*c - a*d)) + (b*c + n*(p + 1)*(b*c - a*d))/(a*n*(p + 1)*(b*c - a*d))* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, n, q}, x] && NeQ[b*c - a*d, 0] && EqQ[n*(p + q + 2) + 1, 0] && (LtQ[p, -1] || Not[LtQ[q, -1]]) && NeQ[p, -1]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := c*x*(a + b*x^n)^(p + 1)/a /; FreeQ[{a, b, c, d, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[a*d - b*c*(n*(p + 1) + 1), 0]
Int[(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := c*x*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(a1*a2) /; FreeQ[{a1, b1, a2, b2, c, d, n, p}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && EqQ[a1*a2*d - b1*b2*c*(n*(p + 1) + 1), 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_), x_Symbol] := -(b*c - a*d)*x*(a + b*x^n)^(p + 1)/(a*b*n*(p + 1)) - (a*d - b*c*(n*(p + 1) + 1))/(a*b*n*(p + 1))* Int[(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, d, n, p}, x] && NeQ[b*c - a*d, 0] && (LtQ[p, -1] || ILtQ[1/n + p, 0])
Int[(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := -(b1*b2*c - a1*a2*d)* x*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(a1*a2*b1* b2*n*(p + 1)) - (a1*a2*d - b1*b2*c*(n*(p + 1) + 1))/(a1*a2*b1*b2*n*(p + 1))* Int[(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1), x] /; FreeQ[{a1, b1, a2, b2, c, d, n}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && (LtQ[p, -1] || ILtQ[1/n + p, 0])
Int[(c_ + d_.*x_^n_)/(a_ + b_.*x_^n_), x_Symbol] := c*x/a - (b*c - a*d)/a*Int[1/(b + a*x^(-n)), x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && LtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_), x_Symbol] := d*x*(a + b*x^n)^(p + 1)/(b*(n*(p + 1) + 1)) - (a*d - b*c*(n*(p + 1) + 1))/(b*(n*(p + 1) + 1))* Int[(a + b*x^n)^p, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && NeQ[n*(p + 1) + 1, 0]
Int[(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := d*x*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(b1* b2*(n*(p + 1) + 1)) - (a1*a2*d - b1*b2*c*(n*(p + 1) + 1))/(b1*b2*(n*(p + 1) + 1))* Int[(a1 + b1*x^(n/2))^p*(a2 + b2*x^(n/2))^p, x] /; FreeQ[{a1, b1, a2, b2, c, d, n, p}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && NeQ[n*(p + 1) + 1, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := Int[PolynomialDivide[(a + b*x^n)^p, (c + d*x^n)^(-q), x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[q, 0] && GeQ[p, -q]
Int[(a_ + b_.*x_^n_)^p_/(c_ + d_.*x_^n_), x_Symbol] := b/d*Int[(a + b*x^n)^(p - 1), x] - (b*c - a*d)/d* Int[(a + b*x^n)^(p - 1)/(c + d*x^n), x] /; FreeQ[{a, b, c, d, p}, x] && NeQ[b*c - a*d, 0] && EqQ[n*(p - 1) + 1, 0] && IntegerQ[n]
Int[1/((a_ + b_.*x_^n_)*(c_ + d_.*x_^n_)), x_Symbol] := b/(b*c - a*d)*Int[1/(a + b*x^n), x] - d/(b*c - a*d)*Int[1/(c + d*x^n), x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0]
Int[1/((a_ + b_.*x_^2)^(1/3)*(c_ + d_.*x_^2)), x_Symbol] := With[{q = Rt[b/a, 2]}, q*ArcTanh[Sqrt[3]/(q*x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) + q*ArcTanh[ Sqrt[3]*(a^(1/3) - 2^(1/3)*(a + b*x^2)^(1/3))/(a^(1/3)*q* x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) + q*ArcTan[q*x]/(6*2^(2/3)*a^(1/3)*d) - q*ArcTan[(a^(1/3)*q*x)/(a^(1/3) + 2^(1/3)*(a + b*x^2)^(1/3))]/(2*2^(2/3)*a^(1/3)*d)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + 3*a*d, 0] && PosQ[b/a]
Int[1/((a_ + b_.*x_^2)^(1/3)*(c_ + d_.*x_^2)), x_Symbol] := With[{q = Rt[-b/a, 2]}, q*ArcTan[Sqrt[3]/(q*x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) + q*ArcTan[ Sqrt[3]*(a^(1/3) - 2^(1/3)*(a + b*x^2)^(1/3))/(a^(1/3)*q* x)]/(2*2^(2/3)*Sqrt[3]*a^(1/3)*d) - q*ArcTanh[q*x]/(6*2^(2/3)*a^(1/3)*d) + q*ArcTanh[(a^(1/3)*q*x)/(a^(1/3) + 2^(1/3)*(a + b*x^2)^(1/3))]/(2*2^(2/3)*a^(1/3)*d)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + 3*a*d, 0] && NegQ[b/a]
Int[1/((a_ + b_.*x_^2)^(1/3)*(c_ + d_.*x_^2)), x_Symbol] := With[{q = Rt[b/a, 2]}, q*ArcTan[q*x/3]/(12*Rt[a, 3]*d) + q*ArcTan[(Rt[a, 3] - (a + b*x^2)^(1/3))^2/(3*Rt[a, 3]^2*q* x)]/(12*Rt[a, 3]*d) - q*ArcTanh[(Sqrt[3]*(Rt[a, 3] - (a + b*x^2)^(1/3)))/(Rt[a, 3]*q* x)]/(4*Sqrt[3]*Rt[a, 3]*d)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c - 9*a*d, 0] && PosQ[b/a]
Int[1/((a_ + b_.*x_^2)^(1/3)*(c_ + d_.*x_^2)), x_Symbol] := With[{q = Rt[-b/a, 2]}, -q*ArcTanh[q*x/3]/(12*Rt[a, 3]*d) + q*ArcTanh[(Rt[a, 3] - (a + b*x^2)^(1/3))^2/(3*Rt[a, 3]^2*q* x)]/(12*Rt[a, 3]*d) - q*ArcTan[(Sqrt[3]*(Rt[a, 3] - (a + b*x^2)^(1/3)))/(Rt[a, 3]*q* x)]/(4*Sqrt[3]*Rt[a, 3]*d)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c - 9*a*d, 0] && NegQ[b/a]
Int[(a_ + b_.*x_^2)^(2/3)/(c_ + d_.*x_^2), x_Symbol] := b/d*Int[1/(a + b*x^2)^(1/3), x] - (b*c - a*d)/d* Int[1/((a + b*x^2)^(1/3)*(c + d*x^2)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + 3*a*d, 0]
Int[1/((a_ + b_.*x_^2)^(1/4)*(c_ + d_.*x_^2)), x_Symbol] := With[{q = Rt[b^2/a, 4]}, -b/(2*a*d*q)* ArcTan[(b + q^2*Sqrt[a + b*x^2])/(q^3*x*(a + b*x^2)^(1/4))] - b/(2*a*d*q)* ArcTanh[(b - q^2*Sqrt[a + b*x^2])/(q^3*x*(a + b*x^2)^(1/4))]] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && PosQ[b^2/a]
Int[1/((a_ + b_.*x_^2)^(1/4)*(c_ + d_.*x_^2)), x_Symbol] := With[{q = Rt[-b^2/a, 4]}, b/(2*Sqrt[2]*a*d*q)*ArcTan[q*x/(Sqrt[2]*(a + b*x^2)^(1/4))] + b/(2*Sqrt[2]*a*d*q)*ArcTanh[q*x/(Sqrt[2]*(a + b*x^2)^(1/4))]] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && NegQ[b^2/a]
(* Int[1/((a_+b_.*x_^2)^(1/4)*(c_+d_.*x_^2)),x_Symbol] := With[{q=Rt[-b^2/a,4]}, b/(2*Sqrt[2]*a*d*q)*ArcTan[q*x/(Sqrt[2]*(a+b*x^2)^(1/4))] + b/(4*Sqrt[2]*a*d*q)*Log[(Sqrt[2]*q*x+2*(a+b*x^2)^(1/4))/(Sqrt[2]*q* x-2*(a+b*x^2)^(1/4))]] /; FreeQ[{a,b,c,d},x] && EqQ[b*c-2*a*d,0] && NegQ[b^2/a] *)
Int[1/((a_ + b_.*x_^2)^(1/4)*(c_ + d_.*x_^2)), x_Symbol] := 2*Sqrt[-b*x^2/a]/x* Subst[Int[x^2/(Sqrt[1 - x^4/a]*(b*c - a*d + d*x^4)), x], x, (a + b*x^2)^(1/4)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[1/((a_ + b_.*x_^2)^(3/4)*(c_ + d_.*x_^2)), x_Symbol] := 1/c*Int[1/(a + b*x^2)^(3/4), x] - d/c*Int[x^2/((a + b*x^2)^(3/4)*(c + d*x^2)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0]
Int[1/((a_ + b_.*x_^2)^(3/4)*(c_ + d_.*x_^2)), x_Symbol] := Sqrt[-b*x^2/a]/(2*x)* Subst[Int[1/(Sqrt[-b*x/a]*(a + b*x)^(3/4)*(c + d*x)), x], x, x^2] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*x_^2)^p_./(c_ + d_.*x_^2), x_Symbol] := b/d*Int[(a + b*x^2)^(p - 1), x] - (b*c - a*d)/d* Int[(a + b*x^2)^(p - 1)/(c + d*x^2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && GtQ[p, 0] && (EqQ[p, 1/2] || EqQ[Denominator[p], 4])
Int[(a_ + b_.*x_^2)^p_/(c_ + d_.*x_^2), x_Symbol] := b/(b*c - a*d)*Int[(a + b*x^2)^p, x] - d/(b*c - a*d)*Int[(a + b*x^2)^(p + 1)/(c + d*x^2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && EqQ[Denominator[p], 4] && (EqQ[p, -5/4] || EqQ[p, -7/4])
Int[Sqrt[a_ + b_.*x_^4]/(c_ + d_.*x_^4), x_Symbol] := a/c*Subst[Int[1/(1 - 4*a*b*x^4), x], x, x/Sqrt[a + b*x^4]] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && PosQ[a*b]
Int[Sqrt[a_ + b_.*x_^4]/(c_ + d_.*x_^4), x_Symbol] := With[{q = Rt[-a*b, 4]}, a/(2*c*q)*ArcTan[q*x*(a + q^2*x^2)/(a*Sqrt[a + b*x^4])] + a/(2*c*q)*ArcTanh[q*x*(a - q^2*x^2)/(a*Sqrt[a + b*x^4])]] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c + a*d, 0] && NegQ[a*b]
Int[Sqrt[a_ + b_.*x_^4]/(c_ + d_.*x_^4), x_Symbol] := b/d*Int[1/Sqrt[a + b*x^4], x] - (b*c - a*d)/d* Int[1/(Sqrt[a + b*x^4]*(c + d*x^4)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*x_^4)^(1/4)/(c_ + d_.*x_^4), x_Symbol] := Sqrt[a + b*x^4]*Sqrt[a/(a + b*x^4)]* Subst[Int[1/(Sqrt[1 - b*x^4]*(c - (b*c - a*d)*x^4)), x], x, x/(a + b*x^4)^(1/4)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*x_^4)^(5/4)/(c_ + d_.*x_^4), x_Symbol] := b/d*Int[(a + b*x^4)^(1/4), x] - (b*c - a*d)/d* Int[(a + b*x^4)^(1/4)/(c + d*x^4), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[1/(Sqrt[a_ + b_.*x_^4]*(c_ + d_.*x_^4)), x_Symbol] := 1/(2*c)*Int[1/(Sqrt[a + b*x^4]*(1 - Rt[-d/c, 2]*x^2)), x] + 1/(2*c)*Int[1/(Sqrt[a + b*x^4]*(1 + Rt[-d/c, 2]*x^2)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[1/((a_ + b_.*x_^4)^(3/4)*(c_ + d_.*x_^4)), x_Symbol] := b/(b*c - a*d)*Int[1/(a + b*x^4)^(3/4), x] - d/(b*c - a*d)*Int[(a + b*x^4)^(1/4)/(c + d*x^4), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*x_^3)^(1/3)/(c_ + d_.*x_^3), x_Symbol] := With[{q = Rt[b/a, 3]}, 9*a/(c*q)* Subst[Int[x/((4 - a*x^3)*(1 + 2*a*x^3)), x], x, (1 + q*x)/(a + b*x^3)^(1/3)]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + a*d, 0]
Int[1/((a_ + b_.*x_^3)^(2/3)*(c_ + d_.*x_^3)), x_Symbol] := b/(b*c - a*d)*Int[1/(a + b*x^3)^(2/3), x] - d/(b*c - a*d)*Int[(a + b*x^3)^(1/3)/(c + d*x^3), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + a*d, 0]
Int[Sqrt[a_ + b_.*x_^2]/(c_ + d_.*x_^2)^(3/2), x_Symbol] := Sqrt[a + b*x^2]/(c*Rt[d/c, 2]*Sqrt[c + d*x^2]* Sqrt[c*(a + b*x^2)/(a*(c + d*x^2))])* EllipticE[ArcTan[Rt[d/c, 2]*x], 1 - b*c/(a*d)] /; FreeQ[{a, b, c, d}, x] && PosQ[b/a] && PosQ[d/c]
(* Int[Sqrt[a_+b_.*x_^2]/(c_+d_.*x_^2)^(3/2),x_Symbol] := a*Sqrt[c+d*x^2]*Sqrt[(c*(a+b*x^2))/(a*(c+d*x^2))]/(c^2*Rt[d/c,2]* Sqrt[a+b*x^2])*EllipticE[ArcTan[Rt[d/c,2]*x],1-b*c/(a*d)] /; FreeQ[{a,b,c,d},x] && PosQ[b/a] && PosQ[d/c] *)
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -x*(a + b*x^n)^(p + 1)*(c + d*x^n)^q/(a*n*(p + 1)) + 1/(a*n*(p + 1))* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(n*(p + 1) + 1) + d*(n*(p + q + 1) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && LtQ[0, q, 1] && IntBinomialQ[a, b, c, d, n, p, q, x]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := (a*d - c*b)* x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(a*b*n*(p + 1)) - 1/(a*b*n*(p + 1))* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 2)* Simp[c*(a*d - c*b*(n*(p + 1) + 1)) + d*(a*d*(n*(q - 1) + 1) - b*c*(n*(p + q) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && GtQ[q, 1] && IntBinomialQ[a, b, c, d, n, p, q, x]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -b*x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a* n*(p + 1)*(b*c - a*d)) + 1/(a*n*(p + 1)*(b*c - a*d))* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[b*c + n*(p + 1)*(b*c - a*d) + d*b*(n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, n, q}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && Not[Not[IntegerQ[p]] && IntegerQ[q] && LtQ[q, -1]] && IntBinomialQ[a, b, c, d, n, p, q, x]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^n)^p*(c + d*x^n)^q, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && IntegersQ[p, q] && GtQ[p + q, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := d*x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(b*(n*(p + q) + 1)) + 1/(b*(n*(p + q) + 1))* Int[(a + b*x^n)^p*(c + d*x^n)^(q - 2)* Simp[c*(b*c*(n*(p + q) + 1) - a*d) + d*(b*c*(n*(p + 2*q - 1) + 1) - a*d*(n*(q - 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, n, p}, x] && NeQ[b*c - a*d, 0] && GtQ[q, 1] && NeQ[n*(p + q) + 1, 0] && Not[IGtQ[p, 1]] && IntBinomialQ[a, b, c, d, n, p, q, x]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := x*(a + b*x^n)^p*(c + d*x^n)^q/(n*(p + q) + 1) + n/(n*(p + q) + 1)* Int[(a + b*x^n)^(p - 1)*(c + d*x^n)^(q - 1)* Simp[a*c*(p + q) + (q*(b*c - a*d) + a*d*(p + q))*x^n, x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[b*c - a*d, 0] && GtQ[q, 0] && GtQ[p, 0] && IntBinomialQ[a, b, c, d, n, p, q, x]
Int[1/(Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]), x_Symbol] := Sqrt[a + b*x^2]/(a*Rt[d/c, 2]*Sqrt[c + d*x^2]* Sqrt[c*(a + b*x^2)/(a*(c + d*x^2))])* EllipticF[ArcTan[Rt[d/c, 2]*x], 1 - b*c/(a*d)] /; FreeQ[{a, b, c, d}, x] && PosQ[d/c] && PosQ[b/a] && Not[SimplerSqrtQ[b/a, d/c]]
(* Int[1/(Sqrt[a_+b_.*x_^2]*Sqrt[c_+d_.*x_^2]),x_Symbol] := Sqrt[c+d*x^2]*Sqrt[c*(a+b*x^2)/(a*(c+d*x^2))]/(c*Rt[d/c,2]*Sqrt[a+b* x^2])*EllipticF[ArcTan[Rt[d/c,2]*x],1-b*c/(a*d)] /; FreeQ[{a,b,c,d},x] && PosQ[d/c] && PosQ[b/a] &&  Not[SimplerSqrtQ[b/a,d/c]] *)
Int[1/(Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]), x_Symbol] := 1/(Sqrt[a]*Sqrt[c]*Rt[-d/c, 2])* EllipticF[ArcSin[Rt[-d/c, 2]*x], b*c/(a*d)] /; FreeQ[{a, b, c, d}, x] && NegQ[d/c] && GtQ[c, 0] && GtQ[a, 0] && Not[NegQ[b/a] && SimplerSqrtQ[-b/a, -d/c]]
Int[1/(Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]), x_Symbol] := -1/(Sqrt[c]*Rt[-d/c, 2]*Sqrt[a - b*c/d])* EllipticF[ArcCos[Rt[-d/c, 2]*x], b*c/(b*c - a*d)] /; FreeQ[{a, b, c, d}, x] && NegQ[d/c] && GtQ[c, 0] && GtQ[a - b*c/d, 0]
Int[1/(Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]), x_Symbol] := Sqrt[1 + d/c*x^2]/Sqrt[c + d*x^2]* Int[1/(Sqrt[a + b*x^2]*Sqrt[1 + d/c*x^2]), x] /; FreeQ[{a, b, c, d}, x] && Not[GtQ[c, 0]]
Int[Sqrt[a_ + b_.*x_^2]/Sqrt[c_ + d_.*x_^2], x_Symbol] := a*Int[1/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]), x] + b*Int[x^2/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d}, x] && PosQ[d/c] && PosQ[b/a]
Int[Sqrt[a_ + b_.*x_^2]/Sqrt[c_ + d_.*x_^2], x_Symbol] := b/d*Int[Sqrt[c + d*x^2]/Sqrt[a + b*x^2], x] - (b*c - a*d)/d* Int[1/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d}, x] && PosQ[d/c] && NegQ[b/a]
Int[Sqrt[a_ + b_.*x_^2]/Sqrt[c_ + d_.*x_^2], x_Symbol] := Sqrt[a]/(Sqrt[c]*Rt[-d/c, 2])* EllipticE[ArcSin[Rt[-d/c, 2]*x], b*c/(a*d)] /; FreeQ[{a, b, c, d}, x] && NegQ[d/c] && GtQ[c, 0] && GtQ[a, 0]
Int[Sqrt[a_ + b_.*x_^2]/Sqrt[c_ + d_.*x_^2], x_Symbol] := -Sqrt[a - b*c/d]/(Sqrt[c]*Rt[-d/c, 2])* EllipticE[ArcCos[Rt[-d/c, 2]*x], b*c/(b*c - a*d)] /; FreeQ[{a, b, c, d}, x] && NegQ[d/c] && GtQ[c, 0] && GtQ[a - b*c/d, 0]
Int[Sqrt[a_ + b_.*x_^2]/Sqrt[c_ + d_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[1 + b/a*x^2]* Int[Sqrt[1 + b/a*x^2]/Sqrt[c + d*x^2], x] /; FreeQ[{a, b, c, d}, x] && NegQ[d/c] && GtQ[c, 0] && Not[GtQ[a, 0]]
Int[Sqrt[a_ + b_.*x_^2]/Sqrt[c_ + d_.*x_^2], x_Symbol] := Sqrt[1 + d/c*x^2]/Sqrt[c + d*x^2]* Int[Sqrt[a + b*x^2]/Sqrt[1 + d/c*x^2], x] /; FreeQ[{a, b, c, d}, x] && NegQ[d/c] && Not[GtQ[c, 0]]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^n)^p*(c + d*x^n)^q, x], x] /; FreeQ[{a, b, c, d, n, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := a^p*c^q*x*AppellF1[1/n, -p, -q, 1 + 1/n, -b*x^n/a, -d*x^n/c] /; FreeQ[{a, b, c, d, n, p, q}, x] && NeQ[b*c - a*d, 0] && NeQ[n, -1] && (IntegerQ[p] || GtQ[a, 0]) && (IntegerQ[q] || GtQ[c, 0])
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := a^IntPart[p]*(a + b*x^n)^FracPart[p]/(1 + b*x^n/a)^FracPart[p]* Int[(1 + b*x^n/a)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, n, p, q}, x] && NeQ[b*c - a*d, 0] && NeQ[n, -1] && Not[IntegerQ[p] || GtQ[a, 0]]
Int[(a_. + b_.*u_^n_)^p_.*(c_. + d_.*u_^n_)^q_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x^n)^p*(c + d*x^n)^q, x], x, u] /; FreeQ[{a, b, c, d, n, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[u_^p_.*v_^q_., x_Symbol] := Int[NormalizePseudoBinomial[u, x]^p* NormalizePseudoBinomial[v, x]^q, x] /; FreeQ[{p, q}, x] && PseudoBinomialPairQ[u, v, x]
Int[x_^m_.*u_^p_.*v_^q_., x_Symbol] := Int[NormalizePseudoBinomial[x^(m/p)*u, x]^p* NormalizePseudoBinomial[v, x]^q, x] /; FreeQ[{p, q}, x] && IntegersQ[p, m/p] && PseudoBinomialPairQ[x^(m/p)*u, v, x]
(* IntBinomialQ[a,b,c,d,n,p,q,x] returns True iff  (a+b*x^n)^p*(c+d*x^n)^q is integrable wrt x in terms of non-Appell  functions. *) IntBinomialQ[a_, b_, c_, d_, n_, p_, q_, x_Symbol] := IntegersQ[p, q] || IGtQ[p, 0] || IGtQ[q, 0] || (EqQ[n, 2] || EqQ[n, 4]) && (IntegersQ[p, 4*q] || IntegersQ[4*p, q]) || EqQ[n, 2] && (IntegersQ[2*p, 2*q] || IntegersQ[3*p, q] && EqQ[b*c + 3*a*d, 0] || IntegersQ[p, 3*q] && EqQ[3*b*c + a*d, 0]) || EqQ[n, 3] && (IntegersQ[p + 1/3, q] || IntegersQ[q + 1/3, p]) || EqQ[n, 3] && (IntegersQ[p + 2/3, q] || IntegersQ[q + 2/3, p]) && EqQ[b*c + a*d, 0]
Int[(a_ + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_., x_Symbol] := Int[(a + b*x^n)^p*(d + c*x^n)^q/x^(n*q), x] /; FreeQ[{a, b, c, d, n, p}, x] && EqQ[mn, -n] && IntegerQ[q] && (PosQ[n] || Not[IntegerQ[p]])
Int[(a_ + b_.*x_^n_.)^p_*(c_ + d_.*x_^mn_.)^q_, x_Symbol] := x^(n*FracPart[q])*(c + d*x^(-n))^FracPart[q]/(d + c*x^n)^ FracPart[q]*Int[(a + b*x^n)^p*(d + c*x^n)^q/x^(n*q), x] /; FreeQ[{a, b, c, d, n, p, q}, x] && EqQ[mn, -n] && Not[IntegerQ[q]] && Not[IntegerQ[p]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.4 (e x)^m (a+b x^n)^p (c+d x^n)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.4 (e x)^m (a+b x^n)^p (c+d x^n)^q *)
Int[(e_.*x_)^m_.*(b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_., x_Symbol] := e^m/(n*b^(Simplify[(m + 1)/n] - 1))* Subst[Int[(b*x)^(p + Simplify[(m + 1)/n] - 1)*(c + d*x)^q, x], x, x^n] /; FreeQ[{b, c, d, e, m, n, p, q}, x] && (IntegerQ[m] || GtQ[e, 0]) && IntegerQ[Simplify[(m + 1)/n]]
Int[(e_.*x_)^m_.*(b_.*x_^n_.)^p_*(c_ + d_.*x_^n_)^q_., x_Symbol] := e^m*b^IntPart[p]*(b*x^n)^FracPart[p]/x^(n*FracPart[p])* Int[x^(m + n*p)*(c + d*x^n)^q, x] /; FreeQ[{b, c, d, e, m, n, p, q}, x] && (IntegerQ[m] || GtQ[e, 0]) && Not[IntegerQ[Simplify[(m + 1)/n]]]
Int[(e_*x_)^m_*(b_.*x_^n_.)^p_*(c_ + d_.*x_^n_)^q_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{b, c, d, e, m, n, p, q}, x] && Not[IntegerQ[m]]
Int[x_/((a_ + b_.*x_^2)^(1/4)*(c_ + d_.*x_^2)), x_Symbol] := -1/(Sqrt[2]*Rt[a, 4]*d)* ArcTan[(Rt[a, 4]^2 - Sqrt[a + b*x^2])/(Sqrt[2]* Rt[a, 4]*(a + b*x^2)^(1/4))] - 1/(Sqrt[2]*Rt[a, 4]*d)* ArcTanh[(Rt[a, 4]^2 + Sqrt[a + b*x^2])/(Sqrt[2]* Rt[a, 4]*(a + b*x^2)^(1/4))] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && PosQ[a]
Int[x_^m_/((a_ + b_.*x_^2)^(1/4)*(c_ + d_.*x_^2)), x_Symbol] := Int[ExpandIntegrand[x^m/((a + b*x^2)^(1/4)*(c + d*x^2)), x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && IntegerQ[m] && (PosQ[a] || IntegerQ[m/2])
Int[x_^2/((a_ + b_.*x_^2)^(3/4)*(c_ + d_.*x_^2)), x_Symbol] := -b/(a*d*Rt[b^2/a, 4]^3)* ArcTan[(b + Rt[b^2/a, 4]^2*Sqrt[a + b*x^2])/(Rt[b^2/a, 4]^3* x*(a + b*x^2)^(1/4))] + b/(a*d*Rt[b^2/a, 4]^3)* ArcTanh[(b - Rt[b^2/a, 4]^2*Sqrt[a + b*x^2])/(Rt[b^2/a, 4]^3* x*(a + b*x^2)^(1/4))] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && PosQ[b^2/a]
Int[x_^2/((a_ + b_.*x_^2)^(3/4)*(c_ + d_.*x_^2)), x_Symbol] := -b/(Sqrt[2]*a*d*Rt[-b^2/a, 4]^3)* ArcTan[(Rt[-b^2/a, 4]*x)/(Sqrt[2]*(a + b*x^2)^(1/4))] + b/(Sqrt[2]*a*d*Rt[-b^2/a, 4]^3)* ArcTanh[(Rt[-b^2/a, 4]*x)/(Sqrt[2]*(a + b*x^2)^(1/4))] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && NegQ[b^2/a]
Int[x_^m_/((a_ + b_.*x_^2)^(3/4)*(c_ + d_.*x_^2)), x_Symbol] := Int[ExpandIntegrand[x^m/((a + b*x^2)^(3/4)*(c + d*x^2)), x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - 2*a*d, 0] && IntegerQ[m] && (PosQ[a] || IntegerQ[m/2])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := 1/n*Subst[Int[(a + b*x)^p*(c + d*x)^q, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && EqQ[m - n + 1, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := Int[x^(m + n*(p + q))*(b + a*x^(-n))^p*(d + c*x^(-n))^q, x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[b*c - a*d, 0] && IntegersQ[p, q] && NegQ[n]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*x)^p*(c + d*x)^q, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && IntegerQ[Simplify[(m + 1)/n]]
Int[(e_*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && IntegerQ[Simplify[(m + 1)/n]]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := Int[ExpandIntegrand[(e*x)^m*(a + b*x^n)^p*(c + d*x^n)^q, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[p, 0] && IGtQ[q, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := c*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*e*(m + 1)) /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[a*d*(m + 1) - b*c*(m + n*(p + 1) + 1), 0] && NeQ[m, -1]
Int[(e_.*x_)^m_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := c*(e*x)^(m + 1)*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(a1*a2*e*(m + 1)) /; FreeQ[{a1, b1, a2, b2, c, d, e, m, n, p}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && EqQ[a1*a2*d*(m + 1) - b1*b2*c*(m + n*(p + 1) + 1), 0] && NeQ[m, -1]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := c*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*e*(m + 1)) + d/e^n*Int[(e*x)^(m + n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n*(p + 1) + 1, 0] && (IntegerQ[n] || GtQ[e, 0]) && (GtQ[n, 0] && LtQ[m, -1] || LtQ[n, 0] && GtQ[m + n, -1])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := (b*c - a*d)*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*b*e*(m + 1)) + d/b*Int[(e*x)^m*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n*(p + 1) + 1, 0] && NeQ[m, -1]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := c*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*e*(m + 1)) + (a*d*(m + 1) - b*c*(m + n*(p + 1) + 1))/(a*e^n*(m + 1))* Int[(e*x)^(m + n)*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b*c - a*d, 0] && (IntegerQ[n] || GtQ[e, 0]) && (GtQ[n, 0] && LtQ[m, -1] || LtQ[n, 0] && GtQ[m + n, -1]) && Not[ILtQ[p, -1]]
Int[(e_.*x_)^m_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := c*(e*x)^(m + 1)*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(a1*a2*e*(m + 1)) + (a1*a2*d*(m + 1) - b1*b2*c*(m + n*(p + 1) + 1))/(a1*a2* e^n*(m + 1))* Int[(e*x)^(m + n)*(a1 + b1*x^(n/2))^p*(a2 + b2*x^(n/2))^p, x] /; FreeQ[{a1, b1, a2, b2, c, d, e, p}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[n] || GtQ[e, 0]) && (GtQ[n, 0] && LtQ[m, -1] || LtQ[n, 0] && GtQ[m + n, -1]) && Not[ILtQ[p, -1]]
Int[x_^m_*(a_ + b_.*x_^2)^p_*(c_ + d_.*x_^2), x_Symbol] := (-a)^(m/2 - 1)*(b*c - a*d)* x*(a + b*x^2)^(p + 1)/(2*b^(m/2 + 1)*(p + 1)) + 1/(2*b^(m/2 + 1)*(p + 1))*Int[(a + b*x^2)^(p + 1)* ExpandToSum[ 2*b*(p + 1)*x^2* Together[(b^(m/2)* x^(m - 2)*(c + d*x^2) - (-a)^(m/2 - 1)*(b*c - a*d))/(a + b*x^2)] - (-a)^(m/2 - 1)*(b*c - a*d), x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && IGtQ[m/2, 0] && (IntegerQ[p] || EqQ[m + 2*p + 1, 0])
Int[x_^m_*(a_ + b_.*x_^2)^p_*(c_ + d_.*x_^2), x_Symbol] := (-a)^(m/2 - 1)*(b*c - a*d)* x*(a + b*x^2)^(p + 1)/(2*b^(m/2 + 1)*(p + 1)) + 1/(2*b^(m/2 + 1)*(p + 1))*Int[x^m*(a + b*x^2)^(p + 1)* ExpandToSum[ 2*b*(p + 1)* Together[(b^(m/2)*(c + d*x^2) - (-a)^(m/2 - 1)*(b*c - a*d)* x^(-m + 2))/(a + b*x^2)] - (-a)^(m/2 - 1)*(b*c - a*d)*x^(-m), x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && ILtQ[m/2, 0] && (IntegerQ[p] || EqQ[m + 2*p + 1, 0])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := -(b*c - a*d)*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*b*e* n*(p + 1)) - (a*d*(m + 1) - b*c*(m + n*(p + 1) + 1))/(a*b*n*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && (Not[IntegerQ[p + 1/2]] && NeQ[p, -5/4] || Not[RationalQ[m]] || IGtQ[n, 0] && ILtQ[p + 1/2, 0] && LeQ[-1, m, -n*(p + 1)])
Int[(e_.*x_)^m_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := -(b1*b2*c - a1*a2*d)*(e*x)^(m + 1)*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(a1*a2*b1*b2*e*n*(p + 1)) - (a1*a2*d*(m + 1) - b1*b2*c*(m + n*(p + 1) + 1))/(a1*a2*b1*b2* n*(p + 1))* Int[(e*x)^m*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1), x] /; FreeQ[{a1, b1, a2, b2, c, d, e, m, n}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && LtQ[p, -1] && (Not[IntegerQ[p + 1/2]] && NeQ[p, -5/4] || Not[RationalQ[m]] || IGtQ[n, 0] && ILtQ[p + 1/2, 0] && LeQ[-1, m, -n*(p + 1)])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_), x_Symbol] := d*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(b*e*(m + n*(p + 1) + 1)) - (a*d*(m + 1) - b*c*(m + n*(p + 1) + 1))/(b*(m + n*(p + 1) + 1))* Int[(e*x)^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[b*c - a*d, 0] && NeQ[m + n*(p + 1) + 1, 0]
Int[(e_.*x_)^m_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_), x_Symbol] := d*(e*x)^(m + 1)*(a1 + b1*x^(n/2))^(p + 1)*(a2 + b2*x^(n/2))^(p + 1)/(b1*b2*e*(m + n*(p + 1) + 1)) - (a1*a2*d*(m + 1) - b1*b2*c*(m + n*(p + 1) + 1))/(b1* b2*(m + n*(p + 1) + 1))* Int[(e*x)^m*(a1 + b1*x^(n/2))^p*(a2 + b2*x^(n/2))^p, x] /; FreeQ[{a1, b1, a2, b2, c, d, e, m, n, p}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && NeQ[m + n*(p + 1) + 1, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_/(c_ + d_.*x_^n_), x_Symbol] := Int[ExpandIntegrand[(e*x)^m*(a + b*x^n)^p/(c + d*x^n), x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && IGtQ[p, 0] && (IntegerQ[m] || IGtQ[2*(m + 1), 0] || Not[RationalQ[m]])
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^2, x_Symbol] := c^2*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*e*(m + 1)) - 1/(a*e^n*(m + 1))* Int[(e*x)^(m + n)*(a + b*x^n)^p* Simp[b*c^2*n*(p + 1) + c*(b*c - 2*a*d)*(m + 1) - a*(m + 1)*d^2*x^n, x], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^2, x_Symbol] := -(b*c - a*d)^2*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*b^2*e* n*(p + 1)) + 1/(a*b^2*n*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)* Simp[(b*c - a*d)^2*(m + 1) + b^2*c^2*n*(p + 1) + a*b*d^2*n*(p + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^2, x_Symbol] := d^2*(e*x)^(m + n + 1)*(a + b*x^n)^(p + 1)/(b* e^(n + 1)*(m + n*(p + 2) + 1)) + 1/(b*(m + n*(p + 2) + 1))* Int[(e*x)^m*(a + b*x^n)^p* Simp[b*c^2*(m + n*(p + 2) + 1) + d*((2*b*c - a*d)*(m + n + 1) + 2*b*c*n*(p + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && NeQ[m + n*(p + 2) + 1, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := With[{k = GCD[m + 1, n]}, 1/k* Subst[Int[x^((m + 1)/k - 1)*(a + b*x^(n/k))^p*(c + d*x^(n/k))^q, x], x, x^k] /; k != 1] /; FreeQ[{a, b, c, d, p, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := With[{k = Denominator[m]}, k/e* Subst[Int[ x^(k*(m + 1) - 1)*(a + b*x^(k*n)/e^n)^p*(c + d*x^(k*n)/e^n)^q, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, p, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && FractionQ[m] && IntegerQ[p]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(b*n*(p + 1)) - e^n/(b*n*(p + 1))* Int[(e*x)^(m - n)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(m - n + 1) + d*(m + n*(q - 1) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[q, 0] && GtQ[m - n + 1, 0] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -(c*b - a*d)*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(a*b*e*n*(p + 1)) + 1/(a*b*n*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 2)* Simp[c*(c*b*n*(p + 1) + (c*b - a*d)*(m + 1)) + d*(c*b*n*(p + 1) + (c*b - a*d)*(m + n*(q - 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[q, 1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(a*e*n*(p + 1)) + 1/(a*n*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(m + n*(p + 1) + 1) + d*(m + n*(p + q + 1) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && LtQ[0, q, 1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -a*e^(2*n - 1)*(e*x)^(m - 2*n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(b*n*(b*c - a*d)*(p + 1)) + e^(2*n)/(b*n*(b*c - a*d)*(p + 1))* Int[(e*x)^(m - 2*n)*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[a*c*(m - 2*n + 1) + (a*d*(m - n + n*q + 1) + b*c*n*(p + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m - n + 1, n] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(n*(b*c - a*d)*(p + 1)) - e^n/(n*(b*c - a*d)*(p + 1))* Int[(e*x)^(m - n)*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*(m - n + 1) + d*(m + n*(p + q + 1) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && GeQ[n, m - n + 1] && GtQ[m - n + 1, 0] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -b*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*e* n*(b*c - a*d)*(p + 1)) + 1/(a*n*(b*c - a*d)*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*b*(m + 1) + n*(b*c - a*d)*(p + 1) + d*b*(m + n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := (e*x)^(m + 1)*(a + b*x^n)^p*(c + d*x^n)^q/(e*(m + 1)) - n/(e^n*(m + 1))* Int[(e*x)^(m + n)*(a + b*x^n)^(p - 1)*(c + d*x^n)^(q - 1)* Simp[b*c*p + a*d*q + b*d*(p + q)*x^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[q, 0] && LtQ[m, -1] && GtQ[p, 0] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := c*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(a* e*(m + 1)) - 1/(a*e^n*(m + 1))* Int[(e*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^(q - 2)* Simp[c*(c*b - a*d)*(m + 1) + c*n*(b*c*(p + 1) + a*d*(q - 1)) + d*((c*b - a*d)*(m + 1) + c*b*n*(p + q))*x^n, x], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[q, 1] && LtQ[m, -1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := (e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^q/(a*e*(m + 1)) - 1/(a*e^n*(m + 1))* Int[(e*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^(q - 1)* Simp[c*b*(m + 1) + n*(b*c*(p + 1) + a*d*q) + d*(b*(m + 1) + b*n*(p + q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[0, q, 1] && LtQ[m, -1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := (e*x)^(m + 1)*(a + b*x^n)^p*(c + d*x^n)^q/(e*(m + n*(p + q) + 1)) + n/(m + n*(p + q) + 1)* Int[(e*x)^m*(a + b*x^n)^(p - 1)*(c + d*x^n)^(q - 1)* Simp[a*c*(p + q) + (q*(b*c - a*d) + a*d*(p + q))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[q, 0] && GtQ[p, 0] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := d*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(b* e*(m + n*(p + q) + 1)) + 1/(b*(m + n*(p + q) + 1))* Int[(e*x)^m*(a + b*x^n)^p*(c + d*x^n)^(q - 2)* Simp[c*((c*b - a*d)*(m + 1) + c*b*n*(p + q)) + (d*(c*b - a*d)*(m + 1) + d*n*(q - 1)*(b*c - a*d) + c*b*d*n*(p + q))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[q, 1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(b*(m + n*(p + q) + 1)) - e^n/(b*(m + n*(p + q) + 1))* Int[(e*x)^(m - n)*(a + b*x^n)^p*(c + d*x^n)^(q - 1)* Simp[a*c*(m - n + 1) + (a*d*(m - n + 1) - n*q*(b*c - a*d))*x^n, x], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[q, 0] && GtQ[m - n + 1, 0] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := e^(2*n - 1)*(e*x)^(m - 2*n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(b*d*(m + n*(p + q) + 1)) - e^(2*n)/(b*d*(m + n*(p + q) + 1))* Int[(e*x)^(m - 2*n)*(a + b*x^n)^p*(c + d*x^n)^q* Simp[a*c*(m - 2*n + 1) + (a*d*(m + n*(q - 1) + 1) + b*c*(m + n*(p - 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, p, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[m - n + 1, n] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := (e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*c* e*(m + 1)) - 1/(a*c*e^n*(m + 1))* Int[(e*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^q* Simp[(b*c + a*d)*(m + n + 1) + n*(b*c*p + a*d*q) + b*d*(m + n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, p, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[m, -1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_./((a_ + b_.*x_^n_)*(c_ + d_.*x_^n_)), x_Symbol] := -a*e^n/(b*c - a*d)*Int[(e*x)^(m - n)/(a + b*x^n), x] + c*e^n/(b*c - a*d)*Int[(e*x)^(m - n)/(c + d*x^n), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LeQ[n, m, 2*n - 1]
Int[(e_.*x_)^m_./((a_ + b_.*x_^n_)*(c_ + d_.*x_^n_)), x_Symbol] := b/(b*c - a*d)*Int[(e*x)^m/(a + b*x^n), x] - d/(b*c - a*d)*Int[(e*x)^m/(c + d*x^n), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0]
Int[(e_.*x_)^m_*(c_ + d_.*x_^n_)^q_./(a_ + b_.*x_^n_), x_Symbol] := e^n/b*Int[(e*x)^(m - n)*(c + d*x^n)^q, x] - a*e^n/b*Int[(e*x)^(m - n)*(c + d*x^n)^q/(a + b*x^n), x] /; FreeQ[{a, b, c, d, e, m, q}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LeQ[n, m, 2*n - 1] && IntBinomialQ[a, b, c, d, e, m, n, -1, q, x]
Int[x_*(a_ + b_.*x_^n_)^p_/(c_ + d_.*x_^n_), x_Symbol] := b/d*Int[x*(a + b*x^n)^(p - 1), x] - (b*c - a*d)/d* Int[x*(a + b*x^n)^(p - 1)/(c + d*x^n), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && GtQ[p, 0] && IntBinomialQ[a, b, c, d, 1, 1, n, p, -1, x]
Int[x_*(a_ + b_.*x_^n_)^p_/(c_ + d_.*x_^n_), x_Symbol] := b/(b*c - a*d)*Int[x*(a + b*x^n)^(p - 1), x] - d/(b*c - a*d)*Int[x*(a + b*x^n)^(p + 1)/(c + d*x^n), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && IGtQ[n, 0] && LtQ[p, -1] && IntBinomialQ[a, b, c, d, 1, 1, n, p, -1, x]
Int[x_/((a_ + b_.*x_^3)*Sqrt[c_ + d_.*x_^3]), x_Symbol] := With[{q = Rt[d/c, 3]}, q*ArcTanh[Sqrt[c + d*x^3]/Rt[c, 2]]/(9*2^(2/3)*b*Rt[c, 2]) + q*ArcTan[ Sqrt[c + d*x^3]/(Sqrt[3]*Rt[c, 2])]/(3*2^(2/3)*Sqrt[3]*b* Rt[c, 2]) - q*ArcTan[ Sqrt[3]*Rt[c, 2]*(1 + 2^(1/3)*q*x)/Sqrt[c + d*x^3]]/(3*2^(2/3)* Sqrt[3]*b*Rt[c, 2]) - q*ArcTanh[ Rt[c, 2]*(1 - 2^(1/3)*q*x)/Sqrt[c + d*x^3]]/(3*2^(2/3)*b* Rt[c, 2])] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[4*b*c - a*d, 0] && PosQ[c]
Int[x_/((a_ + b_.*x_^3)*Sqrt[c_ + d_.*x_^3]), x_Symbol] := With[{q = Rt[d/c, 3]}, -q*ArcTan[Sqrt[c + d*x^3]/Rt[-c, 2]]/(9*2^(2/3)*b*Rt[-c, 2]) - q*ArcTanh[ Sqrt[c + d*x^3]/(Sqrt[3]*Rt[-c, 2])]/(3*2^(2/3)*Sqrt[3]*b* Rt[-c, 2]) - q*ArcTanh[ Sqrt[3]*Rt[-c, 2]*(1 + 2^(1/3)*q*x)/ Sqrt[c + d*x^3]]/(3*2^(2/3)*Sqrt[3]*b*Rt[-c, 2]) - q*ArcTan[ Rt[-c, 2]*(1 - 2^(1/3)*q*x)/Sqrt[c + d*x^3]]/(3*2^(2/3)*b* Rt[-c, 2])] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[4*b*c - a*d, 0] && NegQ[c]
Int[x_/((a_ + b_.*x_^3)*Sqrt[c_ + d_.*x_^3]), x_Symbol] := With[{q = Rt[d/c, 3]}, d*q/(4*b)*Int[x^2/((8*c - d*x^3)*Sqrt[c + d*x^3]), x] - q^2/(12*b)*Int[(1 + q*x)/((2 - q*x)*Sqrt[c + d*x^3]), x] + 1/(12*b*c)* Int[(2*c*q^2 - 2*d*x - d*q*x^2)/((4 + 2*q*x + q^2*x^2)* Sqrt[c + d*x^3]), x]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[8*b*c + a*d, 0]
Int[x_/((c_ + d_.*x_^3)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{q = Rt[b/a, 3], r = Simplify[(b*c - 10*a*d)/(6*a*d)]}, -q*(2 - r)* ArcTan[(1 - r)*Sqrt[a + b*x^3]/(Sqrt[2]*Rt[a, 2]*r^(3/2))]/(3* Sqrt[2]*Rt[a, 2]*d*r^(3/2)) - q*(2 - r)* ArcTan[Rt[a, 2]* Sqrt[r]*(1 + r)*(1 + q*x)/(Sqrt[2]*Sqrt[a + b*x^3])]/(2* Sqrt[2]*Rt[a, 2]*d*r^(3/2)) - q*(2 - r)* ArcTanh[Rt[a, 2]*(1 - r)* Sqrt[r]*(1 + q*x)/(Sqrt[2]*Sqrt[a + b*x^3])]/(6*Sqrt[2]* Rt[a, 2]*d*Sqrt[r]) - q*(2 - r)* ArcTanh[Rt[a, 2]* Sqrt[r]*(1 + r - 2*q*x)/(Sqrt[2]*Sqrt[a + b*x^3])]/(3*Sqrt[2]* Rt[a, 2]*d*Sqrt[r])] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b^2*c^2 - 20*a*b*c*d - 8*a^2*d^2, 0] && PosQ[a]
Int[x_/((c_ + d_.*x_^3)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{q = Rt[b/a, 3], r = Simplify[(b*c - 10*a*d)/(6*a*d)]}, q*(2 - r)* ArcTanh[(1 - r)*Sqrt[a + b*x^3]/(Sqrt[2]*Rt[-a, 2]*r^(3/2))]/(3* Sqrt[2]*Rt[-a, 2]*d*r^(3/2)) - q*(2 - r)* ArcTanh[Rt[-a, 2]* Sqrt[r]*(1 + r)*(1 + q*x)/(Sqrt[2]*Sqrt[a + b*x^3])]/(2* Sqrt[2]*Rt[-a, 2]*d*r^(3/2)) - q*(2 - r)* ArcTan[Rt[-a, 2]*(1 - r)* Sqrt[r]*(1 + q*x)/(Sqrt[2]*Sqrt[a + b*x^3])]/(6*Sqrt[2]* Rt[-a, 2]*d*Sqrt[r]) - q*(2 - r)* ArcTan[Rt[-a, 2]* Sqrt[r]*(1 + r - 2*q*x)/(Sqrt[2]*Sqrt[a + b*x^3])]/(3*Sqrt[2]* Rt[-a, 2]*d*Sqrt[r])] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b^2*c^2 - 20*a*b*c*d - 8*a^2*d^2, 0] && NegQ[a]
Int[x_/((a_ + b_.*x_^3)^(1/3)*(c_ + d_.*x_^3)), x_Symbol] := With[{q = Rt[b/a, 3]}, -q^2/(3*d)*Int[1/((1 - q*x)*(a + b*x^3)^(1/3)), x] + q/d* Subst[Int[1/(1 + 2*a*x^3), x], x, (1 + q*x)/(a + b*x^3)^(1/3)]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + a*d, 0]
Int[x_/((a_ + b_.*x_^3)^(2/3)*(c_ + d_.*x_^3)), x_Symbol] := With[{q = Rt[(b*c - a*d)/c, 3]}, -ArcTan[(1 + (2*q*x)/(a + b*x^3)^(1/3))/Sqrt[3]]/(Sqrt[3]*c* q^2) + Log[c + d*x^3]/(6*c*q^2) - Log[q*x - (a + b*x^3)^(1/3)]/(2*c*q^2)] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[x_^2/((a_ + b_.*x_^4)*Sqrt[c_ + d_.*x_^4]), x_Symbol] := With[{r = Numerator[Rt[-a/b, 2]], s = Denominator[Rt[-a/b, 2]]}, s/(2*b)*Int[1/((r + s*x^2)*Sqrt[c + d*x^4]), x] - s/(2*b)*Int[1/((r - s*x^2)*Sqrt[c + d*x^4]), x]] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[x_^2*Sqrt[c_ + d_.*x_^4]/(a_ + b_.*x_^4), x_Symbol] := d/b*Int[x^2/Sqrt[c + d*x^4], x] + (b*c - a*d)/b* Int[x^2/((a + b*x^4)*Sqrt[c + d*x^4]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[x_^2/(Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]), x_Symbol] := x*Sqrt[a + b*x^2]/(b*Sqrt[c + d*x^2]) - c/b*Int[Sqrt[a + b*x^2]/(c + d*x^2)^(3/2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && PosQ[b/a] && PosQ[d/c] && Not[SimplerSqrtQ[b/a, d/c]]
Int[x_^n_/(Sqrt[a_ + b_.*x_^n_]*Sqrt[c_ + d_.*x_^n_]), x_Symbol] := 1/b*Int[Sqrt[a + b*x^n]/Sqrt[c + d*x^n], x] - a/b*Int[1/(Sqrt[a + b*x^n]*Sqrt[c + d*x^n]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && (EqQ[n, 2] || EqQ[n, 4]) && Not[EqQ[n, 2] && SimplerSqrtQ[-b/a, -d/c]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_., x_Symbol] := With[{k = Denominator[p]}, k*a^(p + (m + 1)/n)/n* Subst[ Int[x^(k*(m + 1)/n - 1)*(c - (b*c - a*d)*x^k)^ q/(1 - b*x^k)^(p + q + (m + 1)/n + 1), x], x, x^(n/k)/(a + b*x^n)^(1/k)]] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && RationalQ[m, p] && IntegersQ[p + (m + 1)/n, q] && LtQ[-1, p, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -Subst[Int[(a + b*x^(-n))^p*(c + d*x^(-n))^q/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, p, q}, x] && NeQ[b*c - a*d, 0] && ILtQ[n, 0] && IntegerQ[m]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := With[{g = Denominator[m]}, -g/e* Subst[Int[(a + b*e^(-n)*x^(-g*n))^p*(c + d*e^(-n)*x^(-g*n))^q/ x^(g*(m + 1) + 1), x], x, 1/(e*x)^(1/g)]] /; FreeQ[{a, b, c, d, e, p, q}, x] && ILtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -(e*x)^m*(x^(-1))^m* Subst[Int[(a + b*x^(-n))^p*(c + d*x^(-n))^q/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m, p, q}, x] && NeQ[b*c - a*d, 0] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g*(m + 1) - 1)*(a + b*x^(g*n))^p*(c + d*x^(g*n))^q, x], x, x^(1/g)]] /; FreeQ[{a, b, c, d, m, p, q}, x] && NeQ[b*c - a*d, 0] && FractionQ[n]
Int[(e_*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, m, p, q}, x] && NeQ[b*c - a*d, 0] && FractionQ[n]
(* Int[x_^m_.*(a_+b_.*x_^n_)^p_*(c_+d_.*x_^n_)^q_,x_Symbol] := -1/(m+1)*Subst[Int[(a+b*x^Simplify[-n/(m+1)])^p*(c+d*x^Simplify[-n/( m+1)])^q/x^2,x],x,x^(-(m+1))] /; FreeQ[{a,b,c,d,m,n},x] && NeQ[b*c-a*d,0] && NeQ[m,-1] &&  ILtQ[Simplify[n/(m+1)+1],0] && GeQ[p,-1] && LtQ[p,0] && GeQ[q,-1] && LtQ[q,0] && Not[IntegerQ[n]] *)
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*x^Simplify[n/(m + 1)])^ p*(c + d*x^Simplify[n/(m + 1)])^q, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(e_*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -(c*b - a*d)*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(a*b*e*n*(p + 1)) + 1/(a*b*n*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 2)* Simp[c*(c*b*n*(p + 1) + (c*b - a*d)*(m + 1)) + d*(c*b*n*(p + 1) + (c*b - a*d)*(m + n*(q - 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && GtQ[q, 1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(a*e*n*(p + 1)) + 1/(a*n*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(m + n*(p + 1) + 1) + d*(m + n*(p + q + 1) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && LtQ[0, q, 1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := -b*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*e* n*(b*c - a*d)*(p + 1)) + 1/(a*n*(b*c - a*d)*(p + 1))* Int[(e*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*b*(m + 1) + n*(b*c - a*d)*(p + 1) + d*b*(m + n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n, q}, x] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := (e*x)^(m + 1)*(a + b*x^n)^p*(c + d*x^n)^q/(e*(m + n*(p + q) + 1)) + n/(m + n*(p + q) + 1)* Int[(e*x)^m*(a + b*x^n)^(p - 1)*(c + d*x^n)^(q - 1)* Simp[a*c*(p + q) + (q*(b*c - a*d) + a*d*(p + q))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b*c - a*d, 0] && GtQ[q, 0] && GtQ[p, 0] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := d*(e*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)/(b* e*(m + n*(p + q) + 1)) + 1/(b*(m + n*(p + q) + 1))* Int[(e*x)^m*(a + b*x^n)^p*(c + d*x^n)^(q - 2)* Simp[c*((c*b - a*d)*(m + 1) + c*b*n*(p + q)) + (d*(c*b - a*d)*(m + 1) + d*n*(q - 1)*(b*c - a*d) + c*b*d*n*(p + q))*x^n, x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[b*c - a*d, 0] && GtQ[q, 1] && IntBinomialQ[a, b, c, d, e, m, n, p, q, x]
Int[x_^m_/((a_ + b_.*x_^n_)*(c_ + d_.*x_^n_)), x_Symbol] := -a/(b*c - a*d)*Int[x^(m - n)/(a + b*x^n), x] + c/(b*c - a*d)*Int[x^(m - n)/(c + d*x^n), x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[b*c - a*d, 0] && (EqQ[m, n] || EqQ[m, 2*n - 1])
Int[(e_.*x_)^m_./((a_ + b_.*x_^n_)*(c_ + d_.*x_^n_)), x_Symbol] := b/(b*c - a*d)*Int[(e*x)^m/(a + b*x^n), x] - d/(b*c - a*d)*Int[(e*x)^m/(c + d*x^n), x] /; FreeQ[{a, b, c, d, e, n, m}, x] && NeQ[b*c - a*d, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := Int[ExpandIntegrand[(e*x)^m*(a + b*x^n)^p*(c + d*x^n)^q, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b*c - a*d, 0] && IGtQ[p, -2] && (IGtQ[q, -2] || EqQ[q, -3] && IntegerQ[(m - 1)/2])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := a^p*c^q*(e*x)^(m + 1)/(e*(m + 1))* AppellF1[(m + 1)/n, -p, -q, 1 + (m + 1)/n, -b*x^n/a, -d*x^n/c] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && NeQ[m, -1] && NeQ[m, n - 1] && (IntegerQ[p] || GtQ[a, 0]) && (IntegerQ[q] || GtQ[c, 0])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_, x_Symbol] := a^IntPart[p]*(a + b*x^n)^FracPart[p]/(1 + b*x^n/a)^FracPart[p]* Int[(e*x)^m*(1 + b*x^n/a)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && NeQ[m, -1] && NeQ[m, n - 1] && Not[IntegerQ[p] || GtQ[a, 0]]
Int[x_^m_.*(a_. + b_.*v_^n_)^p_.*(c_. + d_.*v_^n_)^q_., x_Symbol] := 1/Coefficient[v, x, 1]^(m + 1)* Subst[Int[ SimplifyIntegrand[(x - Coefficient[v, x, 0])^m*(a + b*x^n)^ p*(c + d*x^n)^q, x], x], x, v] /; FreeQ[{a, b, c, d, n, p, q}, x] && LinearQ[v, x] && IntegerQ[m] && NeQ[v, x]
Int[u_^m_.*(a_. + b_.*v_^n_)^p_.*(c_. + d_.*v_^n_)^q_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q, x], x, v] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && LinearPairQ[u, v, x]
Int[x_^m_.*(a_ + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_., x_Symbol] := Int[x^(m - n*q)*(a + b*x^n)^p*(d + c*x^n)^q, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[mn, -n] && IntegerQ[q] && (PosQ[n] || Not[IntegerQ[p]])
Int[x_^m_.*(a_ + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_, x_Symbol] := x^(n*FracPart[q])*(c + d*x^(-n))^FracPart[q]/(d + c*x^n)^ FracPart[q]*Int[x^(m - n*q)*(a + b*x^n)^p*(d + c*x^n)^q, x] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && EqQ[mn, -n] && Not[IntegerQ[q]] && Not[IntegerQ[p]]
Int[(e_*x_)^m_*(a_. + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^(-n))^q, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[mn, -n]
(* IntBinomialQ[a,b,c,d,e,m,n,p,q,x] returns True iff  (e*x)^m*(a+b*x^n)^p*(c+d*x^n)^q is integrable wrt x in terms of  non-Appell functions. *) IntBinomialQ[a_, b_, c_, d_, e_, m_, n_, p_, q_, x_Symbol] := IntegersQ[p, q] || IGtQ[p, 0] || IGtQ[q, 0] || EqQ[n, 2] && (IntegersQ[m, 2*p, 2*q] || IntegersQ[2*m, p, 2*q] || IntegersQ[2*m, 2*p, q]) || EqQ[n, 4] && (IntegersQ[m, p, 2*q] || IntegersQ[m, 2*p, q]) || EqQ[n, 2] && IntegersQ[m/2, p + 1/3, q] && (EqQ[b*c + 3*a*d, 0] || EqQ[b*c - 9*a*d, 0]) || EqQ[n, 2] && IntegersQ[m/2, q + 1/3, p] && (EqQ[a*d + 3*b*c, 0] || EqQ[a*d - 9*b*c, 0]) || EqQ[n, 3] && IntegersQ[(m - 1)/3, q, p - 1/2] && (EqQ[b*c - 4*a*d, 0] || EqQ[b*c + 8*a*d, 0] || EqQ[b^2*c^2 - 20*a*b*c*d - 8*a^2*d^2, 0]) || EqQ[n, 3] && IntegersQ[(m - 1)/3, p, q - 1/2] && (EqQ[4*b*c - a*d, 0] || EqQ[8*b*c + a*d, 0] || EqQ[8*b^2*c^2 + 20*a*b*c*d - a^2*d^2, 0]) || EqQ[n, 3] && (IntegersQ[m, q, 3*p] || IntegersQ[m, p, 3*q]) && EqQ[b*c + a*d, 0] || EqQ[n, 3] && (IntegersQ[(m + 2)/3, p + 2/3, q] || IntegersQ[(m + 2)/3, q + 2/3, p]) || EqQ[n, 3] && (IntegersQ[m/3, p + 1/3, q] || IntegersQ[m/3, q + 1/3, p])
Int[u_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_.)^q_., x_Symbol] := Int[u*(a1*a2 + b1*b2*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a1, b1, a2, b2, c, d, n, p, q}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[p] || GtQ[a1, 0] && GtQ[a2, 0])
Int[u_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_. + e_.*x_^n2_.)^q_., x_Symbol] := Int[u*(a1*a2 + b1*b2*x^n)^p*(c + d*x^n + e*x^(2*n))^q, x] /; FreeQ[{a1, b1, a2, b2, c, d, e, n, p, q}, x] && EqQ[non2, n/2] && EqQ[n2, 2*n] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[p] || GtQ[a1, 0] && GtQ[a2, 0])
Int[u_.*(a1_ + b1_.*x_^non2_.)^p_*(a2_ + b2_.*x_^non2_.)^ p_*(c_ + d_.*x_^n_.)^q_., x_Symbol] := (a1 + b1*x^(n/2))^ FracPart[p]*(a2 + b2*x^(n/2))^FracPart[p]/(a1*a2 + b1*b2*x^n)^ FracPart[p]* Int[u*(a1*a2 + b1*b2*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a1, b1, a2, b2, c, d, n, p, q}, x] && EqQ[non2, n/2] && EqQ[a2*b1 + a1*b2, 0] && Not[EqQ[n, 2] && IGtQ[q, 0]]
Int[u_.*(a1_ + b1_.*x_^non2_.)^p_.*(a2_ + b2_.*x_^non2_.)^ p_.*(c_ + d_.*x_^n_. + e_.*x_^n2_.)^q_., x_Symbol] := (a1 + b1*x^(n/2))^ FracPart[p]*(a2 + b2*x^(n/2))^FracPart[p]/(a1*a2 + b1*b2*x^n)^ FracPart[p]* Int[u*(a1*a2 + b1*b2*x^n)^p*(c + d*x^n + e*x^(2*n))^q, x] /; FreeQ[{a1, b1, a2, b2, c, d, e, n, p, q}, x] && EqQ[non2, n/2] && EqQ[n2, 2*n] && EqQ[a2*b1 + a1*b2, 0]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.5 (a+b x^n)^p (c+d x^n)^q (e+f x^n)^r.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.5 (a+b x^n)^p (c+d x^n)^q (e+f x^n)^r *)
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := Int[ExpandIntegrand[(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IGtQ[r, 0]
Int[(e_ + f_.*x_^n_)/((a_ + b_.*x_^n_)*(c_ + d_.*x_^n_)), x_Symbol] := (b*e - a*f)/(b*c - a*d)*Int[1/(a + b*x^n), x] - (d*e - c*f)/(b*c - a*d)*Int[1/(c + d*x^n), x] /; FreeQ[{a, b, c, d, e, f, n}, x]
Int[(e_ + f_.*x_^n_)/((a_ + b_.*x_^n_)*Sqrt[c_ + d_.*x_^n_]), x_Symbol] := f/b*Int[1/Sqrt[c + d*x^n], x] + (b*e - a*f)/b*Int[1/((a + b*x^n)*Sqrt[c + d*x^n]), x] /; FreeQ[{a, b, c, d, e, f, n}, x]
Int[(e_ + f_.*x_^n_)/(Sqrt[a_ + b_.*x_^n_]*Sqrt[c_ + d_.*x_^n_]), x_Symbol] := f/b*Int[Sqrt[a + b*x^n]/Sqrt[c + d*x^n], x] + (b*e - a*f)/b*Int[1/(Sqrt[a + b*x^n]*Sqrt[c + d*x^n]), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && Not[ EqQ[n, 2] && (PosQ[b/a] && PosQ[d/c] || NegQ[b/a] && (PosQ[d/c] || GtQ[a, 0] && (Not[GtQ[c, 0]] || SimplerSqrtQ[-b/a, -d/c])))]
Int[(e_ + f_.*x_^2)/(Sqrt[a_ + b_.*x_^2]*(c_ + d_.*x_^2)^(3/2)), x_Symbol] := (b*e - a*f)/(b*c - a*d)* Int[1/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]), x] - (d*e - c*f)/(b*c - a*d)* Int[Sqrt[a + b*x^2]/(c + d*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e, f}, x] && PosQ[b/a] && PosQ[d/c]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_), x_Symbol] := -(b*e - a*f)* x*(a + b*x^n)^(p + 1)*(c + d*x^n)^q/(a*b*n*(p + 1)) + 1/(a*b*n*(p + 1))* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(b*e*n*(p + 1) + b*e - a*f) + d*(b*e*n*(p + 1) + (b*e - a*f)*(n*q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && LtQ[p, -1] && GtQ[q, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_), x_Symbol] := -(b*e - a*f)* x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a* n*(b*c - a*d)*(p + 1)) + 1/(a*n*(b*c - a*d)*(p + 1))* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*(b*e - a*f) + e*n*(b*c - a*d)*(p + 1) + d*(b*e - a*f)*(n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, n, q}, x] && LtQ[p, -1]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_), x_Symbol] := f*x*(a + b*x^n)^(p + 1)*(c + d*x^n)^q/(b*(n*(p + q + 1) + 1)) + 1/(b*(n*(p + q + 1) + 1))* Int[(a + b*x^n)^p*(c + d*x^n)^(q - 1)* Simp[c*(b*e - a*f + b*e*n*(p + q + 1)) + (d*(b*e - a*f) + f*n*q*(b*c - a*d) + b*d*e*n*(p + q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && GtQ[q, 0] && NeQ[n*(p + q + 1) + 1, 0]
Int[(e_ + f_.*x_^4)/((a_ + b_.*x_^4)^(3/4)*(c_ + d_.*x_^4)), x_Symbol] := (b*e - a*f)/(b*c - a*d)* Int[1/(a + b*x^4)^(3/4), x] - (d*e - c*f)/(b*c - a*d)* Int[(a + b*x^4)^(1/4)/(c + d*x^4), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[(a_ + b_.*x_^n_)^p_*(e_ + f_.*x_^n_)/(c_ + d_.*x_^n_), x_Symbol] := f/d*Int[(a + b*x^n)^p, x] + (d*e - c*f)/d* Int[(a + b*x^n)^p/(c + d*x^n), x] /; FreeQ[{a, b, c, d, e, f, p, n}, x]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_), x_Symbol] := e*Int[(a + b*x^n)^p*(c + d*x^n)^q, x] + f*Int[x^n*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, f, n, p, q}, x]
Int[1/((a_ + b_.*x_^2)*(c_ + d_.*x_^2)*Sqrt[e_ + f_.*x_^2]), x_Symbol] := b/(b*c - a*d)*Int[1/((a + b*x^2)*Sqrt[e + f*x^2]), x] - d/(b*c - a*d)*Int[1/((c + d*x^2)*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[1/(x_^2*(c_ + d_.*x_^2)*Sqrt[e_ + f_.*x_^2]), x_Symbol] := 1/c*Int[1/(x^2*Sqrt[e + f*x^2]), x] - d/c*Int[1/((c + d*x^2)*Sqrt[e + f*x^2]), x] /; FreeQ[{c, d, e, f}, x] && NeQ[d*e - c*f, 0]
Int[Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]/(a_ + b_.*x_^2), x_Symbol] := d/b*Int[Sqrt[e + f*x^2]/Sqrt[c + d*x^2], x] + (b*c - a*d)/b* Int[Sqrt[e + f*x^2]/((a + b*x^2)*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[d/c, 0] && GtQ[f/e, 0] && Not[SimplerSqrtQ[d/c, f/e]]
Int[Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]/(a_ + b_.*x_^2), x_Symbol] := d/b*Int[Sqrt[e + f*x^2]/Sqrt[c + d*x^2], x] + (b*c - a*d)/b* Int[Sqrt[e + f*x^2]/((a + b*x^2)*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[SimplerSqrtQ[-f/e, -d/c]]
Int[1/((a_ + b_.*x_^2)*Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := -f/(b*e - a*f)*Int[1/(Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] + b/(b*e - a*f)* Int[Sqrt[e + f*x^2]/((a + b*x^2)*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[d/c, 0] && GtQ[f/e, 0] && Not[SimplerSqrtQ[d/c, f/e]]
Int[1/((a_ + b_.*x_^2)*Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := 1/(a*Sqrt[c]*Sqrt[e]*Rt[-d/c, 2])* EllipticPi[b*c/(a*d), ArcSin[Rt[-d/c, 2]*x], c*f/(d*e)] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[d/c, 0]] && GtQ[c, 0] && GtQ[e, 0] && Not[Not[GtQ[f/e, 0]] && SimplerSqrtQ[-f/e, -d/c]]
Int[1/((a_ + b_.*x_^2)*Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := Sqrt[1 + d/c*x^2]/Sqrt[c + d*x^2]* Int[1/((a + b*x^2)*Sqrt[1 + d/c*x^2]*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && Not[GtQ[c, 0]]
Int[Sqrt[c_ + d_.*x_^2]/((a_ + b_.*x_^2)*Sqrt[e_ + f_.*x_^2]), x_Symbol] := c*Sqrt[ e + f*x^2]/(a*e*Rt[d/c, 2]*Sqrt[c + d*x^2]* Sqrt[c*(e + f*x^2)/(e*(c + d*x^2))])* EllipticPi[1 - b*c/(a*d), ArcTan[Rt[d/c, 2]*x], 1 - c*f/(d*e)] /; FreeQ[{a, b, c, d, e, f}, x] && PosQ[d/c]
(* Int[Sqrt[c_+d_.*x_^2]/((a_+b_.*x_^2)*Sqrt[e_+f_.*x_^2]),x_Symbol] := Sqrt[c+d*x^2]*Sqrt[c*(e+f*x^2)/(e*(c+d*x^2))]/(a*Rt[d/c,2]*Sqrt[e+f* x^2])* EllipticPi[1-b*c/(a*d),ArcTan[Rt[d/c,2]*x],1-c*f/(d*e)] /; FreeQ[{a,b,c,d,e,f},x] && PosQ[d/c] *)
Int[Sqrt[c_ + d_.*x_^2]/((a_ + b_.*x_^2)*Sqrt[e_ + f_.*x_^2]), x_Symbol] := d/b*Int[1/(Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] + (b*c - a*d)/b* Int[1/((a + b*x^2)*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NegQ[d/c]
Int[Sqrt[e_ + f_.*x_^2]/((a_ + b_.*x_^2)*(c_ + d_.*x_^2)^(3/2)), x_Symbol] := b/(b*c - a*d)* Int[Sqrt[e + f*x^2]/((a + b*x^2)*Sqrt[c + d*x^2]), x] - d/(b*c - a*d)*Int[Sqrt[e + f*x^2]/(c + d*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e, f}, x] && PosQ[d/c] && PosQ[f/e]
Int[(e_ + f_.*x_^2)^(3/2)/((a_ + b_.*x_^2)*(c_ + d_.*x_^2)^(3/2)), x_Symbol] := (b*e - a*f)/(b*c - a*d)* Int[Sqrt[e + f*x^2]/((a + b*x^2)*Sqrt[c + d*x^2]), x] - (d*e - c*f)/(b*c - a*d)* Int[Sqrt[e + f*x^2]/(c + d*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e, f}, x] && PosQ[d/c] && PosQ[f/e]
Int[(c_ + d_.*x_^2)^(3/2)*Sqrt[e_ + f_.*x_^2]/(a_ + b_.*x_^2), x_Symbol] := (b*c - a*d)^2/b^2* Int[Sqrt[e + f*x^2]/((a + b*x^2)*Sqrt[c + d*x^2]), x] + d/b^2* Int[(2*b*c - a*d + b*d*x^2)*Sqrt[e + f*x^2]/Sqrt[c + d*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && PosQ[d/c] && PosQ[f/e]
Int[(c_ + d_.*x_^2)^q_*(e_ + f_.*x_^2)^r_/(a_ + b_.*x_^2), x_Symbol] := b*(b*e - a*f)/(b*c - a*d)^2* Int[(c + d*x^2)^(q + 2)*(e + f*x^2)^(r - 1)/(a + b*x^2), x] - 1/(b*c - a*d)^2* Int[(c + d*x^2)^ q*(e + f*x^2)^(r - 1)*(2*b*c*d*e - a*d^2*e - b*c^2*f + d^2*(b*e - a*f)*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && LtQ[q, -1] && GtQ[r, 1]
Int[(c_ + d_.*x_^2)^q_*(e_ + f_.*x_^2)^r_/(a_ + b_.*x_^2), x_Symbol] := d/b*Int[(c + d*x^2)^(q - 1)*(e + f*x^2)^r, x] + (b*c - a*d)/b* Int[(c + d*x^2)^(q - 1)*(e + f*x^2)^r/(a + b*x^2), x] /; FreeQ[{a, b, c, d, e, f, r}, x] && GtQ[q, 1]
Int[(c_ + d_.*x_^2)^q_*(e_ + f_.*x_^2)^r_/(a_ + b_.*x_^2), x_Symbol] := b^2/(b*c - a*d)^2* Int[(c + d*x^2)^(q + 2)*(e + f*x^2)^r/(a + b*x^2), x] - d/(b*c - a*d)^2* Int[(c + d*x^2)^q*(e + f*x^2)^r*(2*b*c - a*d + b*d*x^2), x] /; FreeQ[{a, b, c, d, e, f, r}, x] && LtQ[q, -1]
Int[(c_ + d_.*x_^2)^q_*(e_ + f_.*x_^2)^r_/(a_ + b_.*x_^2), x_Symbol] := -d/(b*c - a*d)*Int[(c + d*x^2)^q*(e + f*x^2)^r, x] + b/(b*c - a*d)* Int[(c + d*x^2)^(q + 1)*(e + f*x^2)^r/(a + b*x^2), x] /; FreeQ[{a, b, c, d, e, f, r}, x] && LeQ[q, -1]
Int[Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]/(a_ + b_.*x_^2)^2, x_Symbol] := x*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]/(2*a*(a + b*x^2)) + d*f/(2*a*b^2)* Int[(a - b*x^2)/(Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] + (b^2*c*e - a^2*d*f)/(2*a*b^2)* Int[1/((a + b*x^2)*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[1/((a_ + b_.*x_^2)^2*Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := b^2*x*Sqrt[c + d*x^2]* Sqrt[e + f*x^2]/(2*a*(b*c - a*d)*(b*e - a*f)*(a + b*x^2)) - d*f/(2*a*(b*c - a*d)*(b*e - a*f))* Int[(a + b*x^2)/(Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] + (b^2*c*e + 3*a^2*d*f - 2*a*b*(d*e + c*f))/(2* a*(b*c - a*d)*(b*e - a*f))* Int[1/((a + b*x^2)*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_*(e_ + f_.*x_^n_)^r_, x_Symbol] := d/b*Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)*(e + f*x^n)^r, x] + (b*c - a*d)/b* Int[(a + b*x^n)^p*(c + d*x^n)^(q - 1)*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, n, r}, x] && ILtQ[p, 0] && GtQ[q, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_*(e_ + f_.*x_^n_)^r_, x_Symbol] := b/(b*c - a*d)* Int[(a + b*x^n)^p*(c + d*x^n)^(q + 1)*(e + f*x^n)^r, x] - d/(b*c - a*d)* Int[(a + b*x^n)^(p + 1)*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, n, q}, x] && ILtQ[p, 0] && LeQ[q, -1]
Int[1/(Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := Sqrt[c + d*x^2]* Sqrt[a*(e + f*x^2)/(e*(a + b*x^2))]/(c*Sqrt[e + f*x^2]* Sqrt[a*(c + d*x^2)/(c*(a + b*x^2))])* Subst[ Int[1/(Sqrt[1 - (b*c - a*d)*x^2/c]*Sqrt[1 - (b*e - a*f)*x^2/e]), x], x, x/Sqrt[a + b*x^2]] /; FreeQ[{a, b, c, d, e, f}, x]
Int[Sqrt[a_ + b_.*x_^2]/(Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := a*Sqrt[c + d*x^2]* Sqrt[a*(e + f*x^2)/(e*(a + b*x^2))]/(c*Sqrt[e + f*x^2]* Sqrt[a*(c + d*x^2)/(c*(a + b*x^2))])* Subst[ Int[1/((1 - b*x^2)*Sqrt[1 - (b*c - a*d)*x^2/c]* Sqrt[1 - (b*e - a*f)*x^2/e]), x], x, x/Sqrt[a + b*x^2]] /; FreeQ[{a, b, c, d, e, f}, x]
Int[Sqrt[c_ + d_.*x_^2]/((a_ + b_.*x_^2)^(3/2)*Sqrt[e_ + f_.*x_^2]), x_Symbol] := Sqrt[c + d*x^2]* Sqrt[a*(e + f*x^2)/(e*(a + b*x^2))]/(a*Sqrt[e + f*x^2]* Sqrt[a*(c + d*x^2)/(c*(a + b*x^2))])* Subst[ Int[Sqrt[1 - (b*c - a*d)*x^2/c]/Sqrt[1 - (b*e - a*f)*x^2/e], x], x, x/Sqrt[a + b*x^2]] /; FreeQ[{a, b, c, d, e, f}, x]
Int[Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]/Sqrt[e_ + f_.*x_^2], x_Symbol] := d*x*Sqrt[a + b*x^2]*Sqrt[e + f*x^2]/(2*f*Sqrt[c + d*x^2]) - c*(d*e - c*f)/(2*f)* Int[Sqrt[a + b*x^2]/((c + d*x^2)^(3/2)*Sqrt[e + f*x^2]), x] + b*c*(d*e - c*f)/(2*d*f)* Int[1/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] - (b*d*e - b*c*f - a*d*f)/(2*d*f)* Int[Sqrt[c + d*x^2]/(Sqrt[a + b*x^2]*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && PosQ[(d*e - c*f)/c]
Int[Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]/Sqrt[e_ + f_.*x_^2], x_Symbol] := x*Sqrt[a + b*x^2]*Sqrt[c + d*x^2]/(2*Sqrt[e + f*x^2]) + e*(b*e - a*f)/(2*f)* Int[Sqrt[c + d*x^2]/(Sqrt[a + b*x^2]*(e + f*x^2)^(3/2)), x] + (b*e - a*f)*(d*e - 2*c*f)/(2*f^2)* Int[1/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] - (b*d*e - b*c*f - a*d*f)/(2*f^2)* Int[Sqrt[e + f*x^2]/(Sqrt[a + b*x^2]*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NegQ[(d*e - c*f)/c]
Int[Sqrt[a_ + b_.*x_^2]*Sqrt[c_ + d_.*x_^2]/(e_ + f_.*x_^2)^(3/2), x_Symbol] := b/f*Int[Sqrt[c + d*x^2]/(Sqrt[a + b*x^2]*Sqrt[e + f*x^2]), x] - (b*e - a*f)/f* Int[Sqrt[c + d*x^2]/(Sqrt[a + b*x^2]*(e + f*x^2)^(3/2)), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_*(e_ + f_.*x_^n_)^r_, x_Symbol] := With[{u = ExpandIntegrand[(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, p, q, r}, x] && IGtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_*(e_ + f_.*x_^n_)^r_, x_Symbol] := -Subst[ Int[(a + b*x^(-n))^p*(c + d*x^(-n))^q*(e + f*x^(-n))^r/x^2, x], x, 1/x] /; FreeQ[{a, b, c, d, e, f, p, q, r}, x] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := Unintegrable[(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, n, p, q, r}, x]
Int[(a_. + b_.*u_^n_)^p_.*(c_. + d_.*v_^n_)^q_.*(e_. + f_.*w_^n_)^r_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x], x, u] /; FreeQ[{a, b, c, d, e, f, p, n, q, r}, x] && EqQ[u, v] && EqQ[u, w] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_.*(e_ + f_.*x_^n_.)^ r_., x_Symbol] := Int[(a + b*x^n)^p*(d + c*x^n)^q*(e + f*x^n)^r/x^(n*q), x] /; FreeQ[{a, b, c, d, e, f, n, p, r}, x] && EqQ[mn, -n] && IntegerQ[q]
Int[(a_. + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_.*(e_ + f_.*x_^n_.)^ r_., x_Symbol] := Int[x^(n*(p + r))*(b + a*x^(-n))^p*(c + d*x^(-n))^q*(f + e*x^(-n))^ r, x] /; FreeQ[{a, b, c, d, e, f, n, q}, x] && EqQ[mn, -n] && IntegerQ[p] && IntegerQ[r]
Int[(a_. + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^q_*(e_ + f_.*x_^n_.)^ r_., x_Symbol] := x^(n*FracPart[q])*(c + d*x^(-n))^FracPart[q]/(d + c*x^n)^ FracPart[q]* Int[(a + b*x^n)^p*(d + c*x^n)^q*(e + f*x^n)^r/x^(n*q), x] /; FreeQ[{a, b, c, d, e, f, n, p, q, r}, x] && EqQ[mn, -n] && Not[IntegerQ[q]]
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e1_ + f1_.*x_^n2_.)^ r_.*(e2_ + f2_.*x_^n2_.)^r_., x_Symbol] := Int[(a + b*x^n)^p*(c + d*x^n)^q*(e1*e2 + f1*f2*x^n)^r, x] /; FreeQ[{a, b, c, d, e1, f1, e2, f2, n, p, q, r}, x] && EqQ[n2, n/2] && EqQ[e2*f1 + e1*f2, 0] && (IntegerQ[r] || GtQ[e1, 0] && GtQ[e2, 0])
Int[(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e1_ + f1_.*x_^n2_.)^ r_.*(e2_ + f2_.*x_^n2_.)^r_., x_Symbol] := (e1 + f1*x^(n/2))^ FracPart[r]*(e2 + f2*x^(n/2))^FracPart[r]/(e1*e2 + f1*f2*x^n)^ FracPart[r]* Int[(a + b*x^n)^p*(c + d*x^n)^q*(e1*e2 + f1*f2*x^n)^r, x] /; FreeQ[{a, b, c, d, e1, f1, e2, f2, n, p, q, r}, x] && EqQ[n2, n/2] && EqQ[e2*f1 + e1*f2, 0]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.6 (g x)^m (a+b x^n)^p (c+d x^n)^q (e+f x^n)^r.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.6 (g x)^m (a+b x^n)^p (c+d x^n)^q (e+f x^n)^r *)
Int[(g_.*x_)^m_.*(b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := g^m/(n*b^(Simplify[(m + 1)/n] - 1))* Subst[Int[(b*x)^(p + Simplify[(m + 1)/n] - 1)*(c + d*x)^ q*(e + f*x)^r, x], x, x^n] /; FreeQ[{b, c, d, e, f, g, m, n, p, q, r}, x] && (IntegerQ[m] || GtQ[g, 0]) && IntegerQ[Simplify[(m + 1)/n]]
Int[(g_.*x_)^m_.*(b_.*x_^n_.)^p_*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := g^m*b^IntPart[p]*(b*x^n)^FracPart[p]/x^(n*FracPart[p])* Int[x^(m + n*p)*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{b, c, d, e, f, g, m, n, p, q, r}, x] && (IntegerQ[m] || GtQ[g, 0]) && Not[IntegerQ[Simplify[(m + 1)/n]]]
Int[(g_*x_)^m_*(b_.*x_^n_.)^p_*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := g^IntPart[m]*(g*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{b, c, d, e, f, g, m, n, p, q, r}, x] && Not[IntegerQ[m]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := Int[ExpandIntegrand[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^ q*(e + f*x^n)^r, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && IGtQ[p, -2] && IGtQ[q, 0] && IGtQ[r, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := 1/n*Subst[Int[(a + b*x)^p*(c + d*x)^q*(e + f*x)^r, x], x, x^n] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && EqQ[m - n + 1, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := Int[x^(m + n*(p + q + r))*(b + a*x^(-n))^p*(d + c*x^(-n))^ q*(f + e*x^(-n))^r, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IntegersQ[p, q, r] && NegQ[n]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*x)^p*(c + d*x)^q*(e + f*x)^ r, x], x, x^n] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(g_*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := g^IntPart[m]*(g*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := With[{k = GCD[m + 1, n]}, 1/k* Subst[Int[ x^((m + 1)/k - 1)*(a + b*x^(n/k))^p*(c + d*x^(n/k))^ q*(e + f*x^(n/k))^r, x], x, x^k] /; k != 1] /; FreeQ[{a, b, c, d, e, f, p, q, r}, x] && IGtQ[n, 0] && IntegerQ[m]
Int[(g_.*x_)^m_*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_*(e_ + f_.*x_^n_)^r_, x_Symbol] := With[{k = Denominator[m]}, k/g* Subst[Int[ x^(k*(m + 1) - 1)*(a + b*x^(k*n)/g^n)^p*(c + d*x^(k*n)/g^n)^ q*(e + f*x^(k*n)/g^n)^r, x], x, (g*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, p, q, r}, x] && IGtQ[n, 0] && FractionQ[m]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := -(b*e - a*f)*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(a*b*g*n*(p + 1)) + 1/(a*b*n*(p + 1))* Int[(g*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(b*e*n*(p + 1) + (b*e - a*f)*(m + 1)) + d*(b*e*n*(p + 1) + (b*e - a*f)*(m + n*q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[EqQ[q, 1] && SimplerQ[b*c - a*d, b*e - a*f]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_*(e_ + f_.*x_^n_), x_Symbol] := g^(n - 1)*(b*e - a*f)*(g*x)^(m - n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(b*n*(b*c - a*d)*(p + 1)) - g^n/(b*n*(b*c - a*d)*(p + 1))* Int[(g*x)^(m - n)*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*(b*e - a*f)*(m - n + 1) + (d*(b*e - a*f)*(m + n*q + 1) - b*n*(c*f - d*e)*(p + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, q}, x] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m - n + 1, 0]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_*(e_ + f_.*x_^n_), x_Symbol] := -(b*e - a*f)*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*g*n*(b*c - a*d)*(p + 1)) + 1/(a*n*(b*c - a*d)*(p + 1))* Int[(g*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*(b*e - a*f)*(m + 1) + e*n*(b*c - a*d)*(p + 1) + d*(b*e - a*f)*(m + n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, q}, x] && IGtQ[n, 0] && LtQ[p, -1]
Int[(g_.*x_)^m_*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := e*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^q/(a*g*(m + 1)) - 1/(a*g^n*(m + 1))* Int[(g*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^(q - 1)* Simp[c*(b*e - a*f)*(m + 1) + e*n*(b*c*(p + 1) + a*d*q) + d*((b*e - a*f)*(m + 1) + b*e*n*(p + q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && IGtQ[n, 0] && GtQ[q, 0] && LtQ[m, -1] && Not[EqQ[q, 1] && SimplerQ[e + f*x^n, c + d*x^n]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := f*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(b*g*(m + n*(p + q + 1) + 1)) + 1/(b*(m + n*(p + q + 1) + 1))* Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^(q - 1)* Simp[c*((b*e - a*f)*(m + 1) + b*e*n*(p + q + 1)) + (d*(b*e - a*f)*(m + 1) + f*n*q*(b*c - a*d) + b*e*d*n*(p + q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && IGtQ[n, 0] && GtQ[q, 0] && Not[EqQ[q, 1] && SimplerQ[e + f*x^n, c + d*x^n]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := f*g^(n - 1)*(g*x)^(m - n + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(b*d*(m + n*(p + q + 1) + 1)) - g^n/(b*d*(m + n*(p + q + 1) + 1))* Int[(g*x)^(m - n)*(a + b*x^n)^p*(c + d*x^n)^q* Simp[a*f* c*(m - n + 1) + (a*f*d*(m + n*q + 1) + b*(f*c*(m + n*p + 1) - e*d*(m + n*(p + q + 1) + 1)))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, p, q}, x] && IGtQ[n, 0] && GtQ[m, n - 1]
Int[(g_.*x_)^m_*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := e*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*c* g*(m + 1)) + 1/(a*c*g^n*(m + 1))*Int[(g*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^q* Simp[a*f*c*(m + 1) - e*(b*c + a*d)*(m + n + 1) - e*n*(b*c*p + a*d*q) - b*e*d*(m + n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, p, q}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^ p_*(e_ + f_.*x_^n_)/(c_ + d_.*x_^n_), x_Symbol] := Int[ExpandIntegrand[(g*x)^m*(a + b*x^n)^p*(e + f*x^n)/(c + d*x^n), x], x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && IGtQ[n, 0]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := e*Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^q, x] + f/e^n*Int[(g*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, f, g, m, p, q}, x] && IGtQ[n, 0]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := e*Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^(r - 1), x] + f/e^n* Int[(g*x)^(m + n)*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^(r - 1), x] /; FreeQ[{a, b, c, d, e, f, g, m, p, q}, x] && IGtQ[n, 0] && IGtQ[r, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := -Subst[ Int[(a + b*x^(-n))^p*(c + d*x^(-n))^q*(e + f*x^(-n))^r/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, f, p, q, r}, x] && ILtQ[n, 0] && IntegerQ[m]
Int[(g_.*x_)^m_*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := With[{k = Denominator[m]}, -k/g* Subst[Int[(a + b*g^(-n)*x^(-k*n))^p*(c + d*g^(-n)*x^(-k*n))^ q*(e + f*g^(-n)*x^(-k*n))^r/x^(k*(m + 1) + 1), x], x, 1/(g*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, p, q, r}, x] && ILtQ[n, 0] && FractionQ[m]
Int[(g_.*x_)^m_*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := -(g*x)^m*(x^(-1))^m* Subst[Int[(a + b*x^(-n))^p*(c + d*x^(-n))^q*(e + f*x^(-n))^r/ x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, f, g, m, p, q, r}, x] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := With[{k = Denominator[n]}, k*Subst[ Int[x^(k*(m + 1) - 1)*(a + b*x^(k*n))^p*(c + d*x^(k*n))^ q*(e + f*x^(k*n))^r, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e, f, m, p, q, r}, x] && FractionQ[n]
Int[(g_*x_)^m_*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := g^IntPart[m]*(g*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, g, m, p, q, r}, x] && FractionQ[n]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_.*(e_ + f_.*x_^n_)^ r_., x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*x^Simplify[n/(m + 1)])^ p*(c + d*x^Simplify[n/(m + 1)])^ q*(e + f*x^Simplify[n/(m + 1)])^r, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && IntegerQ[Simplify[n/(m + 1)]]
Int[(g_*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := g^IntPart[m]*(g*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r}, x] && IntegerQ[Simplify[n/(m + 1)]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := -(b*e - a*f)*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(a*b*g*n*(p + 1)) + 1/(a*b*n*(p + 1))* Int[(g*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q - 1)* Simp[c*(b*e*n*(p + 1) + (b*e - a*f)*(m + 1)) + d*(b*e*n*(p + 1) + (b*e - a*f)*(m + n*q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && LtQ[p, -1] && GtQ[q, 0] && Not[EqQ[q, 1] && SimplerQ[b*c - a*d, b*e - a*f]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_*(e_ + f_.*x_^n_), x_Symbol] := -(b*e - a*f)*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(q + 1)/(a*g*n*(b*c - a*d)*(p + 1)) + 1/(a*n*(b*c - a*d)*(p + 1))* Int[(g*x)^m*(a + b*x^n)^(p + 1)*(c + d*x^n)^q* Simp[c*(b*e - a*f)*(m + 1) + e*n*(b*c - a*d)*(p + 1) + d*(b*e - a*f)*(m + n*(p + q + 2) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n, q}, x] && LtQ[p, -1]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_), x_Symbol] := f*(g*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^ q/(b*g*(m + n*(p + q + 1) + 1)) + 1/(b*(m + n*(p + q + 1) + 1))* Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^(q - 1)* Simp[c*((b*e - a*f)*(m + 1) + b*e*n*(p + q + 1)) + (d*(b*e - a*f)*(m + 1) + f*n*q*(b*c - a*d) + b*e*d*n*(p + q + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && GtQ[q, 0] && Not[EqQ[q, 1] && SimplerQ[e + f*x^n, c + d*x^n]]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^ p_*(e_ + f_.*x_^n_)/(c_ + d_.*x_^n_), x_Symbol] := Int[ExpandIntegrand[(g*x)^m*(a + b*x^n)^p*(e + f*x^n)/(c + d*x^n), x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*(c_ + d_.*x_^n_)^ q_*(e_ + f_.*x_^n_), x_Symbol] := e*Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^q, x] + f*(g*x)^m/x^m*Int[x^(m + n)*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q}, x]
Int[x_^m_.*(a_ + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^ q_.*(e_ + f_.*x_^n_.)^r_., x_Symbol] := Int[x^(m - n*q)*(a + b*x^n)^p*(d + c*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, r}, x] && EqQ[mn, -n] && IntegerQ[q]
Int[x_^m_.*(a_. + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^ q_.*(e_ + f_.*x_^n_.)^r_., x_Symbol] := Int[x^(m + n*(p + r))*(b + a*x^(-n))^p*(c + d*x^(-n))^ q*(f + e*x^(-n))^r, x] /; FreeQ[{a, b, c, d, e, f, m, n, q}, x] && EqQ[mn, -n] && IntegerQ[p] && IntegerQ[r]
Int[x_^m_.*(a_. + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^ q_*(e_ + f_.*x_^n_.)^r_., x_Symbol] := x^(n*FracPart[q])*(c + d*x^(-n))^FracPart[q]/(d + c*x^n)^ FracPart[q]* Int[x^(m - n*q)*(a + b*x^n)^p*(d + c*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && EqQ[mn, -n] && Not[IntegerQ[q]]
Int[(g_*x_)^m_*(a_ + b_.*x_^n_.)^p_.*(c_ + d_.*x_^mn_.)^ q_.*(e_ + f_.*x_^n_.)^r_., x_Symbol] := g^IntPart[m]*(g*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n)^p*(c + d*x^(-n))^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r}, x] && EqQ[mn, -n]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e_ + f_.*x_^n_)^r_., x_Symbol] := Unintegrable[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r}, x]
Int[u_^m_.*(a_. + b_.*v_^n_)^p_.*(c_. + d_.*v_^n_)^ q_.*(e_ + f_.*v_^n_)^r_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q*(e + f*x^n)^r, x], x, v] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && LinearPairQ[u, v, x]
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e1_ + f1_.*x_^n2_.)^r_.*(e2_ + f2_.*x_^n2_.)^r_., x_Symbol] := Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^q*(e1*e2 + f1*f2*x^n)^r, x] /; FreeQ[{a, b, c, d, e1, f1, e2, f2, g, m, n, p, q, r}, x] && EqQ[n2, n/2] && EqQ[e2*f1 + e1*f2, 0] && (IntegerQ[r] || GtQ[e1, 0] && GtQ[e2, 0])
Int[(g_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^ q_.*(e1_ + f1_.*x_^n2_.)^r_.*(e2_ + f2_.*x_^n2_.)^r_., x_Symbol] := (e1 + f1*x^(n/2))^ FracPart[r]*(e2 + f2*x^(n/2))^FracPart[r]/(e1*e2 + f1*f2*x^n)^ FracPart[r]* Int[(g*x)^m*(a + b*x^n)^p*(c + d*x^n)^q*(e1*e2 + f1*f2*x^n)^r, x] /; FreeQ[{a, b, c, d, e1, f1, e2, f2, g, m, n, p, q, r}, x] && EqQ[n2, n/2] && EqQ[e2*f1 + e1*f2, 0]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.7 P(x) (a+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.7 P(x) (a+b x^n)^p *)
(* Int[Pq_*(a_+b_.*x_)^p_,x_Symbol] := With[{n=Denominator[p]}, n/b*Subst[Int[x^(n*p+n-1)*ReplaceAll[Pq,x->-a/b+x^n/b],x],x,(a+b*x)^( 1/n)]] /; FreeQ[{a,b},x] && PolyQ[Pq,x] && FractionQ[p] *)
Int[Pq_*(a_ + b_.*x_^n_.)^p_., x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, n}, x] && PolyQ[Pq, x] && (IGtQ[p, 0] || EqQ[n, 1])
Int[Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := Int[x*PolynomialQuotient[Pq, x, x]*(a + b*x^n)^p, x] /; FreeQ[{a, b, n, p}, x] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0] && Not[MatchQ[Pq, x^m_.*u_. /; IntegerQ[m]]]
Int[Pq_*(a_ + b_.*x_^n_.)^p_., x_Symbol] := Int[PolynomialQuotient[Pq, a + b*x^n, x]*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && GeQ[Expon[Pq, x], n] && EqQ[PolynomialRemainder[Pq, a + b*x^n, x], 0]
Int[Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := Module[{q = Expon[Pq, x], i}, (a + b*x^n)^p* Sum[Coeff[Pq, x, i]*x^(i + 1)/(n*p + i + 1), {i, 0, q}] + a*n*p* Int[(a + b*x^n)^(p - 1)* Sum[Coeff[Pq, x, i]*x^i/(n*p + i + 1), {i, 0, q}], x]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[(n - 1)/2, 0] && GtQ[p, 0]
Int[Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := Module[{q = Expon[Pq, x], i}, (a*Coeff[Pq, x, q] - b*x*ExpandToSum[Pq - Coeff[Pq, x, q]*x^q, x])*(a + b*x^n)^(p + 1)/(a*b*n*(p + 1)) + 1/(a*n*(p + 1))* Int[Sum[(n*(p + 1) + i + 1)*Coeff[Pq, x, i]*x^i, {i, 0, q - 1}]*(a + b*x^n)^(p + 1), x] /; q == n - 1] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && LtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := -x*Pq*(a + b*x^n)^(p + 1)/(a*n*(p + 1)) + 1/(a*n*(p + 1))* Int[ExpandToSum[n*(p + 1)*Pq + D[x*Pq, x], x]*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && LtQ[p, -1] && LtQ[Expon[Pq, x], n - 1]
Int[P4_/(a_ + b_.*x_^4)^(3/2), x_Symbol] := With[{d = Coeff[P4, x, 0], e = Coeff[P4, x, 1], f = Coeff[P4, x, 3], g = Coeff[P4, x, 4]}, -(a*f + 2*a*g*x - b*e*x^2)/(2*a*b*Sqrt[a + b*x^4]) /; EqQ[b*d + a*g, 0]] /; FreeQ[{a, b}, x] && PolyQ[P4, x, 4] && EqQ[Coeff[P4, x, 2], 0]
Int[P6_/(a_ + b_.*x_^4)^(3/2), x_Symbol] := With[{d = Coeff[P6, x, 0], e = Coeff[P6, x, 2], f = Coeff[P6, x, 3], g = Coeff[P6, x, 4], h = Coeff[P6, x, 6]}, -(a*f - 2*b*d*x - 2*a*h*x^3)/(2*a*b*Sqrt[a + b*x^4]) /; EqQ[b*e - 3*a*h, 0] && EqQ[b*d + a*g, 0]] /; FreeQ[{a, b}, x] && PolyQ[P6, x, 6] && EqQ[Coeff[P6, x, 1], 0] && EqQ[Coeff[P6, x, 5], 0]
Int[Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, Module[{Q = PolynomialQuotient[b^(Floor[(q - 1)/n] + 1)*Pq, a + b*x^n, x], R = PolynomialRemainder[b^(Floor[(q - 1)/n] + 1)*Pq, a + b*x^n, x]}, -x* R*(a + b*x^n)^(p + 1)/(a*n*(p + 1)* b^(Floor[(q - 1)/n] + 1)) + 1/(a*n*(p + 1)*b^(Floor[(q - 1)/n] + 1))* Int[(a + b*x^n)^(p + 1)* ExpandToSum[a*n*(p + 1)*Q + n*(p + 1)*R + D[x*R, x], x], x]] /; GeQ[q, n]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && LtQ[p, -1]
Int[(A_ + B_.*x_)/(a_ + b_.*x_^3), x_Symbol] := B^3/b*Int[1/(A^2 - A*B*x + B^2*x^2), x] /; FreeQ[{a, b, A, B}, x] && EqQ[a*B^3 - b*A^3, 0]
Int[(A_ + B_.*x_)/(a_ + b_.*x_^3), x_Symbol] := With[{r = Numerator[Rt[a/b, 3]], s = Denominator[Rt[a/b, 3]]}, -r*(B*r - A*s)/(3*a*s)*Int[1/(r + s*x), x] + r/(3*a*s)* Int[(r*(B*r + 2*A*s) + s*(B*r - A*s)*x)/(r^2 - r*s*x + s^2*x^2), x]] /; FreeQ[{a, b, A, B}, x] && NeQ[a*B^3 - b*A^3, 0] && PosQ[a/b]
Int[(A_ + B_.*x_)/(a_ + b_.*x_^3), x_Symbol] := With[{r = Numerator[Rt[-a/b, 3]], s = Denominator[Rt[-a/b, 3]]}, r*(B*r + A*s)/(3*a*s)*Int[1/(r - s*x), x] - r/(3*a*s)* Int[(r*(B*r - 2*A*s) - s*(B*r + A*s)*x)/(r^2 + r*s*x + s^2*x^2), x]] /; FreeQ[{a, b, A, B}, x] && NeQ[a*B^3 - b*A^3, 0] && NegQ[a/b]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, -C^2/b*Int[1/(B - C*x), x] /; EqQ[B^2 - A*C, 0] && EqQ[b*B^3 + a*C^3, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = a^(1/3)/b^(1/3)}, C/b*Int[1/(q + x), x] + (B + C*q)/b* Int[1/(q^2 - q*x + x^2), x]] /; EqQ[A*b^(2/3) - a^(1/3)*b^(1/3)*B - 2*a^(2/3)*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = (-a)^(1/3)/(-b)^(1/3)}, C/b*Int[1/(q + x), x] + (B + C*q)/b* Int[1/(q^2 - q*x + x^2), x]] /; EqQ[A*(-b)^(2/3) - (-a)^(1/3)*(-b)^(1/3)*B - 2*(-a)^(2/3)*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = (-a)^(1/3)/b^(1/3)}, -C/b* Int[1/(q - x), x] + (B - C*q)/b*Int[1/(q^2 + q*x + x^2), x]] /; EqQ[A*b^(2/3) + (-a)^(1/3)*b^(1/3)*B - 2*(-a)^(2/3)*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = a^(1/3)/(-b)^(1/3)}, -C/b* Int[1/(q - x), x] + (B - C*q)/b*Int[1/(q^2 + q*x + x^2), x]] /; EqQ[A*(-b)^(2/3) + a^(1/3)*(-b)^(1/3)*B - 2*a^(2/3)*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = (a/b)^(1/3)}, C/b*Int[1/(q + x), x] + (B + C*q)/b* Int[1/(q^2 - q*x + x^2), x]] /; EqQ[A - (a/b)^(1/3)*B - 2*(a/b)^(2/3)*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = Rt[a/b, 3]}, C/b*Int[1/(q + x), x] + (B + C*q)/b* Int[1/(q^2 - q*x + x^2), x]] /; EqQ[A - Rt[a/b, 3]*B - 2*Rt[a/b, 3]^2*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = (-a/b)^(1/3)}, -C/b*Int[1/(q - x), x] + (B - C*q)/b* Int[1/(q^2 + q*x + x^2), x]] /; EqQ[A + (-a/b)^(1/3)*B - 2*(-a/b)^(2/3)*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = Rt[-a/b, 3]}, -C/b*Int[1/(q - x), x] + (B - C*q)/b* Int[1/(q^2 + q*x + x^2), x]] /; EqQ[A + Rt[-a/b, 3]*B - 2*Rt[-a/b, 3]^2*C, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, Int[(A + B*x)/(a + b*x^3), x] + C*Int[x^2/(a + b*x^3), x] /; EqQ[a*B^3 - b*A^3, 0] || Not[RationalQ[a/b]]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = (a/b)^(1/3)}, q^2/a*Int[(A + C*q*x)/(q^2 - q*x + x^2), x]] /; EqQ[A - B*(a/b)^(1/3) + C*(a/b)^(2/3), 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2]}, With[{q = (-a/b)^(1/3)}, q/a*Int[(A*q + (A + B*q)*x)/(q^2 + q*x + x^2), x]] /; EqQ[A + B*(-a/b)^(1/3) + C*(-a/b)^(2/3), 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2], q = (a/b)^(1/3)}, q*(A - B*q + C*q^2)/(3*a)*Int[1/(q + x), x] + q/(3*a)*Int[(q*(2*A + B*q - C*q^2) - (A - B*q - 2*C*q^2)* x)/(q^2 - q*x + x^2), x] /; NeQ[a*B^3 - b*A^3, 0] && NeQ[A - B*q + C*q^2, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2] && GtQ[a/b, 0]
Int[P2_/(a_ + b_.*x_^3), x_Symbol] := With[{A = Coeff[P2, x, 0], B = Coeff[P2, x, 1], C = Coeff[P2, x, 2], q = (-a/b)^(1/3)}, q*(A + B*q + C*q^2)/(3*a)*Int[1/(q - x), x] + q/(3*a)*Int[(q*(2*A - B*q - C*q^2) + (A + B*q - 2*C*q^2)* x)/(q^2 + q*x + x^2), x] /; NeQ[a*B^3 - b*A^3, 0] && NeQ[A + B*q + C*q^2, 0]] /; FreeQ[{a, b}, x] && PolyQ[P2, x, 2] && LtQ[a/b, 0]
Int[Pq_/(a_ + b_.*x_^n_), x_Symbol] := With[{v = Sum[x^ii*(Coeff[Pq, x, ii] + Coeff[Pq, x, n/2 + ii]*x^(n/2))/(a + b*x^n), {ii, 0, n/2 - 1}]}, Int[v, x] /; SumQ[v]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n/2, 0] && Expon[Pq, x] < n
Int[(c_ + d_.*x_)/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Simplify[(1 - Sqrt[3])*d/c]], s = Denom[Simplify[(1 - Sqrt[3])*d/c]]}, 2*d*s^3*Sqrt[a + b*x^3]/(a*r^2*((1 + Sqrt[3])*s + r*x)) - 3^(1/4)*Sqrt[2 - Sqrt[3]]*d*s*(s + r*x)* Sqrt[(s^2 - r*s*x + r^2*x^2)/((1 + Sqrt[3])*s + r*x)^2]/ (r^2*Sqrt[a + b*x^3]* Sqrt[s*(s + r*x)/((1 + Sqrt[3])*s + r*x)^2])* EllipticE[ ArcSin[((1 - Sqrt[3])*s + r*x)/((1 + Sqrt[3])*s + r*x)], -7 - 4*Sqrt[3]]] /; FreeQ[{a, b, c, d}, x] && PosQ[a] && EqQ[b*c^3 - 2*(5 - 3*Sqrt[3])*a*d^3, 0]
Int[(c_ + d_.*x_)/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, (c*r - (1 - Sqrt[3])*d*s)/r*Int[1/Sqrt[a + b*x^3], x] + d/r*Int[((1 - Sqrt[3])*s + r*x)/Sqrt[a + b*x^3], x]] /; FreeQ[{a, b, c, d}, x] && PosQ[a] && NeQ[b*c^3 - 2*(5 - 3*Sqrt[3])*a*d^3, 0]
Int[(c_ + d_.*x_)/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Simplify[(1 + Sqrt[3])*d/c]], s = Denom[Simplify[(1 + Sqrt[3])*d/c]]}, 2*d*s^3*Sqrt[a + b*x^3]/(a*r^2*((1 - Sqrt[3])*s + r*x)) + 3^(1/4)*Sqrt[2 + Sqrt[3]]*d*s*(s + r*x)* Sqrt[(s^2 - r*s*x + r^2*x^2)/((1 - Sqrt[3])*s + r*x)^2]/ (r^2*Sqrt[a + b*x^3]* Sqrt[-s*(s + r*x)/((1 - Sqrt[3])*s + r*x)^2])* EllipticE[ ArcSin[((1 + Sqrt[3])*s + r*x)/((1 - Sqrt[3])*s + r*x)], -7 + 4*Sqrt[3]]] /; FreeQ[{a, b, c, d}, x] && NegQ[a] && EqQ[b*c^3 - 2*(5 + 3*Sqrt[3])*a*d^3, 0]
Int[(c_ + d_.*x_)/Sqrt[a_ + b_.*x_^3], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, (c*r - (1 + Sqrt[3])*d*s)/r*Int[1/Sqrt[a + b*x^3], x] + d/r*Int[((1 + Sqrt[3])*s + r*x)/Sqrt[a + b*x^3], x]] /; FreeQ[{a, b, c, d}, x] && NegQ[a] && NeQ[b*c^3 - 2*(5 + 3*Sqrt[3])*a*d^3, 0]
Int[(c_ + d_.*x_^4)/Sqrt[a_ + b_.*x_^6], x_Symbol] := With[{r = Numer[Rt[b/a, 3]], s = Denom[Rt[b/a, 3]]}, (1 + Sqrt[3])*d*s^3*x* Sqrt[a + b*x^6]/(2*a*r^2*(s + (1 + Sqrt[3])*r*x^2)) - 3^(1/4)*d*s*x*(s + r*x^2)* Sqrt[(s^2 - r*s*x^2 + r^2*x^4)/(s + (1 + Sqrt[3])*r*x^2)^2]/ (2*r^2* Sqrt[(r*x^2*(s + r*x^2))/(s + (1 + Sqrt[3])*r*x^2)^2]* Sqrt[a + b*x^6])* EllipticE[ ArcCos[(s + (1 - Sqrt[3])*r*x^2)/(s + (1 + Sqrt[3])*r* x^2)], (2 + Sqrt[3])/4]] /; FreeQ[{a, b, c, d}, x] && EqQ[2*Rt[b/a, 3]^2*c - (1 - Sqrt[3])*d, 0]
Int[(c_ + d_.*x_^4)/Sqrt[a_ + b_.*x_^6], x_Symbol] := With[{q = Rt[b/a, 3]}, (2*c*q^2 - (1 - Sqrt[3])*d)/(2*q^2)*Int[1/Sqrt[a + b*x^6], x] + d/(2*q^2)*Int[(1 - Sqrt[3] + 2*q^2*x^4)/Sqrt[a + b*x^6], x]] /; FreeQ[{a, b, c, d}, x] && NeQ[2*Rt[b/a, 3]^2*c - (1 - Sqrt[3])*d, 0]
Int[(c_ + d_.*x_^2)/Sqrt[a_ + b_.*x_^8], x_Symbol] := -c*d*x^3*Sqrt[-(c - d*x^2)^2/(c*d*x^2)]* Sqrt[-d^2*(a + b*x^8)/(b*c^2*x^4)]/(Sqrt[2 + Sqrt[2]]*(c - d*x^2)* Sqrt[a + b*x^8])* EllipticF[ ArcSin[1/2* Sqrt[(Sqrt[2]*c^2 + 2*c*d*x^2 + Sqrt[2]*d^2*x^4)/(c*d* x^2)]], -2*(1 - Sqrt[2])] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c^4 - a*d^4, 0]
Int[(c_ + d_.*x_^2)/Sqrt[a_ + b_.*x_^8], x_Symbol] := (d + Rt[b/a, 4]*c)/(2*Rt[b/a, 4])* Int[(1 + Rt[b/a, 4]*x^2)/Sqrt[a + b*x^8], x] - (d - Rt[b/a, 4]*c)/(2*Rt[b/a, 4])* Int[(1 - Rt[b/a, 4]*x^2)/Sqrt[a + b*x^8], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c^4 - a*d^4, 0]
Int[Pq_/(x_*Sqrt[a_ + b_.*x_^n_]), x_Symbol] := Coeff[Pq, x, 0]*Int[1/(x*Sqrt[a + b*x^n]), x] + Int[ExpandToSum[(Pq - Coeff[Pq, x, 0])/x, x]/Sqrt[a + b*x^n], x] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && NeQ[Coeff[Pq, x, 0], 0]
Int[Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := Module[{q = Expon[Pq, x], j, k}, Int[ Sum[x^j*Sum[ Coeff[Pq, x, j + k*n/2]*x^(k*n/2), {k, 0, 2*(q - j)/n + 1}]*(a + b*x^n)^p, {j, 0, n/2 - 1}], x]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && IGtQ[n/2, 0] && Not[PolyQ[Pq, x^(n/2)]]
Int[Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := Coeff[Pq, x, n - 1]*Int[x^(n - 1)*(a + b*x^n)^p, x] + Int[ ExpandToSum[Pq - Coeff[Pq, x, n - 1]*x^(n - 1), x]*(a + b*x^n)^p, x] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && Expon[Pq, x] == n - 1
Int[Pq_/(a_ + b_.*x_^n_), x_Symbol] := Int[ExpandIntegrand[Pq/(a + b*x^n), x], x] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IntegerQ[n]
Int[Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, Pqq*x^(q - n + 1)*(a + b*x^n)^(p + 1)/(b*(q + n*p + 1)) + 1/(b*(q + n*p + 1))* Int[ExpandToSum[ b*(q + n*p + 1)*(Pq - Pqq*x^q) - a*Pqq*(q - n + 1)*x^(q - n), x]*(a + b*x^n)^p, x]] /; NeQ[q + n*p + 1, 0] && q - n >= 0 && (IntegerQ[2*p] || IntegerQ[p + (q + 1)/(2*n)])] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && IGtQ[n, 0]
Int[Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, -Subst[ Int[ExpandToSum[x^q*ReplaceAll[Pq, x -> x^(-1)], x]*(a + b*x^(-n))^p/x^(q + 2), x], x, 1/x]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && ILtQ[n, 0]
Int[Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g - 1)*ReplaceAll[Pq, x -> x^g]*(a + b*x^(g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && FractionQ[n]
Int[(A_ + B_.*x_^m_.)*(a_ + b_.*x_^n_)^p_., x_Symbol] := A*Int[(a + b*x^n)^p, x] + B*Int[x^m*(a + b*x^n)^p, x] /; FreeQ[{a, b, A, B, m, n, p}, x] && EqQ[m - n + 1, 0]
Int[P3_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{A = Coeff[P3, x^(n/2), 0], B = Coeff[P3, x^(n/2), 1], C = Coeff[P3, x^(n/2), 2], D = Coeff[P3, x^(n/2), 3]}, -(x*(b*A - a*C + (b*B - a*D)*x^(n/2))*(a + b*x^n)^(p + 1))/(a*b* n*(p + 1)) - 1/(2*a*b*n*(p + 1))* Int[(a + b*x^n)^(p + 1)* Simp[2*a*C - 2*b*A*(n*(p + 1) + 1) + (a*D*(n + 2) - b*B*(n*(2*p + 3) + 2))*x^(n/2), x], x]] /; FreeQ[{a, b, n}, x] && PolyQ[P3, x^(n/2), 3] && ILtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^n_)^p_., x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, n, p}, x] && (PolyQ[Pq, x] || PolyQ[Pq, x^n])
Int[Pq_*(a_ + b_.*v_^n_.)^p_, x_Symbol] := 1/Coeff[v, x, 1]* Subst[Int[SubstFor[v, Pq, x]*(a + b*x^n)^p, x], x, v] /; FreeQ[{a, b, n, p}, x] && LinearQ[v, x] && PolyQ[Pq, v^n]
Int[Pq_*(a1_ + b1_.*x_^n_.)^p_.*(a2_ + b2_.*x_^n_.)^p_., x_Symbol] := Int[Pq*(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, n, p}, x] && PolyQ[Pq, x] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[p] || GtQ[a1, 0] && GtQ[a2, 0])
Int[Pq_*(a1_ + b1_.*x_^n_.)^p_.*(a2_ + b2_.*x_^n_.)^p_., x_Symbol] := (a1 + b1*x^n)^ FracPart[p]*(a2 + b2*x^n)^FracPart[p]/(a1*a2 + b1*b2*x^(2*n))^ FracPart[p]* Int[Pq*(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, n, p}, x] && PolyQ[Pq, x] && EqQ[a2*b1 + a1*b2, 0] && Not[EqQ[n, 1] && LinearQ[Pq, x]]
Int[(e_ + f_.*x_^n_. + g_.*x_^n2_.)*(a_ + b_.*x_^n_.)^ p_.*(c_ + d_.*x_^n_.)^p_., x_Symbol] := e*x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(p + 1)/(a*c) /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[n2, 2*n] && EqQ[a*c*f - e*(b*c + a*d)*(n*(p + 1) + 1), 0] && EqQ[a*c*g - b*d*e*(2*n*(p + 1) + 1), 0]
Int[(e_ + g_.*x_^n2_.)*(a_ + b_.*x_^n_.)^p_.*(c_ + d_.*x_^n_.)^p_., x_Symbol] := e*x*(a + b*x^n)^(p + 1)*(c + d*x^n)^(p + 1)/(a*c) /; FreeQ[{a, b, c, d, e, g, n, p}, x] && EqQ[n2, 2*n] && EqQ[n*(p + 1) + 1, 0] && EqQ[a*c*g - b*d*e*(2*n*(p + 1) + 1), 0]
Int[(A_ + B_.*x_^m_.)*(a_. + b_.*x_^n_)^p_.*(c_ + d_.*x_^n_)^q_., x_Symbol] := A*Int[(a + b*x^n)^p*(c + d*x^n)^q, x] + B*Int[x^m*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, A, B, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && EqQ[m - n + 1, 0]
Int[Px_^q_.*(a_. + b_.*(c_ + d_.*x_)^n_)^p_, x_Symbol] := With[{k = Denominator[n]}, k/d* Subst[Int[ SimplifyIntegrand[ x^(k - 1)*ReplaceAll[Px, x -> x^k/d - c/d]^q*(a + b*x^(k*n))^p, x], x], x, (c + d*x)^(1/k)]] /; FreeQ[{a, b, c, d, p}, x] && PolynomialQ[Px, x] && IntegerQ[q] && FractionQ[n]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.3 General/1.1.3.8 P(x) (c x)^m (a+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.3.8 P(x) (c x)^m (a+b x^n)^p *)
Int[x_^m_.*(e_ + f_.*x_^q_. + g_.*x_^r_. + h_.*x_^n_.)/(a_ + c_.*x_^n_.)^(3/2), x_Symbol] := -(2*a*g + 4*a*h*x^(n/4) - 2*c*f*x^(n/2))/(a*c*n*Sqrt[a + c*x^n]) /; FreeQ[{a, c, e, f, g, h, m, n}, x] && EqQ[q, n/4] && EqQ[r, 3*n/4] && EqQ[4*m - n + 4, 0] && EqQ[c*e + a*h, 0]
Int[(d_*x_)^ m_.*(e_ + f_.*x_^q_. + g_.*x_^r_. + h_.*x_^n_.)/(a_ + c_.*x_^n_.)^(3/2), x_Symbol] := (d*x)^m/x^m* Int[x^m*(e + f*x^(n/4) + g*x^((3*n)/4) + h*x^n)/(a + c*x^n)^(3/2), x] /; FreeQ[{a, c, d, e, f, g, h, m, n}, x] && EqQ[4*m - n + 4, 0] && EqQ[q, n/4] && EqQ[r, 3*n/4] && EqQ[c*e + a*h, 0]
Int[(c_.*x_)^m_*Pq_*(a_ + b_.*x_)^p_, x_Symbol] := With[{n = Denominator[p]}, n/b* Subst[Int[ x^(n*p + n - 1)*(-a*c/b + c*x^n/b)^m* ReplaceAll[Pq, x -> -a/b + x^n/b], x], x, (a + b*x)^(1/n)]] /; FreeQ[{a, b, c, m}, x] && PolyQ[Pq, x] && FractionQ[p] && ILtQ[m, -1]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_., x_Symbol] := 1/(m + 1)* Subst[Int[ SubstFor[x^(m + 1), Pq, x]*(a + b*x^Simplify[n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, m, n, p}, x] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && PolyQ[Pq, x^(m + 1)]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_.)^p_., x_Symbol] := Int[ExpandIntegrand[(c*x)^m*Pq*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, m, n}, x] && PolyQ[Pq, x] && (IGtQ[p, 0] || EqQ[n, 1])
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*SubstFor[x^n, Pq, x]*(a + b*x)^p, x], x, x^n] /; FreeQ[{a, b, m, n, p}, x] && PolyQ[Pq, x^n] && IntegerQ[Simplify[(m + 1)/n]]
Int[(c_*x_)^m_.*Pq_*(a_ + b_.*x_^n_)^p_., x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*Pq*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && PolyQ[Pq, x^n] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := Pq*(a + b*x^n)^(p + 1)/(b*n*(p + 1)) - 1/(b*n*(p + 1))*Int[D[Pq, x]*(a + b*x^n)^(p + 1), x] /; FreeQ[{a, b, m, n}, x] && PolyQ[Pq, x] && EqQ[m - n + 1, 0] && LtQ[p, -1]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := 1/d*Int[(d*x)^(m + 1)*PolynomialQuotient[Pq, x, x]*(a + b*x^n)^p, x] /; FreeQ[{a, b, d, m, n, p}, x] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := Module[{u = IntHide[x^m*Pq, x]}, u*(a + b*x^n)^p - b*n*p*Int[ x^(m + n)*(a + b*x^n)^(p - 1)*ExpandToSum[u/x^(m + 1), x], x]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m + Expon[Pq, x] + 1, 0]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := Module[{q = Expon[Pq, x], i}, (c*x)^m*(a + b*x^n)^p* Sum[Coeff[Pq, x, i]*x^(i + 1)/(m + n*p + i + 1), {i, 0, q}] + a*n*p* Int[(c*x)^m*(a + b*x^n)^(p - 1)* Sum[Coeff[Pq, x, i]*x^i/(m + n*p + i + 1), {i, 0, q}], x]] /; FreeQ[{a, b, c, m}, x] && PolyQ[Pq, x] && IGtQ[(n - 1)/2, 0] && GtQ[p, 0]
Int[x_^2*P4_/(a_ + b_.*x_^4)^(3/2), x_Symbol] := With[{e = Coeff[P4, x, 0], f = Coeff[P4, x, 1], h = Coeff[P4, x, 4]}, -(f - 2*h*x^3)/(2*b*Sqrt[a + b*x^4]) /; EqQ[b*e - 3*a*h, 0]] /; FreeQ[{a, b}, x] && PolyQ[P4, x, 4] && EqQ[Coeff[P4, x, 2], 0] && EqQ[Coeff[P4, x, 3], 0]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := With[{q = m + Expon[Pq, x]}, Module[{Q = PolynomialQuotient[b^(Floor[(q - 1)/n] + 1)*x^m*Pq, a + b*x^n, x], R = PolynomialRemainder[b^(Floor[(q - 1)/n] + 1)*x^m*Pq, a + b*x^n, x]}, -x* R*(a + b*x^n)^(p + 1)/(a*n*(p + 1)* b^(Floor[(q - 1)/n] + 1)) + 1/(a*n*(p + 1)*b^(Floor[(q - 1)/n] + 1))* Int[(a + b*x^n)^(p + 1)* ExpandToSum[a*n*(p + 1)*Q + n*(p + 1)*R + D[x*R, x], x], x]] /; GeQ[q, n]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && LtQ[p, -1] && IGtQ[m, 0]
Int[x_^m_*Pq_*(a_ + b_.*x_^n_.)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, Module[{Q = PolynomialQuotient[a*b^(Floor[(q - 1)/n] + 1)*x^m*Pq, a + b*x^n, x], R = PolynomialRemainder[a*b^(Floor[(q - 1)/n] + 1)*x^m*Pq, a + b*x^n, x], i}, -x* R*(a + b*x^n)^(p + 1)/(a^2*n*(p + 1)* b^(Floor[(q - 1)/n] + 1)) + 1/(a*n*(p + 1)*b^(Floor[(q - 1)/n] + 1))* Int[x^m*(a + b*x^n)^(p + 1)* ExpandToSum[ n*(p + 1)*x^(-m)*Q + Sum[(n*(p + 1) + i + 1)/a*Coeff[R, x, i]*x^(i - m), {i, 0, n - 1}], x], x]]] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && LtQ[p, -1] && ILtQ[m, 0]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{g = GCD[m + 1, n]}, 1/g* Subst[Int[ x^((m + 1)/g - 1)* ReplaceAll[Pq, x -> x^(1/g)]*(a + b*x^(n/g))^p, x], x, x^g] /; g != 1] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x^n] && IGtQ[n, 0] && IntegerQ[m]
Int[(c_.*x_)^m_.*Pq_/(a_ + b_.*x_^n_), x_Symbol] := With[{v = Sum[(c*x)^(m + ii)*(Coeff[Pq, x, ii] + Coeff[Pq, x, n/2 + ii]*x^(n/2))/(c^ii*(a + b*x^n)), {ii, 0, n/2 - 1}]}, Int[v, x] /; SumQ[v]] /; FreeQ[{a, b, c, m}, x] && PolyQ[Pq, x] && IGtQ[n/2, 0] && Expon[Pq, x] < n
Int[Pq_/(x_*Sqrt[a_ + b_.*x_^n_]), x_Symbol] := Coeff[Pq, x, 0]*Int[1/(x*Sqrt[a + b*x^n]), x] + Int[ExpandToSum[(Pq - Coeff[Pq, x, 0])/x, x]/Sqrt[a + b*x^n], x] /; FreeQ[{a, b}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && NeQ[Coeff[Pq, x, 0], 0]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := Module[{q = Expon[Pq, x], j, k}, Int[ Sum[(c*x)^(m + j)/c^j* Sum[Coeff[Pq, x, j + k*n/2]*x^(k*n/2), {k, 0, 2*(q - j)/n + 1}]*(a + b*x^n)^p, {j, 0, n/2 - 1}], x]] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && IGtQ[n/2, 0] && Not[PolyQ[Pq, x^(n/2)]]
Int[(c_.*x_)^m_.*Pq_/(a_ + b_.*x_^n_), x_Symbol] := Int[ExpandIntegrand[(c*x)^m*Pq/(a + b*x^n), x], x] /; FreeQ[{a, b, c, m}, x] && PolyQ[Pq, x] && IntegerQ[n] && Not[IGtQ[m, 0]]
Int[(c_.*x_)^m_*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{Pq0 = Coeff[Pq, x, 0]}, Pq0*(c*x)^(m + 1)*(a + b*x^n)^(p + 1)/(a*c*(m + 1)) + 1/(2*a*c*(m + 1))* Int[(c*x)^(m + 1)* ExpandToSum[ 2*a*(m + 1)*(Pq - Pq0)/x - 2*b*Pq0*(m + n*(p + 1) + 1)*x^(n - 1), x]*(a + b*x^n)^p, x] /; NeQ[Pq0, 0]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && IGtQ[n, 0] && LtQ[m, -1] && LeQ[n - 1, Expon[Pq, x]]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, Pqq*(c*x)^(m + q - n + 1)*(a + b*x^n)^(p + 1)/(b* c^(q - n + 1)*(m + q + n*p + 1)) + 1/(b*(m + q + n*p + 1))* Int[(c*x)^m* ExpandToSum[ b*(m + q + n*p + 1)*(Pq - Pqq*x^q) - a*Pqq*(m + q - n + 1)*x^(q - n), x]*(a + b*x^n)^p, x]] /; NeQ[m + q + n*p + 1, 0] && q - n >= 0 && (IntegerQ[2*p] || IntegerQ[p + (q + 1)/(2*n)])] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && IGtQ[n, 0]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, -Subst[ Int[ExpandToSum[x^q*ReplaceAll[Pq, x -> x^(-1)], x]*(a + b*x^(-n))^p/x^(m + q + 2), x], x, 1/x]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && ILtQ[n, 0] && IntegerQ[m]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{g = Denominator[m], q = Expon[Pq, x]}, -g/c* Subst[Int[ ExpandToSum[x^(g*q)*ReplaceAll[Pq, x -> c^(-1)*x^(-g)], x]* (a + b*c^(-n)*x^(-g*n))^p/x^(g*(m + q + 1) + 1), x], x, 1/(c*x)^(1/g)]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && ILtQ[n, 0] && FractionQ[m]
Int[(c_.*x_)^m_*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, -(c*x)^m*(x^(-1))^m* Subst[Int[ ExpandToSum[x^q*ReplaceAll[Pq, x -> x^(-1)], x]*(a + b*x^(-n))^p/ x^(m + q + 2), x], x, 1/x]] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g*(m + 1) - 1)*ReplaceAll[Pq, x -> x^g]*(a + b*x^(g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, b, m, p}, x] && PolyQ[Pq, x] && FractionQ[n]
Int[(c_*x_)^m_*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*Pq*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && FractionQ[n]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[ ReplaceAll[SubstFor[x^n, Pq, x], x -> x^Simplify[n/(m + 1)]]*(a + b*x^Simplify[n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, m, n, p}, x] && PolyQ[Pq, x^n] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_*x_)^m_*Pq_*(a_ + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*Pq*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && PolyQ[Pq, x^n] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_)^p_., x_Symbol] := Int[ExpandIntegrand[(c*x)^m*Pq*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, m, n, p}, x] && (PolyQ[Pq, x] || PolyQ[Pq, x^n]) && Not[IGtQ[m, 0]]
Int[u_^m_.*Pq_*(a_ + b_.*v_^n_.)^p_, x_Symbol] := u^m/(Coeff[v, x, 1]*v^m)* Subst[Int[x^m*SubstFor[v, Pq, x]*(a + b*x^n)^p, x], x, v] /; FreeQ[{a, b, m, n, p}, x] && LinearPairQ[u, v, x] && PolyQ[Pq, v^n]
Int[(c_.*x_)^m_.*Pq_*(a1_ + b1_.*x_^n_.)^p_.*(a2_ + b2_.*x_^n_.)^p_., x_Symbol] := Int[(c*x)^m*Pq*(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && PolyQ[Pq, x] && EqQ[a2*b1 + a1*b2, 0] && (IntegerQ[p] || GtQ[a1, 0] && GtQ[a2, 0])
Int[(c_.*x_)^m_.*Pq_*(a1_ + b1_.*x_^n_.)^p_.*(a2_ + b2_.*x_^n_.)^p_., x_Symbol] := (a1 + b1*x^n)^ FracPart[p]*(a2 + b2*x^n)^FracPart[p]/(a1*a2 + b1*b2*x^(2*n))^ FracPart[p]* Int[(c*x)^m*Pq*(a1*a2 + b1*b2*x^(2*n))^p, x] /; FreeQ[{a1, b1, a2, b2, c, m, n, p}, x] && PolyQ[Pq, x] && EqQ[a2*b1 + a1*b2, 0] && Not[EqQ[n, 1] && LinearQ[Pq, x]]
Int[(h_.*x_)^m_.*(e_ + f_.*x_^n_. + g_.*x_^n2_.)*(a_ + b_.*x_^n_.)^ p_.*(c_ + d_.*x_^n_.)^p_., x_Symbol] := e*(h*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(p + 1)/(a*c* h*(m + 1)) /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[a*c*f*(m + 1) - e*(b*c + a*d)*(m + n*(p + 1) + 1), 0] && EqQ[a*c*g*(m + 1) - b*d*e*(m + 2*n*(p + 1) + 1), 0] && NeQ[m, -1]
Int[(h_.*x_)^m_.*(e_ + g_.*x_^n2_.)*(a_ + b_.*x_^n_.)^ p_.*(c_ + d_.*x_^n_.)^p_., x_Symbol] := e*(h*x)^(m + 1)*(a + b*x^n)^(p + 1)*(c + d*x^n)^(p + 1)/(a*c* h*(m + 1)) /; FreeQ[{a, b, c, d, e, g, h, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[m + n*(p + 1) + 1, 0] && EqQ[a*c*g*(m + 1) - b*d*e*(m + 2*n*(p + 1) + 1), 0] && NeQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.4 Improper/1.1.4.1 (a x^j+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.4.1 (a x^j+b x^n)^p *)
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (a*x^j + b*x^n)^(p + 1)/(b*(n - j) (p + 1)*x^(n - 1)) /; FreeQ[{a, b, j, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && EqQ[j*p - n + j + 1, 0]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)*x^(j - 1)) + (n*p + n - j + 1)/(a*(n - j)*(p + 1))* Int[(a*x^j + b*x^n)^(p + 1)/x^j, x] /; FreeQ[{a, b, j, n}, x] && Not[IntegerQ[p]] && NeQ[n, j] && ILtQ[Simplify[(n*p + n - j + 1)/(n - j)], 0] && LtQ[p, -1]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (a*x^j + b*x^n)^(p + 1)/(a*(j*p + 1)*x^(j - 1)) - b*(n*p + n - j + 1)/(a*(j*p + 1))* Int[x^(n - j)*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, j, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && ILtQ[Simplify[(n*p + n - j + 1)/(n - j)], 0] && NeQ[j*p + 1, 0]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := x*(a*x^j + b*x^n)^p/(j*p + 1) - b*(n - j)*p/(j*p + 1)*Int[x^n*(a*x^j + b*x^n)^(p - 1), x] /; FreeQ[{a, b}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && GtQ[p, 0] && LtQ[j*p + 1, 0]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := x*(a*x^j + b*x^n)^p/(n*p + 1) + a*(n - j)*p/(n*p + 1)*Int[x^j*(a*x^j + b*x^n)^(p - 1), x] /; FreeQ[{a, b}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && GtQ[p, 0] && NeQ[n*p + 1, 0]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (a*x^j + b*x^n)^(p + 1)/(b*(n - j)*(p + 1)*x^(n - 1)) - (j*p - n + j + 1)/(b*(n - j)*(p + 1))* Int[(a*x^j + b*x^n)^(p + 1)/x^n, x] /; FreeQ[{a, b}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && LtQ[p, -1] && GtQ[j*p + 1, n - j]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)*x^(j - 1)) + (n*p + n - j + 1)/(a*(n - j)*(p + 1))* Int[(a*x^j + b*x^n)^(p + 1)/x^j, x] /; FreeQ[{a, b}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && LtQ[p, -1]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := x*(a*x^j + b*x^n)^p/(p*(n - j)) + a*Int[x^j*(a*x^j + b*x^n)^(p - 1), x] /; FreeQ[{a, b, j, n}, x] && IGtQ[p + 1/2, 0] && NeQ[n, j] && EqQ[Simplify[j*p + 1], 0]
Int[1/Sqrt[a_.*x_^2 + b_.*x_^n_.], x_Symbol] := 2/(2 - n)*Subst[Int[1/(1 - a*x^2), x], x, x/Sqrt[a*x^2 + b*x^n]] /; FreeQ[{a, b, n}, x] && NeQ[n, 2]
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)*x^(j - 1)) + (n*p + n - j + 1)/(a*(n - j)*(p + 1))* Int[(a*x^j + b*x^n)^(p + 1)/x^j, x] /; FreeQ[{a, b, j, n}, x] && ILtQ[p + 1/2, 0] && NeQ[n, j] && EqQ[Simplify[j*p + 1], 0]
Int[1/Sqrt[a_.*x_^j_. + b_.*x_^n_.], x_Symbol] := -2*Sqrt[a*x^j + b*x^n]/(b*(n - 2)*x^(n - 1)) - a*(2*n - j - 2)/(b*(n - 2))* Int[1/(x^(n - j)*Sqrt[a*x^j + b*x^n]), x] /; FreeQ[{a, b}, x] && LtQ[2*(n - 1), j, n]
(* Int[(a_.*x_^j_.+b_.*x_^n_.)^p_,x_Symbol] := x*(a*x^j+b*x^n)^p/(p*(n-j)*((a*x^j+b*x^n)/(b*x^n))^p)* Hypergeometric2F1[-p,-p,1-p,-a/(b*x^(n-j))] /; FreeQ[{a,b,j,n,p},x] && Not[IntegerQ[p]] && NeQ[n,j] && EqQ[j*p+1,0] *)
(* Int[(a_.*x_^j_.+b_.*x_^n_.)^p_,x_Symbol] := x*(a*x^j+b*x^n)^p/((j*p+1)*((a*x^j+b*x^n)/(a*x^j))^p)* Hypergeometric2F1[-p,(j*p+1)/(n-j),(j*p+1)/(n-j)+1,-b*x^(n-j)/a] /; FreeQ[{a,b,j,n,p},x] && Not[IntegerQ[p]] && NeQ[n,j] && NeQ[j*p+1,0] *)
Int[(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (a*x^j + b*x^n)^ FracPart[p]/(x^(j*FracPart[p])*(a + b*x^(n - j))^FracPart[p])* Int[x^(j*p)*(a + b*x^(n - j))^p, x] /; FreeQ[{a, b, j, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && PosQ[n - j]
Int[(a_.*u_^j_. + b_.*u_^n_.)^p_, x_Symbol] := 1/Coefficient[u, x, 1]*Subst[Int[(a*x^j + b*x^n)^p, x], x, u] /; FreeQ[{a, b, j, n, p}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.4 Improper/1.1.4.2 (c x)^m (a x^j+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.4.2 (c x)^m (a x^j+b x^n)^p *)
Int[x_^m_.*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := 1/n*Subst[Int[(a*x^Simplify[j/n] + b*x)^p, x], x, x^n] /; FreeQ[{a, b, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && EqQ[Simplify[m - n + 1], 0]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -c^(j - 1)*(c*x)^(m - j + 1)*(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)) /; FreeQ[{a, b, c, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && EqQ[m + n*p + n - j + 1, 0] && (IntegerQ[j] || GtQ[c, 0])
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -c^(j - 1)*(c*x)^(m - j + 1)*(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)) + c^j*(m + n*p + n - j + 1)/(a*(n - j)*(p + 1))* Int[(c*x)^(m - j)*(a*x^j + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, j, m, n}, x] && Not[IntegerQ[p]] && NeQ[n, j] && ILtQ[Simplify[(m + n*p + n - j + 1)/(n - j)], 0] && LtQ[p, -1] && (IntegerQ[j] || GtQ[c, 0])
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := c^(j - 1)*(c*x)^(m - j + 1)*(a*x^j + b*x^n)^(p + 1)/(a*(m + j*p + 1)) - b*(m + n*p + n - j + 1)/(a*c^(n - j)*(m + j*p + 1))* Int[(c*x)^(m + n - j)*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && ILtQ[Simplify[(m + n*p + n - j + 1)/(n - j)], 0] && NeQ[m + j*p + 1, 0] && (IntegersQ[j, n] || GtQ[c, 0])
Int[(c_*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && ILtQ[Simplify[(m + n*p + n - j + 1)/(n - j)], 0]
Int[x_^m_.*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a*x^Simplify[j/n] + b*x)^p, x], x, x^n] /; FreeQ[{a, b, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[(m + 1)/n]] && NeQ[n^2, 1]
Int[(c_*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[(m + 1)/n]] && NeQ[n^2, 1]
Int[(c_.*x_)^m_*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (c*x)^(m + 1)*(a*x^j + b*x^n)^p/(c*(m + j*p + 1)) - b*p*(n - j)/(c^n*(m + j*p + 1))* Int[(c*x)^(m + n)*(a*x^j + b*x^n)^(p - 1), x] /; FreeQ[{a, b, c}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && (IntegersQ[j, n] || GtQ[c, 0]) && GtQ[p, 0] && LtQ[m + j*p + 1, 0]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (c*x)^(m + 1)*(a*x^j + b*x^n)^p/(c*(m + n*p + 1)) + a*(n - j)*p/(c^j*(m + n*p + 1))* Int[(c*x)^(m + j)*(a*x^j + b*x^n)^(p - 1), x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && (IntegersQ[j, n] || GtQ[c, 0]) && GtQ[p, 0] && NeQ[m + n*p + 1, 0]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := c^(n - 1)*(c*x)^(m - n + 1)*(a*x^j + b*x^n)^(p + 1)/(b*(n - j)*(p + 1)) - c^n*(m + j*p - n + j + 1)/(b*(n - j)*(p + 1))* Int[(c*x)^(m - n)*(a*x^j + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && (IntegersQ[j, n] || GtQ[c, 0]) && LtQ[p, -1] && GtQ[m + j*p + 1, n - j]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -c^(j - 1)*(c*x)^(m - j + 1)*(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)) + c^j*(m + n*p + n - j + 1)/(a*(n - j)*(p + 1))* Int[(c*x)^(m - j)*(a*x^j + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && (IntegersQ[j, n] || GtQ[c, 0]) && LtQ[p, -1]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := c^(n - 1)*(c*x)^(m - n + 1)*(a*x^j + b*x^n)^(p + 1)/(b*(m + n*p + 1)) - a*c^(n - j)*(m + j*p - n + j + 1)/(b*(m + n*p + 1))* Int[(c*x)^(m - (n - j))*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, m, p}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && (IntegersQ[j, n] || GtQ[c, 0]) && GtQ[m + j*p + 1 - n + j, 0] && NeQ[m + n*p + 1, 0]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := c^(j - 1)*(c*x)^(m - j + 1)*(a*x^j + b*x^n)^(p + 1)/(a*(m + j*p + 1)) - b*(m + n*p + n - j + 1)/(a*c^(n - j)*(m + j*p + 1))* Int[(c*x)^(m + n - j)*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, m, p}, x] && Not[IntegerQ[p]] && LtQ[0, j, n] && (IntegersQ[j, n] || GtQ[c, 0]) && LtQ[m + j*p + 1, 0]
Int[x_^m_.*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[(a*x^Simplify[j/(m + 1)] + b*x^Simplify[n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && NeQ[m, -1] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && NeQ[m, -1] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := (c*x)^(m + 1)*(a*x^j + b*x^n)^p/(c*p*(n - j)) + a/c^j*Int[(c*x)^(m + j)*(a*x^j + b*x^n)^(p - 1), x] /; FreeQ[{a, b, c, j, m, n}, x] && IGtQ[p + 1/2, 0] && NeQ[n, j] && EqQ[Simplify[m + j*p + 1], 0] && (IntegerQ[j] || GtQ[c, 0])
Int[x_^m_./Sqrt[a_.*x_^j_. + b_.*x_^n_.], x_Symbol] := -2/(n - j)* Subst[Int[1/(1 - a*x^2), x], x, x^(j/2)/Sqrt[a*x^j + b*x^n]] /; FreeQ[{a, b, j, n}, x] && EqQ[m, j/2 - 1] && NeQ[n, j]
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := -c^(j - 1)*(c*x)^(m - j + 1)*(a*x^j + b*x^n)^(p + 1)/(a*(n - j)*(p + 1)) + c^j*(m + n*p + n - j + 1)/(a*(n - j)*(p + 1))* Int[(c*x)^(m - j)*(a*x^j + b*x^n)^(p + 1), x] /; FreeQ[{a, b, c, j, m, n}, x] && ILtQ[p + 1/2, 0] && NeQ[n, j] && EqQ[Simplify[m + j*p + 1], 0] && (IntegerQ[j] || GtQ[c, 0])
Int[(c_*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && IntegerQ[p + 1/2] && NeQ[n, j] && EqQ[Simplify[m + j*p + 1], 0]
(* Int[x_^m_.*(a_.*x_^j_.+b_.*x_^n_.)^p_,x_Symbol] := (a*x^j+b*x^n)^(p+1)/(b*p*(n-j)*x^(n+j*p))*Hypergeometric2F1[1,1,1-p, -a/(b*x^(n-j))] /; FreeQ[{a,b,j,m,n,p},x] && NeQ[n,j] && EqQ[m+j*p+1,0] *)
(* Int[x_^m_.*(a_.*x_^j_.+b_.*x_^n_.)^p_,x_Symbol] := (a*x^j+b*x^n)^(p+1)/(b*(p-1)*(n-j)*x^(2*n+j*(p-1)))* Hypergeometric2F1[1,2,2-p,-a/(b*x^(n-j))] /; FreeQ[{a,b,j,m,n,p},x] && NeQ[n,j] && EqQ[m+n+(p-1)*j+1,0] *)
(* Int[x_^m_.*(a_.*x_^j_.+b_.*x_^n_.)^p_,x_Symbol] := (x^(m-j+1)*(a*x^j+b*x^n)^(p+1))/(a*(m+j*p+1))*Hypergeometric2F1[1,( m+n*p+1)/(n-j)+1,(m+j*p+1)/(n-j)+1,-b*x^(n-j)/a] /; FreeQ[{a,b,j,m,n,p},x] && NeQ[n,j] && NeQ[m+j*p+1,0] &&  NeQ[m+n+(p-1)*j+1,0] *)
Int[(c_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^n_.)^p_, x_Symbol] := c^IntPart[m]*(c*x)^FracPart[m]*(a*x^j + b*x^n)^FracPart[p]/ (x^(FracPart[m] + j*FracPart[p])*(a + b*x^(n - j))^ FracPart[p])* Int[x^(m + j*p)*(a + b*x^(n - j))^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && Not[IntegerQ[p]] && NeQ[n, j] && PosQ[n - j]
Int[u_^m_.*(a_.*v_^j_. + b_.*v_^n_.)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(a*x^j + b*x^n)^p, x], x, v] /; FreeQ[{a, b, j, m, n, p}, x] && LinearPairQ[u, v, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.4 Improper/1.1.4.3 (e x)^m (a x^j+b x^k)^p (c+d x^n)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.4.3 (e x)^m (a x^j+b x^k)^p (c+d x^n)^q *)
Int[x_^m_.*(a_.*x_^j_ + b_.*x_^k_.)^p_*(c_ + d_.*x_^n_)^q_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a*x^Simplify[j/n] + b*x^Simplify[k/n])^p*(c + d*x)^q, x], x, x^n] /; FreeQ[{a, b, c, d, j, k, m, n, p, q}, x] && Not[IntegerQ[p]] && NeQ[k, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[k/n]] && IntegerQ[Simplify[(m + 1)/n]] && NeQ[n^2, 1]
Int[(e_*x_)^m_.*(a_.*x_^j_ + b_.*x_^k_.)^p_*(c_ + d_.*x_^n_.)^q_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a*x^j + b*x^k)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, j, k, m, n, p, q}, x] && Not[IntegerQ[p]] && NeQ[k, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[k/n]] && IntegerQ[Simplify[(m + 1)/n]] && NeQ[n^2, 1]
Int[(e_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^jn_.)^p_*(c_ + d_.*x_^n_.), x_Symbol] := c*e^(j - 1)*(e*x)^(m - j + 1)*(a*x^j + b*x^(j + n))^(p + 1)/(a*(m + j*p + 1)) /; FreeQ[{a, b, c, d, e, j, m, n, p}, x] && EqQ[jn, j + n] && Not[IntegerQ[p]] && NeQ[b*c - a*d, 0] && EqQ[a*d*(m + j*p + 1) - b*c*(m + n + p*(j + n) + 1), 0] && (GtQ[e, 0] || IntegersQ[j]) && NeQ[m + j*p + 1, 0]
Int[(e_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^jn_.)^p_*(c_ + d_.*x_^n_.), x_Symbol] := -e^(j - 1)*(b*c - a*d)*(e*x)^(m - j + 1)*(a*x^j + b*x^(j + n))^(p + 1)/(a*b* n*(p + 1)) - e^j*(a*d*(m + j*p + 1) - b*c*(m + n + p*(j + n) + 1))/(a*b* n*(p + 1))* Int[(e*x)^(m - j)*(a*x^j + b*x^(j + n))^(p + 1), x] /; FreeQ[{a, b, c, d, e, j, m, n}, x] && EqQ[jn, j + n] && Not[IntegerQ[p]] && NeQ[b*c - a*d, 0] && LtQ[p, -1] && GtQ[j, 0] && LeQ[j, m] && (GtQ[e, 0] || IntegerQ[j])
Int[(e_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^jn_.)^p_*(c_ + d_.*x_^n_.), x_Symbol] := c*e^(j - 1)*(e*x)^(m - j + 1)*(a*x^j + b*x^(j + n))^(p + 1)/(a*(m + j*p + 1)) + (a*d*(m + j*p + 1) - b*c*(m + n + p*(j + n) + 1))/(a* e^n*(m + j*p + 1))* Int[(e*x)^(m + n)*(a*x^j + b*x^(j + n))^p, x] /; FreeQ[{a, b, c, d, e, j, p}, x] && EqQ[jn, j + n] && Not[IntegerQ[p]] && NeQ[b*c - a*d, 0] && GtQ[n, 0] && (LtQ[m + j*p, -1] || IntegersQ[m - 1/2, p - 1/2] && LtQ[p, 0] && LtQ[m, -n*p - 1]) && (GtQ[e, 0] || IntegersQ[j, n]) && NeQ[m + j*p + 1, 0] && NeQ[m - n + j*p + 1, 0]
Int[(e_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^jn_.)^p_*(c_ + d_.*x_^n_.), x_Symbol] := d*e^(j - 1)*(e*x)^(m - j + 1)*(a*x^j + b*x^(j + n))^(p + 1)/(b*(m + n + p*(j + n) + 1)) - (a*d*(m + j*p + 1) - b*c*(m + n + p*(j + n) + 1))/(b*(m + n + p*(j + n) + 1))* Int[(e*x)^m*(a*x^j + b*x^(j + n))^p, x] /; FreeQ[{a, b, c, d, e, j, m, n, p}, x] && EqQ[jn, j + n] && Not[IntegerQ[p]] && NeQ[b*c - a*d, 0] && NeQ[m + n + p*(j + n) + 1, 0] && (GtQ[e, 0] || IntegerQ[j])
Int[x_^m_.*(a_.*x_^j_ + b_.*x_^k_.)^p_*(c_ + d_.*x_^n_.)^q_., x_Symbol] := 1/(m + 1)* Subst[Int[(a*x^Simplify[j/(m + 1)] + b*x^Simplify[k/(m + 1)])^ p*(c + d*x^Simplify[n/(m + 1)])^q, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, j, k, m, n, p, q}, x] && Not[IntegerQ[p]] && NeQ[k, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[k/n]] && NeQ[m, -1] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(e_*x_)^m_.*(a_.*x_^j_ + b_.*x_^k_.)^p_*(c_ + d_.*x_^n_.)^q_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a*x^j + b*x^k)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, j, k, m, n, p, q}, x] && Not[IntegerQ[p]] && NeQ[k, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[k/n]] && NeQ[m, -1] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(e_.*x_)^m_.*(a_.*x_^j_. + b_.*x_^jn_.)^p_*(c_ + d_.*x_^n_.)^q_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]*(a*x^j + b*x^(j + n))^FracPart[p]/ (x^(FracPart[m] + j*FracPart[p])*(a + b*x^n)^FracPart[p])* Int[x^(m + j*p)*(a + b*x^n)^p*(c + d*x^n)^q, x] /; FreeQ[{a, b, c, d, e, j, m, n, p, q}, x] && EqQ[jn, j + n] && Not[IntegerQ[p]] && NeQ[b*c - a*d, 0] && Not[EqQ[n, 1] && EqQ[j, 1]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.1 Binomial products/1.1.4 Improper/1.1.4.4 P(x) (c x)^m (a x^j+b x^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.1.4.4 P(x) (c x)^m (a x^j+b x^n)^p *)
Int[Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := With[{d = Denominator[n]}, d*Subst[ Int[x^(d - 1)* ReplaceAll[SubstFor[x^n, Pq, x], x -> x^(d*n)]*(a*x^(d*j) + b*x^(d*n))^p, x], x, x^(1/d)]] /; FreeQ[{a, b, j, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && RationalQ[j, n] && IntegerQ[j/n] && LtQ[-1, n, 1]
Int[x_^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)* SubstFor[x^n, Pq, x]*(a*x^Simplify[j/n] + b*x)^p, x], x, x^n] /; FreeQ[{a, b, j, m, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[(m + 1)/n]]
Int[(c_*x_)^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := c^(Sign[m]*Quotient[m, Sign[m]])*(c*x)^Mod[m, Sign[m]]/ x^Mod[m, Sign[m]]*Int[x^m*Pq*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[(m + 1)/n]] && RationalQ[m] && GtQ[m^2, 1]
Int[(c_*x_)^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := (c*x)^m/x^m*Int[x^m*Pq*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := With[{g = GCD[m + 1, n]}, 1/g* Subst[Int[ x^((m + 1)/g - 1)* ReplaceAll[Pq, x -> x^(1/g)]*(a*x^(j/g) + b*x^(n/g))^p, x], x, x^g] /; NeQ[g, 1]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && IGtQ[j, 0] && IGtQ[n, 0] && IGtQ[j/n, 0] && IntegerQ[m]
Int[(c_.*x_)^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, Pqq*(c*x)^(m + q - n + 1)*(a*x^j + b*x^n)^(p + 1)/(b* c^(q - n + 1)*(m + q + n*p + 1)) + Int[(c*x)^m* ExpandToSum[ Pq - Pqq*x^q - a*Pqq*(m + q - n + 1)*x^(q - n)/(b*(m + q + n*p + 1)), x]*(a*x^j + b*x^n)^p, x]] /; GtQ[q, n - 1] && NeQ[m + q + n*p + 1, 0] && (IntegerQ[2*p] || IntegerQ[p + (q + 1)/(2*n)])] /; FreeQ[{a, b, c, m, p}, x] && PolyQ[Pq, x] && Not[IntegerQ[p]] && IGtQ[j, 0] && IGtQ[n, 0] && LtQ[j, n]
Int[x_^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := 1/(m + 1)*Subst[ Int[ ReplaceAll[SubstFor[x^n, Pq, x], x -> x^Simplify[n/(m + 1)]]*(a*x^Simplify[j/(m + 1)] + b*x^Simplify[n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, j, m, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_*x_)^m_*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := c^(Sign[m]*Quotient[m, Sign[m]])*(c*x)^Mod[m, Sign[m]]/ x^Mod[m, Sign[m]]*Int[x^m*Pq*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]] && GtQ[m^2, 1]
Int[(c_*x_)^m_*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := (c*x)^m/x^m*Int[x^m*Pq*(a*x^j + b*x^n)^p, x] /; FreeQ[{a, b, c, j, m, n, p}, x] && PolyQ[Pq, x^n] && Not[IntegerQ[p]] && NeQ[n, j] && IntegerQ[Simplify[j/n]] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(c_.*x_)^m_.*Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := Int[ExpandIntegrand[(c*x)^m*Pq*(a*x^j + b*x^n)^p, x], x] /; FreeQ[{a, b, c, j, m, n, p}, x] && (PolyQ[Pq, x] || PolyQ[Pq, x^n]) && Not[IntegerQ[p]] && NeQ[n, j]
Int[Pq_*(a_.*x_^j_. + b_.*x_^n_)^p_, x_Symbol] := Int[ExpandIntegrand[Pq*(a*x^j + b*x^n)^p, x], x] /; FreeQ[{a, b, j, n, p}, x] && (PolyQ[Pq, x] || PolyQ[Pq, x^n]) && Not[IntegerQ[p]] && NeQ[n, j]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.1 (a+b x+c x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.1 (a+b x+c x^2)^p *)
Int[(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := 2*(a + b*x + c*x^2)^(p + 1)/((2*p + 1)*(b + 2*c*x)) /; FreeQ[{a, b, c, p}, x] && EqQ[b^2 - 4*a*c, 0] && LtQ[p, -1]
Int[1/Sqrt[a_ + b_.*x_ + c_.*x_^2], x_Symbol] := (b/2 + c*x)/Sqrt[a + b*x + c*x^2]*Int[1/(b/2 + c*x), x] /; FreeQ[{a, b, c}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (b + 2*c*x)*(a + b*x + c*x^2)^p/(2*c*(2*p + 1)) /; FreeQ[{a, b, c, p}, x] && EqQ[b^2 - 4*a*c, 0] && NeQ[p, -1/2]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 1/c^p* Int[Simp[b/2 - q/2 + c*x, x]^p*Simp[b/2 + q/2 + c*x, x]^p, x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && PerfectSquareQ[b^2 - 4*a*c]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && (EqQ[a, 0] || Not[PerfectSquareQ[b^2 - 4*a*c]])
Int[(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (b + 2*c*x)*(a + b*x + c*x^2)^p/(2*c*(2*p + 1)) - p*(b^2 - 4*a*c)/(2*c*(2*p + 1))* Int[(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && IntegerQ[4*p]
Int[1/(a_. + b_.*x_ + c_.*x_^2)^(3/2), x_Symbol] := -2*(b + 2*c*x)/((b^2 - 4*a*c)*Sqrt[a + b*x + c*x^2]) /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (b + 2*c*x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) - 2*c*(2*p + 3)/((p + 1)*(b^2 - 4*a*c))* Int[(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && NeQ[p, -3/2] && IntegerQ[4*p]
Int[1/(b_.*x_ + c_.*x_^2), x_Symbol] := Log[x]/b - Log[RemoveContent[b + c*x, x]]/b /; FreeQ[{b, c}, x]
Int[1/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, c/q*Int[1/Simp[b/2 - q/2 + c*x, x], x] - c/q*Int[1/Simp[b/2 + q/2 + c*x, x], x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[b^2 - 4*a*c] && PerfectSquareQ[b^2 - 4*a*c]
Int[1/(a_ + b_.*x_ + c_.*x_^2), x_Symbol] := With[{q = 1 - 4*Simplify[a*c/b^2]}, -2/b*Subst[Int[1/(q - x^2), x], x, 1 + 2*c*x/b] /; RationalQ[q] && (EqQ[q^2, 1] || Not[RationalQ[b^2 - 4*a*c]])] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[1/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := -2*Subst[Int[1/Simp[b^2 - 4*a*c - x^2, x], x], x, b + 2*c*x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := 1/(2*c*(-4*c/(b^2 - 4*a*c))^p)* Subst[Int[Simp[1 - x^2/(b^2 - 4*a*c), x]^p, x], x, b + 2*c*x] /; FreeQ[{a, b, c, p}, x] && GtQ[4*a - b^2/c, 0]
Int[1/Sqrt[b_.*x_ + c_.*x_^2], x_Symbol] := 2*Subst[Int[1/(1 - c*x^2), x], x, x/Sqrt[b*x + c*x^2]] /; FreeQ[{b, c}, x]
Int[1/Sqrt[a_ + b_.*x_ + c_.*x_^2], x_Symbol] := 2*Subst[Int[1/(4*c - x^2), x], x, (b + 2*c*x)/Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (b*x + c*x^2)^p/(-c*(b*x + c*x^2)/(b^2))^p* Int[(-c*x/b - c^2*x^2/b^2)^p, x] /; FreeQ[{b, c}, x] && RationalQ[p] && 3 <= Denominator[p] <= 4
(* Int[(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] := (a+b*x+c*x^2)^p/(-c*(a+b*x+c*x^2)/(b^2-4*a*c))^p*Int[(-a*c/(b^2-4*a* c)-b*c*x/(b^2-4*a*c)-c^2*x^2/(b^2-4*a*c))^p,x] /; FreeQ[{a,b,c},x] && NeQ[b^2-4*a*c,0] && RationalQ[p] &&  3<=Denominator[p]<=4 *)
Int[(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{d = Denominator[p]}, d*Sqrt[(b + 2*c*x)^2]/(b + 2*c*x)* Subst[Int[x^(d*(p + 1) - 1)/Sqrt[b^2 - 4*a*c + 4*c*x^d], x], x, (a + b*x + c*x^2)^(1/d)] /; 3 <= d <= 4] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && RationalQ[p]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -(a + b*x + c*x^2)^(p + 1)/(q*(p + 1)*((q - b - 2*c*x)/(2*q))^(p + 1))* Hypergeometric2F1[-p, p + 1, p + 2, (b + q + 2*c*x)/(2*q)]] /; FreeQ[{a, b, c, p}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[4*p]]
Int[(a_. + b_.*u_ + c_.*u_^2)^p_, x_Symbol] := 1/Coefficient[u, x, 1]*Subst[Int[(a + b*x + c*x^2)^p, x], x, u] /; FreeQ[{a, b, c, p}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.2 (d+e x)^m (a+b x+c x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.2 (d+e x)^m (a+b x+c x^2)^p *)
(* Int[(d_.+e_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] := 1/c^p*Int[(d+e*x)^m*(b/2+c*x)^(2*p),x] /; FreeQ[{a,b,c,d,e,m},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_)^m_.*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && (IntegerQ[p] || GtQ[a, 0] && GtQ[d, 0] && IntegerQ[m + p])
Int[(d_ + e_.*x_)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := d*Log[RemoveContent[a + b*x + c*x^2, x]]/b /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[(d_ + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := d*(a + b*x + c*x^2)^(p + 1)/(b*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[2*c*d - b*e, 0] && NeQ[p, -1]
Int[(d_ + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(p + 1)*(a/d + c/e*x)^p, x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && IGtQ[p, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0]
Int[(d_. + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && IntegerQ[p] && (GtQ[p, 0] || EqQ[a, 0])
Int[(d_. + e_.*x_)/(a_ + b_.*x_ + c_.*x_^2), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (c*d - e*(b/2 - q/2))/q* Int[1/(b/2 - q/2 + c*x), x] - (c*d - e*(b/2 + q/2))/q* Int[1/(b/2 + q/2 + c*x), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && NeQ[b^2 - 4*a*c, 0] && NiceSqrtQ[b^2 - 4*a*c]
Int[(d_ + e_.*x_)/(a_ + c_.*x_^2), x_Symbol] := With[{q = Rt[-a*c, 2]}, (e/2 + c*d/(2*q))*Int[1/(-q + c*x), x] + (e/2 - c*d/(2*q))* Int[1/(q + c*x), x]] /; FreeQ[{a, c, d, e}, x] && NiceSqrtQ[-a*c]
Int[(d_. + e_.*x_)/(a_ + b_.*x_ + c_.*x_^2), x_Symbol] := (* (d-b*e/(2*c))*Int[1/(a+b*x+c*x^2),x] + *) (2*c*d - b*e)/(2*c)*Int[1/(a + b*x + c*x^2), x] + e/(2*c)*Int[(b + 2*c*x)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && NeQ[b^2 - 4*a*c, 0] && Not[NiceSqrtQ[b^2 - 4*a*c]]
Int[(d_ + e_.*x_)/(a_ + c_.*x_^2), x_Symbol] := d*Int[1/(a + c*x^2), x] + e*Int[x/(a + c*x^2), x] /; FreeQ[{a, c, d, e}, x] && Not[NiceSqrtQ[-a*c]]
Int[(d_. + e_.*x_)/(a_. + b_.*x_ + c_.*x_^2)^(3/2), x_Symbol] := -2*(b*d - 2*a*e + (2*c*d - b*e)*x)/((b^2 - 4*a*c)* Sqrt[a + b*x + c*x^2]) /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && NeQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_)/(a_ + c_.*x_^2)^(3/2), x_Symbol] := (-a*e + c*d*x)/(a*c*Sqrt[a + c*x^2]) /; FreeQ[{a, c, d, e}, x]
Int[(d_. + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (b*d - 2*a*e + (2*c*d - b*e)*x)/((p + 1)*(b^2 - 4*a*c))*(a + b*x + c*x^2)^(p + 1) - (2*p + 3)*(2*c*d - b*e)/((p + 1)*(b^2 - 4*a*c))* Int[(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(d_ + e_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (a*e - c*d*x)/(2*a*c*(p + 1))*(a + c*x^2)^(p + 1) + d*(2*p + 3)/(2*a*(p + 1))*Int[(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(d_. + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(a + b*x + c*x^2)^(p + 1)/(2*c*(p + 1)) + (2*c*d - b*e)/(2*c)* Int[(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[2*c*d - b*e, 0] && NeQ[p, -1]
Int[(d_ + e_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := e*(a + c*x^2)^(p + 1)/(2*c*(p + 1)) + d*Int[(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, p}, x] && NeQ[p, -1]
Int[(d_ + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e^m/c^(m/2)*Int[(a + b*x + c*x^2)^(p + m/2), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[2*c*d - b*e, 0] && IntegerQ[m/2]
Int[(d_ + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e^(m - 1)/c^((m - 1)/2)* Int[(d + e*x)*(a + b*x + c*x^2)^(p + (m - 1)/2), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[2*c*d - b*e, 0] && IntegerQ[(m - 1)/2]
Int[(d_ + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^p/(d + e*x)^(2*p)*Int[(d + e*x)^(m + 2*p), x] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[2*c*d - b*e, 0] && Not[IntegerQ[m]]
Int[(d_. + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x)^(2*FracPart[p]))* Int[ ExpandLinearProduct[(b/2 + c*x)^(2*p), (d + e*x)^m, b/2, c, x], x] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && NeQ[2*c*d - b*e, 0] && IGtQ[m, 0] && EqQ[m - 2*p + 1, 0]
Int[(d_. + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x)^(2*FracPart[p]))* Int[(d + e*x)^m*(b/2 + c*x)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && NeQ[2*c*d - b*e, 0]
Int[(e_.*x_)^m_.*(b_.*x_ + c_.*x_^2)^p_., x_Symbol] := 1/e^p*Int[(e*x)^(m + p)*(b + c*x)^p, x] /; FreeQ[{b, c, e, m}, x] && IntegerQ[p]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)) /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)/(c*(p + 1)) /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(2*c*d - b*e)) /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + 2*p + 2, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*c*d*(p + 1)) /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + 2*p + 2, 0]
Int[(d_. + e_.*x_)^2*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)) - e^2*(p + 2)/(c*(p + 1))*Int[(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && LtQ[p, -1]
Int[(d_ + e_.*x_)^2*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)*(a + c*x^2)^(p + 1)/(c*(p + 1)) - e^2*(p + 2)/(c*(p + 1))*Int[(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && LtQ[p, -1]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[(a + b*x + c*x^2)^(m + p)/(a/d + c*x/e)^m, x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && IntegerQ[m] && RationalQ[p] && (LtQ[0, -m, p] || LtQ[p, -m, 0]) && NeQ[m, 2] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := d^(2*m)/a^m*Int[(a + c*x^2)^(m + p)/(d - e*x)^m, x] /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && IntegerQ[m] && RationalQ[p] && (LtQ[0, -m, p] || LtQ[p, -m, 0]) && NeQ[m, 2] && NeQ[m, -1]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 1)) + Simplify[m + p]*(2*c*d - b*e)/(c*(m + 2*p + 1))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && IGtQ[Simplify[m + p], 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)/(c*(m + 2*p + 1)) + 2*c*d*Simplify[m + p]/(c*(m + 2*p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && IGtQ[Simplify[m + p], 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/((m + p + 1)*(2*c*d - b*e)) + c*Simplify[m + 2*p + 2]/((m + p + 1)*(2*c*d - b*e))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[Simplify[m + 2*p + 2], 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*c*d*(m + p + 1)) + Simplify[m + 2*p + 2]/(2*d*(m + p + 1))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[Simplify[m + 2*p + 2], 0]
Int[1/(Sqrt[d_. + e_.*x_]*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := 2*e*Subst[Int[1/(2*c*d - b*e + e^2*x^2), x], x, Sqrt[a + b*x + c*x^2]/Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0]
Int[1/(Sqrt[d_ + e_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := 2*e*Subst[Int[1/(2*c*d + e^2*x^2), x], x, Sqrt[a + c*x^2]/Sqrt[d + e*x]] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/(e*(m + p + 1)) - c*p/(e^2*(m + p + 1))* Int[(d + e*x)^(m + 2)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[p, 0] && (LtQ[m, -2] || EqQ[m + 2*p + 1, 0]) && NeQ[m + p + 1, 0] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + c*x^2)^p/(e*(m + p + 1)) - c*p/(e^2*(m + p + 1))* Int[(d + e*x)^(m + 2)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && (LtQ[m, -2] || EqQ[m + 2*p + 1, 0]) && NeQ[m + p + 1, 0] && IntegerQ[2*p]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/(e*(m + 2*p + 1)) - p*(2*c*d - b*e)/(e^2*(m + 2*p + 1))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[p, 0] && (LeQ[-2, m, 0] || EqQ[m + p + 1, 0]) && NeQ[m + 2*p + 1, 0] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + c*x^2)^p/(e*(m + 2*p + 1)) - 2*c*d*p/(e^2*(m + 2*p + 1))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && (LeQ[-2, m, 0] || EqQ[m + p + 1, 0]) && NeQ[m + 2*p + 1, 0] && IntegerQ[2*p]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (2*c*d - b*e)*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/(e*(p + 1)*(b^2 - 4*a*c)) - (2*c*d - b*e)*(m + 2*p + 2)/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && LtQ[0, m, 1] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -d*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*a*e*(p + 1)) + d*(m + 2*p + 2)/(2*a*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && LtQ[0, m, 1] && IntegerQ[2*p]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)) - e^2*(m + p)/(c*(p + 1))* Int[(d + e*x)^(m - 2)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 1] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)/(c*(p + 1)) - e^2*(m + p)/(c*(p + 1))* Int[(d + e*x)^(m - 2)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 1] && IntegerQ[2*p]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 1)) + (m + p)*(2*c*d - b*e)/(c*(m + 2*p + 1))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[m, 1] && NeQ[m + 2*p + 1, 0] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)/(c*(m + 2*p + 1)) + 2*c*d*(m + p)/(c*(m + 2*p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, p}, x] && EqQ[c*d^2 + a*e^2, 0] && GtQ[m, 1] && NeQ[m + 2*p + 1, 0] && IntegerQ[2*p]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/((m + p + 1)*(2*c*d - b*e)) + c*(m + 2*p + 2)/((m + p + 1)*(2*c*d - b*e))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[m, 0] && NeQ[m + p + 1, 0] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*c*d*(m + p + 1)) + (m + 2*p + 2)/(2*d*(m + p + 1))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, p}, x] && EqQ[c*d^2 + a*e^2, 0] && LtQ[m, 0] && NeQ[m + p + 1, 0] && IntegerQ[2*p]
Int[(e_.*x_)^m_*(b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (e*x)^m*(b*x + c*x^2)^p/(x^(m + p)*(b + c*x)^p)* Int[x^(m + p)*(b + c*x)^p, x] /; FreeQ[{b, c, e, m}, x] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && GtQ[a, 0] && GtQ[d, 0] && Not[IGtQ[m, 0]]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := a^(p + 1)*d^(m - 1)*((d - e*x)/d)^(p + 1)/(a/d + c*x/e)^(p + 1)* Int[(1 + e*x/d)^(m + p)*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, m}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && (IntegerQ[m] || GtQ[d, 0]) && GtQ[a, 0] && Not[IGtQ[m, 0] && (IntegerQ[3*p] || IntegerQ[4*p])]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := d^m*(a + b*x + c*x^2)^ FracPart[ p]/((1 + e*x/d)^FracPart[p]*(a/d + (c*x)/e)^FracPart[p])* Int[(1 + e*x/d)^(m + p)*(a/d + c/e*x)^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && (IntegerQ[m] || GtQ[d, 0]) && Not[IGtQ[m, 0] && (IntegerQ[3*p] || IntegerQ[4*p])]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := d^(m - 1)*(a + c*x^2)^(p + 1)/((1 + e*x/d)^(p + 1)*(a/d + (c*x)/e)^(p + 1))* Int[(1 + e*x/d)^(m + p)*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, m}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && (IntegerQ[m] || GtQ[d, 0]) && Not[IGtQ[m, 0] && (IntegerQ[3*p] || IntegerQ[4*p])]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := d^IntPart[m]*(d + e*x)^FracPart[m]/(1 + e*x/d)^FracPart[m]* Int[(1 + e*x/d)^m*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && Not[IntegerQ[m] || GtQ[d, 0]]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := d^IntPart[m]*(d + e*x)^FracPart[m]/(1 + e*x/d)^FracPart[m]* Int[(1 + e*x/d)^m*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && Not[IntegerQ[m] || GtQ[d, 0]]
Int[1/((d_ + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)), x_Symbol] := -4*b*c/(d*(b^2 - 4*a*c))*Int[1/(b + 2*c*x), x] + b^2/(d^2*(b^2 - 4*a*c))*Int[(d + e*x)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := 2*c*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(e*(p + 1)*(b^2 - 4*a*c)) /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && EqQ[m + 2*p + 3, 0] && NeQ[p, -1]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && IGtQ[p, 0] && Not[EqQ[m, 3] && NeQ[p, 1]]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/(e*(m + 1)) - b*p/(d*e*(m + 1))* Int[(d + e*x)^(m + 2)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && NeQ[m + 2*p + 3, 0] && GtQ[p, 0] && LtQ[m, -1] && Not[IntegerQ[m/2] && LtQ[m + 2*p + 3, 0]] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/(e*(m + 2*p + 1)) - d*p*(b^2 - 4*a*c)/(b*e*(m + 2*p + 1))* Int[(d + e*x)^m*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && NeQ[m + 2*p + 3, 0] && GtQ[p, 0] && Not[LtQ[m, -1]] && Not[IGtQ[(m - 1)/2, 0] && (Not[IntegerQ[p]] || LtQ[m, 2*p])] && RationalQ[m] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := d*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(b*(p + 1)) - d*e*(m - 1)/(b*(p + 1))* Int[(d + e*x)^(m - 2)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && NeQ[m + 2*p + 3, 0] && LtQ[p, -1] && GtQ[m, 1] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := 2*c*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(e*(p + 1)*(b^2 - 4*a*c)) - 2*c*e*(m + 2*p + 3)/(e*(p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^m*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && NeQ[m + 2*p + 3, 0] && LtQ[p, -1] && Not[GtQ[m, 1]] && RationalQ[m] && IntegerQ[2*p]
Int[1/((d_ + e_.*x_)*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := 4*c*Subst[Int[1/(b^2*e - 4*a*c*e + 4*c*e*x^2), x], x, Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0]
Int[1/(Sqrt[d_ + e_.*x_]*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := 4/e*Sqrt[-c/(b^2 - 4*a*c)]* Subst[Int[1/Sqrt[Simp[1 - b^2*x^4/(d^2*(b^2 - 4*a*c)), x]], x], x, Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && LtQ[c/(b^2 - 4*a*c), 0]
Int[Sqrt[d_ + e_.*x_]/Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := 4/e*Sqrt[-c/(b^2 - 4*a*c)]* Subst[Int[x^2/Sqrt[Simp[1 - b^2*x^4/(d^2*(b^2 - 4*a*c)), x]], x], x, Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && LtQ[c/(b^2 - 4*a*c), 0]
Int[(d_ + e_.*x_)^m_/Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Sqrt[-c*(a + b*x + c*x^2)/(b^2 - 4*a*c)]/Sqrt[a + b*x + c*x^2]* Int[(d + e*x)^m/ Sqrt[-a*c/(b^2 - 4*a*c) - b*c*x/(b^2 - 4*a*c) - c^2*x^2/(b^2 - 4*a*c)], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && EqQ[m^2, 1/4]
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := 2*d*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(b*(m + 2*p + 1)) + d^2*(m - 1)*(b^2 - 4*a*c)/(b^2*(m + 2*p + 1))* Int[(d + e*x)^(m - 2)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && NeQ[m + 2*p + 3, 0] && GtQ[m, 1] && NeQ[m + 2*p + 1, 0] && (IntegerQ[2*p] || IntegerQ[m] && RationalQ[p] || OddQ[m])
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := -2*b*d*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(d^2*(m + 1)*(b^2 - 4*a*c)) + b^2*(m + 2*p + 3)/(d^2*(m + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m + 2)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0] && NeQ[m + 2*p + 3, 0] && LtQ[m, -1] && (IntegerQ[2*p] || IntegerQ[m] && RationalQ[p] || IntegerQ[(m + 2*p + 3)/2])
Int[(d_ + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := 1/e*Subst[Int[x^m*(a - b^2/(4*c) + (c*x^2)/e^2)^p, x], x, d + e*x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*c*d - b*e, 0]
Int[1/((d_ + e_.*x_)*(a_. + c_.*x_^2)^(1/4)), x_Symbol] := 1/(2*(-a)^(1/4)*e)* ArcTan[(-1 - c*x^2/a)^(1/4)/(1 - c*d*x/(2*a*e) - Sqrt[-1 - c*x^2/a])] + 1/(4*(-a)^(1/4)*e)* Log[(1 - c*d*x/(2*a*e) + Sqrt[-1 - c*x^2/a] - (-1 - c*x^2/a)^(1/4))/ (1 - c*d*x/(2*a*e) + Sqrt[-1 - c*x^2/a] + (-1 - c*x^2/a)^(1/4))] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + 2*a*e^2, 0] && LtQ[a, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*m*d^(m - 1)*(a + c*x^2)^(p + 1)/(2*c*(p + 1)) + Int[((d + e*x)^m - e*m*d^(m - 1)*x)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 1] && IGtQ[m, 0] && LeQ[m, p]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, m}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && IntegerQ[p] && (GtQ[p, 0] || EqQ[a, 0] && IntegerQ[m])
(* Int[Sqrt[d_.+e_.*x_]/(a_.+b_.*x_+c_.*x_^2),x_Symbol] := With[{q=Rt[(c*d^2-b*d*e+a*e^2)/c,2]}, 1/2*Int[(d+q+e*x)/(Sqrt[d+e*x]*(a+b*x+c*x^2)),x] + 1/2*Int[(d-q+e*x)/(Sqrt[d+e*x]*(a+b*x+c*x^2)),x]] /; FreeQ[{a,b,c,d,e},x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] &&  NeQ[2*c*d-b*e,0] && LtQ[b^2-4*a*c,0] *)
(* Int[Sqrt[d_+e_.*x_]/(a_+c_.*x_^2),x_Symbol] := With[{q=Rt[(c*d^2+a*e^2)/c,2]}, 1/2*Int[(d+q+e*x)/(Sqrt[d+e*x]*(a+c*x^2)),x] + 1/2*Int[(d-q+e*x)/(Sqrt[d+e*x]*(a+c*x^2)),x]] /; FreeQ[{a,c,d,e},x] && NeQ[c*d^2+a*e^2,0] && LtQ[-a*c,0] *)
(* Int[Sqrt[d_.+e_.*x_]/(a_.+b_.*x_+c_.*x_^2),x_Symbol] := With[{q=Rt[b^2-4*a*c,2]}, (2*c*d-b*e+e*q)/q*Int[1/(Sqrt[d+e*x]*(b-q+2*c*x)),x] - (2*c*d-b*e-e*q)/q*Int[1/(Sqrt[d+e*x]*(b+q+2*c*x)),x]] /; FreeQ[{a,b,c,d,e},x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] &&  NeQ[2*c*d-b*e,0] (* && Not[LtQ[b^2-4*a*c,0]] *) *)
(* Int[Sqrt[d_+e_.*x_]/(a_+c_.*x_^2),x_Symbol] := With[{q=Rt[-a*c,2]}, (c*d+e*q)/(2*q)*Int[1/(Sqrt[d+e*x]*(-q+c*x)),x] - (c*d-e*q)/(2*q)*Int[1/(Sqrt[d+e*x]*(+q+c*x)),x]] /; FreeQ[{a,c,d,e},x] && NeQ[c*d^2+a*e^2,0] (* && Not[LtQ[-a*c,0]] *) *)
Int[Sqrt[d_. + e_.*x_]/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := 2*e*Subst[ Int[x^2/(c*d^2 - b*d*e + a*e^2 - (2*c*d - b*e)*x^2 + c*x^4), x], x, Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0]
Int[Sqrt[d_ + e_.*x_]/(a_ + c_.*x_^2), x_Symbol] := 2*e*Subst[Int[x^2/(c*d^2 + a*e^2 - 2*c*d*x^2 + c*x^4), x], x, Sqrt[d + e*x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^m_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Int[PolynomialDivide[(d + e*x)^m, a + b*x + c*x^2, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && IGtQ[m, 1] && (NeQ[d, 0] || GtQ[m, 2])
Int[(d_ + e_.*x_)^m_/(a_ + c_.*x_^2), x_Symbol] := Int[PolynomialDivide[(d + e*x)^m, a + c*x^2, x], x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[m, 1] && (NeQ[d, 0] || GtQ[m, 2])
Int[(d_. + e_.*x_)^m_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*(d + e*x)^(m - 1)/(c*(m - 1)) + 1/c* Int[(d + e*x)^(m - 2)* Simp[c*d^2 - a*e^2 + e*(2*c*d - b*e)*x, x]/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && GtQ[m, 1]
Int[(d_ + e_.*x_)^m_/(a_ + c_.*x_^2), x_Symbol] := e*(d + e*x)^(m - 1)/(c*(m - 1)) + 1/c* Int[(d + e*x)^(m - 2)* Simp[c*d^2 - a*e^2 + 2*c*d*e*x, x]/(a + c*x^2), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[m, 1]
Int[1/((d_. + e_.*x_)*(a_. + b_.*x_ + c_.*x_^2)), x_Symbol] := e^2/(c*d^2 - b*d*e + a*e^2)*Int[1/(d + e*x), x] + 1/(c*d^2 - b*d*e + a*e^2)* Int[(c*d - b*e - c*e*x)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0]
Int[1/((d_ + e_.*x_)*(a_ + c_.*x_^2)), x_Symbol] := e^2/(c*d^2 + a*e^2)*Int[1/(d + e*x), x] + 1/(c*d^2 + a*e^2)*Int[(c*d - c*e*x)/(a + c*x^2), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
(* Int[1/(Sqrt[d_.+e_.*x_]*(a_.+b_.*x_+c_.*x_^2)),x_Symbol] := With[{q=Rt[(c*d^2-b*d*e+a*e^2)/c,2]}, 1/(2*q)*Int[(d+q+e*x)/(Sqrt[d+e*x]*(a+b*x+c*x^2)),x] - 1/(2*q)*Int[(d-q+e*x)/(Sqrt[d+e*x]*(a+b*x+c*x^2)),x]] /; FreeQ[{a,b,c,d,e},x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] &&  NeQ[2*c*d-b*e,0] && LtQ[b^2-4*a*c,0] *)
(* Int[1/(Sqrt[d_+e_.*x_]*(a_+c_.*x_^2)),x_Symbol] := With[{q=Rt[(c*d^2+a*e^2)/c,2]}, 1/(2*q)*Int[(d+q+e*x)/(Sqrt[d+e*x]*(a+c*x^2)),x] - 1/(2*q)*Int[(d-q+e*x)/(Sqrt[d+e*x]*(a+c*x^2)),x]] /; FreeQ[{a,c,d,e},x] && NeQ[c*d^2+a*e^2,0] && LtQ[-a*c,0] *)
(* Int[1/(Sqrt[d_.+e_.*x_]*(a_.+b_.*x_+c_.*x_^2)),x_Symbol] := With[{q=Rt[b^2-4*a*c,2]}, 2*c/q*Int[1/(Sqrt[d+e*x]*(b-q+2*c*x)),x] - 2*c/q*Int[1/(Sqrt[d+e*x]*(b+q+2*c*x)),x]] /; FreeQ[{a,b,c,d,e},x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] &&  NeQ[2*c*d-b*e,0] (* && Not[LtQ[b^2-4*a*c,0]] *) *)
(* Int[1/(Sqrt[d_+e_.*x_]*(a_+c_.*x_^2)),x_Symbol] := With[{q=Rt[-a*c,2]}, c/(2*q)*Int[1/(Sqrt[d+e*x]*(-q+c*x)),x] - c/(2*q)*Int[1/(Sqrt[d+e*x]*(q+c*x)),x]] /; FreeQ[{a,c,d,e},x] && NeQ[c*d^2+a*e^2,0] (* && Not[LtQ[-a*c,0]] *) *)
Int[1/(Sqrt[d_. + e_.*x_]*(a_. + b_.*x_ + c_.*x_^2)), x_Symbol] := 2*e*Subst[ Int[1/(c*d^2 - b*d*e + a*e^2 - (2*c*d - b*e)*x^2 + c*x^4), x], x, Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0]
Int[1/(Sqrt[d_ + e_.*x_]*(a_ + c_.*x_^2)), x_Symbol] := 2*e*Subst[Int[1/(c*d^2 + a*e^2 - 2*c*d*x^2 + c*x^4), x], x, Sqrt[d + e*x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^m_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*(d + e*x)^(m + 1)/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/(c*d^2 - b*d*e + a*e^2)* Int[(d + e*x)^(m + 1)* Simp[c*d - b*e - c*e*x, x]/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && LtQ[m, -1]
Int[(d_ + e_.*x_)^m_/(a_ + c_.*x_^2), x_Symbol] := e*(d + e*x)^(m + 1)/((m + 1)*(c*d^2 + a*e^2)) + c/(c*d^2 + a*e^2)* Int[(d + e*x)^(m + 1)*(d - e*x)/(a + c*x^2), x] /; FreeQ[{a, c, d, e, m}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m, 1/(a + b*x + c*x^2), x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && Not[IntegerQ[m]]
Int[(d_ + e_.*x_)^m_/(a_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m, 1/(a + c*x^2), x], x] /; FreeQ[{a, c, d, e, m}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[m]]
Int[(d_. + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ FracPart[p]*(a + b*x + c*x^2)^FracPart[p]/(a*d + c*e*x^3)^ FracPart[p]*Int[(d + e*x)^(m - p)*(a*d + c*e*x^3)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[b*d + a*e, 0] && EqQ[c*d + b*e, 0] && IGtQ[m - p + 1, 0] && Not[IntegerQ[p]]
Int[(d_. + e_.*x_)^m_/Sqrt[b_.*x_ + c_.*x_^2], x_Symbol] := Int[(d + e*x)^m/(Sqrt[b*x]*Sqrt[1 + c/b*x]), x] /; FreeQ[{b, c, d, e}, x] && NeQ[c*d - b*e, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m^2, 1/4] && LtQ[c, 0] && RationalQ[b]
Int[(d_. + e_.*x_)^m_/Sqrt[b_.*x_ + c_.*x_^2], x_Symbol] := Sqrt[x]*Sqrt[b + c*x]/Sqrt[b*x + c*x^2]* Int[(d + e*x)^m/(Sqrt[x]*Sqrt[b + c*x]), x] /; FreeQ[{b, c, d, e}, x] && NeQ[c*d - b*e, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m^2, 1/4]
Int[x_^m_/Sqrt[a_ + b_.*x_ + c_.*x_^2], x_Symbol] := 2*Subst[Int[x^(2*m + 1)/Sqrt[a + b*x^2 + c*x^4], x], x, Sqrt[x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[m^2, 1/4]
Int[(e_*x_)^m_/Sqrt[a_ + b_.*x_ + c_.*x_^2], x_Symbol] := (e*x)^m/x^m*Int[x^m/Sqrt[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[m^2, 1/4]
Int[(d_. + e_.*x_)^m_/Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := 2*Rt[b^2 - 4*a*c, 2]*(d + e*x)^m* Sqrt[-c*(a + b*x + c*x^2)/(b^2 - 4*a*c)]/ (c* Sqrt[a + b*x + c*x^2]*(2*c*(d + e*x)/(2*c*d - b*e - e*Rt[b^2 - 4*a*c, 2]))^m)* Subst[ Int[(1 + 2*e*Rt[b^2 - 4*a*c, 2]* x^2/(2*c*d - b*e - e*Rt[b^2 - 4*a*c, 2]))^m/Sqrt[1 - x^2], x], x, Sqrt[(b + Rt[b^2 - 4*a*c, 2] + 2*c*x)/(2*Rt[b^2 - 4*a*c, 2])]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m^2, 1/4]
Int[(d_ + e_.*x_)^m_/Sqrt[a_ + c_.*x_^2], x_Symbol] := 2*a*Rt[-c/a, 2]*(d + e*x)^m* Sqrt[1 + c*x^2/a]/(c* Sqrt[a + c*x^2]*(c*(d + e*x)/(c*d - a*e*Rt[-c/a, 2]))^m)* Subst[ Int[(1 + 2*a*e*Rt[-c/a, 2]*x^2/(c*d - a*e*Rt[-c/a, 2]))^m/ Sqrt[1 - x^2], x], x, Sqrt[(1 - Rt[-c/a, 2]*x)/2]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[m^2, 1/4]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^(m + 1)*(d*b - 2*a*e + (2*c*d - b*e)*x)*(a + b*x + c*x^2)^ p/(2*(m + 1)*(c*d^2 - b*d*e + a*e^2)) + p*(b^2 - 4*a*c)/(2*(m + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 2)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m + 2*p + 2, 0] && GtQ[p, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^(m + 1)*(-2*a*e + (2*c*d)*x)*(a + c*x^2)^ p/(2*(m + 1)*(c*d^2 + a*e^2)) - 4*a*c*p/(2*(m + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 2)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[m + 2*p + 2, 0] && GtQ[p, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m - 1)*(d*b - 2*a*e + (2*c*d - b*e)* x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) - 2*(2*p + 3)*(c*d^2 - b*d*e + a*e^2)/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 2)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m + 2*p + 2, 0] && LtQ[p, -1]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m - 1)*(a*e - c*d*x)*(a + c*x^2)^(p + 1)/(2*a*c*(p + 1)) + (2*p + 3)*(c*d^2 + a*e^2)/(2*a*c*(p + 1))* Int[(d + e*x)^(m - 2)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[m + 2*p + 2, 0] && LtQ[p, -1]
Int[1/((d_. + e_.*x_)*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := -2*Subst[Int[1/(4*c*d^2 - 4*b*d*e + 4*a*e^2 - x^2), x], x, (2*a*e - b*d - (2*c*d - b*e)*x)/Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[2*c*d - b*e, 0]
Int[1/((d_ + e_.*x_)*Sqrt[a_ + c_.*x_^2]), x_Symbol] := -Subst[Int[1/(c*d^2 + a*e^2 - x^2), x], x, (a*e - c*d*x)/Sqrt[a + c*x^2]] /; FreeQ[{a, c, d, e}, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -(b - Rt[b^2 - 4*a*c, 2] + 2*c*x)*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/ ((m + 1)*(2*c*d - b*e + e*Rt[b^2 - 4*a*c, 2])* ((2*c*d - b*e + e*Rt[b^2 - 4*a*c, 2])*(b + Rt[b^2 - 4*a*c, 2] + 2*c*x)/((2*c*d - b*e - e*Rt[b^2 - 4*a*c, 2])*(b - Rt[b^2 - 4*a*c, 2] + 2*c*x)))^p)* Hypergeometric2F1[m + 1, -p, m + 2, -4*c* Rt[b^2 - 4*a*c, 2]*(d + e* x)/((2*c*d - b*e - e*Rt[b^2 - 4*a*c, 2])*(b - Rt[b^2 - 4*a*c, 2] + 2*c*x))] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && Not[IntegerQ[p]] && EqQ[m + 2*p + 2, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (Rt[-a*c, 2] - c*x)*(d + e*x)^(m + 1)*(a + c*x^2)^p/ ((m + 1)*(c*d + e*Rt[-a*c, 2])*((c*d + e*Rt[-a*c, 2])*(Rt[-a*c, 2] + c*x)/((c*d - e*Rt[-a*c, 2])*(-Rt[-a*c, 2] + c*x)))^p)* Hypergeometric2F1[m + 1, -p, m + 2, 2*c*Rt[-a*c, 2]*(d + e*x)/((c*d - e*Rt[-a*c, 2])*(Rt[-a*c, 2] - c*x))] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + 2*p + 2, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ m*(b + 2*c*x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) + m*(2*c*d - b*e)/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m + 2*p + 3, 0] && LtQ[p, -1]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^m*(2*c*x)*(a + c*x^2)^(p + 1)/(4*a*c*(p + 1)) - m*(2*c*d)/(4*a*c*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[m + 2*p + 3, 0] && LtQ[p, -1]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + (2*c*d - b*e)/(2*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && EqQ[m + 2*p + 3, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/((m + 1)*(c*d^2 + a*e^2)) + c*d/(c*d^2 + a*e^2)*Int[(d + e*x)^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[m + 2*p + 3, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/(e*(m + 1)) - p/(e*(m + 1))* Int[(d + e*x)^(m + 1)*(b + 2*c*x)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && GtQ[p, 0] && (IntegerQ[p] || LtQ[m, -1]) && NeQ[m, -1] && Not[ILtQ[m + 2*p + 1, 0]] && IntQuadraticQ[a, b, c, d, e, m, p, x]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + c*x^2)^p/(e*(m + 1)) - 2*c*p/(e*(m + 1))* Int[x*(d + e*x)^(m + 1)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e, m}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && (IntegerQ[p] || LtQ[m, -1]) && NeQ[m, -1] && Not[ILtQ[m + 2*p + 1, 0]] && IntQuadraticQ[a, 0, c, d, e, m, p, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^p/(e*(m + 2*p + 1)) - p/(e*(m + 2*p + 1))* Int[(d + e*x)^m* Simp[b*d - 2*a*e + (2*c*d - b*e)*x, x]*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && GtQ[p, 0] && NeQ[m + 2*p + 1, 0] && (Not[RationalQ[m]] || LtQ[m, 1]) && Not[ILtQ[m + 2*p, 0]] && IntQuadraticQ[a, b, c, d, e, m, p, x]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(a + c*x^2)^p/(e*(m + 2*p + 1)) + 2*p/(e*(m + 2*p + 1))* Int[(d + e*x)^m*Simp[a*e - c*d*x, x]*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e, m}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && NeQ[m + 2*p + 1, 0] && (Not[RationalQ[m]] || LtQ[m, 1]) && Not[ILtQ[m + 2*p, 0]] && IntQuadraticQ[a, 0, c, d, e, m, p, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ m*(b + 2*c*x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) - 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(b*e*m + 2*c*d*(2*p + 3) + 2*c*e*(m + 2*p + 3)*x)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && LtQ[p, -1] && GtQ[m, 0] && (LtQ[m, 1] || ILtQ[m + 2*p + 3, 0] && NeQ[m, 2]) && IntQuadraticQ[a, b, c, d, e, m, p, x]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -x*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*a*(p + 1)) + 1/(2*a*(p + 1))* Int[(d + e*x)^(m - 1)*(d*(2*p + 3) + e*(m + 2*p + 3)*x)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0] && (LtQ[m, 1] || ILtQ[m + 2*p + 3, 0] && NeQ[m, 2]) && IntQuadraticQ[a, 0, c, d, e, m, p, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m - 1)*(d*b - 2*a*e + (2*c*d - b*e)* x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 2)* Simp[e*(2*a*e*(m - 1) + b*d*(2*p - m + 4)) - 2*c*d^2*(2*p + 3) + e*(b*e - 2*d*c)*(m + 2*p + 2)*x, x]* (a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && LtQ[p, -1] && GtQ[m, 1] && IntQuadraticQ[a, b, c, d, e, m, p, x]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m - 1)*(a*e - c*d*x)*(a + c*x^2)^(p + 1)/(2*a*c*(p + 1)) + 1/((p + 1)*(-2*a*c))* Int[(d + e*x)^(m - 2)* Simp[a*e^2*(m - 1) - c*d^2*(2*p + 3) - d*c*e*(m + 2*p + 2)*x, x]*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 1] && IntQuadraticQ[a, 0, c, d, e, m, p, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(b*c*d - b^2*e + 2*a*c*e + c*(2*c*d - b*e)* x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2)) + 1/((p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^m* Simp[b*c*d*e*(2*p - m + 2) + b^2*e^2*(m + p + 2) - 2*c^2*d^2*(2*p + 3) - 2*a*c*e^2*(m + 2*p + 3) - c*e*(2*c*d - b*e)*(m + 2*p + 4)*x, x]* (a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && LtQ[p, -1] && IntQuadraticQ[a, b, c, d, e, m, p, x]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^(m + 1)*(a*e + c*d*x)*(a + c*x^2)^(p + 1)/(2*a*(p + 1)*(c*d^2 + a*e^2)) + 1/(2*a*(p + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^m* Simp[c*d^2*(2*p + 3) + a*e^2*(m + 2*p + 3) + c*e*d*(m + 2*p + 4)*x, x]*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, m}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && IntQuadraticQ[a, 0, c, d, e, m, p, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 1)) + 1/(c*(m + 2*p + 1))* Int[(d + e*x)^(m - 2)* Simp[c*d^2*(m + 2*p + 1) - e*(a*e*(m - 1) + b*d*(p + 1)) + e*(2*c*d - b*e)*(m + p)*x, x]* (a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && If[RationalQ[m], GtQ[m, 1], SumSimplerQ[m, -2]] && NeQ[m + 2*p + 1, 0] && IntQuadraticQ[a, b, c, d, e, m, p, x]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)/(c*(m + 2*p + 1)) + 1/(c*(m + 2*p + 1))* Int[(d + e*x)^(m - 2)* Simp[c*d^2*(m + 2*p + 1) - a*e^2*(m - 1) + 2*c*d*e*(m + p)*x, x]*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && If[RationalQ[m], GtQ[m, 1], SumSimplerQ[m, -2]] && NeQ[m + 2*p + 1, 0] && IntQuadraticQ[a, 0, c, d, e, m, p, x]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/((m + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)* Simp[c*d*(m + 1) - b*e*(m + p + 2) - c*e*(m + 2*p + 3)*x, x]*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && NeQ[m, -1] && (LtQ[m, -1] && IntQuadraticQ[a, b, c, d, e, m, p, x] || SumSimplerQ[m, 1] && IntegerQ[p] || ILtQ[Simplify[m + 2*p + 3], 0])
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/((m + 1)*(c*d^2 + a*e^2)) + c/((m + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 1)* Simp[d*(m + 1) - e*(m + 2*p + 3)*x, x]*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && NeQ[m, -1] && (LtQ[m, -1] && IntQuadraticQ[a, 0, c, d, e, m, p, x] || SumSimplerQ[m, 1] && IntegerQ[p] || ILtQ[Simplify[m + 2*p + 3], 0])
Int[1/((d_ + e_.*x_)*(a_ + c_.*x_^2)^(1/4)), x_Symbol] := d*Int[1/((d^2 - e^2*x^2)*(a + c*x^2)^(1/4)), x] - e*Int[x/((d^2 - e^2*x^2)*(a + c*x^2)^(1/4)), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[1/((d_ + e_.*x_)*(a_ + c_.*x_^2)^(3/4)), x_Symbol] := d*Int[1/((d^2 - e^2*x^2)*(a + c*x^2)^(3/4)), x] - e*Int[x/((d^2 - e^2*x^2)*(a + c*x^2)^(3/4)), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_/(d_. + e_.*x_), x_Symbol] := 1/(-4*c/(b^2 - 4*a*c))^p* Subst[Int[ Simp[1 - x^2/(b^2 - 4*a*c), x]^p/Simp[2*c*d - b*e + e*x, x], x], x, b + 2*c*x] /; FreeQ[{a, b, c, d, e, p}, x] && GtQ[4*a - b^2/c, 0] && IntegerQ[4*p]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_/(d_. + e_.*x_), x_Symbol] := (a + b*x + c*x^2)^p/(-c*(a + b*x + c*x^2)/(b^2 - 4*a*c))^p* Int[(-a*c/(b^2 - 4*a*c) - b*c*x/(b^2 - 4*a*c) - c^2*x^2/(b^2 - 4*a*c))^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, p}, x] && Not[GtQ[4*a - b^2/c, 0]] && IntegerQ[4*p]
Int[1/((d_. + e_.*x_)*(a_ + b_.*x_ + c_.*x_^2)^(1/3)), x_Symbol] := With[{q = Rt[3*c*e^2*(2*c*d - b*e), 3]}, -Sqrt[3]*c*e* ArcTan[1/Sqrt[3] + 2*(c*d - b*e - c*e*x)/(Sqrt[3]*q*(a + b*x + c*x^2)^(1/3))]/ q^2 - 3*c*e*Log[d + e*x]/(2*q^2) + 3*c*e* Log[c*d - b*e - c*e*x - q*(a + b*x + c*x^2)^(1/3)]/(2*q^2)] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && EqQ[c^2*d^2 - b*c*d*e + b^2*e^2 - 3*a*c*e^2, 0] && PosQ[c*e^2*(2*c*d - b*e)]
Int[1/((d_ + e_.*x_)*(a_ + c_.*x_^2)^(1/3)), x_Symbol] := With[{q = Rt[6*c^2*e^2/d^2, 3]}, -Sqrt[3]*c*e* ArcTan[1/Sqrt[3] + 2*c*(d - e*x)/(Sqrt[3]*d*q*(a + c*x^2)^(1/3))]/(d^2*q^2) - 3*c*e*Log[d + e*x]/(2*d^2*q^2) + 3*c*e*Log[c*d - c*e*x - d*q*(a + c*x^2)^(1/3)]/(2*d^2*q^2)] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 - 3*a*e^2, 0]
Int[1/((d_. + e_.*x_)*(a_ + b_.*x_ + c_.*x_^2)^(1/3)), x_Symbol] := With[{q = Rt[-3*c*e^2*(2*c*d - b*e), 3]}, -Sqrt[3]*c*e* ArcTan[1/Sqrt[3] - 2*(c*d - b*e - c*e*x)/(Sqrt[3]*q*(a + b*x + c*x^2)^(1/3))]/ q^2 - 3*c*e*Log[d + e*x]/(2*q^2) + 3*c*e* Log[c*d - b*e - c*e*x + q*(a + b*x + c*x^2)^(1/3)]/(2*q^2)] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0] && EqQ[c^2*d^2 - b*c*d*e + b^2*e^2 - 3*a*c*e^2, 0] && NegQ[c*e^2*(2*c*d - b*e)]
(* Int[1/((d_+e_.*x_)*(a_+c_.*x_^2)^(1/3)),x_Symbol] := With[{q=Rt[-6*c^2*d*e^2,3]}, -Sqrt[3]*c*e*ArcTan[1/Sqrt[3]-2*(c*d-c*e*x)/(Sqrt[3]*q*(a+c*x^2)^(1/ 3))]/q^2 - 3*c*e*Log[d+e*x]/(2*q^2) + 3*c*e*Log[c*d-c*e*x+q*(a+c*x^2)^(1/3)]/(2*q^2)] /; FreeQ[{a,c,d,e},x] && EqQ[c*d^2-3*a*e^2,0] && NegQ[c^2*d*e^2] *)
Int[1/((d_ + e_.*x_)*(a_ + c_.*x_^2)^(1/3)), x_Symbol] := a^(1/3)* Int[1/((d + e*x)*(1 - 3*e*x/d)^(1/3)*(1 + 3*e*x/d)^(1/3)), x] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + 9*a*e^2, 0] && GtQ[a, 0]
Int[1/((d_ + e_.*x_)*(a_ + c_.*x_^2)^(1/3)), x_Symbol] := (1 + c*x^2/a)^(1/3)/(a + c*x^2)^(1/3)* Int[1/((d + e*x)*(1 + c*x^2/a)^(1/3)), x] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 + 9*a*e^2, 0] && Not[GtQ[a, 0]]
Int[1/((d_. + e_.*x_)*(a_ + b_.*x_ + c_.*x_^2)^(1/3)), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (b + q + 2*c*x)^(1/ 3)*(b - q + 2*c*x)^(1/3)/(a + b*x + c*x^2)^(1/3)* Int[1/((d + e*x)*(b + q + 2*c*x)^(1/3)*(b - q + 2*c*x)^(1/3)), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c^2*d^2 - b*c*d*e - 2*b^2*e^2 + 9*a*c*e^2, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[(d + e*x)^m*(Rt[a, 2] + Rt[-c, 2]*x)^ p*(Rt[a, 2] - Rt[-c, 2]*x)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && GtQ[a, 0] && LtQ[c, 0]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(a + c*x^2)^ p, (d/(d^2 - e^2*x^2) - e*x/(d^2 - e^2*x^2))^(-m), x], x] /; FreeQ[{a, c, d, e, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[m, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -(1/(d + e*x))^(2*p)*(a + b*x + c*x^2)^ p/(e*(e*(b - q + 2*c*x)/(2*c*(d + e*x)))^ p*(e*(b + q + 2*c*x)/(2*c*(d + e*x)))^p)* Subst[ Int[x^(-m - 2*(p + 1))*Simp[1 - (d - e*(b - q)/(2*c))*x, x]^p* Simp[1 - (d - e*(b + q)/(2*c))*x, x]^p, x], x, 1/(d + e*x)]] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && Not[IntegerQ[p]] && ILtQ[m, 0]
Int[(d_. + e_.*x_)^m_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (a + b*x + c*x^2)^ p/(e*(1 - (d + e*x)/(d - e*(b - q)/(2*c)))^ p*(1 - (d + e*x)/(d - e*(b + q)/(2*c)))^p)* Subst[ Int[x^m*Simp[1 - x/(d - e*(b - q)/(2*c)), x]^p* Simp[1 - x/(d - e*(b + q)/(2*c)), x]^p, x], x, d + e*x]] /; FreeQ[{a, b, c, d, e, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[2*c*d - b*e, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Rt[-a*c, 2]}, (a + c*x^2)^ p/(e*(1 - (d + e*x)/(d + e*q/c))^p*(1 - (d + e*x)/(d - e*q/c))^ p)* Subst[ Int[x^m*Simp[1 - x/(d + e*q/c), x]^p* Simp[1 - x/(d - e*q/c), x]^p, x], x, d + e*x]] /; FreeQ[{a, c, d, e, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d_. + e_.*u_)^m_.*(a_ + b_.*u_ + c_.*u_^2)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(d + e*x)^m*(a + b*x + c*x^2)^p, x], x, u] /; FreeQ[{a, b, c, d, e, m, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(d_. + e_.*u_)^m_.*(a_ + c_.*u_^2)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(d + e*x)^m*(a + c*x^2)^p, x], x, u] /; FreeQ[{a, c, d, e, m, p}, x] && LinearQ[u, x] && NeQ[u, x]
(* IntQuadraticQ[a,b,c,d,e,m,p,x] returns True iff  (d+e*x)^m*(a+b*x+c*x^2)^p is integrable wrt x in terms of non-Appell  functions. *) IntQuadraticQ[a_, b_, c_, d_, e_, m_, p_, x_] := IntegerQ[p] || IGtQ[m, 0] || IntegersQ[2*m, 2*p] || IntegersQ[m, 4*p] || IntegersQ[m, p + 1/3] && (EqQ[c^2*d^2 - b*c*d*e + b^2*e^2 - 3*a*c*e^2, 0] || EqQ[c^2*d^2 - b*c*d*e - 2*b^2*e^2 + 9*a*c*e^2, 0])

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.3 (d+e x)^m (f+g x) (a+b x+c x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.3 (d+e x)^m (f+g x) (a+b x+c x^2)^p *)
Int[(e_.*x_)^m_.*(f_ + g_.*x_)*(b_.*x_ + c_.*x_^2)^p_., x_Symbol] := g*(e*x)^m*(b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) /; FreeQ[{b, c, e, f, g, m, p}, x] && EqQ[b*g*(m + p + 1) - c*f*(m + 2*p + 2), 0] && NeQ[m + 2*p + 2, 0]
Int[x_^m_.*(f_ + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := f*Int[x^m*(a + c*x^2)^p, x] + g*Int[x^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, f, g, p}, x] && IntegerQ[m] && Not[IntegerQ[2*p]]
Int[(e_.*x_)^m_.*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(e*x)^m*(f + g*x)*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, e, f, g, m}, x] && IntegerQ[p] && (GtQ[p, 0] || EqQ[a, 0] && IntegerQ[m])
Int[(e_.*x_)^m_.*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(e*x)^m*(f + g*x)*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, e, f, g, m}, x] && IGtQ[p, 0]
Int[(d_. + e_.*x_)^m_.*(f_ + g_.*x_)*(a_ + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := -f*g*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(b*(p + 1)*(e*f - d*g)) /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && EqQ[m + 2*p + 3, 0] && EqQ[2*c*f - b*g, 0]
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := g*(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)/(2*c*(p + 1)) - e*g*m/(2*c*(p + 1))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[2*c*f - b*g, 0] && LtQ[p, -1] && GtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -2*c*(e*f - d*g)*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(2*c*d - b*e)^2) + (2*c*f - b*g)/(2*c*d - b*e)* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && EqQ[m + 2*p + 3, 0] && NeQ[2*c*f - b*g, 0] && NeQ[2*c*d - b*e, 0]
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x)^(2*FracPart[p]))* Int[(d + e*x)^m*(f + g*x)*(b/2 + c*x)^(2*p), x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[p] && (GtQ[p, 0] || EqQ[a, 0] && IntegerQ[m])
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, f, g, m}, x] && IGtQ[p, 0]
Int[(d_. + e_.*x_)*(f_ + g_.*x_)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*g*x/c + 1/c*Int[(c*d*f - a*e*g + (c*e*f + c*d*g - b*e*g)*x)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(d_. + e_.*x_)*(f_ + g_.*x_)/(a_ + c_.*x_^2), x_Symbol] := e*g*x/c + 1/c*Int[(c*d*f - a*e*g + c*(e*f + d*g)*x)/(a + c*x^2), x] /; FreeQ[{a, c, d, e, f, g}, x]
Int[(d_. + e_.*x_)*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -(b*e*g*(p + 2) - c*(e*f + d*g)*(2*p + 3) - 2*c*e*g*(p + 1)*x)*(a + b*x + c*x^2)^(p + 1)/(2* c^2*(p + 1)*(2*p + 3)) /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[b^2*e*g*(p + 2) - 2*a*c*e*g + c*(2*c*d*f - b*(e*f + d*g))*(2*p + 3), 0] && NeQ[p, -1]
Int[(d_. + e_.*x_)*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := ((e*f + d*g)*(2*p + 3) + 2*e*g*(p + 1)*x)*(a + c*x^2)^(p + 1)/(2*c*(p + 1)*(2*p + 3)) /; FreeQ[{a, c, d, e, f, g, p}, x] && EqQ[a*e*g - c*d*f*(2*p + 3), 0] && NeQ[p, -1]
Int[(d_. + e_.*x_)*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -(2*a*c*(e*f + d*g) - b*(c*d*f + a*e*g) - (b^2*e*g - b*c*(e*f + d*g) + 2*c*(c*d*f - a*e*g))*x)*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)*(b^2 - 4*a*c)) - (b^2*e*g*(p + 2) - 2*a*c*e*g + c*(2*c*d*f - b*(e*f + d*g))*(2*p + 3))/(c*(p + 1)*(b^2 - 4*a*c))*Int[(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1]
Int[(d_. + e_.*x_)*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (a*(e*f + d*g) - (c*d*f - a*e*g)*x)*(a + c*x^2)^(p + 1)/(2*a* c*(p + 1)) - (a*e*g - c*d*f*(2*p + 3))/(2*a*c*(p + 1))* Int[(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, f, g}, x] && LtQ[p, -1]
Int[(d_. + e_.*x_)*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -(b*e*g*(p + 2) - c*(e*f + d*g)*(2*p + 3) - 2*c*e*g*(p + 1)*x)*(a + b*x + c*x^2)^(p + 1)/(2* c^2*(p + 1)*(2*p + 3)) + (b^2*e*g*(p + 2) - 2*a*c*e*g + c*(2*c*d*f - b*(e*f + d*g))*(2*p + 3))/(2*c^2*(2*p + 3))* Int[(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b^2 - 4*a*c, 0] && Not[LeQ[p, -1]]
Int[(d_. + e_.*x_)*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := ((e*f + d*g)*(2*p + 3) + 2*e*g*(p + 1)*x)*(a + c*x^2)^(p + 1)/(2*c*(p + 1)*(2*p + 3)) - (a*e*g - c*d*f*(2*p + 3))/(c*(2*p + 3))*Int[(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, p}, x] && Not[LeQ[p, -1]]
Int[(e_.*x_)^m_.*(f_. + g_.*x_)*(b_.*x_ + c_.*x_^2)^p_., x_Symbol] := 1/e^p*Int[(e*x)^(m + p)*(f + g*x)*(b + c*x)^p, x] /; FreeQ[{b, c, e, f, g, m}, x] && IntegerQ[p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(f + g*x)*(a/d + c/e*x)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(f + g*x)*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, f, g, m}, x] && EqQ[c*d^2 + a*e^2, 0] && (IntegerQ[p] || GtQ[a, 0] && GtQ[d, 0] && EqQ[m + p, 0])
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := d^m*e^m* Int[(f + g*x)*(a + b*x + c*x^2)^(m + p)/(a*e + c*d*x)^m, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[2*p]] && ILtQ[m, 0]
Int[x_*(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := d^m*e^m*Int[x*(a + c*x^2)^(m + p)/(a*e + c*d*x)^m, x] /; FreeQ[{a, c, d, e, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[m, 0] && EqQ[m, -1] && Not[ILtQ[p - 1/2, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := g*(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[m*(g*(c*d - b*e) + c*e*f) + e*(p + 1)*(2*c*f - b*g), 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := g*(d + e*x)^m*(a + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) /; FreeQ[{a, c, d, e, f, g, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && EqQ[m*(d*g + e*f) + 2*e*f*(p + 1), 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (g*(c*d - b*e) + c*e*f)*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)*(2*c*d - b*e)) - e*(m*(g*(c*d - b*e) + c*e*f) + e*(p + 1)*(2*c*f - b*g))/(c*(p + 1)*(2*c*d - b*e))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (d*g + e*f)*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*c*d*(p + 1)) - e*(m*(d*g + e*f) + 2*e*f*(p + 1))/(2*c*d*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, f, g}, x] && EqQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (g*(c*d - b*e) + c*e*f)*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)*(2*c*d - b*e)) - e*(m*(g*(c*d - b*e) + c*e*f) + e*(p + 1)*(2*c*f - b*g))/(c*(p + 1)*(2*c*d - b*e))* Int[(d + e*x)^Simplify[m - 1]*(a + b*x + c*x^2)^ Simplify[p + 1], x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && SumSimplerQ[p, 1] && SumSimplerQ[m, -1] && NeQ[p, -1]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (d*g + e*f)*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*c*d*(p + 1)) - e*(m*(d*g + e*f) + 2*e*f*(p + 1))/(2*c*d*(p + 1))* Int[(d + e*x)^Simplify[m - 1]*(a + c*x^2)^Simplify[p + 1], x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && SumSimplerQ[p, 1] && SumSimplerQ[m, -1] && NeQ[p, -1] && Not[IGtQ[m, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d*g - e*f)*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/((2*c*d - b*e)*(m + p + 1)) + (m*(g*(c*d - b*e) + c*e*f) + e*(p + 1)*(2*c*f - b*g))/(e*(2*c*d - b*e)*(m + p + 1))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && (LtQ[m, -1] && Not[IGtQ[m + p + 1, 0]] || LtQ[m, 0] && LtQ[p, -1] || EqQ[m + 2*p + 2, 0]) && NeQ[m + p + 1, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (d*g - e*f)*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*c*d*(m + p + 1)) + (m*(g*c*d + c*e*f) + 2*e*c*f*(p + 1))/(e*(2*c*d)*(m + p + 1))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && (LtQ[m, -1] && Not[IGtQ[m + p + 1, 0]] || LtQ[m, 0] && LtQ[p, -1] || EqQ[m + 2*p + 2, 0]) && NeQ[m + p + 1, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := g*(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) + (m*(g*(c*d - b*e) + c*e*f) + e*(p + 1)*(2*c*f - b*g))/(c* e*(m + 2*p + 2))*Int[(d + e*x)^m*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[m + 2*p + 2, 0] && (NeQ[m, 2] || EqQ[d, 0])
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := g*(d + e*x)^m*(a + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) + (m*(d*g + e*f) + 2*e*f*(p + 1))/(e*(m + 2*p + 2))* Int[(d + e*x)^m*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && EqQ[c*d^2 + a*e^2, 0] && NeQ[m + 2*p + 2, 0] && NeQ[m, 2]
Int[x_^2*(f_ + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := x^2*(a*g - c*f*x)*(a + c*x^2)^(p + 1)/(2*a*c*(p + 1)) - 1/(2*a*c*(p + 1))* Int[x*Simp[2*a*g - c*f*(2*p + 5)*x, x]*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, f, g}, x] && EqQ[a*g^2 + f^2*c, 0] && LtQ[p, -2]
Int[x_^2*(f_ + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := 1/c*Int[(f + g*x)*(a + c*x^2)^(p + 1), x] - a/c*Int[(f + g*x)*(a + c*x^2)^p, x] /; FreeQ[{a, c, f, g, p}, x] && EqQ[a*g^2 + f^2*c, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^m*(f + g*x)^(p + 1)*(a/f + c/g*x)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*f^2 - b*f*g + a*g^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^m*(f + g*x)^(p + 1)*(a/f + c/g*x)^p, x] /; FreeQ[{a, c, d, e, f, g, m}, x] && EqQ[c*f^2 + a*g^2, 0] && (IntegerQ[p] || GtQ[a, 0] && GtQ[f, 0] && EqQ[p, -1])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)/(a + b*x + c*x^2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[m]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)/(a + c*x^2), x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[m]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := -(e*f - d*g)*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(2*(p + 1)*(c*d^2 - b*d*e + a*e^2)) /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[Simplify[m + 2*p + 3], 0] && EqQ[b*(e*f + d*g) - 2*(c*d*f + a*e*g), 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := -(e*f - d*g)*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/(2*(p + 1)*(c*d^2 + a*e^2)) /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[Simplify[m + 2*p + 3], 0] && EqQ[c*d*f + a*e*g, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)*(b*f - 2*a*g + (2*c*f - b*g)*x)/((p + 1)*(b^2 - 4*a*c)) - m*(b*(e*f + d*g) - 2*(c*d*f + a*e*g))/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[Simplify[m + 2*p + 3], 0] && LtQ[p, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^m*(a + c*x^2)^(p + 1)*(a*g - c*f*x)/(2*a*c*(p + 1)) - m*(c*d*f + a*e*g)/(2*a*c*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[Simplify[m + 2*p + 3], 0] && LtQ[p, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := -(e*f - d*g)*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(2*(p + 1)*(c*d^2 - b*d*e + a*e^2)) - (b*(e*f + d*g) - 2*(c*d*f + a*e*g))/(2*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[Simplify[m + 2*p + 3], 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := -(e*f - d*g)*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/(2*(p + 1)*(c*d^2 + a*e^2)) + (c*d*f + a*e*g)/(c*d^2 + a*e^2)* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[Simplify[m + 2*p + 3], 0]
Int[(e_.*x_)^m_*(f_ + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := f*Int[(e*x)^m*(a + c*x^2)^p, x] + g/e*Int[(e*x)^(m + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, e, f, g, p}, x] && Not[RationalQ[m]] && Not[IGtQ[p, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ FracPart[p]*(a + b*x + c*x^2)^FracPart[p]/(a*d + c*e*x^3)^ FracPart[p]*Int[(f + g*x)*(a*d + c*e*x^3)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[m, p] && EqQ[b*d + a*e, 0] && EqQ[c*d + b*e, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := -(d + e*x)^(m + 1)*(a + b*x + c*x^2)^ p/(e^2*(m + 1)*(m + 2)*(c*d^2 - b*d*e + a*e^2))* ((d*g - e*f*(m + 2))*(c*d^2 - b*d*e + a*e^2) - d*p*(2*c*d - b*e)*(e*f - d*g) - e*(g*(m + 1)*(c*d^2 - b*d*e + a*e^2) + p*(2*c*d - b*e)*(e*f - d*g))*x) - p/(e^2*(m + 1)*(m + 2)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 2)*(a + b*x + c*x^2)^(p - 1)* Simp[2*a*c*e*(e*f - d*g)*(m + 2) + b^2*e*(d*g*(p + 1) - e*f*(m + p + 2)) + b*(a*e^2*g*(m + 1) - c*d*(d*g*(2*p + 1) - e*f*(m + 2*p + 2))) - c*(2*c*d*(d*g*(2*p + 1) - e*f*(m + 2*p + 2)) - e*(2*a*e*g*(m + 1) - b*(d*g*(m - 2*p) + e*f*(m + 2*p + 2))))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[p, 0] && LtQ[m, -2] && LtQ[m + 2*p, 0] && Not[ILtQ[m + 2*p + 3, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := -(d + e*x)^(m + 1)*(a + c*x^2)^ p/(e^2*(m + 1)*(m + 2)*(c*d^2 + a*e^2))* ((d*g - e*f*(m + 2))*(c*d^2 + a*e^2) - 2*c*d^2*p*(e*f - d*g) - e*(g*(m + 1)*(c*d^2 + a*e^2) + 2*c*d*p*(e*f - d*g))*x) - p/(e^2*(m + 1)*(m + 2)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 2)*(a + c*x^2)^(p - 1)* Simp[2*a*c*e*(e*f - d*g)*(m + 2) - c*(2*c*d*(d*g*(2*p + 1) - e*f*(m + 2*p + 2)) - 2*a*e^2*g*(m + 1))*x, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && LtQ[m, -2] && LtQ[m + 2*p, 0] && Not[ILtQ[m + 2*p + 3, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(e*f*(m + 2*p + 2) - d*g*(2*p + 1) + e*g*(m + 1)*x)*(a + b*x + c*x^2)^p/(e^2*(m + 1)*(m + 2*p + 2)) + p/(e^2*(m + 1)*(m + 2*p + 2))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p - 1)* Simp[g*(b*d + 2*a*e + 2*a*e*m + 2*b*d*p) - f*b*e*(m + 2*p + 2) + (g*(2*c*d + b*e + b*e*m + 4*c*d*p) - 2*c*e*f*(m + 2*p + 2))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && RationalQ[p] && p > 0 && (LtQ[m, -1] || EqQ[p, 1] || IntegerQ[p] && Not[RationalQ[m]]) && NeQ[m, -1] && Not[ILtQ[m + 2*p + 1, 0]] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(e*f*(m + 2*p + 2) - d*g*(2*p + 1) + e*g*(m + 1)*x)*(a + c*x^2)^p/(e^2*(m + 1)*(m + 2*p + 2)) + p/(e^2*(m + 1)*(m + 2*p + 2))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^(p - 1)* Simp[g*(2*a*e + 2*a*e*m) + (g*(2*c*d + 4*c*d*p) - 2*c*e*f*(m + 2*p + 2))*x, x], x] /; FreeQ[{a, c, d, e, f, g, m}, x] && NeQ[c*d^2 + a*e^2, 0] && RationalQ[p] && p > 0 && (LtQ[m, -1] || EqQ[p, 1] || IntegerQ[p] && Not[RationalQ[m]]) && NeQ[m, -1] && Not[ILtQ[m + 2*p + 1, 0]] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(c*e*f*(m + 2*p + 2) - g*(c*d + 2*c*d*p - b*e*p) + g*c*e*(m + 2*p + 1)*x)*(a + b*x + c*x^2)^p/ (c*e^2*(m + 2*p + 1)*(m + 2*p + 2)) - p/(c*e^2*(m + 2*p + 1)*(m + 2*p + 2))* Int[(d + e*x)^m*(a + b*x + c*x^2)^(p - 1)* Simp[c*e*f*(b*d - 2*a*e)*(m + 2*p + 2) + g*(a*e*(b*e - 2*c*d*m + b*e*m) + b*d*(b*e*p - c*d - 2*c*d*p)) + (c*e*f*(2*c*d - b*e)*(m + 2*p + 2) + g*(b^2*e^2*(p + m + 1) - 2*c^2*d^2*(1 + 2*p) - c*e*(b*d*(m - 2*p) + 2*a*e*(m + 2*p + 1))))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[p, 0] && (IntegerQ[p] || Not[RationalQ[m]] || GeQ[m, -1] && LtQ[m, 0]) && Not[ILtQ[m + 2*p, 0]] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(c*e*f*(m + 2*p + 2) - g*c*d*(2*p + 1) + g*c*e*(m + 2*p + 1)*x)*(a + c*x^2)^p/ (c*e^2*(m + 2*p + 1)*(m + 2*p + 2)) + 2*p/(c*e^2*(m + 2*p + 1)*(m + 2*p + 2))* Int[(d + e*x)^m*(a + c*x^2)^(p - 1)* Simp[f*a*c*e^2*(m + 2*p + 2) + a*c*d*e*g* m - (c^2*f*d*e*(m + 2*p + 2) - g*(c^2*d^2*(2*p + 1) + a*c*e^2*(m + 2*p + 1)))*x, x], x] /; FreeQ[{a, c, d, e, f, g, m}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && (IntegerQ[p] || Not[RationalQ[m]] || GeQ[m, -1] && LtQ[m, 0]) && Not[ILtQ[m + 2*p, 0]] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[(a + b*x + c*x^2)^p*ExpandIntegrand[(d + e*x)^m*(f + g*x), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[p, -1] && IGtQ[m, 0] && RationalQ[a, b, c, d, e, f, g]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[(a + c*x^2)^p*ExpandIntegrand[(d + e*x)^m*(f + g*x), x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && ILtQ[p, -1] && IGtQ[m, 0] && RationalQ[a, c, d, e, f, g]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := -(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)*(2*a*c*(e*f + d*g) - b*(c*d*f + a*e*g) - (2*c^2*d*f + b^2*e*g - c*(b*e*f + b*d*g + 2*a*e*g))*x)/ (c*(p + 1)*(b^2 - 4*a*c)) - 1/(c*(p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 2)*(a + b*x + c*x^2)^(p + 1)* Simp[2*c^2*d^2*f*(2*p + 3) + b*e*g*(a*e*(m - 1) + b*d*(p + 2)) - c*(2*a*e*(e*f*(m - 1) + d*g*m) + b*d*(d*g*(2*p + 3) - e*f*(m - 2*p - 4))) + e*(b^2*e*g*(m + p + 1) + 2*c^2*d*f*(m + 2*p + 2) - c*(2*a*e*g*m + b*(e*f + d*g)*(m + 2*p + 2)))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 1] && (EqQ[m, 2] && EqQ[p, -3] && RationalQ[a, b, c, d, e, f, g] || Not[ILtQ[m + 2*p + 3, 0]])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)*(a*(e*f + d*g) - (c*d*f - a*e*g)*x)/(2*a*c*(p + 1)) - 1/(2*a*c*(p + 1))*Int[(d + e*x)^(m - 2)*(a + c*x^2)^(p + 1)* Simp[a*e*(e*f*(m - 1) + d*g*m) - c*d^2*f*(2*p + 3) + e*(a*e*g*m - c*d*f*(m + 2*p + 2))*x, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 1] && (EqQ[d, 0] || EqQ[m, 2] && EqQ[p, -3] && RationalQ[a, c, d, e, f, g] || Not[ILtQ[m + 2*p + 3, 0]])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)*(f*b - 2*a*g + (2*c*f - b*g)*x)/((p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)* Simp[g*(2*a*e*m + b*d*(2*p + 3)) - f*(b*e*m + 2*c*d*(2*p + 3)) - e*(2*c*f - b*g)*(m + 2*p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^m*(a + c*x^2)^(p + 1)*(a*g - c*f*x)/(2*a*c*(p + 1)) - 1/(2*a*c*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)* Simp[a*e*g*m - c*d*f*(2*p + 3) - c*e*f*(m + 2*p + 3)*x, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^(m + 1)*(f*(b*c*d - b^2*e + 2*a*c*e) - a*g*(2*c*d - b*e) + c*(f*(2*c*d - b*e) - g*(b*d - 2*a*e))* x)*(a + b*x + c*x^2)^(p + 1)/ ((p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2)) + 1/((p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)* Simp[f*(b*c*d*e*(2*p - m + 2) + b^2*e^2*(p + m + 2) - 2*c^2*d^2*(2*p + 3) - 2*a*c*e^2*(m + 2*p + 3)) - g*(a*e*(b*e - 2*c*d*m + b*e*m) - b*d*(3*c*d - b*e + 2*c*d*p - b*e*p)) + c*e*(g*(b*d - 2*a*e) - f*(2*c*d - b*e))*(m + 2*p + 4)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^(m + 1)*(f*a*c*e - a*g*c*d + c*(c*d*f + a*e*g)*x)*(a + c*x^2)^(p + 1)/(2*a* c*(p + 1)*(c*d^2 + a*e^2)) + 1/(2*a*c*(p + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^m*(a + c*x^2)^(p + 1)* Simp[f*(c^2*d^2*(2*p + 3) + a*c*e^2*(m + 2*p + 3)) - a*c*d*e*g*m + c*e*(c*d*f + a*e*g)*(m + 2*p + 4)*x, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := g*(d + e*x)^m/(c*m) + 1/c* Int[(d + e*x)^(m - 1)* Simp[c*d*f - a*e*g + (g*c*d - b*e*g + c*e*f)*x, x]/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && FractionQ[m] && GtQ[m, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_ + c_.*x_^2), x_Symbol] := g*(d + e*x)^m/(c*m) + 1/c* Int[(d + e*x)^(m - 1)* Simp[c*d*f - a*e*g + (g*c*d + c*e*f)*x, x]/(a + c*x^2), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && FractionQ[m] && GtQ[m, 0]
Int[(f_. + g_.*x_)/(Sqrt[d_. + e_.*x_]*(a_. + b_.*x_ + c_.*x_^2)), x_Symbol] := 2*Subst[ Int[(e*f - d*g + g*x^2)/(c*d^2 - b*d*e + a*e^2 - (2*c*d - b*e)*x^2 + c*x^4), x], x, Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[(f_. + g_.*x_)/(Sqrt[d_. + e_.*x_]*(a_ + c_.*x_^2)), x_Symbol] := 2*Subst[ Int[(e*f - d*g + g*x^2)/(c*d^2 + a*e^2 - 2*c*d*x^2 + c*x^4), x], x, Sqrt[d + e*x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := (e*f - d*g)*(d + e*x)^(m + 1)/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/(c*d^2 - b*d*e + a*e^2)* Int[(d + e*x)^(m + 1)* Simp[c*d*f - f*b*e + a*e*g - c*(e*f - d*g)*x, x]/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && FractionQ[m] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_ + c_.*x_^2), x_Symbol] := (e*f - d*g)*(d + e*x)^(m + 1)/((m + 1)*(c*d^2 + a*e^2)) + 1/(c*d^2 + a*e^2)* Int[(d + e*x)^(m + 1)* Simp[c*d*f + a*e*g - c*(e*f - d*g)*x, x]/(a + c*x^2), x] /; FreeQ[{a, c, d, e, f, g, m}, x] && NeQ[c*d^2 + a*e^2, 0] && FractionQ[m] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m, (f + g*x)/(a + b*x + c*x^2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[RationalQ[m]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)/(a_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m, (f + g*x)/(a + c*x^2), x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[RationalQ[m]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := g*(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) + 1/(c*(m + 2*p + 2))*Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^p* Simp[m*(c*d*f - a*e*g) + d*(2*c*f - b*g)*(p + 1) + (m*(c*e*f + c*d*g - b*e*g) + e*(p + 1)*(2*c*f - b*g))*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[m, 0] && NeQ[m + 2*p + 2, 0] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p]) && Not[IGtQ[m, 0] && EqQ[f, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := g*(d + e*x)^m*(a + c*x^2)^(p + 1)/(c*(m + 2*p + 2)) + 1/(c*(m + 2*p + 2))*Int[(d + e*x)^(m - 1)*(a + c*x^2)^p* Simp[c*d*f*(m + 2*p + 2) - a*e*g*m + c*(e*f*(m + 2*p + 2) + d*g*m)*x, x], x] /; FreeQ[{a, c, d, e, f, g, p}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[m, 0] && NeQ[m + 2*p + 2, 0] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p]) && Not[IGtQ[m, 0] && EqQ[f, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (e*f - d*g)*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/((m + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p* Simp[(c*d*f - f*b*e + a*e*g)*(m + 1) + b*(d*g - e*f)*(p + 1) - c*(e*f - d*g)*(m + 2*p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[m, -1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := (e*f - d*g)*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/((m + 1)*(c*d^2 + a*e^2)) + 1/((m + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p* Simp[(c*d*f + a*e*g)*(m + 1) - c*(e*f - d*g)*(m + 2*p + 3)*x, x], x] /; FreeQ[{a, c, d, e, f, g, p}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[m, -1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m, 2*p])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (e*f - d*g)*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/((m + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p* Simp[(c*d*f - f*b*e + a*e*g)*(m + 1) + b*(d*g - e*f)*(p + 1) - c*(e*f - d*g)*(m + 2*p + 3)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[Simplify[m + 2*p + 3], 0] && NeQ[m, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := (e*f - d*g)*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/((m + 1)*(c*d^2 + a*e^2)) + 1/((m + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p* Simp[(c*d*f + a*e*g)*(m + 1) - c*(e*f - d*g)*(m + 2*p + 3)*x, x], x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && ILtQ[Simplify[m + 2*p + 3], 0] && NeQ[m, -1]
Int[(f_ + g_.*x_)/((d_. + e_.*x_)*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := 4*f*(a - d)/(b*d - a*e)* Subst[Int[1/(4*(a - d) - x^2), x], x, (2*(a - d) + (b - e)*x)/Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[4*c*(a - d) - (b - e)^2, 0] && EqQ[e*f*(b - e) - 2*g*(b*d - a*e), 0] && NeQ[b*d - a*e, 0]
Int[(f_ + g_.*x_)/(Sqrt[x_]*Sqrt[a_ + b_.*x_ + c_.*x_^2]), x_Symbol] := 2*Subst[Int[(f + g*x^2)/Sqrt[a + b*x^2 + c*x^4], x], x, Sqrt[x]] /; FreeQ[{a, b, c, f, g}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(f_ + g_.*x_)/(Sqrt[x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := 2*Subst[Int[(f + g*x^2)/Sqrt[a + c*x^4], x], x, Sqrt[x]] /; FreeQ[{a, c, f, g}, x]
Int[(f_ + g_.*x_)/(Sqrt[e_*x_]*Sqrt[a_ + b_.*x_ + c_.*x_^2]), x_Symbol] := Sqrt[x]/Sqrt[e*x]* Int[(f + g*x)/(Sqrt[x]*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(f_ + g_.*x_)/(Sqrt[e_*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := Sqrt[x]/Sqrt[e*x]*Int[(f + g*x)/(Sqrt[x]*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, e, f, g}, x]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := g/e*Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p, x] + (e*f - d*g)/e* Int[(d + e*x)^m*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IGtQ[m, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)*(a_ + c_.*x_^2)^p_., x_Symbol] := g/e*Int[(d + e*x)^(m + 1)*(a + c*x^2)^p, x] + (e*f - d*g)/e* Int[(d + e*x)^m*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IGtQ[m, 0]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.3 (d+e x)^m (f+g x)^n (a+b x+c x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (g/e)^n \[Star] Int[(d+e*x)^(m+n)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[e*f-d*g,0] && IntegerQ[n] && Not[IntegerQ[m] && SimplerQ[f+g*x,d+e*x]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (e/g)^m \[Star] Int[(f+g*x)^(m+n)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[e*f-d*g,0] && GtQ[e/g,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^m/(f+g*x)^m \[Star] Int[(f+g*x)^(m+n)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[e*f-d*g,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  1/c^p \[Star] Int[(d+e*x)^m*(f+g*x)^n*(b/2+c*x)^(2*p),x] /;
FreeQ[{a,b,c,d,e,f,g,m,n},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_+g_.*x_)*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  -f*g*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/(b*(p+1)*(e*f-d*g)) /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[b^2-4*a*c,0] && EqQ[m+2*p+3,0] && EqQ[2*c*f-b*g,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -2*c*(e*f-d*g)*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/((p+1)*(2*c*d-b*e)^2) + 
  (2*c*f-b*g)/(2*c*d-b*e) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[b^2-4*a*c,0] && EqQ[m+2*p+3,0] && NeQ[2*c*f-b*g,0] && NeQ[2*c*d-b*e,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/(c^IntPart[p]*(b/2+c*x)^(2*FracPart[p])) \[Star] Int[(d+e*x)^m*(f+g*x)^n*(b/2+c*x)^(2*p),x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[(d*f+e*g*x^2)^m*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[m,n] && EqQ[e*f+d*g,0] && (IntegerQ[m] || GtQ[d,0] && GtQ[f,0])


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  b \[Star] Int[x*(d+e*x)^m*(f+g*x)^n,x] + Int[(d+e*x)^m*(f+g*x)^n*(a+c*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g,m,n},x] && EqQ[m,n] && EqQ[e*f+d*g,0]


(* ::Code:: *)
Int[Sqrt[d_+e_.*x_]*Sqrt[f_+g_.*x_]/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  e*g/c \[Star] Int[1/(Sqrt[d+e*x]*Sqrt[f+g*x]),x] + 
  1/c \[Star] Int[(c*d*f-a*e*g-b*e*g*x)/(Sqrt[d+e*x]*Sqrt[f+g*x]*(a+b*x+c*x^2)),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[e*f+d*g,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^FracPart[m]*(f+g*x)^FracPart[m]/(d*f+e*g*x^2)^FracPart[m] \[Star] Int[(d*f+e*g*x^2)^m*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[m,n] && EqQ[e*f+d*g,0] && Not[EqQ[p,2] && LtQ[m,-1]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  2/e^(n+2*p+1) \[Star] Subst[Int[x^(2*m+1)*(e*f-d*g+g*x^2)^n*(c*d^2-b*d*e+a*e^2-(2*c*d-b*e)*x^2+c*x^4)^p,x],x,Sqrt[d+e*x]] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[p,0] && ILtQ[n,0] && IntegerQ[m+1/2]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(a+b*x+c*x^2)^p,d+e*x,x],R=PolynomialRemainder[(a+b*x+c*x^2)^p,d+e*x,x]},
  R*(d+e*x)^(m+1)*(f+g*x)^(n+1)/((m+1)*(e*f-d*g)) + 
  1/((m+1)*(e*f-d*g)) \[Star] Int[(d+e*x)^(m+1)*(f+g*x)^n*ExpandToSum[(m+1)*(e*f-d*g)*Qx-g*R*(m+n+2),x],x]] /;
FreeQ[{a,b,c,d,e,f,g,n},x] && IGtQ[p,0] && ILtQ[2*m,-2] && Not[IntegerQ[n]] && Not[EqQ[m,-2] && EqQ[p,1] && EqQ[2*c*d-b*e,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  c^p*(d+e*x)^(m+2*p)*(f+g*x)^(n+1)/(g*e^(2*p)*(m+n+2*p+1)) + 
  1/(g*e^(2*p)*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(f+g*x)^n*
    ExpandToSum[g*(m+n+2*p+1)*(e^(2*p)*(a+b*x+c*x^2)^p-c^p*(d+e*x)^(2*p))-c^p*(e*f-d*g)*(m+2*p)*(d+e*x)^(2*p-1),x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[p,0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,n},x] && IGtQ[p,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  g*(d+e*x)^m/(c*m) + 
  1/c \[Star] Int[(d+e*x)^(m-1)*Simp[c*d*f-a*e*g+(g*c*d-b*e*g+c*e*f)*x,x]/(a+b*x+c*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && FractionQ[m] && GtQ[m,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)/(Sqrt[d_.+e_.*x_]*(a_.+b_.*x_+c_.*x_^2)),x_Symbol] :=
  2 \[Star] Subst[Int[(e*f-d*g+g*x^2)/(c*d^2-b*d*e+a*e^2-(2*c*d-b*e)*x^2+c*x^4),x],x,Sqrt[d+e*x]] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  (e*f-d*g)*(d+e*x)^(m+1)/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/(c*d^2-b*d*e+a*e^2) \[Star] Int[(d+e*x)^(m+1)*Simp[c*d*f-f*b*e+a*e*g-c*(e*f-d*g)*x,x]/(a+b*x+c*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && FractionQ[m] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  With[{q=Denominator[m]},
  q/e \[Star] Subst[Int[ExpandIntegrand[x^(q*(m+1)-1)*((e*f-d*g)/e+g*x^q/e)^n/((c*d^2-b*d*e+a*e^2)/e^2-(2*c*d-b*e)*x^q/e^2+c*x^(2*q)/e^2),x],x],x,(d+e*x)^(1/q)]] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[n] && FractionQ[m]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_./(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n/(a+b*x+c*x^2),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && IntegersQ[n]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  g/c^2 \[Star] Int[Simp[2*c*e*f+c*d*g-b*e*g+c*e*g*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n-2),x] + 
  1/c^2 \[Star] Int[Simp[c^2*d*f^2-2*a*c*e*f*g-a*c*d*g^2+a*b*e*g^2+(c^2*e*f^2+2*c^2*d*f*g-2*b*c*e*f*g-b*c*d*g^2+b^2*e*g^2-a*c*e*g^2)*x,x]*
    (d+e*x)^(m-1)*(f+g*x)^(n-2)/(a+b*x+c*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m,0] && GtQ[n,1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  e*g/c \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^(n-1),x] + 
  1/c \[Star] Int[Simp[c*d*f-a*e*g+(c*e*f+c*d*g-b*e*g)*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n-1)/(a+b*x+c*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && 
  Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m,0] && GtQ[n,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  -g*(e*f-d*g)/(c*f^2-b*f*g+a*g^2) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^n,x] + 
  1/(c*f^2-b*f*g+a*g^2) \[Star] 
    Int[Simp[c*d*f-b*d*g+a*e*g+c*(e*f-d*g)*x,x]*(d+e*x)^(m-1)*(f+g*x)^(n+1)/(a+b*x+c*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && 
  Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m,0] && LtQ[n,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_/(Sqrt[f_.+g_.*x_]*(a_.+b_.*x_+c_.*x_^2)),x_Symbol] :=
  Int[ExpandIntegrand[1/(Sqrt[d+e*x]*Sqrt[f+g*x]),(d+e*x)^(m+1/2)/(a+b*x+c*x^2),x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[m+1/2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_/(a_.+b_.*x_+c_.*x_^2),x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n,1/(a+b*x+c*x^2),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,n},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_+g_.*x_)^n_.*(b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[x^p*(d+e*x)^m*(f+g*x)^n*(b+c*x)^p,x],x] /;
FreeQ[{b,c,d,e,f,g},x] && ILtQ[p,-1] && IntegersQ[m,n]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
    1/c^p \[Star] Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(b/2-q/2+c*x)^p*(b/2+q/2+c*x)^p,x],x] /;
 Not[FractionalPowerFactorQ[q]]] /;
FreeQ[{a,b,c,d,e,f,g},x] && ILtQ[p,-1] && IntegersQ[m,n] && NiceSqrtQ[b^2-4*a*c]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^2*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  g^2*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/(c*e*(m+2*p+3)) /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[b*e*g*(m+p+2)+2*c*(d*g*(p+1)-e*f*(m+2*p+3)),0] && 
  EqQ[e*(c*f^2-b*f*g+a*g^2)*(m+1)+(2*c*f-b*g)*(e*f-d*g)*(p+1),0] && NeQ[m+2*p+3,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_.*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[(f+g*x)^n*(a*d+c*e*x^3)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[b*d+a*e,0] && EqQ[c*d+b*e,0] && EqQ[m,p] && ILtQ[p,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_.*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^FracPart[p]*(a+b*x+c*x^2)^FracPart[p]/(a*d+c*e*x^3)^FracPart[p] \[Star] Int[(f+g*x)^n*(a*d+c*e*x^3)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[b*d+a*e,0] && EqQ[c*d+b*e,0] && EqQ[m,p]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_./(a_.+b_.*x_+c_.*x_^2)^(3/2),x_Symbol] :=
  -2*(2*c*d-b*e)^(m-2)*(c*(e*f+d*g)-b*e*g)^n*(d+e*x)/(c^(m+n-1)*e^(n-1)*Sqrt[a+b*x+c*x^2]) + 
  1/(c^(m+n-1)*e^(n-2)) \[Star] 
    Int[ExpandToSum[((2*c*d-b*e)^(m-1)*(c*(e*f+d*g)-b*e*g)^n-c^(m+n-1)*e^n*(d+e*x)^(m-1)*(f+g*x)^n)/(c*d-b*e-c*e*x),x]/Sqrt[a+b*x+c*x^2],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && IGtQ[m,0] && IGtQ[n,0]


(* ::Code:: *)
Int[x_^n_.*(d_.+e_.*x_)^m_./(a_+b_.*x_+c_.*x_^2)^(3/2),x_Symbol] :=
  -2*(2*c*d-b*e)^(m-2)*(c*d-b*e)^n*(d+e*x)/(c^(m+n-1)*e^(n-1)*Sqrt[a+b*x+c*x^2]) - 
  e^2/c^(m+n-1) \[Star] 
    Int[ExpandToSum[(c^(m+n-1)*(d+e*x)^(m-1)-((c*d-b*e)^n*(2*c*d-b*e)^(m-1))*e^(-n)*x^(-n))/(c*d-b*e-c*e*x),x]/(Sqrt[a+b*x+c*x^2]/x^n),x] /;
FreeQ[{a,b,c,d,e},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && IGtQ[m,0] && ILtQ[n,0]


(* ::Code:: *)
Int[x_^n_.*(d_.+e_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -2*(-d)^n*e^(2*m-n+3)*Sqrt[a+b*x+c*x^2]/((-2*c*d+b*e)^(m+2)*(d+e*x)) - 
  e^(2*m-n+2) \[Star] Int[ExpandToSum[((-d)^n*(-2*c*d+b*e)^(-m-1)-e^n*x^n*((-c)*d+b*e+c*e*x)^(-m-1))/(d+e*x),x]/Sqrt[a+b*x+c*x^2],x] /;
FreeQ[{a,b,c,d,e},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[m,0] && IGtQ[n,0] && EqQ[m+p,-3/2]


(* ::Code:: *)
Int[x_^n_.*(d_.+e_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -2*(-d)^n*e^(2*m-n+3)*Sqrt[a+b*x+c*x^2]/((-2*c*d+b*e)^(m+2)*(d+e*x)) - 
  e^(2*m+2) \[Star] Int[ExpandToSum[((-d)^n*(-2*c*d+b*e)^(-m-1)*e^(-n)*x^(-n)-(-c*d+b*e+c*e*x)^(-m-1))/(d+e*x),x]/(x^(-n)*Sqrt[a+b*x+c*x^2]),x] /;
FreeQ[{a,b,c,d,e},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[m,0] && ILtQ[n,0] && EqQ[m+p,-3/2]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  Int[(a/d+c*x/e)*(f+g*x)^n*(a+b*x+c*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,f,g,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && GtQ[p,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_.*Sqrt[a_.+b_.*x_+c_.*x_^2],x_Symbol] :=
  Int[(a/d+c*x/e)^(-m)*(f+g*x)^n*(a+b*x+c*x^2)^(m+1/2),x] /;
FreeQ[{a,b,c,d,e,f,g,n},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[m,0] && IntegerQ[n]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  g*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(c*(m+2*p+2)) /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[c*e*f*(m+2*p+2)+g*(c*d*m-b*e*(m+p+1)),0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (g*(c*d-b*e)+c*e*f)*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(c*(p+1)*(2*c*d-b*e)) - 
  e*(m*(g*(c*d-b*e)+c*e*f)+e*(p+1)*(2*c*f-b*g))/(c*(p+1)*(2*c*d-b*e)) \[Star] 
    Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && LtQ[p,-1] && GtQ[m,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (g*(c*d-b*e)+c*e*f)*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(c*(p+1)*(2*c*d-b*e)) - 
  e*(m*(g*(c*d-b*e)+c*e*f)+e*(p+1)*(2*c*f-b*g))/(c*(p+1)*(2*c*d-b*e)) \[Star] 
    Int[(d+e*x)^Simplify[m-1]*(a+b*x+c*x^2)^Simplify[p+1],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && SumSimplerQ[p,1] && SumSimplerQ[m,-1] && NeQ[p,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d*g-e*f)*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/((2*c*d-b*e)*(m+p+1)) + 
  (m*(g*(c*d-b*e)+c*e*f)+e*(p+1)*(2*c*f-b*g))/(e*(2*c*d-b*e)*(m+p+1)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && 
  (LtQ[m,-1] && Not[IGtQ[m+p+1,0]] || LtQ[m,0] && LtQ[p,-1] || EqQ[m+2*p+2,0]) && NeQ[m+p+1,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  g*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(c*(m+2*p+2)) + 
  (m*(g*(c*d-b*e)+c*e*f)+e*(p+1)*(2*c*f-b*g))/(c*e*(m+2*p+2)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && NeQ[m+2*p+2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  g*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(2*c*(p+1)) - 
  e*g*m/(2*c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[2*c*f-b*g,0] && LtQ[p,-1] && GtQ[m,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -(b*e*g*(p+2)-c*(e*f+d*g)*(2*p+3)-2*c*e*g*(p+1)*x)*(a+b*x+c*x^2)^(p+1)/(2*c^2*(p+1)*(2*p+3)) /;
FreeQ[{a,b,c,d,e,f,g,p},x] && EqQ[b^2*e*g*(p+2)-2*a*c*e*g+c*(2*c*d*f-b*(e*f+d*g))*(2*p+3),0] && NeQ[p,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -(2*a*c*(e*f+d*g)-b*(c*d*f+a*e*g)-(b^2*e*g-b*c*(e*f+d*g)+2*c*(c*d*f-a*e*g))*x)*(a+b*x+c*x^2)^(p+1)/(c*(p+1)*(b^2-4*a*c)) - 
  (b^2*e*g*(p+2)-2*a*c*e*g+c*(2*c*d*f-b*(e*f+d*g))*(2*p+3))/(c*(p+1)*(b^2-4*a*c)) \[Star] Int[(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && LtQ[p,-1] && Not[IntegerQ[p] && NeQ[a,0] && NiceSqrtQ[b^2-4*a*c]]


(* ::Code:: *)
Int[(d_.+e_.*x_)*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -(b*e*g*(p+2)-c*(e*f+d*g)*(2*p+3)-2*c*e*g*(p+1)*x)*(a+b*x+c*x^2)^(p+1)/(2*c^2*(p+1)*(2*p+3)) + 
  (b^2*e*g*(p+2)-2*a*c*e*g+c*(2*c*d*f-b*(e*f+d*g))*(2*p+3))/(2*c^2*(2*p+3)) \[Star] Int[(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,p},x] && Not[LeQ[p,-1]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  -(e*f-d*g)*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/(2*(p+1)*(c*d^2-b*d*e+a*e^2)) /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[Simplify[m+2*p+3],0] && EqQ[b*(e*f+d*g)-2*(c*d*f+a*e*g),0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^m*(a+b*x+c*x^2)^(p+1)*(b*f-2*a*g+(2*c*f-b*g)*x)/((p+1)*(b^2-4*a*c)) - 
  m*(b*(e*f+d*g)-2*(c*d*f+a*e*g))/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[Simplify[m+2*p+3],0] && LtQ[p,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  -(e*f-d*g)*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/(2*(p+1)*(c*d^2-b*d*e+a*e^2)) - 
  (b*(e*f+d*g)-2*(c*d*f+a*e*g))/(2*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[Simplify[m+2*p+3],0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  -(d+e*x)^(m+1)*(a+b*x+c*x^2)^p/(e^2*(m+1)*(m+2)*(c*d^2-b*d*e+a*e^2))*
    ((d*g-e*f*(m+2))*(c*d^2-b*d*e+a*e^2)-d*p*(2*c*d-b*e)*(e*f-d*g)-e*(g*(m+1)*(c*d^2-b*d*e+a*e^2)+p*(2*c*d-b*e)*(e*f-d*g))*x) - 
  p/(e^2*(m+1)*(m+2)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+2)*(a+b*x+c*x^2)^(p-1)*
    Simp[2*a*c*e*(e*f-d*g)*(m+2)+b^2*e*(d*g*(p+1)-e*f*(m+p+2))+b*(a*e^2*g*(m+1)-c*d*(d*g*(2*p+1)-e*f*(m+2*p+2)))-
      c*(2*c*d*(d*g*(2*p+1)-e*f*(m+2*p+2))-e*(2*a*e*g*(m+1)-b*(d*g*(m-2*p)+e*f*(m+2*p+2))))*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && GtQ[p,0] && LtQ[m,-2] && LtQ[m+2*p,0] && Not[ILtQ[m+2*p+3,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^(m+1)*(e*f*(m+2*p+2)-d*g*(2*p+1)+e*g*(m+1)*x)*(a+b*x+c*x^2)^p/(e^2*(m+1)*(m+2*p+2)) + 
  p/(e^2*(m+1)*(m+2*p+2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p-1)*
    Simp[g*(b*d+2*a*e+2*a*e*m+2*b*d*p)-f*b*e*(m+2*p+2)+(g*(2*c*d+b*e+b*e*m+4*c*d*p)-2*c*e*f*(m+2*p+2))*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && GtQ[p,0] && 
  (LtQ[m,-1] || EqQ[p,1] || IntegerQ[p] && Not[RationalQ[m]]) && NeQ[m,-1] && Not[ILtQ[m+2*p+1,0]] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (d+e*x)^(m+1)*(c*e*f*(m+2*p+2)-g*(c*d+2*c*d*p-b*e*p)+g*c*e*(m+2*p+1)*x)*(a+b*x+c*x^2)^p/
    (c*e^2*(m+2*p+1)*(m+2*p+2)) - 
  p/(c*e^2*(m+2*p+1)*(m+2*p+2)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^(p-1)*
    Simp[c*e*f*(b*d-2*a*e)*(m+2*p+2)+g*(a*e*(b*e-2*c*d*m+b*e*m)+b*d*(b*e*p-c*d-2*c*d*p))+
      (c*e*f*(2*c*d-b*e)*(m+2*p+2)+g*(b^2*e^2*(p+m+1)-2*c^2*d^2*(1+2*p)-c*e*(b*d*(m-2*p)+2*a*e*(m+2*p+1))))*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && 
  GtQ[p,0] && (IntegerQ[p] || Not[RationalQ[m]] || GeQ[m,-1] && LtQ[m,0]) && Not[ILtQ[m+2*p,0]] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[(a+b*x+c*x^2)^p*ExpandIntegrand[(d+e*x)^m*(f+g*x),x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && ILtQ[p,-1] && IGtQ[m,0] && RationalQ[a,b,c,d,e,f,g]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  -(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*(2*a*c*(e*f+d*g)-b*(c*d*f+a*e*g)-(2*c^2*d*f+b^2*e*g-c*(b*e*f+b*d*g+2*a*e*g))*x)/
    (c*(p+1)*(b^2-4*a*c)) - 
  1/(c*(p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-2)*(a+b*x+c*x^2)^(p+1)*
    Simp[2*c^2*d^2*f*(2*p+3)+b*e*g*(a*e*(m-1)+b*d*(p+2))-c*(2*a*e*(e*f*(m-1)+d*g*m)+b*d*(d*g*(2*p+3)-e*f*(m-2*p-4))) + 
      e*(b^2*e*g*(m+p+1)+2*c^2*d*f*(m+2*p+2)-c*(2*a*e*g*m+b*(e*f+d*g)*(m+2*p+2)))*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && LtQ[p,-1] && GtQ[m,1] && 
  (EqQ[m,2] && EqQ[p,-3] && RationalQ[a,b,c,d,e,f,g] || Not[ILtQ[m+2*p+3,0]])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^m*(a+b*x+c*x^2)^(p+1)*(f*b-2*a*g+(2*c*f-b*g)*x)/((p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*
    Simp[g*(2*a*e*m+b*d*(2*p+3))-f*(b*e*m+2*c*d*(2*p+3))-e*(2*c*f-b*g)*(m+2*p+3)*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && LtQ[p,-1] && GtQ[m,0] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^(m+1)*(f*(b*c*d-b^2*e+2*a*c*e)-a*g*(2*c*d-b*e)+c*(f*(2*c*d-b*e)-g*(b*d-2*a*e))*x)*(a+b*x+c*x^2)^(p+1)/
    ((p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) + 
  1/((p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^(p+1)*
    Simp[f*(b*c*d*e*(2*p-m+2)+b^2*e^2*(p+m+2)-2*c^2*d^2*(2*p+3)-2*a*c*e^2*(m+2*p+3))-
      g*(a*e*(b*e-2*c*d*m+b*e*m)-b*d*(3*c*d-b*e+2*c*d*p-b*e*p))+
      c*e*(g*(b*d-2*a*e)-f*(2*c*d-b*e))*(m+2*p+4)*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && LtQ[p,-1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  g*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(c*(m+2*p+2)) + 
  1/(c*(m+2*p+2)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^p*
    Simp[m*(c*d*f-a*e*g)+d*(2*c*f-b*g)*(p+1)+(m*(c*e*f+c*d*g-b*e*g)+e*(p+1)*(2*c*f-b*g))*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g,p},x] && GtQ[m,0] && NeQ[m+2*p+2,0] && 
  (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p]) && Not[IGtQ[m,0] && EqQ[f,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (e*f-d*g)*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/((m+1)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p*
    Simp[(c*d*f-f*b*e+a*e*g)*(m+1)+b*(d*g-e*f)*(p+1)-c*(e*f-d*g)*(m+2*p+3)*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g,p},x] && LtQ[m,-1] && (IntegerQ[m] || IntegerQ[p] || IntegersQ[2*m,2*p])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  (e*f-d*g)*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/((m+1)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p*
    Simp[(c*d*f-f*b*e+a*e*g)*(m+1)+b*(d*g-e*f)*(p+1)-c*(e*f-d*g)*(m+2*p+3)*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && ILtQ[Simplify[m+2*p+3],0] && NeQ[m,-1]


(* ::Code:: *)
Int[(f_+g_.*x_)/((d_.+e_.*x_)*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  4*f*(a-d)/(b*d-a*e) \[Star] Subst[Int[1/(4*(a-d)-x^2),x],x,(2*(a-d)+(b-e)*x)/Sqrt[a+b*x+c*x^2]] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[4*c*(a-d)-(b-e)^2,0] && EqQ[e*f*(b-e)-2*g*(b*d-a*e),0] && NeQ[b*d-a*e,0]


(* ::Code:: *)
Int[(f_+g_.*x_)/(Sqrt[x_]*Sqrt[a_+b_.*x_+c_.*x_^2]),x_Symbol] :=
  2 \[Star] Subst[Int[(f+g*x^2)/Sqrt[a+b*x^2+c*x^4],x],x,Sqrt[x]] /;
FreeQ[{a,b,c,f,g},x]


(* ::Code:: *)
Int[(f_+g_.*x_)/(Sqrt[e_*x_]*Sqrt[a_+b_.*x_+c_.*x_^2]),x_Symbol] :=
  Sqrt[x]/Sqrt[e*x] \[Star] Int[(f+g*x)/(Sqrt[x]*Sqrt[a+b*x+c*x^2]),x] /;
FreeQ[{a,b,c,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a*e+c*d*x,x], R=PolynomialRemainder[(f+g*x)^n,a*e+c*d*x,x]},
  R*(2*c*d-b*e)*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(e*(p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[d*e*(p+1)*(b^2-4*a*c)*Q-R*(2*c*d-b*e)*(m+2*p+2),x],x]] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[n,1] && IGtQ[m,0] && LtQ[p,-1] && EqQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  -(2*c*d-b*e)*(f+g*x)^n*(a+b*x+c*x^2)^(p+1)/(e*p*(b^2-4*a*c)*(d+e*x)) + 
  n*(a*g*(2*c*d-b*e)-c*f*(b*d-2*a*e))/(d*e*p*(b^2-4*a*c)) \[Star] Int[(f+g*x)^(n-1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && IGtQ[n,1] && LtQ[p,-1] && EqQ[n+2*p+1,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_+b_.*x_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  -(e*f-d*g)*(f+g*x)^(n-1)*(a+b*x+c*x^2)^(p+1)/(p*(2*c*d-b*e)*(d+e*x)) + 
  1/(p*e^2*(2*c*d-b*e)) \[Star] Int[(f+g*x)^(n-2)*(a+b*x+c*x^2)^p*
    Simp[b*e*g*(-e*f+d*g+e*f*n-d*g*n-e*f*p)+c*(d^2*g^2*(n-1)-d*e*f*g*n+e^2*f^2*(2*p+1))-e*g*(b*e*g*p-c*(e*f*n-d*g*n+2*e*f*p))*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && EqQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
(* Int[(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  -(2*c*d-b*e)*(f+g*x)^n*(a+b*x+c*x^2)^(p+1)/(e*p*(b^2-4*a*c)*(d+e*x)) - 
  1/(d*e*p*(b^2-4*a*c)) \[Star] Int[(f+g*x)^(n-1)*(a+b*x+c*x^2)^p*
    Simp[b*(a*e*g*n-c*d*f*(2*p+1))-2*a*c*(d*g*n-e*f*(2*p+1))-c*g*(b*d-2*a*e)*(n+2*p+1)*x,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && EqQ[c*d^2-b*d*e+a*e^2,0] *)


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[(d+e*x)^(m+p)*(f+g*x)^n*(a/d+c/e*x)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && GtQ[a,0] && GtQ[d,0] && LtQ[c,0]


(* ::Code:: *)
(* Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[(a/d+c*x/e)^(-m)*(f+g*x)^n*(a+b*x+c*x^2)^(m+p),x] /;
FreeQ[{a,b,c,d,e,f,g,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[m,0] && IntegerQ[n] && (LtQ[n,0] || GtQ[p,0]) *)


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_/(d_+e_.*x_),x_Symbol] :=
  (f+g*x)^(n+1)*(a+b*x+c*x^2)^p*(c*d-b*e-c*e*x)/(p*(2*c*d-b*e)*(e*f-d*g)) + 
  1/(p*(2*c*d-b*e)*(e*f-d*g)) \[Star] Int[(f+g*x)^n*(a+b*x+c*x^2)^p*(b*e*g*(n+p+1)+c*e*f*(2*p+1)-c*d*g*(n+2*p+1)+c*e*g*(n+2*p+2)*x),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[n,0] && ILtQ[n+2*p,0] && Not[IGtQ[n,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -e*(d+e*x)^(m-1)*(f+g*x)^n*(a+b*x+c*x^2)^(p+1)/(c*(m-n-1)) /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && EqQ[c*e*f+c*d*g-b*e*g,0] && NeQ[m-n-1,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -e^2*(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p+1)/((n+1)*(c*e*f+c*d*g-b*e*g)) /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && EqQ[m-n-2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (d+e*x)^m*(f+g*x)^(n+1)*(a+b*x+c*x^2)^p/(g*(n+1)) + 
  c*m/(e*g*(n+1)) \[Star] Int[(d+e*x)^(m+1)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && GtQ[p,0] && LtQ[n,-1] && Not[IntegerQ[n+p] && LeQ[n+p+2,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -(d+e*x)^m*(f+g*x)^(n+1)*(a+b*x+c*x^2)^p/(g*(m-n-1)) - 
  m*(c*e*f+c*d*g-b*e*g)/(e^2*g*(m-n-1)) \[Star] Int[(d+e*x)^(m+1)*(f+g*x)^n*(a+b*x+c*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,f,g,n},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && GtQ[p,0] && NeQ[m-n-1,0] && Not[IGtQ[n,0]] && Not[IntegerQ[n+p] && LtQ[n+p+2,0]] && RationalQ[n]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  e*(d+e*x)^(m-1)*(f+g*x)^n*(a+b*x+c*x^2)^(p+1)/(c*(p+1)) - 
  e*g*n/(c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^(n-1)*(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && LtQ[p,-1] && GtQ[n,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p+1)/((p+1)*(c*e*f+c*d*g-b*e*g)) + 
  e^2*g*(m-n-2)/((p+1)*(c*e*f+c*d*g-b*e*g)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^n*(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,f,g,n},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && LtQ[p,-1] && RationalQ[n]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -e*(d+e*x)^(m-1)*(f+g*x)^n*(a+b*x+c*x^2)^(p+1)/(c*(m-n-1)) - 
  n*(c*e*f+c*d*g-b*e*g)/(c*e*(m-n-1)) \[Star] Int[(d+e*x)^m*(f+g*x)^(n-1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && GtQ[n,0] && NeQ[m-n-1,0] && (IntegerQ[2*p] || IntegerQ[n])


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  -e^2*(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p+1)/((n+1)*(c*e*f+c*d*g-b*e*g)) - 
  c*e*(m-n-2)/((n+1)*(c*e*f+c*d*g-b*e*g)) \[Star] Int[(d+e*x)^m*(f+g*x)^(n+1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p,0] && LtQ[n,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[Sqrt[d_+e_.*x_]/((f_.+g_.*x_)*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  2*e^2 \[Star] Subst[Int[1/(c*(e*f+d*g)-b*e*g+e^2*g*x^2),x],x,Sqrt[a+b*x+c*x^2]/Sqrt[d+e*x]] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(d+e*x)^(m-2)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p+1)/(c*g*(n+p+2)) /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p-1,0] && EqQ[b*e*g*(n+1)+c*e*f*(p+1)-c*d*g*(2*n+p+3),0] && NeQ[n+p+2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(e*f-d*g)*(d+e*x)^(m-2)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p+1)/(g*(n+1)*(c*e*f+c*d*g-b*e*g)) - 
  e*(b*e*g*(n+1)+c*e*f*(p+1)-c*d*g*(2*n+p+3))/(g*(n+1)*(c*e*f+c*d*g-b*e*g)) \[Star] 
    Int[(d+e*x)^(m-1)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p-1,0] && LtQ[n,-1] && IntegerQ[2*p]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  e^2*(d+e*x)^(m-2)*(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p+1)/(c*g*(n+p+2)) - 
  (b*e*g*(n+1)+c*e*f*(p+1)-c*d*g*(2*n+p+3))/(c*g*(n+p+2)) \[Star] Int[(d+e*x)^(m-1)*(f+g*x)^n*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+p-1,0] && Not[LtQ[n,-1]] && IntegerQ[2*p]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,f,g,n,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[m,0] && (ILtQ[n,0] || IGtQ[n,0] && ILtQ[p+1/2,0]) && Not[IGtQ[n,0]]


(* ::Code:: *)
(* Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a*e+c*d*x,x], R=PolynomialRemainder[(f+g*x)^n,a*e+c*d*x,x]},
  R*(2*c*d-b*e)*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(e*(p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[d*e*(p+1)*(b^2-4*a*c)*Q-R*(2*c*d-b*e)*(m+2*p+2),x],x]] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[p+1/2,0] && IGtQ[m,0] && IGtQ[n,0] *)


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x+c*x^2)^p,(d+e*x)^m*(f+g*x)^n,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+n+2*p+1,0] && ILtQ[m,0] && ILtQ[n,0]


(* ::Code:: *)
Int[(e_.*x_)^m_*(f_.+g_.*x_)^n_*(b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (e*x)^m*(b*x+c*x^2)^p/(x^(m+p)*(b+c*x)^p) \[Star] Int[x^(m+p)*(f+g*x)^n*(b+c*x)^p,x] /;
FreeQ[{b,c,e,f,g,m,n},x] && Not[IGtQ[n,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  g^n*(d+e*x)^(m+n-1)*(a+b*x+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 
  1/(c*e^n*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p*
    ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^n+e*g^n*(m+p+n)*(d+e*x)^(n-2)*(b*d-2*a*e+(2*c*d-b*e)*x),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && IGtQ[n,0] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a+b*x+c*x^2,x],
        R=Coeff[PolynomialRemainder[(f+g*x)^n,a+b*x+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(f+g*x)^n,a+b*x+c*x^2,x],x,1]},
  (d+e*x)^m*(a+b*x+c*x^2)^(p+1)*(R*b-2*a*S+(2*c*R-b*S)*x)/((p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[(p+1)*(b^2-4*a*c)*(d+e*x)*Q+S*(2*a*e*m+b*d*(2*p+3))-R*(b*e*m+2*c*d*(2*p+3))-e*(2*c*R-b*S)*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && GtQ[m,0] && NeQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(d+e*x)^m*(f+g*x)^n,a+b*x+c*x^2,x],
        R=Coeff[PolynomialRemainder[(d+e*x)^m*(f+g*x)^n,a+b*x+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(d+e*x)^m*(f+g*x)^n,a+b*x+c*x^2,x],x,1]},
  (b*R-2*a*S+(2*c*R-b*S)*x)*(a+b*x+c*x^2)^(p+1)/((p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[(p+1)*(b^2-4*a*c)*(d+e*x)^(-m)*Q-(2*p+3)*(2*c*R-b*S)*(d+e*x)^(-m),x],x]] /;
FreeQ[{a,b,c,d,e,f,g},x] && IGtQ[n,1] && LtQ[p,-1] && ILtQ[m,0] && NeQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,a+b*x+c*x^2,x],
        R=Coeff[PolynomialRemainder[(f+g*x)^n,a+b*x+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(f+g*x)^n,a+b*x+c*x^2,x],x,1]},
  (d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)*(R*(b*c*d-b^2*e+2*a*c*e)-a*S*(2*c*d-b*e)+c*(R*(2*c*d-b*e)-S*(b*d-2*a*e))*x)/
    ((p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) + 
  1/((p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^(p+1)*
   ExpandToSum[(p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)*Q+
      R*(b*c*d*e*(2*p-m+2)+b^2*e^2*(p+m+2)-2*c^2*d^2*(2*p+3)-2*a*c*e^2*(m+2*p+3))-
      S*(a*e*(b*e-2*c*d*m+b*e*m)-b*d*(3*c*d-b*e+2*c*d*p-b*e*p))+
      c*e*(S*(b*d-2*a*e)-R*(2*c*d-b*e))*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && IGtQ[n,1] && LtQ[p,-1] && NeQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,d+e*x,x], R=PolynomialRemainder[(f+g*x)^n,d+e*x,x]},
  (e*R*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1))/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/((m+1)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p*
     ExpandToSum[(m+1)*(c*d^2-b*d*e+a*e^2)*Q+c*d*R*(m+1)-b*e*R*(m+p+2)-c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,e,f,g,p},x] && IGtQ[n,1] && ILtQ[m,-1] && NeQ[c*d^2-b*d*e+a*e^2,0] && (NeQ[m+n,0] || EqQ[p,-1/2])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  g^n*(d+e*x)^(m+n-1)*(a+b*x+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 
  1/(c*e^n*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p*ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^n-
    g^n*(d+e*x)^(n-2)*(b*d*e*(p+1)+a*e^2*(m+n-1)-c*d^2*(m+n+2*p+1)-e*(2*c*d-b*e)*(m+n+p)*x),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && IGtQ[n,1] && IntegerQ[m] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
(*(a+b*x+c*x^2)^p/((d+e*x)^p*(a*e+c*d*x)^p) \[Star] Int[(d+e*x)^(m+p)*(f+g*x)^n*(a*e+c*d*x)^p,x] /; *)
  (a+b*x+c*x^2)^FracPart[p]/((d+e*x)^FracPart[p]*(a/d+(c*x)/e)^FracPart[p]) \[Star] Int[(d+e*x)^(m+p)*(f+g*x)^n*(a/d+c/e*x)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n},x] && EqQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  g/e \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p,x] + (e*f-d*g)/e \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_/((d_.+e_.*x_)*(f_.+g_.*x_)),x_Symbol] :=
  (c*d^2-b*d*e+a*e^2)/(e*(e*f-d*g)) \[Star] Int[(a+b*x+c*x^2)^(p-1)/(d+e*x),x] - 
  1/(e*(e*f-d*g)) \[Star] Int[Simp[c*d*f-b*e*f+a*e*g-c*(e*f-d*g)*x,x]*(a+b*x+c*x^2)^(p-1)/(f+g*x),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && FractionQ[p] && GtQ[p,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2],x_Symbol] :=
  (d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/(e*(m+1)) - 
  1/(2*e*(m+1)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*Simp[b*f+a*g+2*(c*f+b*g)*x+3*c*g*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2],x_Symbol] :=
  2*(d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/(e*(2*m+5)) - 
  1/(e*(2*m+5)) \[Star] Int[(d+e*x)^m/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[b*d*f-3*a*e*f+a*d*g+2*(c*d*f-b*e*f+b*d*g-a*e*g)*x-(c*e*f-3*c*d*g+b*e*g)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m},x] && IntegerQ[2*m] && Not[LtQ[m,-1]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[a_.+b_.*x_+c_.*x_^2]/Sqrt[f_.+g_.*x_],x_Symbol] :=
  2*(d+e*x)^m*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/(g*(2*m+3)) - 
  1/(g*(2*m+3)) \[Star] Int[(d+e*x)^(m-1)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[b*d*f+2*a*(e*f*m-d*g*(m+1))+(2*c*d*f-2*a*e*g+b*(e*f-d*g)*(2*m+1))*x-(b*e*g+2*c*(d*g*m-e*f*(m+1)))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && GtQ[m,0]


(* ::Code:: *)
Int[Sqrt[a_.+b_.*x_+c_.*x_^2]/((d_.+e_.*x_)*Sqrt[f_.+g_.*x_]),x_Symbol] :=
  (c*d^2-b*d*e+a*e^2)/e^2 \[Star] Int[1/((d+e*x)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),x] - 
  1/e^2 \[Star] Int[(c*d-b*e-c*e*x)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),x] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Sqrt[a_.+b_.*x_+c_.*x_^2]/Sqrt[f_.+g_.*x_],x_Symbol] :=
  (d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/((m+1)*(e*f-d*g)) - 
  1/(2*(m+1)*(e*f-d*g)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[b*f+a*g*(2*m+3)+2*(c*f+b*g*(m+2))*x+c*g*(2*m+5)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && LtQ[m,-1]


(* ::Code:: *)
Int[Sqrt[d_.+e_.*x_]/(Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
  Sqrt[2]*Sqrt[2*c*f-g*(b+q)]*Sqrt[b-q+2*c*x]*(d+e*x)*
    Sqrt[(e*f-d*g)*(b+q+2*c*x)/((2*c*f-g*(b+q))*(d+e*x))]*
    Sqrt[(e*f-d*g)*(2*a+(b+q)*x)/((b*f+q*f-2*a*g)*(d+e*x))]/
   (g*Sqrt[2*c*d-e*(b+q)]*Sqrt[2*a*c/(b+q)+c*x]*Sqrt[a+b*x+c*x^2])*
    EllipticPi[e*(2*c*f-g*(b+q))/(g*(2*c*d-e*(b+q))),
      ArcSin[Sqrt[2*c*d-e*(b+q)]*Sqrt[f+g*x]/(Sqrt[2*c*f-g*(b+q)]*Sqrt[d+e*x])],
      (b*d+q*d-2*a*e)*(2*c*f-g*(b+q))/((b*f+q*f-2*a*g)*(2*c*d-e*(b+q)))]] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^(3/2)/(Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  e/g \[Star] Int[Sqrt[d+e*x]*Sqrt[f+g*x]/Sqrt[a+b*x+c*x^2],x] - 
  (e*f-d*g)/g \[Star] Int[Sqrt[d+e*x]/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),x] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_/(Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  2*e^2*(d+e*x)^(m-2)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/(c*g*(2*m-1)) - 
  1/(c*g*(2*m-1)) \[Star] Int[(d+e*x)^(m-3)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[b*d*e^2*f+a*e^2*(d*g+2*e*f*(m-2))-c*d^3*g*(2*m-1)+
      e*(e*(2*b*d*g+e*(b*f+a*g)*(2*m-3))+c*d*(2*e*f-3*d*g*(2*m-1)))*x+
      2*e^2*(c*e*f-3*c*d*g+b*e*g)*(m-1)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && GeQ[m,2]


(* ::Code:: *)
Int[1/((d_.+e_.*x_)*Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
  Sqrt[b-q+2*c*x]*Sqrt[b+q+2*c*x]/Sqrt[a+b*x+c*x^2] \[Star] Int[1/((d+e*x)*Sqrt[f+g*x]*Sqrt[b-q+2*c*x]*Sqrt[b+q+2*c*x]),x]] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[1/(Sqrt[d_.+e_.*x_]*Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  -2*(d+e*x)*Sqrt[(e*f-d*g)^2*(a+b*x+c*x^2)/((c*f^2-b*f*g+a*g^2)*(d+e*x)^2)]/((e*f-d*g)*Sqrt[a+b*x+c*x^2]) \[Star] 
  Subst[
    Int[1/Sqrt[1-(2*c*d*f-b*e*f-b*d*g+2*a*e*g)*x^2/(c*f^2-b*f*g+a*g^2)+(c*d^2-b*d*e+a*e^2)*x^4/(c*f^2-b*f*g+a*g^2)],x],
    x,
    Sqrt[f+g*x]/Sqrt[d+e*x]] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[1/((d_.+e_.*x_)^(3/2)*Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  -g/(e*f-d*g) \[Star] Int[1/(Sqrt[d+e*x]*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),x] + 
  e/(e*f-d*g) \[Star] Int[Sqrt[f+g*x]/((d+e*x)^(3/2)*Sqrt[a+b*x+c*x^2]),x] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_/(Sqrt[f_.+g_.*x_]*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  e^2*(d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/((m+1)*(e*f-d*g)*(c*d^2-b*d*e+a*e^2)) + 
  1/(2*(m+1)*(e*f-d*g)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[2*d*(c*e*f-c*d*g+b*e*g)*(m+1)-e^2*(b*f+a*g)*(2*m+3)+2*e*(c*d*g*(m+1)-e*(c*f+b*g)*(m+2))*x-c*e^2*g*(2*m+5)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && LeQ[m,-2]


(* ::Code:: *)
(* Int[Sqrt[d_.+e_.*x_]*Sqrt[f_.+g_.*x_]/Sqrt[a_.+b_.*x_+c_.*x_^2],x_Symbol] :=
  0 /;
FreeQ[{a,b,c,d,e,f,g},x] *)


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*Sqrt[f_.+g_.*x_]/Sqrt[a_.+b_.*x_+c_.*x_^2],x_Symbol] :=
  2*e*(d+e*x)^(m-1)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/(c*(2*m+1)) - 
  1/(c*(2*m+1)) \[Star] Int[(d+e*x)^(m-2)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[e*(b*d*f+a*(d*g+2*e*f*(m-1)))-c*d^2*f*(2*m+1)+
      (a*e^2*g*(2*m-1)-c*d*(4*e*f*m+d*g*(2*m+1))+b*e*(2*d*g+e*f*(2*m-1)))*x+
      e*(2*b*e*g*m-c*(e*f+d*g*(4*m-1)))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && GtQ[m,1]


(* ::Code:: *)
Int[Sqrt[f_.+g_.*x_]/((d_.+e_.*x_)*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  g/e \[Star] Int[1/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),x] + 
  (e*f-d*g)/e \[Star] Int[1/((d+e*x)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),x] /;
FreeQ[{a,b,c,d,e,f,g},x]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*Sqrt[f_.+g_.*x_]/Sqrt[a_.+b_.*x_+c_.*x_^2],x_Symbol] :=
  e*(d+e*x)^(m+1)*Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/(2*(m+1)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2])*
    Simp[2*c*d*f*(m+1)-e*(a*g+b*f*(2*m+3))-2*(b*e*g*(2+m)-c*(d*g*(m+1)-e*f*(m+2)))*x-c*e*g*(2*m+5)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[2*m] && LeQ[m,-2]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_/(d_.+e_.*x_),x_Symbol] :=
  (c*d^2-b*d*e+a*e^2)/(e*(e*f-d*g)) \[Star] Int[(f+g*x)^(n+1)*(a+b*x+c*x^2)^(p-1)/(d+e*x),x] - 
  1/(e*(e*f-d*g)) \[Star] Int[(f+g*x)^n*(c*d*f-b*e*f+a*e*g-c*(e*f-d*g)*x)*(a+b*x+c*x^2)^(p-1),x] /;
FreeQ[{a,b,c,d,e,f,g},x] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && GtQ[p,0] && LtQ[n,-1]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_/(d_.+e_.*x_),x_Symbol] :=
  e*(e*f-d*g)/(c*d^2-b*d*e+a*e^2) \[Star] Int[(f+g*x)^(n-1)*(a+b*x+c*x^2)^(p+1)/(d+e*x),x] + 
  1/(c*d^2-b*d*e+a*e^2) \[Star] Int[(f+g*x)^(n-1)*(c*d*f-b*e*f+a*e*g-c*(e*f-d*g)*x)*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g},x] && 
  Not[IntegerQ[n]] && Not[IntegerQ[p]] && LtQ[p,-1] && GtQ[n,0]


(* ::Code:: *)
Int[(f_.+g_.*x_)^n_/((d_.+e_.*x_)*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  Int[ExpandIntegrand[1/(Sqrt[f+g*x]*Sqrt[a+b*x+c*x^2]),(f+g*x)^(n+1/2)/(d+e*x),x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegerQ[n+1/2]


(* ::Code:: *)
(* Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Denominator[m]},
  q/e \[Star] Subst[Int[x^(q*(m+1)-1)*((e*f-d*g)/e+g*x^q/e)^n*
    ((c*d^2-b*d*e+a*e^2)/e^2-(2*c*d-b*e)*x^q/e^2+c*x^(2*q)/e^2)^p,x],x,(d+e*x)^(1/q)]] /;
FreeQ[{a,b,c,d,e,f,g},x] && IntegersQ[n,p] && FractionQ[m] *)


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,f,g},x] && (IntegerQ[p] || ILtQ[m,0] && ILtQ[n,0])


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[(f+g*x)^n,d+e*x,x], R=PolynomialRemainder[(f+g*x)^n,d+e*x,x]},
  (e*R*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1))/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/((m+1)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p*
     ExpandToSum[(m+1)*(c*d^2-b*d*e+a*e^2)*Q+c*d*R*(m+1)-b*e*R*(m+p+2)-c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,e,f,g,p},x] && IGtQ[n,1] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  g^n*(d+e*x)^(m+n-1)*(a+b*x+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 
  1/(c*e^n*(m+n+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p*ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^n-
    g^n*(d+e*x)^(n-2)*(b*d*e*(p+1)+a*e^2*(m+n-1)-c*d^2*(m+n+2*p+1)-e*(2*c*d-b*e)*(m+n+p)*x),x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,p},x] && IGtQ[n,1] && NeQ[m+n+2*p+1,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Unintegrable[(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Code:: *)
Int[(d_.+e_.*u_)^m_.*(f_.+g_.*u_)^n_.*(a_+b_.*u_+c_.*u_^2)^p_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x],x,u] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && LinearQ[u,x] && NeQ[u,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.4 (a+b x+c x^2)^p (d+e x+f x^2)^q.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  1/c^p \[Star] Int[(b/2+c*x)^(2*p)*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,q},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_.*(d_+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  (c/f)^p \[Star] Int[(d+e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && EqQ[c*d-a*f,0] && EqQ[b*d-a*e,0] && (IntegerQ[p] || GtQ[c/f,0]) && 
  (Not[IntegerQ[q]] || LeafCount[d+e*x+f*x^2]<=LeafCount[a+b*x+c*x^2])


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  a^IntPart[p]*(a+b*x+c*x^2)^FracPart[p]/(d^IntPart[p]*(d+e*x+f*x^2)^FracPart[p]) \[Star] Int[(d+e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && EqQ[c*d-a*f,0] && EqQ[b*d-a*e,0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f,0]]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(b+2*c*x)^(2*p)*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_.,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(b+2*c*x)^(2*p)*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,p,q},x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
(* Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  1/(2^(2*p+2*q+1)*c*(-c/(b^2-4*a*c))^p*(-f/(e^2-4*d*f))^q) \[Star] 
    Subst[Int[(1-x^2/(b^2-4*a*c))^p*(1+e*x^2/(b*(4*c*d-b*e)))^q,x],x,b+2*c*x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[c*e-b*f,0] && 
  (IntegerQ[p] || GtQ[-c/(b^2-4*a*c),0]) && (IntegerQ[q] || GtQ[-f/(e^2-4*d*f),0]) *)


(* ::Code:: *)
(* Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (d+e*x+f*x^2)^q/(2^(2*p+2*q+1)*c*(-c/(b^2-4*a*c))^p*(-f*(d+e*x+f*x^2)/(e^2-4*d*f))^q) \[Star] 
    Subst[Int[(1-x^2/(b^2-4*a*c))^p*(1+e*x^2/(b*(4*c*d-b*e)))^q,x],x,b+2*c*x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[c*e-b*f,0] && 
  (IntegerQ[p] || GtQ[-c/(b^2-4*a*c),0]) && Not[IntegerQ[q] || GtQ[-f/(e^2-4*d*f),0]] *)


(* ::Code:: *)
(* Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q/(2^(2*p+2*q+1)*c*(-c*(a+b*x+c*x^2)/(b^2-4*a*c))^p*(-f*(d+e*x+f*x^2)/(e^2-4*d*f))^q) \[Star] 
    Subst[Int[(1-x^2/(b^2-4*a*c))^p*(1+e*x^2/(b*(4*c*d-b*e)))^q,x],x,b+2*c*x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[c*e-b*f,0] *)


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{r=Rt[b^2-4*a*c,2]},
    1/c^p \[Star] Int[ExpandIntegrand[(b/2-r/2+c*x)^p*(b/2+r/2+c*x)^p*(d+e*x+f*x^2)^q,x],x] /;
 EqQ[p,-1] || Not[FractionalPowerFactorQ[r]]] /;
FreeQ[{a,b,c,d,e,f},x] && ILtQ[p,0] && IntegerQ[q] && NiceSqrtQ[b^2-4*a*c]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  With[{r=Rt[b^2-4*a*c,2]},
    1/c^p \[Star] Int[ExpandIntegrand[(b/2-r/2+c*x)^p*(b/2+r/2+c*x)^p*(d+f*x^2)^q,x],x] /;
 EqQ[p,-1] || Not[FractionalPowerFactorQ[r]]] /;
FreeQ[{a,b,c,d,f},x] && ILtQ[p,0] && IntegerQ[q] && NiceSqrtQ[b^2-4*a*c]


(* ::Code:: *)
Int[(a_.+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{r=Rt[-a*c,2]},
    1/c^p \[Star] Int[ExpandIntegrand[(-r+c*x)^p*(r+c*x)^p*(d+e*x+f*x^2)^q,x],x] /;
 EqQ[p,-1] || Not[FractionalPowerFactorQ[r]]] /;
FreeQ[{a,c,d,e,f},x] && ILtQ[p,0] && IntegerQ[q] && NiceSqrtQ[-a*c]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (b+2*c*x)*(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^q/((b^2-4*a*c)*(p+1)) - 
  (1/((b^2-4*a*c)*(p+1))) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q-1)*
      Simp[2*c*d*(2*p+3)+b*e*q+(2*b*f*q+2*c*e*(2*p+q+3))*x+2*c*f*(2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && GtQ[q,0] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  (b+2*c*x)*(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^q/((b^2-4*a*c)*(p+1)) - 
  (1/((b^2-4*a*c)*(p+1))) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^(q-1)*
      Simp[2*c*d*(2*p+3)+(2*b*f*q)*x+2*c*f*(2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,b,c,d,f},x] && NeQ[b^2-4*a*c,0] && LtQ[p,-1] && GtQ[q,0] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (2*c*x)*(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^q/((-4*a*c)*(p+1)) - 
  (1/((-4*a*c)*(p+1))) \[Star] 
    Int[(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q-1)*
      Simp[2*c*d*(2*p+3)+(2*c*e*(2*p+q+3))*x+2*c*f*(2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,c,d,e,f},x] && NeQ[e^2-4*d*f] && LtQ[p,-1] && GtQ[q,0] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (2*a*c^2*e-b^2*c*e+b^3*f+b*c*(c*d-3*a*f)+c*(2*c^2*d+b^2*f-c*(b*e+2*a*f))*x)*(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q+1)/
    ((b^2-4*a*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1)) - 
  (1/((b^2-4*a*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1))) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^q*
      Simp[2*c*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1)-
        (2*c^2*d+b^2*f-c*(b*e+2*a*f))*(a*f*(p+1)-c*d*(p+2))-
        e*(b^2*c*e-2*a*c^2*e-b^3*f-b*c*(c*d-3*a*f))*(p+q+2)+
       (2*f*(2*a*c^2*e-b^2*c*e+b^3*f+b*c*(c*d-3*a*f))*(p+q+2)-(2*c^2*d+b^2*f-c*(b*e+2*a*f))*(b*f*(p+1)-c*e*(2*p+q+4)))*x+
       c*f*(2*c^2*d+b^2*f-c*(b*e+2*a*f))*(2*p+2*q+5)*x^2,x],x]/;
FreeQ[{a,b,c,d,e,f,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && 
  NeQ[(c*d-a*f)^2-(b*d-a*e)*(c*e-b*f),0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  (b^3*f+b*c*(c*d-3*a*f)+c*(2*c^2*d+b^2*f-c*(2*a*f))*x)*(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^(q+1)/
    ((b^2-4*a*c)*(b^2*d*f+(c*d-a*f)^2)*(p+1)) - 
  (1/((b^2-4*a*c)*(b^2*d*f+(c*d-a*f)^2)*(p+1))) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^q*
      Simp[2*c*(b^2*d*f+(c*d-a*f)^2)*(p+1)-
        (2*c^2*d+b^2*f-c*(2*a*f))*(a*f*(p+1)-c*d*(p+2))+
       (2*f*(b^3*f+b*c*(c*d-3*a*f))*(p+q+2)-(2*c^2*d+b^2*f-c*(2*a*f))*(b*f*(p+1)))*x+
       c*f*(2*c^2*d+b^2*f-c*(2*a*f))*(2*p+2*q+5)*x^2,x],x]/;
FreeQ[{a,b,c,d,f,q},x] && NeQ[b^2-4*a*c,0] && LtQ[p,-1] && NeQ[b^2*d*f+(c*d-a*f)^2,0] && 
  Not[Not[IntegerQ[p]] && ILtQ[q,-1]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (2*a*c^2*e+c*(2*c^2*d-c*(2*a*f))*x)*(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q+1)/
    ((-4*a*c)*(a*c*e^2+(c*d-a*f)^2)*(p+1)) - 
  (1/((-4*a*c)*(a*c*e^2+(c*d-a*f)^2)*(p+1))) \[Star] 
    Int[(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^q*
      Simp[2*c*((c*d-a*f)^2-(-a*e)*(c*e))*(p+1)-(2*c^2*d-c*(2*a*f))*(a*f*(p+1)-c*d*(p+2))-e*(-2*a*c^2*e)*(p+q+2)+
       (2*f*(2*a*c^2*e)*(p+q+2)-(2*c^2*d-c*(2*a*f))*(-c*e*(2*p+q+4)))*x+
       c*f*(2*c^2*d-c*(2*a*f))*(2*p+2*q+5)*x^2,x],x]/;
FreeQ[{a,c,d,e,f,q},x] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && NeQ[a*c*e^2+(c*d-a*f)^2,0] && 
  Not[Not[IntegerQ[p]] && ILtQ[q,-1]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (b*f*(3*p+2*q)-c*e*(2*p+q)+2*c*f*(p+q)*x)*(a+b*x+c*x^2)^(p-1)*(d+e*x+f*x^2)^(q+1)/(2*f^2*(p+q)*(2*p+2*q+1)) - 
  1/(2*f^2*(p+q)*(2*p+2*q+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p-2)*(d+e*x+f*x^2)^q*
      Simp[(b*d-a*e)*(c*e-b*f)*(1-p)*(2*p+q)-
        (p+q)*(b^2*d*f*(1-p)-a*(f*(b*e-2*a*f)*(2*p+2*q+1)+c*(2*d*f-e^2*(2*p+q))))+
        (2*(c*d-a*f)*(c*e-b*f)*(1-p)*(2*p+q)-
          (p+q)*((b^2-4*a*c)*e*f*(1-p)+b*(c*(e^2-4*d*f)*(2*p+q)+f*(2*c*d-b*e+2*a*f)*(2*p+2*q+1))))*x+
        ((c*e-b*f)^2*(1-p)*p+c*(p+q)*(f*(b*e-2*a*f)*(4*p+2*q-1)-c*(2*d*f*(1-2*p)+e^2*(3*p+q-1))))*x^2,x],x]/;
FreeQ[{a,b,c,d,e,f,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && GtQ[p,1] && 
  NeQ[p+q,0] && NeQ[2*p+2*q+1,0] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  (b*(3*p+2*q)+2*c*(p+q)*x)*(a+b*x+c*x^2)^(p-1)*(d+f*x^2)^(q+1)/(2*f*(p+q)*(2*p+2*q+1)) - 
  1/(2*f*(p+q)*(2*p+2*q+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p-2)*(d+f*x^2)^q*
      Simp[b^2*d*(p-1)*(2*p+q)-(p+q)*(b^2*d*(1-p)-2*a*(c*d-a*f*(2*p+2*q+1)))-
        (2*b*(c*d-a*f)*(1-p)*(2*p+q)-2*(p+q)*b*(2*c*d*(2*p+q)-(c*d+a*f)*(2*p+2*q+1)))*x+
        (b^2*f*p*(1-p)+2*c*(p+q)*(c*d*(2*p-1)-a*f*(4*p+2*q-1)))*x^2,x],x]/;
FreeQ[{a,b,c,d,f,q},x] && NeQ[b^2-4*a*c,0] && GtQ[p,1] && NeQ[p+q,0] && NeQ[2*p+2*q+1,0] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  -c*(e*(2*p+q)-2*f*(p+q)*x)*(a+c*x^2)^(p-1)*(d+e*x+f*x^2)^(q+1)/(2*f^2*(p+q)*(2*p+2*q+1)) - 
  1/(2*f^2*(p+q)*(2*p+2*q+1)) \[Star] 
    Int[(a+c*x^2)^(p-2)*(d+e*x+f*x^2)^q*
      Simp[-a*c*e^2*(1-p)*(2*p+q)+a*(p+q)*(-2*a*f^2*(2*p+2*q+1)+c*(2*d*f-e^2*(2*p+q)))+
        (2*(c*d-a*f)*(c*e)*(1-p)*(2*p+q)+4*a*c*e*f*(1-p)*(p+q))*x+
        (p*c^2*e^2*(1-p)-c*(p+q)*(2*a*f^2*(4*p+2*q-1)+c*(2*d*f*(1-2*p)+e^2*(3*p+q-1))))*x^2,x],x]/;
FreeQ[{a,c,d,e,f,q},x] && NeQ[e^2-4*d*f,0] && GtQ[p,1] && NeQ[p+q,0] && NeQ[2*p+2*q+1,0] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[1/((a_+b_.*x_+c_.*x_^2)*(d_+e_.*x_+f_.*x_^2)),x_Symbol] :=
  With[{q=c^2*d^2-b*c*d*e+a*c*e^2+b^2*d*f-2*a*c*d*f-a*b*e*f+a^2*f^2},
  1/q \[Star] Int[(c^2*d-b*c*e+b^2*f-a*c*f-(c^2*e-b*c*f)*x)/(a+b*x+c*x^2),x] + 
  1/q \[Star] Int[(c*e^2-c*d*f-b*e*f+a*f^2+(c*e*f-b*f^2)*x)/(d+e*x+f*x^2),x] /;
 NeQ[q,0]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_+c_.*x_^2)*(d_+f_.*x_^2)),x_Symbol] :=
  With[{q=c^2*d^2+b^2*d*f-2*a*c*d*f+a^2*f^2},
  1/q \[Star] Int[(c^2*d+b^2*f-a*c*f+b*c*f*x)/(a+b*x+c*x^2),x] - 
  1/q \[Star] Int[(c*d*f-a*f^2+b*f^2*x)/(d+f*x^2),x] /;
 NeQ[q,0]] /;
FreeQ[{a,b,c,d,f},x] && NeQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -2*e \[Star] Subst[Int[1/(e*(b*e-4*a*f)-(b*d-a*e)*x^2),x],x,(e+2*f*x)/Sqrt[d+e*x+f*x^2]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[c*e-b*f,0]


(* ::Code:: *)
(* Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{k=Rt[(a/c-d/f)^2+(b/c-e/f)*(b*d/(c*f)-a*e/(c*f)),2]},
  -2*(c*d-a*f+c*f*k+(c*e-b*f)*x)*Sqrt[(d+e*x+f*x^2)*((c*f*k)/(c*d-a*f+c*f*k+(c*e-b*f)*x))^2]/(c*Sqrt[d+e*x+f*x^2]) \[Star] 
    Subst[Int[(1-x)/(
      (b*d-a*e-b*f*k-(c*d-a*f-c*f*k)^2/(c*e-b*f)+(b*d-a*e+b*f*k-(a*f-c*d-c*f*k)^2/(c*e-b*f))*x^2)*
      Sqrt[-f*((b*d-a*e-c*e*k)/(c*e-b*f)-(c*d-a*f-c*f*k)^2/(c*e-b*f)^2)-f*((b*d-a*e+c*e*k)/(c*e-b*f)-(a*f-c*d-c*f*k)^2/(c*e-b*f)^2)*x^2]),x],x,
        (c*d-a*f-c*f*k+(c*e-b*f)*x)/(c*d-a*f+c*f*k+(c*e-b*f)*x)]] /;
FreeQ[{a,b,c,d,e,f},x] && RationalQ[a,b,c,d,e,f] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && NeQ[c*e-b*f,0] && LtQ[b^2-4*a*c,0] *)


(* ::Code:: *)
(* Int[1/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{k=Rt[(a/c-d/f)^2+a*e^2/(c*f^2),2]},
  -2*(c*d-a*f+c*f*k+c*e*x)*Sqrt[(d+e*x+f*x^2)*((c*f*k)/(c*d-a*f+c*f*k+c*e*x))^2]/(c*Sqrt[d+e*x+f*x^2]) \[Star] 
    Subst[Int[(1-x)/(
      (-a*e-(c*d-a*f-c*f*k)^2/(c*e)+(-a*e-(a*f-c*d-c*f*k)^2/(c*e))*x^2)*
      Sqrt[-f*((-a*e-c*e*k)/(c*e)-(c*d-a*f-c*f*k)^2/(c*e)^2)-f*((-a*e+c*e*k)/(c*e)-(a*f-c*d-c*f*k)^2/(c*e)^2)*x^2]),x],x,
        (c*d-a*f-c*f*k+(c*e)*x)/(c*d-a*f+c*f*k+(c*e)*x)]] /;
FreeQ[{a,c,d,e,f},x] && RationalQ[a,c,d,e,f] && NeQ[e^2-4*d*f,0] && LtQ[-a*c,0] *)


(* ::Code:: *)
(* Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+f_.*x_^2]),x_Symbol] :=
  With[{k=Rt[(a/c-d/f)^2+b^2*d/(c^2*f),2]},
  -2*(c*d-a*f+c*f*k-b*f*x)*Sqrt[(d+f*x^2)*((c*f*k)/(c*d-a*f+c*f*k-b*f*x))^2]/(c*Sqrt[d+f*x^2]) \[Star] 
    Subst[Int[(1-x)/(
      (b*d-b*f*k+(c*d-a*f-c*f*k)^2/(b*f)+(b*d+b*f*k+(a*f-c*d-c*f*k)^2/(b*f))*x^2)*
      Sqrt[-f*(-d/f-(c*d-a*f-c*f*k)^2/(b*f)^2)-f*(-d/f-(a*f-c*d-c*f*k)^2/(b*f)^2)*x^2]),x],x,
        (c*d-a*f-c*f*k+(-b*f)*x)/(c*d-a*f+c*f*k+(-b*f)*x)]] /;
FreeQ[{a,b,c,d,f},x] && RationalQ[a,b,c,d,f] && NeQ[b^2-4*a*c,0] && LtQ[b^2-4*a*c,0] *)


(* ::Code:: *)
Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
  2*c/q \[Star] Int[1/((b-q+2*c*x)*Sqrt[d+e*x+f*x^2]),x] -
  2*c/q \[Star] Int[1/((b+q+2*c*x)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && NeQ[c*e-b*f,0] && PosQ[b^2-4*a*c]


(* ::Code:: *)
Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
  2*c/q \[Star] Int[1/((b-q+2*c*x)*Sqrt[d+f*x^2]),x] -
  2*c/q \[Star] Int[1/((b+q+2*c*x)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,c,d,f},x] && NeQ[b^2-4*a*c,0] && PosQ[b^2-4*a*c]


(* ::Code:: *)
Int[1/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  1/2 \[Star] Int[1/((a-Rt[-a*c,2]*x)*Sqrt[d+e*x+f*x^2]),x] +
  1/2 \[Star] Int[1/((a+Rt[-a*c,2]*x)*Sqrt[d+e*x+f*x^2]),x] /;
FreeQ[{a,c,d,e,f},x] && NeQ[e^2-4*d*f,0] && PosQ[-a*c]


(* ::Code:: *)
Int[1/((a_.+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[(c*d-a*f)^2-(b*d-a*e)*(c*e-b*f),2]},
  1/(2*q) \[Star] Int[(c*d-a*f+q+(c*e-b*f)*x)/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x] - 
  1/(2*q) \[Star] Int[(c*d-a*f-q+(c*e-b*f)*x)/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && NeQ[c*e-b*f,0] && NegQ[b^2-4*a*c]


(* ::Code:: *)
Int[1/((a_.+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[(c*d-a*f)^2+a*c*e^2,2]},
  1/(2*q) \[Star] Int[(c*d-a*f+q+c*e*x)/((a+c*x^2)*Sqrt[d+e*x+f*x^2]),x] - 
  1/(2*q) \[Star] Int[(c*d-a*f-q+c*e*x)/((a+c*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,c,d,e,f},x] && NeQ[e^2-4*d*f,0] && NegQ[-a*c]


(* ::Code:: *)
Int[1/((a_.+b_.*x_+c_.*x_^2)*Sqrt[d_.+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[(c*d-a*f)^2+b^2*d*f,2]},
  1/(2*q) \[Star] Int[(c*d-a*f+q+(-b*f)*x)/((a+b*x+c*x^2)*Sqrt[d+f*x^2]),x] - 
  1/(2*q) \[Star] Int[(c*d-a*f-q+(-b*f)*x)/((a+b*x+c*x^2)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,c,d,f},x] && NeQ[b^2-4*a*c,0] && NegQ[b^2-4*a*c]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_+c_.*x_^2]/(d_+e_.*x_+f_.*x_^2),x_Symbol] :=
  c/f \[Star] Int[1/Sqrt[a+b*x+c*x^2],x] - 
  1/f \[Star] Int[(c*d-a*f+(c*e-b*f)*x)/(Sqrt[a+b*x+c*x^2]*(d+e*x+f*x^2)),x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_+c_.*x_^2]/(d_+f_.*x_^2),x_Symbol] :=
  c/f \[Star] Int[1/Sqrt[a+b*x+c*x^2],x] - 
  1/f \[Star] Int[(c*d-a*f-b*f*x)/(Sqrt[a+b*x+c*x^2]*(d+f*x^2)),x] /;
FreeQ[{a,b,c,d,f},x] && NeQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[Sqrt[a_+c_.*x_^2]/(d_+e_.*x_+f_.*x_^2),x_Symbol] :=
  c/f \[Star] Int[1/Sqrt[a+c*x^2],x] - 
  1/f \[Star] Int[(c*d-a*f+c*e*x)/(Sqrt[a+c*x^2]*(d+e*x+f*x^2)),x] /;
FreeQ[{a,c,d,e,f},x] && NeQ[e^2-4*d*f,0]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_+c_.*x_^2]*Sqrt[d_+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{r=Rt[b^2-4*a*c,2]},
  Sqrt[b+r+2*c*x]*Sqrt[2*a+(b+r)*x]/Sqrt[a+b*x+c*x^2] \[Star] Int[1/(Sqrt[b+r+2*c*x]*Sqrt[2*a+(b+r)*x]*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0]


(* ::Code:: *)
Int[1/(Sqrt[a_+b_.*x_+c_.*x_^2]*Sqrt[d_+f_.*x_^2]),x_Symbol] :=
  With[{r=Rt[b^2-4*a*c,2]},
  Sqrt[b+r+2*c*x]*Sqrt[2*a+(b+r)*x]/Sqrt[a+b*x+c*x^2] \[Star] Int[1/(Sqrt[b+r+2*c*x]*Sqrt[2*a+(b+r)*x]*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,c,d,f},x] && NeQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  Unintegrable[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  Unintegrable[(a+c*x^2)^p*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,c,d,e,f,p,q},x] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[(a_.+b_.*u_+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q,x],x,u] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(a_.+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+c*x^2)^p*(d+e*x+f*x^2)^q,x],x,u] /;
FreeQ[{a,c,d,e,f,p,q},x] && LinearQ[u,x] && NeQ[u,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.4 (d+e x)^m (f+g x)^n (a+b x+c x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.4 (d+e x)^m (f+g x)^n (a+b x+c x^2)^p *)
Int[x_^m_.*(f_ + g_.*x_)^n_.*(b_.*x_ + c_.*x_^2), x_Symbol] := c*x^(m + 2)*(f + g*x)^(n + 1)/(g*(m + n + 3)) /; FreeQ[{b, c, f, g, m, n}, x] && EqQ[c*f*(m + 2) - b*g*(m + n + 3), 0] && NeQ[m + n + 3, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x)^(2*FracPart[p]))* Int[(d + e*x)^m*(f + g*x)^n*(b/2 + c*x)^(2*p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && NeQ[e*f - d*g, 0] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(f + g*x)^n*(a/d + c/e*x)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p] && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(f + g*x)^n*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && (IntegerQ[p] || GtQ[a, 0] && GtQ[d, 0] && EqQ[m + p, 0])
Int[x_^n_.*(a_. + b_.*x_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := Int[x^n*(a/d + c*x/e)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && (Not[IntegerQ[n]] || Not[IntegerQ[2*p]] || IGtQ[n, 2] || GtQ[p, 0] && NeQ[n, 2])
Int[x_^n_.*(a_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := Int[x^n*(a/d + c*x/e)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e, n, p}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && (Not[IntegerQ[n]] || Not[IntegerQ[2*p]] || IGtQ[n, 2] || GtQ[p, 0] && NeQ[n, 2])
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[(a/d + c*x/e)^(-m)*(f + g*x)^n*(a + b*x + c*x^2)^(m + p), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[m, 0] && IntegerQ[n] && (LtQ[n, 0] || GtQ[p, 0])
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := d^(2*m)/a^m*Int[(f + g*x)^n*(a + c*x^2)^(m + p)/(d - e*x)^m, x] /; FreeQ[{a, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[f, 0] && ILtQ[m, -1] && Not[IGtQ[n, 0] && ILtQ[m + n, 0] && Not[GtQ[p, 1]]]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := d^(2*m)/a^m*Int[(f + g*x)^n*(a + c*x^2)^(m + p)/(d - e*x)^m, x] /; FreeQ[{a, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[m, 0] && IntegerQ[n]
Int[(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := -(2*c*d - b*e)*(f + g*x)^ n*(a + b*x + c*x^2)^(p + 1)/(e*p*(b^2 - 4*a*c)*(d + e*x)) - 1/(d*e*p*(b^2 - 4*a*c))*Int[(f + g*x)^(n - 1)*(a + b*x + c*x^2)^p* Simp[b*(a*e*g*n - c*d*f*(2*p + 1)) - 2*a*c*(d*g*n - e*f*(2*p + 1)) - c*g*(b*d - 2*a*e)*(n + 2*p + 1)*x, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && IGtQ[n, 0] && ILtQ[n + 2*p, 0]
Int[(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := d*(f + g*x)^n*(a + c*x^2)^(p + 1)/(2*a*e*p*(d + e*x)) - 1/(2*d*e*p)* Int[(f + g*x)^(n - 1)*(a + c*x^2)^p* Simp[d*g*n - e*f*(2*p + 1) - e*g*(n + 2*p + 1)*x, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && IGtQ[n, 0] && ILtQ[n + 2*p, 0]
Int[(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := (f + g*x)^(n + 1)*(a + b*x + c*x^2)^ p*(c*d - b*e - c*e*x)/(p*(2*c*d - b*e)*(e*f - d*g)) + 1/(p*(2*c*d - b*e)*(e*f - d*g))* Int[(f + g*x)^n*(a + b*x + c*x^2)^ p*(b*e*g*(n + p + 1) + c*e*f*(2*p + 1) - c*d*g*(n + 2*p + 1) + c*e*g*(n + 2*p + 2)*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[n, 0] && ILtQ[n + 2*p, 0] && Not[IGtQ[n, 0]]
Int[(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := d*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/(2*a* p*(e*f - d*g)*(d + e*x)) + 1/(p*(2*c*d)*(e*f - d*g))* Int[(f + g*x)^n*(a + c*x^2)^ p*(c*e*f*(2*p + 1) - c*d*g*(n + 2*p + 1) + c*e*g*(n + 2*p + 2)*x), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[n, 0] && ILtQ[n + 2*p, 0] && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^(m - 1)*(f + g*x)^ n*(a + b*x + c*x^2)^(p + 1)/(c*(m - n - 1)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && EqQ[c*e*f + c*d*g - b*e*g, 0] && NeQ[m - n - 1, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^(m - 1)*(f + g*x)^ n*(a + c*x^2)^(p + 1)/(c*(m - n - 1)) /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && EqQ[e*f + d*g, 0] && NeQ[m - n - 1, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -e^2*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p + 1)/((n + 1)*(c*e*f + c*d*g - b*e*g)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && EqQ[m - n - 2, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := -e^2*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/(c*(n + 1)*(e*f + d*g)) /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && EqQ[m - n - 2, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^m*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^p/(g*(n + 1)) + c*m/(e*g*(n + 1))* Int[(d + e*x)^(m + 1)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && GtQ[p, 0] && LtQ[n, -1] && Not[IntegerQ[n + p] && LeQ[n + p + 2, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^m*(f + g*x)^(n + 1)*(a + c*x^2)^p/(g*(n + 1)) + c*m/(e*g*(n + 1))* Int[(d + e*x)^(m + 1)*(f + g*x)^(n + 1)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && GtQ[p, 0] && LtQ[n, -1] && Not[IntegerQ[n + p] && LeQ[n + p + 2, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^m*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^ p/(g*(m - n - 1)) - m*(c*e*f + c*d*g - b*e*g)/(e^2*g*(m - n - 1))* Int[(d + e*x)^(m + 1)*(f + g*x)^n*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && GtQ[p, 0] && NeQ[m - n - 1, 0] && Not[IGtQ[n, 0]] && Not[IntegerQ[n + p] && LtQ[n + p + 2, 0]] && RationalQ[n]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := -(d + e*x)^m*(f + g*x)^(n + 1)*(a + c*x^2)^p/(g*(m - n - 1)) - c*m*(e*f + d*g)/(e^2*g*(m - n - 1))* Int[(d + e*x)^(m + 1)*(f + g*x)^n*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && GtQ[p, 0] && NeQ[m - n - 1, 0] && Not[IGtQ[n, 0]] && Not[IntegerQ[n + p] && LtQ[n + p + 2, 0]] && RationalQ[n]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(f + g*x)^ n*(a + b*x + c*x^2)^(p + 1)/(c*(p + 1)) - e*g*n/(c*(p + 1))* Int[(d + e*x)^(m - 1)*(f + g*x)^(n - 1)*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && LtQ[p, -1] && GtQ[n, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := e*(d + e*x)^(m - 1)*(f + g*x)^n*(a + c*x^2)^(p + 1)/(c*(p + 1)) - e*g*n/(c*(p + 1))* Int[(d + e*x)^(m - 1)*(f + g*x)^(n - 1)*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && LtQ[p, -1] && GtQ[n, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e^2*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(c*e*f + c*d*g - b*e*g)) + e^2*g*(m - n - 2)/((p + 1)*(c*e*f + c*d*g - b*e*g))* Int[(d + e*x)^(m - 1)*(f + g*x)^n*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && LtQ[p, -1] && RationalQ[n]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := e^2*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/(c*(p + 1)*(e*f + d*g)) + e^2*g*(m - n - 2)/(c*(p + 1)*(e*f + d*g))* Int[(d + e*x)^(m - 1)*(f + g*x)^n*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && LtQ[p, -1] && RationalQ[n]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^(m - 1)*(f + g*x)^ n*(a + b*x + c*x^2)^(p + 1)/(c*(m - n - 1)) - n*(c*e*f + c*d*g - b*e*g)/(c*e*(m - n - 1))* Int[(d + e*x)^m*(f + g*x)^(n - 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && GtQ[n, 0] && NeQ[m - n - 1, 0] && (IntegerQ[2*p] || IntegerQ[n])
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := -e*(d + e*x)^(m - 1)*(f + g*x)^ n*(a + c*x^2)^(p + 1)/(c*(m - n - 1)) - n*(e*f + d*g)/(e*(m - n - 1))* Int[(d + e*x)^m*(f + g*x)^(n - 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && GtQ[n, 0] && NeQ[m - n - 1, 0] && (IntegerQ[2*p] || IntegerQ[n])
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := -e^2*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p + 1)/((n + 1)*(c*e*f + c*d*g - b*e*g)) - c*e*(m - n - 2)/((n + 1)*(c*e*f + c*d*g - b*e*g))* Int[(d + e*x)^m*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && LtQ[n, -1] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := -e^2*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/((n + 1)*(c*e*f + c*d*g)) - e*(m - n - 2)/((n + 1)*(e*f + d*g))* Int[(d + e*x)^m*(f + g*x)^(n + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p, 0] && LtQ[n, -1] && IntegerQ[2*p]
Int[Sqrt[d_ + e_.*x_]/((f_. + g_.*x_)*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := 2*e^2* Subst[Int[1/(c*(e*f + d*g) - b*e*g + e^2*g*x^2), x], x, Sqrt[a + b*x + c*x^2]/Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Sqrt[d_ + e_.*x_]/((f_. + g_.*x_)*Sqrt[a_ + c_.*x_^2]), x_Symbol] := 2*e^2* Subst[Int[1/(c*(e*f + d*g) + e^2*g*x^2), x], x, Sqrt[a + c*x^2]/Sqrt[d + e*x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e^2*(d + e*x)^(m - 2)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p + 1)/(c*g*(n + p + 2)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0] && EqQ[b*e*g*(n + 1) + c*e*f*(p + 1) - c*d*g*(2*n + p + 3), 0] && NeQ[n + p + 2, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := e^2*(d + e*x)^(m - 2)*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/(c* g*(n + p + 2)) /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0] && EqQ[e*f*(p + 1) - d*g*(2*n + p + 3), 0] && NeQ[n + p + 2, 0]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e^2*(e*f - d*g)*(d + e*x)^(m - 2)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p + 1)/(g*(n + 1)*(c*e*f + c*d*g - b*e*g)) - e*(b*e*g*(n + 1) + c*e*f*(p + 1) - c*d*g*(2*n + p + 3))/(g*(n + 1)*(c*e*f + c*d*g - b*e*g))* Int[(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0] && LtQ[n, -1] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := e^2*(e*f - d*g)*(d + e*x)^(m - 2)*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/(c* g*(n + 1)*(e*f + d*g)) - e*(e*f*(p + 1) - d*g*(2*n + p + 3))/(g*(n + 1)*(e*f + d*g))* Int[(d + e*x)^(m - 1)*(f + g*x)^(n + 1)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0] && LtQ[n, -1] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := e^2*(d + e*x)^(m - 2)*(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p + 1)/(c*g*(n + p + 2)) - (b*e*g*(n + 1) + c*e*f*(p + 1) - c*d*g*(2*n + p + 3))/(c* g*(n + p + 2))* Int[(d + e*x)^(m - 1)*(f + g*x)^n*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0] && Not[LtQ[n, -1]] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := e^2*(d + e*x)^(m - 2)*(f + g*x)^(n + 1)*(a + c*x^2)^(p + 1)/(c* g*(n + p + 2)) - (e*f*(p + 1) - d*g*(2*n + p + 3))/(g*(n + p + 2))* Int[(d + e*x)^(m - 1)*(f + g*x)^n*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0] && Not[LtQ[n, -1]] && IntegerQ[2*p]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[m, 0] && (ILtQ[n, 0] || IGtQ[n, 0] && ILtQ[p + 1/2, 0]) && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[ 1/Sqrt[a + c*x^2], (d + e*x)^m*(f + g*x)^n*(a + c*x^2)^(p + 1/2), x], x] /; FreeQ[{a, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p - 1/2] && ILtQ[m, 0] && ILtQ[n, 0] && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[m, 0] && (ILtQ[n, 0] || IGtQ[n, 0] && ILtQ[p + 1/2, 0]) && Not[IGtQ[n, 0]]
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[(f + g*x)^n, a*e + c*d*x, x], h = PolynomialRemainder[(f + g*x)^n, a*e + c*d*x, x]}, h*(2*c*d - b*e)*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/(e*(p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)* ExpandToSum[ d*e*(p + 1)*(b^2 - 4*a*c)*Q - h*(2*c*d - b*e)*(m + 2*p + 2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[p + 1/2, 0] && IGtQ[m, 0] && IGtQ[n, 0] && Not[IGtQ[n, 0]]
Int[(d_. + e_.*x_)^m_.*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[(f + g*x)^n, a*e + c*d*x, x], h = PolynomialRemainder[(f + g*x)^n, a*e + c*d*x, x]}, -d*h*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*a*e*(p + 1)) + d/(2*a*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)* ExpandToSum[2*a*e*(p + 1)*Q + h*(m + 2*p + 2), x], x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && ILtQ[p + 1/2, 0] && IGtQ[m, 0] && IGtQ[n, 0] && Not[IGtQ[n, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x + c*x^2)^p, (d + e*x)^m*(f + g*x)^n, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + n + 2*p + 1, 0] && ILtQ[m, 0] && ILtQ[n, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(a + c*x^2)^p, (d + e*x)^m*(f + g*x)^n, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && EqQ[m + n + 2*p + 1, 0] && ILtQ[m, 0] && ILtQ[n, 0]
(* Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_.+b_.*x_+c_.*x_^2)^p_,x_ Symbol] := g^n*(d+e*x)^(m+n-1)*(a+b*x+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 1/(c*e^n*(m+n+2*p+1))*Int[(d+e*x)^m*(a+b*x+c*x^2)^p* ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^ n+e*g^n*(m+p+n)*(d+e*x)^(n-2)*(b*d-2*a*e+(2*c*d-b*e)*x),x],x] /; FreeQ[{a,b,c,d,e,f,g,m,p},x] && NeQ[e*f-d*g,0] && NeQ[b^2-4*a*c,0] &&  EqQ[c*d^2-b*d*e+a*e^2,0] && Not[IntegerQ[p]] && NeQ[m+n+2*p+1,0] && IGtQ[n,0] *)
(* Int[(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_*(a_+c_.*x_^2)^p_,x_Symbol] := g^n*(d+e*x)^(m+n-1)*(a+c*x^2)^(p+1)/(c*e^(n-1)*(m+n+2*p+1)) + 1/(c*e^n*(m+n+2*p+1))*Int[(d+e*x)^m*(a+c*x^2)^p* ExpandToSum[c*e^n*(m+n+2*p+1)*(f+g*x)^n-c*g^n*(m+n+2*p+1)*(d+e*x)^ n-2*e*g^n*(m+p+n)*(d+e*x)^(n-2)*(a*e-c*d*x),x],x] /; FreeQ[{a,c,d,e,f,g,m,p},x] && NeQ[e*f-d*g,0] && EqQ[c*d^2+a*e^2,0] &&  Not[IntegerQ[p]] && NeQ[m+n+2*p+1,0] && IGtQ[n,0] *)
Int[(e_.*x_)^m_*(f_. + g_.*x_)^n_*(b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (e*x)^m*(b*x + c*x^2)^p/(x^(m + p)*(b + c*x)^p)* Int[x^(m + p)*(f + g*x)^n*(b + c*x)^p, x] /; FreeQ[{b, c, e, f, g, m, n}, x] && Not[IntegerQ[p]] && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[(d + e*x)^(m + p)*(f + g*x)^n*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && GtQ[a, 0] && GtQ[d, 0] && Not[IGtQ[m, 0]] && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (*(a+b*x+c*x^2)^p/((d+e*x)^p*(a*e+c*d*x)^p)*Int[(d+e*x)^(m+p)*(f+g*x) ^n*(a*e+c*d*x)^p,x] /; *) (a + b*x + c*x^2)^ FracPart[p]/((d + e*x)^FracPart[p]*(a/d + (c*x)/e)^FracPart[p])* Int[(d + e*x)^(m + p)*(f + g*x)^n*(a/d + c/e*x)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && Not[IGtQ[m, 0]] && Not[IGtQ[n, 0]]
Int[(d_ + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := (a + c*x^2)^ FracPart[p]/((d + e*x)^FracPart[p]*(a/d + (c*x)/e)^FracPart[p])* Int[(d + e*x)^(m + p)*(f + g*x)^n*(a/d + c/e*x)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n}, x] && NeQ[e*f - d*g, 0] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && Not[IGtQ[m, 0]] && Not[IGtQ[n, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p] && (EqQ[p, 1] && IntegersQ[m, n] || ILtQ[m, 0] && ILtQ[n, 0])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[p] && (EqQ[p, 1] && IntegersQ[m, n] || ILtQ[m, 0] && ILtQ[n, 0])
Int[(a_. + b_.*x_ + c_.*x_^2)^p_/((d_. + e_.*x_)*(f_. + g_.*x_)), x_Symbol] := (c*d^2 - b*d*e + a*e^2)/(e*(e*f - d*g))* Int[(a + b*x + c*x^2)^(p - 1)/(d + e*x), x] - 1/(e*(e*f - d*g))* Int[Simp[c*d*f - b*e*f + a*e*g - c*(e*f - d*g)*x, x]*(a + b*x + c*x^2)^(p - 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && FractionQ[p] && GtQ[p, 0]
Int[(a_ + c_.*x_^2)^p_/((d_. + e_.*x_)*(f_. + g_.*x_)), x_Symbol] := (c*d^2 + a*e^2)/(e*(e*f - d*g))* Int[(a + c*x^2)^(p - 1)/(d + e*x), x] - 1/(e*(e*f - d*g))* Int[Simp[c*d*f + a*e*g - c*(e*f - d*g)*x, x]*(a + c*x^2)^(p - 1)/(f + g*x), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && FractionQ[p] && GtQ[p, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := With[{q = Denominator[m]}, q/e*Subst[Int[x^(q*(m + 1) - 1)*((e*f - d*g)/e + g*x^q/e)^n* ((c*d^2 - b*d*e + a*e^2)/e^2 - (2*c*d - b*e)*x^q/e^2 + c*x^(2*q)/e^2)^p, x], x, (d + e*x)^(1/q)]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegersQ[n, p] && FractionQ[m]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := With[{q = Denominator[m]}, q/e* Subst[Int[ x^(q*(m + 1) - 1)*((e*f - d*g)/e + g*x^q/e)^ n*((c*d^2 + a*e^2)/e^2 - 2*c*d*x^q/e^2 + c*x^(2*q)/e^2)^p, x], x, (d + e*x)^(1/q)]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegersQ[n, p] && FractionQ[m]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d*f + e*g*x^2)^m*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[m - n, 0] && EqQ[e*f + d*g, 0] && (IntegerQ[m] || GtQ[d, 0] && GtQ[f, 0])
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^n_*(a_. + c_.*x_^2)^p_., x_Symbol] := Int[(d*f + e*g*x^2)^m*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && EqQ[m - n, 0] && EqQ[e*f + d*g, 0] && (IntegerQ[m] || GtQ[d, 0] && GtQ[f, 0])
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^ FracPart[m]*(f + g*x)^FracPart[m]/(d*f + e*g*x^2)^FracPart[m]* Int[(d*f + e*g*x^2)^m*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[m - n, 0] && EqQ[e*f + d*g, 0]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^n_*(a_. + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ FracPart[m]*(f + g*x)^FracPart[m]/(d*f + e*g*x^2)^FracPart[m]* Int[(d*f + e*g*x^2)^m*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && EqQ[m - n, 0] && EqQ[e*f + d*g, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := g/c^2* Int[Simp[2*c*e*f + c*d*g - b*e*g + c*e*g*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n - 2), x] + 1/c^2* Int[Simp[ c^2*d*f^2 - 2*a*c*e*f*g - a*c*d*g^2 + a*b*e*g^2 + (c^2*e*f^2 + 2*c^2*d*f*g - 2*b*c*e*f*g - b*c*d*g^2 + b^2*e*g^2 - a*c*e*g^2)*x, x]* (d + e*x)^(m - 1)*(f + g*x)^(n - 2)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m, 0] && GtQ[n, 1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_ + c_.*x_^2), x_Symbol] := g/c*Int[ Simp[2*e*f + d*g + e*g*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n - 2), x] + 1/c* Int[Simp[ c*d*f^2 - 2*a*e*f*g - a*d*g^2 + (c*e*f^2 + 2*c*d*f*g - a*e*g^2)*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n - 2)/(a + c*x^2), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m, 0] && GtQ[n, 1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*g/c*Int[(d + e*x)^(m - 1)*(f + g*x)^(n - 1), x] + 1/c* Int[Simp[c*d*f - a*e*g + (c*e*f + c*d*g - b*e*g)*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n - 1)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m, 0] && GtQ[n, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_ + c_.*x_^2), x_Symbol] := e*g/c*Int[(d + e*x)^(m - 1)*(f + g*x)^(n - 1), x] + 1/c* Int[Simp[c*d*f - a*e*g + (c*e*f + c*d*g)*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n - 1)/(a + c*x^2), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m, 0] && GtQ[n, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := -g*(e*f - d*g)/(c*f^2 - b*f*g + a*g^2)* Int[(d + e*x)^(m - 1)*(f + g*x)^n, x] + 1/(c*f^2 - b*f*g + a*g^2)* Int[ Simp[c*d*f - b*d*g + a*e*g + c*(e*f - d*g)*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)/(a + b*x + c*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m, 0] && LtQ[n, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_ + c_.*x_^2), x_Symbol] := -g*(e*f - d*g)/(c*f^2 + a*g^2)* Int[(d + e*x)^(m - 1)*(f + g*x)^n, x] + 1/(c*f^2 + a*g^2)* Int[ Simp[c*d*f + a*e*g + c*(e*f - d*g)*x, x]*(d + e*x)^(m - 1)*(f + g*x)^(n + 1)/(a + c*x^2), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && GtQ[m, 0] && LtQ[n, -1]
Int[(d_. + e_.*x_)^m_/(Sqrt[f_. + g_.*x_]*(a_. + b_.*x_ + c_.*x_^2)), x_Symbol] := Int[ExpandIntegrand[ 1/(Sqrt[d + e*x]*Sqrt[f + g*x]), (d + e*x)^(m + 1/2)/(a + b*x + c*x^2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[m + 1/2, 0]
Int[(d_. + e_.*x_)^m_/(Sqrt[f_. + g_.*x_]*(a_. + c_.*x_^2)), x_Symbol] := Int[ExpandIntegrand[ 1/(Sqrt[d + e*x]*Sqrt[f + g*x]), (d + e*x)^(m + 1/2)/(a + c*x^2), x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[m + 1/2, 0]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n, 1/(a + b*x + c*x^2), x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_/(a_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n, 1/(a + c*x^2), x], x] /; FreeQ[{a, c, d, e, f, g, m, n}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]]
Int[x_^2*(d_. + e_.*x_)^m_.*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(c*e*(m + 2*p + 3)) /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[b*e*(m + p + 2) + 2*c*d*(p + 1), 0] && EqQ[b*d*(p + 1) + a*e*(m + 1), 0] && NeQ[m + 2*p + 3, 0]
Int[x_^2*(d_. + e_.*x_)^m_.*(a_. + c_.*x_^2)^p_., x_Symbol] := (d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/(c*e*(m + 2*p + 3)) /; FreeQ[{a, c, d, e, m, p}, x] && EqQ[d*(p + 1), 0] && EqQ[a*(m + 1), 0] && NeQ[m + 2*p + 3, 0]
Int[(g_.*x_)^n_*(d_. + e_.*x_)^m_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (d + e*x)^ FracPart[p]*(a + b*x + c*x^2)^FracPart[p]/(a*d + c*e*x^3)^ FracPart[p]*Int[(g*x)^n*(a*d + c*e*x^3)^p, x] /; FreeQ[{a, b, c, d, e, g, m, n, p}, x] && EqQ[m - p, 0] && EqQ[b*d + a*e, 0] && EqQ[c*d + b*e, 0]
Int[(d_. + e_.*x_)^m_.*Sqrt[f_. + g_.*x_]* Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]/(e*(m + 1)) - 1/(2*e*(m + 1))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[b*f + a*g + 2*(c*f + b*g)*x + 3*c*g*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_.*Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Sqrt[f + g*x]*Sqrt[a + c*x^2]/(e*(m + 1)) - 1/(2*e*(m + 1))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[a*g + 2*c*f*x + 3*c*g*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_.*Sqrt[f_. + g_.*x_]* Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := 2*(d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + b*x + c*x^2]/(e*(2*m + 5)) - 1/(e*(2*m + 5))* Int[(d + e*x)^m/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[b*d*f - 3*a*e*f + a*d*g + 2*(c*d*f - b*e*f + b*d*g - a*e*g)* x - (c*e*f - 3*c*d*g + b*e*g)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && Not[LtQ[m, -1]]
Int[(d_. + e_.*x_)^m_.*Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2], x_Symbol] := 2*(d + e*x)^(m + 1)*Sqrt[f + g*x]*Sqrt[a + c*x^2]/(e*(2*m + 5)) + 1/(e*(2*m + 5))*Int[(d + e*x)^m/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[3*a*e*f - a*d*g - 2*(c*d*f - a*e*g)*x + (c*e*f - 3*c*d*g)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g, m}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && Not[LtQ[m, -1]]
Int[(d_. + e_.*x_)^m_.* Sqrt[a_. + b_.*x_ + c_.*x_^2]/Sqrt[f_. + g_.*x_], x_Symbol] := 2*(d + e*x)^m*Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]/(g*(2*m + 3)) - 1/(g*(2*m + 3))* Int[(d + e*x)^(m - 1)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[b*d*f + 2*a*(e*f*m - d*g*(m + 1)) + (2*c*d*f - 2*a*e*g + b*(e*f - d*g)*(2*m + 1))* x - (b*e*g + 2*c*(d*g*m - e*f*(m + 1)))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && GtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*Sqrt[a_ + c_.*x_^2]/Sqrt[f_. + g_.*x_], x_Symbol] := 2*(d + e*x)^m*Sqrt[f + g*x]*Sqrt[a + c*x^2]/(g*(2*m + 3)) - 1/(g*(2*m + 3))* Int[(d + e*x)^(m - 1)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[2*a*(e*f*m - d*g*(m + 1)) + (2*c*d*f - 2*a*e*g)* x - (2*c*(d*g*m - e*f*(m + 1)))*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && GtQ[m, 0]
Int[Sqrt[a_. + b_.*x_ + c_.*x_^2]/((d_. + e_.*x_)*Sqrt[f_. + g_.*x_]), x_Symbol] := (c*d^2 - b*d*e + a*e^2)/e^2* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), x] - 1/e^2* Int[(c*d - b*e - c*e*x)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Sqrt[a_ + c_.*x_^2]/((d_. + e_.*x_)*Sqrt[f_. + g_.*x_]), x_Symbol] := (c*d^2 + a*e^2)/e^2* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[a + c*x^2]), x] - 1/e^2*Int[(c*d - c*e*x)/(Sqrt[f + g*x]*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^m_.* Sqrt[a_. + b_.*x_ + c_.*x_^2]/Sqrt[f_. + g_.*x_], x_Symbol] := (d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + b*x + c*x^2]/((m + 1)*(e*f - d*g)) - 1/(2*(m + 1)*(e*f - d*g))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[b*f + a*g*(2*m + 3) + 2*(c*f + b*g*(m + 2))*x + c*g*(2*m + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_.*Sqrt[a_ + c_.*x_^2]/Sqrt[f_. + g_.*x_], x_Symbol] := (d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + c*x^2]/((m + 1)*(e*f - d*g)) - 1/(2*(m + 1)*(e*f - d*g))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[a*g*(2*m + 3) + 2*(c*f)*x + c*g*(2*m + 5)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && LtQ[m, -1]
Int[Sqrt[ d_. + e_.*x_]/(Sqrt[f_. + g_.*x_]*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[2]*Sqrt[2*c*f - g*(b + q)]*Sqrt[b - q + 2*c*x]*(d + e*x)* Sqrt[(e*f - d*g)*(b + q + 2*c*x)/((2*c*f - g*(b + q))*(d + e*x))]* Sqrt[(e*f - d*g)*(2*a + (b + q)*x)/((b*f + q*f - 2*a*g)*(d + e*x))]/ (g*Sqrt[2*c*d - e*(b + q)]*Sqrt[2*a*c/(b + q) + c*x]* Sqrt[a + b*x + c*x^2])* EllipticPi[e*(2*c*f - g*(b + q))/(g*(2*c*d - e*(b + q))), ArcSin[Sqrt[2*c*d - e*(b + q)]* Sqrt[f + g*x]/(Sqrt[2*c*f - g*(b + q)]*Sqrt[d + e*x])], (b*d + q*d - 2*a*e)*(2*c*f - g*(b + q))/((b*f + q*f - 2*a*g)*(2*c*d - e*(b + q)))]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Sqrt[d_. + e_.*x_]/(Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := With[{q = Rt[-4*a*c, 2]}, Sqrt[2]*Sqrt[2*c*f - g*q]*Sqrt[-q + 2*c*x]*(d + e*x)* Sqrt[(e*f - d*g)*(q + 2*c*x)/((2*c*f - g*q)*(d + e*x))]* Sqrt[(e*f - d*g)*(2*a + q*x)/((q*f - 2*a*g)*(d + e*x))]/ (g*Sqrt[2*c*d - e*q]*Sqrt[2*a*c/q + c*x]*Sqrt[a + c*x^2])* EllipticPi[e*(2*c*f - g*q)/(g*(2*c*d - e*q)), ArcSin[Sqrt[2*c*d - e*q]* Sqrt[f + g*x]/(Sqrt[2*c*f - g*q]*Sqrt[d + e*x])], (q*d - 2*a*e)*(2*c*f - g*q)/((q*f - 2*a*g)*(2*c*d - e*q))]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^(3/2)/(Sqrt[f_. + g_.*x_]* Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := e/g*Int[Sqrt[d + e*x]*Sqrt[f + g*x]/Sqrt[a + b*x + c*x^2], x] - (e*f - d*g)/g* Int[Sqrt[d + e*x]/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[(d_. + e_.*x_)^(3/2)/(Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := e/g*Int[Sqrt[d + e*x]*Sqrt[f + g*x]/Sqrt[a + c*x^2], x] - (e*f - d*g)/g* Int[Sqrt[d + e*x]/(Sqrt[f + g*x]*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^ m_/(Sqrt[f_. + g_.*x_]*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := 2*e^2*(d + e*x)^(m - 2)*Sqrt[f + g*x]* Sqrt[a + b*x + c*x^2]/(c*g*(2*m - 1)) - 1/(c*g*(2*m - 1))* Int[(d + e*x)^(m - 3)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[b*d*e^2*f + a*e^2*(d*g + 2*e*f*(m - 2)) - c*d^3*g*(2*m - 1) + e*(e*(2*b*d*g + e*(b*f + a*g)*(2*m - 3)) + c*d*(2*e*f - 3*d*g*(2*m - 1)))*x + 2*e^2*(c*e*f - 3*c*d*g + b*e*g)*(m - 1)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && GeQ[m, 2]
Int[(d_. + e_.*x_)^m_/(Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := 2*e^2*(d + e*x)^(m - 2)*Sqrt[f + g*x]* Sqrt[a + c*x^2]/(c*g*(2*m - 1)) - 1/(c*g*(2*m - 1))* Int[(d + e*x)^(m - 3)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[a*e^2*(d*g + 2*e*f*(m - 2)) - c*d^3*g*(2*m - 1) + e*(e*(a*e*g*(2*m - 3)) + c*d*(2*e*f - 3*d*g*(2*m - 1)))*x + 2*e^2*(c*e*f - 3*c*d*g)*(m - 1)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && GeQ[m, 2]
Int[1/((d_. + e_.*x_)*Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := With[{q = Rt[-c/a, 2]}, 1/Sqrt[a]* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[1 - q*x]*Sqrt[1 + q*x]), x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && GtQ[a, 0]
Int[1/((d_. + e_.*x_)*Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := With[{q = Rt[-c/a, 2]}, Sqrt[1 + c*x^2/a]/Sqrt[a + c*x^2]* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[1 - q*x]*Sqrt[1 + q*x]), x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && Not[GtQ[a, 0]]
Int[1/((d_. + e_.*x_)*Sqrt[f_. + g_.*x_]* Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[b - q + 2*c*x]*Sqrt[b + q + 2*c*x]/Sqrt[a + b*x + c*x^2]* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[b - q + 2*c*x]* Sqrt[b + q + 2*c*x]), x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[1/(Sqrt[d_. + e_.*x_]*Sqrt[f_. + g_.*x_]* Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := -2*(d + e*x)* Sqrt[(e*f - d*g)^2*(a + b*x + c*x^2)/((c*f^2 - b*f*g + a*g^2)*(d + e*x)^2)]/((e*f - d*g)* Sqrt[a + b*x + c*x^2])* Subst[ Int[ 1/Sqrt[1 - (2*c*d*f - b*e*f - b*d*g + 2*a*e*g)* x^2/(c*f^2 - b*f*g + a*g^2) + (c*d^2 - b*d*e + a*e^2)* x^4/(c*f^2 - b*f*g + a*g^2)], x], x, Sqrt[f + g*x]/Sqrt[d + e*x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[1/(Sqrt[d_. + e_.*x_]*Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := -2*(d + e*x)* Sqrt[(e*f - d*g)^2*(a + c*x^2)/((c*f^2 + a*g^2)*(d + e*x)^2)]/((e* f - d*g)*Sqrt[a + c*x^2])* Subst[ Int[ 1/Sqrt[1 - (2*c*d*f + 2*a*e*g)* x^2/(c*f^2 + a*g^2) + (c*d^2 + a*e^2)*x^4/(c*f^2 + a*g^2)], x], x, Sqrt[f + g*x]/Sqrt[d + e*x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0]
Int[1/((d_. + e_.*x_)^(3/2)*Sqrt[f_. + g_.*x_]* Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := -g/(e*f - d*g)* Int[1/(Sqrt[d + e*x]*Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), x] + e/(e*f - d*g)* Int[Sqrt[f + g*x]/((d + e*x)^(3/2)*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[1/((d_. + e_.*x_)^(3/2)*Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := -g/(e*f - d*g)* Int[1/(Sqrt[d + e*x]*Sqrt[f + g*x]*Sqrt[a + c*x^2]), x] + e/(e*f - d*g)* Int[Sqrt[f + g*x]/((d + e*x)^(3/2)*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^ m_/(Sqrt[f_. + g_.*x_]*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := e^2*(d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + b*x + c*x^2]/((m + 1)*(e*f - d*g)*(c*d^2 - b*d*e + a*e^2)) + 1/(2*(m + 1)*(e*f - d*g)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[2*d*(c*e*f - c*d*g + b*e*g)*(m + 1) - e^2*(b*f + a*g)*(2*m + 3) + 2*e*(c*d*g*(m + 1) - e*(c*f + b*g)*(m + 2))*x - c*e^2*g*(2*m + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && LeQ[m, -2]
Int[(d_. + e_.*x_)^m_/(Sqrt[f_. + g_.*x_]*Sqrt[a_ + c_.*x_^2]), x_Symbol] := e^2*(d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + c*x^2]/((m + 1)*(e*f - d*g)*(c*d^2 + a*e^2)) + 1/(2*(m + 1)*(e*f - d*g)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[2*d*(c*e*f - c*d*g)*(m + 1) - a*e^2*g*(2*m + 3) + 2*e*(c*d*g*(m + 1) - c*e*f*(m + 2))*x - c*e^2*g*(2*m + 5)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && LeQ[m, -2]
(* Int[Sqrt[d_.+e_.*x_]*Sqrt[f_.+g_.*x_]/Sqrt[a_.+b_.*x_+c_.*x_^2],x_ Symbol] := 0 /; FreeQ[{a,b,c,d,e,f,g},x] && NeQ[e*f-d*g,0] && NeQ[b^2-4*a*c,0] &&  NeQ[c*d^2-b*d*e+a*e^2,0] *)
Int[(d_. + e_.*x_)^m_* Sqrt[f_. + g_.*x_]/Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := 2*e*(d + e*x)^(m - 1)*Sqrt[f + g*x]* Sqrt[a + b*x + c*x^2]/(c*(2*m + 1)) - 1/(c*(2*m + 1))* Int[(d + e*x)^(m - 2)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[e*(b*d*f + a*(d*g + 2*e*f*(m - 1))) - c*d^2*f*(2*m + 1) + (a*e^2*g*(2*m - 1) - c*d*(4*e*f*m + d*g*(2*m + 1)) + b*e*(2*d*g + e*f*(2*m - 1)))*x + e*(2*b*e*g*m - c*(e*f + d*g*(4*m - 1)))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && GtQ[m, 1]
Int[(d_. + e_.*x_)^m_*Sqrt[f_. + g_.*x_]/Sqrt[a_ + c_.*x_^2], x_Symbol] := 2*e*(d + e*x)^(m - 1)*Sqrt[f + g*x]*Sqrt[a + c*x^2]/(c*(2*m + 1)) - 1/(c*(2*m + 1))* Int[(d + e*x)^(m - 2)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[a*e*(d*g + 2*e*f*(m - 1)) - c*d^2*f*(2*m + 1) + (a*e^2*g*(2*m - 1) - c*d*(4*e*f*m + d*g*(2*m + 1)))*x - c*e*(e*f + d*g*(4*m - 1))*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && GtQ[m, 1]
Int[Sqrt[f_. + g_.*x_]/((d_. + e_.*x_)*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := g/e*Int[1/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), x] + (e*f - d*g)/e* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Sqrt[f_. + g_.*x_]/((d_. + e_.*x_)*Sqrt[a_ + c_.*x_^2]), x_Symbol] := g/e*Int[1/(Sqrt[f + g*x]*Sqrt[a + c*x^2]), x] + (e*f - d*g)/e* Int[1/((d + e*x)*Sqrt[f + g*x]*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_. + e_.*x_)^m_* Sqrt[f_. + g_.*x_]/Sqrt[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + b*x + c*x^2]/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/(2*(m + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2])* Simp[2*c*d*f*(m + 1) - e*(a*g + b*f*(2*m + 3)) - 2*(b*e*g*(2 + m) - c*(d*g*(m + 1) - e*f*(m + 2)))*x - c*e*g*(2*m + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[2*m] && LeQ[m, -2]
Int[(d_. + e_.*x_)^m_*Sqrt[f_. + g_.*x_]/Sqrt[a_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m + 1)*Sqrt[f + g*x]* Sqrt[a + c*x^2]/((m + 1)*(c*d^2 + a*e^2)) + 1/(2*(m + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 1)/(Sqrt[f + g*x]*Sqrt[a + c*x^2])* Simp[2*c*d*f*(m + 1) - e*(a*g) + 2*c*(d*g*(m + 1) - e*f*(m + 2))*x - c*e*g*(2*m + 5)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[2*m] && LeQ[m, -2]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && (IGtQ[m, 0] || EqQ[m, -2] && EqQ[p, 1] && EqQ[2*c*d - b*e, 0])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && (IGtQ[m, 0] || EqQ[m, -2] && EqQ[p, 1] && EqQ[d, 0])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + b*x + c*x^2)^p, d + e*x, x], R = PolynomialRemainder[(a + b*x + c*x^2)^p, d + e*x, x]}, R*(d + e*x)^(m + 1)*(f + g*x)^(n + 1)/((m + 1)*(e*f - d*g)) + 1/((m + 1)*(e*f - d*g))* Int[(d + e*x)^(m + 1)*(f + g*x)^n* ExpandToSum[(m + 1)*(e*f - d*g)*Qx - g*R*(m + n + 2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + c*x^2)^p, d + e*x, x], R = PolynomialRemainder[(a + c*x^2)^p, d + e*x, x]}, R*(d + e*x)^(m + 1)*(f + g*x)^(n + 1)/((m + 1)*(e*f - d*g)) + 1/((m + 1)*(e*f - d*g))* Int[(d + e*x)^(m + 1)*(f + g*x)^n* ExpandToSum[(m + 1)*(e*f - d*g)*Qx - g*R*(m + n + 2), x], x]] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := c^p*(d + e*x)^(m + 2*p)*(f + g*x)^(n + 1)/(g* e^(2*p)*(m + n + 2*p + 1)) + 1/(g*e^(2*p)*(m + n + 2*p + 1))*Int[(d + e*x)^m*(f + g*x)^n* ExpandToSum[ g*(m + n + 2*p + 1)*(e^(2*p)*(a + b*x + c*x^2)^p - c^p*(d + e*x)^(2*p)) - c^p*(e*f - d*g)*(m + 2*p)*(d + e*x)^(2*p - 1), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && NeQ[m + n + 2*p + 1, 0] && (IntegerQ[n] || Not[IntegerQ[m]])
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := c^p*(d + e*x)^(m + 2*p)*(f + g*x)^(n + 1)/(g* e^(2*p)*(m + n + 2*p + 1)) + 1/(g*e^(2*p)*(m + n + 2*p + 1))*Int[(d + e*x)^m*(f + g*x)^n* ExpandToSum[ g*(m + n + 2*p + 1)*(e^(2*p)*(a + c*x^2)^p - c^p*(d + e*x)^(2*p)) - c^p*(e*f - d*g)*(m + 2*p)*(d + e*x)^(2*p - 1), x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && NeQ[m + n + 2*p + 1, 0] && (IntegerQ[n] || Not[IntegerQ[m]])
Int[(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_/(d_. + e_.*x_), x_Symbol] := (c*d^2 - b*d*e + a*e^2)/(e*(e*f - d*g))* Int[(f + g*x)^(n + 1)*(a + b*x + c*x^2)^(p - 1)/(d + e*x), x] - 1/(e*(e*f - d*g))* Int[(f + g*x)^ n*(c*d*f - b*e*f + a*e*g - c*(e*f - d*g)*x)*(a + b*x + c*x^2)^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && GtQ[p, 0] && LtQ[n, -1]
Int[(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_/(d_. + e_.*x_), x_Symbol] := (c*d^2 + a*e^2)/(e*(e*f - d*g))* Int[(f + g*x)^(n + 1)*(a + c*x^2)^(p - 1)/(d + e*x), x] - 1/(e*(e*f - d*g))* Int[(f + g*x)^ n*(c*d*f + a*e*g - c*(e*f - d*g)*x)*(a + c*x^2)^(p - 1), x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && GtQ[p, 0] && LtQ[n, -1]
Int[(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_/(d_. + e_.*x_), x_Symbol] := e*(e*f - d*g)/(c*d^2 - b*d*e + a*e^2)* Int[(f + g*x)^(n - 1)*(a + b*x + c*x^2)^(p + 1)/(d + e*x), x] + 1/(c*d^2 - b*d*e + a*e^2)* Int[(f + g*x)^(n - 1)*(c*d*f - b*e*f + a*e*g - c*(e*f - d*g)*x)*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && LtQ[p, -1] && GtQ[n, 0]
Int[(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_/(d_. + e_.*x_), x_Symbol] := e*(e*f - d*g)/(c*d^2 + a*e^2)* Int[(f + g*x)^(n - 1)*(a + c*x^2)^(p + 1)/(d + e*x), x] + 1/(c*d^2 + a*e^2)* Int[(f + g*x)^(n - 1)*(c*d*f + a*e*g - c*(e*f - d*g)*x)*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[n]] && Not[IntegerQ[p]] && LtQ[p, -1] && GtQ[n, 0]
Int[(f_. + g_.*x_)^n_/((d_. + e_.*x_)*Sqrt[a_. + b_.*x_ + c_.*x_^2]), x_Symbol] := Int[ExpandIntegrand[ 1/(Sqrt[f + g*x]*Sqrt[a + b*x + c*x^2]), (f + g*x)^(n + 1/2)/(d + e*x), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[n + 1/2]
Int[(f_. + g_.*x_)^n_/((d_. + e_.*x_)*Sqrt[a_ + c_.*x_^2]), x_Symbol] := Int[ExpandIntegrand[ 1/(Sqrt[f + g*x]*Sqrt[a + c*x^2]), (f + g*x)^(n + 1/2)/(d + e*x), x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[n + 1/2]
Int[(g_.*x_)^n_.*(a_ + c_.*x_^2)^p_/(d_ + e_.*x_), x_Symbol] := d*(g*x)^n/x^n*Int[(x^n*(a + c*x^2)^p)/(d^2 - e^2*x^2), x] - e*(g*x)^n/x^n*Int[(x^(n + 1)*(a + c*x^2)^p)/(d^2 - e^2*x^2), x] /; FreeQ[{a, c, d, e, g, n, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && Not[IntegersQ[n, 2*p]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && (IntegerQ[p] || ILtQ[m, 0] && ILtQ[n, 0]) && Not[IGtQ[m, 0] || IGtQ[n, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^n*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && NeQ[c*d^2 + a*e^2, 0] && (IntegerQ[p] || ILtQ[m, 0] && ILtQ[n, 0]) && Not[IGtQ[m, 0] || IGtQ[n, 0]]
Int[(g_.*x_)^n_.*(d_ + e_.*x_)^m_*(a_ + c_.*x_^2)^p_, x_Symbol] := (g*x)^n/x^n* Int[ExpandIntegrand[ x^n*(a + c*x^2)^ p, (d/(d^2 - e^2*x^2) - e*x/(d^2 - e^2*x^2))^(-m), x], x] /; FreeQ[{a, c, d, e, g, n, p}, x] && NeQ[c*d^2 + a*e^2, 0] && ILtQ[m, 0] && Not[IntegerQ[p]] && Not[IntegerQ[n]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Unintegrable[(d + e*x)^m*(f + g*x)^n*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && Not[IGtQ[m, 0] || IGtQ[n, 0]]
Int[(d_. + e_.*x_)^m_*(f_. + g_.*x_)^n_*(a_ + c_.*x_^2)^p_, x_Symbol] := Unintegrable[(d + e*x)^m*(f + g*x)^n*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && Not[IGtQ[m, 0] || IGtQ[n, 0]]
Int[(d_. + e_.*u_)^m_.*(f_. + g_.*u_)^n_.*(a_ + b_.*u_ + c_.*u_^2)^ p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(d + e*x)^m*(f + g*x)^n*(a + b*x + c*x^2)^p, x], x, u] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(d_. + e_.*u_)^m_.*(f_. + g_.*u_)^n_.*(a_ + c_.*u_^2)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(d + e*x)^m*(f + g*x)^n*(a + c*x^2)^p, x], x, u] /; FreeQ[{a, c, d, e, f, g, m, n, p}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.5 (a+b x+c x^2)^p (d+e x+f x^2)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.5 (a+b x+c x^2)^p (d+e x+f x^2)^q *)
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_ + e_.*x_ + f_.*x_^2)^q_., x_Symbol] := (c/f)^p*Int[(d + e*x + f*x^2)^(p + q), x] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && (IntegerQ[p] || GtQ[c/f, 0]) && (Not[IntegerQ[q]] || LeafCount[d + e*x + f*x^2] <= LeafCount[a + b*x + c*x^2])
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_., x_Symbol] := a^IntPart[p]*(a + b*x + c*x^2)^ FracPart[p]/(d^IntPart[p]*(d + e*x + f*x^2)^FracPart[p])* Int[(d + e*x + f*x^2)^(p + q), x] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_., x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(b + 2*c*x)^(2*p)*(d + e*x + f*x^2)^q, x] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_., x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(b + 2*c*x)^(2*p)*(d + f*x^2)^q, x] /; FreeQ[{a, b, c, d, f, p, q}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
(* Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] := 1/(2^(2*p+2*q+1)*c*(-c/(b^2-4*a*c))^p*(-f/(e^2-4*d*f))^q)* Subst[Int[(1-x^2/(b^2-4*a*c))^p*(1+e*x^2/(b*(4*c*d-b*e)))^q,x],x, b+2*c*x] /; FreeQ[{a,b,c,d,e,f,p,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] &&  EqQ[c*e-b*f,0] && (IntegerQ[p] || GtQ[-c/(b^2-4*a*c),0]) && (IntegerQ[q] ||  GtQ[-f/(e^2-4*d*f),0]) *)
(* Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] := (d+e*x+f*x^2)^q/(2^(2*p+2*q+1)*c*(-c/(b^2-4*a*c))^p*(-f*(d+e*x+f*x^ 2)/(e^2-4*d*f))^q)* Subst[Int[(1-x^2/(b^2-4*a*c))^p*(1+e*x^2/(b*(4*c*d-b*e)))^q,x],x, b+2*c*x] /; FreeQ[{a,b,c,d,e,f,p,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] &&  EqQ[c*e-b*f,0] && (IntegerQ[p] || GtQ[-c/(b^2-4*a*c),0]) && Not[IntegerQ[q] ||  GtQ[-f/(e^2-4*d*f),0]] *)
(* Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] := (a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q/(2^(2*p+2*q+1)*c*(-c*(a+b*x+c*x^2)/( b^2-4*a*c))^p*(-f*(d+e*x+f*x^2)/(e^2-4*d*f))^q)* Subst[Int[(1-x^2/(b^2-4*a*c))^p*(1+e*x^2/(b*(4*c*d-b*e)))^q,x],x, b+2*c*x] /; FreeQ[{a,b,c,d,e,f,p,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] &&  EqQ[c*e-b*f,0] *)
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (b + 2*c*x)*(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^ q/((b^2 - 4*a*c)*(p + 1)) - (1/((b^2 - 4*a*c)*(p + 1)))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[2*c*d*(2*p + 3) + b*e*q + (2*b*f*q + 2*c*e*(2*p + q + 3))*x + 2*c*f*(2*p + 2*q + 3)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + f_.*x_^2)^q_, x_Symbol] := (b + 2*c*x)*(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^ q/((b^2 - 4*a*c)*(p + 1)) - (1/((b^2 - 4*a*c)*(p + 1)))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q - 1)* Simp[2*c*d*(2*p + 3) + (2*b*f*q)*x + 2*c*f*(2*p + 2*q + 3)*x^2, x], x] /; FreeQ[{a, b, c, d, f}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_. + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (2*c*x)*(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^ q/((-4*a*c)*(p + 1)) - (1/((-4*a*c)*(p + 1)))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[2*c*d*(2*p + 3) + (2*c*e*(2*p + q + 3))*x + 2*c*f*(2*p + 2*q + 3)*x^2, x], x] /; FreeQ[{a, c, d, e, f}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (2*a*c^2*e - b^2*c*e + b^3*f + b*c*(c*d - 3*a*f) + c*(2*c^2*d + b^2*f - c*(b*e + 2*a*f))*x)*(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/ ((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1)) - (1/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1)))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[2*c*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1) - (2*c^2*d + b^2*f - c*(b*e + 2*a*f))*(a*f*(p + 1) - c*d*(p + 2)) - e*(b^2*c*e - 2*a*c^2*e - b^3*f - b*c*(c*d - 3*a*f))*(p + q + 2) + (2* f*(2*a*c^2*e - b^2*c*e + b^3*f + b*c*(c*d - 3*a*f))*(p + q + 2) - (2*c^2*d + b^2*f - c*(b*e + 2*a*f))*(b*f*(p + 1) - c*e*(2*p + q + 4)))*x + c*f*(2*c^2*d + b^2*f - c*(b*e + 2*a*f))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[(c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f), 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + f_.*x_^2)^q_, x_Symbol] := (b^3*f + b*c*(c*d - 3*a*f) + c*(2*c^2*d + b^2*f - c*(2*a*f))*x)*(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q + 1)/ ((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1)) - (1/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1)))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^q* Simp[2*c*(b^2*d*f + (c*d - a*f)^2)*(p + 1) - (2*c^2*d + b^2*f - c*(2*a*f))*(a*f*(p + 1) - c*d*(p + 2)) + (2* f*(b^3*f + b*c*(c*d - 3*a*f))*(p + q + 2) - (2*c^2*d + b^2*f - c*(2*a*f))*(b*f*(p + 1)))*x + c*f*(2*c^2*d + b^2*f - c*(2*a*f))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && NeQ[b^2*d*f + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_. + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (2*a*c^2*e + c*(2*c^2*d - c*(2*a*f))*x)*(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/ ((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1)) - (1/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1)))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[2*c*((c*d - a*f)^2 - (-a*e)*(c*e))*(p + 1) - (2*c^2*d - c*(2*a*f))*(a*f*(p + 1) - c*d*(p + 2)) - e*(-2*a*c^2*e)*(p + q + 2) + (2* f*(2*a*c^2*e)*(p + q + 2) - (2*c^2*d - c*(2*a*f))*(-c* e*(2*p + q + 4)))*x + c*f*(2*c^2*d - c*(2*a*f))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, c, d, e, f, q}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[a*c*e^2 + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (b*f*(3*p + 2*q) - c*e*(2*p + q) + 2*c*f*(p + q)*x)*(a + b*x + c*x^2)^(p - 1)*(d + e*x + f*x^2)^(q + 1)/(2* f^2*(p + q)*(2*p + 2*q + 1)) - 1/(2*f^2*(p + q)*(2*p + 2*q + 1))* Int[(a + b*x + c*x^2)^(p - 2)*(d + e*x + f*x^2)^q* Simp[(b*d - a*e)*(c*e - b*f)*(1 - p)*(2*p + q) - (p + q)*(b^2*d*f*(1 - p) - a*(f*(b*e - 2*a*f)*(2*p + 2*q + 1) + c*(2*d*f - e^2*(2*p + q)))) + (2*(c*d - a*f)*(c*e - b*f)*(1 - p)*(2*p + q) - (p + q)*((b^2 - 4*a*c)*e*f*(1 - p) + b*(c*(e^2 - 4*d*f)*(2*p + q) + f*(2*c*d - b*e + 2*a*f)*(2*p + 2*q + 1))))*x + ((c*e - b*f)^2*(1 - p)*p + c*(p + q)*(f*(b*e - 2*a*f)*(4*p + 2*q - 1) - c*(2*d*f*(1 - 2*p) + e^2*(3*p + q - 1))))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 1] && NeQ[p + q, 0] && NeQ[2*p + 2*q + 1, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + f_.*x_^2)^q_, x_Symbol] := (b*(3*p + 2*q) + 2*c*(p + q)*x)*(a + b*x + c*x^2)^(p - 1)*(d + f*x^2)^(q + 1)/(2* f*(p + q)*(2*p + 2*q + 1)) - 1/(2*f*(p + q)*(2*p + 2*q + 1))* Int[(a + b*x + c*x^2)^(p - 2)*(d + f*x^2)^q* Simp[b^2* d*(p - 1)*(2*p + q) - (p + q)*(b^2*d*(1 - p) - 2*a*(c*d - a*f*(2*p + 2*q + 1))) - (2*b*(c*d - a*f)*(1 - p)*(2*p + q) - 2*(p + q)* b*(2*c*d*(2*p + q) - (c*d + a*f)*(2*p + 2*q + 1)))*x + (b^2*f*p*(1 - p) + 2*c*(p + q)*(c*d*(2*p - 1) - a*f*(4*p + 2*q - 1)))*x^2, x], x] /; FreeQ[{a, b, c, d, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 1] && NeQ[p + q, 0] && NeQ[2*p + 2*q + 1, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_. + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := -c*(e*(2*p + q) - 2*f*(p + q)*x)*(a + c*x^2)^(p - 1)*(d + e*x + f*x^2)^(q + 1)/(2* f^2*(p + q)*(2*p + 2*q + 1)) - 1/(2*f^2*(p + q)*(2*p + 2*q + 1))* Int[(a + c*x^2)^(p - 2)*(d + e*x + f*x^2)^q* Simp[-a*c*e^2*(1 - p)*(2*p + q) + a*(p + q)*(-2*a*f^2*(2*p + 2*q + 1) + c*(2*d*f - e^2*(2*p + q))) + (2*(c*d - a*f)*(c*e)*(1 - p)*(2*p + q) + 4*a*c*e*f*(1 - p)*(p + q))*x + (p*c^2*e^2*(1 - p) - c*(p + q)*(2*a*f^2*(4*p + 2*q - 1) + c*(2*d*f*(1 - 2*p) + e^2*(3*p + q - 1))))*x^2, x], x] /; FreeQ[{a, c, d, e, f, q}, x] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 1] && NeQ[p + q, 0] && NeQ[2*p + 2*q + 1, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[1/((a_ + b_.*x_ + c_.*x_^2)*(d_ + e_.*x_ + f_.*x_^2)), x_Symbol] := With[{q = c^2*d^2 - b*c*d*e + a*c*e^2 + b^2*d*f - 2*a*c*d*f - a*b*e*f + a^2*f^2}, 1/q* Int[(c^2*d - b*c*e + b^2*f - a*c*f - (c^2*e - b*c*f)*x)/(a + b*x + c*x^2), x] + 1/q* Int[(c*e^2 - c*d*f - b*e*f + a*f^2 + (c*e*f - b*f^2)*x)/(d + e*x + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[1/((a_ + b_.*x_ + c_.*x_^2)*(d_ + f_.*x_^2)), x_Symbol] := With[{q = c^2*d^2 + b^2*d*f - 2*a*c*d*f + a^2*f^2}, 1/q*Int[(c^2*d + b^2*f - a*c*f + b*c*f*x)/(a + b*x + c*x^2), x] - 1/q*Int[(c*d*f - a*f^2 + b*f^2*x)/(d + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, f}, x] && NeQ[b^2 - 4*a*c, 0]
Int[1/((a_ + b_.*x_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := -2*e*Subst[Int[1/(e*(b*e - 4*a*f) - (b*d - a*e)*x^2), x], x, (e + 2*f*x)/Sqrt[d + e*x + f*x^2]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && EqQ[c*e - b*f, 0]
(* Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] := With[{k=Rt[(a/c-d/f)^2+(b/c-e/f)*(b*d/(c*f)-a*e/(c*f)),2]}, -2*(c*d-a*f+c*f*k+(c*e-b*f)*x)*Sqrt[(d+e*x+f*x^2)*((c*f*k)/(c*d-a*f+ c*f*k+(c*e-b*f)*x))^2]/(c*Sqrt[d+e*x+f*x^2])* Subst[Int[(1-x)/( (b*d-a*e-b*f*k-(c*d-a*f-c*f*k)^2/(c*e-b*f)+(b*d-a*e+b*f*k-(a*f- c*d-c*f*k)^2/(c*e-b*f))*x^2)* Sqrt[-f*((b*d-a*e-c*e*k)/(c*e-b*f)-(c*d-a*f-c*f*k)^2/(c*e-b*f)^ 2)-f*((b*d-a*e+c*e*k)/(c*e-b*f)-(a*f-c*d-c*f*k)^2/(c*e-b*f)^2)*x^2]), x],x, (c*d-a*f-c*f*k+(c*e-b*f)*x)/(c*d-a*f+c*f*k+(c*e-b*f)*x)]] /; FreeQ[{a,b,c,d,e,f},x] && RationalQ[a,b,c,d,e,f] && NeQ[b^2-4*a*c,0] &&  NeQ[e^2-4*d*f,0] && NeQ[c*e-b*f,0] && LtQ[b^2-4*a*c,0] *)
(* Int[1/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] := With[{k=Rt[(a/c-d/f)^2+a*e^2/(c*f^2),2]}, -2*(c*d-a*f+c*f*k+c*e*x)*Sqrt[(d+e*x+f*x^2)*((c*f*k)/(c*d-a*f+c*f*k+ c*e*x))^2]/(c*Sqrt[d+e*x+f*x^2])* Subst[Int[(1-x)/( (-a*e-(c*d-a*f-c*f*k)^2/(c*e)+(-a*e-(a*f-c*d-c*f*k)^2/(c*e))*x^ 2)* Sqrt[-f*((-a*e-c*e*k)/(c*e)-(c*d-a*f-c*f*k)^2/(c*e)^2)-f*((-a*e+ c*e*k)/(c*e)-(a*f-c*d-c*f*k)^2/(c*e)^2)*x^2]),x],x, (c*d-a*f-c*f*k+(c*e)*x)/(c*d-a*f+c*f*k+(c*e)*x)]] /; FreeQ[{a,c,d,e,f},x] && RationalQ[a,c,d,e,f] && NeQ[e^2-4*d*f,0] &&  LtQ[-a*c,0] *)
(* Int[1/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+f_.*x_^2]),x_Symbol] := With[{k=Rt[(a/c-d/f)^2+b^2*d/(c^2*f),2]}, -2*(c*d-a*f+c*f*k-b*f*x)*Sqrt[(d+f*x^2)*((c*f*k)/(c*d-a*f+c*f*k-b*f* x))^2]/(c*Sqrt[d+f*x^2])* Subst[Int[(1-x)/( (b*d-b*f*k+(c*d-a*f-c*f*k)^2/(b*f)+(b*d+b*f*k+(a*f-c*d-c*f*k)^2/ (b*f))*x^2)* Sqrt[-f*(-d/f-(c*d-a*f-c*f*k)^2/(b*f)^2)-f*(-d/f-(a*f-c*d-c*f*k) ^2/(b*f)^2)*x^2]),x],x, (c*d-a*f-c*f*k+(-b*f)*x)/(c*d-a*f+c*f*k+(-b*f)*x)]] /; FreeQ[{a,b,c,d,f},x] && RationalQ[a,b,c,d,f] && NeQ[b^2-4*a*c,0] &&  LtQ[b^2-4*a*c,0] *)
Int[1/((a_ + b_.*x_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/((b - q + 2*c*x)*Sqrt[d + e*x + f*x^2]), x] - 2*c/q*Int[1/((b + q + 2*c*x)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && NeQ[c*e - b*f, 0] && PosQ[b^2 - 4*a*c]
Int[1/((a_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := 1/2*Int[1/((a - Rt[-a*c, 2]*x)*Sqrt[d + e*x + f*x^2]), x] + 1/2*Int[1/((a + Rt[-a*c, 2]*x)*Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, c, d, e, f}, x] && NeQ[e^2 - 4*d*f, 0] && PosQ[-a*c]
Int[1/((a_ + b_.*x_ + c_.*x_^2)*Sqrt[d_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/((b - q + 2*c*x)*Sqrt[d + f*x^2]), x] - 2*c/q*Int[1/((b + q + 2*c*x)*Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, c, d, f}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[b^2 - 4*a*c]
Int[1/((a_. + b_.*x_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[(c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f), 2]}, 1/(2*q)* Int[(c*d - a*f + q + (c*e - b*f)*x)/((a + b*x + c*x^2)* Sqrt[d + e*x + f*x^2]), x] - 1/(2*q)* Int[(c*d - a*f - q + (c*e - b*f)*x)/((a + b*x + c*x^2)* Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && NeQ[c*e - b*f, 0] && NegQ[b^2 - 4*a*c]
Int[1/((a_. + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[(c*d - a*f)^2 + a*c*e^2, 2]}, 1/(2*q)* Int[(c*d - a*f + q + c*e*x)/((a + c*x^2)*Sqrt[d + e*x + f*x^2]), x] - 1/(2*q)* Int[(c*d - a*f - q + c*e*x)/((a + c*x^2)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, c, d, e, f}, x] && NeQ[e^2 - 4*d*f, 0] && NegQ[-a*c]
Int[1/((a_. + b_.*x_ + c_.*x_^2)*Sqrt[d_. + f_.*x_^2]), x_Symbol] := With[{q = Rt[(c*d - a*f)^2 + b^2*d*f, 2]}, 1/(2*q)* Int[(c*d - a*f + q + (-b*f)*x)/((a + b*x + c*x^2)* Sqrt[d + f*x^2]), x] - 1/(2*q)* Int[(c*d - a*f - q + (-b*f)*x)/((a + b*x + c*x^2)* Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, c, d, f}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[b^2 - 4*a*c]
Int[Sqrt[a_ + b_.*x_ + c_.*x_^2]/(d_ + e_.*x_ + f_.*x_^2), x_Symbol] := c/f*Int[1/Sqrt[a + b*x + c*x^2], x] - 1/f* Int[(c*d - a*f + (c*e - b*f)*x)/(Sqrt[ a + b*x + c*x^2]*(d + e*x + f*x^2)), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[Sqrt[a_ + b_.*x_ + c_.*x_^2]/(d_ + f_.*x_^2), x_Symbol] := c/f*Int[1/Sqrt[a + b*x + c*x^2], x] - 1/f* Int[(c*d - a*f - b*f*x)/(Sqrt[a + b*x + c*x^2]*(d + f*x^2)), x] /; FreeQ[{a, b, c, d, f}, x] && NeQ[b^2 - 4*a*c, 0]
Int[Sqrt[a_ + c_.*x_^2]/(d_ + e_.*x_ + f_.*x_^2), x_Symbol] := c/f*Int[1/Sqrt[a + c*x^2], x] - 1/f* Int[(c*d - a*f + c*e*x)/(Sqrt[a + c*x^2]*(d + e*x + f*x^2)), x] /; FreeQ[{a, c, d, e, f}, x] && NeQ[e^2 - 4*d*f, 0]
Int[1/(Sqrt[a_ + b_.*x_ + c_.*x_^2]*Sqrt[d_ + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{r = Rt[b^2 - 4*a*c, 2]}, Sqrt[b + r + 2*c*x]*Sqrt[2*a + (b + r)*x]/Sqrt[a + b*x + c*x^2]* Int[1/(Sqrt[b + r + 2*c*x]*Sqrt[2*a + (b + r)*x]* Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[1/(Sqrt[a_ + b_.*x_ + c_.*x_^2]*Sqrt[d_ + f_.*x_^2]), x_Symbol] := With[{r = Rt[b^2 - 4*a*c, 2]}, Sqrt[b + r + 2*c*x]*Sqrt[2*a + (b + r)*x]/Sqrt[a + b*x + c*x^2]* Int[1/(Sqrt[b + r + 2*c*x]*Sqrt[2*a + (b + r)*x]*Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, c, d, f}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := Unintegrable[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^q, x] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := Unintegrable[(a + c*x^2)^p*(d + e*x + f*x^2)^q, x] /; FreeQ[{a, c, d, e, f, p, q}, x] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_. + b_.*u_ + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^q_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^q, x], x, u] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^q_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + c*x^2)^p*(d + e*x + f*x^2)^q, x], x, u] /; FreeQ[{a, c, d, e, f, p, q}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.5 (g+h x)^m (a+b x+c x^2)^p (d+e x+f x^2)^q.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (c/f)^p \[Star] Int[(g+h*x)^m*(d+e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,d,e,f,g,h,p,q},x] && EqQ[c*d-a*f,0] && EqQ[b*d-a*e,0] && (IntegerQ[p] || GtQ[c/f,0]) && 
  (Not[IntegerQ[q]] || LeafCount[d+e*x+f*x^2]<=LeafCount[a+b*x+c*x^2])


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  a^IntPart[p]*(a+b*x+c*x^2)^FracPart[p]/(d^IntPart[p]*(d+e*x+f*x^2)^FracPart[p]) \[Star] Int[(g+h*x)^m*(d+e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,d,e,f,g,h,p,q},x] && EqQ[c*d-a*f,0] && EqQ[b*d-a*e,0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f,0]]


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  1/c^p \[Star] Int[(g+h*x)^m*(b/2+c*x)^(2*p)*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,g,h,m,q},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p]


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+f_.*x_^2)^q_.,x_Symbol] :=
  1/c^p \[Star] Int[(g+h*x)^m*(b/2+c*x)^(2*p)*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,g,h,m,q},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p]


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(g+h*x)^m*(b+2*c*x)^(2*p)*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,g,h,m,p,q},x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(g+h*x)^m*(b+2*c*x)^(2*p)*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,g,h,m,p,q},x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^m_.,x_Symbol] :=
  Int[(d*g/a+f*h*x/c)^m*(a+b*x+c*x^2)^(m+p),x] /;
FreeQ[{a,b,c,d,e,f,g,h,p},x] && EqQ[c*g^2-b*g*h+a*h^2,0] && EqQ[c^2*d*g^2-a*c*e*g*h+a^2*f*h^2,0] && IntegerQ[m]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^m_.,x_Symbol] :=
  Int[(d*g/a+f*h*x/c)^m*(a+c*x^2)^(m+p),x] /;
FreeQ[{a,c,d,e,f,g,h,p},x] && EqQ[c*g^2+a*h^2,0] && EqQ[c^2*d*g^2-a*c*e*g*h+a^2*f*h^2,0] && IntegerQ[m]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*(a_+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^m_.,x_Symbol] :=
  Int[(d*g/a+f*h*x/c)^m*(a+b*x+c*x^2)^(m+p),x] /;
FreeQ[{a,b,c,d,f,g,h,p},x] && EqQ[c*g^2-b*g*h+a*h^2,0] && EqQ[c^2*d*g^2+a^2*f*h^2,0] && IntegerQ[m]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^m_.,x_Symbol] :=
  Int[(d*g/a+f*h*x/c)^m*(a+c*x^2)^(m+p),x] /;
FreeQ[{a,c,d,f,g,h,p},x] && EqQ[c*g^2+a*h^2,0] && EqQ[c^2*d*g^2+a^2*f*h^2,0] && IntegerQ[m]


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,g,h,m,q},x] && EqQ[c*g^2-b*g*h+a*h^2,0] && IntegerQ[p] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,c,d,e,f,g,h,m,q},x] && NeQ[e^2-4*d*f,0] && EqQ[c*g^2+a*h^2,0] && IntegerQ[p] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,g,h,m,q},x] && NeQ[b^2-4*a*c,0] && EqQ[c*g^2-b*g*h+a*h^2,0] && IntegerQ[p] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /;
FreeQ[{a,c,d,f,g,h,m,q},x] && EqQ[c*g^2+a*h^2,0] && IntegerQ[p] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^FracPart[p]) \[Star] Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,g,h,m,q},x] && EqQ[c*g^2-b*g*h+a*h^2,0] && Not[IntegerQ[p]] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  (a+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^FracPart[p]) \[Star] Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,c,d,e,f,g,h,m,q},x] && NeQ[e^2-4*d*f,0] && EqQ[c*g^2+a*h^2,0] && Not[IntegerQ[p]] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^FracPart[p]) \[Star] Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,g,h,m,q},x] && NeQ[b^2-4*a*c,0] && EqQ[c*g^2-b*g*h+a*h^2,0] && Not[IntegerQ[p]] *)


(* ::Code:: *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] :=
  (a+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^FracPart[p]) \[Star] Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /;
FreeQ[{a,c,d,f,g,h,m,q},x] && EqQ[c*g^2+a*h^2,0] && Not[IntegerQ[p]] *)


(* ::Code:: *)
Int[x_^p_*(a_.+b_.*x_+c_.*x_^2)^p_*(e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  Int[(a/e+c/f*x)^p*(e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,e,f,q},x] && NeQ[b^2-4*a*c,0] && EqQ[c*e^2-b*e*f+a*f^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[x_^p_*(a_+c_.*x_^2)^p_*(e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  Int[(a/e+c/f*x)^p*(e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,c,e,f,q},x] && EqQ[c*e^2+a*f^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_+c_.*x_^2)^(1/3)*(d_+f_.*x_^2)),x_Symbol] :=
  Sqrt[3]*h*ArcTan[1/Sqrt[3]-2^(2/3)*(1-3*h*x/g)^(2/3)/(Sqrt[3]*(1+3*h*x/g)^(1/3))]/(2^(2/3)*a^(1/3)*f) + 
  h*Log[d+f*x^2]/(2^(5/3)*a^(1/3)*f) - 
  3*h*Log[(1-3*h*x/g)^(2/3)+2^(1/3)*(1+3*h*x/g)^(1/3)]/(2^(5/3)*a^(1/3)*f) /;
FreeQ[{a,c,d,f,g,h},x] && EqQ[c*d+3*a*f,0] && EqQ[c*g^2+9*a*h^2,0] && GtQ[a,0]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_+c_.*x_^2)^(1/3)*(d_+f_.*x_^2)),x_Symbol] :=
  (1+c*x^2/a)^(1/3)/(a+c*x^2)^(1/3) \[Star] Int[(g+h*x)/((1+c*x^2/a)^(1/3)*(d+f*x^2)),x] /;
FreeQ[{a,c,d,f,g,h},x] && EqQ[c*d+3*a*f,0] && EqQ[c*g^2+9*a*h^2,0] && Not[GtQ[a,0]]


(* ::Code:: *)
Int[(g_+h_.*x_)*(a_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_,x_Symbol] :=
  g \[Star] Int[(a+c*x^2)^p*(d+f*x^2)^q,x] + h \[Star] Int[x*(a+c*x^2)^p*(d+f*x^2)^q,x] /;
FreeQ[{a,c,d,f,g,h,p,q},x]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q*(g+h*x),x],x] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && IGtQ[p,0] && IntegerQ[q]


(* ::Code:: *)
Int[(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  Int[ExpandIntegrand[(a+c*x^2)^p*(d+e*x+f*x^2)^q*(g+h*x),x],x] /;
FreeQ[{a,c,d,e,f,g,h},x] && NeQ[e^2-4*d*f,0] && IntegersQ[p,q] && (GtQ[p,0] || GtQ[q,0])


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  (g*b-2*a*h-(b*h-2*g*c)*x)*(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^q/((b^2-4*a*c)*(p+1)) - 
  1/((b^2-4*a*c)*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q-1)*
      Simp[e*q*(g*b-2*a*h)-d*(b*h-2*g*c)*(2*p+3)+
        (2*f*q*(g*b-2*a*h)-e*(b*h-2*g*c)*(2*p+q+3))*x-
        f*(b*h-2*g*c)*(2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && GtQ[q,0]


(* ::Code:: *)
Int[(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  (a*h-g*c*x)*(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^q/(2*a*c*(p+1)) + 
  2/(4*a*c*(p+1)) \[Star] 
    Int[(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q-1)*
      Simp[g*c*d*(2*p+3)-a*(h*e*q)+(g*c*e*(2*p+q+3)-a*(2*h*f*q))*x+g*c*f*(2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g,h},x] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && GtQ[q,0]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  (g*b-2*a*h-(b*h-2*g*c)*x)*(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^q/((b^2-4*a*c)*(p+1)) - 
  1/((b^2-4*a*c)*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^(q-1)*
      Simp[-d*(b*h-2*g*c)*(2*p+3)+(2*f*q*(g*b-2*a*h))*x-f*(b*h-2*g*c)*(2*p+2*q+3)*x^2,x],x] /;
FreeQ[{a,b,c,d,f,g,h},x] && NeQ[b^2-4*a*c,0] && LtQ[p,-1] && GtQ[q,0]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  (a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q+1)/((b^2-4*a*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1))*
    (g*c*(2*a*c*e-b*(c*d+a*f))+(g*b-a*h)*(2*c^2*d+b^2*f-c*(b*e+2*a*f))+
      c*(g*(2*c^2*d+b^2*f-c*(b*e+2*a*f))-h*(b*c*d-2*a*c*e+a*b*f))*x) + 
  1/((b^2-4*a*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^q*
      Simp[(b*h-2*g*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1)+
        (b^2*(g*f)-b*(h*c*d+g*c*e+a*h*f)+2*(g*c*(c*d-a*f)-a*(-h*c*e)))*(a*f*(p+1)-c*d*(p+2))-
        e*((g*c)*(2*a*c*e-b*(c*d+a*f))+(g*b-a*h)*(2*c^2*d+b^2*f-c*(b*e+2*a*f)))*(p+q+2)-
        (2*f*((g*c)*(2*a*c*e-b*(c*d+a*f))+(g*b-a*h)*(2*c^2*d+b^2*f-c*(b*e+2*a*f)))*(p+q+2)-
          (b^2*g*f-b*(h*c*d+g*c*e+a*h*f)+2*(g*c*(c*d-a*f)-a*(-h*c*e)))*
          (b*f*(p+1)-c*e*(2*p+q+4)))*x-
        c*f*(b^2*(g*f)-b*(h*c*d+g*c*e+a*h*f)+2*(g*c*(c*d-a*f)+a*h*c*e))*(2*p+2*q+5)*x^2,x],x]/;
FreeQ[{a,b,c,d,e,f,g,h,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && 
  NeQ[(c*d-a*f)^2-(b*d-a*e)*(c*e-b*f),0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]]


(* ::Code:: *)
Int[(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  (a+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q+1)/((-4*a*c)*(a*c*e^2+(c*d-a*f)^2)*(p+1))*
    (g*c*(2*a*c*e)+(-a*h)*(2*c^2*d-c*(2*a*f))+
      c*(g*(2*c^2*d-c*(2*a*f))-h*(-2*a*c*e))*x) + 
  1/((-4*a*c)*(a*c*e^2+(c*d-a*f)^2)*(p+1)) \[Star] 
    Int[(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^q*
      Simp[(-2*g*c)*((c*d-a*f)^2-(-a*e)*(c*e))*(p+1)+
        (2*(g*c*(c*d-a*f)-a*(-h*c*e)))*(a*f*(p+1)-c*d*(p+2))-
        e*((g*c)*(2*a*c*e)+(-a*h)*(2*c^2*d-c*(+2*a*f)))*(p+q+2)-
        (2*f*((g*c)*(2*a*c*e)+(-a*h)*(2*c^2*d+-c*(+2*a*f)))*(p+q+2)-(2*(g*c*(c*d-a*f)-a*(-h*c*e)))*(-c*e*(2*p+q+4)))*x-
        c*f*(2*(g*c*(c*d-a*f)-a*(-h*c*e)))*(2*p+2*q+5)*x^2,x],x]/;
FreeQ[{a,c,d,e,f,g,h,q},x] && NeQ[e^2-4*d*f,0] && LtQ[p,-1] && NeQ[a*c*e^2+(c*d-a*f)^2,0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  (a+b*x+c*x^2)^(p+1)*(d+f*x^2)^(q+1)/((b^2-4*a*c)*(b^2*d*f+(c*d-a*f)^2)*(p+1))*
    ((g*c)*(-b*(c*d+a*f))+(g*b-a*h)*(2*c^2*d+b^2*f-c*(2*a*f))+
      c*(g*(2*c^2*d+b^2*f-c*(2*a*f))-h*(b*c*d+a*b*f))*x) + 
  1/((b^2-4*a*c)*(b^2*d*f+(c*d-a*f)^2)*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^q*
      Simp[(b*h-2*g*c)*((c*d-a*f)^2-(b*d)*(-b*f))*(p+1)+
        (b^2*(g*f)-b*(h*c*d+a*h*f)+2*(g*c*(c*d-a*f)))*(a*f*(p+1)-c*d*(p+2))-
        (2*f*((g*c)*(-b*(c*d+a*f))+(g*b-a*h)*(2*c^2*d+b^2*f-c*(2*a*f)))*(p+q+2)-
          (b^2*(g*f)-b*(h*c*d+a*h*f)+2*(g*c*(c*d-a*f)))*
          (b*f*(p+1)))*x-
        c*f*(b^2*(g*f)-b*(h*c*d+a*h*f)+2*(g*c*(c*d-a*f)))*(2*p+2*q+5)*x^2,x],x]/;
FreeQ[{a,b,c,d,f,g,h,q},x] && NeQ[b^2-4*a*c,0] && LtQ[p,-1] && NeQ[b^2*d*f+(c*d-a*f)^2,0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  h*(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^(q+1)/(2*f*(p+q+1)) - 
  (1/(2*f*(p+q+1))) \[Star] 
    Int[(a+b*x+c*x^2)^(p-1)*(d+e*x+f*x^2)^q*
      Simp[h*p*(b*d-a*e)+a*(h*e-2*g*f)*(p+q+1)+
        (2*h*p*(c*d-a*f)+b*(h*e-2*g*f)*(p+q+1))*x+
        (h*p*(c*e-b*f)+c*(h*e-2*g*f)*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,e,f,g,h,q},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && GtQ[p,0] && NeQ[p+q+1,0]


(* ::Code:: *)
Int[(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  h*(a+c*x^2)^p*(d+e*x+f*x^2)^(q+1)/(2*f*(p+q+1)) + 
  (1/(2*f*(p+q+1))) \[Star] 
    Int[(a+c*x^2)^(p-1)*(d+e*x+f*x^2)^q*
      Simp[a*h*e*p-a*(h*e-2*g*f)*(p+q+1)-2*h*p*(c*d-a*f)*x-(h*c*e*p+c*(h*e-2*g*f)*(p+q+1))*x^2,x],x] /;
FreeQ[{a,c,d,e,f,g,h,q},x] && NeQ[e^2-4*d*f,0] && GtQ[p,0] && NeQ[p+q+1,0]


(* ::Code:: *)
Int[(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  h*(a+b*x+c*x^2)^p*(d+f*x^2)^(q+1)/(2*f*(p+q+1)) - 
  (1/(2*f*(p+q+1))) \[Star] 
    Int[(a+b*x+c*x^2)^(p-1)*(d+f*x^2)^q*
      Simp[h*p*(b*d)+a*(-2*g*f)*(p+q+1)+
        (2*h*p*(c*d-a*f)+b*(-2*g*f)*(p+q+1))*x+
        (h*p*(-b*f)+c*(-2*g*f)*(p+q+1))*x^2,x],x] /;
FreeQ[{a,b,c,d,f,g,h,q},x] && NeQ[b^2-4*a*c,0] && GtQ[p,0] && NeQ[p+q+1,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*(d_+e_.*x_+f_.*x_^2)),x_Symbol] :=
  With[{q=Simplify[c^2*d^2-b*c*d*e+a*c*e^2+b^2*d*f-2*a*c*d*f-a*b*e*f+a^2*f^2]},
  1/q \[Star] Int[Simp[g*c^2*d-g*b*c*e+a*h*c*e+g*b^2*f-a*b*h*f-a*g*c*f+c*(h*c*d-g*c*e+g*b*f-a*h*f)*x,x]/(a+b*x+c*x^2),x] + 
  1/q \[Star] Int[Simp[-h*c*d*e+g*c*e^2+b*h*d*f-g*c*d*f-g*b*e*f+a*g*f^2-f*(h*c*d-g*c*e+g*b*f-a*h*f)*x,x]/(d+e*x+f*x^2),x] /;
 NeQ[q,0]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*(d_+f_.*x_^2)),x_Symbol] :=
  With[{q=Simplify[c^2*d^2+b^2*d*f-2*a*c*d*f+a^2*f^2]},
  1/q \[Star] Int[Simp[g*c^2*d+g*b^2*f-a*b*h*f-a*g*c*f+c*(h*c*d+g*b*f-a*h*f)*x,x]/(a+b*x+c*x^2),x] + 
  1/q \[Star] Int[Simp[b*h*d*f-g*c*d*f+a*g*f^2-f*(h*c*d+g*b*f-a*h*f)*x,x]/(d+f*x^2),x] /;
 NeQ[q,0]] /;
FreeQ[{a,b,c,d,f,g,h},x] && NeQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -2*g \[Star] Subst[Int[1/(b*d-a*e-b*x^2),x],x,Sqrt[d+e*x+f*x^2]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[c*e-b*f,0] && EqQ[h*e-2*g*f,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -(h*e-2*g*f)/(2*f) \[Star] Int[1/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x] + 
  h/(2*f) \[Star] Int[(e+2*f*x)/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[c*e-b*f,0] && NeQ[h*e-2*g*f,0]


(* ::Code:: *)
Int[x_/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -2*e \[Star] Subst[Int[(1-d*x^2)/(c*e-b*f-e*(2*c*d-b*e+2*a*f)*x^2+d^2*(c*e-b*f)*x^4),x],x,
    (1+(e+Sqrt[e^2-4*d*f])*x/(2*d))/Sqrt[d+e*x+f*x^2]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[b*d-a*e,0]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_+e_.*x_+f_.*x_^2]),x_Symbol] :=
  g \[Star] Subst[Int[1/(a+(c*d-a*f)*x^2),x],x,x/Sqrt[d+e*x+f*x^2]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[b*d-a*e,0] && EqQ[2*h*d-g*e,0]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -(2*h*d-g*e)/e \[Star] Int[1/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x] + 
  h/e \[Star] Int[(2*d+e*x)/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && EqQ[b*d-a*e,0] && NeQ[2*h*d-g*e,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_.+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -2*g*(g*b-2*a*h) \[Star] 
    Subst[Int[1/Simp[g*(g*b-2*a*h)*(b^2-4*a*c)-(b*d-a*e)*x^2,x],x],x,Simp[g*b-2*a*h-(b*h-2*g*c)*x,x]/Sqrt[d+e*x+f*x^2]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && NeQ[b*d-a*e,0] && 
  EqQ[h^2*(b*d-a*e)-2*g*h*(c*d-a*f)+g^2*(c*e-b*f),0]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  -2*a*g*h \[Star] Subst[Int[1/Simp[2*a^2*g*h*c+a*e*x^2,x],x],x,Simp[a*h-g*c*x,x]/Sqrt[d+e*x+f*x^2]] /;
FreeQ[{a,c,d,e,f,g,h},x] && EqQ[a*h^2*e+2*g*h*(c*d-a*f)-g^2*c*e,0]


(* ::Code:: *)
Int[(g_+h_.*x_)/((a_.+b_.*x_+c_.*x_^2)*Sqrt[d_+f_.*x_^2]),x_Symbol] :=
  -2*g*(g*b-2*a*h) \[Star] Subst[Int[1/Simp[g*(g*b-2*a*h)*(b^2-4*a*c)-b*d*x^2,x],x],x,Simp[g*b-2*a*h-(b*h-2*g*c)*x,x]/Sqrt[d+f*x^2]] /;
FreeQ[{a,b,c,d,f,g,h},x] && NeQ[b^2-4*a*c,0] && EqQ[b*h^2*d-2*g*h*(c*d-a*f)-g^2*b*f,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
  (2*c*g-h*(b-q))/q \[Star] Int[1/((b-q+2*c*x)*Sqrt[d+e*x+f*x^2]),x] -
  (2*c*g-h*(b+q))/q \[Star] Int[1/((b+q+2*c*x)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && PosQ[b^2-4*a*c]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[-a*c,2]},
  (h/2+c*g/(2*q)) \[Star] Int[1/((-q+c*x)*Sqrt[d+e*x+f*x^2]),x] +
  (h/2-c*g/(2*q)) \[Star] Int[1/((q+c*x)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,c,d,e,f,g,h},x] && NeQ[e^2-4*d*f,0] && PosQ[-a*c]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]},
  (2*c*g-h*(b-q))/q \[Star] Int[1/((b-q+2*c*x)*Sqrt[d+f*x^2]),x] -
  (2*c*g-h*(b+q))/q \[Star] Int[1/((b+q+2*c*x)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,c,d,f,g,h},x] && NeQ[b^2-4*a*c,0] && PosQ[b^2-4*a*c]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_.+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[(c*d-a*f)^2-(b*d-a*e)*(c*e-b*f),2]},
  1/(2*q) \[Star] Int[Simp[h*(b*d-a*e)-g*(c*d-a*f-q)-(g*(c*e-b*f)-h*(c*d-a*f+q))*x,x]/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x] - 
  1/(2*q) \[Star] Int[Simp[h*(b*d-a*e)-g*(c*d-a*f+q)-(g*(c*e-b*f)-h*(c*d-a*f-q))*x,x]/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0] && NeQ[b*d-a*e,0] && NegQ[b^2-4*a*c]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[(c*d-a*f)^2+a*c*e^2,2]},
  1/(2*q) \[Star] Int[Simp[-a*h*e-g*(c*d-a*f-q)+(h*(c*d-a*f+q)-g*c*e)*x,x]/((a+c*x^2)*Sqrt[d+e*x+f*x^2]),x] - 
  1/(2*q) \[Star] Int[Simp[-a*h*e-g*(c*d-a*f+q)+(h*(c*d-a*f-q)-g*c*e)*x,x]/((a+c*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,c,d,e,f,g,h},x] && NeQ[e^2-4*d*f,0] && NegQ[-a*c]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_.+b_.*x_+c_.*x_^2)*Sqrt[d_+f_.*x_^2]),x_Symbol] :=
  With[{q=Rt[(c*d-a*f)^2+b^2*d*f,2]},
  1/(2*q) \[Star] Int[Simp[h*b*d-g*(c*d-a*f-q)+(h*(c*d-a*f+q)+g*b*f)*x,x]/((a+b*x+c*x^2)*Sqrt[d+f*x^2]),x] - 
  1/(2*q) \[Star] Int[Simp[h*b*d-g*(c*d-a*f+q)+(h*(c*d-a*f-q)+g*b*f)*x,x]/((a+b*x+c*x^2)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,c,d,f,g,h},x] && NeQ[b^2-4*a*c,0] && NegQ[b^2-4*a*c]


(* ::Code:: *)
Int[(g_.+h_.*x_)/(Sqrt[a_+b_.*x_+c_.*x_^2]*Sqrt[d_+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{s=Rt[b^2-4*a*c,2],t=Rt[e^2-4*d*f,2]},
  Sqrt[b+s+2*c*x]*Sqrt[2*a+(b+s)*x]*Sqrt[e+t+2*f*x]*Sqrt[2*d+(e+t)*x]/(Sqrt[a+b*x+c*x^2]*Sqrt[d+e*x+f*x^2]) \[Star] 
    Int[(g+h*x)/(Sqrt[b+s+2*c*x]*Sqrt[2*a+(b+s)*x]*Sqrt[e+t+2*f*x]*Sqrt[2*d+(e+t)*x]),x]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b^2-4*a*c,0] && NeQ[e^2-4*d*f,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/(Sqrt[a_+b_.*x_+c_.*x_^2]*Sqrt[d_+f_.*x_^2]),x_Symbol] :=
  With[{s=Rt[b^2-4*a*c,2],t=Rt[-4*d*f,2]},
  Sqrt[b+s+2*c*x]*Sqrt[2*a+(b+s)*x]*Sqrt[t+2*f*x]*Sqrt[2*d+t*x]/(Sqrt[a+b*x+c*x^2]*Sqrt[d+f*x^2]) \[Star] 
    Int[(g+h*x)/(Sqrt[b+s+2*c*x]*Sqrt[2*a+(b+s)*x]*Sqrt[t+2*f*x]*Sqrt[2*d+t*x]),x]] /;
FreeQ[{a,b,c,d,f,g,h},x] && NeQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_.+b_.*x_+c_.*x_^2)^(1/3)*(d_.+e_.*x_+f_.*x_^2)),x_Symbol] :=
  With[{q=(-9*c*h^2/(2*c*g-b*h)^2)^(1/3)},
  Sqrt[3]*h*q*ArcTan[1/Sqrt[3]-2^(2/3)*(1-(3*h*(b+2*c*x))/(2*c*g-b*h))^(2/3)/(Sqrt[3]*(1+(3*h*(b+2*c*x))/(2*c*g-b*h))^(1/3))]/f + 
  h*q*Log[d+e*x+f*x^2]/(2*f) - 
  3*h*q*Log[(1-3*h*(b+2*c*x)/(2*c*g-b*h))^(2/3)+2^(1/3)*(1+3*h*(b+2*c*x)/(2*c*g-b*h))^(1/3)]/(2*f)] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && EqQ[c*e-b*f,0] && EqQ[c^2*d-f*(b^2-3*a*c),0] && EqQ[c^2*g^2-b*c*g*h-2*b^2*h^2+9*a*c*h^2,0] && 
  GtQ[-9*c*h^2/(2*c*g-b*h)^2,0]


(* ::Code:: *)
Int[(g_.+h_.*x_)/((a_.+b_.*x_+c_.*x_^2)^(1/3)*(d_.+e_.*x_+f_.*x_^2)),x_Symbol] :=
  With[{q=-c/(b^2-4*a*c)},
  (q*(a+b*x+c*x^2))^(1/3)/(a+b*x+c*x^2)^(1/3) \[Star] Int[(g+h*x)/((q*a+b*q*x+c*q*x^2)^(1/3)*(d+e*x+f*x^2)),x]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && EqQ[c*e-b*f,0] && EqQ[c^2*d-f*(b^2-3*a*c),0] && EqQ[c^2*g^2-b*c*g*h-2*b^2*h^2+9*a*c*h^2,0] && Not[GtQ[4*a-b^2/c,0]]


(* ::Code:: *)
Int[(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  Unintegrable[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q*(g+h*x),x] /;
FreeQ[{a,b,c,d,e,f,g,h,p,q},x]


(* ::Code:: *)
Int[(a_.+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_*(g_.+h_.*x_),x_Symbol] :=
  Unintegrable[(a+c*x^2)^p*(d+e*x+f*x^2)^q*(g+h*x),x] /;
FreeQ[{a,c,d,e,f,g,h,p,q},x]


(* ::Code:: *)
Int[(g_.+h_.*u_)^m_.*(a_.+b_.*u_+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(g+h*x)^m*(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q,x],x,u] /;
FreeQ[{a,b,c,d,e,f,g,h,m,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(g_.+h_.*u_)^m_.*(a_.+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.,x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(g+h*x)^m*(a+c*x^2)^p*(d+e*x+f*x^2)^q,x],x,u] /;
FreeQ[{a,c,d,e,f,g,h,m,p,q},x] && LinearQ[u,x] && NeQ[u,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.6 (g+h x)^m (a+b x+c x^2)^p (d+e x+f x^2)^q.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.6 (g+h x)^m (a+b x+c x^2)^p (d+e x+f x^2)^q *)
Int[(g_. + h_.*x_)^m_.*(a_ + b_.*x_ + c_.*x_^2)^ p_*(d_ + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (c/f)^p*Int[(g + h*x)^m*(d + e*x + f*x^2)^(p + q), x] /; FreeQ[{a, b, c, d, e, f, g, h, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && (IntegerQ[p] || GtQ[c/f, 0]) && (Not[IntegerQ[q]] || LeafCount[d + e*x + f*x^2] <= LeafCount[a + b*x + c*x^2])
Int[(g_. + h_.*x_)^m_.*(a_ + b_.*x_ + c_.*x_^2)^ p_*(d_ + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := a^IntPart[p]*(a + b*x + c*x^2)^ FracPart[p]/(d^IntPart[p]*(d + e*x + f*x^2)^FracPart[p])* Int[(g + h*x)^m*(d + e*x + f*x^2)^(p + q), x] /; FreeQ[{a, b, c, d, e, f, g, h, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f, 0]]
Int[(g_. + h_.*x_)^m_.*(a_ + b_.*x_ + c_.*x_^2)^ p_*(d_ + e_.*x_ + f_.*x_^2)^q_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(g + h*x)^m*(b + 2*c*x)^(2*p)*(d + e*x + f*x^2)^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, p, q}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(g_. + h_.*x_)^m_.*(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(g + h*x)^m*(b + 2*c*x)^(2*p)*(d + f*x^2)^q, x] /; FreeQ[{a, b, c, d, f, g, h, m, p, q}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(g_ + h_.*x_)^m_.*(a_ + b_.*x_ + c_.*x_^2)^ p_*(d_. + e_.*x_ + f_.*x_^2)^m_., x_Symbol] := Int[(d*g/a + f*h*x/c)^m*(a + b*x + c*x^2)^(m + p), x] /; FreeQ[{a, b, c, d, e, f, g, h, p}, x] && EqQ[c*g^2 - b*g*h + a*h^2, 0] && EqQ[c^2*d*g^2 - a*c*e*g*h + a^2*f*h^2, 0] && IntegerQ[m]
Int[(g_ + h_.*x_)^m_.*(a_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^ m_., x_Symbol] := Int[(d*g/a + f*h*x/c)^m*(a + c*x^2)^(m + p), x] /; FreeQ[{a, c, d, e, f, g, h, p}, x] && EqQ[c*g^2 + a*h^2, 0] && EqQ[c^2*d*g^2 - a*c*e*g*h + a^2*f*h^2, 0] && IntegerQ[m]
Int[(g_ + h_.*x_)^m_.*(a_ + b_.*x_ + c_.*x_^2)^p_*(d_. + f_.*x_^2)^ m_., x_Symbol] := Int[(d*g/a + f*h*x/c)^m*(a + b*x + c*x^2)^(m + p), x] /; FreeQ[{a, b, c, d, f, g, h, p}, x] && EqQ[c*g^2 - b*g*h + a*h^2, 0] && EqQ[c^2*d*g^2 + a^2*f*h^2, 0] && IntegerQ[m]
Int[(g_ + h_.*x_)^m_.*(a_ + c_.*x_^2)^p_*(d_. + f_.*x_^2)^m_., x_Symbol] := Int[(d*g/a + f*h*x/c)^m*(a + c*x^2)^(m + p), x] /; FreeQ[{a, c, d, f, g, h, p}, x] && EqQ[c*g^2 + a*h^2, 0] && EqQ[c^2*d*g^2 + a^2*f*h^2, 0] && IntegerQ[m]
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^ q_,x_Symbol] := Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /; FreeQ[{a,b,c,d,e,f,g,h,m,q},x] && EqQ[c*g^2-b*g*h+a*h^2,0] &&  IntegerQ[p] *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_ Symbol] := Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /; FreeQ[{a,c,d,e,f,g,h,m,q},x] && NeQ[e^2-4*d*f,0] &&  EqQ[c*g^2+a*h^2,0] && IntegerQ[p] *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_ Symbol] := Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /; FreeQ[{a,b,c,d,f,g,h,m,q},x] && NeQ[b^2-4*a*c,0] &&  EqQ[c*g^2-b*g*h+a*h^2,0] && IntegerQ[p] *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] := Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /; FreeQ[{a,c,d,f,g,h,m,q},x] && EqQ[c*g^2+a*h^2,0] && IntegerQ[p] *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^ q_,x_Symbol] := (a+b*x+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^ FracPart[p])*Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /; FreeQ[{a,b,c,d,e,f,g,h,m,q},x] && EqQ[c*g^2-b*g*h+a*h^2,0] &&  Not[IntegerQ[p]] *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+e_.*x_+f_.*x_^2)^q_,x_ Symbol] := (a+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^FracPart[p] )*Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+e*x+f*x^2)^q,x] /; FreeQ[{a,c,d,e,f,g,h,m,q},x] && NeQ[e^2-4*d*f,0] &&  EqQ[c*g^2+a*h^2,0] && Not[IntegerQ[p]] *)
(* Int[(g_+h_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_ Symbol] := (a+b*x+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^ FracPart[p])*Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /; FreeQ[{a,b,c,d,f,g,h,m,q},x] && NeQ[b^2-4*a*c,0] &&  EqQ[c*g^2-b*g*h+a*h^2,0] && Not[IntegerQ[p]] *)
(* Int[(g_+h_.*x_)^m_.*(a_+c_.*x_^2)^p_*(d_.+f_.*x_^2)^q_,x_Symbol] := (a+c*x^2)^FracPart[p]/((g+h*x)^FracPart[p]*(a/g+(c*x)/h)^FracPart[p] )*Int[(g+h*x)^(m+p)*(a/g+c/h*x)^p*(d+f*x^2)^q,x] /; FreeQ[{a,c,d,f,g,h,m,q},x] && EqQ[c*g^2+a*h^2,0] && Not[IntegerQ[p]] *)
Int[x_^p_*(a_. + b_.*x_ + c_.*x_^2)^p_*(e_.*x_ + f_.*x_^2)^q_, x_Symbol] := Int[(a/e + c/f*x)^p*(e*x + f*x^2)^(p + q), x] /; FreeQ[{a, b, c, e, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*e^2 - b*e*f + a*f^2, 0] && IntegerQ[p]
Int[x_^p_*(a_ + c_.*x_^2)^p_*(e_.*x_ + f_.*x_^2)^q_, x_Symbol] := Int[(a/e + c/f*x)^p*(e*x + f*x^2)^(p + q), x] /; FreeQ[{a, c, e, f, q}, x] && EqQ[c*e^2 + a*f^2, 0] && IntegerQ[p]
Int[(g_ + h_.*x_)/((a_ + c_.*x_^2)^(1/3)*(d_ + f_.*x_^2)), x_Symbol] := Sqrt[3]*h* ArcTan[1/Sqrt[3] - 2^(2/3)*(1 - 3*h*x/g)^(2/3)/(Sqrt[ 3]*(1 + 3*h*x/g)^(1/3))]/(2^(2/3)*a^(1/3)*f) + h*Log[d + f*x^2]/(2^(5/3)*a^(1/3)*f) - 3*h* Log[(1 - 3*h*x/g)^(2/3) + 2^(1/3)*(1 + 3*h*x/g)^(1/3)]/(2^(5/3)* a^(1/3)*f) /; FreeQ[{a, c, d, f, g, h}, x] && EqQ[c*d + 3*a*f, 0] && EqQ[c*g^2 + 9*a*h^2, 0] && GtQ[a, 0]
Int[(g_ + h_.*x_)/((a_ + c_.*x_^2)^(1/3)*(d_ + f_.*x_^2)), x_Symbol] := (1 + c*x^2/a)^(1/3)/(a + c*x^2)^(1/3)* Int[(g + h*x)/((1 + c*x^2/a)^(1/3)*(d + f*x^2)), x] /; FreeQ[{a, c, d, f, g, h}, x] && EqQ[c*d + 3*a*f, 0] && EqQ[c*g^2 + 9*a*h^2, 0] && Not[GtQ[a, 0]]
Int[(g_ + h_.*x_)*(a_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_, x_Symbol] := g*Int[(a + c*x^2)^p*(d + f*x^2)^q, x] + h*Int[x*(a + c*x^2)^p*(d + f*x^2)^q, x] /; FreeQ[{a, c, d, f, g, h, p, q}, x]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(g_. + h_.*x_), x_Symbol] := Int[ExpandIntegrand[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^ q*(g + h*x), x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && IGtQ[p, 0] && IntegerQ[q]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := Int[ExpandIntegrand[(a + c*x^2)^p*(d + e*x + f*x^2)^q*(g + h*x), x], x] /; FreeQ[{a, c, d, e, f, g, h}, x] && NeQ[e^2 - 4*d*f, 0] && IntegersQ[p, q] && (GtQ[p, 0] || GtQ[q, 0])
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(g_. + h_.*x_), x_Symbol] := (g*b - 2*a*h - (b*h - 2*g*c)*x)*(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q/((b^2 - 4*a*c)*(p + 1)) - 1/((b^2 - 4*a*c)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[e*q*(g*b - 2*a*h) - d*(b*h - 2*g*c)*(2*p + 3) + (2*f*q*(g*b - 2*a*h) - e*(b*h - 2*g*c)*(2*p + q + 3))* x - f*(b*h - 2*g*c)*(2*p + 2*q + 3)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := (a*h - g*c*x)*(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^ q/(2*a*c*(p + 1)) + 2/(4*a*c*(p + 1))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[g*c*d*(2*p + 3) - a*(h*e*q) + (g*c*e*(2*p + q + 3) - a*(2*h*f*q))*x + g*c*f*(2*p + 2*q + 3)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g, h}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := (g*b - 2*a*h - (b*h - 2*g*c)*x)*(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^ q/((b^2 - 4*a*c)*(p + 1)) - 1/((b^2 - 4*a*c)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q - 1)* Simp[-d*(b*h - 2*g*c)*(2*p + 3) + (2*f*q*(g*b - 2*a*h))*x - f*(b*h - 2*g*c)*(2*p + 2*q + 3)*x^2, x], x] /; FreeQ[{a, b, c, d, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[q, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(g_. + h_.*x_), x_Symbol] := (a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1))* (g* c*(2*a*c*e - b*(c*d + a*f)) + (g*b - a*h)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)) + c*(g*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)) - h*(b*c*d - 2*a*c*e + a*b*f))*x) + 1/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[(b*h - 2*g*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1) + (b^2*(g*f) - b*(h*c*d + g*c*e + a*h*f) + 2*(g*c*(c*d - a*f) - a*(-h*c*e)))*(a*f*(p + 1) - c*d*(p + 2)) - e*((g*c)*(2*a*c*e - b*(c*d + a*f)) + (g*b - a*h)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)))*(p + q + 2) - (2* f*((g*c)*(2*a*c*e - b*(c*d + a*f)) + (g*b - a*h)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)))*(p + q + 2) - (b^2*g*f - b*(h*c*d + g*c*e + a*h*f) + 2*(g*c*(c*d - a*f) - a*(-h*c*e)))* (b*f*(p + 1) - c*e*(2*p + q + 4)))*x - c*f*(b^2*(g*f) - b*(h*c*d + g*c*e + a*h*f) + 2*(g*c*(c*d - a*f) + a*h*c*e))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[(c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f), 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := (a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1))* (g*c*(2*a*c*e) + (-a*h)*(2*c^2*d - c*(2*a*f)) + c*(g*(2*c^2*d - c*(2*a*f)) - h*(-2*a*c*e))*x) + 1/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[(-2*g*c)*((c*d - a*f)^2 - (-a*e)*(c*e))*(p + 1) + (2*(g*c*(c*d - a*f) - a*(-h*c*e)))*(a*f*(p + 1) - c*d*(p + 2)) - e*((g*c)*(2*a*c*e) + (-a*h)*(2*c^2*d - c*(+2*a*f)))*(p + q + 2) - (2* f*((g*c)*(2*a*c*e) + (-a*h)*(2*c^2*d + -c*(+2*a*f)))*(p + q + 2) - (2*(g*c*(c*d - a*f) - a*(-h*c*e)))*(-c* e*(2*p + q + 4)))*x - c*f*(2*(g*c*(c*d - a*f) - a*(-h*c*e)))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, c, d, e, f, g, h, q}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[a*c*e^2 + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := (a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q + 1)/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1))* ((g*c)*(-b*(c*d + a*f)) + (g*b - a*h)*(2*c^2*d + b^2*f - c*(2*a*f)) + c*(g*(2*c^2*d + b^2*f - c*(2*a*f)) - h*(b*c*d + a*b*f))*x) + 1/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^q* Simp[(b*h - 2*g*c)*((c*d - a*f)^2 - (b*d)*(-b*f))*(p + 1) + (b^2*(g*f) - b*(h*c*d + a*h*f) + 2*(g*c*(c*d - a*f)))*(a*f*(p + 1) - c*d*(p + 2)) - (2* f*((g*c)*(-b*(c*d + a*f)) + (g*b - a*h)*(2*c^2*d + b^2*f - c*(2*a*f)))*(p + q + 2) - (b^2*(g*f) - b*(h*c*d + a*h*f) + 2*(g*c*(c*d - a*f)))* (b*f*(p + 1)))*x - c*f*(b^2*(g*f) - b*(h*c*d + a*h*f) + 2*(g*c*(c*d - a*f)))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, f, g, h, q}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && NeQ[b^2*d*f + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(g_. + h_.*x_), x_Symbol] := h*(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^(q + 1)/(2*f*(p + q + 1)) - (1/(2*f*(p + q + 1)))* Int[(a + b*x + c*x^2)^(p - 1)*(d + e*x + f*x^2)^q* Simp[h*p*(b*d - a*e) + a*(h*e - 2*g*f)*(p + q + 1) + (2*h*p*(c*d - a*f) + b*(h*e - 2*g*f)*(p + q + 1))*x + (h*p*(c*e - b*f) + c*(h*e - 2*g*f)*(p + q + 1))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := h*(a + c*x^2)^p*(d + e*x + f*x^2)^(q + 1)/(2*f*(p + q + 1)) + (1/(2*f*(p + q + 1)))* Int[(a + c*x^2)^(p - 1)*(d + e*x + f*x^2)^q* Simp[a*h*e*p - a*(h*e - 2*g*f)*(p + q + 1) - 2*h*p*(c*d - a*f)*x - (h*c*e*p + c*(h*e - 2*g*f)*(p + q + 1))* x^2, x], x] /; FreeQ[{a, c, d, e, f, g, h, q}, x] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := h*(a + b*x + c*x^2)^p*(d + f*x^2)^(q + 1)/(2*f*(p + q + 1)) - (1/(2*f*(p + q + 1)))* Int[(a + b*x + c*x^2)^(p - 1)*(d + f*x^2)^q* Simp[h*p*(b*d) + a*(-2*g*f)*(p + q + 1) + (2*h*p*(c*d - a*f) + b*(-2*g*f)*(p + q + 1))*x + (h*p*(-b*f) + c*(-2*g*f)*(p + q + 1))*x^2, x], x] /; FreeQ[{a, b, c, d, f, g, h, q}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0]
Int[(g_. + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)*(d_ + e_.*x_ + f_.*x_^2)), x_Symbol] := With[{q = Simplify[ c^2*d^2 - b*c*d*e + a*c*e^2 + b^2*d*f - 2*a*c*d*f - a*b*e*f + a^2*f^2]}, 1/q* Int[Simp[ g*c^2*d - g*b*c*e + a*h*c*e + g*b^2*f - a*b*h*f - a*g*c*f + c*(h*c*d - g*c*e + g*b*f - a*h*f)*x, x]/(a + b*x + c*x^2), x] + 1/q* Int[Simp[-h*c*d*e + g*c*e^2 + b*h*d*f - g*c*d*f - g*b*e*f + a*g*f^2 - f*(h*c*d - g*c*e + g*b*f - a*h*f)*x, x]/(d + e*x + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[(g_. + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)*(d_ + f_.*x_^2)), x_Symbol] := With[{q = Simplify[c^2*d^2 + b^2*d*f - 2*a*c*d*f + a^2*f^2]}, 1/q* Int[Simp[ g*c^2*d + g*b^2*f - a*b*h*f - a*g*c*f + c*(h*c*d + g*b*f - a*h*f)*x, x]/(a + b*x + c*x^2), x] + 1/q* Int[Simp[ b*h*d*f - g*c*d*f + a*g*f^2 - f*(h*c*d + g*b*f - a*h*f)*x, x]/(d + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(g_ + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := -2*g*Subst[Int[1/(b*d - a*e - b*x^2), x], x, Sqrt[d + e*x + f*x^2]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && EqQ[c*e - b*f, 0] && EqQ[h*e - 2*g*f, 0]
Int[(g_. + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := -(h*e - 2*g*f)/(2*f)* Int[1/((a + b*x + c*x^2)*Sqrt[d + e*x + f*x^2]), x] + h/(2*f)* Int[(e + 2*f*x)/((a + b*x + c*x^2)*Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && EqQ[c*e - b*f, 0] && NeQ[h*e - 2*g*f, 0]
Int[x_/((a_ + b_.*x_ + c_.*x_^2)*Sqrt[d_ + e_.*x_ + f_.*x_^2]), x_Symbol] := -2*e*Subst[ Int[(1 - d*x^2)/(c*e - b*f - e*(2*c*d - b*e + 2*a*f)*x^2 + d^2*(c*e - b*f)*x^4), x], x, (1 + (e + Sqrt[e^2 - 4*d*f])*x/(2*d))/Sqrt[d + e*x + f*x^2]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && EqQ[b*d - a*e, 0]
Int[(g_ + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_ + e_.*x_ + f_.*x_^2]), x_Symbol] := g*Subst[Int[1/(a + (c*d - a*f)*x^2), x], x, x/Sqrt[d + e*x + f*x^2]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && EqQ[b*d - a*e, 0] && EqQ[2*h*d - g*e, 0]
Int[(g_ + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_ + e_.*x_ + f_.*x_^2]), x_Symbol] := -(2*h*d - g*e)/e* Int[1/((a + b*x + c*x^2)*Sqrt[d + e*x + f*x^2]), x] + h/e* Int[(2*d + e*x)/((a + b*x + c*x^2)*Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && EqQ[b*d - a*e, 0] && NeQ[2*h*d - g*e, 0]
Int[(g_. + h_.*x_)/((a_. + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := -2*g*(g*b - 2*a*h)* Subst[ Int[1/Simp[g*(g*b - 2*a*h)*(b^2 - 4*a*c) - (b*d - a*e)*x^2, x], x], x, Simp[g*b - 2*a*h - (b*h - 2*g*c)*x, x]/ Sqrt[d + e*x + f*x^2]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && NeQ[b*d - a*e, 0] && EqQ[h^2*(b*d - a*e) - 2*g*h*(c*d - a*f) + g^2*(c*e - b*f), 0]
Int[(g_ + h_.*x_)/((a_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := -2*a*g*h* Subst[Int[1/Simp[2*a^2*g*h*c + a*e*x^2, x], x], x, Simp[a*h - g*c*x, x]/Sqrt[d + e*x + f*x^2]] /; FreeQ[{a, c, d, e, f, g, h}, x] && EqQ[a*h^2*e + 2*g*h*(c*d - a*f) - g^2*c*e, 0]
Int[(g_ + h_.*x_)/((a_. + b_.*x_ + c_.*x_^2)*Sqrt[d_ + f_.*x_^2]), x_Symbol] := -2*g*(g*b - 2*a*h)* Subst[Int[1/Simp[g*(g*b - 2*a*h)*(b^2 - 4*a*c) - b*d*x^2, x], x], x, Simp[g*b - 2*a*h - (b*h - 2*g*c)*x, x]/Sqrt[d + f*x^2]] /; FreeQ[{a, b, c, d, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[b*h^2*d - 2*g*h*(c*d - a*f) - g^2*b*f, 0]
Int[(g_. + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*c*g - h*(b - q))/q* Int[1/((b - q + 2*c*x)*Sqrt[d + e*x + f*x^2]), x] - (2*c*g - h*(b + q))/q* Int[1/((b + q + 2*c*x)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && PosQ[b^2 - 4*a*c]
Int[(g_. + h_.*x_)/((a_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[-a*c, 2]}, (h/2 + c*g/(2*q))*Int[1/((-q + c*x)*Sqrt[d + e*x + f*x^2]), x] + (h/2 - c*g/(2*q))*Int[1/((q + c*x)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, c, d, e, f, g, h}, x] && NeQ[e^2 - 4*d*f, 0] && PosQ[-a*c]
Int[(g_. + h_.*x_)/((a_ + b_.*x_ + c_.*x_^2)*Sqrt[d_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*c*g - h*(b - q))/q* Int[1/((b - q + 2*c*x)*Sqrt[d + f*x^2]), x] - (2*c*g - h*(b + q))/q* Int[1/((b + q + 2*c*x)*Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, c, d, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[b^2 - 4*a*c]
Int[(g_. + h_.*x_)/((a_. + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[(c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f), 2]}, 1/(2*q)* Int[Simp[ h*(b*d - a*e) - g*(c*d - a*f - q) - (g*(c*e - b*f) - h*(c*d - a*f + q))*x, x]/((a + b*x + c*x^2)*Sqrt[d + e*x + f*x^2]), x] - 1/(2*q)* Int[Simp[ h*(b*d - a*e) - g*(c*d - a*f + q) - (g*(c*e - b*f) - h*(c*d - a*f - q))*x, x]/((a + b*x + c*x^2)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && NeQ[b*d - a*e, 0] && NegQ[b^2 - 4*a*c]
Int[(g_. + h_.*x_)/((a_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[(c*d - a*f)^2 + a*c*e^2, 2]}, 1/(2*q)* Int[Simp[-a*h*e - g*(c*d - a*f - q) + (h*(c*d - a*f + q) - g*c*e)*x, x]/((a + c*x^2)*Sqrt[d + e*x + f*x^2]), x] - 1/(2*q)* Int[Simp[-a*h*e - g*(c*d - a*f + q) + (h*(c*d - a*f - q) - g*c*e)*x, x]/((a + c*x^2)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, c, d, e, f, g, h}, x] && NeQ[e^2 - 4*d*f, 0] && NegQ[-a*c]
Int[(g_. + h_.*x_)/((a_. + b_.*x_ + c_.*x_^2)*Sqrt[d_ + f_.*x_^2]), x_Symbol] := With[{q = Rt[(c*d - a*f)^2 + b^2*d*f, 2]}, 1/(2*q)* Int[Simp[ h*b*d - g*(c*d - a*f - q) + (h*(c*d - a*f + q) + g*b*f)*x, x]/((a + b*x + c*x^2)*Sqrt[d + f*x^2]), x] - 1/(2*q)* Int[Simp[ h*b*d - g*(c*d - a*f + q) + (h*(c*d - a*f - q) + g*b*f)*x, x]/((a + b*x + c*x^2)*Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, c, d, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[b^2 - 4*a*c]
Int[(g_. + h_.*x_)/(Sqrt[a_ + b_.*x_ + c_.*x_^2]* Sqrt[d_ + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{s = Rt[b^2 - 4*a*c, 2], t = Rt[e^2 - 4*d*f, 2]}, Sqrt[b + s + 2*c*x]*Sqrt[2*a + (b + s)*x]*Sqrt[e + t + 2*f*x]* Sqrt[2*d + (e + t)*x]/(Sqrt[a + b*x + c*x^2]* Sqrt[d + e*x + f*x^2])* Int[(g + h*x)/(Sqrt[b + s + 2*c*x]*Sqrt[2*a + (b + s)*x]* Sqrt[e + t + 2*f*x]*Sqrt[2*d + (e + t)*x]), x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[(g_. + h_.*x_)/(Sqrt[a_ + b_.*x_ + c_.*x_^2]*Sqrt[d_ + f_.*x_^2]), x_Symbol] := With[{s = Rt[b^2 - 4*a*c, 2], t = Rt[-4*d*f, 2]}, Sqrt[b + s + 2*c*x]*Sqrt[2*a + (b + s)*x]*Sqrt[t + 2*f*x]* Sqrt[2*d + t*x]/(Sqrt[a + b*x + c*x^2]*Sqrt[d + f*x^2])* Int[(g + h*x)/(Sqrt[b + s + 2*c*x]*Sqrt[2*a + (b + s)*x]* Sqrt[t + 2*f*x]*Sqrt[2*d + t*x]), x]] /; FreeQ[{a, b, c, d, f, g, h}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(g_. + h_.*x_)/((a_. + b_.*x_ + c_.*x_^2)^(1/3)*(d_. + e_.*x_ + f_.*x_^2)), x_Symbol] := With[{q = (-9*c*h^2/(2*c*g - b*h)^2)^(1/3)}, Sqrt[3]*h*q* ArcTan[1/Sqrt[3] - 2^(2/3)*(1 - (3*h*(b + 2*c*x))/(2*c*g - b*h))^(2/3)/(Sqrt[ 3]*(1 + (3*h*(b + 2*c*x))/(2*c*g - b*h))^(1/3))]/f + h*q*Log[d + e*x + f*x^2]/(2*f) - 3*h*q* Log[(1 - 3*h*(b + 2*c*x)/(2*c*g - b*h))^(2/3) + 2^(1/3)*(1 + 3*h*(b + 2*c*x)/(2*c*g - b*h))^(1/3)]/(2*f)] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[c*e - b*f, 0] && EqQ[c^2*d - f*(b^2 - 3*a*c), 0] && EqQ[c^2*g^2 - b*c*g*h - 2*b^2*h^2 + 9*a*c*h^2, 0] && GtQ[-9*c*h^2/(2*c*g - b*h)^2, 0]
Int[(g_. + h_.*x_)/((a_. + b_.*x_ + c_.*x_^2)^(1/3)*(d_. + e_.*x_ + f_.*x_^2)), x_Symbol] := With[{q = -c/(b^2 - 4*a*c)}, (q*(a + b*x + c*x^2))^(1/3)/(a + b*x + c*x^2)^(1/3)* Int[(g + h*x)/((q*a + b*q*x + c*q*x^2)^(1/3)*(d + e*x + f*x^2)), x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[c*e - b*f, 0] && EqQ[c^2*d - f*(b^2 - 3*a*c), 0] && EqQ[c^2*g^2 - b*c*g*h - 2*b^2*h^2 + 9*a*c*h^2, 0] && Not[GtQ[4*a - b^2/c, 0]]
Int[(a_. + b_.*x_ + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^ q_*(g_. + h_.*x_), x_Symbol] := Unintegrable[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^q*(g + h*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, p, q}, x]
Int[(a_. + c_.*x_^2)^p_*(d_. + e_.*x_ + f_.*x_^2)^q_*(g_. + h_.*x_), x_Symbol] := Unintegrable[(a + c*x^2)^p*(d + e*x + f*x^2)^q*(g + h*x), x] /; FreeQ[{a, c, d, e, f, g, h, p, q}, x]
Int[(g_. + h_.*u_)^m_.*(a_. + b_.*u_ + c_.*u_^2)^ p_.*(d_. + e_.*u_ + f_.*u_^2)^q_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(g + h*x)^m*(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^q, x], x, u] /; FreeQ[{a, b, c, d, e, f, g, h, m, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(g_. + h_.*u_)^m_.*(a_. + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^ q_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(g + h*x)^m*(a + c*x^2)^p*(d + e*x + f*x^2)^q, x], x, u] /; FreeQ[{a, c, d, e, f, g, h, m, p, q}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.6 P(x) (a+b x+c x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Pq_*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[Pq*(a+b*x+c*x^2)^p,x],x] /;
FreeQ[{a,b,c},x] && PolyQ[Pq,x] && IGtQ[p,-2]


(* ::Code:: *)
Int[Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[x*PolynomialQuotient[Pq,x,x]*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,p},x] && PolyQ[Pq,x] && EqQ[Coeff[Pq,x,0],0] && Not[MatchQ[Pq,x^m_.*u_. /; IntegerQ[m]]]


(* ::Code:: *)
Int[Pq_*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[Pq*(b+2*c*x)^(2*p),x] /;
FreeQ[{a,b,c,p},x] && PolyQ[Pq,x] && EqQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Q=PolynomialQuotient[Pq,a+b*x+c*x^2,x],
        f=Coeff[PolynomialRemainder[Pq,a+b*x+c*x^2,x],x,0],
        g=Coeff[PolynomialRemainder[Pq,a+b*x+c*x^2,x],x,1]},
  (b*f-2*a*g+(2*c*f-b*g)*x)*(a+b*x+c*x^2)^(p+1)/((p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(a+b*x+c*x^2)^(p+1)*ExpandToSum[(p+1)*(b^2-4*a*c)*Q-(2*p+3)*(2*c*f-b*g),x],x]] /;
FreeQ[{a,b,c},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && LtQ[p,-1]


(* ::Code:: *)
Int[Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],e=Coeff[Pq,x,Expon[Pq,x]]},
  e*x^(q-1)*(a+b*x+c*x^2)^(p+1)/(c*(q+2*p+1)) + 
  1/(c*(q+2*p+1)) \[Star] Int[(a+b*x+c*x^2)^p*
    ExpandToSum[c*(q+2*p+1)*Pq-a*e*(q-1)*x^(q-2)-b*e*(q+p)*x^(q-1)-c*e*(q+2*p+1)*x^q,x],x]] /;
FreeQ[{a,b,c,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && Not[LeQ[p,-1]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.7 (a+b x+c x^2)^p (d+e x+f x^2)^q (A+B x+C x^2).m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.7 (a+b x+c x^2)^p (d+e x+f x^2)^q (A+B x+C x^2) *)
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_ + e_.*x_ + f_.*x_^2)^ q_.*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (c/f)^p*Int[(d + e*x + f*x^2)^(p + q)*(A + B*x + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && (IntegerQ[p] || GtQ[c/f, 0]) && (Not[IntegerQ[q]] || LeafCount[d + e*x + f*x^2] <= LeafCount[a + b*x + c*x^2])
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_ + e_.*x_ + f_.*x_^2)^ q_.*(A_. + C_.*x_^2), x_Symbol] := (c/f)^p*Int[(d + e*x + f*x^2)^(p + q)*(A + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && (IntegerQ[p] || GtQ[c/f, 0]) && (Not[IntegerQ[q]] || LeafCount[d + e*x + f*x^2] <= LeafCount[a + b*x + c*x^2])
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_ + e_.*x_ + f_.*x_^2)^ q_.*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := a^IntPart[p]*(a + b*x + c*x^2)^ FracPart[p]/(d^IntPart[p]*(d + e*x + f*x^2)^FracPart[p])* Int[(d + e*x + f*x^2)^(p + q)*(A + B*x + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_ + e_.*x_ + f_.*x_^2)^ q_.*(A_. + C_.*x_^2), x_Symbol] := a^IntPart[p]*(a + b*x + c*x^2)^ FracPart[p]/(d^IntPart[p]*(d + e*x + f*x^2)^FracPart[p])* Int[(d + e*x + f*x^2)^(p + q)*(A + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, p, q}, x] && EqQ[c*d - a*f, 0] && EqQ[b*d - a*e, 0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_. + e_.*x_ + f_.*x_^2)^ q_.*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(b + 2*c*x)^(2*p)*(d + e*x + f*x^2)^q*(A + B*x + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, p, q}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_. + e_.*x_ + f_.*x_^2)^ q_.*(A_. + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(b + 2*c*x)^(2*p)*(d + e*x + f*x^2)^q*(A + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, p, q}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_. + f_.*x_^2)^ q_.*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(b + 2*c*x)^(2*p)*(d + f*x^2)^q*(A + B*x + C*x^2), x] /; FreeQ[{a, b, c, d, f, A, B, C, p, q}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_.*(d_. + f_.*x_^2)^ q_.*(A_. + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(b + 2*c*x)^(2*p)*(d + f*x^2)^q*(A + C*x^2), x] /; FreeQ[{a, b, c, d, f, A, C, p, q}, x] && EqQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (A*b*c - 2*a*B*c + a*b*C - (c*(b*B - 2*A*c) - C*(b^2 - 2*a*c))*x)*(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^ q/(c*(b^2 - 4*a*c)*(p + 1)) - 1/(c*(b^2 - 4*a*c)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[e*q*(A*b*c - 2*a*B*c + a*b*C) - d*(c*(b*B - 2*A*c)*(2*p + 3) + C*(2*a*c - b^2*(p + 2))) + (2*f*q*(A*b*c - 2*a*B*c + a*b*C) - e*(c*(b*B - 2*A*c)*(2*p + q + 3) + C*(2*a*c*(q + 1) - b^2*(p + q + 2))))*x - f*(c*(b*B - 2*A*c)*(2*p + 2*q + 3) + C*(2*a*c*(2*q + 1) - b^2*(p + 2*q + 2)))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + C_.*x_^2), x_Symbol] := (A*b*c + a*b*C + (2*A*c^2 + C*(b^2 - 2*a*c))*x)*(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q/(c*(b^2 - 4*a*c)*(p + 1)) - 1/(c*(b^2 - 4*a*c)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[A*c*(2*c*d*(2*p + 3) + b*e*q) - C*(2*a*c*d - b^2*d*(p + 2) - a*b*e*q) + (C*(2*a*b*f*q - 2*a*c*e*(q + 1) + b^2*e*(p + q + 2)) + 2*A*c*(b*f*q + c*e*(2*p + q + 3)))* x - f*(-2*A*c^2*(2*p + 2*q + 3) + C*(2*a*c*(2*q + 1) - b^2*(p + 2*q + 2)))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (a*B - (A*c - a*C)*x)*(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^ q/(2*a*c*(p + 1)) - 2/((-4*a*c)*(p + 1))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[A*c*d*(2*p + 3) - a*(C*d + B*e*q) + (A*c*e*(2*p + q + 3) - a*(2*B*f*q + C*e*(q + 1)))*x - f*(a*C*(2*q + 1) - A*c*(2*p + 2*q + 3))*x^2, x], x] /; FreeQ[{a, c, d, e, f, A, B, C}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(A_. + C_.*x_^2), x_Symbol] := -(A*c - a*C)* x*(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q/(2*a*c*(p + 1)) + 2/(4*a*c*(p + 1))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q - 1)* Simp[A*c*d*(2*p + 3) - a*C*d + (A*c*e*(2*p + q + 3) - a*C*e*(q + 1))*x - f*(a*C*(2*q + 1) - A*c*(2*p + 2*q + 3))*x^2, x], x] /; FreeQ[{a, c, d, e, f, A, C}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (A*b*c - 2*a*B*c + a*b*C - (c*(b*B - 2*A*c) - C*(b^2 - 2*a*c))*x)*(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^q/(c*(b^2 - 4*a*c)*(p + 1)) - 1/(c*(b^2 - 4*a*c)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q - 1)* Simp[-d*(c*(b*B - 2*A*c)*(2*p + 3) + C*(2*a*c - b^2*(p + 2))) + (2*f*q*(A*b*c - 2*a*B*c + a*b*C))*x - f*(c*(b*B - 2*A*c)*(2*p + 2*q + 3) + C*(2*a*c*(2*q + 1) - b^2*(p + 2*q + 2)))*x^2, x], x] /; FreeQ[{a, b, c, d, f, A, B, C}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_*(A_. + C_.*x_^2), x_Symbol] := (A*b*c + a*b*C + (2*A*c^2 + C*(b^2 - 2*a*c))*x)*(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^q/(c*(b^2 - 4*a*c)*(p + 1)) - 1/(c*(b^2 - 4*a*c)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q - 1)* Simp[A*c*(2*c*d*(2*p + 3)) - C*(2*a*c*d - b^2*d*(p + 2)) + (C*(2*a*b*f*q) + 2*A*c*(b*f*q))*x - f*(-2*A*c^2*(2*p + 2*q + 3) + C*(2*a*c*(2*q + 1) - b^2*(p + 2*q + 2)))*x^2, x], x] /; FreeQ[{a, b, c, d, f, A, C}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[q, 0] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1))* ((A*c - a*C)*(2*a*c*e - b*(c*d + a*f)) + (A*b - a*B)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)) + c*(A*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)) - B*(b*c*d - 2*a*c*e + a*b*f) + C*(b^2*d - a*b*e - 2*a*(c*d - a*f)))*x) + 1/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[(b*B - 2*A*c - 2*a*C)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1) + (b^2*(C*d + A*f) - b*(B*c*d + A*c*e + a*C*e + a*B*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - B*c*e - a*C*f)))*(a* f*(p + 1) - c*d*(p + 2)) - e*((A*c - a*C)*(2*a*c*e - b*(c*d + a*f)) + (A*b - a*B)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)))*(p + q + 2) - (2* f*((A*c - a*C)*(2*a*c*e - b*(c*d + a*f)) + (A*b - a*B)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)))*(p + q + 2) - (b^2*(C*d + A*f) - b*(B*c*d + A*c*e + a*C*e + a*B*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - B*c*e - a*C*f)))* (b*f*(p + 1) - c*e*(2*p + q + 4)))*x - c*f*(b^2*(C*d + A*f) - b*(B*c*d + A*c*e + a*C*e + a*B*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - B*c*e - a*C*f)))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[(c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f), 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1))* ((A*c - a*C)*(2*a*c*e - b*(c*d + a*f)) + (A*b)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)) + c*(A*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)) + C*(b^2*d - a*b*e - 2*a*(c*d - a*f)))*x) + 1/((b^2 - 4*a*c)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[(-2*A*c - 2*a*C)*((c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f))*(p + 1) + (b^2*(C*d + A*f) - b*(+A*c*e + a*C*e) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(a*f*(p + 1) - c*d*(p + 2)) - e*((A*c - a*C)*(2*a*c*e - b*(c*d + a*f)) + (A*b)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)))*(p + q + 2) - (2* f*((A*c - a*C)*(2*a*c*e - b*(c*d + a*f)) + (A* b)*(2*c^2*d + b^2*f - c*(b*e + 2*a*f)))*(p + q + 2) - (b^2*(C*d + A*f) - b*(A*c*e + a*C*e) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))* (b*f*(p + 1) - c*e*(2*p + q + 4)))*x - c*f*(b^2*(C*d + A*f) - b*(A*c*e + a*C*e) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(2*p + 2*q + 5)* x^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[(c*d - a*f)^2 - (b*d - a*e)*(c*e - b*f), 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1))* ((A*c - a*C)*(2*a*c*e) + (-a*B)*(2*c^2*d - c*(2*a*f)) + c*(A*(2*c^2*d - c*(2*a*f)) - B*(-2*a*c*e) + C*(-2*a*(c*d - a*f)))*x) + 1/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[(-2*A*c - 2*a*C)*((c*d - a*f)^2 - (-a*e)*(c*e))*(p + 1) + (2*(A*c*(c*d - a*f) - a*(c*C*d - B*c*e - a*C*f)))*(a* f*(p + 1) - c*d*(p + 2)) - e*((A*c - a*C)*(2*a*c*e) + (-a*B)*(2*c^2*d - c*(+2*a*f)))*(p + q + 2) - (2* f*((A*c - a*C)*(2*a*c*e) + (-a* B)*(2*c^2*d + -c*(+2*a*f)))*(p + q + 2) - (2*(A*c*(c*d - a*f) - a*(c*C*d - B*c*e - a*C*f)))* (-c*e*(2*p + q + 4)))*x - c*f*(2*(A*c*(c*d - a*f) - a*(c*C*d - B*c*e - a*C*f)))*(2*p + 2*q + 5)*x^2, x], x] /; FreeQ[{a, c, d, e, f, A, B, C, q}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[a*c*e^2 + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(A_. + C_.*x_^2), x_Symbol] := (a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^(q + 1)/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1))* ((A*c - a*C)*(2*a*c*e) + c*(A*(2*c^2*d - c*(2*a*f)) + C*(-2*a*(c*d - a*f)))*x) + 1/((-4*a*c)*(a*c*e^2 + (c*d - a*f)^2)*(p + 1))* Int[(a + c*x^2)^(p + 1)*(d + e*x + f*x^2)^q* Simp[(-2*A*c - 2*a*C)*((c*d - a*f)^2 - (-a*e)*(c*e))*(p + 1) + (2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(a* f*(p + 1) - c*d*(p + 2)) - e*((A*c - a*C)*(2*a*c*e))*(p + q + 2) - (2* f*((A*c - a*C)*(2*a*c*e))*(p + q + 2) - (2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(-c* e*(2*p + q + 4)))*x - c*f*(2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(2*p + 2*q + 5)* x^2, x], x] /; FreeQ[{a, c, d, e, f, A, C, q}, x] && NeQ[e^2 - 4*d*f, 0] && LtQ[p, -1] && NeQ[a*c*e^2 + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q + 1)/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1))* ((A*c - a*C)*(-b*(c*d + a*f)) + (A*b - a*B)*(2*c^2*d + b^2*f - c*(2*a*f)) + c*(A*(2*c^2*d + b^2*f - c*(2*a*f)) - B*(b*c*d + a*b*f) + C*(b^2*d - 2*a*(c*d - a*f)))*x) + 1/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^q* Simp[(b*B - 2*A*c - 2*a*C)*((c*d - a*f)^2 - (b*d)*(-b*f))*(p + 1) + (b^2*(C*d + A*f) - b*(B*c*d + a*B*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(a*f*(p + 1) - c*d*(p + 2)) - (2* f*((A*c - a*C)*(-b*(c*d + a*f)) + (A*b - a*B)*(2*c^2*d + b^2*f - c*(2*a*f)))*(p + q + 2) - (b^2*(C*d + A*f) - b*(B*c*d + a*B*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))* (b*f*(p + 1)))*x - c*f*(b^2*(C*d + A*f) - b*(B*c*d + a*B*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(2*p + 2*q + 5)* x^2, x], x] /; FreeQ[{a, b, c, d, f, A, B, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && NeQ[b^2*d*f + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_*(A_. + C_.*x_^2), x_Symbol] := (a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^(q + 1)/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1))* ((A*c - a*C)*(-b*(c*d + a*f)) + (A*b)*(2*c^2*d + b^2*f - c*(2*a*f)) + c*(A*(2*c^2*d + b^2*f - c*(2*a*f)) + C*(b^2*d - 2*a*(c*d - a*f)))*x) + 1/((b^2 - 4*a*c)*(b^2*d*f + (c*d - a*f)^2)*(p + 1))* Int[(a + b*x + c*x^2)^(p + 1)*(d + f*x^2)^q* Simp[(-2*A*c - 2*a*C)*((c*d - a*f)^2 - (b*d)*(-b*f))*(p + 1) + (b^2*(C*d + A*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(a*f*(p + 1) - c*d*(p + 2)) - (2* f*((A*c - a*C)*(-b*(c*d + a*f)) + (A*b)*(2*c^2*d + b^2*f - c*(2*a*f)))*(p + q + 2) - (b^2*(C*d + A*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))* (b*f*(p + 1)))*x - c*f*(b^2*(C*d + A*f) + 2*(A*c*(c*d - a*f) - a*(c*C*d - a*C*f)))*(2*p + 2*q + 5)* x^2, x], x] /; FreeQ[{a, b, c, d, f, A, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && NeQ[b^2*d*f + (c*d - a*f)^2, 0] && Not[Not[IntegerQ[p]] && ILtQ[q, -1]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (B*c*f*(2*p + 2*q + 3) + C*(b*f*p - c*e*(2*p + q + 2)) + 2*c*C*f*(p + q + 1)*x)*(a + b*x + c*x^2)^p* (d + e*x + f*x^2)^(q + 1)/(2*c* f^2*(p + q + 1)*(2*p + 2*q + 3)) - (1/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)))* Int[(a + b*x + c*x^2)^(p - 1)*(d + e*x + f*x^2)^q* Simp[p*(b*d - a*e)*(C*(c*e - b*f)*(q + 1) - c*(C*e - B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(b^2*C*d*f*p + a*c*(C*(2*d*f - e^2*(2*p + q + 2)) + f*(B*e - 2*A*f)*(2*p + 2*q + 3))) + (2* p*(c*d - a*f)*(C*(c*e - b*f)*(q + 1) - c*(C*e - B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(C*e*f*p*(b^2 - 4*a*c) - b*c*(C*(e^2 - 4*d*f)*(2*p + q + 2) + f*(2*C*d - B*e + 2*A*f)*(2*p + 2*q + 3))))*x + (p*(c*e - b*f)*(C*(c*e - b*f)*(q + 1) - c*(C*e - B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(C*f^2*p*(b^2 - 4*a*c) - c^2*(C*(e^2 - 4*d*f)*(2*p + q + 2) + f*(2*C*d - B*e + 2*A*f)*(2*p + 2*q + 3))))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0] && NeQ[2*p + 2*q + 3, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + C_.*x_^2), x_Symbol] := (C*(b*f*p - c*e*(2*p + q + 2)) + 2*c*C*f*(p + q + 1)*x)*(a + b*x + c*x^2)^p* (d + e*x + f*x^2)^(q + 1)/(2*c* f^2*(p + q + 1)*(2*p + 2*q + 3)) - (1/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)))* Int[(a + b*x + c*x^2)^(p - 1)*(d + e*x + f*x^2)^q* Simp[p*(b*d - a*e)*(C*(c*e - b*f)*(q + 1) - c*(C*e)*(2*p + 2*q + 3)) + (p + q + 1)*(b^2*C*d*f*p + a*c*(C*(2*d*f - e^2*(2*p + q + 2)) + f*(-2*A*f)*(2*p + 2*q + 3))) + (2* p*(c*d - a*f)*(C*(c*e - b*f)*(q + 1) - c*(C*e)*(2*p + 2*q + 3)) + (p + q + 1)*(C*e*f*p*(b^2 - 4*a*c) - b*c*(C*(e^2 - 4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x + (p*(c*e - b*f)*(C*(c*e - b*f)*(q + 1) - c*(C*e)*(2*p + 2*q + 3)) + (p + q + 1)*(C*f^2*p*(b^2 - 4*a*c) - c^2*(C*(e^2 - 4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0] && NeQ[2*p + 2*q + 3, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (B*c*f*(2*p + 2*q + 3) + C*(-c*e*(2*p + q + 2)) + 2*c*C*f*(p + q + 1)*x)*(a + c*x^2)^p* (d + e*x + f*x^2)^(q + 1)/(2*c* f^2*(p + q + 1)*(2*p + 2*q + 3)) - (1/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)))* Int[(a + c*x^2)^(p - 1)*(d + e*x + f*x^2)^q* Simp[p*(-a*e)*(C*(c*e)*(q + 1) - c*(C*e - B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(a* c*(C*(2*d*f - e^2*(2*p + q + 2)) + f*(B*e - 2*A*f)*(2*p + 2*q + 3))) + (2* p*(c*d - a*f)*(C*(c*e)*(q + 1) - c*(C*e - B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(C*e*f*p*(-4*a*c)))*x + (p*(c*e)*(C*(c*e)*(q + 1) - c*(C*e - B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(C*f^2*p*(-4*a*c) - c^2*(C*(e^2 - 4*d*f)*(2*p + q + 2) + f*(2*C*d - B*e + 2*A*f)*(2*p + 2*q + 3))))*x^2, x], x] /; FreeQ[{a, c, d, e, f, A, B, C, q}, x] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0] && NeQ[2*p + 2*q + 3, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_ + c_.*x_^2)^p_*(d_ + e_.*x_ + f_.*x_^2)^q_*(A_. + C_.*x_^2), x_Symbol] := (C*(-c*e*(2*p + q + 2)) + 2*c*C*f*(p + q + 1)*x)*(a + c*x^2)^ p*(d + e*x + f*x^2)^(q + 1)/(2*c* f^2*(p + q + 1)*(2*p + 2*q + 3)) - (1/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)))* Int[(a + c*x^2)^(p - 1)*(d + e*x + f*x^2)^q* Simp[p*(-a*e)*(C*(c*e)*(q + 1) - c*(C*e)*(2*p + 2*q + 3)) + (p + q + 1)*(a* c*(C*(2*d*f - e^2*(2*p + q + 2)) + f*(-2*A*f)*(2*p + 2*q + 3))) + (2* p*(c*d - a*f)*(C*(c*e)*(q + 1) - c*(C*e)*(2*p + 2*q + 3)) + (p + q + 1)*(C*e*f* p*(-4*a*c)))*x + (p*(c*e)*(C*(c*e)*(q + 1) - c*(C*e)*(2*p + 2*q + 3)) + (p + q + 1)*(C*f^2*p*(-4*a*c) - c^2*(C*(e^2 - 4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x^2, x], x] /; FreeQ[{a, c, d, e, f, A, C, q}, x] && NeQ[e^2 - 4*d*f, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0] && NeQ[2*p + 2*q + 3, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^ q_*(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := (B*c*f*(2*p + 2*q + 3) + C*(b*f*p) + 2*c*C*f*(p + q + 1)*x)*(a + b*x + c*x^2)^p* (d + f*x^2)^(q + 1)/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)) - (1/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)))* Int[(a + b*x + c*x^2)^(p - 1)*(d + f*x^2)^q* Simp[p*(b*d)*(C*(-b*f)*(q + 1) - c*(-B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(b^2*C*d*f*p + a*c*(C*(2*d*f) + f*(-2*A*f)*(2*p + 2*q + 3))) + (2* p*(c*d - a*f)*(C*(-b*f)*(q + 1) - c*(-B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(-b* c*(C*(-4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x + (p*(-b*f)*(C*(-b*f)*(q + 1) - c*(-B*f)*(2*p + 2*q + 3)) + (p + q + 1)*(C*f^2*p*(b^2 - 4*a*c) - c^2*(C*(-4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x^2, x], x] /; FreeQ[{a, b, c, d, f, A, B, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0] && NeQ[2*p + 2*q + 3, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(a_ + b_.*x_ + c_.*x_^2)^p_*(d_ + f_.*x_^2)^q_*(A_. + C_.*x_^2), x_Symbol] := (C*(b*f*p) + 2*c*C*f*(p + q + 1)*x)*(a + b*x + c*x^2)^p* (d + f*x^2)^(q + 1)/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)) - (1/(2*c*f^2*(p + q + 1)*(2*p + 2*q + 3)))* Int[(a + b*x + c*x^2)^(p - 1)*(d + f*x^2)^q* Simp[p*(b*d)*(C*(-b*f)*(q + 1)) + (p + q + 1)*(b^2*C*d*f*p + a*c*(C*(2*d*f) + f*(-2*A*f)*(2*p + 2*q + 3))) + (2*p*(c*d - a*f)*(C*(-b*f)*(q + 1)) + (p + q + 1)*(-b* c*(C*(-4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x + (p*(-b*f)*(C*(-b*f)*(q + 1)) + (p + q + 1)*(C*f^2*p*(b^2 - 4*a*c) - c^2*(C*(-4*d*f)*(2*p + q + 2) + f*(2*C*d + 2*A*f)*(2*p + 2*q + 3))))*x^2, x], x] /; FreeQ[{a, b, c, d, f, A, C, q}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[p + q + 1, 0] && NeQ[2*p + 2*q + 3, 0] && Not[IGtQ[p, 0]] && Not[IGtQ[q, 0]]
Int[(A_. + B_.*x_ + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)*(d_ + e_.*x_ + f_.*x_^2)), x_Symbol] := With[{q = c^2*d^2 - b*c*d*e + a*c*e^2 + b^2*d*f - 2*a*c*d*f - a*b*e*f + a^2*f^2}, 1/q* Int[(A*c^2*d - a*c*C*d - A*b*c*e + a*B*c*e + A*b^2*f - a*b*B*f - a*A*c*f + a^2*C*f + c*(B*c*d - b*C*d - A*c*e + a*C*e + A*b*f - a*B*f)*x)/(a + b*x + c*x^2), x] + 1/q* Int[(c*C*d^2 - B*c*d*e + A*c*e^2 + b*B*d*f - A*c*d*f - a*C*d*f - A*b*e*f + a*A*f^2 - f*(B*c*d - b*C*d - A*c*e + a*C*e + A*b*f - a*B*f)*x)/(d + e*x + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[(A_. + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)*(d_ + e_.*x_ + f_.*x_^2)), x_Symbol] := With[{q = c^2*d^2 - b*c*d*e + a*c*e^2 + b^2*d*f - 2*a*c*d*f - a*b*e*f + a^2*f^2}, 1/q* Int[(A*c^2*d - a*c*C*d - A*b*c*e + A*b^2*f - a*A*c*f + a^2*C*f + c*(-b*C*d - A*c*e + a*C*e + A*b*f)*x)/(a + b*x + c*x^2), x] + 1/q* Int[(c*C*d^2 + A*c*e^2 - A*c*d*f - a*C*d*f - A*b*e*f + a*A*f^2 - f*(-b*C*d - A*c*e + a*C*e + A*b*f)*x)/(d + e*x + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)*(d_ + f_.*x_^2)), x_Symbol] := With[{q = c^2*d^2 + b^2*d*f - 2*a*c*d*f + a^2*f^2}, 1/q* Int[(A*c^2*d - a*c*C*d + A*b^2*f - a*b*B*f - a*A*c*f + a^2*C*f + c*(B*c*d - b*C*d + A*b*f - a*B*f)*x)/(a + b*x + c*x^2), x] + 1/q* Int[(c*C*d^2 + b*B*d*f - A*c*d*f - a*C*d*f + a*A*f^2 - f*(B*c*d - b*C*d + A*b*f - a*B*f)*x)/(d + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, f, A, B, C}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_. + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)*(d_ + f_.*x_^2)), x_Symbol] := With[{q = c^2*d^2 + b^2*d*f - 2*a*c*d*f + a^2*f^2}, 1/q* Int[(A*c^2*d - a*c*C*d + A*b^2*f - a*A*c*f + a^2*C*f + c*(-b*C*d + A*b*f)*x)/(a + b*x + c*x^2), x] + 1/q* Int[(c*C*d^2 - A*c*d*f - a*C*d*f + a*A*f^2 - f*(-b*C*d + A*b*f)*x)/(d + f*x^2), x] /; NeQ[q, 0]] /; FreeQ[{a, b, c, d, f, A, C}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := C/c*Int[1/Sqrt[d + e*x + f*x^2], x] + 1/c* Int[(A*c - a*C + (B*c - b*C)*x)/((a + b*x + c*x^2)* Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[(A_. + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := C/c*Int[1/Sqrt[d + e*x + f*x^2], x] + 1/c*Int[(A*c - a*C - b*C*x)/((a + b*x + c*x^2)* Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[e^2 - 4*d*f, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)/((a_ + c_.*x_^2)* Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := C/c*Int[1/Sqrt[d + e*x + f*x^2], x] + 1/c*Int[(A*c - a*C + B*c*x)/((a + c*x^2)*Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, c, d, e, f, A, B, C}, x] && NeQ[e^2 - 4*d*f, 0]
Int[(A_. + C_.*x_^2)/((a_ + c_.*x_^2)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := C/c*Int[1/Sqrt[d + e*x + f*x^2], x] + (A*c - a*C)/c* Int[1/((a + c*x^2)*Sqrt[d + e*x + f*x^2]), x] /; FreeQ[{a, c, d, e, f, A, C}, x] && NeQ[e^2 - 4*d*f, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)* Sqrt[d_. + f_.*x_^2]), x_Symbol] := C/c*Int[1/Sqrt[d + f*x^2], x] + 1/c*Int[(A*c - a*C + (B*c - b*C)*x)/((a + b*x + c*x^2)* Sqrt[d + f*x^2]), x] /; FreeQ[{a, b, c, d, f, A, B, C}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_. + C_.*x_^2)/((a_ + b_.*x_ + c_.*x_^2)*Sqrt[d_. + f_.*x_^2]), x_Symbol] := C/c*Int[1/Sqrt[d + f*x^2], x] + 1/c*Int[(A*c - a*C - b*C*x)/((a + b*x + c*x^2)*Sqrt[d + f*x^2]), x] /; FreeQ[{a, b, c, d, f, A, C}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(a_. + b_.*u_ + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^ q_.*(A_. + B_.*u_ + C_.*u_^2), x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^ q*(A + B*x + C*x^2), x], x, u] /; FreeQ[{a, b, c, d, e, f, A, B, C, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*u_ + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^ q_.*(A_. + B_.*u_), x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^q*(A + B*x), x], x, u] /; FreeQ[{a, b, c, d, e, f, A, B, C, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*u_ + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^ q_.*(A_. + C_.*u_^2), x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x + c*x^2)^p*(d + e*x + f*x^2)^q*(A + C*x^2), x], x, u] /; FreeQ[{a, b, c, d, e, f, A, C, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^ q_.*(A_. + B_.*u_ + C_.*u_^2), x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + c*x^2)^p*(d + e*x + f*x^2)^q*(A + B*x + C*x^2), x], x, u] /; FreeQ[{a, c, d, e, f, A, B, C, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^q_.*(A_. + B_.*u_), x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + c*x^2)^p*(d + e*x + f*x^2)^q*(A + B*x), x], x, u] /; FreeQ[{a, c, d, e, f, A, B, C, p, q}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + c_.*u_^2)^p_.*(d_. + e_.*u_ + f_.*u_^2)^ q_.*(A_. + C_.*u_^2), x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + c*x^2)^p*(d + e*x + f*x^2)^q*(A + C*x^2), x], x, u] /; FreeQ[{a, c, d, e, f, A, C, p, q}, x] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.7 P(x) (d+e x)^m (a+b x+c x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[(d+e*x)^(m+1)*PolynomialQuotient[Pq,d+e*x,x]*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[PolynomialRemainder[Pq,d+e*x,x],0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[(d+e*x)^(m+1)*PolynomialQuotient[Pq,d+e*x,x]*(a+c*x^2)^p,x] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[PolynomialRemainder[Pq,d+e*x,x],0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*P2_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{f=Coeff[P2,x,0],g=Coeff[P2,x,1],h=Coeff[P2,x,2]},
  h*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)/(c*e*(m+2*p+3)) /;
 EqQ[b*e*h*(m+p+2)+2*c*d*h*(p+1)-c*e*g*(m+2*p+3),0] && EqQ[b*d*h*(p+1)+a*e*h*(m+1)-c*e*f*(m+2*p+3),0]] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[P2,x,2] && NeQ[m+2*p+3,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*P2_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{f=Coeff[P2,x,0],g=Coeff[P2,x,1],h=Coeff[P2,x,2]},
  h*(d+e*x)^(m+1)*(a+c*x^2)^(p+1)/(c*e*(m+2*p+3)) /;
 EqQ[2*d*h*(p+1)-e*g*(m+2*p+3),0] && EqQ[a*h*(m+1)-c*f*(m+2*p+3),0]] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[P2,x,2] && NeQ[m+2*p+3,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*Pq*(a+b*x+c*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && PolyQ[Pq,x] && IGtQ[p,-2]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(d+e*x)^m*Pq*(a+c*x^2)^p,x],x] /;
FreeQ[{a,c,d,e,m},x] && PolyQ[Pq,x] && IGtQ[p,-2]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(d+e*x)^m*Pq*(b+2*c*x)^(2*p),x] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[b^2-4*a*c,0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*Pq_*(b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  e \[Star] Int[(e*x)^(m-1)*PolynomialQuotient[Pq,b+c*x,x]*(b*x+c*x^2)^(p+1),x] /;
FreeQ[{b,c,e,m,p},x] && PolyQ[Pq,x] && EqQ[PolynomialRemainder[Pq,b+c*x,x],0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  d*e \[Star] Int[(d+e*x)^(m-1)*PolynomialQuotient[Pq,a*e+c*d*x,x]*(a+b*x+c*x^2)^(p+1),x] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[PolynomialRemainder[Pq,a*e+c*d*x,x],0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  d*e \[Star] Int[(d+e*x)^(m-1)*PolynomialQuotient[Pq,a*e+c*d*x,x]*(a+c*x^2)^(p+1),x] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[c*d^2+a*e^2,0] && EqQ[PolynomialRemainder[Pq,a*e+c*d*x,x],0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a*e+c*d*x,x], R=PolynomialRemainder[Pq,a*e+c*d*x,x]},
  R*(2*c*d-b*e)*(d+e*x)^m*(a+b*x+c*x^2)^(p+1)/(e*(p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[d*e*(p+1)*(b^2-4*a*c)*Qx-R*(2*c*d-b*e)*(m+2*p+2),x],x]] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && EqQ[c*d^2-b*d*e+a*e^2,0] && ILtQ[p+1/2,0] && GtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a*e+c*d*x,x], R=PolynomialRemainder[Pq,a*e+c*d*x,x]},
  -d*R*(d+e*x)^m*(a+c*x^2)^(p+1)/(2*a*e*(p+1)) + 
  d/(2*a*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1)*ExpandToSum[2*a*e*(p+1)*Qx+R*(m+2*p+2),x],x]] /;
FreeQ[{a,c,d,e},x] && PolyQ[Pq,x] && EqQ[c*d^2+a*e^2,0] && ILtQ[p+1/2,0] && GtQ[m,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+b*x+c*x^2)^p,(d+e*x)^m*Pq,x],x] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && EqQ[c*d^2-b*d*e+a*e^2,0] && EqQ[m+Expon[Pq,x]+2*p+1,0] && ILtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  Int[ExpandIntegrand[(a+c*x^2)^p,(d+e*x)^m*Pq,x],x] /;
FreeQ[{a,c,d,e},x] && PolyQ[Pq,x] && EqQ[c*d^2+a*e^2,0] && EqQ[m+Expon[Pq,x]+2*p+1,0] && ILtQ[m,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(d+e*x)^(m+q-1)*(a+b*x+c*x^2)^(p+1)/(c*e^(q-1)*(m+q+2*p+1)) + 
  1/(c*e^q*(m+q+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p*
    ExpandToSum[c*e^q*(m+q+2*p+1)*Pq-c*f*(m+q+2*p+1)*(d+e*x)^q+e*f*(m+p+q)*(d+e*x)^(q-2)*(b*d-2*a*e+(2*c*d-b*e)*x),x],x] /;
 NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && EqQ[c*d^2-b*d*e+a*e^2,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(d+e*x)^(m+q-1)*(a+c*x^2)^(p+1)/(c*e^(q-1)*(m+q+2*p+1)) + 
  1/(c*e^q*(m+q+2*p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^p*
    ExpandToSum[c*e^q*(m+q+2*p+1)*Pq-c*f*(m+q+2*p+1)*(d+e*x)^q-2*e*f*(m+p+q)*(d+e*x)^(q-2)*(a*e-c*d*x),x],x] /;
 NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[c*d^2+a*e^2,0] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[(d+e*x)^(m+p)*(a/d+c/e*x)^p*Pq,x] /;
FreeQ[{a,b,c,d,e,m},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && EqQ[c*d^2-b*d*e+a*e^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[(d+e*x)^(m+p)*(a/d+c/e*x)^p*Pq,x] /;
FreeQ[{a,c,d,e,m},x] && PolyQ[Pq,x] && EqQ[c*d^2+a*e^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((d+e*x)^FracPart[p]*(a/d+(c*x)/e)^FracPart[p]) \[Star] Int[(d+e*x)^(m+p)*(a/d+c/e*x)^p*Pq,x] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && EqQ[c*d^2-b*d*e+a*e^2,0] && Not[IntegerQ[p]] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  (a+c*x^2)^FracPart[p]/((d+e*x)^FracPart[p]*(a/d+(c*x)/e)^FracPart[p]) \[Star] Int[(d+e*x)^(m+p)*(a/d+c/e*x)^p*Pq,x] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[Pq,x] && EqQ[c*d^2+a*e^2,0] && Not[IntegerQ[p]] && Not[IGtQ[m,0]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a+b*x+c*x^2,x],
        R=Coeff[PolynomialRemainder[Pq,a+b*x+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[Pq,a+b*x+c*x^2,x],x,1]},
  (d+e*x)^m*(a+b*x+c*x^2)^(p+1)*(R*b-2*a*S+(2*c*R-b*S)*x)/((p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^(m-1)*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[(p+1)*(b^2-4*a*c)*(d+e*x)*Qx+S*(2*a*e*m+b*d*(2*p+3))-R*(b*e*m+2*c*d*(2*p+3))-e*(2*c*R-b*S)*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && LtQ[p,-1] && GtQ[m,0] && 
  (IntegerQ[p] || Not[IntegerQ[m]] || Not[RationalQ[a,b,c,d,e]]) && 
  Not[IGtQ[m,0] && RationalQ[a,b,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a+c*x^2,x],
        R=Coeff[PolynomialRemainder[Pq,a+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[Pq,a+c*x^2,x],x,1]},
  (d+e*x)^m*(a+c*x^2)^(p+1)*(a*S-c*R*x)/(2*a*c*(p+1)) + 
  1/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^(m-1)*(a+c*x^2)^(p+1)*
    ExpandToSum[2*a*c*(p+1)*(d+e*x)*Qx-a*e*S*m+c*d*R*(2*p+3)+c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,c,d,e},x] && PolyQ[Pq,x] && NeQ[c*d^2+a*e^2,0] && LtQ[p,-1] && GtQ[m,0] && 
  Not[IGtQ[m,0] && RationalQ[a,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(d+e*x)^m*Pq,a+b*x+c*x^2,x],
        R=Coeff[PolynomialRemainder[(d+e*x)^m*Pq,a+b*x+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(d+e*x)^m*Pq,a+b*x+c*x^2,x],x,1]},
  (b*R-2*a*S+(2*c*R-b*S)*x)*(a+b*x+c*x^2)^(p+1)/((p+1)*(b^2-4*a*c)) + 
  1/((p+1)*(b^2-4*a*c)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^(p+1)*
    ExpandToSum[(p+1)*(b^2-4*a*c)*(d+e*x)^(-m)*Qx-(2*p+3)*(2*c*R-b*S)*(d+e*x)^(-m),x],x]] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && LtQ[p,-1] && ILtQ[m,0]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[(d+e*x)^m*Pq,a+c*x^2,x],
        R=Coeff[PolynomialRemainder[(d+e*x)^m*Pq,a+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[(d+e*x)^m*Pq,a+c*x^2,x],x,1]},
  (a*S-c*R*x)*(a+c*x^2)^(p+1)/(2*a*c*(p+1)) + 
  1/(2*a*c*(p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^(p+1)*
    ExpandToSum[2*a*c*(p+1)*(d+e*x)^(-m)*Qx+c*R*(2*p+3)*(d+e*x)^(-m),x],x]] /;
FreeQ[{a,c,d,e},x] && PolyQ[Pq,x] && NeQ[c*d^2+a*e^2,0] && LtQ[p,-1] && ILtQ[m,0]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a+b*x+c*x^2,x],
        R=Coeff[PolynomialRemainder[Pq,a+b*x+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[Pq,a+b*x+c*x^2,x],x,1]},
  (d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1)*(R*(b*c*d-b^2*e+2*a*c*e)-a*S*(2*c*d-b*e)+c*(R*(2*c*d-b*e)-S*(b*d-2*a*e))*x)/
    ((p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) + 
  1/((p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^(p+1)*
   ExpandToSum[(p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)*Qx+
      R*(b*c*d*e*(2*p-m+2)+b^2*e^2*(p+m+2)-2*c^2*d^2*(2*p+3)-2*a*c*e^2*(m+2*p+3))-
      S*(a*e*(b*e-2*c*d*m+b*e*m)-b*d*(3*c*d-b*e+2*c*d*p-b*e*p))+
      c*e*(S*(b*d-2*a*e)-R*(2*c*d-b*e))*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,b,c,d,e,m},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && LtQ[p,-1] && 
  Not[IGtQ[m,0] && RationalQ[a,b,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,a+c*x^2,x],
        R=Coeff[PolynomialRemainder[Pq,a+c*x^2,x],x,0],
        S=Coeff[PolynomialRemainder[Pq,a+c*x^2,x],x,1]},
  -(d+e*x)^(m+1)*(a+c*x^2)^(p+1)*(a*(e*R-d*S)+(c*d*R+a*e*S)*x)/(2*a*(p+1)*(c*d^2+a*e^2)) + 
  1/(2*a*(p+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^(p+1)*
   ExpandToSum[2*a*(p+1)*(c*d^2+a*e^2)*Qx+c*d^2*R*(2*p+3)-a*e*(d*S*m-e*R*(m+2*p+3))+e*(c*d*R+a*e*S)*(m+2*p+4)*x,x],x]] /;
FreeQ[{a,c,d,e,m},x] && PolyQ[Pq,x] && NeQ[c*d^2+a*e^2,0] && LtQ[p,-1] && 
  Not[IGtQ[m,0] && RationalQ[a,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,d+e*x,x], R=PolynomialRemainder[Pq,d+e*x,x]},
  (e*R*(d+e*x)^(m+1)*(a+b*x+c*x^2)^(p+1))/((m+1)*(c*d^2-b*d*e+a*e^2)) + 
  1/((m+1)*(c*d^2-b*d*e+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+b*x+c*x^2)^p*
     ExpandToSum[(m+1)*(c*d^2-b*d*e+a*e^2)*Qx+c*d*R*(m+1)-b*e*R*(m+p+2)-c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,b,c,d,e,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && LtQ[m,-1]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{Qx=PolynomialQuotient[Pq,d+e*x,x], R=PolynomialRemainder[Pq,d+e*x,x]},
  (e*R*(d+e*x)^(m+1)*(a+c*x^2)^(p+1))/((m+1)*(c*d^2+a*e^2)) + 
  1/((m+1)*(c*d^2+a*e^2)) \[Star] Int[(d+e*x)^(m+1)*(a+c*x^2)^p*
     ExpandToSum[(m+1)*(c*d^2+a*e^2)*Qx+c*d*R*(m+1)-c*e*R*(m+2*p+3)*x,x],x]] /;
FreeQ[{a,c,d,e,p},x] && PolyQ[Pq,x] && NeQ[c*d^2+a*e^2,0] && LtQ[m,-1]


(* ::Code:: *)
Int[x_^m_.*Pq_*(a_+b_.*x_^2)^p_,x_Symbol] :=
  Module[{q=Expon[Pq,x],k},
  Int[x^m*Sum[Coeff[Pq,x,2*k]*x^(2*k),{k,0,q/2}]*(a+b*x^2)^p,x] + 
  Int[x^(m+1)*Sum[Coeff[Pq,x,2*k+1]*x^(2*k),{k,0,(q-1)/2}]*(a+b*x^2)^p,x]] /;
FreeQ[{a,b,p},x] && PolyQ[Pq,x] && Not[PolyQ[Pq,x^2]] && IGtQ[m,-2] && Not[IntegerQ[2*p]]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(d+e*x)^(m+q-1)*(a+b*x+c*x^2)^(p+1)/(c*e^(q-1)*(m+q+2*p+1)) + 
  1/(c*e^q*(m+q+2*p+1)) \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p*ExpandToSum[c*e^q*(m+q+2*p+1)*Pq-c*f*(m+q+2*p+1)*(d+e*x)^q-
    f*(d+e*x)^(q-2)*(b*d*e*(p+1)+a*e^2*(m+q-1)-c*d^2*(m+q+2*p+1)-e*(2*c*d-b*e)*(m+q+p)*x),x],x] /;
 GtQ[q,1] && NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && 
  Not[IGtQ[m,0] && RationalQ[a,b,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_,x_Symbol] :=
  With[{q=Expon[Pq,x],f=Coeff[Pq,x,Expon[Pq,x]]},
  f*(d+e*x)^(m+q-1)*(a+c*x^2)^(p+1)/(c*e^(q-1)*(m+q+2*p+1)) + 
  1/(c*e^q*(m+q+2*p+1)) \[Star] Int[(d+e*x)^m*(a+c*x^2)^p*ExpandToSum[c*e^q*(m+q+2*p+1)*Pq-c*f*(m+q+2*p+1)*(d+e*x)^q-
    f*(d+e*x)^(q-2)*(a*e^2*(m+q-1)-c*d^2*(m+q+2*p+1)-2*c*d*e*(m+q+p)*x),x],x] /;
 GtQ[q,1] && NeQ[m+q+2*p+1,0]] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[c*d^2+a*e^2,0] && Not[EqQ[d,0] && True] && 
  Not[IGtQ[m,0] && RationalQ[a,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_.+e_.*x_)^m_.*Pq_*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Expon[Pq,x]},
  Coeff[Pq,x,q]/e^q \[Star] Int[(d+e*x)^(m+q)*(a+b*x+c*x^2)^p,x] + 
  1/e^q \[Star] Int[(d+e*x)^m*(a+b*x+c*x^2)^p*ExpandToSum[e^q*Pq-Coeff[Pq,x,q]*(d+e*x)^q,x],x]] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && 
  Not[IGtQ[m,0] && RationalQ[a,b,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]


(* ::Code:: *)
Int[(d_+e_.*x_)^m_.*Pq_*(a_+c_.*x_^2)^p_.,x_Symbol] :=
  With[{q=Expon[Pq,x]},
  Coeff[Pq,x,q]/e^q \[Star] Int[(d+e*x)^(m+q)*(a+c*x^2)^p,x] + 
  1/e^q \[Star] Int[(d+e*x)^m*(a+c*x^2)^p*ExpandToSum[e^q*Pq-Coeff[Pq,x,q]*(d+e*x)^q,x],x]] /;
FreeQ[{a,c,d,e,m,p},x] && PolyQ[Pq,x] && NeQ[c*d^2+a*e^2,0] && 
  Not[IGtQ[m,0] && RationalQ[a,c,d,e] && (IntegerQ[p] || ILtQ[p+1/2,0])]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.8 P(x) (a+b x+c x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.8 P(x) (a+b x+c x^2)^p *)
Int[Pq_*(a_ + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && IGtQ[p, -2]
Int[Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[x*PolynomialQuotient[Pq, x, x]*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0] && Not[MatchQ[Pq, x^m_.*u_. /; IntegerQ[m]]]
Int[Pq_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[Pq*(b + 2*c*x)^(2*p), x] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && EqQ[b^2 - 4*a*c, 0]
Int[Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + b*x + c*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + b*x + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + b*x + c*x^2, x], x, 1]}, (b*f - 2*a*g + (2*c*f - b*g)* x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(a + b*x + c*x^2)^(p + 1)* ExpandToSum[(p + 1)*(b^2 - 4*a*c)*Q - (2*p + 3)*(2*c*f - b*g), x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1]
Int[Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], e = Coeff[Pq, x, Expon[Pq, x]]}, e*x^(q - 1)*(a + b*x + c*x^2)^(p + 1)/(c*(q + 2*p + 1)) + 1/(c*(q + 2*p + 1))*Int[(a + b*x + c*x^2)^p* ExpandToSum[ c*(q + 2*p + 1)*Pq - a*e*(q - 1)*x^(q - 2) - b*e*(q + p)*x^(q - 1) - c*e*(q + 2*p + 1)*x^q, x], x]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && Not[LeQ[p, -1]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.8 P(x) (d+e x)^m (f+g x)^n (a+b x+c x^2)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Px_*(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,d+e*x,x]*(d+e*x)^(m+1)*(f+g*x)^n*(a+b*x+c*x^2)^p,x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && PolynomialQ[Px,x] && EqQ[PolynomialRemainder[Px,d+e*x,x],0]


(* ::Code:: *)
Int[Px_*(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[Px*(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && PolyQ[Px,x] && (IntegerQ[p] || IntegerQ[2*p] && IntegerQ[m] && ILtQ[n,0]) && Not[IGtQ[m,0] && IGtQ[n,0]]


(* ::Code:: *)
Int[Px_*(d_.+e_.*x_)^m_.*(f_.+g_.*x_)^n_.*(a_.+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[PolynomialQuotient[Px,d+e*x,x]*(d+e*x)^(m+1)*(f+g*x)^n*(a+b*x+c*x^2)^p,x] + 
  PolynomialRemainder[Px,d+e*x,x] \[Star] Int[(d+e*x)^m*(f+g*x)^n*(a+b*x+c*x^2)^p,x]/;
FreeQ[{a,b,c,d,e,f,g,n,p},x] && PolynomialQ[Px,x] && LtQ[m,0] && Not[IntegerQ[n]] && IntegersQ[2*m,2*n,2*p]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.9 P(x) (a+b x+c x^2)^p (d+e x+f x^2)^q.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_.*(d_+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  (c/f)^p \[Star] Int[Px*(d+e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && PolyQ[Px,x] && EqQ[c*d-a*f,0] && EqQ[b*d-a*e,0] && (IntegerQ[p] || GtQ[c/f,0]) && 
  (Not[IntegerQ[q]] || LeafCount[d+e*x+f*x^2]<=LeafCount[a+b*x+c*x^2])


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_.*(d_+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  a^IntPart[p]*(a+b*x+c*x^2)^FracPart[p]/(d^IntPart[p]*(d+e*x+f*x^2)^FracPart[p]) \[Star] Int[Px*(d+e*x+f*x^2)^(p+q),x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && PolyQ[Px,x] && EqQ[c*d-a*f,0] && EqQ[b*d-a*e,0] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && Not[GtQ[c/f,0]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  1/c^p \[Star] Int[Px*(b/2+c*x)^(2*p)*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && PolyQ[Px,x] && EqQ[b^2-4*a*c,0] && IntegerQ[p]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+f_.*x_^2)^q_.,x_Symbol] :=
  1/c^p \[Star] Int[Px*(b/2+c*x)^(2*p)*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,p,q},x] && PolyQ[Px,x] && EqQ[b^2-4*a*c,0] && IntegerQ[p]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+e_.*x_+f_.*x_^2)^q_.,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(b+2*c*x)^(2*p)*(d+e*x+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,e,f,p,q},x] && PolyQ[Px,x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_.*(d_.+f_.*x_^2)^q_.,x_Symbol] :=
  (a+b*x+c*x^2)^FracPart[p]/((4*c)^IntPart[p]*(b+2*c*x)^(2*FracPart[p])) \[Star] Int[(b+2*c*x)^(2*p)*(d+f*x^2)^q,x] /;
FreeQ[{a,b,c,d,f,p,q},x] && PolyQ[Px,x] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (A*b*c-2*a*B*c+a*b*C-(c*(b*B-2*A*c)-C*(b^2-2*a*c))*x)*(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^q/(c*(b^2-4*a*c)*(p+1)) - 
  1/(c*(b^2-4*a*c)*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q-1)*
      Simp[e*q*(A*b*c-2*a*B*c+a*b*C)-d*(c*(b*B-2*A*c)*(2*p+3)+C*(2*a*c-b^2*(p+2)))+
        (2*f*q*(A*b*c-2*a*B*c+a*b*C)-e*(c*(b*B-2*A*c)*(2*p+q+3)+C*(2*a*c*(q+1)-b^2*(p+q+2))))*x-
        f*(c*(b*B-2*A*c)*(2*p+2*q+3)+C*(2*a*c*(2*q+1)-b^2*(p+2*q+2)))*x^2,x],x]] /;
FreeQ[{a,b,c,d,e,f},x] && PolyQ[Px,x,2] && LtQ[p,-1] && GtQ[q,0] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (a*B-(A*c-a*C)*x)*(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^q/(2*a*c*(p+1)) - 
  2/((-4*a*c)*(p+1)) \[Star] 
    Int[(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q-1)*
      Simp[A*c*d*(2*p+3)-a*(C*d+B*e*q)+(A*c*e*(2*p+q+3)-a*(2*B*f*q+C*e*(q+1)))*x-f*(a*C*(2*q+1)-A*c*(2*p+2*q+3))*x^2,x],x]] /;
FreeQ[{a,c,d,e,f},x] && PolyQ[Px,x,2] && LtQ[p,-1] && GtQ[q,0] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (A*b*c-2*a*B*c+a*b*C-(c*(b*B-2*A*c)-C*(b^2-2*a*c))*x)*(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^q/(c*(b^2-4*a*c)*(p+1)) - 
  1/(c*(b^2-4*a*c)*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^(q-1)*
      Simp[-d*(c*(b*B-2*A*c)*(2*p+3)+C*(2*a*c-b^2*(p+2)))+
        (2*f*q*(A*b*c-2*a*B*c+a*b*C))*x-
        f*(c*(b*B-2*A*c)*(2*p+2*q+3)+C*(2*a*c*(2*q+1)-b^2*(p+2*q+2)))*x^2,x],x]] /;
FreeQ[{a,b,c,d,f},x] && PolyQ[Px,x,2] && LtQ[p,-1] && GtQ[q,0] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q+1)/((b^2-4*a*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1))*
    ((A*c-a*C)*(2*a*c*e-b*(c*d+a*f))+(A*b-a*B)*(2*c^2*d+b^2*f-c*(b*e+2*a*f))+
      c*(A*(2*c^2*d+b^2*f-c*(b*e+2*a*f))-B*(b*c*d-2*a*c*e+a*b*f)+C*(b^2*d-a*b*e-2*a*(c*d-a*f)))*x) + 
  1/((b^2-4*a*c)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+e*x+f*x^2)^q*
      Simp[(b*B-2*A*c-2*a*C)*((c*d-a*f)^2-(b*d-a*e)*(c*e-b*f))*(p+1)+
        (b^2*(C*d+A*f)-b*(B*c*d+A*c*e+a*C*e+a*B*f)+2*(A*c*(c*d-a*f)-a*(c*C*d-B*c*e-a*C*f)))*(a*f*(p+1)-c*d*(p+2))-
        e*((A*c-a*C)*(2*a*c*e-b*(c*d+a*f))+(A*b-a*B)*(2*c^2*d+b^2*f-c*(b*e+2*a*f)))*(p+q+2)-
        (2*f*((A*c-a*C)*(2*a*c*e-b*(c*d+a*f))+(A*b-a*B)*(2*c^2*d+b^2*f-c*(b*e+2*a*f)))*(p+q+2)-
          (b^2*(C*d+A*f)-b*(B*c*d+A*c*e+a*C*e+a*B*f)+2*(A*c*(c*d-a*f)-a*(c*C*d-B*c*e-a*C*f)))*
          (b*f*(p+1)-c*e*(2*p+q+4)))*x-
        c*f*(b^2*(C*d+A*f)-b*(B*c*d+A*c*e+a*C*e+a*B*f)+2*(A*c*(c*d-a*f)-a*(c*C*d-B*c*e-a*C*f)))*(2*p+2*q+5)*x^2,x],x]] /;
FreeQ[{a,b,c,d,e,f,q},x] && PolyQ[Px,x,2] && LtQ[p,-1] && NeQ[(c*d-a*f)^2-(b*d-a*e)*(c*e-b*f),0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (a+c*x^2)^(p+1)*(d+e*x+f*x^2)^(q+1)/((-4*a*c)*(a*c*e^2+(c*d-a*f)^2)*(p+1))*
    ((A*c-a*C)*(2*a*c*e)+(-a*B)*(2*c^2*d-c*(2*a*f))+
      c*(A*(2*c^2*d-c*(2*a*f))-B*(-2*a*c*e)+C*(-2*a*(c*d-a*f)))*x) + 
  1/((-4*a*c)*(a*c*e^2+(c*d-a*f)^2)*(p+1)) \[Star] 
    Int[(a+c*x^2)^(p+1)*(d+e*x+f*x^2)^q*
      Simp[(-2*A*c-2*a*C)*((c*d-a*f)^2-(-a*e)*(c*e))*(p+1)+
        (2*(A*c*(c*d-a*f)-a*(c*C*d-B*c*e-a*C*f)))*(a*f*(p+1)-c*d*(p+2))-
        e*((A*c-a*C)*(2*a*c*e)+(-a*B)*(2*c^2*d-c*(+2*a*f)))*(p+q+2)-
        (2*f*((A*c-a*C)*(2*a*c*e)+(-a*B)*(2*c^2*d+-c*(+2*a*f)))*(p+q+2)-
          (2*(A*c*(c*d-a*f)-a*(c*C*d-B*c*e-a*C*f)))*
          (-c*e*(2*p+q+4)))*x-
        c*f*(2*(A*c*(c*d-a*f)-a*(c*C*d-B*c*e-a*C*f)))*(2*p+2*q+5)*x^2,x],x]] /;
FreeQ[{a,c,d,e,f,q},x] && PolyQ[Px,x,2] && LtQ[p,-1] && NeQ[a*c*e^2+(c*d-a*f)^2,0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (a+b*x+c*x^2)^(p+1)*(d+f*x^2)^(q+1)/((b^2-4*a*c)*(b^2*d*f+(c*d-a*f)^2)*(p+1))*
    ((A*c-a*C)*(-b*(c*d+a*f))+(A*b-a*B)*(2*c^2*d+b^2*f-c*(2*a*f))+
      c*(A*(2*c^2*d+b^2*f-c*(2*a*f))-B*(b*c*d+a*b*f)+C*(b^2*d-2*a*(c*d-a*f)))*x) + 
  1/((b^2-4*a*c)*(b^2*d*f+(c*d-a*f)^2)*(p+1)) \[Star] 
    Int[(a+b*x+c*x^2)^(p+1)*(d+f*x^2)^q*
      Simp[(b*B-2*A*c-2*a*C)*((c*d-a*f)^2-(b*d)*(-b*f))*(p+1)+
        (b^2*(C*d+A*f)-b*(B*c*d+a*B*f)+2*(A*c*(c*d-a*f)-a*(c*C*d-a*C*f)))*(a*f*(p+1)-c*d*(p+2))-
        (2*f*((A*c-a*C)*(-b*(c*d+a*f))+(A*b-a*B)*(2*c^2*d+b^2*f-c*(2*a*f)))*(p+q+2)-
          (b^2*(C*d+A*f)-b*(B*c*d+a*B*f)+2*(A*c*(c*d-a*f)-a*(c*C*d-a*C*f)))*
          (b*f*(p+1)))*x-
        c*f*(b^2*(C*d+A*f)-b*(B*c*d+a*B*f)+2*(A*c*(c*d-a*f)-a*(c*C*d-a*C*f)))*(2*p+2*q+5)*x^2,x],x]] /;
FreeQ[{a,b,c,d,f,q},x] && PolyQ[Px,x,2] && LtQ[p,-1] && NeQ[b^2*d*f+(c*d-a*f)^2,0] && Not[Not[IntegerQ[p]] && ILtQ[q,-1]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (B*c*f*(2*p+2*q+3)+C*(b*f*p-c*e*(2*p+q+2))+2*c*C*f*(p+q+1)*x)*(a+b*x+c*x^2)^p*
    (d+e*x+f*x^2)^(q+1)/(2*c*f^2*(p+q+1)*(2*p+2*q+3)) - 
  (1/(2*c*f^2*(p+q+1)*(2*p+2*q+3))) \[Star] 
    Int[(a+b*x+c*x^2)^(p-1)*(d+e*x+f*x^2)^q*
      Simp[p*(b*d-a*e)*(C*(c*e-b*f)*(q+1)-c*(C*e-B*f)*(2*p+2*q+3))+
          (p+q+1)*(b^2*C*d*f*p+a*c*(C*(2*d*f-e^2*(2*p+q+2))+f*(B*e-2*A*f)*(2*p+2*q+3)))+
        (2*p*(c*d-a*f)*(C*(c*e-b*f)*(q+1)-c*(C*e-B*f)*(2*p+2*q+3))+
          (p+q+1)*(C*e*f*p*(b^2-4*a*c)-b*c*(C*(e^2-4*d*f)*(2*p+q+2)+f*(2*C*d-B*e+2*A*f)*(2*p+2*q+3))))*x+
        (p*(c*e-b*f)*(C*(c*e-b*f)*(q+1)-c*(C*e-B*f)*(2*p+2*q+3))+
          (p+q+1)*(C*f^2*p*(b^2-4*a*c)-c^2*(C*(e^2-4*d*f)*(2*p+q+2)+f*(2*C*d-B*e+2*A*f)*(2*p+2*q+3))))*x^2,x],x]] /;
FreeQ[{a,b,c,d,e,f,q},x] && PolyQ[Px,x,2] && GtQ[p,0] && NeQ[p+q+1,0] && NeQ[2*p+2*q+3,0] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+c_.*x_^2)^p_*(d_+e_.*x_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (B*c*f*(2*p+2*q+3)+C*(-c*e*(2*p+q+2))+2*c*C*f*(p+q+1)*x)*(a+c*x^2)^p*
    (d+e*x+f*x^2)^(q+1)/(2*c*f^2*(p+q+1)*(2*p+2*q+3)) - 
  (1/(2*c*f^2*(p+q+1)*(2*p+2*q+3))) \[Star] 
    Int[(a+c*x^2)^(p-1)*(d+e*x+f*x^2)^q*
      Simp[p*(-a*e)*(C*(c*e)*(q+1)-c*(C*e-B*f)*(2*p+2*q+3))+
          (p+q+1)*(a*c*(C*(2*d*f-e^2*(2*p+q+2))+f*(B*e-2*A*f)*(2*p+2*q+3)))+
        (2*p*(c*d-a*f)*(C*(c*e)*(q+1)-c*(C*e-B*f)*(2*p+2*q+3))+
          (p+q+1)*(C*e*f*p*(-4*a*c)))*x+
        (p*(c*e)*(C*(c*e)*(q+1)-c*(C*e-B*f)*(2*p+2*q+3))+
          (p+q+1)*(C*f^2*p*(-4*a*c)-c^2*(C*(e^2-4*d*f)*(2*p+q+2)+f*(2*C*d-B*e+2*A*f)*(2*p+2*q+3))))*x^2,x],x]] /;
FreeQ[{a,c,d,e,f,q},x] && PolyQ[Px,x,2] && GtQ[p,0] && NeQ[p+q+1,0] && NeQ[2*p+2*q+3,0] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_*(a_+b_.*x_+c_.*x_^2)^p_*(d_+f_.*x_^2)^q_,x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  (B*c*f*(2*p+2*q+3)+C*(b*f*p)+2*c*C*f*(p+q+1)*x)*(a+b*x+c*x^2)^p*
    (d+f*x^2)^(q+1)/(2*c*f^2*(p+q+1)*(2*p+2*q+3)) - 
  (1/(2*c*f^2*(p+q+1)*(2*p+2*q+3))) \[Star] 
    Int[(a+b*x+c*x^2)^(p-1)*(d+f*x^2)^q*
      Simp[p*(b*d)*(C*(-b*f)*(q+1)-c*(-B*f)*(2*p+2*q+3))+
          (p+q+1)*(b^2*C*d*f*p+a*c*(C*(2*d*f)+f*(-2*A*f)*(2*p+2*q+3)))+
        (2*p*(c*d-a*f)*(C*(-b*f)*(q+1)-c*(-B*f)*(2*p+2*q+3))+
          (p+q+1)*(-b*c*(C*(-4*d*f)*(2*p+q+2)+f*(2*C*d+2*A*f)*(2*p+2*q+3))))*x+
        (p*(-b*f)*(C*(-b*f)*(q+1)-c*(-B*f)*(2*p+2*q+3))+
          (p+q+1)*(C*f^2*p*(b^2-4*a*c)-c^2*(C*(-4*d*f)*(2*p+q+2)+f*(2*C*d+2*A*f)*(2*p+2*q+3))))*x^2,x],x]] /;
FreeQ[{a,b,c,d,f,q},x] && PolyQ[Px,x,2] && GtQ[p,0] && NeQ[p+q+1,0] && NeQ[2*p+2*q+3,0] && Not[IGtQ[p,0]] && Not[IGtQ[q,0]]


(* ::Code:: *)
Int[Px_/((a_+b_.*x_+c_.*x_^2)*(d_+e_.*x_+f_.*x_^2)),x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2],q=c^2*d^2-b*c*d*e+a*c*e^2+b^2*d*f-2*a*c*d*f-a*b*e*f+a^2*f^2},
  1/q \[Star] Int[(A*c^2*d-a*c*C*d-A*b*c*e+a*B*c*e+A*b^2*f-a*b*B*f-a*A*c*f+a^2*C*f+
    c*(B*c*d-b*C*d-A*c*e+a*C*e+A*b*f-a*B*f)*x)/(a+b*x+c*x^2),x] + 
  1/q \[Star] Int[(c*C*d^2-B*c*d*e+A*c*e^2+b*B*d*f-A*c*d*f-a*C*d*f-A*b*e*f+a*A*f^2-
    f*(B*c*d-b*C*d-A*c*e+a*C*e+A*b*f-a*B*f)*x)/(d+e*x+f*x^2),x] /;
 NeQ[q,0]] /;
FreeQ[{a,b,c,d,e,f},x] && PolyQ[Px,x,2]


(* ::Code:: *)
Int[Px_/((a_+b_.*x_+c_.*x_^2)*(d_+f_.*x_^2)),x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2],q=c^2*d^2+b^2*d*f-2*a*c*d*f+a^2*f^2},
  1/q \[Star] Int[(A*c^2*d-a*c*C*d+A*b^2*f-a*b*B*f-a*A*c*f+a^2*C*f+c*(B*c*d-b*C*d+A*b*f-a*B*f)*x)/(a+b*x+c*x^2),x] + 
  1/q \[Star] Int[(c*C*d^2+b*B*d*f-A*c*d*f-a*C*d*f+a*A*f^2-f*(B*c*d-b*C*d+A*b*f-a*B*f)*x)/(d+f*x^2),x] /;
 NeQ[q,0]] /;
FreeQ[{a,b,c,d,f},x] && PolyQ[Px,x,2]


(* ::Code:: *)
Int[Px_/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  C/c \[Star] Int[1/Sqrt[d+e*x+f*x^2],x] + 1/c \[Star] Int[(A*c-a*C+(B*c-b*C)*x)/((a+b*x+c*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && PolyQ[Px,x,2]


(* ::Code:: *)
Int[Px_/((a_+c_.*x_^2)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  C/c \[Star] Int[1/Sqrt[d+e*x+f*x^2],x] + 1/c \[Star] Int[(A*c-a*C+B*c*x)/((a+c*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,c,d,e,f},x] && PolyQ[Px,x,2]


(* ::Code:: *)
Int[Px_/((a_+b_.*x_+c_.*x_^2)*Sqrt[d_.+f_.*x_^2]),x_Symbol] :=
  With[{A=Coeff[Px,x,0],B=Coeff[Px,x,1],C=Coeff[Px,x,2]},
  C/c \[Star] Int[1/Sqrt[d+f*x^2],x] + 1/c \[Star] Int[(A*c-a*C+(B*c-b*C)*x)/((a+b*x+c*x^2)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,c,d,f},x] && PolyQ[Px,x,2]


(* ::Code:: *)
Int[(a_.+b_.*u_+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.*(A_.+B_.*u_+C_.*u_^2),x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q*(A+B*x+C*x^2),x],x,u] /;
FreeQ[{a,b,c,d,e,f,A,B,C,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(a_.+b_.*u_+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.*(A_.+B_.*u_),x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q*(A+B*x),x],x,u] /;
FreeQ[{a,b,c,d,e,f,A,B,C,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(a_.+b_.*u_+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.*(A_.+C_.*u_^2),x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+b*x+c*x^2)^p*(d+e*x+f*x^2)^q*(A+C*x^2),x],x,u] /;
FreeQ[{a,b,c,d,e,f,A,C,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(a_.+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.*(A_.+B_.*u_+C_.*u_^2),x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+c*x^2)^p*(d+e*x+f*x^2)^q*(A+B*x+C*x^2),x],x,u] /;
FreeQ[{a,c,d,e,f,A,B,C,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(a_.+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.*(A_.+B_.*u_),x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+c*x^2)^p*(d+e*x+f*x^2)^q*(A+B*x),x],x,u] /;
FreeQ[{a,c,d,e,f,A,B,C,p,q},x] && LinearQ[u,x] && NeQ[u,x]


(* ::Code:: *)
Int[(a_.+c_.*u_^2)^p_.*(d_.+e_.*u_+f_.*u_^2)^q_.*(A_.+C_.*u_^2),x_Symbol] :=
  1/Coefficient[u,x,1] \[Star] Subst[Int[(a+c*x^2)^p*(d+e*x+f*x^2)^q*(A+C*x^2),x],x,u] /;
FreeQ[{a,c,d,e,f,A,C,p,q},x] && LinearQ[u,x] && NeQ[u,x]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.1 Quadratic/1.2.1.9 P(x) (d+e x)^m (a+b x+c x^2)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.1.9 P(x) (d+e x)^m (a+b x+c x^2)^p *)
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + 1)* PolynomialQuotient[Pq, d + e*x, x]*(a + b*x + c*x^2)^p, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && EqQ[PolynomialRemainder[Pq, d + e*x, x], 0]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + 1)* PolynomialQuotient[Pq, d + e*x, x]*(a + c*x^2)^p, x] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[Pq, x] && EqQ[PolynomialRemainder[Pq, d + e*x, x], 0]
Int[(d_. + e_.*x_)^m_.*P2_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := With[{f = Coeff[P2, x, 0], g = Coeff[P2, x, 1], h = Coeff[P2, x, 2]}, h*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)/(c* e*(m + 2*p + 3)) /; EqQ[b*e*h*(m + p + 2) + 2*c*d*h*(p + 1) - c*e*g*(m + 2*p + 3), 0] && EqQ[b*d*h*(p + 1) + a*e*h*(m + 1) - c*e*f*(m + 2*p + 3), 0]] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[P2, x, 2] && NeQ[m + 2*p + 3, 0]
Int[(d_ + e_.*x_)^m_.*P2_*(a_ + c_.*x_^2)^p_., x_Symbol] := With[{f = Coeff[P2, x, 0], g = Coeff[P2, x, 1], h = Coeff[P2, x, 2]}, h*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)/(c*e*(m + 2*p + 3)) /; EqQ[2*d*h*(p + 1) - e*g*(m + 2*p + 3), 0] && EqQ[a*h*(m + 1) - c*f*(m + 2*p + 3), 0]] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[P2, x, 2] && NeQ[m + 2*p + 3, 0]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*Pq*(a + b*x + c*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && PolyQ[Pq, x] && IGtQ[p, -2]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*Pq*(a + c*x^2)^p, x], x] /; FreeQ[{a, c, d, e, m}, x] && PolyQ[Pq, x] && IGtQ[p, -2]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x)^(2*FracPart[p]))* Int[(d + e*x)^m*Pq*(b + 2*c*x)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && EqQ[b^2 - 4*a*c, 0]
Int[(e_.*x_)^m_.*Pq_*(b_.*x_ + c_.*x_^2)^p_., x_Symbol] := e*Int[(e*x)^(m - 1)* PolynomialQuotient[Pq, b + c*x, x]*(b*x + c*x^2)^(p + 1), x] /; FreeQ[{b, c, e, m, p}, x] && PolyQ[Pq, x] && EqQ[PolynomialRemainder[Pq, b + c*x, x], 0]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := d*e*Int[(d + e*x)^(m - 1)* PolynomialQuotient[Pq, a*e + c*d*x, x]*(a + b*x + c*x^2)^(p + 1), x] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[PolynomialRemainder[Pq, a*e + c*d*x, x], 0]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_., x_Symbol] := d*e*Int[(d + e*x)^(m - 1)* PolynomialQuotient[Pq, a*e + c*d*x, x]*(a + c*x^2)^(p + 1), x] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[Pq, x] && EqQ[c*d^2 + a*e^2, 0] && EqQ[PolynomialRemainder[Pq, a*e + c*d*x, x], 0]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a*e + c*d*x, x], f = PolynomialRemainder[Pq, a*e + c*d*x, x]}, f*(2*c*d - b*e)*(d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)/(e*(p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)* ExpandToSum[ d*e*(p + 1)*(b^2 - 4*a*c)*Q - f*(2*c*d - b*e)*(m + 2*p + 2), x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[p + 1/2, 0] && GtQ[m, 0]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a*e + c*d*x, x], f = PolynomialRemainder[Pq, a*e + c*d*x, x]}, -d*f*(d + e*x)^m*(a + c*x^2)^(p + 1)/(2*a*e*(p + 1)) + d/(2*a*(p + 1))* Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)* ExpandToSum[2*a*e*(p + 1)*Q + f*(m + 2*p + 2), x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Pq, x] && EqQ[c*d^2 + a*e^2, 0] && ILtQ[p + 1/2, 0] && GtQ[m, 0]
Int[(d_. + e_.*x_)^m_*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x + c*x^2)^p, (d + e*x)^m*Pq, x], x] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[m + Expon[Pq, x] + 2*p + 1, 0] && ILtQ[m, 0]
Int[(d_ + e_.*x_)^m_*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := Int[ExpandIntegrand[(a + c*x^2)^p, (d + e*x)^m*Pq, x], x] /; FreeQ[{a, c, d, e}, x] && PolyQ[Pq, x] && EqQ[c*d^2 + a*e^2, 0] && EqQ[m + Expon[Pq, x] + 2*p + 1, 0] && ILtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], f = Coeff[Pq, x, Expon[Pq, x]]}, f*(d + e*x)^(m + q - 1)*(a + b*x + c*x^2)^(p + 1)/(c* e^(q - 1)*(m + q + 2*p + 1)) + 1/(c*e^q*(m + q + 2*p + 1))*Int[(d + e*x)^m*(a + b*x + c*x^2)^p* ExpandToSum[ c*e^q*(m + q + 2*p + 1)*Pq - c*f*(m + q + 2*p + 1)*(d + e*x)^q + e*f*(m + p + q)*(d + e*x)^(q - 2)*(b*d - 2*a*e + (2*c*d - b*e)*x), x], x] /; NeQ[m + q + 2*p + 1, 0]] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], f = Coeff[Pq, x, Expon[Pq, x]]}, f*(d + e*x)^(m + q - 1)*(a + c*x^2)^(p + 1)/(c* e^(q - 1)*(m + q + 2*p + 1)) + 1/(c*e^q*(m + q + 2*p + 1))*Int[(d + e*x)^m*(a + c*x^2)^p* ExpandToSum[ c*e^q*(m + q + 2*p + 1)*Pq - c*f*(m + q + 2*p + 1)*(d + e*x)^q - 2*e*f*(m + p + q)*(d + e*x)^(q - 2)*(a*e - c*d*x), x], x] /; NeQ[m + q + 2*p + 1, 0]] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[Pq, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IGtQ[m, 0]]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p*Pq, x] /; FreeQ[{a, b, c, d, e, m}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_., x_Symbol] := Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p*Pq, x] /; FreeQ[{a, c, d, e, m}, x] && PolyQ[Pq, x] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := (a + b*x + c*x^2)^ FracPart[p]/((d + e*x)^FracPart[p]*(a/d + (c*x)/e)^FracPart[p])* Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p*Pq, x] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && Not[IGtQ[m, 0]]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := (a + c*x^2)^ FracPart[p]/((d + e*x)^FracPart[p]*(a/d + (c*x)/e)^FracPart[p])* Int[(d + e*x)^(m + p)*(a/d + c/e*x)^p*Pq, x] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[Pq, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && Not[IGtQ[m, 0]]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + b*x + c*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + b*x + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + b*x + c*x^2, x], x, 1]}, (d + e*x)^ m*(a + b*x + c*x^2)^(p + 1)*(f*b - 2*a*g + (2*c*f - b*g)*x)/((p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^(m - 1)*(a + b*x + c*x^2)^(p + 1)* ExpandToSum[(p + 1)*(b^2 - 4*a*c)*(d + e*x)*Q + g*(2*a*e*m + b*d*(2*p + 3)) - f*(b*e*m + 2*c*d*(2*p + 3)) - e*(2*c*f - b*g)*(m + 2*p + 3)*x, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0] && (IntegerQ[p] || Not[IntegerQ[m]] || Not[RationalQ[a, b, c, d, e]]) && Not[ IGtQ[m, 0] && RationalQ[a, b, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + c*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + c*x^2, x], x, 1]}, (d + e*x)^m*(a + c*x^2)^(p + 1)*(a*g - c*f*x)/(2*a*c*(p + 1)) + 1/(2*a*c*(p + 1))*Int[(d + e*x)^(m - 1)*(a + c*x^2)^(p + 1)* ExpandToSum[ 2*a*c*(p + 1)*(d + e*x)*Q - a*e*g*m + c*d*f*(2*p + 3) + c*e*f*(m + 2*p + 3)*x, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Pq, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && GtQ[m, 0] && Not[ IGtQ[m, 0] && RationalQ[a, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[(d + e*x)^m*Pq, a + b*x + c*x^2, x], f = Coeff[PolynomialRemainder[(d + e*x)^m*Pq, a + b*x + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[(d + e*x)^m*Pq, a + b*x + c*x^2, x], x, 1]}, (b*f - 2*a*g + (2*c*f - b*g)* x)*(a + b*x + c*x^2)^(p + 1)/((p + 1)*(b^2 - 4*a*c)) + 1/((p + 1)*(b^2 - 4*a*c))* Int[(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)* ExpandToSum[(p + 1)*(b^2 - 4*a*c)*(d + e*x)^(-m)* Q - (2*p + 3)*(2*c*f - b*g)*(d + e*x)^(-m), x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && ILtQ[m, 0]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[(d + e*x)^m*Pq, a + c*x^2, x], f = Coeff[PolynomialRemainder[(d + e*x)^m*Pq, a + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[(d + e*x)^m*Pq, a + c*x^2, x], x, 1]}, (a*g - c*f*x)*(a + c*x^2)^(p + 1)/(2*a*c*(p + 1)) + 1/(2*a*c*(p + 1))*Int[(d + e*x)^m*(a + c*x^2)^(p + 1)* ExpandToSum[ 2*a*c*(p + 1)*(d + e*x)^(-m)*Q + c*f*(2*p + 3)*(d + e*x)^(-m), x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Pq, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && ILtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + b*x + c*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + b*x + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + b*x + c*x^2, x], x, 1]}, (d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1)*(f*(b*c*d - b^2*e + 2*a*c*e) - a*g*(2*c*d - b*e) + c*(f*(2*c*d - b*e) - g*(b*d - 2*a*e))*x)/ ((p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2)) + 1/((p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^m*(a + b*x + c*x^2)^(p + 1)* ExpandToSum[(p + 1)*(b^2 - 4*a*c)*(c*d^2 - b*d*e + a*e^2)*Q + f*(b*c*d*e*(2*p - m + 2) + b^2*e^2*(p + m + 2) - 2*c^2*d^2*(2*p + 3) - 2*a*c*e^2*(m + 2*p + 3)) - g*(a*e*(b*e - 2*c*d*m + b*e*m) - b*d*(3*c*d - b*e + 2*c*d*p - b*e*p)) + c*e*(g*(b*d - 2*a*e) - f*(2*c*d - b*e))*(m + 2*p + 4)*x, x], x]] /; FreeQ[{a, b, c, d, e, m}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && Not[ IGtQ[m, 0] && RationalQ[a, b, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, a + c*x^2, x], f = Coeff[PolynomialRemainder[Pq, a + c*x^2, x], x, 0], g = Coeff[PolynomialRemainder[Pq, a + c*x^2, x], x, 1]}, -(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1)*(a*(e*f - d*g) + (c*d*f + a*e*g)*x)/(2* a*(p + 1)*(c*d^2 + a*e^2)) + 1/(2*a*(p + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^m*(a + c*x^2)^(p + 1)* ExpandToSum[ 2*a*(p + 1)*(c*d^2 + a*e^2)*Q + c*d^2*f*(2*p + 3) - a*e*(d*g*m - e*f*(m + 2*p + 3)) + e*(c*d*f + a*e*g)*(m + 2*p + 4)*x, x], x]] /; FreeQ[{a, c, d, e, m}, x] && PolyQ[Pq, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && Not[ IGtQ[m, 0] && RationalQ[a, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_. + e_.*x_)^m_*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, d + e*x, x], R = PolynomialRemainder[Pq, d + e*x, x]}, (e*R*(d + e*x)^(m + 1)*(a + b*x + c*x^2)^(p + 1))/((m + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/((m + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x)^(m + 1)*(a + b*x + c*x^2)^p* ExpandToSum[(m + 1)*(c*d^2 - b*d*e + a*e^2)*Q + c*d*R*(m + 1) - b*e*R*(m + p + 2) - c*e*R*(m + 2*p + 3)*x, x], x]] /; FreeQ[{a, b, c, d, e, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[m, -1]
Int[(d_ + e_.*x_)^m_*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{Q = PolynomialQuotient[Pq, d + e*x, x], R = PolynomialRemainder[Pq, d + e*x, x]}, (e*R*(d + e*x)^(m + 1)*(a + c*x^2)^(p + 1))/((m + 1)*(c*d^2 + a*e^2)) + 1/((m + 1)*(c*d^2 + a*e^2))* Int[(d + e*x)^(m + 1)*(a + c*x^2)^p* ExpandToSum[(m + 1)*(c*d^2 + a*e^2)*Q + c*d*R*(m + 1) - c*e*R*(m + 2*p + 3)*x, x], x]] /; FreeQ[{a, c, d, e, p}, x] && PolyQ[Pq, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[m, -1]
Int[x_^m_.*Pq_*(a_ + b_.*x_^2)^p_, x_Symbol] := Module[{q = Expon[Pq, x], k}, Int[ x^m*Sum[Coeff[Pq, x, 2*k]*x^(2*k), {k, 0, q/2}]*(a + b*x^2)^p, x] + Int[ x^(m + 1)* Sum[Coeff[Pq, x, 2*k + 1]*x^(2*k), {k, 0, (q - 1)/2}]*(a + b*x^2)^p, x]] /; FreeQ[{a, b, p}, x] && PolyQ[Pq, x] && Not[PolyQ[Pq, x^2]] && IGtQ[m, -2] && Not[IntegerQ[2*p]]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], f = Coeff[Pq, x, Expon[Pq, x]]}, f*(d + e*x)^(m + q - 1)*(a + b*x + c*x^2)^(p + 1)/(c* e^(q - 1)*(m + q + 2*p + 1)) + 1/(c*e^q*(m + q + 2*p + 1))* Int[(d + e*x)^m*(a + b*x + c*x^2)^p* ExpandToSum[ c*e^q*(m + q + 2*p + 1)*Pq - c*f*(m + q + 2*p + 1)*(d + e*x)^q - f*(d + e*x)^(q - 2)*(b*d*e*(p + 1) + a*e^2*(m + q - 1) - c*d^2*(m + q + 2*p + 1) - e*(2*c*d - b*e)*(m + q + p)*x), x], x] /; GtQ[q, 1] && NeQ[m + q + 2*p + 1, 0]] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[ IGtQ[m, 0] && RationalQ[a, b, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x], f = Coeff[Pq, x, Expon[Pq, x]]}, f*(d + e*x)^(m + q - 1)*(a + c*x^2)^(p + 1)/(c* e^(q - 1)*(m + q + 2*p + 1)) + 1/(c*e^q*(m + q + 2*p + 1))* Int[(d + e*x)^m*(a + c*x^2)^p* ExpandToSum[ c*e^q*(m + q + 2*p + 1)*Pq - c*f*(m + q + 2*p + 1)*(d + e*x)^q - f*(d + e*x)^(q - 2)*(a*e^2*(m + q - 1) - c*d^2*(m + q + 2*p + 1) - 2*c*d*e*(m + q + p)*x), x], x] /; GtQ[q, 1] && NeQ[m + q + 2*p + 1, 0]] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[c*d^2 + a*e^2, 0] && Not[EqQ[d, 0] && True] && Not[ IGtQ[m, 0] && RationalQ[a, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_. + e_.*x_)^m_.*Pq_*(a_. + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := With[{q = Expon[Pq, x]}, Coeff[Pq, x, q]/e^q* Int[(d + e*x)^(m + q)*(a + b*x + c*x^2)^p, x] + 1/e^q* Int[(d + e*x)^m*(a + b*x + c*x^2)^p* ExpandToSum[e^q*Pq - Coeff[Pq, x, q]*(d + e*x)^q, x], x]] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[ IGtQ[m, 0] && RationalQ[a, b, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]
Int[(d_ + e_.*x_)^m_.*Pq_*(a_ + c_.*x_^2)^p_., x_Symbol] := With[{q = Expon[Pq, x]}, Coeff[Pq, x, q]/e^q*Int[(d + e*x)^(m + q)*(a + c*x^2)^p, x] + 1/e^q* Int[(d + e*x)^m*(a + c*x^2)^p* ExpandToSum[e^q*Pq - Coeff[Pq, x, q]*(d + e*x)^q, x], x]] /; FreeQ[{a, c, d, e, m, p}, x] && PolyQ[Pq, x] && NeQ[c*d^2 + a*e^2, 0] && Not[ IGtQ[m, 0] && RationalQ[a, c, d, e] && (IntegerQ[p] || ILtQ[p + 1/2, 0])]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.1 (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.1 (a+b x^2+c x^4)^p *)
(* Int[(a_+b_.*x_^2+c_.*x_^4)^p_,x_Symbol] := 1/c^p*Int[(b/2+c*x^2)^(2*p),x] /; FreeQ[{a,b,c,p},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)
(* Int[1/(a_+b_.*x_^2+c_.*x_^4)^(5/4),x_Symbol] := 2*x/(3*a*(a+b*x^2+c*x^4)^(1/4)) +  x*(2*a+b*x^2)/(6*a*(a+b*x^2+c*x^4)^(5/4)) /; FreeQ[{a,b,c},x] && EqQ[b^2-4*a*c,0] *)
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^p/(b + 2*c*x^2)^(2*p)* Int[(b + 2*c*x^2)^(2*p), x] /; FreeQ[{a, b, c, p}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p - 1/2]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^2 + c*x^4)^ FracPart[p]/(1 + 2*c*x^2/b)^(2*FracPart[p])* Int[(1 + 2*c*x^2/b)^(2*p), x] /; FreeQ[{a, b, c, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[2*p]]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := x*(a + b*x^2 + c*x^4)^p/(4*p + 1) + 2*p/(4*p + 1)*Int[(2*a + b*x^2)*(a + b*x^2 + c*x^4)^(p - 1), x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && IntegerQ[2*p]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := -x*(b^2 - 2*a*c + b*c*x^2)*(a + b*x^2 + c*x^4)^(p + 1)/(2* a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))* Int[(b^2 - 2*a*c + 2*(p + 1)*(b^2 - 4*a*c) + b*c*(4*p + 7)*x^2)*(a + b*x^2 + c*x^4)^(p + 1), x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && IntegerQ[2*p]
Int[1/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, c/q*Int[1/(b/2 - q/2 + c*x^2), x] - c/q*Int[1/(b/2 + q/2 + c*x^2), x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[b^2 - 4*a*c]
Int[1/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*q*r)*Int[(r - x)/(q - r*x + x^2), x] + 1/(2*c*q*r)*Int[(r + x)/(q + r*x + x^2), x]]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[b^2 - 4*a*c]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*Sqrt[-c]* Int[1/(Sqrt[b + q + 2*c*x^2]*Sqrt[-b + q - 2*c*x^2]), x]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 4]}, (1 + q^2*x^2)* Sqrt[(a + b*x^2 + c*x^4)/(a*(1 + q^2*x^2)^2)]/(2*q* Sqrt[a + b*x^2 + c*x^4])* EllipticF[2*ArcTan[q*x], 1/2 - b*q^2/(4*c)]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && GtQ[c/a, 0] && LtQ[b/a, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[-2*a - (b - q)*x^2]* Sqrt[(2*a + (b + q)*x^2)/q]/(2*Sqrt[-a]* Sqrt[a + b*x^2 + c*x^4])* EllipticF[ ArcSin[x/Sqrt[(2*a + (b + q)*x^2)/(2*q)]], (b + q)/(2*q)] /; IntegerQ[q]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[a, 0] && GtQ[c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[(2*a + (b - q)*x^2)/(2*a + (b + q)*x^2)]* Sqrt[(2*a + (b + q)*x^2)/q]/(2*Sqrt[a + b*x^2 + c*x^4]* Sqrt[a/(2*a + (b + q)*x^2)])* EllipticF[ ArcSin[x/Sqrt[(2*a + (b + q)*x^2)/(2*q)]], (b + q)/(2*q)]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[a, 0] && GtQ[c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*a + (b + q)*x^2)* Sqrt[(2*a + (b - q)*x^2)/(2*a + (b + q)*x^2)]/(2*a* Rt[(b + q)/(2*a), 2]*Sqrt[a + b*x^2 + c*x^4])* EllipticF[ArcTan[Rt[(b + q)/(2*a), 2]*x], 2*q/(b + q)] /; PosQ[(b + q)/a] && Not[PosQ[(b - q)/a] && SimplerSqrtQ[(b - q)/(2*a), (b + q)/(2*a)]]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*a + (b - q)*x^2)* Sqrt[(2*a + (b + q)*x^2)/(2*a + (b - q)*x^2)]/(2*a* Rt[(b - q)/(2*a), 2]*Sqrt[a + b*x^2 + c*x^4])* EllipticF[ArcTan[Rt[(b - q)/(2*a), 2]*x], -2*q/(b - q)] /; PosQ[(b - q)/a]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[1 + (b + q)*x^2/(2*a)]* Sqrt[1 + (b - q)*x^2/(2*a)]/(Rt[-(b + q)/(2*a), 2]* Sqrt[a + b*x^2 + c*x^4])* EllipticF[ArcSin[Rt[-(b + q)/(2*a), 2]*x], (b - q)/(b + q)] /; NegQ[(b + q)/a] && Not[NegQ[(b - q)/a] && SimplerSqrtQ[-(b - q)/(2*a), -(b + q)/(2*a)]]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[1 + (b - q)*x^2/(2*a)]* Sqrt[1 + (b + q)*x^2/(2*a)]/(Rt[-(b - q)/(2*a), 2]* Sqrt[a + b*x^2 + c*x^4])* EllipticF[ArcSin[Rt[-(b - q)/(2*a), 2]*x], (b + q)/(b - q)] /; NegQ[(b - q)/a]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 4]}, (1 + q^2*x^2)* Sqrt[(a + b*x^2 + c*x^4)/(a*(1 + q^2*x^2)^2)]/(2*q* Sqrt[a + b*x^2 + c*x^4])* EllipticF[2*ArcTan[q*x], 1/2 - b*q^2/(4*c)]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a]
Int[1/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[1 + 2*c*x^2/(b - q)]* Sqrt[1 + 2*c*x^2/(b + q)]/Sqrt[a + b*x^2 + c*x^4]* Int[1/(Sqrt[1 + 2*c*x^2/(b - q)]*Sqrt[1 + 2*c*x^2/(b + q)]), x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[c/a]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, a^IntPart[p]*(a + b*x^2 + c*x^4)^ FracPart[ p]/((1 + 2*c*x^2/(b + q))^FracPart[p]*(1 + 2*c*x^2/(b - q))^ FracPart[p])* Int[(1 + 2*c*x^2/(b + q))^p*(1 + 2*c*x^2/(b - q))^p, x]] /; FreeQ[{a, b, c, p}, x] && NeQ[b^2 - 4*a*c, 0]
Int[P4_^p_, x_Symbol] := With[{a = Coeff[P4, x, 0], b = Coeff[P4, x, 1], c = Coeff[P4, x, 2], d = Coeff[P4, x, 3], e = Coeff[P4, x, 4]}, Subst[ Int[SimplifyIntegrand[(a + d^4/(256*e^3) - b*d/(8*e) + (c - 3*d^2/(8*e))*x^2 + e*x^4)^p, x], x], x, d/(4*e) + x] /; EqQ[d^3 - 4*c*d*e + 8*b*e^2, 0] && NeQ[d, 0]] /; FreeQ[p, x] && PolyQ[P4, x, 4] && NeQ[p, 2] && NeQ[p, 3]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.2 (d x)^m (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.2 (d x)^m (a+b x^2+c x^4)^p *)
(* Int[(d_.*x_)^m_.*(b_.*x_^2+c_.*x_^4)^p_.,x_Symbol] := 1/d^(2*p)*Int[(d*x)^(m+2*p)*(b+c*x^2)^p,x] /; FreeQ[{b,c,d,m},x] && IntegerQ[p] *)
(* Int[(d_.*x_)^m_.*(b_.*x_^2+c_.*x_^4)^p_,x_Symbol] := (b*x^2+c*x^4)^p/((d*x)^(2*p)*(b+c*x^2)^p)*Int[(d*x)^(m+2*p)*(b+c*x^ 2)^p,x] /; FreeQ[{b,c,d,m,p},x] && Not[IntegerQ[p]] *)
Int[x_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[Int[(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, p}, x]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(d*x)^m*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p, 0] && Not[IntegerQ[(m + 1)/2]]
(* Int[(d_.*x_)^m_.*(a_+b_.*x_^2+c_.*x_^4)^p_.,x_Symbol] := 1/c^p*Int[(d*x)^m*(b/2+c*x^2)^(2*p),x] /; FreeQ[{a,b,c,d,m,p},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := 2*(d*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)/(d*(m + 3)*(2*a + b*x^2)) - (d*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)/(2*a* d*(m + 3)*(p + 1)) /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[m + 4*p + 5, 0] && LtQ[p, -1]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)/(4*a* d*(p + 1)*(2*p + 1)) - (d*x)^(m + 1)*(2*a + b*x^2)*(a + b*x^2 + c*x^4)^ p/(4*a*d*(2*p + 1)) /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[m + 4*p + 5, 0] && NeQ[p, -1/2]
Int[x_^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := 1/2*Subst[Int[x^((m - 1)/2)*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, p}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p - 1/2] && IntegerQ[(m - 1)/2] && (GtQ[m, 0] || LtQ[0, 4*p, -m - 1])
(* Int[(d_.*x_)^m_.*(a_+b_.*x_^2+c_.*x_^4)^p_,x_Symbol] := c*(a+b*x^2+c*x^4)^(p+1)/(b/2+c*x^2)^(2*(p+1))*Int[(d*x)^m*(b/2+c*x^ 2)^(2*p),x] /; FreeQ[{a,b,c,d,m,p},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p-1/2] &&  IGeQ[m,2*p] *)
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x^2)^(2*FracPart[p]))* Int[(d*x)^m*(b/2 + c*x^2)^(2*p), x] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p - 1/2]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^2 + c*x^4)^ FracPart[p]/(1 + 2*c*x^2/b)^(2*FracPart[p])* Int[(d*x)^m*(1 + 2*c*x^2/b)^(2*p), x] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[2*p]]
Int[x_^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[Int[x^((m - 1)/2)*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, p}, x] && IntegerQ[(m - 1)/2]
Int[(d_.*x_)^m_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{k = Denominator[m]}, k/d* Subst[Int[x^(k*(m + 1) - 1)*(a + b*x^(2*k)/d^2 + c*x^(4*k)/d^4)^p, x], x, (d*x)^(1/k)]] /; FreeQ[{a, b, c, d, p}, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[m] && IntegerQ[p]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := d*(d*x)^(m - 1)*(a + b*x^2 + c*x^4)^ p*(2*b*p + c*(m + 4*p - 1)*x^2)/(c*(m + 4*p + 1)*(m + 4*p - 1)) - 2*p*d^2/(c*(m + 4*p + 1)*(m + 4*p - 1))* Int[(d*x)^(m - 2)*(a + b*x^2 + c*x^4)^(p - 1)* Simp[a*b*(m - 1) - (2*a*c*(m + 4*p - 1) - b^2*(m + 2*p - 1))* x^2, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && GtQ[m, 1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^2 + c*x^4)^p/(d*(m + 1)) - 2*p/(d^2*(m + 1))* Int[(d*x)^(m + 2)*(b + 2*c*x^2)*(a + b*x^2 + c*x^4)^(p - 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && LtQ[m, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^2 + c*x^4)^p/(d*(m + 4*p + 1)) + 2*p/(m + 4*p + 1)* Int[(d*x)^m*(2*a + b*x^2)*(a + b*x^2 + c*x^4)^(p - 1), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[m + 4*p + 1, 0] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := d*(d*x)^(m - 1)*(b + 2*c*x^2)*(a + b*x^2 + c*x^4)^(p + 1)/(2*(p + 1)*(b^2 - 4*a*c)) - d^2/(2*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^(m - 2)*(b*(m - 1) + 2*c*(m + 4*p + 5)*x^2)*(a + b*x^2 + c*x^4)^(p + 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[m, 1] && LeQ[m, 3] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := -d^3*(d*x)^(m - 3)*(2*a + b*x^2)*(a + b*x^2 + c*x^4)^(p + 1)/(2*(p + 1)*(b^2 - 4*a*c)) + d^4/(2*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^(m - 4)*(2*a*(m - 3) + b*(m + 4*p + 3)*x^2)*(a + b*x^2 + c*x^4)^(p + 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[m, 3] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := -(d*x)^(m + 1)*(b^2 - 2*a*c + b*c*x^2)*(a + b*x^2 + c*x^4)^(p + 1)/(2*a* d*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^m*(a + b*x^2 + c*x^4)^(p + 1)* Simp[b^2*(m + 2*p + 3) - 2*a*c*(m + 4*p + 5) + b*c*(m + 4*p + 7)*x^2, x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := d^3*(d*x)^(m - 3)*(a + b*x^2 + c*x^4)^(p + 1)/(c*(m + 4*p + 1)) - d^4/(c*(m + 4*p + 1))* Int[(d*x)^(m - 4)* Simp[a*(m - 3) + b*(m + 2*p - 1)*x^2, x]*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, p}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[m, 3] && NeQ[m + 4*p + 1, 0] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)/(a*d*(m + 1)) - 1/(a*d^2*(m + 1))* Int[(d*x)^(m + 2)*(b*(m + 2*p + 3) + c*(m + 4*p + 5)*x^2)*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, p}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[m, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(d_.*x_)^m_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := (d*x)^(m + 1)/(a*d*(m + 1)) - 1/(a*d^2)*Int[(d*x)^(m + 2)*(b + c*x^2)/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[m, -1]
Int[x_^m_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[PolynomialDivide[x^m, (a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[m, 5]
Int[(d_.*x_)^m_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := d^3*(d*x)^(m - 3)/(c*(m - 3)) - d^4/c*Int[(d*x)^(m - 4)*(a + b*x^2)/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[m, 3]
Int[x_^2/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[a/c, 2]}, 1/2*Int[(q + x^2)/(a + b*x^2 + c*x^4), x] - 1/2*Int[(q - x^2)/(a + b*x^2 + c*x^4), x]] /; FreeQ[{a, b, c}, x] && LtQ[b^2 - 4*a*c, 0] && PosQ[a*c]
Int[x_^m_./(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*r)*Int[x^(m - 3)*(q + r*x)/(q + r*x + x^2), x] - 1/(2*c*r)*Int[x^(m - 3)*(q - r*x)/(q - r*x + x^2), x]]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && GeQ[m, 3] && LtQ[m, 4] && NegQ[b^2 - 4*a*c]
Int[x_^m_./(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*r)*Int[x^(m - 1)/(q - r*x + x^2), x] - 1/(2*c*r)*Int[x^(m - 1)/(q + r*x + x^2), x]]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && GeQ[m, 1] && LtQ[m, 3] && NegQ[b^2 - 4*a*c]
Int[(d_.*x_)^m_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, d^2/2*(b/q + 1)*Int[(d*x)^(m - 2)/(b/2 + q/2 + c*x^2), x] - d^2/2*(b/q - 1)*Int[(d*x)^(m - 2)/(b/2 - q/2 + c*x^2), x]] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - 4*a*c, 0] && GeQ[m, 2]
Int[(d_.*x_)^m_./(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, c/q*Int[(d*x)^m/(b/2 - q/2 + c*x^2), x] - c/q*Int[(d*x)^m/(b/2 + q/2 + c*x^2), x]] /; FreeQ[{a, b, c, d, m}, x] && NeQ[b^2 - 4*a*c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*Sqrt[-c]* Int[x^2/(Sqrt[b + q + 2*c*x^2]*Sqrt[-b + q - 2*c*x^2]), x]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 2]}, 1/q*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - 1/q*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && GtQ[c/a, 0] && LtQ[b/a, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -(b - q)/(2*c)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + 1/(2*c)*Int[(b - q + 2*c*x^2)/Sqrt[a + b*x^2 + c*x^4], x]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[a, 0] && GtQ[c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, x*(b + q + 2*c*x^2)/(2*c*Sqrt[a + b*x^2 + c*x^4]) - Rt[(b + q)/(2*a), 2]*(2*a + (b + q)*x^2)* Sqrt[(2*a + (b - q)*x^2)/(2*a + (b + q)*x^2)]/(2*c* Sqrt[a + b*x^2 + c*x^4])* EllipticE[ArcTan[Rt[(b + q)/(2*a), 2]*x], 2*q/(b + q)] /; PosQ[(b + q)/a] && Not[PosQ[(b - q)/a] && SimplerSqrtQ[(b - q)/(2*a), (b + q)/(2*a)]]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, x*(b - q + 2*c*x^2)/(2*c*Sqrt[a + b*x^2 + c*x^4]) - Rt[(b - q)/(2*a), 2]*(2*a + (b - q)*x^2)* Sqrt[(2*a + (b + q)*x^2)/(2*a + (b - q)*x^2)]/(2*c* Sqrt[a + b*x^2 + c*x^4])* EllipticE[ArcTan[Rt[(b - q)/(2*a), 2]*x], -2*q/(b - q)] /; PosQ[(b - q)/a]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -(b + q)/(2*c)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + 1/(2*c)*Int[(b + q + 2*c*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NegQ[(b + q)/a] && Not[NegQ[(b - q)/a] && SimplerSqrtQ[-(b - q)/(2*a), -(b + q)/(2*a)]]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -(b - q)/(2*c)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + 1/(2*c)*Int[(b - q + 2*c*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NegQ[(b - q)/a]] /; FreeQ[{a, b, c}, x] && GtQ[b^2 - 4*a*c, 0]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 2]}, 1/q*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - 1/q*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a]
Int[x_^2/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[1 + 2*c*x^2/(b - q)]* Sqrt[1 + 2*c*x^2/(b + q)]/Sqrt[a + b*x^2 + c*x^4]* Int[x^2/(Sqrt[1 + 2*c*x^2/(b - q)]*Sqrt[1 + 2*c*x^2/(b + q)]), x]] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[c/a]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^2 + c*x^4)^FracPart[p]/ ((1 + 2*c*x^2/(b + Rt[b^2 - 4*a*c, 2]))^ FracPart[p]*(1 + 2*c*x^2/(b - Rt[b^2 - 4*a*c, 2]))^FracPart[p])* Int[(d*x)^m*(1 + 2*c*x^2/(b + Sqrt[b^2 - 4*a*c]))^ p*(1 + 2*c*x^2/(b - Sqrt[b^2 - 4*a*c]))^p, x] /; FreeQ[{a, b, c, d, m, p}, x]
Int[u_^m_.*(a_. + b_.*v_^2 + c_.*v_^4)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(a + b*x^2 + c*x^(2*2))^p, x], x, v] /; FreeQ[{a, b, c, m, p}, x] && LinearPairQ[u, v, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.3 (d+e x^2)^q (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.3 (d+e x^2)^q (a+b x^2+c x^4)^p *)
Int[(d_ + e_.*x_^2)/(b_.*x_^2 + c_.*x_^4)^(3/4), x_Symbol] := -2*(c*d - b*e)*(b*x^2 + c*x^4)^(1/4)/(b*c*x) + e/c*Int[(b*x^2 + c*x^4)^(1/4)/x^2, x] /; FreeQ[{b, c, d, e}, x]
Int[(d_ + e_.*x_^2)*(b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := e*(b*x^2 + c*x^4)^(p + 1)/(c*(4*p + 3)*x) /; FreeQ[{b, c, d, e, p}, x] && Not[IntegerQ[p]] && NeQ[4*p + 3, 0] && EqQ[b*e*(2*p + 1) - c*d*(4*p + 3), 0]
Int[(d_ + e_.*x_^2)*(b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := e*(b*x^2 + c*x^4)^(p + 1)/(c*(4*p + 3)* x) - ((b*e*(2*p + 1) - c*d*(4*p + 3))/(c*(4*p + 3)))* Int[(b*x^2 + c*x^4)^p, x] /; FreeQ[{b, c, d, e, p}, x] && Not[IntegerQ[p]] && NeQ[4*p + 3, 0] && NeQ[b*e*(2*p + 1) - c*d*(4*p + 3), 0]
Int[(d_ + e_.*x_^2)^q_.*(b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (b*x^2 + c*x^4)^ FracPart[p]/(x^(2*FracPart[p])*(b + c*x^2)^FracPart[p])* Int[x^(2*p)*(d + e*x^2)^q*(b + c*x^2)^p, x] /; FreeQ[{b, c, d, e, p, q}, x] && Not[IntegerQ[p]]
(* Int[(d_+e_.*x_^2)^q_.*(a_+b_.*x_^2+c_.*x_^4)^p_.,x_Symbol] := 1/c^p*Int[(d+e*x^2)^q*(b/2+c*x^2)^(2*p),x] /; FreeQ[{a,b,c,d,e,p,q},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)
Int[(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^p/(d + e*x^2)^(2*p)* Int[(d + e*x^2)^(q + 2*p), x] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[2*c*d - b*e, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x^2)^(2*FracPart[p]))* Int[(d + e*x^2)^q*(b/2 + c*x^2)^(2*p), x] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, c, d, e, q}, x] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[ p]/((d + e*x^2)^FracPart[p]*(a/d + c*x^2/e)^FracPart[p])* Int[(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := (a + c*x^4)^ FracPart[ p]/((d + e*x^2)^FracPart[p]*(a/d + c*x^2/e)^FracPart[p])* Int[(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, c, d, e, p, q}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && IGtQ[q, -2]
Int[(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q*(a + c*x^4)^p, x], x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && IGtQ[q, -2]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := a^p*x*(d + e*x^2)^(q + 1)/d + 1/d* Int[x^2*(d + e*x^2)^ q*(d*PolynomialQuotient[(a + b*x^2 + c*x^4)^p - a^p, x^2, x] - e*a^p*(2*q + 3)), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && ILtQ[q + 1/2, 0] && LtQ[4*p + 2*q + 1, 0]
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := a^p*x*(d + e*x^2)^(q + 1)/d + 1/d* Int[x^2*(d + e*x^2)^ q*(d*PolynomialQuotient[(a + c*x^4)^p - a^p, x^2, x] - e*a^p*(2*q + 3)), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && ILtQ[q + 1/2, 0] && LtQ[4*p + 2*q + 1, 0]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + b*x^2 + c*x^4)^p, d + e*x^2, x], R = Coeff[ PolynomialRemainder[(a + b*x^2 + c*x^4)^p, d + e*x^2, x], x, 0]}, -R*x*(d + e*x^2)^(q + 1)/(2*d*(q + 1)) + 1/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)* ExpandToSum[2*d*(q + 1)*Qx + R*(2*q + 3), x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && LtQ[q, -1]
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + c*x^4)^p, d + e*x^2, x], R = Coeff[PolynomialRemainder[(a + c*x^4)^p, d + e*x^2, x], x, 0]}, -R*x*(d + e*x^2)^(q + 1)/(2*d*(q + 1)) + 1/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)* ExpandToSum[2*d*(q + 1)*Qx + R*(2*q + 3), x], x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && LtQ[q, -1]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := c^p*x^(4*p - 1)*(d + e*x^2)^(q + 1)/(e*(4*p + 2*q + 1)) + 1/(e*(4*p + 2*q + 1))* Int[(d + e*x^2)^q* ExpandToSum[ e*(4*p + 2*q + 1)*(a + b*x^2 + c*x^4)^p - d*c^p*(4*p - 1)*x^(4*p - 2) - e*c^p*(4*p + 2*q + 1)*x^(4*p), x], x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p, 0] && Not[LtQ[q, -1]]
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := c^p*x^(4*p - 1)*(d + e*x^2)^(q + 1)/(e*(4*p + 2*q + 1)) + 1/(e*(4*p + 2*q + 1))* Int[(d + e*x^2)^q* ExpandToSum[ e*(4*p + 2*q + 1)*(a + c*x^4)^p - d*c^p*(4*p - 1)*x^(4*p - 2) - e*c^p*(4*p + 2*q + 1)*x^(4*p), x], x] /; FreeQ[{a, c, d, e, q}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p, 0] && Not[LtQ[q, -1]]
Int[(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[2*d/e - b/c, 2]}, e/(2*c)*Int[1/Simp[d/e + q*x + x^2, x], x] + e/(2*c)*Int[1/Simp[d/e - q*x + x^2, x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && (GtQ[2*d/e - b/c, 0] || Not[LtQ[2*d/e - b/c, 0]] && EqQ[d - e*Rt[a/c, 2], 0])
Int[(d_ + e_.*x_^2)/(a_ + c_.*x_^4), x_Symbol] := With[{q = Rt[2*d/e, 2]}, e/(2*c)*Int[1/Simp[d/e + q*x + x^2, x], x] + e/(2*c)*Int[1/Simp[d/e - q*x + x^2, x], x]] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 - a*e^2, 0] && PosQ[d*e]
Int[(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (e/2 + (2*c*d - b*e)/(2*q))* Int[1/(b/2 - q/2 + c*x^2), x] + (e/2 - (2*c*d - b*e)/(2*q))* Int[1/(b/2 + q/2 + c*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[-2*d/e - b/c, 2]}, e/(2*c*q)*Int[(q - 2*x)/Simp[d/e + q*x - x^2, x], x] + e/(2*c*q)*Int[(q + 2*x)/Simp[d/e - q*x - x^2, x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && Not[GtQ[b^2 - 4*a*c, 0]]
Int[(d_ + e_.*x_^2)/(a_ + c_.*x_^4), x_Symbol] := With[{q = Rt[-2*d/e, 2]}, e/(2*c*q)*Int[(q - 2*x)/Simp[d/e + q*x - x^2, x], x] + e/(2*c*q)*Int[(q + 2*x)/Simp[d/e - q*x - x^2, x], x]] /; FreeQ[{a, c, d, e}, x] && EqQ[c*d^2 - a*e^2, 0] && NegQ[d*e]
Int[(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (e/2 + (2*c*d - b*e)/(2*q))* Int[1/(b/2 - q/2 + c*x^2), x] + (e/2 - (2*c*d - b*e)/(2*q))* Int[1/(b/2 + q/2 + c*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[b^2 - 4*a*c]
Int[(d_ + e_.*x_^2)/(a_ + c_.*x_^4), x_Symbol] := With[{q = Rt[-a*c, 2]}, (e/2 + c*d/(2*q))*Int[1/(-q + c*x^2), x] + (e/2 - c*d/(2*q))* Int[1/(q + c*x^2), x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 - a*e^2, 0] && PosQ[-a*c]
Int[(d_ + e_.*x_^2)/(a_ + c_.*x_^4), x_Symbol] := With[{q = Rt[a*c, 2]}, (d*q + a*e)/(2*a*c)* Int[(q + c*x^2)/(a + c*x^4), x] + (d*q - a*e)/(2*a*c)* Int[(q - c*x^2)/(a + c*x^4), x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && NegQ[-a*c]
Int[(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*q*r)*Int[(d*r - (d - e*q)*x)/(q - r*x + x^2), x] + 1/(2*c*q*r)*Int[(d*r + (d - e*q)*x)/(q + r*x + x^2), x]]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NegQ[b^2 - 4*a*c]
Int[(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q/(a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[q]
Int[(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q/(a + c*x^4), x], x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[q]
Int[(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := e^2/(c*d^2 - b*d*e + a*e^2)*Int[(d + e*x^2)^q, x] + 1/(c*d^2 - b*d*e + a*e^2)* Int[(d + e*x^2)^(q + 1)*(c*d - b*e - c*e*x^2)/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := e^2/(c*d^2 + a*e^2)*Int[(d + e*x^2)^q, x] + c/(c*d^2 + a*e^2)* Int[(d + e*x^2)^(q + 1)*(d - e*x^2)/(a + c*x^4), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{r = Rt[b^2 - 4*a*c, 2]}, 2*c/r*Int[(d + e*x^2)^q/(b - r + 2*c*x^2), x] - 2*c/r*Int[(d + e*x^2)^q/(b + r + 2*c*x^2), x]] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[q]]
Int[(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := With[{r = Rt[-a*c, 2]}, -c/(2*r)*Int[(d + e*x^2)^q/(r - c*x^2), x] - c/(2*r)*Int[(d + e*x^2)^q/(r + c*x^2), x]] /; FreeQ[{a, c, d, e, q}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[q]]
Int[(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := x*(2*b*e*p + c*d*(4*p + 3) + c*e*(4*p + 1)*x^2)*(a + b*x^2 + c*x^4)^ p/(c*(4*p + 1)*(4*p + 3)) + 2*p/(c*(4*p + 1)*(4*p + 3))* Int[Simp[ 2*a*c*d*(4*p + 3) - a*b*e + (2*a*c*e*(4*p + 1) + b*c*d*(4*p + 3) - b^2*e*(2*p + 1))*x^2, x]* (a + b*x^2 + c*x^4)^(p - 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && GtQ[p, 0] && FractionQ[p] && IntegerQ[2*p]
Int[(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_, x_Symbol] := x*(d*(4*p + 3) + e*(4*p + 1)*x^2)*(a + c*x^4)^ p/((4*p + 1)*(4*p + 3)) + 2*p/((4*p + 1)*(4*p + 3))* Int[Simp[2*a*d*(4*p + 3) + (2*a*e*(4*p + 1))*x^2, x]*(a + c*x^4)^(p - 1), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && GtQ[p, 0] && FractionQ[p] && IntegerQ[2*p]
Int[(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := x*(a*b*e - d*(b^2 - 2*a*c) - c*(b*d - 2*a*e)*x^2)*(a + b*x^2 + c*x^4)^(p + 1)/(2* a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))* Int[Simp[(2*p + 3)*d*b^2 - a*b*e - 2*a*c*d*(4*p + 5) + (4*p + 7)*(d*b - 2*a*e)*c*x^2, x]* (a + b*x^2 + c*x^4)^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[p, -1] && IntegerQ[2*p]
Int[(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_, x_Symbol] := -x*(d + e*x^2)*(a + c*x^4)^(p + 1)/(4*a*(p + 1)) + 1/(4*a*(p + 1))* Int[Simp[d*(4*p + 5) + e*(4*p + 7)*x^2, x]*(a + c*x^4)^(p + 1), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && LtQ[p, -1] && IntegerQ[2*p]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*Sqrt[-c]* Int[(d + e*x^2)/(Sqrt[b + q + 2*c*x^2]*Sqrt[-b + q - 2*c*x^2]), x]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[-a*c, 2]}, Sqrt[-c]*Int[(d + e*x^2)/(Sqrt[q + c*x^2]*Sqrt[q - c*x^2]), x]] /; FreeQ[{a, c, d, e}, x] && GtQ[a, 0] && LtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 4]}, -d*x*Sqrt[a + b*x^2 + c*x^4]/(a*(1 + q^2*x^2)) + d*(1 + q^2*x^2)* Sqrt[(a + b*x^2 + c*x^4)/(a*(1 + q^2*x^2)^2)]/(q* Sqrt[a + b*x^2 + c*x^4])* EllipticE[2*ArcTan[q*x], 1/2 - b*q^2/(4*c)] /; EqQ[e + d*q^2, 0]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && GtQ[c/a, 0] && LtQ[b/a, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 2]}, (e + d*q)/q*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - e/q*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NeQ[e + d*q, 0]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && GtQ[c/a, 0] && LtQ[b/a, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, e*x*(b + q + 2*c*x^2)/(2*c*Sqrt[a + b*x^2 + c*x^4]) - e*q*Sqrt[(2*a + (b - q)*x^2)/(2*a + (b + q)*x^2)]* Sqrt[(2*a + (b + q)*x^2)/q]/(2*c*Sqrt[a + b*x^2 + c*x^4]* Sqrt[a/(2*a + (b + q)*x^2)])* EllipticE[ ArcSin[x/Sqrt[(2*a + (b + q)*x^2)/(2*q)]], (b + q)/(2*q)] /; EqQ[2*c*d - e*(b - q), 0]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[a, 0] && GtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[-a*c, 2]}, e*x*(q + c*x^2)/(c*Sqrt[a + c*x^4]) - Sqrt[2]*e*q*Sqrt[-a + q*x^2]* Sqrt[(a + q*x^2)/q]/(Sqrt[-a]*c*Sqrt[a + c*x^4])* EllipticE[ArcSin[x/Sqrt[(a + q*x^2)/(2*q)]], 1/2] /; EqQ[c*d + e*q, 0] && IntegerQ[q]] /; FreeQ[{a, c, d, e}, x] && LtQ[a, 0] && GtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[-a*c, 2]}, e*x*(q + c*x^2)/(c*Sqrt[a + c*x^4]) - Sqrt[2]*e*q*Sqrt[(a - q*x^2)/(a + q*x^2)]* Sqrt[(a + q*x^2)/q]/(c*Sqrt[a + c*x^4]*Sqrt[a/(a + q*x^2)])* EllipticE[ArcSin[x/Sqrt[(a + q*x^2)/(2*q)]], 1/2] /; EqQ[c*d + e*q, 0]] /; FreeQ[{a, c, d, e}, x] && LtQ[a, 0] && GtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*c*d - e*(b - q))/(2*c)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + e/(2*c)*Int[(b - q + 2*c*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NeQ[2*c*d - e*(b - q), 0]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[a, 0] && GtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[-a*c, 2]}, (c*d + e*q)/c*Int[1/Sqrt[a + c*x^4], x] - e/c*Int[(q - c*x^2)/Sqrt[a + c*x^4], x] /; NeQ[c*d + e*q, 0]] /; FreeQ[{a, c, d, e}, x] && LtQ[a, 0] && GtQ[c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, d*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + e*Int[x^2/Sqrt[a + b*x^2 + c*x^4], x] /; PosQ[(b + q)/a] || PosQ[(b - q)/a]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := d*Int[1/Sqrt[a + c*x^4], x] + e*Int[x^2/Sqrt[a + c*x^4], x] /; FreeQ[{a, c, d, e}, x] && GtQ[-a*c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -a*e*Rt[-(b + q)/(2*a), 2]*Sqrt[1 + (b + q)*x^2/(2*a)]* Sqrt[1 + (b - q)*x^2/(2*a)]/(c*Sqrt[a + b*x^2 + c*x^4])* EllipticE[ArcSin[Rt[-(b + q)/(2*a), 2]*x], (b - q)/(b + q)] /; NegQ[(b + q)/a] && EqQ[2*c*d - e*(b + q), 0] && Not[SimplerSqrtQ[-(b - q)/(2*a), -(b + q)/(2*a)]]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*c*d - e*(b + q))/(2*c)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + e/(2*c)*Int[(b + q + 2*c*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NegQ[(b + q)/a] && NeQ[2*c*d - e*(b + q), 0] && Not[SimplerSqrtQ[-(b - q)/(2*a), -(b + q)/(2*a)]]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, -a*e*Rt[-(b - q)/(2*a), 2]*Sqrt[1 + (b - q)*x^2/(2*a)]* Sqrt[1 + (b + q)*x^2/(2*a)]/(c*Sqrt[a + b*x^2 + c*x^4])* EllipticE[ArcSin[Rt[-(b - q)/(2*a), 2]*x], (b + q)/(b - q)] /; NegQ[(b - q)/a] && EqQ[2*c*d - e*(b - q), 0]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (2*c*d - e*(b - q))/(2*c)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + e/(2*c)*Int[(b - q + 2*c*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NegQ[(b - q)/a] && NeQ[2*c*d - e*(b - q), 0]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 4]}, -d*x*Sqrt[a + b*x^2 + c*x^4]/(a*(1 + q^2*x^2)) + d*(1 + q^2*x^2)* Sqrt[(a + b*x^2 + c*x^4)/(a*(1 + q^2*x^2)^2)]/(q* Sqrt[a + b*x^2 + c*x^4])* EllipticE[2*ArcTan[q*x], 1/2 - b*q^2/(4*c)] /; EqQ[e + d*q^2, 0]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 4]}, -d*x*Sqrt[a + c*x^4]/(a*(1 + q^2*x^2)) + d*(1 + q^2*x^2)* Sqrt[(a + c*x^4)/(a*(1 + q^2*x^2)^2)]/(q*Sqrt[a + c*x^4])* EllipticE[2*ArcTan[q*x], 1/2] /; EqQ[e + d*q^2, 0]] /; FreeQ[{a, c, d, e}, x] && PosQ[c/a]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 2]}, (e + d*q)/q*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - e/q*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x] /; NeQ[e + d*q, 0]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[c/a, 2]}, (e + d*q)/q*Int[1/Sqrt[a + c*x^4], x] - e/q*Int[(1 - q*x^2)/Sqrt[a + c*x^4], x] /; NeQ[e + d*q, 0]] /; FreeQ[{a, c, d, e}, x] && PosQ[c/a]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := d/Sqrt[a]*Int[Sqrt[1 + e*x^2/d]/Sqrt[1 - e*x^2/d], x] /; FreeQ[{a, c, d, e}, x] && NegQ[c/a] && EqQ[c*d^2 + a*e^2, 0] && GtQ[a, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := Sqrt[1 + c*x^4/a]/Sqrt[a + c*x^4]* Int[(d + e*x^2)/Sqrt[1 + c*x^4/a], x] /; FreeQ[{a, c, d, e}, x] && NegQ[c/a] && EqQ[c*d^2 + a*e^2, 0] && Not[GtQ[a, 0]]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{q = Rt[-c/a, 2]}, (d*q - e)/q*Int[1/Sqrt[a + c*x^4], x] + e/q*Int[(1 + q*x^2)/Sqrt[a + c*x^4], x]] /; FreeQ[{a, c, d, e}, x] && NegQ[c/a] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_ + e_.*x_^2)/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[1 + 2*c*x^2/(b - q)]* Sqrt[1 + 2*c*x^2/(b + q)]/Sqrt[a + b*x^2 + c*x^4]* Int[(d + e*x^2)/(Sqrt[1 + 2*c*x^2/(b - q)]* Sqrt[1 + 2*c*x^2/(b + q)]), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[c/a]
Int[(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)*(a + c*x^4)^p, x], x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
(* Int[(d_+e_.*x_^2)^2/Sqrt[a_+b_.*x_^2+c_.*x_^4],x_Symbol] := e^2*x*Sqrt[a+b*x^2+c*x^4]/(3*c) + 2*(3*c*d-b*e)/(3*c)*Int[(d+e*x^2)/Sqrt[a+b*x^2+c*x^4],x] - (3*c*d^2-2*b*d*e+a*e^2)/(3*c)*Int[1/Sqrt[a+b*x^2+c*x^4],x] /; FreeQ[{a,b,c,d,e},x] && NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] *)
(* Int[(d_+e_.*x_^2)^2/Sqrt[a_+c_.*x_^4],x_Symbol] := e^2*x*Sqrt[a+c*x^4]/(3*c) + 2*d*Int[(d+e*x^2)/Sqrt[a+c*x^4],x] - (3*c*d^2+a*e^2)/(3*c)*Int[1/Sqrt[a+c*x^4],x] /; FreeQ[{a,c,d,e},x] && NeQ[c*d^2+a*e^2,0] *)
(* Int[(d_+e_.*x_^2)^q_/Sqrt[a_+b_.*x_^2+c_.*x_^4],x_Symbol] := e^2*x*(d+e*x^2)^(q-2)*Sqrt[a+b*x^2+c*x^4]/(c*(2*q-1)) + 2*(q-1)*(3*c*d-b*e)/(c*(2*q-1))*Int[(d+e*x^2)^(q-1)/Sqrt[a+b*x^2+c* x^4],x] - (2*q-3)*(3*c*d^2-2*b*d*e+a*e^2)/(c*(2*q-1))*Int[(d+e*x^2)^(q-2)/ Sqrt[a+b*x^2+c*x^4],x] + 2*d*(q-2)*(c*d^2-b*d*e+a*e^2)/(c*(2*q-1))*Int[(d+e*x^2)^(q-3)/Sqrt[ a+b*x^2+c*x^4],x] /; FreeQ[{a,b,c,d,e},x] && NeQ[b^2-4*a*c,0] && IGtQ[q,2] *)
(* Int[(d_+e_.*x_^2)^q_/Sqrt[a_+c_.*x_^4],x_Symbol] := e^2*x*(d+e*x^2)^(q-2)*Sqrt[a+c*x^4]/(c*(2*q-1)) + 6*d*(q-1)/(2*q-1)*Int[(d+e*x^2)^(q-1)/Sqrt[a+c*x^4],x] - (2*q-3)*(3*c*d^2+a*e^2)/(c*(2*q-1))*Int[(d+e*x^2)^(q-2)/Sqrt[a+c*x^ 4],x] + 2*d*(q-2)*(c*d^2+a*e^2)/(c*(2*q-1))*Int[(d+e*x^2)^(q-3)/Sqrt[a+c*x^ 4],x] /; FreeQ[{a,c,d,e},x] && IGtQ[q,2] *)
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{f = Coeff[PolynomialRemainder[(d + e*x^2)^q, a + b*x^2 + c*x^4, x], x, 0], g = Coeff[ PolynomialRemainder[(d + e*x^2)^q, a + b*x^2 + c*x^4, x], x, 2]}, x*(a + b*x^2 + c*x^4)^(p + 1)*(a*b*g - f*(b^2 - 2*a*c) - c*(b*f - 2*a*g)*x^2)/(2*a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))*Int[(a + b*x^2 + c*x^4)^(p + 1)* ExpandToSum[ 2*a*(p + 1)*(b^2 - 4*a*c)* PolynomialQuotient[(d + e*x^2)^q, a + b*x^2 + c*x^4, x] + b^2*f*(2*p + 3) - 2*a*c*f*(4*p + 5) - a*b*g + c*(4*p + 7)*(b*f - 2*a*g)*x^2, x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[q, 1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := e^q*x^(2*q - 3)*(a + b*x^2 + c*x^4)^(p + 1)/(c*(4*p + 2*q + 1)) + 1/(c*(4*p + 2*q + 1))*Int[(a + b*x^2 + c*x^4)^p* ExpandToSum[ c*(4*p + 2*q + 1)*(d + e*x^2)^q - a*(2*q - 3)*e^q*x^(2*q - 4) - b*(2*p + 2*q - 1)*e^q*x^(2*q - 2) - c*(4*p + 2*q + 1)*e^q*x^(2*q), x], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[q, 1]
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := e^q*x^(2*q - 3)*(a + c*x^4)^(p + 1)/(c*(4*p + 2*q + 1)) + 1/(c*(4*p + 2*q + 1))*Int[(a + c*x^4)^p* ExpandToSum[ c*(4*p + 2*q + 1)*(d + e*x^2)^q - a*(2*q - 3)*e^q*x^(2*q - 4) - c*(4*p + 2*q + 1)*e^q*x^(2*q), x], x] /; FreeQ[{a, c, d, e, p}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[q, 1]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_/(d_ + e_.*x_^2), x_Symbol] := -1/e^2* Int[(c*d - b*e - c*e*x^2)*(a + b*x^2 + c*x^4)^(p - 1), x] + (c*d^2 - b*d*e + a*e^2)/e^2* Int[(a + b*x^2 + c*x^4)^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[p + 1/2, 0]
Int[(a_ + c_.*x_^4)^p_/(d_ + e_.*x_^2), x_Symbol] := -1/e^2*Int[(c*d - c*e*x^2)*(a + c*x^4)^(p - 1), x] + (c*d^2 + a*e^2)/e^2*Int[(a + c*x^4)^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[p + 1/2, 0]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := 1/(2*d)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + 1/(2*d)*Int[(d - e*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := 1/(2*d)*Int[1/Sqrt[a + c*x^4], x] + 1/(2*d)*Int[(d - e*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*Sqrt[-c]* Int[1/((d + e*x^2)*Sqrt[b + q + 2*c*x^2]*Sqrt[-b + q - 2*c*x^2]), x]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && LtQ[c, 0]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[-a*c, 2]}, Sqrt[-c]* Int[1/((d + e*x^2)*Sqrt[q + c*x^2]*Sqrt[q - c*x^2]), x]] /; FreeQ[{a, c, d, e}, x] && GtQ[a, 0] && LtQ[c, 0]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/(2*c*d - e*(b - q))*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - e/(2*c*d - e*(b - q))* Int[(b - q + 2*c*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && GtQ[b^2 - 4*a*c, 0] && Not[LtQ[c, 0]]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[-a*c, 2]}, c/(c*d + e*q)*Int[1/Sqrt[a + c*x^4], x] + e/(c*d + e*q)*Int[(q - c*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && GtQ[-a*c, 0] && Not[LtQ[c, 0]]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, (c*d + a*e*q)/(c*d^2 - a*e^2)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - (a*e*(e + d*q))/(c*d^2 - a*e^2)* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, (c*d + a*e*q)/(c*d^2 - a*e^2)*Int[1/Sqrt[a + c*x^4], x] - (a*e*(e + d*q))/(c*d^2 - a*e^2)* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[-c/a, 4]}, 1/(d*Sqrt[a]*q)*EllipticPi[-e/(d*q^2), ArcSin[q*x], -1]] /; FreeQ[{a, c, d, e}, x] && NegQ[c/a] && GtQ[a, 0]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := Sqrt[1 + c*x^4/a]/Sqrt[a + c*x^4]* Int[1/((d + e*x^2)*Sqrt[1 + c*x^4/a]), x] /; FreeQ[{a, c, d, e}, x] && NegQ[c/a] && Not[GtQ[a, 0]]
Int[1/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, Sqrt[1 + 2*c*x^2/(b - q)]* Sqrt[1 + 2*c*x^2/(b + q)]/Sqrt[a + b*x^2 + c*x^4]* Int[ 1/((d + e*x^2)*Sqrt[1 + 2*c*x^2/(b - q)]* Sqrt[1 + 2*c*x^2/(b + q)]), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NegQ[c/a]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_/(d_ + e_.*x_^2), x_Symbol] := 1/(c*d^2 - b*d*e + a*e^2)* Int[(c*d - b*e - c*e*x^2)*(a + b*x^2 + c*x^4)^p, x] + e^2/(c*d^2 - b*d*e + a*e^2)* Int[(a + b*x^2 + c*x^4)^(p + 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[p + 1/2, 0]
Int[(a_ + c_.*x_^4)^p_/(d_ + e_.*x_^2), x_Symbol] := 1/(c*d^2 + a*e^2)*Int[(c*d - c*e*x^2)*(a + c*x^4)^p, x] + e^2/(c*d^2 + a*e^2)*Int[(a + c*x^4)^(p + 1)/(d + e*x^2), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && ILtQ[p + 1/2, 0]
Int[(d_ + e_.*x_^2)^q_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := -e^2*x*(d + e*x^2)^(q + 1)* Sqrt[a + b*x^2 + c*x^4]/(2*d*(q + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/(2*d*(q + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x^2)^(q + 1)/Sqrt[a + b*x^2 + c*x^4]* Simp[a*e^2*(2*q + 3) + 2*d*(c*d - b*e)*(q + 1) - 2*e*(c*d*(q + 1) - b*e*(q + 2))*x^2 + c*e^2*(2*q + 5)*x^4, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[q, -1]
Int[(d_ + e_.*x_^2)^q_/Sqrt[a_ + c_.*x_^4], x_Symbol] := -e^2*x*(d + e*x^2)^(q + 1)* Sqrt[a + c*x^4]/(2*d*(q + 1)*(c*d^2 + a*e^2)) + 1/(2*d*(q + 1)*(c*d^2 + a*e^2))* Int[(d + e*x^2)^(q + 1)/Sqrt[a + c*x^4]* Simp[a*e^2*(2*q + 3) + 2*c*d^2*(q + 1) - 2*e*c*d*(q + 1)*x^2 + c*e^2*(2*q + 5)*x^4, x], x] /; FreeQ[{a, c, d, e}, x] && ILtQ[q, -1]
Int[Sqrt[a_ + b_.*x_^2 + c_.*x_^4]/(d_ + e_.*x_^2)^2, x_Symbol] := With[{q = Rt[e/d, 2]}, c*(d + e*x^2)* Sqrt[(e^2*(a + b*x^2 + c*x^4))/(c*(d + e*x^2)^2)]/(2*d*e^2*q* Sqrt[a + b*x^2 + c*x^4])* EllipticE[2*ArcTan[q*x], (2*c*d - b*e)/(4*c*d)]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0] && PosQ[e/d]
Int[Sqrt[a_ + b_.*x_^2 + c_.*x_^4]/(d_ + e_.*x_^2)^2, x_Symbol] := x*Sqrt[a + b*x^2 + c*x^4]/(2*d*(d + e*x^2)) + c/(2*d*e^2)*Int[(d - e*x^2)/Sqrt[a + b*x^2 + c*x^4], x] - (c*d^2 - a*e^2)/(2*d*e^2)* Int[1/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Sqrt[a_ + c_.*x_^4]/(d_ + e_.*x_^2)^2, x_Symbol] := x*Sqrt[a + c*x^4]/(2*d*(d + e*x^2)) + c/(2*d*e^2)*Int[(d - e*x^2)/Sqrt[a + c*x^4], x] - (c*d^2 - a*e^2)/(2*d*e^2)* Int[1/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Module[{aa, bb, cc}, Int[ ReplaceAll[ ExpandIntegrand[ 1/Sqrt[aa + bb*x^2 + cc*x^4], (d + e*x^2)^ q*(aa + bb*x^2 + cc*x^4)^(p + 1/2), x], {aa -> a, bb -> b, cc -> c}], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[q, 0] && IntegerQ[p + 1/2]
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := Module[{aa, cc}, Int[ ReplaceAll[ ExpandIntegrand[ 1/Sqrt[aa + cc*x^4], (d + e*x^2)^q*(aa + cc*x^4)^(p + 1/2), x], {aa -> a, cc -> c}], x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && ILtQ[q, 0] && IntegerQ[p + 1/2]
Int[1/(Sqrt[d_ + e_.*x_^2]*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := 1/(2*Sqrt[a]*Sqrt[d]*Rt[-e/d, 2])* EllipticF[2*ArcSin[Rt[-e/d, 2]*x], b*d/(4*a*e)] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c*d - b*e, 0] && GtQ[a, 0] && GtQ[d, 0]
Int[1/(Sqrt[d_ + e_.*x_^2]*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := Sqrt[(d + e*x^2)/d]* Sqrt[(a + b*x^2 + c*x^4)/a]/(Sqrt[d + e*x^2]* Sqrt[a + b*x^2 + c*x^4])* Int[1/(Sqrt[1 + e/d*x^2]*Sqrt[1 + b/a*x^2 + c/a*x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c*d - b*e, 0] && Not[GtQ[a, 0] && GtQ[d, 0]]
Int[1/(Sqrt[d_ + e_.*x_^2]*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := x^3*Sqrt[e + d/x^2]* Sqrt[c + b/x^2 + a/x^4]/(Sqrt[d + e*x^2]*Sqrt[a + b*x^2 + c*x^4])* Int[1/(x^3*Sqrt[e + d/x^2]*Sqrt[c + b/x^2 + a/x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[1/(Sqrt[d_ + e_.*x_^2]*Sqrt[a_ + c_.*x_^4]), x_Symbol] := x^3*Sqrt[e + d/x^2]* Sqrt[c + a/x^4]/(Sqrt[d + e*x^2]*Sqrt[a + c*x^4])* Int[1/(x^3*Sqrt[e + d/x^2]*Sqrt[c + a/x^4]), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[Sqrt[a_ + b_.*x_^2 + c_.*x_^4]/Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[a]/(2*Sqrt[d]*Rt[-e/d, 2])* EllipticE[2*ArcSin[Rt[-e/d, 2]*x], b*d/(4*a*e)] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c*d - b*e, 0] && GtQ[a, 0] && GtQ[d, 0]
Int[Sqrt[a_ + b_.*x_^2 + c_.*x_^4]/Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2 + c*x^4]* Sqrt[(d + e*x^2)/d]/(Sqrt[d + e*x^2]*Sqrt[(a + b*x^2 + c*x^4)/a])* Int[Sqrt[1 + b/a*x^2 + c/a*x^4]/Sqrt[1 + e/d*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c*d - b*e, 0] && Not[GtQ[a, 0] && GtQ[d, 0]]
Int[Sqrt[a_ + b_.*x_^2 + c_.*x_^4]/Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[e + d/x^2]* Sqrt[a + b*x^2 + c*x^4]/(x*Sqrt[d + e*x^2]*Sqrt[c + b/x^2 + a/x^4])* Int[(x*Sqrt[c + b/x^2 + a/x^4])/Sqrt[e + d/x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Sqrt[a_ + c_.*x_^4]/Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[e + d/x^2]*Sqrt[a + c*x^4]/(x*Sqrt[d + e*x^2]*Sqrt[c + a/x^4])* Int[(x*Sqrt[c + a/x^4])/Sqrt[e + d/x^2], x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, e, p, q}, x] && NeQ[b^2 - 4*a*c, 0] && (IntegerQ[p] && IntegerQ[q] || IGtQ[p, 0] || IGtQ[q, 0])
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q*(a + c*x^4)^p, x], x] /; FreeQ[{a, c, d, e, p, q}, x] && (IntegerQ[p] && IntegerQ[q] || IGtQ[p, 0])
Int[(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[(a + c*x^4)^ p, (d/(d^2 - e^2*x^4) - e*x^2/(d^2 - e^2*x^4))^(-q), x], x] /; FreeQ[{a, c, d, e, p}, x] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Unintegrable[(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, e, p, q}, x]
Int[(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Unintegrable[(d + e*x^2)^q*(a + c*x^4)^p, x] /; FreeQ[{a, c, d, e, p, q}, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.4 (f x)^m (d+e x^2)^q (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.4 (f x)^m (d+e x^2)^q (a+b x^2+c x^4)^p *)
(* Int[(f_.*x_)^m_.*(e_.*x_^2)^q_.*(a_+b_.*x_^2+c_.*x_^4)^p_.,x_ Symbol] := e^q/f^(2*q)*Int[(f*x)^(m+2*q)*(a+b*x^2+c*x^4)^p,x] /; FreeQ[{a,b,c,e,f,m,p},x] && IntegerQ[q] *)
(* Int[(f_.*x_)^m_.*(e_.*x_^2)^q_.*(a_+c_.*x_^4)^p_.,x_Symbol] := e^q/f^(2*q)*Int[(f*x)^(m+2*q)*(a+c*x^4)^p,x] /; FreeQ[{a,c,e,f,m,p},x] && IntegerQ[q] *)
Int[x_^m_.*(e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := 1/(2*e^((m - 1)/2))* Subst[Int[(e*x)^(q + (m - 1)/2)*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, e, p, q}, x] && Not[IntegerQ[q]] && IntegerQ[(m - 1)/2]
Int[x_^m_.*(e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := 1/(2*e^((m - 1)/2))* Subst[Int[(e*x)^(q + (m - 1)/2)*(a + c*x^2)^p, x], x, x^2] /; FreeQ[{a, c, e, p, q}, x] && Not[IntegerQ[q]] && IntegerQ[(m - 1)/2]
Int[(f_.*x_)^m_.*(e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := e^IntPart[q]*(e*x^2)^ FracPart[q]/(f^(2*IntPart[q])*(f*x)^(2*FracPart[q]))* Int[(f*x)^(m + 2*q)*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, e, f, m, p, q}, x] && Not[IntegerQ[q]]
Int[(f_.*x_)^m_.*(e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := e^IntPart[q]*(e*x^2)^ FracPart[q]/(f^(2*IntPart[q])*(f*x)^(2*FracPart[q]))* Int[(f*x)^(m + 2*q)*(a + c*x^4)^p, x] /; FreeQ[{a, c, e, f, m, p, q}, x] && Not[IntegerQ[q]]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[Int[(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, d, e, p, q}, x]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[Int[(d + e*x)^q*(a + c*x^2)^p, x], x, x^2] /; FreeQ[{a, c, d, e, p, q}, x]
(* Int[(f_.*x_)^m_.*(d_+e_.*x_^2)^q_.*(a_+b_.*x_^2+c_.*x_^4)^p_.,x_ Symbol] := 1/c^p*Int[(f*x)^m*(d+e*x^2)^q*(b/2+c*x^2)^(2*p),x] /; FreeQ[{a,b,c,d,e,f,m,p,q},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)
Int[x_^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := 1/2*Subst[Int[x^((m - 1)/2)*(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && IGtQ[(m + 1)/2, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x^2)^(2*FracPart[p]))* Int[(f*x)^m*(d + e*x^2)^q*(b/2 + c*x^2)^(2*p), x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[x_^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[Int[x^((m - 1)/2)*(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, d, e, p, q}, x] && IntegerQ[(m - 1)/2]
Int[x_^m_.*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[Int[x^((m - 1)/2)*(d + e*x)^q*(a + c*x^2)^p, x], x, x^2] /; FreeQ[{a, c, d, e, p, q}, x] && IntegerQ[(m + 1)/2]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[(f*x)^m*(d + e*x^2)^(q + p)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[(f*x)^m*(d + e*x^2)^(q + p)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, c, d, e, f, q, m, q}, x] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[ p]/((d + e*x^2)^FracPart[p]*(a/d + (c*x^2)/e)^FracPart[p])* Int[(f*x)^m*(d + e*x^2)^(q + p)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := (a + c*x^4)^ FracPart[ p]/((d + e*x^2)^FracPart[p]*(a/d + (c*x^2)/e)^FracPart[p])* Int[(f*x)^m*(d + e*x^2)^(q + p)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, c, d, e, f, m, p, q}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := (-d)^(m/2 - 1)*(c*d^2 - b*d*e + a*e^2)^p* x*(d + e*x^2)^(q + 1)/(2*e^(2*p + m/2)*(q + 1)) + 1/(2*e^(2*p + m/2)*(q + 1))*Int[(d + e*x^2)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^2)*(2*e^(2*p + m/2)*(q + 1)* x^m*(a + b*x^2 + c*x^4)^p - (-d)^(m/2 - 1)*(c*d^2 - b*d*e + a*e^2)^ p*(d + e*(2*q + 3)*x^2))], x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && ILtQ[q, -1] && IGtQ[m/2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := (-d)^(m/2 - 1)*(c*d^2 + a*e^2)^p* x*(d + e*x^2)^(q + 1)/(2*e^(2*p + m/2)*(q + 1)) + 1/(2*e^(2*p + m/2)*(q + 1))*Int[(d + e*x^2)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^2)*(2*e^(2*p + m/2)*(q + 1)*x^m*(a + c*x^4)^p - (-d)^(m/2 - 1)*(c*d^2 + a*e^2)^ p*(d + e*(2*q + 3)*x^2))], x], x] /; FreeQ[{a, c, d, e}, x] && IGtQ[p, 0] && ILtQ[q, -1] && IGtQ[m/2, 0]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := (-d)^(m/2 - 1)*(c*d^2 - b*d*e + a*e^2)^p* x*(d + e*x^2)^(q + 1)/(2*e^(2*p + m/2)*(q + 1)) + (-d)^(m/2 - 1)/(2*e^(2*p)*(q + 1))*Int[x^m*(d + e*x^2)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^2)*(2*(-d)^(-m/2 + 1)* e^(2*p)*(q + 1)*(a + b*x^2 + c*x^4)^p - (e^(-m/2)*(c*d^2 - b*d*e + a*e^2)^p*x^(-m))*(d + e*(2*q + 3)*x^2))], x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && ILtQ[q, -1] && ILtQ[m/2, 0]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := (-d)^(m/2 - 1)*(c*d^2 + a*e^2)^p* x*(d + e*x^2)^(q + 1)/(2*e^(2*p + m/2)*(q + 1)) + (-d)^(m/2 - 1)/(2*e^(2*p)*(q + 1))*Int[x^m*(d + e*x^2)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^2)*(2*(-d)^(-m/2 + 1)* e^(2*p)*(q + 1)*(a + c*x^4)^p - (e^(-m/2)*(c*d^2 + a*e^2)^p*x^(-m))*(d + e*(2*q + 3)*x^2))], x], x] /; FreeQ[{a, c, d, e}, x] && IGtQ[p, 0] && ILtQ[q, -1] && ILtQ[m/2, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m (d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && IGtQ[q, -2]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m (d + e*x^2)^q*(a + c*x^4)^p, x], x] /; FreeQ[{a, c, d, e, f, m, q}, x] && IGtQ[p, 0] && IGtQ[q, -2]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + b*x^2 + c*x^4)^p, d + e*x^2, x], R = Coeff[ PolynomialRemainder[(a + b*x^2 + c*x^4)^p, d + e*x^2, x], x, 0]}, -R*(f*x)^(m + 1)*(d + e*x^2)^(q + 1)/(2*d*f*(q + 1)) + f/(2*d*(q + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^(q + 1)* ExpandToSum[2*d*(q + 1)*x*Qx + R*(m + 2*q + 3)*x, x], x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && LtQ[q, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + c*x^4)^p, d + e*x^2, x], R = Coeff[PolynomialRemainder[(a + c*x^4)^p, d + e*x^2, x], x, 0]}, -R*(f*x)^(m + 1)*(d + e*x^2)^(q + 1)/(2*d*f*(q + 1)) + f/(2*d*(q + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^(q + 1)* ExpandToSum[2*d*(q + 1)*x*Qx + R*(m + 2*q + 3)*x, x], x]] /; FreeQ[{a, c, d, e, f}, x] && IGtQ[p, 0] && LtQ[q, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + b*x^2 + c*x^4)^p, f*x, x], R = PolynomialRemainder[(a + b*x^2 + c*x^4)^p, f*x, x]}, R*(f*x)^(m + 1)*(d + e*x^2)^(q + 1)/(d*f*(m + 1)) + 1/(d*f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^q* ExpandToSum[d*f*(m + 1)*Qx/x - e*R*(m + 2*q + 3), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := With[{Qx = PolynomialQuotient[(a + c*x^4)^p, f*x, x], R = PolynomialRemainder[(a + c*x^4)^p, f*x, x]}, R*(f*x)^(m + 1)*(d + e*x^2)^(q + 1)/(d*f*(m + 1)) + 1/(d*f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^q* ExpandToSum[d*f*(m + 1)*Qx/x - e*R*(m + 2*q + 3), x], x]] /; FreeQ[{a, c, d, e, f, q}, x] && IGtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := c^p*(f*x)^(m + 4*p - 1)*(d + e*x^2)^(q + 1)/(e* f^(4*p - 1)*(m + 4*p + 2*q + 1)) + 1/(e*(m + 4*p + 2*q + 1))*Int[(f*x)^m*(d + e*x^2)^q* ExpandToSum[ e*(m + 4*p + 2*q + 1)*((a + b*x^2 + c*x^4)^p - c^p*x^(4*p)) - d*c^p*(m + 4*p - 1)*x^(4*p - 2), x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && Not[IntegerQ[q]] && NeQ[m + 4*p + 2*q + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := c^p*(f*x)^(m + 4*p - 1)*(d + e*x^2)^(q + 1)/(e* f^(4*p - 1)*(m + 4*p + 2*q + 1)) + 1/(e*(m + 4*p + 2*q + 1))*Int[(f*x)^m*(d + e*x^2)^q* ExpandToSum[ e*(m + 4*p + 2*q + 1)*((a + c*x^4)^p - c^p*x^(4*p)) - d*c^p*(m + 4*p - 1)*x^(4*p - 2), x], x] /; FreeQ[{a, c, d, e, f, m, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]] && NeQ[m + 4*p + 2*q + 1, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{k = Denominator[m]}, k/f* Subst[Int[ x^(k*(m + 1) - 1)*(d + e*x^(2*k)/f^2)^ q*(a + b*x^(2*k)/f^k + c*x^(4*k)/f^4)^p, x], x, (f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[m] && IntegerQ[p]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_, x_Symbol] := With[{k = Denominator[m]}, k/f* Subst[Int[ x^(k*(m + 1) - 1)*(d + e*x^(2*k)/f)^q*(a + c*x^(4*k)/f)^p, x], x, (f*x)^(1/k)]] /; FreeQ[{a, c, d, e, f, p, q}, x] && FractionQ[m] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := (f*x)^(m + 1)*(a + b*x^2 + c*x^4)^ p*(d*(m + 4*p + 3) + e*(m + 1)*x^2)/(f*(m + 1)*(m + 4*p + 3)) + 2*p/(f^2*(m + 1)*(m + 4*p + 3))* Int[(f*x)^(m + 2)*(a + b*x^2 + c*x^4)^(p - 1)* Simp[2*a*e*(m + 1) - b*d*(m + 4*p + 3) + (b*e*(m + 1) - 2*c*d*(m + 4*p + 3))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && LtQ[m, -1] && m + 4*p + 3 != 0 && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_., x_Symbol] := (f*x)^(m + 1)*(a + c*x^4)^ p*(d*(m + 4*p + 3) + e*(m + 1)*x^2)/(f*(m + 1)*(m + 4*p + 3)) + 4*p/(f^2*(m + 1)*(m + 4*p + 3))* Int[(f*x)^(m + 2)*(a + c*x^4)^(p - 1)*(a*e*(m + 1) - c*d*(m + 4*p + 3)*x^2), x] /; FreeQ[{a, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1] && m + 4*p + 3 != 0 && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := (f*x)^(m + 1)*(a + b*x^2 + c*x^4)^ p*(b*e*2*p + c*d*(m + 4*p + 3) + c*e*(4*p + m + 1)*x^2)/ (c*f*(4*p + m + 1)*(m + 4*p + 3)) + 2*p/(c*(4*p + m + 1)*(m + 4*p + 3))* Int[(f*x)^m*(a + b*x^2 + c*x^4)^(p - 1)* Simp[2*a*c*d*(m + 4*p + 3) - a*b*e*(m + 1) + (2*a*c*e*(4*p + m + 1) + b*c*d*(m + 4*p + 3) - b^2*e*(m + 2*p + 1))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[4*p + m + 1, 0] && NeQ[m + 4*p + 3, 0] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_., x_Symbol] := (f*x)^(m + 1)*(a + c*x^4)^ p*(c*d*(m + 4*p + 3) + c*e*(4*p + m + 1)*x^2)/(c* f*(4*p + m + 1)*(m + 4*p + 3)) + 4*a*p/((4*p + m + 1)*(m + 4*p + 3))* Int[(f*x)^m*(a + c*x^4)^(p - 1)* Simp[d*(m + 4*p + 3) + e*(4*p + m + 1)*x^2, x], x] /; FreeQ[{a, c, d, e, f, m}, x] && GtQ[p, 0] && NeQ[4*p + m + 1, 0] && NeQ[m + 4*p + 3, 0] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := f*(f*x)^(m - 1)*(a + b*x^2 + c*x^4)^(p + 1)*(b*d - 2*a*e - (b*e - 2*c*d)*x^2)/(2*(p + 1)*(b^2 - 4*a*c)) - f^2/(2*(p + 1)*(b^2 - 4*a*c))* Int[(f*x)^(m - 2)*(a + b*x^2 + c*x^4)^(p + 1)* Simp[(m - 1)*(b*d - 2*a*e) - (4*p + 4 + m + 1)*(b*e - 2*c*d)* x^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[m, 1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_., x_Symbol] := f*(f*x)^(m - 1)*(a + c*x^4)^(p + 1)*(a*e - c*d*x^2)/(4*a* c*(p + 1)) - f^2/(4*a*c*(p + 1))* Int[(f*x)^(m - 2)*(a + c*x^4)^(p + 1)*(a*e*(m - 1) - c*d*(4*p + 4 + m + 1)*x^2), x] /; FreeQ[{a, c, d, e, f}, x] && LtQ[p, -1] && GtQ[m, 1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := -(f*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)*(d*(b^2 - 2*a*c) - a*b*e + (b*d - 2*a*e)*c*x^2)/(2*a*f*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))* Int[(f*x)^m*(a + b*x^2 + c*x^4)^(p + 1)* Simp[d*(b^2*(m + 2*(p + 1) + 1) - 2*a*c*(m + 4*(p + 1) + 1)) - a*b*e*(m + 1) + c*(m + 2*(2*p + 3) + 1)*(b*d - 2*a*e)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_, x_Symbol] := -(f*x)^(m + 1)*(a + c*x^4)^(p + 1)*(d + e*x^2)/(4*a*f*(p + 1)) + 1/(4*a*(p + 1))* Int[(f*x)^m*(a + c*x^4)^(p + 1)* Simp[d*(m + 4*(p + 1) + 1) + e*(m + 2*(2*p + 3) + 1)*x^2, x], x] /; FreeQ[{a, c, d, e, f, m}, x] && LtQ[p, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := e*f*(f*x)^(m - 1)*(a + b*x^2 + c*x^4)^(p + 1)/(c*(m + 4*p + 3)) - f^2/(c*(m + 4*p + 3))* Int[(f*x)^(m - 2)*(a + b*x^2 + c*x^4)^p* Simp[a*e*(m - 1) + (b*e*(m + 2*p + 1) - c*d*(m + 4*p + 3))*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[m, 1] && NeQ[m + 4*p + 3, 0] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_, x_Symbol] := e*f*(f*x)^(m - 1)*(a + c*x^4)^(p + 1)/(c*(m + 4*p + 3)) - f^2/(c*(m + 4*p + 3))* Int[(f*x)^(m - 2)*(a + c*x^4)^ p*(a*e*(m - 1) - c*d*(m + 4*p + 3)*x^2), x] /; FreeQ[{a, c, d, e, f, p}, x] && GtQ[m, 1] && NeQ[m + 4*p + 3, 0] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := d*(f*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)/(a*f*(m + 1)) + 1/(a*f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*x^2 + c*x^4)^p* Simp[a*e*(m + 1) - b*d*(m + 2*p + 3) - c*d*(m + 4*p + 5)*x^2, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[m, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_ + c_.*x_^4)^p_, x_Symbol] := d*(f*x)^(m + 1)*(a + c*x^4)^(p + 1)/(a*f*(m + 1)) + 1/(a*f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + c*x^4)^ p*(a*e*(m + 1) - c*d*(m + 4*p + 5)*x^2), x] /; FreeQ[{a, c, d, e, f, p}, x] && LtQ[m, -1] && IntegerQ[2*p] && (IntegerQ[p] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{r = Rt[c/e*(2*c*d - b*e), 2]}, e/2*Int[(f*x)^m/(c*d/e - r*x + c*x^2), x] + e/2*Int[(f*x)^m/(c*d/e + r*x + c*x^2), x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && GtQ[d/e, 0] && PosQ[c/e*(2*c*d - b*e)]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)/(a_ + c_.*x_^4), x_Symbol] := With[{r = Rt[2*c^2*d/e, 2]}, e/2*Int[(f*x)^m/(c*d/e - r*x + c*x^2), x] + e/2*Int[(f*x)^m/(c*d/e + r*x + c*x^2), x]] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[c*d^2 - a*e^2, 0] && GtQ[d/e, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (e/2 + (2*c*d - b*e)/(2*q))* Int[(f*x)^m/(b/2 - q/2 + c*x^2), x] + (e/2 - (2*c*d - b*e)/(2*q))* Int[(f*x)^m/(b/2 + q/2 + c*x^2), x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)/(a_ + c_.*x_^4), x_Symbol] := With[{q = Rt[-a*c, 2]}, -(e/2 + c*d/(2*q))* Int[(f*x)^m/(q - c*x^2), x] + (e/2 - c*d/(2*q))* Int[(f*x)^m/(q + c*x^2), x]] /; FreeQ[{a, c, d, e, f, m}, x]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_./(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q/(a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[q] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_./(a_ + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q/(a + c*x^4), x], x] /; FreeQ[{a, c, d, e, f, m}, x] && IntegerQ[q] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_./(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(f*x)^m, (d + e*x^2)^q/(a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[q] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_./(a_ + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(f*x)^m, (d + e*x^2)^q/(a + c*x^4), x], x] /; FreeQ[{a, c, d, e, f, m}, x] && IntegerQ[q] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := f^4/c^2* Int[(f*x)^(m - 4)*(c*d - b*e + c*e*x^2)*(d + e*x^2)^(q - 1), x] - f^4/c^2* Int[(f*x)^(m - 4)*(d + e*x^2)^(q - 1)* Simp[a*(c*d - b*e) + (b*c*d - b^2*e + a*c*e)*x^2, x]/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && GtQ[m, 3]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := f^4/c*Int[(f*x)^(m - 4)*(d + e*x^2)^q, x] - a*f^4/c*Int[(f*x)^(m - 4)*(d + e*x^2)^q/(a + c*x^4), x] /; FreeQ[{a, c, d, e, f, q}, x] && Not[IntegerQ[q]] && GtQ[m, 3]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := e*f^2/c*Int[(f*x)^(m - 2)*(d + e*x^2)^(q - 1), x] - f^2/c* Int[(f*x)^(m - 2)*(d + e*x^2)^(q - 1)* Simp[a*e - (c*d - b*e)*x^2, x]/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && GtQ[m, 1] && LeQ[m, 3]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := e*f^2/c*Int[(f*x)^(m - 2)*(d + e*x^2)^(q - 1), x] - f^2/c* Int[(f*x)^(m - 2)*(d + e*x^2)^(q - 1)* Simp[a*e - c*d*x^2, x]/(a + c*x^4), x] /; FreeQ[{a, c, d, e, f}, x] && Not[IntegerQ[q]] && GtQ[q, 0] && GtQ[m, 1] && LeQ[m, 3]
Int[(f_.*x_)^m_*(d_. + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := d/a*Int[(f*x)^m*(d + e*x^2)^(q - 1), x] - 1/(a*f^2)* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)* Simp[b*d - a*e + c*d*x^2, x]/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_*(d_. + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := d/a*Int[(f*x)^m*(d + e*x^2)^(q - 1), x] + 1/(a*f^2)* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)* Simp[a*e - c*d*x^2, x]/(a + c*x^4), x] /; FreeQ[{a, c, d, e, f}, x] && Not[IntegerQ[q]] && GtQ[q, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := d^2*f^4/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 4)*(d + e*x^2)^q, x] - f^4/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 4)*(d + e*x^2)^(q + 1)* Simp[a*d + (b*d - a*e)*x^2, x]/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, 3]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := d^2*f^4/(c*d^2 + a*e^2)*Int[(f*x)^(m - 4)*(d + e*x^2)^q, x] - a*f^4/(c*d^2 + a*e^2)* Int[(f*x)^(m - 4)*(d + e*x^2)^(q + 1)*(d - e*x^2)/(a + c*x^4), x] /; FreeQ[{a, c, d, e, f}, x] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, 3]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := -d*e*f^2/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2)*(d + e*x^2)^q, x] + f^2/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)* Simp[a*e + c*d*x^2, x]/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, 1] && LeQ[m, 3]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := -d*e*f^2/(c*d^2 + a*e^2)*Int[(f*x)^(m - 2)*(d + e*x^2)^q, x] + f^2/(c*d^2 + a*e^2)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)* Simp[a*e + c*d*x^2, x]/(a + c*x^4), x] /; FreeQ[{a, c, d, e, f}, x] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, 1] && LeQ[m, 3]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := e^2/(c*d^2 - b*d*e + a*e^2)*Int[(f*x)^m*(d + e*x^2)^q, x] + 1/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^m*(d + e*x^2)^(q + 1)* Simp[c*d - b*e - c*e*x^2, x]/(a + b*x^2 + c*x^4), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := e^2/(c*d^2 + a*e^2)*Int[(f*x)^m*(d + e*x^2)^q, x] + c/(c*d^2 + a*e^2)* Int[(f*x)^m*(d + e*x^2)^(q + 1)*(d - e*x^2)/(a + c*x^4), x] /; FreeQ[{a, c, d, e, f, m}, x] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q, (f*x)^m/(a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^q, (f*x)^m/(a + c*x^4), x], x] /; FreeQ[{a, c, d, e, f, q}, x] && Not[IntegerQ[q]] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q, 1/(a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[q]] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q, 1/(a + c*x^4), x], x] /; FreeQ[{a, c, d, e, f, m, q}, x] && Not[IntegerQ[q]] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := With[{r = Rt[b^2 - 4*a*c, 2]}, 2*c/r*Int[(f*x)^m*(d + e*x^2)^q/(b - r + 2*c*x^2), x] - 2*c/r*Int[(f*x)^m*(d + e*x^2)^q/(b + r + 2*c*x^2), x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_/(a_ + c_.*x_^4), x_Symbol] := With[{r = Rt[-a*c, 2]}, -c/(2*r)*Int[(f*x)^m*(d + e*x^2)^q/(r - c*x^2), x] - c/(2*r)*Int[(f*x)^m*(d + e*x^2)^q/(r + c*x^2), x]] /; FreeQ[{a, c, d, e, f, m, q}, x]
Int[(f_.*x_)^m_*(a_. + b_.*x_^2 + c_.*x_^4)^p_./(d_. + e_.*x_^2), x_Symbol] := 1/d^2* Int[(f*x)^m*(a*d + (b*d - a*e)*x^2)*(a + b*x^2 + c*x^4)^(p - 1), x] + (c*d^2 - b*d*e + a*e^2)/(d^2*f^4)* Int[(f*x)^(m + 4)*(a + b*x^2 + c*x^4)^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && LtQ[m, -2]
Int[(f_.*x_)^m_*(a_ + c_.*x_^4)^p_./(d_. + e_.*x_^2), x_Symbol] := a/d^2*Int[(f*x)^m*(d - e*x^2)*(a + c*x^4)^(p - 1), x] + (c*d^2 + a*e^2)/(d^2*f^4)* Int[(f*x)^(m + 4)*(a + c*x^4)^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -2]
Int[(f_.*x_)^m_*(a_. + b_.*x_^2 + c_.*x_^4)^p_./(d_. + e_.*x_^2), x_Symbol] := 1/(d*e)* Int[(f*x)^m*(a*e + c*d*x^2)*(a + b*x^2 + c*x^4)^(p - 1), x] - (c*d^2 - b*d*e + a*e^2)/(d*e*f^2)* Int[(f*x)^(m + 2)*(a + b*x^2 + c*x^4)^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_*(a_ + c_.*x_^4)^p_./(d_. + e_.*x_^2), x_Symbol] := 1/(d*e)*Int[(f*x)^m*(a*e + c*d*x^2)*(a + c*x^4)^(p - 1), x] - (c*d^2 + a*e^2)/(d*e*f^2)* Int[(f*x)^(m + 2)*(a + c*x^4)^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_.*(a_. + b_.*x_^2 + c_.*x_^4)^p_/(d_. + e_.*x_^2), x_Symbol] := -f^4/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 4)*(a*d + (b*d - a*e)*x^2)*(a + b*x^2 + c*x^4)^p, x] + d^2*f^4/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 4)*(a + b*x^2 + c*x^4)^(p + 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[m, 2]
Int[(f_.*x_)^m_.*(a_ + c_.*x_^4)^p_/(d_. + e_.*x_^2), x_Symbol] := -a*f^4/(c*d^2 + a*e^2)* Int[(f*x)^(m - 4)*(d - e*x^2)*(a + c*x^4)^p, x] + d^2*f^4/(c*d^2 + a*e^2)* Int[(f*x)^(m - 4)*(a + c*x^4)^(p + 1)/(d + e*x^2), x] /; FreeQ[{a, c, d, e, f}, x] && LtQ[p, -1] && GtQ[m, 2]
Int[(f_.*x_)^m_.*(a_. + b_.*x_^2 + c_.*x_^4)^p_/(d_. + e_.*x_^2), x_Symbol] := f^2/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2)*(a*e + c*d*x^2)*(a + b*x^2 + c*x^4)^p, x] - d*e*f^2/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2)*(a + b*x^2 + c*x^4)^(p + 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(a_ + c_.*x_^4)^p_/(d_. + e_.*x_^2), x_Symbol] := f^2/(c*d^2 + a*e^2)* Int[(f*x)^(m - 2)*(a*e + c*d*x^2)*(a + c*x^4)^p, x] - d*e*f^2/(c*d^2 + a*e^2)* Int[(f*x)^(m - 2)*(a + c*x^4)^(p + 1)/(d + e*x^2), x] /; FreeQ[{a, c, d, e, f}, x] && LtQ[p, -1] && GtQ[m, 0]
Int[x_^2/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := d/(2*d*e)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - d/(2*d*e)* Int[(d - e*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && PosQ[c/a] && EqQ[c*d^2 - a*e^2, 0]
Int[x_^2/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := d/(2*d*e)*Int[1/Sqrt[a + c*x^4], x] - d/(2*d*e)*Int[(d - e*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && PosQ[c/a] && EqQ[c*d^2 - a*e^2, 0]
Int[x_^2/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, -a*(e + d*q)/(c*d^2 - a*e^2)* Int[1/Sqrt[a + b*x^2 + c*x^4], x] + a*d*(e + d*q)/(c*d^2 - a*e^2)* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && PosQ[c/a] && NeQ[c*d^2 - a*e^2, 0]
Int[x_^2/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, -a*(e + d*q)/(c*d^2 - a*e^2)*Int[1/Sqrt[a + c*x^4], x] + a*d*(e + d*q)/(c*d^2 - a*e^2)* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && PosQ[c/a] && NeQ[c*d^2 - a*e^2, 0]
Int[x_^4/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := -1/e^2*Int[(d - e*x^2)/Sqrt[a + b*x^2 + c*x^4], x] + d^2/e^2*Int[1/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a] && EqQ[c*d^2 - a*e^2, 0]
Int[x_^4/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := -1/e^2*Int[(d - e*x^2)/Sqrt[a + c*x^4], x] + d^2/e^2*Int[1/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e}, x] && PosQ[c/a] && EqQ[c*d^2 - a*e^2, 0]
Int[x_^4/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, -1/(e*q)*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x] + d^2/(e*(e - d*q))* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; EqQ[2*c*d - a*e*q, 0]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a] && NeQ[c*d^2 - a*e^2, 0]
Int[x_^4/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, -1/(e*q)*Int[(1 - q*x^2)/Sqrt[a + c*x^4], x] + d^2/(e*(e - d*q))* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; EqQ[2*c*d - a*e*q, 0]] /; FreeQ[{a, c, d, e}, x] && PosQ[c/a] && NeQ[c*d^2 - a*e^2, 0]
Int[x_^4/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, -(2*c*d - a*e*q)/(c*e*(e - d*q))* Int[1/Sqrt[a + b*x^2 + c*x^4], x] - 1/(e*q)*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x] + d^2/(e*(e - d*q))* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && PosQ[c/a] && NeQ[c*d^2 - a*e^2, 0]
Int[x_^4/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, -(2*c*d - a*e*q)/(c*e*(e - d*q))*Int[1/Sqrt[a + c*x^4], x] - 1/(e*q)*Int[(1 - q*x^2)/Sqrt[a + c*x^4], x] + d^2/(e*(e - d*q))* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && PosQ[c/a] && NeQ[c*d^2 - a*e^2, 0]
Int[x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := x^(m - 5)*Sqrt[a + b*x^2 + c*x^4]/(c*e*(m - 3)) - 1/(c*e*(m - 3))* Int[x^(m - 6)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4])* Simp[a*d*(m - 5) + (a*e*(m - 5) + b*d*(m - 4))* x^2 + (b*e*(m - 4) + c*d*(m - 3))*x^4, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[m/2, 2]
Int[x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := x^(m - 5)*Sqrt[a + c*x^4]/(c*e*(m - 3)) - 1/(c*e*(m - 3))* Int[x^(m - 6)/((d + e*x^2)*Sqrt[a + c*x^4])* Simp[a*d*(m - 5) + a*e*(m - 5)*x^2 + c*d*(m - 3)*x^4, x], x] /; FreeQ[{a, c, d, e}, x] && IGtQ[m/2, 2]
Int[x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := x^(m + 1)*Sqrt[a + b*x^2 + c*x^4]/(a*d*(m + 1)) - 1/(a*d*(m + 1))* Int[x^(m + 2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4])* Simp[a*e*(m + 1) + b*d*(m + 2) + (b*e*(m + 2) + c*d*(m + 3))*x^2 + c*e*(m + 3)*x^4, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[m/2, 0]
Int[x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := x^(m + 1)*Sqrt[a + c*x^4]/(a*d*(m + 1)) - 1/(a*d*(m + 1))* Int[x^(m + 2)/((d + e*x^2)*Sqrt[a + c*x^4])* Simp[a*e*(m + 1) + c*d*(m + 3)*x^2 + c*e*(m + 3)*x^4, x], x] /; FreeQ[{a, c, d, e}, x] && ILtQ[m/2, 0]
Int[x_^m_/(Sqrt[d_ + e_.*x_^2]*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := x^3*Sqrt[e + d/x^2]* Sqrt[c + b/x^2 + a/x^4]/(Sqrt[d + e*x^2]*Sqrt[a + b*x^2 + c*x^4])* Int[x^(m - 3)/(Sqrt[e + d/x^2]*Sqrt[c + b/x^2 + a/x^4]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[m/2]
Int[x_^m_/(Sqrt[d_ + e_.*x_^2]*Sqrt[a_ + c_.*x_^4]), x_Symbol] := x^3*Sqrt[e + d/x^2]* Sqrt[c + a/x^4]/(Sqrt[d + e*x^2]*Sqrt[a + c*x^4])* Int[x^(m - 3)/(Sqrt[e + d/x^2]*Sqrt[c + a/x^4]), x] /; FreeQ[{a, c, d, e}, x] && IntegerQ[m/2]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{f = Coeff[PolynomialRemainder[x^m*(d + e*x^2)^q, a + b*x^2 + c*x^4, x], x, 0], g = Coeff[ PolynomialRemainder[x^m*(d + e*x^2)^q, a + b*x^2 + c*x^4, x], x, 2]}, x*(a + b*x^2 + c*x^4)^(p + 1)*(a*b*g - f*(b^2 - 2*a*c) - c*(b*f - 2*a*g)*x^2)/(2*a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))*Int[(a + b*x^2 + c*x^4)^(p + 1)* Simp[ExpandToSum[ 2*a*(p + 1)*(b^2 - 4*a*c)* PolynomialQuotient[x^m*(d + e*x^2)^q, a + b*x^2 + c*x^4, x] + b^2*f*(2*p + 3) - 2*a*c*f*(4*p + 5) - a*b*g + c*(4*p + 7)*(b*f - 2*a*g)*x^2, x], x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && IGtQ[q, 1] && IGtQ[m/2, 0]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{f = Coeff[PolynomialRemainder[x^m*(d + e*x^2)^q, a + b*x^2 + c*x^4, x], x, 0], g = Coeff[ PolynomialRemainder[x^m*(d + e*x^2)^q, a + b*x^2 + c*x^4, x], x, 2]}, x*(a + b*x^2 + c*x^4)^(p + 1)*(a*b*g - f*(b^2 - 2*a*c) - c*(b*f - 2*a*g)*x^2)/(2*a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))* Int[x^m*(a + b*x^2 + c*x^4)^(p + 1)* Simp[ExpandToSum[ 2*a*(p + 1)*(b^2 - 4*a*c)*x^(-m)* PolynomialQuotient[x^m*(d + e*x^2)^q, a + b*x^2 + c*x^4, x] + (b^2*f*(2*p + 3) - 2*a*c*f*(4*p + 5) - a*b*g)*x^(-m) + c*(4*p + 7)*(b*f - 2*a*g)*x^(2 - m), x], x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && IGtQ[q, 1] && ILtQ[m/2, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && NeQ[b^2 - 4*a*c, 0] && (IGtQ[p, 0] || IGtQ[q, 0] || IntegersQ[m, q])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + c*x^4)^p, x], x] /; FreeQ[{a, c, d, e, f, m, p, q}, x] && (IGtQ[p, 0] || IGtQ[q, 0] || IntegersQ[m, q])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_*(a_ + c_.*x_^4)^p_, x_Symbol] := (f*x)^m/x^m* Int[ExpandIntegrand[ x^m*(a + c*x^4)^ p, (d/(d^2 - e^2*x^4) - e*x^2/(d^2 - e^2*x^4))^(-q), x], x] /; FreeQ[{a, c, d, e, f, m, p}, x] && Not[IntegerQ[p]] && ILtQ[q, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^2)^q*(a + c*x^4)^p, x] /; FreeQ[{a, c, d, e, f, m, p, q}, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.5 P(x) (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.5 P(x) (a+b x^2+c x^4)^p *)
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && IGtQ[p, 0]
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Int[x*PolynomialQuotient[Pq, x, x]*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0] && Not[MatchQ[Pq, x^m_.*u_. /; IntegerQ[m]]]
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Module[{q = Expon[Pq, x], k}, Int[ Sum[Coeff[Pq, x, 2*k]*x^(2*k), {k, 0, q/2}]*(a + b*x^2 + c*x^4)^ p, x] + Int[ x*Sum[Coeff[Pq, x, 2*k + 1]*x^(2*k), {k, 0, (q - 1)/2}]*(a + b*x^2 + c*x^4)^p, x]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x] && Not[PolyQ[Pq, x^2]]
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := With[{d = Coeff[Pq, x, 0], e = Coeff[Pq, x, 2], f = Coeff[Pq, x, 4]}, d*x*(a + b*x^2 + c*x^4)^(p + 1)/a /; EqQ[a*e - b*d*(2*p + 3), 0] && EqQ[a*f - c*d*(4*p + 5), 0]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x^2] && EqQ[Expon[Pq, x], 4]
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := With[{d = Coeff[Pq, x, 0], e = Coeff[Pq, x, 2], f = Coeff[Pq, x, 4], g = Coeff[Pq, x, 6]}, x*(3*a*d + (a*e - b*d*(2*p + 3))* x^2)*(a + b*x^2 + c*x^4)^(p + 1)/(3*a^2) /; EqQ[3*a^2*g - c*(4*p + 7)*(a*e - b*d*(2*p + 3)), 0] && EqQ[3*a^2*f - 3*a*c*d*(4*p + 5) - b*(2*p + 5)*(a*e - b*d*(2*p + 3)), 0]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x^2] && EqQ[Expon[Pq, x], 6]
Int[Pq_/(a_ + b_.*x_^2 + c_.*x_^4), x_Symbol] := Int[ExpandIntegrand[Pq/(a + b*x^2 + c*x^4), x], x] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x^2] && Expon[Pq, x^2] > 1
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x^2)^(2*FracPart[p]))* Int[Pq*(b + 2*c*x^2)^(2*p), x] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x^2] && Expon[Pq, x^2] > 1 && EqQ[b^2 - 4*a*c, 0]
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{d = Coeff[PolynomialRemainder[Pq, a + b*x^2 + c*x^4, x], x, 0], e = Coeff[PolynomialRemainder[Pq, a + b*x^2 + c*x^4, x], x, 2]}, x*(a + b*x^2 + c*x^4)^(p + 1)*(a*b*e - d*(b^2 - 2*a*c) - c*(b*d - 2*a*e)*x^2)/(2*a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))*Int[(a + b*x^2 + c*x^4)^(p + 1)* ExpandToSum[ 2*a*(p + 1)*(b^2 - 4*a*c)* PolynomialQuotient[Pq, a + b*x^2 + c*x^4, x] + b^2*d*(2*p + 3) - 2*a*c*d*(4*p + 5) - a*b*e + c*(4*p + 7)*(b*d - 2*a*e)*x^2, x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x^2] && Expon[Pq, x^2] > 1 && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{q = Expon[Pq, x^2], e = Coeff[Pq, x^2, Expon[Pq, x^2]]}, e*x^(2*q - 3)*(a + b*x^2 + c*x^4)^(p + 1)/(c*(2*q + 4*p + 1)) + 1/(c*(2*q + 4*p + 1))*Int[(a + b*x^2 + c*x^4)^p* ExpandToSum[ c*(2*q + 4*p + 1)*Pq - a*e*(2*q - 3)*x^(2*q - 4) - b*e*(2*q + 2*p - 1)*x^(2*q - 2) - c*e*(2*q + 4*p + 1)*x^(2*q), x], x]] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x^2] && Expon[Pq, x^2] > 1 && NeQ[b^2 - 4*a*c, 0] && Not[LtQ[p, -1]]
Int[Pq_*Q4_^p_, x_Symbol] := With[{a = Coeff[Q4, x, 0], b = Coeff[Q4, x, 1], c = Coeff[Q4, x, 2], d = Coeff[Q4, x, 3], e = Coeff[Q4, x, 4]}, Subst[ Int[SimplifyIntegrand[ ReplaceAll[Pq, x -> -d/(4*e) + x]*(a + d^4/(256*e^3) - b*d/(8*e) + (c - 3*d^2/(8*e))*x^2 + e*x^4)^p, x], x], x, d/(4*e) + x] /; EqQ[d^3 - 4*c*d*e + 8*b*e^2, 0] && NeQ[d, 0]] /; FreeQ[p, x] && PolyQ[Pq, x] && PolyQ[Q4, x, 4] && Not[IGtQ[p, 0]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.6 P(x) (d x)^m (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.6 P(x) (d x)^m (a+b x^2+c x^4)^p *)
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Module[{q = Expon[Pq, x], k}, Int[(d*x)^m* Sum[Coeff[Pq, x, 2*k]*x^(2*k), {k, 0, q/2 + 1}]*(a + b*x^2 + c*x^4)^p, x] + 1/d* Int[(d*x)^(m + 1)* Sum[Coeff[Pq, x, 2*k + 1]*x^(2*k), {k, 0, (q - 1)/2 + 1}]*(a + b*x^2 + c*x^4)^p, x]] /; FreeQ[{a, b, c, d, m, p}, x] && PolyQ[Pq, x] && Not[PolyQ[Pq, x^2]]
Int[x_^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := 1/2*Subst[ Int[x^((m - 1)/2)*SubstFor[x^2, Pq, x]*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, p}, x] && PolyQ[Pq, x^2] && IntegerQ[(m - 1)/2]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[(d*x)^m*Pq*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && PolyQ[Pq, x^2] && IGtQ[p, -2]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := 1/d^2* Int[(d*x)^(m + 2)*ExpandToSum[Pq/x^2, x]*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, m, p}, x] && PolyQ[Pq, x^2] && EqQ[Coeff[Pq, x, 0], 0]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := With[{e = Coeff[Pq, x, 0], f = Coeff[Pq, x, 2], g = Coeff[Pq, x, 4]}, e*(d*x)^(m + 1)*(a + b*x^2 + c*x^4)^(p + 1)/(a*d*(m + 1)) /; EqQ[a*f*(m + 1) - b*e*(m + 2*p + 3), 0] && EqQ[a*g*(m + 1) - c*e*(m + 4*p + 5), 0] && NeQ[m, -1]] /; FreeQ[{a, b, c, d, m, p}, x] && PolyQ[Pq, x^2] && EqQ[Expon[Pq, x], 4]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x^2)^(2*FracPart[p]))* Int[(d*x)^m*Pq*(b + 2*c*x^2)^(2*p), x] /; FreeQ[{a, b, c, d, m, p}, x] && PolyQ[Pq, x^2] && GtQ[Expon[Pq, x^2], 1] && EqQ[b^2 - 4*a*c, 0]
Int[x_^m_*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{d = Coeff[PolynomialRemainder[x^m*Pq, a + b*x^2 + c*x^4, x], x, 0], e = Coeff[PolynomialRemainder[x^m*Pq, a + b*x^2 + c*x^4, x], x, 2]}, x*(a + b*x^2 + c*x^4)^(p + 1)*(a*b*e - d*(b^2 - 2*a*c) - c*(b*d - 2*a*e)*x^2)/(2*a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))*Int[(a + b*x^2 + c*x^4)^(p + 1)* ExpandToSum[ 2*a*(p + 1)*(b^2 - 4*a*c)* PolynomialQuotient[x^m*Pq, a + b*x^2 + c*x^4, x] + b^2*d*(2*p + 3) - 2*a*c*d*(4*p + 5) - a*b*e + c*(4*p + 7)*(b*d - 2*a*e)*x^2, x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x^2] && GtQ[Expon[Pq, x^2], 1] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && IGtQ[m/2, 0]
Int[x_^m_*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := With[{d = Coeff[PolynomialRemainder[x^m*Pq, a + b*x^2 + c*x^4, x], x, 0], e = Coeff[PolynomialRemainder[x^m*Pq, a + b*x^2 + c*x^4, x], x, 2]}, x*(a + b*x^2 + c*x^4)^(p + 1)*(a*b*e - d*(b^2 - 2*a*c) - c*(b*d - 2*a*e)*x^2)/(2*a*(p + 1)*(b^2 - 4*a*c)) + 1/(2*a*(p + 1)*(b^2 - 4*a*c))* Int[x^m*(a + b*x^2 + c*x^4)^(p + 1)* ExpandToSum[ 2*a*(p + 1)*(b^2 - 4*a*c)*x^(-m)* PolynomialQuotient[x^m*Pq, a + b*x^2 + c*x^4, x] + (b^2*d*(2*p + 3) - 2*a*c*d*(4*p + 5) - a*b*e)*x^(-m) + c*(4*p + 7)*(b*d - 2*a*e)*x^(2 - m), x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x^2] && GtQ[Expon[Pq, x^2], 1] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1] && ILtQ[m/2, 0]
(* Int[x_^m_.*Pq_*(a_+b_.*x_^2+c_.*x_^4)^p_,x_Symbol] := With[{d=Coeff[PolynomialRemainder[x^m*Pq,a+b*x^2+c*x^4,x],x,1], e=Coeff[PolynomialRemainder[x^m*Pq,a+b*x^2+c*x^4,x],x,3]}, x^2*(a+b*x^2+c*x^4)^(p+1)*(a*b*e-d*(b^2-2*a*c)-c*(b*d-2*a*e)*x^2)/( 2*a*(p+1)*(b^2-4*a*c)) + 1/(a*(p+1)*(b^2-4*a*c))*Int[x^m*(a+b*x^2+c*x^4)^(p+1)* ExpandToSum[a*(p+1)*(b^2-4*a*c)*x^(-m)*PolynomialQuotient[x^m*Pq, a+b*x^2+c*x^4,x]+ (b^2*d*(p+2)-2*a*c*d*(2*p+3)-a*b*e)*x^(1-m)+2*c*(p+2)*(b*d-2*a* e)*x^(3-m),x],x]] /; FreeQ[{a,b,c},x] && PolyQ[Pq,x^2] && GtQ[Expon[Pq,x^2],1] &&  NeQ[b^2-4*a*c,0] && LtQ[p,-1] && IntegerQ[(m-1)/2] *)
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Unintegrable[(d*x)^m*Pq*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, m, p}, x] && PolyQ[Pq, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.7 P(x) (d+e x^2)^q (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.7 P(x) (d+e x^2)^q (a+b x^2+c x^4)^p *)
Int[Px_*x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 2], C = Coeff[Px, x, 4]}, C*x^(m - 1)*Sqrt[a + b*x^2 + c*x^4]/(c*e*(m + 1)) - 1/(c*e*(m + 1))* Int[(x^(m - 2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]))* Simp[a*C*d*(m - 1) - (A*c*e*(m + 1) - C*(a*e*(m - 1) + b*d*m))* x^2 - (B*c*e*(m + 1) - C*(b*e*m + c*d*(m + 1)))*x^4, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x^2, 2] && NeQ[b^2 - 4*a*c, 0] && IGtQ[m/2, 0]
Int[Px_*x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 2], C = Coeff[Px, x, 4]}, C*x^(m - 1)*Sqrt[a + c*x^4]/(c*e*(m + 1)) - 1/(c*e*(m + 1))*Int[(x^(m - 2)/((d + e*x^2)*Sqrt[a + c*x^4]))* Simp[a*C*d*(m - 1) - (A*c*e*(m + 1) - C*a*e*(m - 1))* x^2 - (B*c*e*(m + 1) - C*c*d*(m + 1))*x^4, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x^2, 2] && IGtQ[m/2, 0]
Int[Px_*x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 2], C = Coeff[Px, x, 4]}, A*x^(m + 1)*Sqrt[a + b*x^2 + c*x^4]/(a*d*(m + 1)) + 1/(a*d*(m + 1))* Int[(x^(m + 2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]))* Simp[a*B*d*(m + 1) - A*(a*e*(m + 1) + b*d*(m + 2)) + (a*C*d*(m + 1) - A*(b*e*(m + 2) + c*d*(m + 3)))*x^2 - A*c*e*(m + 3)*x^4, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x^2, 2] && NeQ[b^2 - 4*a*c, 0] && ILtQ[m/2, 0]
Int[Px_*x_^m_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 2], C = Coeff[Px, x, 4]}, A*x^(m + 1)*Sqrt[a + c*x^4]/(a*d*(m + 1)) + 1/(a*d*(m + 1))*Int[(x^(m + 2)/((d + e*x^2)*Sqrt[a + c*x^4]))* Simp[a*B*d*(m + 1) - A*a*e*(m + 1) + (a*C*d*(m + 1) - A*c*d*(m + 3))*x^2 - A*c*e*(m + 3)*x^4, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x^2, 2] && ILtQ[m/2, 0]
Int[x_*Px_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := 1/2*Subst[ Int[ReplaceAll[Px, x -> Sqrt[x]]*(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^2] /; FreeQ[{a, b, c, d, e, p, q}, x] && PolyQ[Px, x^2]
Int[Pr_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Int[x* PolynomialQuotient[Pr, x, x]*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, e, p, q}, x] && PolyQ[Pr, x] && EqQ[PolynomialRemainder[Pr, x, x], 0] && Not[MatchQ[Pr, x^m_.*u_. /; IntegerQ[m]]]
Int[Pr_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Module[{r = Expon[Pr, x], k}, Int[ Sum[Coeff[Pr, x, 2*k]*x^(2*k), {k, 0, r/2}]*(d + e*x^2)^ q*(a + b*x^2 + c*x^4)^p, x] + Int[ x*Sum[Coeff[Pr, x, 2*k + 1]*x^(2*k), {k, 0, (r - 1)/2}]*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x]] /; FreeQ[{a, b, c, d, e, p, q}, x] && PolyQ[Pr, x] && Not[PolyQ[Pr, x^2]]
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[Px*(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p] && (PolyQ[Px, x^2] || MatchQ[Px, (f_ + g_.*x^2)^r_. /; FreeQ[{f, g, r}, x]])
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[Px*(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, c, d, e, q}, x] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p] && (PolyQ[Px, x^2] || MatchQ[Px, (f_ + g_.*x^2)^r_. /; FreeQ[{f, g, r}, x]])
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := (a + b*x^2 + c*x^4)^ FracPart[p]/((d + e*x^2)^FracPart[p]*(a/d + c*x^2/e)^FracPart[p])* Int[Px*(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, b, c, d, e, p, q}, x] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]] && (PolyQ[Px, x^2] || MatchQ[Px, (f_ + g_.*x^2)^r_. /; FreeQ[{f, g, r}, x]])
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_, x_Symbol] := (a + c*x^4)^ FracPart[p]/((d + e*x^2)^FracPart[p]*(a/d + c*x^2/e)^FracPart[p])* Int[Px*(d + e*x^2)^(p + q)*(a/d + c/e*x^2)^p, x] /; FreeQ[{a, c, d, e, p, q}, x] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && (PolyQ[Px, x^2] || MatchQ[Px, (f_ + g_.*x^2)^r_. /; FreeQ[{f, g, r}, x]])
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[Px*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x], x] /; FreeQ[{a, b, c, d, e, q}, x] && PolyQ[Px, x^2] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[ExpandIntegrand[Px*(d + e*x^2)^q*(a + c*x^4)^p, x], x] /; FreeQ[{a, c, d, e, q}, x] && PolyQ[Px, x^2] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^2)^q_*P4x_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, C*x*(d + e*x^2)^q*Sqrt[a + b*x^2 + c*x^4]/(c*(2*q + 3)) + 1/(c*(2*q + 3))* Int[(d + e*x^2)^(q - 1)/Sqrt[a + b*x^2 + c*x^4]* Simp[A*c*d*(2*q + 3) - a*C*d + (c*(B*d + A*e)*(2*q + 3) - C*(2*b*d + a*e + 2*a*e*q))* x^2 + (B*c*e*(2*q + 3) - 2*C*(b*e - c*d*q + b*e*q))*x^4, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[P4x, x^2] && EqQ[Expon[P4x, x], 4] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_*P4x_/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, C*x*(d + e*x^2)^q*Sqrt[a + c*x^4]/(c*(2*q + 3)) + 1/(c*(2*q + 3))*Int[(d + e*x^2)^(q - 1)/Sqrt[a + c*x^4]* Simp[A*c*d*(2*q + 3) - a*C*d + (c*(B*d + A*e)*(2*q + 3) - a*C*e*(2*q + 1))* x^2 + (B*c*e*(2*q + 3) + 2*c*C*d*q)*x^4, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[P4x, x^2] && EqQ[Expon[P4x, x], 4] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_*P4x_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -(C*d^2 - B*d*e + A*e^2)*x*(d + e*x^2)^(q + 1)* Sqrt[a + b*x^2 + c*x^4]/(2* d*(q + 1)*(c*d^2 - b*d*e + a*e^2)) + 1/(2*d*(q + 1)*(c*d^2 - b*d*e + a*e^2))* Int[(d + e*x^2)^(q + 1)/Sqrt[a + b*x^2 + c*x^4]* Simp[a*d*(C*d - B*e) + A*(a*e^2*(2*q + 3) + 2*d*(c*d - b*e)*(q + 1)) - 2*((B*d - A*e)*(b*e*(q + 2) - c*d*(q + 1)) - C*d*(b*d + a*e*(q + 1)))*x^2 + c*(C*d^2 - B*d*e + A*e^2)*(2*q + 5)*x^4, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[P4x, x^2] && LeQ[Expon[P4x, x], 4] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && ILtQ[q, -1]
Int[(d_ + e_.*x_^2)^q_*P4x_/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -(C*d^2 - B*d*e + A*e^2)*x*(d + e*x^2)^(q + 1)* Sqrt[a + c*x^4]/(2*d*(q + 1)*(c*d^2 + a*e^2)) + 1/(2*d*(q + 1)*(c*d^2 + a*e^2))* Int[(d + e*x^2)^(q + 1)/Sqrt[a + c*x^4]* Simp[a*d*(C*d - B*e) + A*(a*e^2*(2*q + 3) + 2*c*d^2*(q + 1)) + 2*d*(B*c*d - A*c*e + a*C*e)*(q + 1)*x^2 + c*(C*d^2 - B*d*e + A*e^2)*(2*q + 5)*x^4, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[P4x, x^2] && LeQ[Expon[P4x, x], 4] && NeQ[c*d^2 + a*e^2, 0] && ILtQ[q, -1]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := A*Subst[Int[1/(d - (b*d - 2*a*e)*x^2), x], x, x/Sqrt[a + b*x^2 + c*x^4]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0] && EqQ[B*d + A*e, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := A*Subst[Int[1/(d + 2*a*e*x^2), x], x, x/Sqrt[a + c*x^4]] /; FreeQ[{a, c, d, e, A, B}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0] && EqQ[B*d + A*e, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := (B*d + A*e)/(2*d*e)*Int[1/Sqrt[a + b*x^2 + c*x^4], x] - (B*d - A*e)/(2*d*e)* Int[(d - e*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0] && NeQ[B*d + A*e, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := (B*d + A*e)/(2*d*e)*Int[1/Sqrt[a + c*x^4], x] - (B*d - A*e)/(2*d*e)* Int[(d - e*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e, A, B}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0] && NeQ[B*d + A*e, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := Sqrt[A + B*x^2]*Sqrt[a/A + c*x^2/B]/Sqrt[a + b*x^2 + c*x^4]* Int[Sqrt[A + B*x^2]/((d + e*x^2)*Sqrt[a/A + c*x^2/B]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[c*A^2 - b*A*B + a*B^2, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := Sqrt[A + B*x^2]*Sqrt[a/A + c*x^2/B]/Sqrt[a + c*x^4]* Int[Sqrt[A + B*x^2]/((d + e*x^2)*Sqrt[a/A + c*x^2/B]), x] /; FreeQ[{a, c, d, e, A, B}, x] && NeQ[c*d^2 + a*e^2, 0] && EqQ[c*A^2 + a*B^2, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Sqrt[b^2 - 4*a*c]}, (2*a*B - A*(b + q))/(2*a*e - d*(b + q))* Int[1/Sqrt[a + b*x^2 + c*x^4], x] - (B*d - A*e)/(2*a*e - d*(b + q))* Int[(2*a + (b + q)*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; RationalQ[q]] /; FreeQ[{a, b, c, d, e, A, B}, x] && GtQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*A^2 - b*A*B + a*B^2, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Sqrt[-a*c]}, (a*B - A*q)/(a*e - d*q)*Int[1/Sqrt[a + c*x^4], x] - (B*d - A*e)/(a*e - d*q)* Int[(a + q*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; RationalQ[q]] /; FreeQ[{a, c, d, e, A, B}, x] && GtQ[-a*c, 0] && EqQ[c*d^2 + a*e^2, 0] && NeQ[c*A^2 + a*B^2, 0]
(* Int[(A_+B_.*x_^2)/((d_+e_.*x_^2)*Sqrt[a_+b_.*x_^2+c_.*x_^4]),x_ Symbol] := With[{q=Rt[B/A,2]}, -(B*d-A*e)*ArcTan[Rt[-b+c*d/e+a*e/d,2]*x/Sqrt[a+b*x^2+c*x^4]]/(2*d* e*Rt[-b+c*d/e+a*e/d,2]) + B*q*(c*d^2-a*e^2)*(A+B*x^2)*Sqrt[A^2*(a+b*x^2+c*x^4)/(a*(A+B*x^2)^2) ]/(4*c*d*e*(B*d-A*e)*Sqrt[a+b*x^2+c*x^4])* EllipticPi[-(B*d-A*e)^2/(4*d*e*A*B),2*ArcTan[q*x],1/2-b*A/(4*a*B)] ] /; FreeQ[{a,b,c,d,e,A,B},x] && NeQ[b^2-4*a*c,0] &&  NeQ[c*d^2-b*d*e+a*e^2,0] && NeQ[c*d^2-a*e^2,0] && PosQ[c/a] &&  EqQ[c*A^2-a*B^2,0] *)
(* Int[(A_+B_.*x_^2)/((d_+e_.*x_^2)*Sqrt[a_+c_.*x_^4]),x_Symbol] := With[{q=Rt[B/A,2]}, -(B*d-A*e)*ArcTan[Rt[c*d/e+a*e/d,2]*x/Sqrt[a+c*x^4]]/(2*d*e*Rt[c*d/ e+a*e/d,2]) + B*q*(c*d^2-a*e^2)*(A+B*x^2)*Sqrt[A^2*(a+c*x^4)/(a*(A+B*x^2)^2)]/(4* c*d*e*(B*d-A*e)*Sqrt[a+c*x^4])* EllipticPi[-(B*d-A*e)^2/(4*d*e*A*B),2*ArcTan[q*x],1/2]] /; FreeQ[{a,c,d,e,A,B},x] && NeQ[c*d^2+a*e^2,0] && NeQ[c*d^2-a*e^2,0] &&  PosQ[c/a] && EqQ[c*A^2-a*B^2,0] *)
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[B/A, 2]}, -(B*d - A*e)* ArcTan[Rt[-b + c*d/e + a*e/d, 2]*x/Sqrt[a + b*x^2 + c*x^4]]/(2*d* e*Rt[-b + c*d/e + a*e/d, 2]) + (B*d + A*e)*(A + B*x^2)* Sqrt[A^2*(a + b*x^2 + c*x^4)/(a*(A + B*x^2)^2)]/(4*d*e*A*q* Sqrt[a + b*x^2 + c*x^4])* EllipticPi[Cancel[-(B*d - A*e)^2/(4*d*e*A*B)], 2*ArcTan[q*x], 1/2 - b*A/(4*a*B)]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a] && EqQ[c*A^2 - a*B^2, 0]
Int[(A_ + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[B/A, 2]}, -(B*d - A*e)* ArcTan[Rt[c*d/e + a*e/d, 2]*x/Sqrt[a + c*x^4]]/(2*d*e* Rt[c*d/e + a*e/d, 2]) + (B*d + A*e)*(A + B*x^2)* Sqrt[A^2*(a + c*x^4)/(a*(A + B*x^2)^2)]/(4*d*e*A*q* Sqrt[a + c*x^4])* EllipticPi[Cancel[-(B*d - A*e)^2/(4*d*e*A*B)], 2*ArcTan[q*x], 1/2]] /; FreeQ[{a, c, d, e, A, B}, x] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a] && EqQ[c*A^2 - a*B^2, 0]
Int[(A_. + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, (A*(c*d + a*e*q) - a*B*(e + d*q))/(c*d^2 - a*e^2)* Int[1/Sqrt[a + b*x^2 + c*x^4], x] + a*(B*d - A*e)*(e + d*q)/(c*d^2 - a*e^2)* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a] && NeQ[c*A^2 - a*B^2, 0]
Int[(A_. + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2]}, (A*(c*d + a*e*q) - a*B*(e + d*q))/(c*d^2 - a*e^2)* Int[1/Sqrt[a + c*x^4], x] + a*(B*d - A*e)*(e + d*q)/(c*d^2 - a*e^2)* Int[(1 + q*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e, A, B}, x] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a] && NeQ[c*A^2 - a*B^2, 0]
Int[(A_. + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := B/e*Int[1/Sqrt[a + b*x^2 + c*x^4], x] + (e*A - d*B)/e* Int[1/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && NegQ[c/a]
Int[(A_. + B_.*x_^2)/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := B/e*Int[1/Sqrt[a + c*x^4], x] + (e*A - d*B)/e* Int[1/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e, A, B}, x] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && NegQ[c/a]
Int[P4x_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -C/e^2*Int[(d - e*x^2)/Sqrt[a + b*x^2 + c*x^4], x] + 1/e^2* Int[(C*d^2 + A*e^2 + B*e^2*x^2)/((d + e*x^2)* Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[P4x, x^2, 2] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0]
Int[P4x_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -C/e^2*Int[(d - e*x^2)/Sqrt[a + c*x^4], x] + 1/e^2* Int[(C*d^2 + A*e^2 + B*e^2*x^2)/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[P4x, x^2, 2] && NeQ[c*d^2 + a*e^2, 0] && EqQ[c*d^2 - a*e^2, 0]
Int[P4x_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2], A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -C/(e*q)*Int[(1 - q*x^2)/Sqrt[a + b*x^2 + c*x^4], x] + 1/(c*e)* Int[(A*c*e + a*C*d*q + (B*c*e - C*(c*d - a*e*q))*x^2)/((d + e*x^2)* Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[P4x, x^2, 2] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a] && Not[GtQ[b^2 - 4*a*c, 0]]
Int[P4x_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Rt[c/a, 2], A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -C/(e*q)*Int[(1 - q*x^2)/Sqrt[a + c*x^4], x] + 1/(c*e)* Int[(A*c*e + a*C*d*q + (B*c*e - C*(c*d - a*e*q))*x^2)/((d + e*x^2)* Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[P4x, x^2, 2] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && PosQ[c/a]
Int[P4x_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -1/e^2*Int[(C*d - B*e - C*e*x^2)/Sqrt[a + b*x^2 + c*x^4], x] + (C*d^2 - B*d*e + A*e^2)/e^2* Int[1/((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[P4x, x^2, 2] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0]
Int[P4x_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{A = Coeff[P4x, x, 0], B = Coeff[P4x, x, 2], C = Coeff[P4x, x, 4]}, -1/e^2*Int[(C*d - B*e - C*e*x^2)/Sqrt[a + c*x^4], x] + (C*d^2 - B*d*e + A*e^2)/e^2* Int[1/((d + e*x^2)*Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[P4x, x^2, 2] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0]
Int[Px_/((d_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{q = Expon[Px, x]}, Coeff[Px, x, q]*x^(q - 5)*Sqrt[a + b*x^2 + c*x^4]/(c*e*(q - 3)) + 1/(c*e*(q - 3))* Int[(c*e*(q - 3)*Px - Coeff[Px, x, q]* x^(q - 6)*(d + e*x^2)*(a*(q - 5) + b*(q - 4)*x^2 + c*(q - 3)*x^4))/ ((d + e*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; GtQ[q, 4]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[Px_/((d_ + e_.*x_^2)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{q = Expon[Px, x]}, Coeff[Px, x, q]*x^(q - 5)*Sqrt[a + c*x^4]/(c*e*(q - 3)) + 1/(c*e*(q - 3))* Int[(c*e*(q - 3)*Px - Coeff[Px, x, q]* x^(q - 6)*(d + e*x^2)*(a*(q - 5) + c*(q - 3)*x^4))/((d + e*x^2)*Sqrt[a + c*x^4]), x] /; GtQ[q, 4]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x] && NeQ[c*d^2 + a*e^2, 0]
(* Int[Pq_*(a_+b_.*x_^2+c_.*x_^4)^p_/(d_+e_.*x_^2),x_Symbol] := With[{A=Coeff[PolynomialRemainder[Pq,a+b*x^2+c*x^4,x],x,0], B=Coeff[PolynomialRemainder[Pq,a+b*x^2+c*x^4,x],x,2]}, -B*x*(b^2-2*a*c+b*c*x^2)*(a+b*x^2+c*x^4)^(p+1)/(2*a*e*(p+1)*(b^2-4* a*c)) + (B*d-A*e)*x*(b^2*c*d-2*a*c^2*d-b^3*e+3*a*b*c*e+c*(b*c*d-b^2*e+2*a*c* e)*x^2)*(a+b*x^2+c*x^4)^(p+1)/ (2*a*e*(p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)) + Int[(a+b*x^2+c*x^4)^(p+1)/(d+e*x^2)*ExpandToSum[Pq/(a+b*x^2+c*x^4)-( d+e*x^2)/(a+b*x^2+c*x^4)^(p+1)* D[-B*x*(b^2-2*a*c+b*c*x^2)*(a+b*x^2+c*x^4)^(p+1)/(2*a*e*(p+1)*(b^ 2-4*a*c)) + (B*d-A*e)*x*(b^2*c*d-2*a*c^2*d-b^3*e+3*a*b*c*e+c*(b*c*d-b^2*e+2* a*c*e)*x^2)*(a+b*x^2+c*x^4)^(p+1)/ (2*a*e*(p+1)*(b^2-4*a*c)*(c*d^2-b*d*e+a*e^2)),x],x],x]] /; FreeQ[{a,b,c,d,e},x] && PolyQ[Pq,x^2] && Expon[Pq,x^2]>0 &&  NeQ[b^2-4*a*c,0] && NeQ[c*d^2-b*d*e+a*e^2,0] && LtQ[p,-1] *)
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[1/Sqrt[a + b*x^2 + c*x^4], Px*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x^2] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p + 1/2] && IntegerQ[q]
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_, x_Symbol] := Int[ExpandIntegrand[1/Sqrt[a + c*x^4], Px*(d + e*x^2)^q*(a + c*x^4)^(p + 1/2), x], x] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x^2] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[p + 1/2] && IntegerQ[q]
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Unintegrable[Px*(d + e*x^2)^q*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, e, p, q}, x] && PolyQ[Px, x]
Int[Px_*(d_ + e_.*x_^2)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Unintegrable[Px*(d + e*x^2)^q*(a + c*x^4)^p, x] /; FreeQ[{a, c, d, e, p, q}, x] && PolyQ[Px, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.2 Quartic/1.2.2.8 P(x) (d+e x)^q (a+b x^2+c x^4)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.2.8 P(x) (d+e x)^q (a+b x^2+c x^4)^p *)
Int[1/((d_ + e_.*x_)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := d*Int[1/((d^2 - e^2*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] - e*Int[x/((d^2 - e^2*x^2)*Sqrt[a + b*x^2 + c*x^4]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[1/((d_ + e_.*x_)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := d*Int[1/((d^2 - e^2*x^2)*Sqrt[a + c*x^4]), x] - e*Int[x/((d^2 - e^2*x^2)*Sqrt[a + c*x^4]), x] /; FreeQ[{a, c, d, e}, x]
Int[(d_ + e_.*x_)^q_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := e^3*(d + e*x)^(q + 1)* Sqrt[a + b*x^2 + c*x^4]/((q + 1)*(c*d^4 + b*d^2*e^2 + a*e^4)) + 1/((q + 1)*(c*d^4 + b*d^2*e^2 + a*e^4))* Int[(d + e*x)^(q + 1)/Sqrt[a + b*x^2 + c*x^4]* Simp[d*(q + 1)*(c*d^2 + b*e^2) - e*(c*d^2*(q + 1) + b*e^2*(q + 2))*x + c*d*e^2*(q + 1)*x^2 - c*e^3*(q + 3)*x^3, x], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c*d^4 + b*d^2*e^2 + a*e^4, 0] && ILtQ[q, -1]
Int[(d_ + e_.*x_)^q_/Sqrt[a_ + c_.*x_^4], x_Symbol] := e^3*(d + e*x)^(q + 1)*Sqrt[a + c*x^4]/((q + 1)*(c*d^4 + a*e^4)) + c/((q + 1)*(c*d^4 + a*e^4))* Int[(d + e*x)^(q + 1)/Sqrt[a + c*x^4]* Simp[d^3*(q + 1) - d^2*e*(q + 1)*x + d*e^2*(q + 1)*x^2 - e^3*(q + 3)*x^3, x], x] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^4 + a*e^4, 0] && ILtQ[q, -1]
Int[(a_ + b_.*x_^2 + c_.*x_^4)^p_./(d_ + e_.*x_), x_Symbol] := d*Int[(a + b*x^2 + c*x^4)^p/(d^2 - e^2*x^2), x] - e*Int[x*(a + b*x^2 + c*x^4)^p/(d^2 - e^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p + 1/2]
Int[(a_ + c_.*x_^4)^p_./(d_ + e_.*x_), x_Symbol] := d*Int[(a + c*x^4)^p/(d^2 - e^2*x^2), x] - e*Int[x*(a + c*x^4)^p/(d^2 - e^2*x^2), x] /; FreeQ[{a, c, d, e}, x] && IntegerQ[p + 1/2]
Int[Px_*(d_ + e_.*x_)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[PolynomialQuotient[Px, d + e*x, x]*(d + e*x)^(q + 1)*(a + b*x^2 + c*x^4)^p, x] /; FreeQ[{a, b, c, d, e, p, q}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, d + e*x, x], 0]
Int[Px_*(d_ + e_.*x_)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[PolynomialQuotient[Px, d + e*x, x]*(d + e*x)^(q + 1)*(a + c*x^4)^p, x] /; FreeQ[{a, c, d, e, p, q}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, d + e*x, x], 0]
Int[Px_*(d_ + e_.*x_)^q_.*(a_ + b_.*x_^2 + c_.*x_^4)^p_., x_Symbol] := Int[PolynomialQuotient[Px, a + b*x^2 + c*x^4, x]*(d + e*x)^ q*(a + b*x^2 + c*x^4)^(p + 1), x] /; FreeQ[{a, b, c, d, e, p, q}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, a + b*x^2 + c*x^4, x], 0]
Int[Px_*(d_ + e_.*x_)^q_.*(a_ + c_.*x_^4)^p_., x_Symbol] := Int[PolynomialQuotient[Px, a + c*x^4, x]*(d + e*x)^ q*(a + c*x^4)^(p + 1), x] /; FreeQ[{a, c, d, e, p, q}, x] && PolyQ[Px, x] && EqQ[PolynomialRemainder[Px, a + c*x^4, x], 0]
Int[Px_*(d_ + e_.*x_)^q_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, Int[(d + e*x)^(q - 1)*(A*d + (B*d + A*e)*x + (C*d + B*e)*x^2 + C*e*x^3)/Sqrt[a + b*x^2 + c*x^4], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x] && LeQ[Expon[Px, x], 2] && NeQ[c*d^4 + b*d^2*e^2 + a*e^4, 0] && GtQ[q, 0]
Int[Px_*(d_ + e_.*x_)^q_/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, Int[(d + e*x)^(q - 1)*(A*d + (B*d + A*e)*x + (C*d + B*e)*x^2 + C*e*x^3)/Sqrt[a + c*x^4], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x] && LeQ[Expon[Px, x], 2] && NeQ[c*d^4 + a*e^4, 0] && GtQ[q, 0]
Int[Px_*(d_ + e_.*x_)^q_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, D*(d + e*x)^q*Sqrt[a + b*x^2 + c*x^4]/(c*(q + 2)) - 1/(c*(q + 2))*Int[(d + e*x)^(q - 1)/Sqrt[a + b*x^2 + c*x^4]* Simp[a*D*e*q - A*c*d*(q + 2) + (b*d*D - B*c*d*(q + 2) - A*c*e*(q + 2))*x + (b*D*e*(q + 1) - c*(C*d + B*e)*(q + 2))*x^2 - c*(d*D*q + C*e*(q + 2))*x^3, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x, 3] && NeQ[c*d^4 + b*d^2*e^2 + a*e^4, 0] && GtQ[q, 0]
Int[Px_*(d_ + e_.*x_)^q_/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, D*(d + e*x)^q*Sqrt[a + c*x^4]/(c*(q + 2)) - 1/(c*(q + 2))*Int[(d + e*x)^(q - 1)/Sqrt[a + c*x^4]* Simp[a*D*e*q - A*c*d*(q + 2) - c*(B*d*(q + 2) + A*e*(q + 2))*x - c*(C*d + B*e)*(q + 2)*x^2 - c*(d*D*q + C*e*(q + 2))*x^3, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x, 3] && NeQ[c*d^4 + a*e^4, 0] && GtQ[q, 0]
Int[Px_*(d_ + e_.*x_)^q_/Sqrt[a_ + b_.*x_^2 + c_.*x_^4], x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, -(d^3*D - C*d^2*e + B*d*e^2 - A*e^3)*(d + e*x)^(q + 1)* Sqrt[a + b*x^2 + c*x^4]/((q + 1)*(c*d^4 + b*d^2*e^2 + a*e^4)) + 1/((q + 1)*(c*d^4 + b*d^2*e^2 + a*e^4))* Int[((d + e*x)^(q + 1)/Sqrt[a + b*x^2 + c*x^4])* Simp[(q + 1)*(a*e*(d^2*D - C*d*e + B*e^2) + A*d*(c*d^2 + b*e^2)) - (e*(q + 1)*(A*c*d^2 + a*e*(d*D - C*e)) - B*d*(c*d^2*(q + 1) + b*e^2*(q + 2)) - b*(d^3*D - C*d^2*e - A*e^3*(q + 2)))*x + (q + 1)*(D*e*(b*d^2 + a*e^2) + c*d*(C*d^2 - e*(B*d - A*e)))*x^2 + c*(q + 3)*(d^3*D - C*d^2*e + B*d*e^2 - A*e^3)*x^3, x], x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x] && LeQ[Expon[Px, x], 3] && NeQ[c*d^4 + b*d^2*e^2 + a*e^4, 0] && LtQ[q, -1]
Int[Px_*(d_ + e_.*x_)^q_/Sqrt[a_ + c_.*x_^4], x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, -(d^3*D - C*d^2*e + B*d*e^2 - A*e^3)*(d + e*x)^(q + 1)* Sqrt[a + c*x^4]/((q + 1)*(c*d^4 + a*e^4)) + 1/((q + 1)*(c*d^4 + a*e^4))* Int[((d + e*x)^(q + 1)/Sqrt[a + c*x^4])* Simp[(q + 1)*(a*e*(d^2*D - C*d*e + B*e^2) + A*d*(c*d^2)) - (e*(q + 1)*(A*c*d^2 + a*e*(d*D - C*e)) - B*d*(c*d^2*(q + 1)))*x + (q + 1)*(D*e*(a*e^2) + c*d*(C*d^2 - e*(B*d - A*e)))* x^2 + c*(q + 3)*(d^3*D - C*d^2*e + B*d*e^2 - A*e^3)*x^3, x], x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x] && LeQ[Expon[Px, x], 3] && NeQ[c*d^4 + a*e^4, 0] && LtQ[q, -1]
Int[(A_ + B_.*x_)/((d_ + e_.*x_)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := -A^2*(B*d + A*e)/e* Subst[Int[1/(6*A^3*B*d + 3*A^4*e - a*e*x^2), x], x, (A + B*x)^2/Sqrt[a + b*x^2 + c*x^4]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[B*d - A*e, 0] && EqQ[c^2*d^6 + a*e^4*(13*c*d^2 + b*e^2), 0] && EqQ[b^2*e^4 - 12*c*d^2*(c*d^2 - b*e^2), 0] && EqQ[4*A*c*d*e + B*(2*c*d^2 - b*e^2), 0]
Int[Px_/((d_ + e_.*x_)*Sqrt[a_ + b_.*x_^2 + c_.*x_^4]), x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, Int[(x*(B*d - A*e + (d*D - C*e)*x^2))/((d^2 - e^2*x^2)* Sqrt[a + b*x^2 + c*x^4]), x] + Int[(A*d + (C*d - B*e)*x^2 - D*e*x^4)/((d^2 - e^2*x^2)* Sqrt[a + b*x^2 + c*x^4]), x]] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x] && LeQ[Expon[Px, x], 3] && NeQ[c*d^4 + b*d^2*e^2 + a*e^4, 0]
Int[Px_/((d_ + e_.*x_)*Sqrt[a_ + c_.*x_^4]), x_Symbol] := With[{A = Coeff[Px, x, 0], B = Coeff[Px, x, 1], C = Coeff[Px, x, 2], D = Coeff[Px, x, 3]}, Int[(x*(B*d - A*e + (d*D - C*e)*x^2))/((d^2 - e^2*x^2)* Sqrt[a + c*x^4]), x] + Int[(A*d + (C*d - B*e)*x^2 - D*e*x^4)/((d^2 - e^2*x^2)* Sqrt[a + c*x^4]), x]] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x] && LeQ[Expon[Px, x], 3] && NeQ[c*d^4 + a*e^4, 0]
Int[Px_*(a_ + b_.*x_^2 + c_.*x_^4)^p_./(d_ + e_.*x_), x_Symbol] := d*Int[Px*(a + b*x^2 + c*x^4)^p/(d^2 - e^2*x^2), x] - e*Int[x*Px*(a + b*x^2 + c*x^4)^p/(d^2 - e^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x] && IntegerQ[p + 1/2]
Int[Px_*(a_ + c_.*x_^4)^p_./(d_ + e_.*x_), x_Symbol] := d*Int[Px*(a + c*x^4)^p/(d^2 - e^2*x^2), x] - e*Int[x*Px*(a + c*x^4)^p/(d^2 - e^2*x^2), x] /; FreeQ[{a, c, d, e}, x] && PolyQ[Px, x] && IntegerQ[p + 1/2]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.3 General/1.2.3.1 (a+b x^n+c x^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.3.1 (a+b x^n+c x^(2 n))^p *)
Int[(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(2*n*p)*(c + b*x^(-n) + a*x^(-2*n))^p, x] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && LtQ[n, 0] && IntegerQ[p]
Int[(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*x^(k*n) + c*x^(2*k*n))^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && FractionQ[n]
Int[(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -Subst[Int[(a + b*x^(-n) + c*x^(-2*n))^p/x^2, x], x, 1/x] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^p/(b + 2*c*x^n)^(2*p)* Int[(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -x*(b^2 - 2*a*c + b*c*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a* n*(p + 1)*(b^2 - 4*a*c)) + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(b^2 - 2*a*c + n*(p + 1)*(b^2 - 4*a*c) + b*c*(n*(2*p + 3) + 1)*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1), x] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p, -1]
Int[1/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*q*r)*Int[(r - x^(n/2))/(q - r*x^(n/2) + x^n), x] + 1/(2*c*q*r)*Int[(r + x^(n/2))/(q + r*x^(n/2) + x^n), x]]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n/2, 0] && NegQ[b^2 - 4*a*c]
Int[1/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, c/q*Int[1/(b/2 - q/2 + c*x^n), x] - c/q*Int[1/(b/2 + q/2 + c*x^n), x]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^n + c*x^(2*n))^FracPart[p]/ ((1 + 2*c*x^n/(b + Rt[b^2 - 4*a*c, 2]))^ FracPart[p]*(1 + 2*c*x^n/(b - Rt[b^2 - 4*a*c, 2]))^FracPart[p])* Int[(1 + 2*c*x^n/(b + Sqrt[b^2 - 4*a*c]))^ p*(1 + 2*c*x^n/(b - Sqrt[b^2 - 4*a*c]))^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_ + b_.*u_^n_ + c_.*u_^n2_.)^p_, x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*x^n + c*x^(2*n))^p, x], x, u] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && LinearQ[u, x] && NeQ[u, x]
Int[(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := Int[(b + a*x^n + c*x^(2*n))^p/x^(n*p), x] /; FreeQ[{a, b, c, n}, x] && EqQ[mn, -n] && IntegerQ[p] && PosQ[n]
Int[(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_, x_Symbol] := x^(n*FracPart[p])*(a + b*x^(-n) + c*x^n)^ FracPart[p]/(b + a*x^n + c*x^(2*n))^FracPart[p]* Int[(b + a*x^n + c*x^(2*n))^p/x^(n*p), x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[mn, -n] && Not[IntegerQ[p]] && PosQ[n]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.3 General/1.2.3.2 (d x)^m (a+b x^n+c x^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.3.2 (d x)^m (a+b x^n+c x^(2 n))^p *)
(* Int[(d_.*x_)^m_.*(b_.*x_^n_+c_.*x_^n2_.)^p_.,x_Symbol] := d^m*Int[x^(m+n*p)*(b+c*x^n)^p,x] /; FreeQ[{b,c,d,m,n},x] && EqQ[n2,2*n] && IntegerQ[p] && (IntegerQ[m] ||  GtQ[d,0]) *)
(* Int[(d_.*x_)^m_.*(b_.*x_^n_+c_.*x_^n2_.)^p_.,x_Symbol] := 1/d^(n*p)*Int[(d*x)^(m+n*p)*(b+c*x^n)^p,x] /; FreeQ[{b,c,d,m},x] && EqQ[n2,2*n] && IntegerQ[p] && IntegerQ[n] *)
(* Int[(d_.*x_)^m_.*(b_.*x_^n_+c_.*x_^n2_.)^p_.,x_Symbol] := (d*x)^m/x^m*Int[x^(m+n*p)*(b+c*x^n)^p,x] /; FreeQ[{b,c,d,m,n},x] && EqQ[n2,2*n] && IntegerQ[p] && Not[IntegerQ[m]  || GtQ[d,0]] *)
(* Int[(d_.*x_)^m_.*(b_.*x_^n_+c_.*x_^n2_.)^p_,x_Symbol] := (b*x^n+c*x^(2*n))^p/((d*x)^(n*p)*(b+c*x^n)^p)*Int[(d*x)^(m+n*p)*(b+ c*x^2)^p,x] /; FreeQ[{b,c,d,m,n,p},x] && EqQ[n2,2*n] && Not[IntegerQ[p]] *)
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[Int[(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[Simplify[m - n + 1], 0]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[ExpandIntegrand[(d*x)^m*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[n2, 2*n] && IGtQ[p, 0] && Not[IntegerQ[Simplify[(m + 1)/n]]]
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := Int[x^(m + 2*n*p)*(c + b*x^(-n) + a*x^(-2*n))^p, x] /; FreeQ[{a, b, c, m, n}, x] && EqQ[n2, 2*n] && ILtQ[p, 0] && NegQ[n]
(* Int[(d_.*x_)^m_.*(a_+b_.*x_^n_.+c_.*x_^n2_.)^p_,x_Symbol] := 1/c^p*Int[(d*x)^m*(b/2+c*x^n)^(2*p),x] /; FreeQ[{a,b,c,d,m,n,p},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] &&  IntegerQ[p] *)
(* Int[(d_.*x_)^m_.*(a_+b_.*x_^n_+c_.*x_^n2_.)^p_,x_Symbol] := (d*x)^(m+1)*(a+b*x^n+c*x^(2*n))^(p+1)/(2*a*d*n*(p+1)*(2*p+1)) - (d*x)^(m+1)*(2*a+b*x^n)*(a+b*x^n+c*x^(2*n))^p/(2*a*d*n*(2*p+1)) /; FreeQ[{a,b,c,d,m,n,p},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] &&  Not[IntegerQ[p]] && EqQ[m+2*n*(p+1)+1,0] && NeQ[2*p+1,0] *)
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x^n)^(2*FracPart[p]))* Int[(d*x)^m*(b/2 + c*x^n)^(2*p), x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p - 1/2]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^n + c*x^(2*n))^ FracPart[p]/(1 + 2*c*x^n/b)^(2*FracPart[p])* Int[(d*x)^m*(1 + 2*c*x^n/b)^(2*p), x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[2*p]]
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[(m + 1)/n]]
Int[(d_*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = GCD[m + 1, n]}, 1/k* Subst[Int[x^((m + 1)/k - 1)*(a + b*x^(n/k) + c*x^(2*n/k))^p, x], x, x^k] /; k != 1] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[(d_.*x_)^m_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = Denominator[m]}, k/d* Subst[Int[ x^(k*(m + 1) - 1)*(a + b*x^(k*n)/d^n + c*x^(2*k*n)/d^(2*n))^p, x], x, (d*x)^(1/k)]] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && FractionQ[m] && IntegerQ[p]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^(n - 1)*(d*x)^(m - n + 1)*(a + b*x^n + c*x^(2*n))^ p*(b*n*p + c*(m + n*(2*p - 1) + 1)* x^n)/(c*(m + 2*n*p + 1)*(m + n*(2*p - 1) + 1)) - n*p*d^n/(c*(m + 2*n*p + 1)*(m + n*(2*p - 1) + 1))* Int[(d*x)^(m - n)*(a + b*x^n + c*x^(2*n))^(p - 1)* Simp[a*b*(m - n + 1) - (2*a*c*(m + n*(2*p - 1) + 1) - b^2*(m + n*(p - 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[p, 0] && GtQ[m, n - 1] && NeQ[m + 2*n*p + 1, 0] && NeQ[m + n*(2*p - 1) + 1, 0]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^p/(d*(m + 1)) - n*p/(d^n*(m + 1))* Int[(d*x)^(m + n)*(b + 2*c*x^n)*(a + b*x^n + c*x^(2*n))^(p - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[p, 0] && LtQ[m, -1]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^p/(d*(m + 2*n*p + 1)) + n*p/(m + 2*n*p + 1)* Int[(d*x)^m*(2*a + b*x^n)*(a + b*x^n + c*x^(2*n))^(p - 1), x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[p, 0] && NeQ[m + 2*n*p + 1, 0]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^(n - 1)*(d*x)^(m - n + 1)*(b + 2*c*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(n*(p + 1)*(b^2 - 4*a*c)) - d^n/(n*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^(m - n)*(b*(m - n + 1) + 2*c*(m + 2*n*(p + 1) + 1)*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && ILtQ[p, -1] && GtQ[m, n - 1] && LeQ[m, 2*n - 1]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -d^(2*n - 1)*(d*x)^(m - 2*n + 1)*(2*a + b*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(n*(p + 1)*(b^2 - 4*a*c)) + d^(2*n)/(n*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^(m - 2*n)*(2*a*(m - 2*n + 1) + b*(m + n*(2*p + 1) + 1)*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && ILtQ[p, -1] && GtQ[m, 2*n - 1]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -(d*x)^(m + 1)*(b^2 - 2*a*c + b*c*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*d* n*(p + 1)*(b^2 - 4*a*c)) + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^m*(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[b^2*(m + n*(p + 1) + 1) - 2*a*c*(m + 2*n*(p + 1) + 1) + b*c*(m + n*(2*p + 3) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && ILtQ[p, -1]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^(2*n - 1)*(d*x)^(m - 2*n + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(c*(m + 2*n*p + 1)) - d^(2*n)/(c*(m + 2*n*p + 1))* Int[(d*x)^(m - 2*n)* Simp[a*(m - 2*n + 1) + b*(m + n*(p - 1) + 1)*x^n, x]*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[m, 2*n - 1] && NeQ[m + 2*n*p + 1, 0] && IntegerQ[p]
Int[(d_.*x_)^m_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*d*(m + 1)) - 1/(a*d^n*(m + 1))* Int[(d*x)^(m + n)*(b*(m + n*(p + 1) + 1) + c*(m + 2*n*(p + 1) + 1)*x^n)*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[m, -1] && IntegerQ[p]
Int[(d_.*x_)^m_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := (d*x)^(m + 1)/(a*d*(m + 1)) - 1/(a*d^n)* Int[(d*x)^(m + n)*(b + c*x^n)/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[m, -1]
Int[x_^m_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := Int[PolynomialDivide[x^m, (a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[m, 3*n - 1]
Int[(d_.*x_)^m_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := d^(2*n - 1)*(d*x)^(m - 2*n + 1)/(c*(m - 2*n + 1)) - d^(2*n)/c* Int[(d*x)^(m - 2*n)*(a + b*x^n)/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[m, 2*n - 1]
Int[x_^m_./(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*r)* Int[x^(m - 3*(n/2))*(q + r*x^(n/2))/(q + r*x^(n/2) + x^n), x] - 1/(2*c*r)* Int[x^(m - 3*(n/2))*(q - r*x^(n/2))/(q - r*x^(n/2) + x^n), x]]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n/2, 0] && IGtQ[m, 0] && GeQ[m, 3*n/2] && LtQ[m, 2*n] && NegQ[b^2 - 4*a*c]
Int[x_^m_./(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*r)*Int[x^(m - n/2)/(q - r*x^(n/2) + x^n), x] - 1/(2*c*r)*Int[x^(m - n/2)/(q + r*x^(n/2) + x^n), x]]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n/2, 0] && IGtQ[m, 0] && GeQ[m, n/2] && LtQ[m, 3*n/2] && NegQ[b^2 - 4*a*c]
Int[(d_.*x_)^m_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, d^n/2*(b/q + 1)*Int[(d*x)^(m - n)/(b/2 + q/2 + c*x^n), x] - d^n/2*(b/q - 1)*Int[(d*x)^(m - n)/(b/2 - q/2 + c*x^n), x]] /; FreeQ[{a, b, c, d}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GeQ[m, n]
Int[(d_.*x_)^m_./(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, c/q*Int[(d*x)^m/(b/2 - q/2 + c*x^n), x] - c/q*Int[(d*x)^m/(b/2 + q/2 + c*x^n), x]] /; FreeQ[{a, b, c, d, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0]
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -Subst[Int[(a + b*x^(-n) + c*x^(-2*n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && IntegerQ[m]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = Denominator[m]}, -k/d* Subst[Int[(a + b*d^(-n)*x^(-k*n) + c*d^(-2*n)*x^(-2*k*n))^p/ x^(k*(m + 1) + 1), x], x, 1/(d*x)^(1/k)]] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && FractionQ[m]
Int[(d_.*x_)^m_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -d^IntPart[m]*(d*x)^FracPart[m]*(x^(-1))^FracPart[m]* Subst[Int[(a + b*x^(-n) + c*x^(-2*n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[ Int[x^(k*(m + 1) - 1)*(a + b*x^(k*n) + c*x^(2*k*n))^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[(d_*x_)^m_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[x_^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*x^Simplify[n/(m + 1)] + c*x^Simplify[2*n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(d_*x_)^m_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(d_.*x_)^m_./(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[(d*x)^m/(b - q + 2*c*x^n), x] - 2*c/q*Int[(d*x)^m/(b + q + 2*c*x^n), x]] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -(d*x)^(m + 1)*(b^2 - 2*a*c + b*c*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*d* n*(p + 1)*(b^2 - 4*a*c)) + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(d*x)^m*(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[b^2*(n*(p + 1) + m + 1) - 2*a*c*(m + 2*n*(p + 1) + 1) + b*c*(2*n*p + 3*n + m + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p + 1, 0]
Int[(d_.*x_)^m_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := a^IntPart[p]*(a + b*x^n + c*x^(2*n))^FracPart[p]/ ((1 + 2*c*x^n/(b + Rt[b^2 - 4*a*c, 2]))^ FracPart[p]*(1 + 2*c*x^n/(b - Rt[b^2 - 4*a*c, 2]))^FracPart[p])* Int[(d*x)^m*(1 + 2*c*x^n/(b + Sqrt[b^2 - 4*a*c]))^ p*(1 + 2*c*x^n/(b - Sqrt[b^2 - 4*a*c]))^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n]
Int[x_^m_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := Int[x^(m - n*p)*(b + a*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, m, n}, x] && EqQ[mn, -n] && IntegerQ[p] && PosQ[n]
Int[x_^m_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := x^(n*FracPart[p])*(a + b/x^n + c*x^n)^ FracPart[p]/(b + a*x^n + c*x^(2*n))^FracPart[p]* Int[x^(m - n*p)*(b + a*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[mn, -n] && Not[IntegerQ[p]] && PosQ[n]
Int[(d_*x_)^m_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*x^(-n) + c*x^n)^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[mn, -n]
Int[x_^m_.*(a_. + b_.*v_^n_ + c_.*v_^n2_.)^p_., x_Symbol] := 1/Coefficient[v, x, 1]^(m + 1)* Subst[Int[ SimplifyIntegrand[(x - Coefficient[v, x, 0])^ m*(a + b*x^n + c*x^(2*n))^p, x], x], x, v] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && LinearQ[v, x] && IntegerQ[m] && NeQ[v, x]
Int[u_^m_.*(a_. + b_.*v_^n_ + c_.*v_^n2_.)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(a + b*x^n + c*x^(2*n))^p, x], x, v] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && LinearPairQ[u, v, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.3 General/1.2.3.3 (d+e x^n)^q (a+b x^n+c x^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.3.3 (d+e x^n)^q (a+b x^n+c x^(2 n))^p *)
(* Int[(d_+e_.*x_^n_.)^q_.*(a_+b_.*x_^n_.+c_.*x_^n2_.)^p_,x_Symbol] := 1/c^p*Int[(d+e*x^n)^q*(b/2+c*x^n)^(2*p),x] /; FreeQ[{a,b,c,d,e,n,p,q},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] &&  IntegerQ[p] *)
Int[(d_ + e_.*x_^n_.)^q_.*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^p/(d + e*x^n)^(2*p)* Int[(d + e*x^n)^(q + 2*p), x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && EqQ[2*c*d - b*e, 0]
Int[(d_ + e_.*x_^n_.)^q_.*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x^n)^(2*FracPart[p]))* Int[(d + e*x^n)^q*(b/2 + c*x^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(n*(2*p + q))*(e + d*x^(-n))^q*(c + b*x^(-n) + a*x^(-2*n))^p, x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegersQ[p, q] && NegQ[n]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(n*(2*p + q))*(e + d*x^(-n))^q*(c + a*x^(-2*n))^p, x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegersQ[p, q] && NegQ[n]
Int[(d_ + e_.*x_^n_)^q_.*(a_. + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := -Subst[Int[(d + e*x^(-n))^q*(a + b*x^(-n) + c*x^(-2*n))^p/x^2, x], x, 1/x] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[n2, 2*n] && ILtQ[n, 0]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_)^p_, x_Symbol] := -Subst[Int[(d + e*x^(-n))^q*(a + c*x^(-2*n))^p/x^2, x], x, 1/x] /; FreeQ[{a, c, d, e, p, q}, x] && EqQ[n2, 2*n] && ILtQ[n, 0]
Int[(d_ + e_.*x_^n_)^q_.*(a_. + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g - 1)*(d + e*x^(g*n))^q*(a + b*x^(g*n) + c*x^(2*g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[n2, 2*n] && FractionQ[n]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := With[{g = Denominator[n]}, g*Subst[Int[x^(g - 1)*(d + e*x^(g*n))^q*(a + c*x^(2*g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, c, d, e, p, q}, x] && EqQ[n2, 2*n] && FractionQ[n]
Int[(d_ + e_.*x_^n_)*(b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := (b*e - d*c)*(b*x^n + c*x^(2*n))^(p + 1)/(b*c*n*(p + 1)* x^(2*n*(p + 1))) + e/c*Int[x^(-n)*(b*x^n + c*x^(2*n))^(p + 1), x] /; FreeQ[{b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[p]] && EqQ[n*(2*p + 1) + 1, 0]
Int[(d_ + e_.*x_^n_)*(b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := e*x^(-n + 1)*(b*x^n + c*x^(2*n))^(p + 1)/(c*(n*(2*p + 1) + 1)) /; FreeQ[{b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[p]] && NeQ[n*(2*p + 1) + 1, 0] && EqQ[b*e*(n*p + 1) - c*d*(n*(2*p + 1) + 1), 0]
Int[(d_ + e_.*x_^n_)*(b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := e*x^(-n + 1)*(b*x^n + c*x^(2*n))^(p + 1)/(c*(n*(2*p + 1) + 1)) - (b*e*(n*p + 1) - c*d*(n*(2*p + 1) + 1))/(c*(n*(2*p + 1) + 1))* Int[(b*x^n + c*x^(2*n))^p, x] /; FreeQ[{b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[p]] && NeQ[n*(2*p + 1) + 1, 0] && NeQ[b*e*(n*p + 1) - c*d*(n*(2*p + 1) + 1), 0]
Int[(d_ + e_.*x_^n_)^q_.*(b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := (b*x^n + c*x^(2*n))^ FracPart[p]/(x^(n*FracPart[p])*(b + c*x^n)^FracPart[p])* Int[x^(n*p)*(d + e*x^n)^q*(b + c*x^n)^p, x] /; FreeQ[{b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(d + e*x^n)^(p + q)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(d + e*x^n)^(p + q)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, c, d, e, n, q}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[ p]/((d + e*x^n)^FracPart[p]*(a/d + c*x^n/e)^FracPart[p])* Int[(d + e*x^n)^(p + q)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := (a + c*x^(2*n))^ FracPart[ p]/((d + e*x^n)^FracPart[p]*(a/d + c*x^n/e)^FracPart[p])* Int[(d + e*x^n)^(p + q)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q*(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[q, 0]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_), x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q*(a + c*x^(2*n)), x], x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && IGtQ[q, 0]
Int[(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := -(c*d^2 - b*d*e + a*e^2)* x*(d + e*x^n)^(q + 1)/(d*e^2*n*(q + 1)) + 1/(n*(q + 1)*d*e^2)* Int[(d + e*x^n)^(q + 1)* Simp[c*d^2 - b*d*e + a*e^2*(n*(q + 1) + 1) + c*d*e*n*(q + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && LtQ[q, -1]
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_), x_Symbol] := -(c*d^2 + a*e^2)*x*(d + e*x^n)^(q + 1)/(d*e^2*n*(q + 1)) + 1/(n*(q + 1)*d*e^2)* Int[(d + e*x^n)^(q + 1)* Simp[c*d^2 + a*e^2*(n*(q + 1) + 1) + c*d*e*n*(q + 1)*x^n, x], x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && LtQ[q, -1]
Int[(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := c*x^(n + 1)*(d + e*x^n)^(q + 1)/(e*(n*(q + 2) + 1)) + 1/(e*(n*(q + 2) + 1))* Int[(d + e*x^n)^ q*(a*e*(n*(q + 2) + 1) - (c*d*(n + 1) - b*e*(n*(q + 2) + 1))* x^n), x] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0]
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_), x_Symbol] := c*x^(n + 1)*(d + e*x^n)^(q + 1)/(e*(n*(q + 2) + 1)) + 1/(e*(n*(q + 2) + 1))* Int[(d + e*x^n)^q*(a*e*(n*(q + 2) + 1) - c*d*(n + 1)*x^n), x] /; FreeQ[{a, c, d, e, n, q}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0]
Int[(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[2*d*e, 2]}, e^2/(2*c)*Int[1/(d + q*x^(n/2) + e*x^n), x] + e^2/(2*c)*Int[1/(d - q*x^(n/2) + e*x^n), x]] /; FreeQ[{a, c, d, e}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 - a*e^2, 0] && IGtQ[n/2, 0] && PosQ[d*e]
Int[(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[-2*d*e, 2]}, d/(2*a)*Int[(d - q*x^(n/2))/(d - q*x^(n/2) - e*x^n), x] + d/(2*a)*Int[(d + q*x^(n/2))/(d + q*x^(n/2) - e*x^n), x]] /; FreeQ[{a, c, d, e}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 - a*e^2, 0] && IGtQ[n/2, 0] && NegQ[d*e]
Int[(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a/c, 4]}, 1/(2*Sqrt[2]*c*q^3)* Int[(Sqrt[2]*d*q - (d - e*q^2)*x^(n/2))/(q^2 - Sqrt[2]*q*x^(n/2) + x^n), x] + 1/(2*Sqrt[2]*c*q^3)* Int[(Sqrt[2]*d*q + (d - e*q^2)*x^(n/2))/(q^2 + Sqrt[2]*q*x^(n/2) + x^n), x]] /; FreeQ[{a, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && NeQ[c*d^2 - a*e^2, 0] && IGtQ[n/2, 0] && PosQ[a*c]
Int[(d_ + e_.*x_^3)/(a_ + c_.*x_^6), x_Symbol] := With[{q = Rt[c/a, 6]}, 1/(3*a*q^2)*Int[(q^2*d - e*x)/(1 + q^2*x^2), x] + 1/(6*a*q^2)* Int[(2*q^2*d - (Sqrt[3]*q^3*d - e)*x)/(1 - Sqrt[3]*q*x + q^2*x^2), x] + 1/(6*a*q^2)* Int[(2*q^2*d + (Sqrt[3]*q^3*d + e)*x)/(1 + Sqrt[3]*q*x + q^2*x^2), x]] /; FreeQ[{a, c, d, e}, x] && NeQ[c*d^2 + a*e^2, 0] && PosQ[c/a]
Int[(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[-a/c, 2]}, (d + e*q)/2*Int[1/(a + c*q*x^n), x] + (d - e*q)/2* Int[1/(a - c*q*x^n), x]] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && NegQ[a*c] && IntegerQ[n]
Int[(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := d*Int[1/(a + c*x^(2*n)), x] + e*Int[x^n/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && (PosQ[a*c] || Not[IntegerQ[n]])
Int[(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[2*d/e - b/c, 2]}, e/(2*c)*Int[1/Simp[d/e + q*x^(n/2) + x^n, x], x] + e/(2*c)*Int[1/Simp[d/e - q*x^(n/2) + x^n, x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && IGtQ[n/2, 0] && (GtQ[2*d/e - b/c, 0] || Not[LtQ[2*d/e - b/c, 0]] && EqQ[d, e*Rt[a/c, 2]])
Int[(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (e/2 + (2*c*d - b*e)/(2*q))* Int[1/(b/2 - q/2 + c*x^n), x] + (e/2 - (2*c*d - b*e)/(2*q))* Int[1/(b/2 + q/2 + c*x^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && IGtQ[n/2, 0] && GtQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[-2*d/e - b/c, 2]}, e/(2*c*q)* Int[(q - 2*x^(n/2))/Simp[d/e + q*x^(n/2) - x^n, x], x] + e/(2*c*q)* Int[(q + 2*x^(n/2))/Simp[d/e - q*x^(n/2) - x^n, x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - a*e^2, 0] && IGtQ[n/2, 0] && Not[GtQ[b^2 - 4*a*c, 0]]
Int[(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (e/2 + (2*c*d - b*e)/(2*q))* Int[1/(b/2 - q/2 + c*x^n), x] + (e/2 - (2*c*d - b*e)/(2*q))* Int[1/(b/2 + q/2 + c*x^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && (PosQ[b^2 - 4*a*c] || Not[IGtQ[n/2, 0]])
Int[(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a/c, 2]}, With[{r = Rt[2*q - b/c, 2]}, 1/(2*c*q*r)* Int[(d*r - (d - e*q)*x^(n/2))/(q - r*x^(n/2) + x^n), x] + 1/(2*c*q*r)* Int[(d*r + (d - e*q)*x^(n/2))/(q + r*x^(n/2) + x^n), x]]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IGtQ[n/2, 0] && NegQ[b^2 - 4*a*c]
Int[(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[q]
Int[(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_), x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q/(a + c*x^(2*n)), x], x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && IntegerQ[q]
Int[(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := e^2/(c*d^2 - b*d*e + a*e^2)*Int[(d + e*x^n)^q, x] + 1/(c*d^2 - b*d*e + a*e^2)* Int[(d + e*x^n)^(q + 1)*(c*d - b*e - c*e*x^n)/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_), x_Symbol] := e^2/(c*d^2 + a*e^2)*Int[(d + e*x^n)^q, x] + c/(c*d^2 + a*e^2)* Int[(d + e*x^n)^(q + 1)*(d - e*x^n)/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{r = Rt[b^2 - 4*a*c, 2]}, 2*c/r*Int[(d + e*x^n)^q/(b - r + 2*c*x^n), x] - 2*c/r*Int[(d + e*x^n)^q/(b + r + 2*c*x^n), x]] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[q]]
Int[(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_), x_Symbol] := With[{r = Rt[-a*c, 2]}, -c/(2*r)*Int[(d + e*x^n)^q/(r - c*x^n), x] - c/(2*r)*Int[(d + e*x^n)^q/(r + c*x^n), x]] /; FreeQ[{a, c, d, e, n, q}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[q]]
Int[(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := -x*(d*b^2 - a*b*e - 2*a*c*d + (b*d - 2*a*e)*c* x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a* n*(p + 1)*(b^2 - 4*a*c)) + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[ Simp[(n*p + n + 1)*d*b^2 - a*b*e - 2*a*c*d*(2*n*p + 2*n + 1) + (2*n*p + 3*n + 1)*(d*b - 2*a*e)*c* x^n, x]* (a + b*x^n + c*x^(2*n))^(p + 1), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p, -1]
Int[(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_, x_Symbol] := -x*(d + e*x^n)*(a + c*x^(2*n))^(p + 1)/(2*a*n*(p + 1)) + 1/(2*a*n*(p + 1))* Int[(d*(2*n*p + 2*n + 1) + e*(2*n*p + 3*n + 1)*x^n)*(a + c*x^(2*n))^(p + 1), x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n] && ILtQ[p, -1]
Int[(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)*(a + c*x^(2*n))^p, x], x] /; FreeQ[{a, c, d, e, n}, x] && EqQ[n2, 2*n]
Int[(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := c^p*x^(2*n*p - n + 1)*(d + e*x^n)^(q + 1)/(e*(2*n*p + n*q + 1)) + Int[(d + e*x^n)^q* ExpandToSum[(a + b*x^n + c*x^(2*n))^p - c^p*x^(2*n*p) - d*c^p*(2*n*p - n + 1)*x^(2*n*p - n)/(e*(2*n*p + n*q + 1)), x], x] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[p, 0] && NeQ[2*n*p + n*q + 1, 0] && IGtQ[n, 0] && Not[IGtQ[q, 0]]
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := c^p*x^(2*n*p - n + 1)*(d + e*x^n)^(q + 1)/(e*(2*n*p + n*q + 1)) + Int[(d + e*x^n)^q* ExpandToSum[(a + c*x^(2*n))^p - c^p*x^(2*n*p) - d*c^p*(2*n*p - n + 1)*x^(2*n*p - n)/(e*(2*n*p + n*q + 1)), x], x] /; FreeQ[{a, c, d, e, n, q}, x] && EqQ[n2, 2*n] && IGtQ[p, 0] && NeQ[2*n*p + n*q + 1, 0] && IGtQ[n, 0] && Not[IGtQ[q, 0]]
Int[(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && NeQ[c*d^2 - b*d*e + a*e^2, 0] && (IntegersQ[p, q] && Not[IntegerQ[n]] || IGtQ[p, 0] || IGtQ[q, 0] && Not[IntegerQ[n]])
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q*(a + c*x^(2*n))^p, x], x] /; FreeQ[{a, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && (IntegersQ[p, q] && Not[IntegerQ[n]] || IGtQ[p, 0] || IGtQ[q, 0] && Not[IntegerQ[n]])
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := Int[ExpandIntegrand[(a + c*x^(2*n))^ p, (d/(d^2 - e^2*x^(2*n)) - e*x^n/(d^2 - e^2*x^(2*n)))^(-q), x], x] /; FreeQ[{a, c, d, e, n, p}, x] && EqQ[n2, 2*n] && NeQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]] && ILtQ[q, 0]
Int[(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Unintegrable[(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n]
Int[(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := Unintegrable[(d + e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, n, p, q}, x] && EqQ[n2, 2*n]
Int[(d_ + e_.*u_^n_)^q_.*(a_ + b_.*u_^n_ + c_.*u_^n2_)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x], x, u] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && LinearQ[u, x] && NeQ[u, x]
Int[(d_ + e_.*u_^n_)^q_.*(a_ + c_.*u_^n2_)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(d + e*x^n)^q*(a + c*x^(2*n))^p, x], x, u] /; FreeQ[{a, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && LinearQ[u, x] && NeQ[u, x]
Int[(d_ + e_.*x_^mn_.)^q_.*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(-n*q)*(e + d*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[mn, -n] && IntegerQ[q] && (PosQ[n] || Not[IntegerQ[p]])
Int[(d_ + e_.*x_^mn_.)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(mn*q)*(e + d*x^(-mn))^q*(a + c*x^n2)^p, x] /; FreeQ[{a, c, d, e, mn, p}, x] && EqQ[n2, -2*mn] && IntegerQ[q] && (PosQ[n2] || Not[IntegerQ[p]])
Int[(d_ + e_.*x_^n_.)^q_.*(a_. + b_.*x_^mn_. + c_.*x_^mn2_.)^p_., x_Symbol] := Int[x^(-2*n*p)*(d + e*x^n)^q*(c + b*x^n + a*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[mn, -n] && EqQ[mn2, 2*mn] && IntegerQ[p]
Int[(d_ + e_.*x_^n_.)^q_.*(a_. + c_.*x_^mn2_.)^p_., x_Symbol] := Int[x^(-2*n*p)*(d + e*x^n)^q*(c + a*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, n, q}, x] && EqQ[mn2, -2*n] && IntegerQ[p]
Int[(d_ + e_.*x_^mn_.)^q_*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := e^IntPart[q]* x^(n*FracPart[q])*(d + e*x^(-n))^FracPart[q]/(1 + d*x^n/e)^ FracPart[q]* Int[x^(-n*q)*(1 + d*x^n/e)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[mn, -n] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n]
Int[(d_ + e_.*x_^mn_.)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := e^IntPart[q]* x^(-mn*FracPart[q])*(d + e*x^mn)^FracPart[q]/(1 + d*x^(-mn)/e)^ FracPart[q]*Int[x^(mn*q)*(1 + d*x^(-mn)/e)^q*(a + c*x^n2)^p, x] /; FreeQ[{a, c, d, e, mn, p, q}, x] && EqQ[n2, -2*mn] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n2]
(* Int[(d_+e_.*x_^mn_.)^q_*(a_.+b_.*x_^n_.+c_.*x_^n2_.)^p_.,x_Symbol]  := x^(n*FracPart[q])*(d+e*x^(-n))^FracPart[q]/(e+d*x^n)^FracPart[q]* Int[x^(-n*q)*(e+d*x^n)^q*(a+b*x^n+c*x^(2*n))^p,x] /; FreeQ[{a,b,c,d,e,n,p,q},x] && EqQ[n2,2*n] && EqQ[mn,-n] &&  Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n] *)
(* Int[(d_+e_.*x_^mn_.)^q_*(a_+c_.*x_^n2_.)^p_.,x_Symbol] := x^(-mn*FracPart[q])*(d+e*x^mn)^FracPart[q]/(e+d*x^(-mn))^FracPart[q] *Int[x^(mn*q)*(e+d*x^(-mn))^q*(a+c*x^n2)^p,x] /; FreeQ[{a,c,d,e,mn,p,q},x] && EqQ[n2,-2*mn] && Not[IntegerQ[p]] &&  Not[IntegerQ[q]] && PosQ[n2] *)
Int[(d_ + e_.*x_^n_.)^q_.*(a_. + b_.*x_^mn_. + c_.*x_^mn2_.)^p_, x_Symbol] := x^(2*n*FracPart[p])*(a + b*x^(-n) + c*x^(-2*n))^ FracPart[p]/(c + b*x^n + a*x^(2*n))^FracPart[p]* Int[x^(-2*n*p)*(d + e*x^n)^q*(c + b*x^n + a*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[mn, -n] && EqQ[mn2, 2*mn] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n]
Int[(d_ + e_.*x_^n_.)^q_.*(a_. + c_.*x_^mn2_.)^p_, x_Symbol] := x^(2*n*FracPart[p])*(a + c*x^(-2*n))^FracPart[p]/(c + a*x^(2*n))^ FracPart[p]* Int[x^(-2*n*p)*(d + e*x^n)^q*(c + a*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, n, p, q}, x] && EqQ[mn2, -2*n] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := Int[x^(-n*p)*(d + e*x^n)^q*(b + a*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[mn, -n] && IntegerQ[p]
Int[(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := x^(n*FracPart[p])*(a + b/x^n + c*x^n)^ FracPart[p]/(b + a*x^n + c*x^(2*n))^FracPart[p]* Int[x^(-n*p)*(d + e*x^n)^q*(b + a*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && EqQ[mn, -n] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_.*(f_ + g_.*x_^n_)^ r_.*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x^n)^(2*FracPart[p]))* Int[(d + e*x^n)^q*(f + g*x^n)^r*(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_.*(f_ + g_.*x_^n_)^ r_.*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(d + e*x^n)^(p + q)*(f + g*x^n)^r*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, b, c, d, e, f, g, n, q, r}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^n_)^q_.*(f_ + g_.*x_^n_)^r_.*(a_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(d + e*x^n)^(p + q)*(f + g*x^n)^r*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, c, d, e, f, g, n, q, r}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(d_ + e_.*x_^n_)^q_.*(f_ + g_.*x_^n_)^ r_.*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[ p]/((d + e*x^n)^FracPart[p]*(a/d + (c*x^n)/e)^FracPart[p])* Int[(d + e*x^n)^(p + q)*(f + g*x^n)^r*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d_ + e_.*x_^n_)^q_.*(f_ + g_.*x_^n_)^r_.*(a_ + c_.*x_^n2_)^p_, x_Symbol] := (a + c*x^(2*n))^ FracPart[ p]/((d + e*x^n)^FracPart[p]*(a/d + (c*x^n)/e)^FracPart[p])* Int[(d + e*x^n)^(p + q)*(f + g*x^n)^r*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, c, d, e, f, g, n, p, q, r}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]]
Int[(d1_ + e1_.*x_^non2_.)^q_.*(d2_ + e2_.*x_^non2_.)^ q_.*(a_. + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(d1*d2 + e1*e2*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[non2, n/2] && EqQ[d2*e1 + d1*e2, 0] && (IntegerQ[q] || GtQ[d1, 0] && GtQ[d2, 0])
Int[(d1_ + e1_.*x_^non2_.)^q_.*(d2_ + e2_.*x_^non2_.)^ q_.*(a_. + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := (d1 + e1*x^(n/2))^ FracPart[q]*(d2 + e2*x^(n/2))^FracPart[q]/(d1*d2 + e1*e2*x^n)^ FracPart[q]* Int[(d1*d2 + e1*e2*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[non2, n/2] && EqQ[d2*e1 + d1*e2, 0]
Int[(A_ + B_.*x_^m_.)*(d_ + e_.*x_^n_)^ q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := A*Int[(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] + B*Int[x^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, A, B, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[m - n + 1, 0]
Int[(A_ + B_.*x_^m_.)*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_)^p_., x_Symbol] := A*Int[(d + e*x^n)^q*(a + c*x^(2*n))^p, x] + B*Int[x^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, A, B, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[m - n + 1, 0]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.3 General/1.2.3.4 (f x)^m (d+e x^n)^q (a+b x^n+c x^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.3.4 (f x)^m (d+e x^n)^q (a+b x^n+c x^(2 n))^p *)
Int[(f_.*x_)^m_.*(e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := f^m/(n*e^((m + 1)/n - 1))* Subst[Int[(e*x)^(q + (m + 1)/n - 1)*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && (IntegerQ[m] || GtQ[f, 0]) && IntegerQ[Simplify[(m + 1)/n]]
Int[(f_.*x_)^m_.*(e_.*x_^n_)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := f^m/(n*e^((m + 1)/n - 1))* Subst[Int[(e*x)^(q + (m + 1)/n - 1)*(a + c*x^2)^p, x], x, x^n] /; FreeQ[{a, c, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && (IntegerQ[m] || GtQ[f, 0]) && IntegerQ[Simplify[(m + 1)/n]]
Int[(f_.*x_)^m_.*(e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := f^m*e^IntPart[q]*(e*x^n)^FracPart[q]/x^(n*FracPart[q])* Int[x^(m + n*q)*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && (IntegerQ[m] || GtQ[f, 0]) && Not[IntegerQ[Simplify[(m + 1)/n]]]
Int[(f_.*x_)^m_.*(e_.*x_^n_)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := f^m*e^IntPart[q]*(e*x^n)^FracPart[q]/x^(n*FracPart[q])* Int[x^(m + n*q)*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && (IntegerQ[m] || GtQ[f, 0]) && Not[IntegerQ[Simplify[(m + 1)/n]]]
Int[(f_*x_)^m_.*(e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && Not[IntegerQ[m]]
Int[(f_*x_)^m_.*(e_.*x_^n_)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && Not[IntegerQ[m]]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[Int[(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[Simplify[m - n + 1], 0]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[Int[(d + e*x)^q*(a + c*x^2)^p, x], x, x^n] /; FreeQ[{a, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[Simplify[m - n + 1], 0]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(m + n*(2*p + q))*(e + d*x^(-n))^ q*(c + b*x^(-n) + a*x^(-2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && IntegersQ[p, q] && NegQ[n]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(m + n*(2*p + q))*(e + d*x^(-n))^q*(c + a*x^(-2*n))^p, x] /; FreeQ[{a, c, d, e, m, n}, x] && EqQ[n2, 2*n] && IntegersQ[p, q] && NegQ[n]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := 1/n*Subst[ Int[x^((m + 1)/n - 1)*(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[(m + 1)/n, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[p]/(c^IntPart[p]*(b/2 + c*x^n)^(2*FracPart[p]))* Int[(f*x)^m*(d + e*x^n)^q*(b/2 + c*x^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(d + e*x)^q*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(d + e*x)^q*(a + c*x^2)^p, x], x, x^n] /; FreeQ[{a, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && IntegerQ[Simplify[(m + 1)/n]]
Int[(f_*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && IntegerQ[Simplify[(m + 1)/n]]
Int[(f_*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && IntegerQ[Simplify[(m + 1)/n]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_)^ p_., x_Symbol] := Int[(f*x)^m*(d + e*x^n)^(q + p)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(f*x)^m*(d + e*x^n)^(q + p)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, c, d, e, f, q, m, n, q}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 + a*e^2, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[ p]/((d + e*x^n)^FracPart[p]*(a/d + (c*x^n)/e)^FracPart[p])* Int[(f*x)^m*(d + e*x^n)^(q + p)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[c*d^2 - b*d*e + a*e^2, 0] && Not[IntegerQ[p]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := (a + c*x^(2*n))^ FracPart[ p]/((d + e*x^n)^FracPart[p]*(a/d + (c*x^n)/e)^FracPart[p])* Int[(f*x)^m*(d + e*x^n)^(q + p)*(a/d + c/e*x^n)^p, x] /; FreeQ[{a, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[c*d^2 + a*e^2, 0] && Not[IntegerQ[p]]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := (-d)^((m - Mod[m, n])/n - 1)*(c*d^2 - b*d*e + a*e^2)^p* x^(Mod[m, n] + 1)*(d + e*x^n)^(q + 1)/(n* e^(2*p + (m - Mod[m, n])/n)*(q + 1)) + 1/(n*e^(2*p + (m - Mod[m, n])/n)*(q + 1))* Int[x^Mod[m, n]*(d + e*x^n)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^n)*(n*e^(2*p + (m - Mod[m, n])/n)*(q + 1)* x^(m - Mod[m, n])*(a + b*x^n + c*x^(2*n))^p - (-d)^((m - Mod[m, n])/n - 1)*(c*d^2 - b*d*e + a*e^2)^ p*(d*(Mod[m, n] + 1) + e*(Mod[m, n] + n*(q + 1) + 1)*x^n))], x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[q, -1] && IGtQ[m, 0]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := (-d)^((m - Mod[m, n])/n - 1)*(c*d^2 + a*e^2)^p* x^(Mod[m, n] + 1)*(d + e*x^n)^(q + 1)/(n* e^(2*p + (m - Mod[m, n])/n)*(q + 1)) + 1/(n*e^(2*p + (m - Mod[m, n])/n)*(q + 1))* Int[x^Mod[m, n]*(d + e*x^n)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^n)*(n*e^(2*p + (m - Mod[m, n])/n)*(q + 1)* x^(m - Mod[m, n])*(a + c*x^(2*n))^p - (-d)^((m - Mod[m, n])/n - 1)*(c*d^2 + a*e^2)^ p*(d*(Mod[m, n] + 1) + e*(Mod[m, n] + n*(q + 1) + 1)*x^n))], x], x] /; FreeQ[{a, c, d, e}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[q, -1] && IGtQ[m, 0]
Int[x_^m_*(d_ + e_.*x_^n_)^q_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := (-d)^((m - Mod[m, n])/n - 1)*(c*d^2 - b*d*e + a*e^2)^p* x^(Mod[m, n] + 1)*(d + e*x^n)^(q + 1)/(n* e^(2*p + (m - Mod[m, n])/n)*(q + 1)) + (-d)^((m - Mod[m, n])/n - 1)/(n*e^(2*p)*(q + 1))* Int[x^m*(d + e*x^n)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^n)*(n*(-d)^(-(m - Mod[m, n])/n + 1)* e^(2*p)*(q + 1)*(a + b*x^n + c*x^(2*n))^p - (e^(-(m - Mod[m, n])/n)*(c*d^2 - b*d*e + a*e^2)^p* x^(-(m - Mod[m, n])))*(d*(Mod[m, n] + 1) + e*(Mod[m, n] + n*(q + 1) + 1)*x^n))], x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[q, -1] && ILtQ[m, 0]
Int[x_^m_*(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := (-d)^((m - Mod[m, n])/n - 1)*(c*d^2 + a*e^2)^p* x^(Mod[m, n] + 1)*(d + e*x^n)^(q + 1)/(n* e^(2*p + (m - Mod[m, n])/n)*(q + 1)) + (-d)^((m - Mod[m, n])/n - 1)/(n*e^(2*p)*(q + 1))* Int[x^m*(d + e*x^n)^(q + 1)* ExpandToSum[ Together[ 1/(d + e*x^n)*(n*(-d)^(-(m - Mod[m, n])/n + 1)* e^(2*p)*(q + 1)*(a + c*x^(2*n))^p - (e^(-(m - Mod[m, n])/n)*(c*d^2 + a*e^2)^p* x^(-(m - Mod[m, n])))*(d*(Mod[m, n] + 1) + e*(Mod[m, n] + n*(q + 1) + 1)*x^n))], x], x] /; FreeQ[{a, c, d, e}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IGtQ[p, 0] && IntegersQ[m, q] && ILtQ[q, -1] && ILtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := c^p*(f*x)^(m + 2*n*p - n + 1)*(d + e*x^n)^(q + 1)/(e* f^(2*n*p - n + 1)*(m + 2*n*p + n*q + 1)) + 1/(e*(m + 2*n*p + n*q + 1))*Int[(f*x)^m*(d + e*x^n)^q* ExpandToSum[ e*(m + 2*n*p + n*q + 1)*((a + b*x^n + c*x^(2*n))^p - c^p*x^(2*n*p)) - d*c^p*(m + 2*n*p - n + 1)*x^(2*n*p - n), x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IGtQ[p, 0] && GtQ[2*n*p, n - 1] && Not[IntegerQ[q]] && NeQ[m + 2*n*p + n*q + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := c^p*(f*x)^(m + 2*n*p - n + 1)*(d + e*x^n)^(q + 1)/(e* f^(2*n*p - n + 1)*(m + 2*n*p + n*q + 1)) + 1/(e*(m + 2*n*p + n*q + 1))*Int[(f*x)^m*(d + e*x^n)^q* ExpandToSum[ e*(m + 2*n*p + n*q + 1)*((a + c*x^(2*n))^p - c^p*x^(2*n*p)) - d*c^p*(m + 2*n*p - n + 1)*x^(2*n*p - n), x], x] /; FreeQ[{a, c, d, e, f, m, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IGtQ[p, 0] && GtQ[2*n*p, n - 1] && Not[IntegerQ[q]] && NeQ[m + 2*n*p + n*q + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m (d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^ p, x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m (d + e*x^n)^q*(a + c*x^(2*n))^p, x], x] /; FreeQ[{a, c, d, e, f, m, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IGtQ[p, 0]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = GCD[m + 1, n]}, 1/k* Subst[Int[ x^((m + 1)/k - 1)*(d + e*x^(n/k))^ q*(a + b*x^(n/k) + c*x^(2*n/k))^p, x], x, x^k] /; k != 1] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = GCD[m + 1, n]}, 1/k* Subst[Int[ x^((m + 1)/k - 1)*(d + e*x^(n/k))^q*(a + c*x^(2*n/k))^p, x], x, x^k] /; k != 1] /; FreeQ[{a, c, d, e, p, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_.*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_, x_Symbol] := With[{k = Denominator[m]}, k/f* Subst[Int[ x^(k*(m + 1) - 1)*(d + e*x^(k*n)/f^n)^ q*(a + b*x^(k*n)/f^n + c*x^(2*k*n)/f^(2*n))^p, x], x, (f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && FractionQ[m] && IntegerQ[p]
Int[(f_.*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{k = Denominator[m]}, k/f* Subst[Int[ x^(k*(m + 1) - 1)*(d + e*x^(k*n)/f)^q*(a + c*x^(2*k*n)/f)^p, x], x, (f*x)^(1/k)]] /; FreeQ[{a, c, d, e, f, p, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && FractionQ[m] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := (f*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^ p*(d*(m + n*(2*p + 1) + 1) + e*(m + 1)*x^n)/(f*(m + 1)*(m + n*(2*p + 1) + 1)) + n*p/(f^n*(m + 1)*(m + n*(2*p + 1) + 1))* Int[(f*x)^(m + n)*(a + b*x^n + c*x^(2*n))^(p - 1)* Simp[2*a*e*(m + 1) - b*d*(m + n*(2*p + 1) + 1) + (b*e*(m + 1) - 2*c*d*(m + n*(2*p + 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m + n*(2*p + 1) + 1, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_., x_Symbol] := (f*x)^(m + 1)*(a + c*x^(2*n))^ p*(d*(m + n*(2*p + 1) + 1) + e*(m + 1)*x^n)/(f*(m + 1)*(m + n*(2*p + 1) + 1)) + 2*n*p/(f^n*(m + 1)*(m + n*(2*p + 1) + 1))* Int[(f*x)^(m + n)*(a + c*x^(2*n))^(p - 1)*(a*e*(m + 1) - c*d*(m + n*(2*p + 1) + 1)*x^n), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m + n*(2*p + 1) + 1, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := (f*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^ p*(b*e*n*p + c*d*(m + n*(2*p + 1) + 1) + c*e*(2*n*p + m + 1)*x^n)/ (c*f*(2*n*p + m + 1)*(m + n*(2*p + 1) + 1)) + n*p/(c*(2*n*p + m + 1)*(m + n*(2*p + 1) + 1))* Int[(f*x)^m*(a + b*x^n + c*x^(2*n))^(p - 1)* Simp[2*a*c*d*(m + n*(2*p + 1) + 1) - a*b*e*(m + 1) + (2*a*c*e*(2*n*p + m + 1) + b*c*d*(m + n*(2*p + 1) + 1) - b^2*e*(m + n*p + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && NeQ[2*n*p + m + 1, 0] && NeQ[m + n*(2*p + 1) + 1, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_., x_Symbol] := (f*x)^(m + 1)*(a + c*x^(2*n))^ p*(c*d*(m + n*(2*p + 1) + 1) + c*e*(2*n*p + m + 1)*x^n)/(c* f*(2*n*p + m + 1)*(m + n*(2*p + 1) + 1)) + 2*a*n*p/((2*n*p + m + 1)*(m + n*(2*p + 1) + 1))* Int[(f*x)^m*(a + c*x^(2*n))^(p - 1)* Simp[d*(m + n*(2*p + 1) + 1) + e*(2*n*p + m + 1)*x^n, x], x] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && GtQ[p, 0] && NeQ[2*n*p + m + 1, 0] && NeQ[m + n*(2*p + 1) + 1, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := f^(n - 1)*(f*x)^(m - n + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)*(b*d - 2*a*e - (b*e - 2*c*d)*x^n)/(n*(p + 1)*(b^2 - 4*a*c)) + f^n/(n*(p + 1)*(b^2 - 4*a*c))* Int[(f*x)^(m - n)*(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[(n - m - 1)*(b*d - 2*a*e) + (2*n*p + 2*n + m + 1)*(b*e - 2*c*d)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m, n - 1] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_., x_Symbol] := f^(n - 1)*(f*x)^(m - n + 1)*(a + c*x^(2*n))^(p + 1)*(a*e - c*d*x^n)/(2*a*c*n*(p + 1)) + f^n/(2*a*c*n*(p + 1))* Int[(f*x)^(m - n)*(a + c*x^(2*n))^(p + 1)*(a*e*(n - m - 1) + c*d*(2*n*p + 2*n + m + 1)*x^n), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m, n - 1] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := -(f*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)*(d*(b^2 - 2*a*c) - a*b*e + (b*d - 2*a*e)*c*x^n)/(a*f*n*(p + 1)*(b^2 - 4*a*c)) + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(f*x)^m*(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[d*(b^2*(m + n*(p + 1) + 1) - 2*a*c*(m + 2*n*(p + 1) + 1)) - a*b*e*(m + 1) + c*(m + n*(2*p + 3) + 1)*(b*d - 2*a*e)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_, x_Symbol] := -(f*x)^(m + 1)*(a + c*x^(2*n))^(p + 1)*(d + e*x^n)/(2*a*f* n*(p + 1)) + 1/(2*a*n*(p + 1))* Int[(f*x)^m*(a + c*x^(2*n))^(p + 1)* Simp[d*(m + 2*n*(p + 1) + 1) + e*(m + n*(2*p + 3) + 1)*x^n, x], x] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && LtQ[p, -1] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := e*f^(n - 1)*(f*x)^(m - n + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(c*(m + n (2*p + 1) + 1)) - f^n/(c*(m + n (2*p + 1) + 1))* Int[(f*x)^(m - n)*(a + b*x^n + c*x^(2*n))^p* Simp[a*e*(m - n + 1) + (b*e*(m + n*p + 1) - c*d*(m + n (2*p + 1) + 1))*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[m, n - 1] && NeQ[m + n (2*p + 1) + 1, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_, x_Symbol] := e*f^(n - 1)*(f*x)^(m - n + 1)*(a + c*x^(2*n))^(p + 1)/(c*(m + n (2*p + 1) + 1)) - f^n/(c*(m + n (2*p + 1) + 1))* Int[(f*x)^(m - n)*(a + c*x^(2*n))^ p*(a*e*(m - n + 1) - c*d*(m + n (2*p + 1) + 1)*x^n), x] /; FreeQ[{a, c, d, e, f, p}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && GtQ[m, n - 1] && NeQ[m + n (2*p + 1) + 1, 0] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := d*(f*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*f*(m + 1)) + 1/(a*f^n*(m + 1))* Int[(f*x)^(m + n)*(a + b*x^n + c*x^(2*n))^p* Simp[a*e*(m + 1) - b*d*(m + n*(p + 1) + 1) - c*d*(m + 2*n (p + 1) + 1)*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[m, -1] && IntegerQ[p]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_, x_Symbol] := d*(f*x)^(m + 1)*(a + c*x^(2*n))^(p + 1)/(a*f*(m + 1)) + 1/(a*f^n*(m + 1))* Int[(f*x)^(m + n)*(a + c*x^(2*n))^ p*(a*e*(m + 1) - c*d*(m + 2*n (p + 1) + 1)*x^n), x] /; FreeQ[{a, c, d, e, f, p}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && LtQ[m, -1] && IntegerQ[p]
Int[(f_.*x_)^m_*(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a*c, 2]}, With[{r = Rt[2*c*q - b*c, 2]}, c/(2*q*r)* Int[(f*x)^m* Simp[d*r - (c*d - e*q)*x^(n/2), x]/(q - r*x^(n/2) + c*x^n), x] + c/(2*q*r)* Int[(f*x)^m* Simp[d*r + (c*d - e*q)*x^(n/2), x]/(q + r*x^(n/2) + c*x^n), x]] /; Not[LtQ[2*c*q - b*c, 0]]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && LtQ[b^2 - 4*a*c, 0] && IntegersQ[m, n/2] && LtQ[0, m, n] && PosQ[a*c]
Int[(f_.*x_)^m_*(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a*c, 2]}, With[{r = Rt[2*c*q, 2]}, c/(2*q*r)* Int[(f*x)^m* Simp[d*r - (c*d - e*q)*x^(n/2), x]/(q - r*x^(n/2) + c*x^n), x] + c/(2*q*r)* Int[(f*x)^m* Simp[d*r + (c*d - e*q)*x^(n/2), x]/(q + r*x^(n/2) + c*x^n), x]] /; Not[LtQ[2*c*q, 0]]] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && GtQ[a*c, 0] && IntegersQ[m, n/2] && LtQ[0, m, n]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a*c, 2]}, With[{r = Rt[2*c*q - b*c, 2]}, c/(2*q*r)* Int[(f*x)^ m*(d*r - (c*d - e*q)*x^(n/2))/(q - r*x^(n/2) + c*x^n), x] + c/(2*q*r)* Int[(f*x)^ m*(d*r + (c*d - e*q)*x^(n/2))/(q + r*x^(n/2) + c*x^n), x]] /; Not[LtQ[2*c*q - b*c, 0]]] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && LtQ[b^2 - 4*a*c, 0] && IGtQ[n/2, 1] && PosQ[a*c]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[a*c, 2]}, With[{r = Rt[2*c*q, 2]}, c/(2*q*r)* Int[(f*x)^ m*(d*r - (c*d - e*q)*x^(n/2))/(q - r*x^(n/2) + c*x^n), x] + c/(2*q*r)* Int[(f*x)^ m*(d*r + (c*d - e*q)*x^(n/2))/(q + r*x^(n/2) + c*x^n), x]] /; Not[LtQ[2*c*q, 0]]] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n/2, 1] && GtQ[a*c, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (e/2 + (2*c*d - b*e)/(2*q))* Int[(f*x)^m/(b/2 - q/2 + c*x^n), x] + (e/2 - (2*c*d - b*e)/(2*q))* Int[(f*x)^m/(b/2 + q/2 + c*x^n), x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)/(a_ + c_.*x_^n2_), x_Symbol] := With[{q = Rt[-a*c, 2]}, -(e/2 + c*d/(2*q))* Int[(f*x)^m/(q - c*x^n), x] + (e/2 - c*d/(2*q))* Int[(f*x)^m/(q + c*x^n), x]] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_./(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^n)^q/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IntegerQ[q] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_./(a_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^n)^q/(a + c*x^(2*n)), x], x] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IntegerQ[q] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_./(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(f*x)^m, (d + e*x^n)^q/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IntegerQ[q] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_./(a_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(f*x)^m, (d + e*x^n)^q/(a + c*x^(2*n)), x], x] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IntegerQ[q] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := f^(2*n)/c^2* Int[(f*x)^(m - 2*n)*(c*d - b*e + c*e*x^n)*(d + e*x^n)^(q - 1), x] - f^(2*n)/c^2* Int[(f*x)^(m - 2*n)*(d + e*x^n)^(q - 1)* Simp[a*(c*d - b*e) + (b*c*d - b^2*e + a*c*e)*x^n, x]/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && GtQ[m, 2*n - 1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := f^(2*n)/c*Int[(f*x)^(m - 2*n)*(d + e*x^n)^q, x] - a*f^(2*n)/c* Int[(f*x)^(m - 2*n)*(d + e*x^n)^q/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, f, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && GtQ[m, 2*n - 1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := e*f^n/c*Int[(f*x)^(m - n)*(d + e*x^n)^(q - 1), x] - f^n/c* Int[(f*x)^(m - n)*(d + e*x^n)^(q - 1)* Simp[a*e - (c*d - b*e)*x^n, x]/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && GtQ[m, n - 1] && LeQ[m, 2 n - 1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := e*f^n/c*Int[(f*x)^(m - n)*(d + e*x^n)^(q - 1), x] - f^n/c* Int[(f*x)^(m - n)*(d + e*x^n)^(q - 1)* Simp[a*e - c*d*x^n, x]/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && GtQ[m, n - 1] && LeQ[m, 2 n - 1]
Int[(f_.*x_)^m_*(d_. + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := d/a*Int[(f*x)^m*(d + e*x^n)^(q - 1), x] - 1/(a*f^n)* Int[(f*x)^(m + n)*(d + e*x^n)^(q - 1)* Simp[b*d - a*e + c*d*x^n, x]/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_*(d_. + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := d/a*Int[(f*x)^m*(d + e*x^n)^(q - 1), x] + 1/(a*f^n)* Int[(f*x)^(m + n)*(d + e*x^n)^(q - 1)* Simp[a*e - c*d*x^n, x]/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && GtQ[q, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := d^2*f^(2*n)/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2*n)*(d + e*x^n)^q, x] - f^(2*n)/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2*n)*(d + e*x^n)^(q + 1)* Simp[a*d + (b*d - a*e)*x^n, x]/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, 2*n - 1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := d^2*f^(2*n)/(c*d^2 + a*e^2)*Int[(f*x)^(m - 2*n)*(d + e*x^n)^q, x] - a*f^(2*n)/(c*d^2 + a*e^2)* Int[(f*x)^(m - 2*n)*(d + e*x^n)^(q + 1)*(d - e*x^n)/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, 2*n - 1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := -d*e*f^n/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - n)*(d + e*x^n)^q, x] + f^n/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - n)*(d + e*x^n)^(q + 1)* Simp[a*e + c*d*x^n, x]/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, n - 1] && LeQ[m, 2*n - 1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := -d*e*f^n/(c*d^2 + a*e^2)*Int[(f*x)^(m - n)*(d + e*x^n)^q, x] + f^n/(c*d^2 + a*e^2)* Int[(f*x)^(m - n)*(d + e*x^n)^(q + 1)* Simp[a*e + c*d*x^n, x]/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && LtQ[q, -1] && GtQ[m, n - 1] && LeQ[m, 2*n - 1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_), x_Symbol] := e^2/(c*d^2 - b*d*e + a*e^2)*Int[(f*x)^m*(d + e*x^n)^q, x] + 1/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^m*(d + e*x^n)^(q + 1)* Simp[c*d - b*e - c*e*x^n, x]/(a + b*x^n + c*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_), x_Symbol] := e^2/(c*d^2 + a*e^2)*Int[(f*x)^m*(d + e*x^n)^q, x] + c/(c*d^2 + a*e^2)* Int[(f*x)^m*(d + e*x^n)^(q + 1)*(d - e*x^n)/(a + c*x^(2*n)), x] /; FreeQ[{a, c, d, e, f, m}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && LtQ[q, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q, (f*x)^m/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, e, f, q, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(d + e*x^n)^q, (f*x)^m/(a + c*x^(2*n)), x], x] /; FreeQ[{a, c, d, e, f, q, n}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^n)^q, 1/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, e, f, m, q, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[IntegerQ[q]] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^n)^q, 1/(a + c*x^(2*n)), x], x] /; FreeQ[{a, c, d, e, f, m, q, n}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && Not[IntegerQ[q]] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_*(a_. + b_.*x_^n_ + c_.*x_^n2_.)^p_./(d_. + e_.*x_^n_), x_Symbol] := 1/d^2* Int[(f*x)^ m*(a*d + (b*d - a*e)*x^n)*(a + b*x^n + c*x^(2*n))^(p - 1), x] + (c*d^2 - b*d*e + a*e^2)/(d^2*f^(2*n))* Int[(f*x)^(m + 2*n)*(a + b*x^n + c*x^(2*n))^(p - 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, -n]
Int[(f_.*x_)^m_*(a_ + c_.*x_^n2_.)^p_./(d_. + e_.*x_^n_), x_Symbol] := a/d^2*Int[(f*x)^m*(d - e*x^n)*(a + c*x^(2*n))^(p - 1), x] + (c*d^2 + a*e^2)/(d^2*f^(2*n))* Int[(f*x)^(m + 2*n)*(a + c*x^(2*n))^(p - 1)/(d + e*x^n), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, -n]
Int[(f_.*x_)^m_*(a_. + b_.*x_^n_ + c_.*x_^n2_.)^p_./(d_. + e_.*x_^n_), x_Symbol] := 1/(d*e)* Int[(f*x)^m*(a*e + c*d*x^n)*(a + b*x^n + c*x^(2*n))^(p - 1), x] - (c*d^2 - b*d*e + a*e^2)/(d*e*f^n)* Int[(f*x)^(m + n)*(a + b*x^n + c*x^(2*n))^(p - 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_*(a_ + c_.*x_^n2_.)^p_./(d_. + e_.*x_^n_), x_Symbol] := 1/(d*e)*Int[(f*x)^m*(a*e + c*d*x^n)*(a + c*x^(2*n))^(p - 1), x] - (c*d^2 + a*e^2)/(d*e*f^n)* Int[(f*x)^(m + n)*(a + c*x^(2*n))^(p - 1)/(d + e*x^n), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && GtQ[p, 0] && LtQ[m, 0]
Int[(f_.*x_)^m_.*(a_. + b_.*x_^n_ + c_.*x_^n2_.)^p_/(d_. + e_.*x_^n_), x_Symbol] := -f^(2*n)/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2*n)*(a*d + (b*d - a*e)*x^n)*(a + b*x^n + c*x^(2*n))^p, x] + d^2*f^(2*n)/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - 2*n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m, n]
Int[(f_.*x_)^m_.*(a_ + c_.*x_^n2_.)^p_/(d_. + e_.*x_^n_), x_Symbol] := -a*f^(2*n)/(c*d^2 + a*e^2)* Int[(f*x)^(m - 2*n)*(d - e*x^n)*(a + c*x^(2*n))^p, x] + d^2*f^(2*n)/(c*d^2 + a*e^2)* Int[(f*x)^(m - 2*n)*(a + c*x^(2*n))^(p + 1)/(d + e*x^n), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m, n]
Int[(f_.*x_)^m_.*(a_. + b_.*x_^n_ + c_.*x_^n2_.)^p_/(d_. + e_.*x_^n_), x_Symbol] := f^n/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - n)*(a*e + c*d*x^n)*(a + b*x^n + c*x^(2*n))^p, x] - d*e*f^n/(c*d^2 - b*d*e + a*e^2)* Int[(f*x)^(m - n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(a_ + c_.*x_^n2_.)^p_/(d_. + e_.*x_^n_), x_Symbol] := f^n/(c*d^2 + a*e^2)* Int[(f*x)^(m - n)*(a*e + c*d*x^n)*(a + c*x^(2*n))^p, x] - d*e*f^n/(c*d^2 + a*e^2)* Int[(f*x)^(m - n)*(a + c*x^(2*n))^(p + 1)/(d + e*x^n), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := Int[ExpandIntegrand[(a + b*x^n + c*x^(2*n))^ p, (f*x)^m (d + e*x^n)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && (IGtQ[q, 0] || IntegersQ[m, q])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[ExpandIntegrand[(a + c*x^(2*n))^p, (f*x)^m (d + e*x^n)^q, x], x] /; FreeQ[{a, c, d, e, f, m, q}, x] && EqQ[n2, 2*n] && IGtQ[n, 0] && IGtQ[q, 0]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -Subst[ Int[(d + e*x^(-n))^q*(a + b*x^(-n) + c*x^(-2*n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := -Subst[Int[(d + e*x^(-n))^q*(a + c*x^(-2*n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, e, p, q}, x] && EqQ[n2, 2*n] && ILtQ[n, 0] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_, x_Symbol] := With[{g = Denominator[m]}, -g/f* Subst[Int[(d + e*f^(-n)*x^(-g*n))^ q*(a + b*f^(-n)*x^(-g*n) + c*f^(-2*n)*x^(-2*g*n))^p/ x^(g*(m + 1) + 1), x], x, 1/(f*x)^(1/g)]] /; FreeQ[{a, b, c, d, e, f, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && FractionQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{g = Denominator[m]}, -g/f* Subst[Int[(d + e*f^(-n)*x^(-g*n))^q*(a + c*f^(-2*n)*x^(-2*g*n))^p/ x^(g*(m + 1) + 1), x], x, 1/(f*x)^(1/g)]] /; FreeQ[{a, c, d, e, f, p, q}, x] && EqQ[n2, 2*n] && ILtQ[n, 0] && FractionQ[m]
Int[(f_.*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_, x_Symbol] := -f^IntPart[m]*(f*x)^FracPart[m]*(x^(-1))^FracPart[m]* Subst[Int[(d + e*x^(-n))^q*(a + b*x^(-n) + c*x^(-2*n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[(f_.*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := -f^IntPart[m]*(f*x)^FracPart[m]*(x^(-1))^FracPart[m]* Subst[Int[(d + e*x^(-n))^q*(a + c*x^(-2*n))^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, e, f, m, p, q}, x] && EqQ[n2, 2*n] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g*(m + 1) - 1)*(d + e*x^(g*n))^ q*(a + b*x^(g*n) + c*x^(2*g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, b, c, d, e, m, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g*(m + 1) - 1)*(d + e*x^(g*n))^q*(a + c*x^(2*g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, c, d, e, m, p, q}, x] && EqQ[n2, 2*n] && FractionQ[n]
Int[(f_*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[(f_*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, f, m, p, q}, x] && EqQ[n2, 2*n] && FractionQ[n]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[(d + e*x^Simplify[n/(m + 1)])^ q*(a + b*x^Simplify[n/(m + 1)] + c*x^Simplify[2*n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[(d + e*x^Simplify[n/(m + 1)])^ q*(a + c*x^Simplify[2*n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(f_*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(f_*x_)^m_*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_, x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, f, m, p, q}, x] && EqQ[n2, 2*n] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + b_.*x_^n_ + c_.*x_^n2_.), x_Symbol] := With[{r = Rt[b^2 - 4*a*c, 2]}, 2*c/r*Int[(f*x)^m*(d + e*x^n)^q/(b - r + 2*c*x^n), x] - 2*c/r*Int[(f*x)^m*(d + e*x^n)^q/(b + r + 2*c*x^n), x]] /; FreeQ[{a, b, c, d, e, f, m, n, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_/(a_ + c_.*x_^n2_.), x_Symbol] := With[{r = Rt[-a*c, 2]}, -c/(2*r)*Int[(f*x)^m*(d + e*x^n)^q/(r - c*x^n), x] - c/(2*r)*Int[(f*x)^m*(d + e*x^n)^q/(r + c*x^n), x]] /; FreeQ[{a, c, d, e, f, m, n, q}, x] && EqQ[n2, 2*n]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := -(f*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)*(d*(b^2 - 2*a*c) - a*b*e + (b*d - 2*a*e)*c*x^n)/(a*f*n*(p + 1)*(b^2 - 4*a*c)) + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(f*x)^m*(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[d*(b^2*(m + n*(p + 1) + 1) - 2*a*c*(m + 2*n*(p + 1) + 1)) - a*b*e*(m + 1) + (m + n*(2*p + 3) + 1)*(b*d - 2*a*e)*c*x^n, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)*(a_ + c_.*x_^n2_)^p_, x_Symbol] := -(f*x)^(m + 1)*(a + c*x^(2*n))^(p + 1)*(d + e*x^n)/(2*a*f* n*(p + 1)) + 1/(2*a*n*(p + 1))* Int[(f*x)^m*(a + c*x^(2*n))^(p + 1)* Simp[d*(m + 2*n*(p + 1) + 1) + e*(m + n*(2*p + 3) + 1)*x^n, x], x] /; FreeQ[{a, c, d, e, f, m, n}, x] && EqQ[n2, 2*n] && ILtQ[p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^ p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && (IGtQ[p, 0] || IGtQ[q, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x], x] /; FreeQ[{a, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && (IGtQ[p, 0] || IGtQ[q, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_*(a_ + c_.*x_^n2_)^p_, x_Symbol] := (f*x)^m/x^m* Int[ExpandIntegrand[ x^m*(a + c*x^(2*n))^ p, (d/(d^2 - e^2*x^(2*n)) - e*x^n/(d^2 - e^2*x^(2*n)))^(-q), x], x] /; FreeQ[{a, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[p]] && ILtQ[q, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n]
Int[u_^m_.*(d_ + e_.*v_^n_)^q_.*(a_ + b_.*v_^n_ + c_.*v_^n2_.)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(d + e*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x], x, v] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && LinearPairQ[u, v, x] && NeQ[v, x]
Int[u_^m_.*(d_ + e_.*v_^n_)^q_.*(a_ + c_.*v_^n2_.)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*(d + e*x^n)^q*(a + c*x^(2*n))^p, x], x, v] /; FreeQ[{a, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && LinearPairQ[u, v, x] && NeQ[v, x]
Int[x_^m_.*(d_ + e_.*x_^mn_.)^q_.*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^ p_., x_Symbol] := Int[x^(m - n*q)*(e + d*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[mn, -n] && IntegerQ[q] && (PosQ[n] || Not[IntegerQ[p]])
Int[x_^m_.*(d_ + e_.*x_^mn_.)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := Int[x^(m + mn*q)*(e + d*x^(-mn))^q*(a + c*x^n2)^p, x] /; FreeQ[{a, c, d, e, m, mn, p}, x] && EqQ[n2, -2*mn] && IntegerQ[q] && (PosQ[n2] || Not[IntegerQ[p]])
Int[x_^m_.*(d_ + e_.*x_^n_.)^q_.*(a_. + b_.*x_^mn_. + c_.*x_^mn2_.)^ p_., x_Symbol] := Int[x^(m - 2*n*p)*(d + e*x^n)^q*(c + b*x^n + a*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n, q}, x] && EqQ[mn, -n] && EqQ[mn2, 2*mn] && IntegerQ[p]
Int[x_^m_.*(d_ + e_.*x_^n_.)^q_.*(a_. + c_.*x_^mn2_.)^p_., x_Symbol] := Int[x^(m - 2*n*p)*(d + e*x^n)^q*(c + a*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, m, n, q}, x] && EqQ[mn2, -2*n] && IntegerQ[p]
Int[x_^m_.*(d_ + e_.*x_^mn_.)^q_*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := e^IntPart[q]* x^(n*FracPart[q])*(d + e*x^(-n))^FracPart[q]/(1 + d*x^n/e)^ FracPart[q]* Int[x^(m - n*q)*(1 + d*x^n/e)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[mn, -n] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n]
Int[x_^m_.*(d_ + e_.*x_^mn_.)^q_*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := e^IntPart[q]* x^(-mn*FracPart[q])*(d + e*x^mn)^FracPart[q]/(1 + d*x^(-mn)/e)^ FracPart[q]* Int[x^(m + mn*q)*(1 + d*x^(-mn)/e)^q*(a + c*x^n2)^p, x] /; FreeQ[{a, c, d, e, m, mn, p, q}, x] && EqQ[n2, -2*mn] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n2]
(* Int[x_^m_.*(d_+e_.*x_^mn_.)^q_*(a_.+b_.*x_^n_.+c_.*x_^n2_.)^p_.,x_ Symbol] := x^(n*FracPart[q])*(d+e*x^(-n))^FracPart[q]/(e+d*x^n)^FracPart[q]* Int[x^(m-n*q)*(e+d*x^n)^q*(a+b*x^n+c*x^(2*n))^p,x] /; FreeQ[{a,b,c,d,e,m,n,p,q},x] && EqQ[n2,2*n] && EqQ[mn,-n] &&  Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n] *)
(* Int[x_^m_.*(d_+e_.*x_^mn_.)^q_*(a_+c_.*x_^n2_.)^p_.,x_Symbol] := x^(-mn*FracPart[q])*(d+e*x^mn)^FracPart[q]/(e+d*x^(-mn))^FracPart[q] *Int[x^(m+mn*q)*(e+d*x^(-mn))^q*(a+c*x^n2)^p,x] /; FreeQ[{a,c,d,e,m,mn,p,q},x] && EqQ[n2,-2*mn] && Not[IntegerQ[p]] &&  Not[IntegerQ[q]] && PosQ[n2] *)
Int[x_^m_.*(d_ + e_.*x_^n_.)^q_.*(a_. + b_.*x_^mn_. + c_.*x_^mn2_.)^ p_, x_Symbol] := x^(2*n*FracPart[p])*(a + b*x^(-n) + c*x^(-2*n))^ FracPart[p]/(c + b*x^n + a*x^(2*n))^FracPart[p]* Int[x^(m - 2*n*p)*(d + e*x^n)^q*(c + b*x^n + a*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[mn, -n] && EqQ[mn2, 2*mn] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n]
Int[x_^m_.*(d_ + e_.*x_^n_.)^q_.*(a_. + c_.*x_^mn2_.)^p_, x_Symbol] := x^(2*n*FracPart[p])*(a + c*x^(-2*n))^FracPart[p]/(c + a*x^(2*n))^ FracPart[p]* Int[x^(m - 2*n*p)*(d + e*x^n)^q*(c + a*x^(2*n))^p, x] /; FreeQ[{a, c, d, e, m, n, p, q}, x] && EqQ[mn2, -2*n] && Not[IntegerQ[p]] && Not[IntegerQ[q]] && PosQ[n]
Int[(f_*x_)^m_*(d_ + e_.*x_^mn_.)^ q_.*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^mn)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[mn, -n]
Int[(f_*x_)^m_*(d_ + e_.*x_^mn_.)^q_.*(a_ + c_.*x_^n2_.)^p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^mn)^q*(a + c*x^n2)^p, x] /; FreeQ[{a, c, d, e, f, m, mn, p, q}, x] && EqQ[n2, -2*mn]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := Int[x^(m - n*p)*(d + e*x^n)^q*(b + a*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n, q}, x] && EqQ[mn, -n] && IntegerQ[p]
Int[x_^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^p_., x_Symbol] := x^(n*FracPart[p])*(a + b/x^n + c*x^n)^ FracPart[p]/(b + a*x^n + c*x^(2*n))^FracPart[p]* Int[x^(m - n*p)*(d + e*x^n)^q*(b + a*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && EqQ[mn, -n] && Not[IntegerQ[p]]
Int[(f_*x_)^m_.*(d_ + e_.*x_^n_)^q_.*(a_ + b_.*x_^mn_ + c_.*x_^n_.)^ p_., x_Symbol] := f^IntPart[m]*(f*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(d + e*x^n)^q*(a + b*x^(-n) + c*x^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[mn, -n]
Int[(f_.*x_)^m_.*(d1_ + e1_.*x_^non2_.)^q_.*(d2_ + e2_.*x_^non2_.)^ q_.*(a_. + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := Int[(f*x)^m*(d1*d2 + e1*e2*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[non2, n/2] && EqQ[d2*e1 + d1*e2, 0] && (IntegerQ[q] || GtQ[d1, 0] && GtQ[d2, 0])
Int[(f_.*x_)^m_.*(d1_ + e1_.*x_^non2_.)^q_.*(d2_ + e2_.*x_^non2_.)^ q_.*(a_. + b_.*x_^n_ + c_.*x_^n2_)^p_., x_Symbol] := (d1 + e1*x^(n/2))^ FracPart[q]*(d2 + e2*x^(n/2))^FracPart[q]/(d1*d2 + e1*e2*x^n)^ FracPart[q]* Int[(f*x)^m*(d1*d2 + e1*e2*x^n)^q*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, n, p, q}, x] && EqQ[n2, 2*n] && EqQ[non2, n/2] && EqQ[d2*e1 + d1*e2, 0]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.3 General/1.2.3.5 P(x) (a+b x^n+c x^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.3.5 P(x) (a+b x^n+c x^(2 n))^p *)
Int[Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && IGtQ[p, 0]
Int[(d_ + e_.*x_^n_. + f_.*x_^n2_.)*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^ p_., x_Symbol] := d*x*(a + b*x^n + c*x^(2*n))^(p + 1)/a /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && EqQ[a*e - b*d*(n*(p + 1) + 1), 0] && EqQ[a*f - c*d*(2*n*(p + 1) + 1), 0]
Int[(d_ + f_.*x_^n2_.)*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := d*x*(a + b*x^n + c*x^(2*n))^(p + 1)/a /; FreeQ[{a, b, c, d, f, n, p}, x] && EqQ[n2, 2*n] && EqQ[n*(p + 1) + 1, 0] && EqQ[c*d + a*f, 0]
Int[Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x^n)^(2*FracPart[p]))* Int[Pq*(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[2*p]]
Int[Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := Int[x*PolynomialQuotient[Pq, x, x]*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0] && Not[MatchQ[Pq, x^m_.*u_. /; IntegerQ[m]]]
Int[(d_ + e_.*x_^n_ + f_.*x_^n2_. + g_.*x_^n3_.)*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := x*(a*d*(n + 1) + (a*e - b*d*(n*(p + 1) + 1))* x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a^2*(n + 1)) /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[n2, 2*n] && EqQ[n3, 3*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[ a^2*g*(n + 1) - c*(n*(2*p + 3) + 1)*(a*e - b*d*(n*(p + 1) + 1)), 0] && EqQ[ a^2*f*(n + 1) - a*c*d*(n + 1)*(2*n*(p + 1) + 1) - b*(n*(p + 2) + 1)*(a*e - b*d*(n*(p + 1) + 1)), 0]
Int[(d_ + f_.*x_^n2_. + g_.*x_^n3_.)*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^ p_., x_Symbol] := d*x*(a*(n + 1) - b*(n*(p + 1) + 1)* x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a^2*(n + 1)) /; FreeQ[{a, b, c, d, f, g, n, p}, x] && EqQ[n2, 2*n] && EqQ[n3, 3*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[a^2*g*(n + 1) + c*b*d*(n*(2*p + 3) + 1)*(n*(p + 1) + 1), 0] && EqQ[ a^2*f*(n + 1) - a*c*d*(n + 1)*(2*n*(p + 1) + 1) + b^2*d*(n*(p + 2) + 1)*(n*(p + 1) + 1), 0]
Int[(d_ + e_.*x_^n_ + g_.*x_^n3_.)*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := x*(a*d*(n + 1) + (a*e - b*d*(n*(p + 1) + 1))* x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a^2*(n + 1)) /; FreeQ[{a, b, c, d, e, g, n, p}, x] && EqQ[n2, 2*n] && EqQ[n3, 3*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[ a^2*g*(n + 1) - c*(n*(2*p + 3) + 1)*(a*e - b*d*(n*(p + 1) + 1)), 0] && EqQ[ a*c*d*(n + 1)*(2*n*(p + 1) + 1) + b*(n*(p + 2) + 1)*(a*e - b*d*(n*(p + 1) + 1)), 0]
Int[(d_ + g_.*x_^n3_.)*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := d*x*(a*(n + 1) - b*(n*(p + 1) + 1)* x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a^2*(n + 1)) /; FreeQ[{a, b, c, d, g, n, p}, x] && EqQ[n2, 2*n] && EqQ[n3, 3*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[a^2*g*(n + 1) + c*b*d*(n*(2*p + 3) + 1)*(n*(p + 1) + 1), 0] && EqQ[ a*c*d*(n + 1)*(2*n*(p + 1) + 1) - b^2*d*(n*(p + 2) + 1)*(n*(p + 1) + 1), 0]
Int[Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Module[{q = Expon[Pq, x], i}, -x*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*n*(p + 1)*(b^2 - 4*a*c))* Sum[((b^2 - 2*a*c)*Coeff[Pq, x, i] - a*b*Coeff[Pq, x, n + i])* x^i + c*(b*Coeff[Pq, x, i] - 2*a*Coeff[Pq, x, n + i])*x^(n + i), {i, 0, n - 1}] + 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(a + b*x^n + c*x^(2*n))^(p + 1)* Sum[((b^2*(n*(p + 1) + i + 1) - 2*a*c*(2*n*(p + 1) + i + 1))* Coeff[Pq, x, i] - a*b*(i + 1)*Coeff[Pq, x, n + i])* x^i + c*(n*(2*p + 3) + i + 1)*(b*Coeff[Pq, x, i] - 2*a*Coeff[Pq, x, n + i])*x^(n + i), {i, 0, n - 1}], x] /; LtQ[q, 2*n]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, Module[{Q = PolynomialQuotient[(b*c)^(Floor[(q - 1)/n] + 1)*Pq, a + b*x^n + c*x^(2*n), x], R = PolynomialRemainder[(b*c)^(Floor[(q - 1)/n] + 1)*Pq, a + b*x^n + c*x^(2*n), x], i}, -x*(a + b*x^n + c*x^(2*n))^(p + 1)/(a* n*(p + 1)*(b^2 - 4*a*c)*(b*c)^(Floor[(q - 1)/n] + 1))* Sum[((b^2 - 2*a*c)*Coeff[R, x, i] - a*b*Coeff[R, x, n + i])* x^i + c*(b*Coeff[R, x, i] - 2*a*Coeff[R, x, n + i])*x^(n + i), {i, 0, n - 1}] + 1/(a*n*(p + 1)*(b^2 - 4*a*c)*(b*c)^(Floor[(q - 1)/n] + 1))* Int[(a + b*x^n + c*x^(2*n))^(p + 1)* ExpandToSum[a*n*(p + 1)*(b^2 - 4*a*c)*Q + Sum[((b^2*(n*(p + 1) + i + 1) - 2*a*c*(2*n*(p + 1) + i + 1))*Coeff[R, x, i] - a*b*(i + 1)*Coeff[R, x, n + i])*x^i + c*(n*(2*p + 3) + i + 1)*(b*Coeff[R, x, i] - 2*a*Coeff[R, x, n + i])*x^(n + i), {i, 0, n - 1}], x], x]] /; GeQ[q, 2*n]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1]
Int[Pq_/(a_ + b_.*x_^n_. + c_.*x_^n2_), x_Symbol] := Int[ExpandIntegrand[Pq/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && (NiceSqrtQ[b^2 - 4*a*c] || LtQ[Expon[Pq, x], n])
Int[Pq_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, c^p*Pqq*Log[a + b*x + c*x^2]/2 + 1/2*Int[ExpandToSum[ 2*Pq - c^p*Pqq*(b + 2*c*x)/(a + b*x + c*x^2)^(p + 1), x]*(a + b*x + c*x^2)^p, x]] /; EqQ[q + 2*p + 1, 0]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p, 0]
Int[Pq_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, c^p*Pqq*ArcTanh[(b + 2*c*x)/(2*Rt[c, 2]*Sqrt[a + b*x + c*x^2])] + Int[ExpandToSum[ Pq - c^(p + 1/2)*Pqq/(a + b*x + c*x^2)^(p + 1/2), x]*(a + b*x + c*x^2)^p, x]] /; EqQ[q + 2*p + 1, 0]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p + 1/2, 0] && PosQ[c]
Int[Pq_*(a_ + b_.*x_ + c_.*x_^2)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, -(-c)^p*Pqq* ArcTan[(b + 2*c*x)/(2*Rt[-c, 2]*Sqrt[a + b*x + c*x^2])] + Int[ExpandToSum[ Pq - (-c)^(p + 1/2)*Pqq/(a + b*x + c*x^2)^(p + 1/2), x]*(a + b*x + c*x^2)^p, x]] /; EqQ[q + 2*p + 1, 0]] /; FreeQ[{a, b, c}, x] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p + 1/2, 0] && NegQ[c]
Int[Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, Pqq*x^(q - 2*n + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(c*(q + 2*n*p + 1)) + Int[ExpandToSum[ Pq - Pqq*x^q - Pqq*(a*(q - 2*n + 1)*x^(q - 2*n) + b*(q + n*(p - 1) + 1)*x^(q - n))/(c*(q + 2*n*p + 1)), x]*(a + b*x^n + c*x^(2*n))^p, x]] /; GeQ[q, 2*n] && NeQ[q + 2*n*p + 1, 0] && (IntegerQ[2*p] || EqQ[n, 1] && IntegerQ[4*p] || IntegerQ[p + (q + 1)/(2*n)])] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0]
Int[Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Module[{q = Expon[Pq, x], j, k}, Int[ Sum[x^j*Sum[ Coeff[Pq, x, j + k*n]*x^(k*n), {k, 0, (q - j)/n + 1}]*(a + b*x^n + c*x^(2*n))^p, {j, 0, n - 1}], x]] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[PolyQ[Pq, x^n]]
Int[Pq_/(a_ + b_.*x_^n_. + c_.*x_^n2_.), x_Symbol] := Int[RationalFunctionExpand[Pq/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0]
Int[Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g - 1)* ReplaceAll[Pq, x -> x^g]*(a + b*x^(g*n) + c*x^(2*g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[Pq_/(a_ + b_.*x_^n_. + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[Pq/(b - q + 2*c*x^n), x] - 2*c/q*Int[Pq/(b + q + 2*c*x^n), x]] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0]
Int[P3_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := With[{d = Coeff[P3, x^n, 0], e = Coeff[P3, x^n, 1], f = Coeff[P3, x^n, 2], g = Coeff[P3, x^n, 3]}, -x*(b^2*c*d - 2*a*c*(c*d - a*f) - a*b*(c*e + a*g) + (b*c*(c*d + a*f) - a*b^2*g - 2*a*c*(c*e - a*g))*x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/ (a*c*n*(p + 1)*(b^2 - 4*a*c)) - 1/(a*c*n*(p + 1)*(b^2 - 4*a*c))* Int[(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[a*b*(c*e + a*g) - b^2*c*d*(n + n*p + 1) - 2*a*c*(a*f - c*d*(2*n*(p + 1) + 1)) + (a*b^2*g*(n*(p + 2) + 1) - b*c*(c*d + a*f)*(n*(2*p + 3) + 1) - 2*a*c*(a*g*(n + 1) - c*e*(n*(2*p + 3) + 1)))*x^n, x], x]] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && PolyQ[P3, x^n, 3] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p, -1]
Int[P2_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := With[{d = Coeff[P2, x^n, 0], e = Coeff[P2, x^n, 1], f = Coeff[P2, x^n, 2]}, -x*(b^2*d - 2*a*(c*d - a*f) - a*b*e + (b*(c*d + a*f) - 2*a*c*e)* x^n)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a* n*(p + 1)*(b^2 - 4*a*c)) - 1/(a*n*(p + 1)*(b^2 - 4*a*c))* Int[(a + b*x^n + c*x^(2*n))^(p + 1)* Simp[a*b*e - b^2*d*(n + n*p + 1) - 2*a*(a*f - c*d*(2*n*(p + 1) + 1)) - (b*(c*d + a*f)*(n*(2*p + 3) + 1) - 2*a*c*e*(n*(2*p + 3) + 1))*x^n, x], x]] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && PolyQ[P2, x^n, 2] && NeQ[b^2 - 4*a*c, 0] && ILtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := Int[ExpandIntegrand[Pq*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && ILtQ[p, -1]
Int[Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := Unintegrable[Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && (PolyQ[Pq, x] || PolyQ[Pq, x^n])
Int[Pq_*(a_ + b_.*v_^n_ + c_.*v_^n2_.)^p_., x_Symbol] := 1/Coefficient[v, x, 1]* Subst[Int[SubstFor[v, Pq, x]*(a + b*x^n + c*x^(2*n))^p, x], x, v] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && LinearQ[v, x] && PolyQ[Pq, v^n]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.3 General/1.2.3.6 P(x) (d x)^m (a+b x^n+c x^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.3.6 P(x) (d x)^m (a+b x^n+c x^(2 n))^p *)
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/n*Subst[Int[SubstFor[x^n, Pq, x]*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && EqQ[Simplify[m - n + 1], 0]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := Int[ExpandIntegrand[(d*x)^m*Pq*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && IGtQ[p, 0]
Int[(g_.*x_)^ m_.*(d_ + e_.*x_^n_. + f_.*x_^n2_.)*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := d*(g*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*g*(m + 1)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[a*e*(m + 1) - b*d*(m + n*(p + 1) + 1), 0] && EqQ[a*f*(m + 1) - c*d*(m + 2*n*(p + 1) + 1), 0] && NeQ[m, -1]
Int[(g_.*x_)^m_.*(d_ + f_.*x_^n2_.)*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^ p_., x_Symbol] := d*(g*x)^(m + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(a*g*(m + 1)) /; FreeQ[{a, b, c, d, f, g, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[m + n*(p + 1) + 1, 0] && EqQ[c*d + a*f, 0] && NeQ[m, -1]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^ FracPart[p]/((4*c)^IntPart[p]*(b + 2*c*x^n)^(2*FracPart[p]))* Int[(d*x)^m*Pq*(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[2*p]]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)* SubstFor[x^n, Pq, x]*(a + b*x + c*x^2)^p, x], x, x^n] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[(m + 1)/n]]
Int[(d_*x_)^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := (d*x)^m/x^m*Int[x^m*Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[(m + 1)/n]]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := 1/d*Int[(d*x)^(m + 1)* PolynomialQuotient[Pq, x, x]*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && EqQ[Coeff[Pq, x, 0], 0]
Int[x_^m_.*(e_ + f_.*x_^q_. + g_.*x_^r_. + h_.*x_^s_.)/(a_ + b_.*x_^n_. + c_.*x_^n2_.)^(3/2), x_Symbol] := -(2*c*(b*f - 2*a*g) + 2*h*(b^2 - 4*a*c)*x^(n/2) + 2*c*(2*c*f - b*g)*x^n)/(c*n*(b^2 - 4*a*c)* Sqrt[a + b*x^n + c*x^(2*n)]) /; FreeQ[{a, b, c, e, f, g, h, m, n}, x] && EqQ[n2, 2*n] && EqQ[q, n/2] && EqQ[r, 3*n/2] && EqQ[s, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*m - n + 2, 0] && EqQ[c*e + a*h, 0]
Int[(d_*x_)^ m_.*(e_ + f_.*x_^q_. + g_.*x_^r_. + h_.*x_^s_.)/(a_ + b_.*x_^n_. + c_.*x_^n2_.)^(3/2), x_Symbol] := (d*x)^m/x^m* Int[x^m*(e + f*x^(n/2) + g*x^((3*n)/2) + h*x^(2*n))/(a + b*x^n + c*x^(2*n))^(3/2), x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[n2, 2*n] && EqQ[q, n/2] && EqQ[r, 3*n/2] && EqQ[s, 2*n] && NeQ[b^2 - 4*a*c, 0] && EqQ[2*m - n + 2, 0] && EqQ[c*e + a*h, 0]
Int[x_^m_*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Module[{q = Expon[Pq, x]}, Module[{Q = PolynomialQuotient[a*(b*c)^(Floor[(q - 1)/n] + 1)*x^m*Pq, a + b*x^n + c*x^(2*n), x], R = PolynomialRemainder[a*(b*c)^(Floor[(q - 1)/n] + 1)*x^m*Pq, a + b*x^n + c*x^(2*n), x], i}, -x*(a + b*x^n + c*x^(2*n))^(p + 1)/(a^2* n*(p + 1)*(b^2 - 4*a*c)*(b*c)^(Floor[(q - 1)/n] + 1))* Sum[((b^2 - 2*a*c)*Coeff[R, x, i] - a*b*Coeff[R, x, n + i])* x^i + c*(b*Coeff[R, x, i] - 2*a*Coeff[R, x, n + i])*x^(n + i), {i, 0, n - 1}] + 1/(a*n*(p + 1)*(b^2 - 4*a*c)*(b*c)^(Floor[(q - 1)/n] + 1))* Int[x^m*(a + b*x^n + c*x^(2*n))^(p + 1)* ExpandToSum[n*(p + 1)*(b^2 - 4*a*c)*x^(-m)*Q + Sum[((b^2*(n*(p + 1) + i + 1)/a - 2*c*(2*n*(p + 1) + i + 1))*Coeff[R, x, i] - b*(i + 1)*Coeff[R, x, n + i])*x^(i - m) + c*(n*(2*p + 3) + i + 1)*(b/a*Coeff[R, x, i] - 2*Coeff[R, x, n + i])*x^(n + i - m), {i, 0, n - 1}], x], x]] /; GeQ[q, 2*n]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && ILtQ[m, 0]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := With[{g = GCD[m + 1, n]}, 1/g* Subst[Int[ x^((m + 1)/g - 1)* ReplaceAll[Pq, x -> x^(1/g)]*(a + b*x^(n/g) + c*x^(2*n/g))^p, x], x, x^g] /; NeQ[g, 1]] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[(d_.*x_)^m_.*Pq_/(a_ + b_.*x_^n_. + c_.*x_^n2_), x_Symbol] := Int[ExpandIntegrand[(d*x)^m*Pq/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && NiceSqrtQ[b^2 - 4*a*c]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, With[{Pqq = Coeff[Pq, x, q]}, Pqq*(d*x)^(m + q - 2*n + 1)*(a + b*x^n + c*x^(2*n))^(p + 1)/(c* d^(q - 2*n + 1)*(m + q + 2*n*p + 1)) + Int[(d*x)^m* ExpandToSum[ Pq - Pqq*x^q - Pqq*(a*(m + q - 2*n + 1)*x^(q - 2*n) + b*(m + q + n*(p - 1) + 1)* x^(q - n))/(c*(m + q + 2*n*p + 1)), x]* (a + b*x^n + c*x^(2*n))^p, x]] /; GeQ[q, 2*n] && NeQ[m + q + 2*n*p + 1, 0] && (IntegerQ[2*p] || EqQ[n, 1] && IntegerQ[4*p] || IntegerQ[p + (q + 1)/(2*n)])] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_)^p_, x_Symbol] := Module[{q = Expon[Pq, x], j, k}, Int[ Sum[1/d^j*(d*x)^(m + j)* Sum[Coeff[Pq, x, j + k*n]*x^(k*n), {k, 0, (q - j)/n + 1}]*(a + b*x^n + c*x^(2*n))^p, {j, 0, n - 1}], x]] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && Not[PolyQ[Pq, x^n]]
Int[(d_.*x_)^m_.*Pq_/(a_ + b_.*x_^n_. + c_.*x_^n2_.), x_Symbol] := Int[RationalFunctionExpand[(d*x)^m*Pq/(a + b*x^n + c*x^(2*n)), x], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, -Subst[ Int[ExpandToSum[x^q*ReplaceAll[Pq, x -> x^(-1)], x]*(a + b*x^(-n) + c*x^(-2*n))^p/x^(m + q + 2), x], x, 1/x]] /; FreeQ[{a, b, c, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && IntegerQ[m]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{g = Denominator[m], q = Expon[Pq, x]}, -g/d* Subst[Int[ ExpandToSum[x^(g*q)*ReplaceAll[Pq, x -> d^(-1)*x^(-g)], x]* (a + b*d^(-n)*x^(-g*n) + c*d^(-2*n)*x^(-2*g*n))^p/ x^(g*(m + q + 1) + 1), x], x, 1/(d*x)^(1/g)]] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && FractionQ[m]
Int[(d_.*x_)^m_*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{q = Expon[Pq, x]}, -(d*x)^m*(x^(-1))^m* Subst[Int[ ExpandToSum[x^q*ReplaceAll[Pq, x -> x^(-1)], x]*(a + b*x^(-n) + c*x^(-2*n))^p/x^(m + q + 2), x], x, 1/x]] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := With[{g = Denominator[n]}, g*Subst[ Int[x^(g*(m + 1) - 1)* ReplaceAll[Pq, x -> x^g]*(a + b*x^(g*n) + c*x^(2*g*n))^p, x], x, x^(1/g)]] /; FreeQ[{a, b, c, m, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[(d_*x_)^m_*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^(m - 1/2)*Sqrt[d*x]/Sqrt[x]* Int[x^m*Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n] && IGtQ[m + 1/2, 0]
Int[(d_*x_)^m_*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := d^(m + 1/2)*Sqrt[x]/Sqrt[d*x]* Int[x^m*Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n] && ILtQ[m - 1/2, 0]
Int[(d_*x_)^m_*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := (d*x)^m/x^m*Int[x^m*Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0] && FractionQ[n]
Int[x_^m_.*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := 1/(m + 1)* Subst[Int[ ReplaceAll[SubstFor[x^n, Pq, x], x -> x^Simplify[n/(m + 1)]]*(a + b*x^Simplify[n/(m + 1)] + c*x^Simplify[2*n/(m + 1)])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(d_*x_)^m_*Pq_*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_, x_Symbol] := (d*x)^m/x^m*Int[x^m*Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, p}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x^n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[Simplify[n/(m + 1)]] && Not[IntegerQ[n]]
Int[(d_.*x_)^m_.*Pq_/(a_ + b_.*x_^n_. + c_.*x_^n2_.), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[(d*x)^m*Pq/(b - q + 2*c*x^n), x] - 2*c/q*Int[(d*x)^m*Pq/(b + q + 2*c*x^n), x]] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && NeQ[b^2 - 4*a*c, 0]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := Int[ExpandIntegrand[(d*x)^m*Pq*(a + b*x^n + c*x^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[n2, 2*n] && PolyQ[Pq, x] && ILtQ[p + 1, 0]
Int[(d_.*x_)^m_.*Pq_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := Unintegrable[(d*x)^m*Pq*(a + b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[n2, 2*n] && (PolyQ[Pq, x] || PolyQ[Pq, x^n])
Int[u_^m_.*Pq_*(a_ + b_.*v_^n_ + c_.*v_^n2_.)^p_., x_Symbol] := u^m/(Coefficient[v, x, 1]*v^m)* Subst[Int[x^m*SubstFor[v, Pq, x]*(a + b*x^n + c*x^(2*n))^p, x], x, v] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && LinearPairQ[u, v, x] && PolyQ[Pq, v^n]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.4 Improper/1.2.4.1 (a x^q+b x^n+c x^(2 n-q))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.4.1 (a x^q+b x^n+c x^(2 n-q))^p *)
Int[(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := Int[((a + b + c)*x^n)^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n, q] && EqQ[r, n]
Int[(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := Int[x^(p*q)*(a + b*x^(n - q) + c*x^(2*(n - q)))^p, x] /; FreeQ[{a, b, c, n, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && IntegerQ[p]
Int[Sqrt[a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := Sqrt[a*x^q + b*x^n + c*x^(2*n - q)]/(x^(q/2)* Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))])* Int[x^(q/2)*Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))], x] /; FreeQ[{a, b, c, n, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q]
Int[1/Sqrt[a_.*x_^2 + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := -2/(n - 2)* Subst[Int[1/(4*a - x^2), x], x, x*(2*a + b*x^(n - 2))/Sqrt[a*x^2 + b*x^n + c*x^r]] /; FreeQ[{a, b, c, n, r}, x] && EqQ[r, 2*n - 2] && PosQ[n - 2] && NeQ[b^2 - 4*a*c, 0]
Int[1/Sqrt[a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := x^(q/2)* Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))]/ Sqrt[a*x^q + b*x^n + c*x^(2*n - q)]* Int[1/(x^(q/2)*Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))]), x] /; FreeQ[{a, b, c, n, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q]
Int[(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x*(a*x^q + b*x^n + c*x^(2*n - q))^p/(p*(2*n - q) + 1) + (n - q)*p/(p*(2*n - q) + 1)* Int[ x^q*(2*a + b*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c, n, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[p*(2*n - q) + 1, 0]
Int[(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := -x^(-q + 1)*(b^2 - 2*a*c + b*c*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(n - q)*(p + 1)*(b^2 - 4*a*c)) + 1/(a*(n - q)*(p + 1)*(b^2 - 4*a*c))* Int[ x^(-q)*((p*q + 1)*(b^2 - 2*a*c) + (n - q)*(p + 1)*(b^2 - 4*a*c) + b*c*(p*q + (n - q)*(2*p + 3) + 1)*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c, n, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1]
Int[(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := (a*x^q + b*x^n + c*x^(2*n - q))^ p/(x^(p*q)*(a + b*x^(n - q) + c*x^(2*(n - q)))^p)* Int[x^(p*q)*(a + b*x^(n - q) + c*x^(2*(n - q)))^p, x] /; FreeQ[{a, b, c, n, p, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]]
Int[(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := Unintegrable[(a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c, n, p, q}, x] && EqQ[r, 2*n - q]
Int[(a_.*u_^q_. + b_.*u_^n_. + c_.*u_^r_.)^p_, x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a*x^q + b*x^n + c*x^(2*n - q))^p, x], x, u] /; FreeQ[{a, b, c, n, p, q}, x] && EqQ[r, 2*n - q] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.4 Improper/1.2.4.2 (d x)^m (a x^q+b x^n+c x^(2 n-q))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.4.2 (d x)^m (a x^q+b x^n+c x^(2 n-q))^p *)
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_., x_Symbol] := Int[x^m*((a + b + c)*x^n)^p, x] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[q, n] && EqQ[r, n]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_., x_Symbol] := Int[x^(m + p*q)*(a + b*x^(n - q) + c*x^(2*(n - q)))^p, x] /; FreeQ[{a, b, c, m, n, q}, x] && EqQ[r, 2*n - q] && IntegerQ[p] && PosQ[n - q]
Int[x_^m_./Sqrt[a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := -2/(n - q)* Subst[Int[1/(4*a - x^2), x], x, x^(m + 1)*(2*a + b*x^(n - q))/Sqrt[a*x^q + b*x^n + c*x^r]] /; FreeQ[{a, b, c, m, n, q, r}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && NeQ[b^2 - 4*a*c, 0] && EqQ[m, q/2 - 1]
Int[x_^m_./Sqrt[a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := x^(q/2)* Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))]/ Sqrt[a*x^q + b*x^n + c*x^(2*n - q)]* Int[x^(m - q/2)/Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))], x] /; FreeQ[{a, b, c, m, n, q}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && (EqQ[m, 1] && EqQ[n, 3] && EqQ[q, 2] || (EqQ[m, 1/2] || EqQ[m, 3/2] || EqQ[m, 1/2] || EqQ[m, 5/2]) && EqQ[n, 3] && EqQ[q, 1])
Int[x_^m_./(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^(3/2), x_Symbol] := -2*x^((n - 1)/2)*(b + 2*c*x)/((b^2 - 4*a*c)* Sqrt[a*x^(n - 1) + b*x^n + c*x^(n + 1)]) /; FreeQ[{a, b, c, n}, x] && EqQ[m, 3*(n - 1)/2] && EqQ[q, n - 1] && EqQ[r, n + 1] && NeQ[b^2 - 4*a*c, 0]
Int[x_^m_./(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^(3/2), x_Symbol] := x^((n - 1)/2)*(4*a + 2*b*x)/((b^2 - 4*a*c)* Sqrt[a*x^(n - 1) + b*x^n + c*x^(n + 1)]) /; FreeQ[{a, b, c, n}, x] && EqQ[m, (3*n - 1)/2] && EqQ[q, n - 1] && EqQ[r, n + 1] && NeQ[b^2 - 4*a*c, 0]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - n)*(a*x^(n - 1) + b*x^n + c*x^(n + 1))^(p + 1)/(2* c*(p + 1)) - b/(2*c)*Int[x^(m - 1)*(a*x^(n - 1) + b*x^n + c*x^(n + 1))^p, x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && RationalQ[m, p, q] && EqQ[m + p*(n - 1) - 1, 0]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - n + q + 1)*(b + 2*c*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^ p/(2*c*(n - q)*(2*p + 1)) - p*(b^2 - 4*a*c)/(2*c*(2*p + 1))* Int[x^(m + q)*(a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && RationalQ[m, q] && EqQ[m + p*q + 1, n - q]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - n + q + 1)*(b*(n - q)*p + c*(m + p*q + (n - q)*(2*p - 1) + 1)* x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^ p/(c*(m + p*(2*n - q) + 1)*(m + p*q + (n - q)*(2*p - 1) + 1)) + (n - q)* p/(c*(m + p*(2*n - q) + 1)*(m + p*q + (n - q)*(2*p - 1) + 1))* Int[x^(m - (n - 2*q))* Simp[-a*b*(m + p*q - n + q + 1) + (2*a*c*(m + p*q + (n - q)*(2*p - 1) + 1) - b^2*(m + p*q + (n - q)*(p - 1) + 1))*x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && RationalQ[m, q] && GtQ[m + p*q + 1, n - q] && NeQ[m + p*(2*n - q) + 1, 0] && NeQ[m + p*q + (n - q)*(2*p - 1) + 1, 0]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^p/(m + p*q + 1) - (n - q)*p/(m + p*q + 1)* Int[x^(m + n)*(b + 2*c*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && RationalQ[m, q] && LeQ[m + p*q + 1, -(n - q) + 1] && NeQ[m + p*q + 1, 0]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^p/(m + p*(2*n - q) + 1) + (n - q)*p/(m + p*(2*n - q) + 1)* Int[x^(m + q)*(2*a + b*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && RationalQ[m, q] && GtQ[m + p*q + 1, -(n - q)] && NeQ[m + p*(2*n - q) + 1, 0]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := -x^(m - q + 1)*(b^2 - 2*a*c + b*c*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(n - q)*(p + 1)*(b^2 - 4*a*c)) + (2*a*c - b^2*(p + 2))/(a*(p + 1)*(b^2 - 4*a*c))* Int[x^(m - q)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && RationalQ[m, p, q] && EqQ[m + p*q + 1, -(n - q)*(2*p + 3)]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := -x^(m - 2*n + q + 1)*(2*a + b*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/((n - q)*(p + 1)*(b^2 - 4*a*c)) + 1/((n - q)*(p + 1)*(b^2 - 4*a*c))* Int[ x^(m - 2*n + q)*(2*a*(m + p*q - 2*(n - q) + 1) + b*(m + p*q + (n - q)*(2*p + 1) + 1)*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && RationalQ[m, q] && GtQ[m + p*q + 1, 2*(n - q)]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := -x^(m - q + 1)*(b^2 - 2*a*c + b*c*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(n - q)*(p + 1)*(b^2 - 4*a*c)) + 1/(a*(n - q)*(p + 1)*(b^2 - 4*a*c))* Int[x^(m - q)* (b^2*(m + p*q + (n - q)*(p + 1) + 1) - 2*a*c*(m + p*q + 2*(n - q)*(p + 1) + 1) + b*c*(m + p*q + (n - q)*(2*p + 3) + 1)*x^(n - q))* (a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && RationalQ[m, q] && LtQ[m + p*q + 1, n - q]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - n + 1)*(b + 2*c*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/((n - q)*(p + 1)*(b^2 - 4*a*c)) - 1/((n - q)*(p + 1)*(b^2 - 4*a*c))* Int[ x^(m - n)*(b*(m + p*q - n + q + 1) + 2*c*(m + p*q + 2*(n - q)*(p + 1) + 1)*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && RationalQ[m, q] && LtQ[n - q, m + p*q + 1, 2*(n - q)]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - 2*n + q + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(2* c*(n - q)*(p + 1)) - b/(2*c)*Int[x^(m - n + q)*(a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GeQ[p, -1] && LtQ[p, 0] && RationalQ[m, q] && EqQ[m + p*q + 1, 2*(n - q)]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := -x^(m - q + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(2* a*(n - q)*(p + 1)) - b/(2*a)*Int[x^(m + n - q)*(a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GeQ[p, -1] && LtQ[p, 0] && RationalQ[m, q] && EqQ[m + p*q + 1, -2*(n - q)*(p + 1)]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - 2*n + q + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(c*(m + p*q + 2*(n - q)*p + 1)) - 1/(c*(m + p*q + 2*(n - q)*p + 1))* Int[ x^(m - 2*(n - q))*(a*(m + p*q - 2*(n - q) + 1) + b*(m + p*q + (n - q)*(p - 1) + 1)*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GeQ[p, -1] && LtQ[p, 0] && RationalQ[m, q] && GtQ[m + p*q + 1, 2*(n - q)]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := x^(m - q + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(m + p*q + 1)) - 1/(a*(m + p*q + 1))* Int[ x^(m + n - q)*(b*(m + p*q + (n - q)*(p + 1) + 1) + c*(m + p*q + 2*(n - q)*(p + 1) + 1)*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c}, x] && EqQ[r, 2*n - q] && PosQ[n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GeQ[p, -1] && LtQ[p, 0] && RationalQ[m, q] && LtQ[m + p*q + 1, 0]
Int[x_^m_.*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_, x_Symbol] := (a*x^q + b*x^n + c*x^(2*n - q))^ p/(x^(p*q)*(a + b*x^(n - q) + c*x^(2*(n - q)))^p)* Int[x^(m + p*q)*(a + b*x^(n - q) + c*x^(2*(n - q)))^p, x] /; FreeQ[{a, b, c, m, n, p, q}, x] && EqQ[r, 2*n - q] && Not[IntegerQ[p]] && PosQ[n - q]
Int[u_^m_.*(a_.*u_^q_. + b_.*u_^n_. + c_.*u_^r_.)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[x^m*(a*x^q + b*x^n + c*x^(2*n - q))^p, x], x, u] /; FreeQ[{a, b, c, m, n, p, q}, x] && EqQ[r, 2*n - q] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.4 Improper/1.2.4.3 (d+e x^(n-q)) (a x^q+b x^n+c x^(2 n-q))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.4.3 (d+e x^(n-q)) (a x^q+b x^n+c x^(2 n-q))^p *)
Int[(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^p_., x_Symbol] := Int[x^(p*q)*(A + B*x^(n - q))*(a + b*x^(n - q) + c*x^(2*(n - q)))^ p, x] /; FreeQ[{a, b, c, A, B, n, q}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && IntegerQ[p] && PosQ[n - q]
(* Int[(A_+B_.*x_^j_.)*(a_.*x_^q_.+b_.*x_^n_.+c_.*x_^r_.)^p_,x_Symbol]  := Sqrt[a*x^q+b*x^n+c*x^(2*n-q)]/(x^(q/2)*Sqrt[a+b*x^(n-q)+c*x^(2*(n-q) )])* Int[x^(q*p)*(A+B*x^(n-q))*(a+b*x^(n-q)+c*x^(2*(n-q)))^p,x] /; FreeQ[{a,b,c,A,B,n,p,q},x] && EqQ[j,n-q] && EqQ[r,2*n-q] && PosQ[n-q]  && IGtQ[p+1/2,0] *)
(* Int[(A_+B_.*x_^j_.)*(a_.*x_^q_.+b_.*x_^n_.+c_.*x_^r_.)^p_,x_Symbol]  := x^(q/2)*Sqrt[a+b*x^(n-q)+c*x^(2*(n-q))]/Sqrt[a*x^q+b*x^n+c*x^(2*n-q) ]* Int[x^(q*p)*(A+B*x^(n-q))*(a+b*x^(n-q)+c*x^(2*(n-q)))^p,x] /; FreeQ[{a,b,c,A,B,n,p,q},x] && EqQ[j,n-q] && EqQ[r,2*n-q] && PosQ[n-q]  && ILtQ[p-1/2,0] *)
(* Int[(A_+B_.*x_^j_.)*Sqrt[a_.*x_^q_.+b_.*x_^n_.+c_.*x_^r_.],x_ Symbol] := Sqrt[a*x^q+b*x^n+c*x^(2*n-q)]/(x^(q/2)*Sqrt[a+b*x^(n-q)+c*x^(2*(n-q) )])* Int[x^(q/2)*(A+B*x^(n-q))*Sqrt[a+b*x^(n-q)+c*x^(2*(n-q))],x] /; FreeQ[{a,b,c,A,B,n,q},x] && EqQ[j,n-q] && EqQ[r,2*n-q] && PosQ[n-q] *)
Int[(A_ + B_.*x_^j_.)/Sqrt[a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := x^(q/2)* Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))]/ Sqrt[a*x^q + b*x^n + c*x^(2*n - q)]* Int[(A + B*x^(n - q))/(x^(q/2)* Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))]), x] /; FreeQ[{a, b, c, A, B, n, q}, x] && EqQ[j, n - q] && EqQ[r, 2*n - q] && PosQ[n - q] && EqQ[n, 3] && EqQ[q, 2]
Int[(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^p_, x_Symbol] := x*(b*B*(n - q)*p + A*c*(p*q + (n - q)*(2*p + 1) + 1) + B*c*(p*(2*n - q) + 1)* x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p/ (c*(p*(2*n - q) + 1)*(p*q + (n - q)*(2*p + 1) + 1)) + (n - q)*p/(c*(p*(2*n - q) + 1)*(p*q + (n - q)*(2*p + 1) + 1))* Int[x^q* (2*a*A*c*(p*q + (n - q)*(2*p + 1) + 1) - a*b*B*(p*q + 1) + (2*a*B*c*(p*(2*n - q) + 1) + A*b*c*(p*q + (n - q)*(2*p + 1) + 1) - b^2*B*(p*q + (n - q)*p + 1))*x^(n - q))* (a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c, A, B, n, q}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && GtQ[p, 0] && NeQ[p*(2*n - q) + 1, 0] && NeQ[p*q + (n - q)*(2*p + 1) + 1, 0]
Int[(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_, x_Symbol] := With[{n = q + r}, x*(A*(p*q + (n - q)*(2*p + 1) + 1) + B*(p*(2*n - q) + 1)*x^(n - q))*(a*x^q + c*x^(2*n - q))^ p/((p*(2*n - q) + 1)*(p*q + (n - q)*(2*p + 1) + 1)) + (n - q)*p/((p*(2*n - q) + 1)*(p*q + (n - q)*(2*p + 1) + 1))* Int[x^q*(2*a* A*(p*q + (n - q)*(2*p + 1) + 1) + (2*a* B*(p*(2*n - q) + 1))*x^(n - q))*(a*x^q + c*x^(2*n - q))^(p - 1), x] /; EqQ[j, 2*n - q] && NeQ[p*(2*n - q) + 1, 0] && NeQ[p*q + (n - q)*(2*p + 1) + 1, 0]] /; FreeQ[{a, c, A, B, q}, x] && Not[IntegerQ[p]] && GtQ[p, 0]
Int[(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^p_, x_Symbol] := -x^(-q + 1)*(A*b^2 - a*b*B - 2*a*A*c + (A*b - 2*a*B)*c* x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(n - q)*(p + 1)*(b^2 - 4*a*c)) + 1/(a*(n - q)*(p + 1)*(b^2 - 4*a*c))* Int[x^(-q)* ((A*b^2*(p*q + (n - q)*(p + 1) + 1) - a*b*B*(p*q + 1) - 2*a*A*c*(p*q + 2*(n - q)*(p + 1) + 1) + (p*q + (n - q)*(2*p + 3) + 1)*(A*b - 2*a*B)*c* x^(n - q))* (a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)), x] /; FreeQ[{a, b, c, A, B, n, q}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && LtQ[p, -1]
Int[(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_, x_Symbol] := With[{n = q + r}, -x^(-q + 1)*(a*A*c + a*B*c*x^(n - q))*(a*x^q + c*x^(2*n - q))^(p + 1)/(a*(n - q)*(p + 1)*(2*a*c)) + 1/(a*(n - q)*(p + 1)*(2*a*c))* Int[x^(-q)*((a*A*c*(p*q + 2*(n - q)*(p + 1) + 1) + a*B*c*(p*q + (n - q)*(2*p + 3) + 1)*x^(n - q))*(a*x^q + c*x^(2*n - q))^(p + 1)), x] /; EqQ[j, 2*n - q]] /; FreeQ[{a, c, A, B, q}, x] && Not[IntegerQ[p]] && LtQ[p, -1]
(* Int[(A_+B_.*x_^q_)*(a_.*x_^j_.+b_.*x_^k_.+c_.*x_^n_.)^p_,x_Symbol]  := (a*x^j+b*x^k+c*x^n)^p/(x^(j*p)*(a+b*x^(k-j)+c*x^(2*(k-j)))^p)* Int[x^(j*p)*(A+B*x^(k-j))*(a+b*x^(k-j)+c*x^(2*(k-j)))^p,x] /; FreeQ[{a,b,c,A,B,j,k,p},x] && EqQ[q,k-j] && EqQ[n,2*k-j] && PosQ[k-j]  && Not[IntegerQ[p]] *)
Int[(A_ + B_.*x_^j_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.)^p_., x_Symbol] := Unintegrable[(A + B*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c, A, B, n, p, q}, x] && EqQ[j, n - q] && EqQ[r, 2*n - q]
Int[(A_ + B_.*u_^j_.)*(a_.*u_^q_. + b_.*u_^n_. + c_.*u_^r_.)^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(A + B*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p, x], x, u] /; FreeQ[{a, b, c, A, B, n, p, q}, x] && EqQ[j, n - q] && EqQ[r, 2*n - q] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.2 Trinomial products/1.2.4 Improper/1.2.4.4 (f x)^m (d+e x^(n-q)) (a x^q+b x^n+c x^(2 n-q))^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.2.4.4 (f x)^m (d+e x^(n-q)) (a x^q+b x^n+c x^(2 n-q))^p *)
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := Int[x^(m + p*q)*(A + B*x^(n - q))*(a + b*x^(n - q) + c*x^(2*(n - q)))^p, x] /; FreeQ[{a, b, c, A, B, m, n, q}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && IntegerQ[p] && PosQ[n - q]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := x^(m + 1)*(A*(m + p*q + (n - q)*(2*p + 1) + 1) + B*(m + p*q + 1)*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^ p/((m + p*q + 1)*(m + p*q + (n - q)*(2*p + 1) + 1)) + (n - q)*p/((m + p*q + 1)*(m + p*q + (n - q)*(2*p + 1) + 1))* Int[x^(n + m)* Simp[2*a*B*(m + p*q + 1) - A*b*(m + p*q + (n - q)*(2*p + 1) + 1) + (b*B*(m + p*q + 1) - 2*A*c*(m + p*q + (n - q)*(2*p + 1) + 1))*x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c, A, B}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && RationalQ[m, q] && LeQ[m + p*q, -(n - q)] && NeQ[m + p*q + 1, 0] && NeQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_., x_Symbol] := With[{n = q + r}, x^(m + 1)*(A*(m + p*q + (n - q)*(2*p + 1) + 1) + B*(m + p*q + 1)*x^(n - q))*(a*x^q + c*x^(2*n - q))^ p/((m + p*q + 1)*(m + p*q + (n - q)*(2*p + 1) + 1)) + 2*(n - q)*p/((m + p*q + 1)*(m + p*q + (n - q)*(2*p + 1) + 1))* Int[x^(n + m)* Simp[a*B*(m + p*q + 1) - A*c*(m + p*q + (n - q)*(2*p + 1) + 1)*x^(n - q), x]*(a*x^q + c*x^(2*n - q))^(p - 1), x] /; EqQ[j, 2*n - q] && IGtQ[n, 0] && LeQ[m + p*q, -(n - q)] && NeQ[m + p*q + 1, 0] && NeQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]] /; FreeQ[{a, c, A, B}, x] && Not[IntegerQ[p]] && RationalQ[m, p, q] && GtQ[p, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := x^(m - n + 1)*(A*b - 2*a*B - (b*B - 2*A*c)* x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/((n - q)*(p + 1)*(b^2 - 4*a*c)) + 1/((n - q)*(p + 1)*(b^2 - 4*a*c))* Int[x^(m - n)* Simp[(m + p*q - n + q + 1)*(2*a*B - A*b) + (m + p*q + 2*(n - q)*(p + 1) + 1)*(b*B - 2*A*c)*x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c, A, B}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && RationalQ[m, q] && GtQ[m + p*q, n - q - 1]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_., x_Symbol] := With[{n = q + r}, x^(m - n + 1)*(a*B - A*c*x^(n - q))*(a*x^q + c*x^(2*n - q))^(p + 1)/(2*a* c*(n - q)*(p + 1)) - 1/(2*a*c*(n - q)*(p + 1))* Int[x^(m - n)* Simp[a*B*(m + p*q - n + q + 1) - A*c*(m + p*q + (n - q)*2*(p + 1) + 1)*x^(n - q), x]*(a*x^q + c*x^(2*n - q))^(p + 1), x] /; EqQ[j, 2*n - q] && IGtQ[n, 0] && m + p*q > n - q - 1] /; FreeQ[{a, c, A, B}, x] && Not[IntegerQ[p]] && RationalQ[m, q] && LtQ[p, -1]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := x^(m + 1)*(b*B*(n - q)*p + A*c*(m + p*q + (n - q)*(2*p + 1) + 1) + B*c*(m + p*q + 2*(n - q)*p + 1)* x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p/ (c*(m + p*(2*n - q) + 1)*(m + p*q + (n - q)*(2*p + 1) + 1)) + (n - q)* p/(c*(m + p*(2*n - q) + 1)*(m + p*q + (n - q)*(2*p + 1) + 1))* Int[x^(m + q)* Simp[2*a*A*c*(m + p*q + (n - q)*(2*p + 1) + 1) - a*b*B*(m + p*q + 1) + (2*a*B*c*(m + p*q + 2*(n - q)*p + 1) + A*b*c*(m + p*q + (n - q)*(2*p + 1) + 1) - b^2*B*(m + p*q + (n - q)*p + 1))*x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^(p - 1), x] /; FreeQ[{a, b, c, A, B}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GtQ[p, 0] && RationalQ[m, q] && GtQ[m + p*q, -(n - q) - 1] && NeQ[m + p*(2*n - q) + 1, 0] && NeQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_., x_Symbol] := With[{n = q + r}, x^(m + 1)*(A*(m + p*q + (n - q)*(2*p + 1) + 1) + B*(m + p*q + 2*(n - q)*p + 1)* x^(n - q))*(a*x^q + c*x^(2*n - q))^p/ ((m + p*(2*n - q) + 1)*(m + p*q + (n - q)*(2*p + 1) + 1)) + (n - q)* p/((m + p*(2*n - q) + 1)*(m + p*q + (n - q)*(2*p + 1) + 1))* Int[x^(m + q)* Simp[2*a*A*(m + p*q + (n - q)*(2*p + 1) + 1) + 2*a*B*(m + p*q + 2*(n - q)*p + 1)*x^(n - q), x]*(a*x^q + c*x^(2*n - q))^(p - 1), x] /; EqQ[j, 2*n - q] && IGtQ[n, 0] && GtQ[m + p*q, -(n - q)] && NeQ[m + p*q + 2*(n - q)*p + 1, 0] && NeQ[m + p*q + (n - q)*(2*p + 1) + 1, 0] && NeQ[m + 1, n]] /; FreeQ[{a, c, A, B}, x] && Not[IntegerQ[p]] && RationalQ[m, q] && GtQ[p, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := -x^(m - q + 1)*(A*b^2 - a*b*B - 2*a*A*c + (A*b - 2*a*B)*c* x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(n - q)*(p + 1)*(b^2 - 4*a*c)) + 1/(a*(n - q)*(p + 1)*(b^2 - 4*a*c))* Int[x^(m - q)* Simp[A*b^2*(m + p*q + (n - q)*(p + 1) + 1) - a*b*B*(m + p*q + 1) - 2*a*A*c*(m + p*q + 2*(n - q)*(p + 1) + 1) + (m + p*q + (n - q)*(2*p + 3) + 1)*(A*b - 2*a*B)*c* x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^(p + 1), x] /; FreeQ[{a, b, c, A, B}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && LtQ[p, -1] && RationalQ[m, q] && m + p*q < n - q - 1
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_., x_Symbol] := With[{n = q + r}, -x^(m - q + 1)*(A*c + B*c*x^(n - q))*(a*x^q + c*x^(2*n - q))^(p + 1)/(2*a* c*(n - q)*(p + 1)) + 1/(2*a*c*(n - q)*(p + 1))* Int[x^(m - q)* Simp[A*c*(m + p*q + 2*(n - q)*(p + 1) + 1) + B*(m + p*q + (n - q)*(2*p + 3) + 1)*c*x^(n - q), x]*(a*x^q + c*x^(2*n - q))^(p + 1), x] /; EqQ[j, 2*n - q] && IGtQ[n, 0] && LtQ[m + p*q, n - q - 1]] /; FreeQ[{a, c, A, B}, x] && Not[IntegerQ[p]] && RationalQ[m, q] && LtQ[p, -1]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := B*x^(m - n + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(c*(m + p*q + (n - q)*(2*p + 1) + 1)) - 1/(c*(m + p*q + (n - q)*(2*p + 1) + 1))* Int[x^(m - n + q)* Simp[a*B*(m + p*q - n + q + 1) + (b*B*(m + p*q + (n - q)*p + 1) - A*c*(m + p*q + (n - q)*(2*p + 1) + 1))*x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c, A, B}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && GeQ[p, -1] && LtQ[p, 0] && RationalQ[m, q] && GeQ[m + p*q, n - q - 1] && NeQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_., x_Symbol] := With[{n = q + r}, B*x^(m - n + 1)*(a*x^q + c*x^(2*n - q))^(p + 1)/(c*(m + p*q + (n - q)*(2*p + 1) + 1)) - 1/(c*(m + p*q + (n - q)*(2*p + 1) + 1))* Int[x^(m - n + q)* Simp[a*B*(m + p*q - n + q + 1) - A*c*(m + p*q + (n - q)*(2*p + 1) + 1)*x^(n - q), x]*(a*x^q + c*x^(2*n - q))^p, x] /; EqQ[j, 2*n - q] && IGtQ[n, 0] && GeQ[m + p*q, n - q - 1] && NeQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]] /; FreeQ[{a, c, A, B}, x] && Not[IntegerQ[p]] && RationalQ[m, p, q] && GeQ[p, -1] && LtQ[p, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + b_.*x_^n_. + c_.*x_^j_.)^ p_., x_Symbol] := A*x^(m - q + 1)*(a*x^q + b*x^n + c*x^(2*n - q))^(p + 1)/(a*(m + p*q + 1)) + 1/(a*(m + p*q + 1))* Int[x^(m + n - q)* Simp[a*B*(m + p*q + 1) - A*b*(m + p*q + (n - q)*(p + 1) + 1) - A*c*(m + p*q + 2*(n - q)*(p + 1) + 1)*x^(n - q), x]* (a*x^q + b*x^n + c*x^(2*n - q))^p, x] /; FreeQ[{a, b, c, A, B}, x] && EqQ[r, n - q] && EqQ[j, 2*n - q] && Not[IntegerQ[p]] && NeQ[b^2 - 4*a*c, 0] && IGtQ[n, 0] && RationalQ[m, p, q] && (GeQ[p, -1] && LtQ[p, 0] || EqQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]) && LeQ[m + p*q, -(n - q)] && NeQ[m + p*q + 1, 0]
Int[x_^m_.*(A_ + B_.*x_^r_.)*(a_.*x_^q_. + c_.*x_^j_.)^p_., x_Symbol] := With[{n = q + r}, A*x^(m - q + 1)*(a*x^q + c*x^(2*n - q))^(p + 1)/(a*(m + p*q + 1)) + 1/(a*(m + p*q + 1))* Int[x^(m + n - q)* Simp[a*B*(m + p*q + 1) - A*c*(m + p*q + 2*(n - q)*(p + 1) + 1)*x^(n - q), x]*(a*x^q + c*x^(2*n - q))^p, x] /; EqQ[j, 2*n - q] && IGtQ[n, 0] && (GeQ[p, -1] && LtQ[p, 0] || EqQ[m + p*q + (n - q)*(2*p + 1) + 1, 0]) && LeQ[m + p*q, -(n - q)] && NeQ[m + p*q + 1, 0]] /; FreeQ[{a, c, A, B}, x] && Not[IntegerQ[p]] && RationalQ[m, p, q]
Int[x_^m_.*(A_ + B_.*x_^j_.)/ Sqrt[a_.*x_^q_. + b_.*x_^n_. + c_.*x_^r_.], x_Symbol] := x^(q/2)* Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))]/ Sqrt[a*x^q + b*x^n + c*x^(2*n - q)]* Int[ x^(m - q/2)*(A + B*x^(n - q))/ Sqrt[a + b*x^(n - q) + c*x^(2*(n - q))], x] /; FreeQ[{a, b, c, A, B, m, n, q}, x] && EqQ[j, n - q] && EqQ[r, 2*n - q] && PosQ[n - q] && (EqQ[m, 1/2] || EqQ[m, -1/2]) && EqQ[n, 3] && EqQ[q, 1]
(* Int[x_^m_.*(A_+B_.*x_^j_.)*(a_.*x_^q_.+b_.*x_^n_.+c_.*x_^r_.)^p_,x_ Symbol] := Sqrt[a*x^q+b*x^n+c*x^(2*n-q)]/(x^(q/2)*Sqrt[a+b*x^(n-q)+c*x^(2*(n-q) )])* Int[x^(m+q*p)*(A+B*x^(n-q))*(a+b*x^(n-q)+c*x^(2*(n-q)))^p,x] /; FreeQ[{a,b,c,A,B,m,n,p,q},x] && EqQ[j,n-q] && EqQ[r,2*n-q] &&  IGtQ[p+1/2,0] && PosQ[n-q] *)
(* Int[x_^m_.*(A_+B_.*x_^j_.)*(a_.*x_^q_.+b_.*x_^n_.+c_.*x_^r_.)^p_,x_ Symbol] := x^(q/2)*Sqrt[a+b*x^(n-q)+c*x^(2*(n-q))]/Sqrt[a*x^q+b*x^n+c*x^(2*n-q) ]* Int[x^(m+q*p)*(A+B*x^(n-q))*(a+b*x^(n-q)+c*x^(2*(n-q)))^p,x] /; FreeQ[{a,b,c,A,B,m,n,p,q},x] && EqQ[j,n-q] && EqQ[r,2*n-q] &&  ILtQ[p-1/2,0] && PosQ[n-q] *)
Int[x_^m_.*(A_ + B_.*x_^q_)*(a_.*x_^j_. + b_.*x_^k_. + c_.*x_^n_.)^p_, x_Symbol] := (a*x^j + b*x^k + c*x^n)^ p/(x^(j*p)*(a + b*x^(k - j) + c*x^(2*(k - j)))^p)* Int[ x^(m + j*p)*(A + B*x^(k - j))*(a + b*x^(k - j) + c*x^(2*(k - j)))^ p, x] /; FreeQ[{a, b, c, A, B, j, k, m, p}, x] && EqQ[q, k - j] && EqQ[n, 2*k - j] && Not[IntegerQ[p]] && PosQ[k - j]
Int[u_^m_.*(A_ + B_.*u_^j_.)*(a_.*u_^q_. + b_.*u_^n_. + c_.*u_^r_.)^ p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[x^m*(A + B*x^(n - q))*(a*x^q + b*x^n + c*x^(2*n - q))^p, x], x, u] /; FreeQ[{a, b, c, A, B, m, n, p, q}, x] && EqQ[j, n - q] && EqQ[r, 2*n - q] && LinearQ[u, x] && NeQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Miscellaneous/1.3.1 P(x)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.3.1 P(x)^p *)
Int[u_.*P_^p_*Q_^q_, x_Symbol] := Module[{gcd = PolyGCD[P, Q, x]}, Int[ u*gcd^(p + q)*PolynomialQuotient[P, gcd, x]^p* PolynomialQuotient[Q, gcd, x]^q, x] /; NeQ[gcd, 1]] /; IGtQ[p, 0] && ILtQ[q, 0] && PolyQ[P, x] && PolyQ[Q, x]
Int[u_.*P_*Q_^q_, x_Symbol] := Module[{gcd = PolyGCD[P, Q, x]}, Int[ u*gcd^(q + 1)*PolynomialQuotient[P, gcd, x]* PolynomialQuotient[Q, gcd, x]^q, x] /; NeQ[gcd, 1]] /; ILtQ[q, 0] && PolyQ[P, x] && PolyQ[Q, x]
Int[u_.*P_^p_., x_Symbol] := With[{m = MinimumMonomialExponent[P, x]}, P^FracPart[p]/(x^(m*FracPart[p])*Distrib[1/x^m, P]^FracPart[p])* Int[u*x^(m*p)*Distrib[1/x^m, P]^p, x]] /; FreeQ[p, x] && Not[IntegerQ[p]] && SumQ[P] && EveryQ[Function[BinomialQ[#, x]], P] && Not[PolyQ[P, x, 2]]
Int[P_^p_, x_Symbol] := With[{u = Factor[ReplaceAll[P, x -> Sqrt[x]]]}, Int[ExpandIntegrand[ReplaceAll[u, x -> x^2]^p, x], x] /; Not[SumQ[NonfreeFactors[u, x]]]] /; PolyQ[P, x^2] && ILtQ[p, 0]
Int[P_^p_, x_Symbol] := With[{u = Factor[P]}, Int[ExpandIntegrand[u^p, x], x] /; Not[SumQ[NonfreeFactors[u, x]]]] /; PolyQ[P, x] && ILtQ[p, 0]
Int[P_^p_, x_Symbol] := With[{u = Factor[P]}, Int[u^p, x] /; Not[SumQ[NonfreeFactors[u, x]]]] /; PolyQ[P, x] && IntegerQ[p]
(* Int[Pn_^p_,x_Symbol] := With[{u=Factor[Pn]}, Pn^p/DistributeDegree[u,p]*Int[DistributeDegree[u,p],x] /; Not[SumQ[u]]] /; PolyQ[Pn,x] && Not[IntegerQ[p]] *)
Int[(a_. + b_.*x_ + c_.*x_^2 + d_.*x_^3)^p_, x_Symbol] := 1/3^p* Subst[Int[Simp[(3*a*c - b^2)/c + c^2*x^3/b, x]^p, x], x, c/(3*d) + x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0] && EqQ[c^2 - 3*b*d, 0]
Int[P_^p_, x_Symbol] := Int[ExpandToSum[P^p, x], x] /; PolyQ[P, x] && IGtQ[p, 0]
Int[P_^p_, x_Symbol] := Int[ExpandIntegrand[P^p, x], x] /; PolyQ[P, x] && IntegerQ[p] && QuadraticProductQ[Factor[P], x]
Int[(a_. + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := 1/(3^(3*p)*a^(2*p))*Int[(3*a - b*x)^p*(3*a + 2*b*x)^(2*p), x] /; FreeQ[{a, b, d}, x] && EqQ[4*b^3 + 27*a^2*d, 0] && IntegerQ[p]
Int[(a_. + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := (a + b*x + d*x^3)^p/((3*a - b*x)^p*(3*a + 2*b*x)^(2*p))* Int[(3*a - b*x)^p*(3*a + 2*b*x)^(2*p), x] /; FreeQ[{a, b, d, p}, x] && EqQ[4*b^3 + 27*a^2*d, 0] && Not[IntegerQ[p]]
Int[(a_. + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := With[{r = Rt[-9*a*d^2 + Sqrt[3]*d*Sqrt[4*b^3*d + 27*a^2*d^2], 3]}, 1/d^(2*p)*Int[Simp[18^(1/3)*b*d/(3*r) - r/18^(1/3) + d*x, x]^p* Simp[b*d/3 + 12^(1/3)*b^2*d^2/(3*r^2) + r^2/(3*12^(1/3)) - d*(2^(1/3)*b*d/(3^(1/3)*r) - r/18^(1/3))*x + d^2*x^2, x]^p, x]] /; FreeQ[{a, b, d}, x] && NeQ[4*b^3 + 27*a^2*d, 0] && IntegerQ[p]
Int[(a_. + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := With[{r = Rt[-9*a*d^2 + Sqrt[3]*d*Sqrt[4*b^3*d + 27*a^2*d^2], 3]}, (a + b*x + d*x^3)^p/ (Simp[18^(1/3)*b*d/(3*r) - r/18^(1/3) + d*x, x]^p* Simp[b*d/3 + 12^(1/3)*b^2*d^2/(3*r^2) + r^2/(3*12^(1/3)) - d*(2^(1/3)*b*d/(3^(1/3)*r) - r/18^(1/3))*x + d^2*x^2, x]^ p)* Int[Simp[18^(1/3)*b*d/(3*r) - r/18^(1/3) + d*x, x]^p* Simp[b*d/3 + 12^(1/3)*b^2*d^2/(3*r^2) + r^2/(3*12^(1/3)) - d*(2^(1/3)*b*d/(3^(1/3)*r) - r/18^(1/3))*x + d^2*x^2, x]^p, x]] /; FreeQ[{a, b, d, p}, x] && NeQ[4*b^3 + 27*a^2*d, 0] && Not[IntegerQ[p]]
Int[P3_^p_, x_Symbol] := With[{a = Coeff[P3, x, 0], b = Coeff[P3, x, 1], c = Coeff[P3, x, 2], d = Coeff[P3, x, 3]}, Subst[ Int[Simp[(2*c^3 - 9*b*c*d + 27*a*d^2)/(27*d^2) - (c^2 - 3*b*d)* x/(3*d) + d*x^3, x]^p, x], x, x + c/(3*d)] /; NeQ[c, 0]] /; FreeQ[p, x] && PolyQ[P3, x, 3]
Int[P4_^p_, x_Symbol] := With[{a = Coeff[P4, x, 0], b = Coeff[P4, x, 1], c = Coeff[P4, x, 2], d = Coeff[P4, x, 3], e = Coeff[P4, x, 4]}, 1/a^(3*p)* Int[ExpandIntegrand[(a - b*x)^(-p)/(a^5 - b^5*x^5)^(-p), x], x] /; NeQ[a, 0] && EqQ[c, b^2/a] && EqQ[d, b^3/a^2] && EqQ[e, b^4/a^3]] /; FreeQ[p, x] && PolyQ[P4, x, 4] && ILtQ[p, 0]
Int[P4_^p_, x_Symbol] := With[{a = Coeff[P4, x, 0], b = Coeff[P4, x, 1], c = Coeff[P4, x, 2], d = Coeff[P4, x, 3], e = Coeff[P4, x, 4]}, -16*a^2*Subst[ Int[1/(b - 4*a*x)^2*(a*(-3*b^4 + 16*a*b^2*c - 64*a^2*b*d + 256*a^3*e - 32*a^2*(3*b^2 - 8*a*c)*x^2 + 256*a^4*x^4)/(b - 4*a*x)^4)^p, x], x, b/(4*a) + 1/x] /; NeQ[a, 0] && NeQ[b, 0] && EqQ[b^3 - 4*a*b*c + 8*a^2*d, 0]] /; FreeQ[p, x] && PolyQ[P4, x, 4] && IntegerQ[2*p] && Not[IGtQ[p, 0]]
Int[Q6_^p_, x_Symbol] := With[{a = Coeff[Q6, x, 0], b = Coeff[Q6, x, 2], c = Coeff[Q6, x, 3], d = Coeff[Q6, x, 4], e = Coeff[Q6, x, 6]}, 1/(3^(3*p)*a^(2*p))*Int[ExpandIntegrand[ (3*a + 3*Rt[a, 3]^2*Rt[c, 3]*x + b*x^2)^p* (3*a - 3*(-1)^(1/3)*Rt[a, 3]^2*Rt[c, 3]*x + b*x^2)^p* (3*a + 3*(-1)^(2/3)*Rt[a, 3]^2*Rt[c, 3]*x + b*x^2)^p, x], x] /; EqQ[b^2 - 3*a*d, 0] && EqQ[b^3 - 27*a^2*e, 0]] /; ILtQ[p, 0] && PolyQ[Q6, x, 6] && EqQ[Coeff[Q6, x, 1], 0] && EqQ[Coeff[Q6, x, 5], 0] && RationalFunctionQ[u, x]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Miscellaneous/1.3.2 P(x) Q(x)^p.m
*)

(* ::Subsection::Closed:: *)
(* 1.3.2 P(x) Q(x)^p *)
Int[Sqrt[v_]/(d_ + e_.*x_^4), x_Symbol] := With[{a = Coeff[v, x, 0], b = Coeff[v, x, 2], c = Coeff[v, x, 4]}, a/d* Subst[Int[1/(1 - 2*b*x^2 + (b^2 - 4*a*c)*x^4), x], x, x/Sqrt[v]] /; EqQ[c*d + a*e, 0] && PosQ[a*c]] /; FreeQ[{d, e}, x] && PolyQ[v, x^2, 2]
Int[Sqrt[a_ + b_.*x_^2 + c_.*x_^4]/(d_ + e_.*x_^4), x_Symbol] := With[{q = Sqrt[b^2 - 4*a*c]}, -a*Sqrt[b + q]/(2*Sqrt[2]*Rt[-a*c, 2]*d)* ArcTan[Sqrt[b + q]* x*(b - q + 2*c*x^2)/(2*Sqrt[2]*Rt[-a*c, 2]* Sqrt[a + b*x^2 + c*x^4])] + a*Sqrt[-b + q]/(2*Sqrt[2]*Rt[-a*c, 2]*d)* ArcTanh[Sqrt[-b + q]* x*(b + q + 2*c*x^2)/(2*Sqrt[2]*Rt[-a*c, 2]* Sqrt[a + b*x^2 + c*x^4])]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c*d + a*e, 0] && NegQ[a*c]
Int[P_^p_*Q_^q_., x_Symbol] := With[{PP = Factor[ReplaceAll[P, x -> Sqrt[x]]]}, Int[ExpandIntegrand[ReplaceAll[PP, x -> x^2]^p*Q^q, x], x] /; Not[SumQ[NonfreeFactors[PP, x]]]] /; FreeQ[q, x] && PolyQ[P, x^2] && PolyQ[Q, x] && ILtQ[p, 0]
Int[P_^p_*Q_^q_., x_Symbol] := With[{PP = Factor[P]}, Int[ExpandIntegrand[PP^p*Q^q, x], x] /; Not[SumQ[NonfreeFactors[PP, x]]]] /; FreeQ[q, x] && PolyQ[P, x] && PolyQ[Q, x] && IntegerQ[p] && NeQ[P, x]
Int[P_^p_*Qm_, x_Symbol] := With[{PP = Factor[P]}, Int[ExpandIntegrand[PP^p*Qm, x], x] /; QuadraticProductQ[PP, x]] /; PolyQ[Qm, x] && PolyQ[P, x] && ILtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_ + b_.*x_ + d_.*x_^3)^p_., x_Symbol] := 1/(3^(3*p)*a^(2*p))* Int[(e + f*x)^m*(3*a - b*x)^p*(3*a + 2*b*x)^(2*p), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[4*b^3 + 27*a^2*d, 0] && IntegerQ[p]
Int[(e_. + f_.*x_)^m_.*(a_ + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := (a + b*x + d*x^3)^p/((3*a - b*x)^p*(3*a + 2*b*x)^(2*p))* Int[(e + f*x)^m*(3*a - b*x)^p*(3*a + 2*b*x)^(2*p), x] /; FreeQ[{a, b, d, e, f, m, p}, x] && EqQ[4*b^3 + 27*a^2*d, 0] && Not[IntegerQ[p]]
Int[(e_. + f_.*x_)^m_.*(a_ + b_.*x_ + d_.*x_^3)^p_., x_Symbol] := Int[ExpandIntegrand[(e + f*x)^m*(a + b*x + d*x^3)^p, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[4*b^3 + 27*a^2*d, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_ + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := With[{r = Rt[-9*a*d^2 + Sqrt[3]*d*Sqrt[4*b^3*d + 27*a^2*d^2], 3]}, 1/d^(2*p)* Int[(e + f*x)^m*Simp[18^(1/3)*b*d/(3*r) - r/18^(1/3) + d*x, x]^p* Simp[b*d/3 + 12^(1/3)*b^2*d^2/(3*r^2) + r^2/(3*12^(1/3)) - d*(2^(1/3)*b*d/(3^(1/3)*r) - r/18^(1/3))*x + d^2*x^2, x]^p, x]] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[4*b^3 + 27*a^2*d, 0] && ILtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_ + b_.*x_ + d_.*x_^3)^p_, x_Symbol] := With[{r = Rt[-9*a*d^2 + Sqrt[3]*d*Sqrt[4*b^3*d + 27*a^2*d^2], 3]}, (a + b*x + d*x^3)^p/ (Simp[18^(1/3)*b*d/(3*r) - r/18^(1/3) + d*x, x]^p* Simp[b*d/3 + 12^(1/3)*b^2*d^2/(3*r^2) + r^2/(3*12^(1/3)) - d*(2^(1/3)*b*d/(3^(1/3)*r) - r/18^(1/3))*x + d^2*x^2, x]^ p)* Int[(e + f*x)^m* Simp[18^(1/3)*b*d/(3*r) - r/18^(1/3) + d*x, x]^p* Simp[b*d/3 + 12^(1/3)*b^2*d^2/(3*r^2) + r^2/(3*12^(1/3)) - d*(2^(1/3)*b*d/(3^(1/3)*r) - r/18^(1/3))*x + d^2*x^2, x]^p, x]] /; FreeQ[{a, b, d, e, f, m, p}, x] && NeQ[4*b^3 + 27*a^2*d, 0] && Not[IntegerQ[p]]
Int[(e_. + f_.*x_)^m_.*P3_^p_., x_Symbol] := With[{a = Coeff[P3, x, 0], b = Coeff[P3, x, 1], c = Coeff[P3, x, 2], d = Coeff[P3, x, 3]}, Subst[ Int[((3*d*e - c*f)/(3*d) + f*x)^m* Simp[(2*c^3 - 9*b*c*d + 27*a*d^2)/(27*d^2) - (c^2 - 3*b*d)* x/(3*d) + d*x^3, x]^p, x], x, x + c/(3*d)] /; NeQ[c, 0]] /; FreeQ[{e, f, m, p}, x] && PolyQ[P3, x, 3]
Int[x_/Sqrt[a_ + b_.*x_ + c_.*x_^2 + e_.*x_^4], x_Symbol] := With[{Px = 1/320*(33*b^2*c + 6*a*c^2 + 40*a^2*e) - 22/5*a*c*e*x^2 + 22/15*b*c*e*x^3 + 1/4*e*(5*c^2 + 4*a*e)*x^4 + 4/3*b*e^2*x^5 + 2*c*e^2*x^6 + e^3*x^8}, 1/(8*Rt[e, 2])* Log[Px + Dist[1/(8*Rt[e, 2]*x), D[Px, x], x]* Sqrt[a + b*x + c*x^2 + e*x^4]]] /; FreeQ[{a, b, c, e}, x] && EqQ[71*c^2 + 100*a*e, 0] && EqQ[1152*c^3 - 125*b^2*e, 0]
Int[(A_ + B_.*x_)/Sqrt[a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4], x_Symbol] := B*Subst[ Int[x/Sqrt[(-3*d^4 + 16*c*d^2*e - 64*b*d*e^2 + 256*a*e^3)/(256* e^3) + (d^3 - 4*c*d*e + 8*b*e^2)*x/(8*e^2) - (3*d^2 - 8*c*e)*x^2/(8*e) + e*x^4], x], x, d/(4*e) + x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[B*d - 4*A*e, 0] && EqQ[ d*(141*d^3 - 752*c*d*e - 400*b*e^2) + 16*e^2*(71*c^2 + 100*a*e), 0] && EqQ[144*(3*d^2 - 8*c*e)^3 + 125*(d^3 - 4*c*d*e + 8*b*e^2)^2, 0]
Int[(f_ + g_.*x_^2)/((d_ + e_.*x_ + d_.*x_^2)* Sqrt[a_ + b_.*x_ + c_.*x_^2 + b_.*x_^3 + a_.*x_^4]), x_Symbol] := a*f/(d*Rt[a^2*(2*a - c), 2])* ArcTan[(a*b + (4*a^2 + b^2 - 2*a*c)*x + a*b*x^2)/(2* Rt[a^2*(2*a - c), 2]*Sqrt[a + b*x + c*x^2 + b*x^3 + a*x^4])] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*d - a*e, 0] && EqQ[f + g, 0] && PosQ[a^2*(2*a - c)]
Int[(f_ + g_.*x_^2)/((d_ + e_.*x_ + d_.*x_^2)* Sqrt[a_ + b_.*x_ + c_.*x_^2 + b_.*x_^3 + a_.*x_^4]), x_Symbol] := -a*f/(d*Rt[-a^2*(2*a - c), 2])* ArcTanh[(a*b + (4*a^2 + b^2 - 2*a*c)*x + a*b*x^2)/(2* Rt[-a^2*(2*a - c), 2]*Sqrt[a + b*x + c*x^2 + b*x^3 + a*x^4])] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*d - a*e, 0] && EqQ[f + g, 0] && NegQ[a^2*(2*a - c)]
Int[P3_/(a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4), x_Symbol] := With[{q = Sqrt[8*a^2 + b^2 - 4*a*c], A = Coeff[P3, x, 0], B = Coeff[P3, x, 1], C = Coeff[P3, x, 2], D = Coeff[P3, x, 3]}, 1/q* Int[(b*A - 2*a*B + 2*a*D + A*q + (2*a*A - 2*a*C + b*D + D*q)*x)/(2*a + (b + q)*x + 2*a*x^2), x] - 1/q* Int[(b*A - 2*a*B + 2*a*D - A*q + (2*a*A - 2*a*C + b*D - D*q)*x)/(2*a + (b - q)*x + 2*a*x^2), x]] /; FreeQ[{a, b, c}, x] && PolyQ[P3, x, 3] && EqQ[a, e] && EqQ[b, d]
Int[x_^m_.*P3_/(a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4), x_Symbol] := With[{q = Sqrt[8*a^2 + b^2 - 4*a*c], A = Coeff[P3, x, 0], B = Coeff[P3, x, 1], C = Coeff[P3, x, 2], D = Coeff[P3, x, 3]}, 1/q* Int[x^m*(b*A - 2*a*B + 2*a*D + A*q + (2*a*A - 2*a*C + b*D + D*q)*x)/(2*a + (b + q)*x + 2*a*x^2), x] - 1/q* Int[x^m*(b*A - 2*a*B + 2*a*D - A*q + (2*a*A - 2*a*C + b*D - D*q)*x)/(2*a + (b - q)*x + 2*a*x^2), x]] /; FreeQ[{a, b, c, m}, x] && PolyQ[P3, x, 3] && EqQ[a, e] && EqQ[b, d]
Int[(A_. + B_.*x_ + C_.*x_^2)/(a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4), x_Symbol] := With[{q = Rt[C*(2*e*(B*d - 4*A*e) + C*(d^2 - 4*c*e)), 2]}, -2*C^2/q*ArcTanh[(C*d - B*e + 2*C*e*x)/q] + 2*C^2/q* ArcTanh[C*(4*B*c*C - 3*B^2*d - 4*A*C*d + 12*A*B*e + 4*C*(2*c*C - B*d + 2*A*e)*x + 4*C*(2*C*d - B*e)*x^2 + 8*C^2*e*x^3)/(q*(B^2 - 4*A*C))]] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[B^2*d + 2*C*(b*C + A*d) - 2*B*(c*C + 2*A*e), 0] && EqQ[ 2*B^2*c*C - 8*a*C^3 - B^3*d - 4*A*B*C*d + 4*A*(B^2 + 2*A*C)*e, 0] && PosQ[C*(2*e*(B*d - 4*A*e) + C*(d^2 - 4*c*e))]
Int[(A_. + C_.*x_^2)/(a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4), x_Symbol] := With[{q = Rt[C*(-8*A*e^2 + C*(d^2 - 4*c*e)), 2]}, -2*C^2/q*ArcTanh[C*(d + 2*e*x)/q] + 2*C^2/q*ArcTanh[ C*(A*d - 2*(c*C + A*e)*x - 2*C*d*x^2 - 2*C*e*x^3)/(A*q)]] /; FreeQ[{a, b, c, d, e, A, C}, x] && EqQ[b*C + A*d, 0] && EqQ[a*C^2 - A^2*e, 0] && PosQ[C*(-8*A*e^2 + C*(d^2 - 4*c*e))]
Int[(A_. + B_.*x_ + C_.*x_^2)/(a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4), x_Symbol] := With[{q = Rt[-C*(2*e*(B*d - 4*A*e) + C*(d^2 - 4*c*e)), 2]}, 2*C^2/q*ArcTan[(C*d - B*e + 2*C*e*x)/q] - 2*C^2/q* ArcTan[C*(4*B*c*C - 3*B^2*d - 4*A*C*d + 12*A*B*e + 4*C*(2*c*C - B*d + 2*A*e)*x + 4*C*(2*C*d - B*e)*x^2 + 8*C^2*e*x^3)/(q*(B^2 - 4*A*C))]] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[B^2*d + 2*C*(b*C + A*d) - 2*B*(c*C + 2*A*e), 0] && EqQ[ 2*B^2*c*C - 8*a*C^3 - B^3*d - 4*A*B*C*d + 4*A*(B^2 + 2*A*C)*e, 0] && NegQ[C*(2*e*(B*d - 4*A*e) + C*(d^2 - 4*c*e))]
Int[(A_. + C_.*x_^2)/(a_ + b_.*x_ + c_.*x_^2 + d_.*x_^3 + e_.*x_^4), x_Symbol] := With[{q = Rt[-C*(-8*A*e^2 + C*(d^2 - 4*c*e)), 2]}, 2*C^2/q*ArcTan[(C*d + 2*C*e*x)/q] - 2*C^2/q*ArcTan[-C*(-A*d + 2*(c*C + A*e)*x + 2*C*d*x^2 + 2*C*e*x^3)/(A*q)]] /; FreeQ[{a, b, c, d, e, A, C}, x] && EqQ[b*C + A*d, 0] && EqQ[a*C^2 - A^2*e, 0] && NegQ[C*(-8*A*e^2 + C*(d^2 - 4*c*e))]
Int[Px_*P4_^p_, x_Symbol] := With[{a = Coeff[P4, x, 0], b = Coeff[P4, x, 1], c = Coeff[P4, x, 2], d = Coeff[P4, x, 3], e = Coeff[P4, x, 4]}, 1/a^(3*p)* Int[ExpandIntegrand[Px*(a - b*x)^(-p)/(a^5 - b^5*x^5)^(-p), x], x] /; NeQ[a, 0] && EqQ[c, b^2/a] && EqQ[d, b^3/a^2] && EqQ[e, b^4/a^3]] /; FreeQ[p, x] && PolyQ[P4, x, 4] && PolyQ[Px, x] && ILtQ[p, 0]
Int[(A_ + B_.*x_^n_)/(a_ + b_.*x_^2 + c_.*x_^n_ + d_.*x_^n2_), x_Symbol] := A^2*(n - 1)* Subst[Int[1/(a + A^2*b*(n - 1)^2*x^2), x], x, x/(A*(n - 1) - B*x^n)] /; FreeQ[{a, b, c, d, A, B, n}, x] && EqQ[n2, 2*n] && NeQ[n, 2] && EqQ[a*B^2 - A^2*d*(n - 1)^2, 0] && EqQ[B*c + 2*A*d*(n - 1), 0]
Int[x_^m_.*(A_ + B_.*x_^n_.)/(a_ + b_.*x_^k_. + c_.*x_^n_. + d_.*x_^n2_), x_Symbol] := A^2*(m - n + 1)/(m + 1)* Subst[Int[1/(a + A^2*b*(m - n + 1)^2*x^2), x], x, x^(m + 1)/(A*(m - n + 1) + B*(m + 1)*x^n)] /; FreeQ[{a, b, c, d, A, B, m, n}, x] && EqQ[n2, 2*n] && EqQ[k, 2*(m + 1)] && EqQ[a*B^2*(m + 1)^2 - A^2*d*(m - n + 1)^2, 0] && EqQ[B*c*(m + 1) - 2*A*d*(m - n + 1), 0]
Int[(a_ + b_.*x_^2 + c_.*x_^4)/(d_ + e_.*x_^2 + f_.*x_^4 + g_.*x_^6), x_Symbol] := With[{q = Rt[(-a*c*f^2 + 12*a^2*g^2 + f*(3*c^2*d - 2*a*b*g))/(c* g*(3*c*d - a*f)), 2], r = Rt[(a*c*f^2 + 4*g*(b*c*d + a^2*g) - f*(3*c^2*d + 2*a*b*g))/(c* g*(3*c*d - a*f)), 2]}, c/(g*q)*ArcTan[(r + 2*x)/q] - c/(g*q)*ArcTan[(r - 2*x)/q] - c/(g*q)* ArcTan[(3*c*d - a*f)* x/(g*q*(b*c*d - 2*a^2*g)*(b*c*d - a*b*f + 4*a^2*g))* (b*c^2*d*f - a*b^2*f*g - 2*a^2*c*f*g + 6*a^2*b*g^2 + c*(3*c^2*d*f - a*c*f^2 - b*c*d*g + 2*a^2*g^2)*x^2 + c^2*g*(3*c*d - a*f)*x^4)]] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[9*c^3*d^2 - c*(b^2 + 6*a*c)*d*f + a^2*c*f^2 + 2*a*b*(3*c*d + a*f)*g - 12*a^3*g^2, 0] && EqQ[ 3*c^4*d^2*e - 3*a^2*c^2*d*f*g + a^3*c*f^2*g + 2*a^3*g^2*(b*f - 6*a*g) - c^3*d*(2*b*d*f + a*e*f - 12*a*d*g), 0] && NeQ[3*c*d - a*f, 0] && NeQ[b*c*d - 2*a^2*g, 0] && NeQ[b*c*d - a*b*f + 4*a^2*g, 0] && PosQ[(-a*c*f^2 + 12*a^2*g^2 + f*(3*c^2*d - 2*a*b*g))/(c* g*(3*c*d - a*f))]
Int[(a_ + c_.*x_^4)/(d_ + e_.*x_^2 + f_.*x_^4 + g_.*x_^6), x_Symbol] := With[{q = Rt[(-a*c*f^2 + 12*a^2*g^2 + 3*f*c^2*d)/(c*g*(3*c*d - a*f)), 2], r = Rt[(a*c*f^2 + 4*a^2*g^2 - 3*c^2*d*f)/(c*g*(3*c*d - a*f)), 2]}, c/(g*q)*ArcTan[(r + 2*x)/q] - c/(g*q)*ArcTan[(r - 2*x)/q] - c/(g*q)* ArcTan[(c*(3*c*d - a*f)* x*(2*a^2*f*g - (3*c^2*d*f - a*c*f^2 + 2*a^2*g^2)*x^2 - c*(3*c*d - a*f)*g*x^4))/(8*a^4*g^3*q)]] /; FreeQ[{a, c, d, e, f, g}, x] && EqQ[9*c^3*d^2 - 6*a*c^2*d*f + a^2*c*f^2 - 12*a^3*g^2, 0] && EqQ[ 3*c^4*d^2*e - 3*a^2*c^2*d*f*g + a^3*c*f^2*g - 12*a^4*g^3 - a*c^3*d*(e*f - 12*d*g), 0] && NeQ[3*c*d - a*f, 0] && PosQ[(-a*c*f^2 + 12*a^2*g^2 + 3*c^2*d*f)/(c*g*(3*c*d - a*f))]
Int[u_*Q6_^p_, x_Symbol] := With[{a = Coeff[Q6, x, 0], b = Coeff[Q6, x, 2], c = Coeff[Q6, x, 3], d = Coeff[Q6, x, 4], e = Coeff[Q6, x, 6]}, 1/(3^(3*p)*a^(2*p))*Int[ExpandIntegrand[u* (3*a + 3*Rt[a, 3]^2*Rt[c, 3]*x + b*x^2)^p* (3*a - 3*(-1)^(1/3)*Rt[a, 3]^2*Rt[c, 3]*x + b*x^2)^p* (3*a + 3*(-1)^(2/3)*Rt[a, 3]^2*Rt[c, 3]*x + b*x^2)^p, x], x] /; EqQ[b^2 - 3*a*d, 0] && EqQ[b^3 - 27*a^2*e, 0]] /; ILtQ[p, 0] && PolyQ[Q6, x, 6] && EqQ[Coeff[Q6, x, 1], 0] && EqQ[Coeff[Q6, x, 5], 0] && RationalFunctionQ[u, x]
Int[Pm_/Qn_, x_Symbol] := With[{m = Expon[Pm, x], n = Expon[Qn, x]}, Coeff[Pm, x, m]*Log[Qn]/(n*Coeff[Qn, x, n]) + Simplify[Pm - Coeff[Pm, x, m]*D[Qn, x]/(n*Coeff[Qn, x, n])]* Int[1/Qn, x] /; EqQ[m, n - 1] && EqQ[D[Simplify[ Pm - Coeff[Pm, x, m]/(n*Coeff[Qn, x, n])*D[Qn, x]], x], 0]] /; PolyQ[Pm, x] && PolyQ[Qn, x]
Int[Pm_*Qn_^p_, x_Symbol] := With[{m = Expon[Pm, x], n = Expon[Qn, x]}, Coeff[Pm, x, m]*Qn^(p + 1)/(n*(p + 1)*Coeff[Qn, x, n]) + Simplify[Pm - Coeff[Pm, x, m]*D[Qn, x]/(n*Coeff[Qn, x, n])]* Int[Qn^p, x] /; EqQ[m, n - 1] && EqQ[D[Simplify[ Pm - Coeff[Pm, x, m]/(n*Coeff[Qn, x, n])*D[Qn, x]], x], 0]] /; FreeQ[p, x] && PolyQ[Pm, x] && PolyQ[Qn, x] && NeQ[p, -1]
Int[Pm_/Qn_, x_Symbol] := With[{m = Expon[Pm, x], n = Expon[Qn, x]}, Coeff[Pm, x, m]*Log[Qn]/(n*Coeff[Qn, x, n]) + 1/(n*Coeff[Qn, x, n]) Int[ ExpandToSum[n*Coeff[Qn, x, n]*Pm - Coeff[Pm, x, m]*D[Qn, x], x]/Qn, x] /; EqQ[m, n - 1]] /; PolyQ[Pm, x] && PolyQ[Qn, x]
Int[Pm_*Qn_^p_, x_Symbol] := With[{m = Expon[Pm, x], n = Expon[Qn, x]}, Coeff[Pm, x, m]*Qn^(p + 1)/(n*(p + 1)*Coeff[Qn, x, n]) + 1/(n*Coeff[Qn, x, n])* Int[ExpandToSum[n*Coeff[Qn, x, n]*Pm - Coeff[Pm, x, m]*D[Qn, x], x]*Qn^p, x] /; EqQ[m, n - 1]] /; FreeQ[p, x] && PolyQ[Pm, x] && PolyQ[Qn, x] && NeQ[p, -1]
Int[Pm_*Qn_^p_., x_Symbol] := With[{m = Expon[Pm, x], n = Expon[Qn, x]}, Coeff[Pm, x, m]*x^(m - n + 1)* Qn^(p + 1)/((m + n*p + 1)*Coeff[Qn, x, n]) + 1/((m + n*p + 1)*Coeff[Qn, x, n])* Int[ExpandToSum[(m + n*p + 1)*Coeff[Qn, x, n]*Pm - Coeff[Pm, x, m]* x^(m - n)*((m - n + 1)*Qn + (p + 1)*x*D[Qn, x]), x]*Qn^p, x] /; LtQ[1, n, m + 1] && m + n*p + 1 < 0] /; FreeQ[p, x] && PolyQ[Pm, x] && PolyQ[Qn, x] && LtQ[p, -1]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Miscellaneous/1.3.3 Miscellaneous algebraic functions.m
*)

(* ::Subsection::Closed:: *)
(* 1.3.3 Miscellaneous algebraic functions *)
Int[u_/(e_.*Sqrt[a_. + b_.*x_] + f_.*Sqrt[c_. + d_.*x_]), x_Symbol] := c/(e*(b*c - a*d))*Int[(u*Sqrt[a + b*x])/x, x] - a/(f*(b*c - a*d))*Int[(u*Sqrt[c + d*x])/x, x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a*e^2 - c*f^2, 0]
Int[u_/(e_.*Sqrt[a_. + b_.*x_] + f_.*Sqrt[c_. + d_.*x_]), x_Symbol] := -d/(e*(b*c - a*d))*Int[u*Sqrt[a + b*x], x] + b/(f*(b*c - a*d))*Int[u*Sqrt[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[b*e^2 - d*f^2, 0]
Int[u_/(e_.*Sqrt[a_. + b_.*x_] + f_.*Sqrt[c_. + d_.*x_]), x_Symbol] := e*Int[(u*Sqrt[a + b*x])/(a*e^2 - c*f^2 + (b*e^2 - d*f^2)*x), x] - f*Int[(u*Sqrt[c + d*x])/(a*e^2 - c*f^2 + (b*e^2 - d*f^2)*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a*e^2 - c*f^2, 0] && NeQ[b*e^2 - d*f^2, 0]
Int[u_./(d_.*x_^n_. + c_.*Sqrt[a_. + b_.*x_^p_.]), x_Symbol] := -b/(a*d)*Int[u*x^n, x] + 1/(a*c)*Int[u*Sqrt[a + b*x^(2*n)], x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 2*n] && EqQ[b*c^2 - d^2, 0]
Int[x_^m_./(d_.*x_^n_. + c_.*Sqrt[a_. + b_.*x_^p_.]), x_Symbol] := -d*Int[x^(m + n)/(a*c^2 + (b*c^2 - d^2)*x^(2*n)), x] + c*Int[(x^m*Sqrt[a + b*x^(2*n)])/(a*c^2 + (b*c^2 - d^2)*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[p, 2*n] && NeQ[b*c^2 - d^2, 0]
Int[1/((a_ + b_.*x_^3)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{r = Numerator[Rt[a/b, 3]], s = Denominator[Rt[a/b, 3]]}, r/(3*a)*Int[1/((r + s*x)*Sqrt[d + e*x + f*x^2]), x] + r/(3*a)* Int[(2*r - s*x)/((r^2 - r*s*x + s^2*x^2)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, d, e, f}, x] && PosQ[a/b]
Int[1/((a_ + b_.*x_^3)*Sqrt[d_. + f_.*x_^2]), x_Symbol] := With[{r = Numerator[Rt[a/b, 3]], s = Denominator[Rt[a/b, 3]]}, r/(3*a)*Int[1/((r + s*x)*Sqrt[d + f*x^2]), x] + r/(3*a)* Int[(2*r - s*x)/((r^2 - r*s*x + s^2*x^2)*Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, d, f}, x] && PosQ[a/b]
Int[1/((a_ + b_.*x_^3)*Sqrt[d_. + e_.*x_ + f_.*x_^2]), x_Symbol] := With[{r = Numerator[Rt[-a/b, 3]], s = Denominator[Rt[-a/b, 3]]}, r/(3*a)*Int[1/((r - s*x)*Sqrt[d + e*x + f*x^2]), x] + r/(3*a)* Int[(2*r + s*x)/((r^2 + r*s*x + s^2*x^2)*Sqrt[d + e*x + f*x^2]), x]] /; FreeQ[{a, b, d, e, f}, x] && NegQ[a/b]
Int[1/((a_ + b_.*x_^3)*Sqrt[d_. + f_.*x_^2]), x_Symbol] := With[{r = Numerator[Rt[-a/b, 3]], s = Denominator[Rt[-a/b, 3]]}, r/(3*a)*Int[1/((r - s*x)*Sqrt[d + f*x^2]), x] + r/(3*a)* Int[(2*r + s*x)/((r^2 + r*s*x + s^2*x^2)*Sqrt[d + f*x^2]), x]] /; FreeQ[{a, b, d, f}, x] && NegQ[a/b]
Int[u_*(A_ + B_.*x_^4)/Sqrt[v_], x_Symbol] := With[{a = Coeff[v, x, 0], b = Coeff[v, x, 2], c = Coeff[v, x, 4], d = Coeff[1/u, x, 0], e = Coeff[1/u, x, 2], f = Coeff[1/u, x, 4]}, A*Subst[Int[1/(d - (b*d - a*e)*x^2), x], x, x/Sqrt[v]] /; EqQ[a*B + A*c, 0] && EqQ[c*d - a*f, 0]] /; FreeQ[{A, B}, x] && PolyQ[v, x^2, 2] && PolyQ[1/u, x^2, 2]
Int[1/((a_ + b_.*x_)*Sqrt[c_ + d_.*x_^2]*Sqrt[e_ + f_.*x_^2]), x_Symbol] := a*Int[1/((a^2 - b^2*x^2)*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] - b*Int[x/((a^2 - b^2*x^2)*Sqrt[c + d*x^2]*Sqrt[e + f*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[(g_. + h_.*x_)* Sqrt[d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2]], x_Symbol] := 2*(f*(5*b*c*g^2 - 2*b^2*g*h - 3*a*c*g*h + 2*a*b*h^2) + c*f*(10*c*g^2 - b*g*h + a*h^2)*x + 9*c^2*f*g*h*x^2 + 3*c^2*f*h^2*x^3 - (e*g - d*h)*(5*c*g - 2*b*h + c*h*x)*Sqrt[a + b*x + c*x^2])/ (15*c^2*f*(g + h*x))*Sqrt[d + e*x + f*Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[(e*g - d*h)^2 - f^2*(c*g^2 - b*g*h + a*h^2), 0] && EqQ[2*e^2*g - 2*d*e*h - f^2*(2*c*g - b*h), 0]
Int[(g_. + h_.*x_)^m_.*(u_ + f_.*(j_. + k_.*Sqrt[v_]))^n_., x_Symbol] := Int[(g + h*x)^ m*(ExpandToSum[u + f*j, x] + f*k*Sqrt[ExpandToSum[v, x]])^n, x] /; FreeQ[{f, g, h, j, k, m, n}, x] && LinearQ[u, x] && QuadraticQ[v, x] && Not[ LinearMatchQ[u, x] && QuadraticMatchQ[v, x] && (EqQ[j, 0] || EqQ[f, 1])] && EqQ[(Coefficient[u, x, 1]*g - h*(Coefficient[u, x, 0] + f*j))^2 - f^2*k^2*(Coefficient[v, x, 2]*g^2 - Coefficient[v, x, 1]*g*h + Coefficient[v, x, 0]*h^2), 0]
(* Int[1/(d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] := Int[(d+e*x)/(d^2-a*f^2+(2*d*e-b*f^2)*x),x] - f*Int[Sqrt[a+b*x+c*x^2]/(d^2-a*f^2+(2*d*e-b*f^2)*x),x] /; FreeQ[{a,b,c,d,e,f},x] && EqQ[e^2-c*f^2,0] *)
(* Int[1/(d_.+e_.*x_+f_.*Sqrt[a_.+c_.*x_^2]),x_Symbol] := Int[(d+e*x)/(d^2-a*f^2+2*d*e*x),x] - f*Int[Sqrt[a+c*x^2]/(d^2-a*f^2+2*d*e*x),x] /; FreeQ[{a,c,d,e,f},x] && EqQ[e^2-c*f^2,0] *)
Int[(g_. + h_.*(d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2])^n_)^ p_., x_Symbol] := 2*Subst[ Int[(g + h*x^n)^ p*(d^2*e - (b*d - a*e)*f^2 - (2*d*e - b*f^2)*x + e*x^2)/(-2*d*e + b*f^2 + 2*e*x)^2, x], x, d + e*x + f*Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c, d, e, f, g, h, n}, x] && EqQ[e^2 - c*f^2, 0] && IntegerQ[p]
Int[(g_. + h_.*(d_. + e_.*x_ + f_.*Sqrt[a_ + c_.*x_^2])^n_)^p_., x_Symbol] := 1/(2*e)* Subst[Int[(g + h*x^n)^p*(d^2 + a*f^2 - 2*d*x + x^2)/(d - x)^2, x], x, d + e*x + f*Sqrt[a + c*x^2]] /; FreeQ[{a, c, d, e, f, g, h, n}, x] && EqQ[e^2 - c*f^2, 0] && IntegerQ[p]
Int[(g_. + h_.*(u_ + f_. Sqrt[v_])^n_)^p_., x_Symbol] := Int[(g + h*(ExpandToSum[u, x] + f*Sqrt[ExpandToSum[v, x]])^n)^p, x] /; FreeQ[{f, g, h, n}, x] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]] && EqQ[Coefficient[u, x, 1]^2 - Coefficient[v, x, 2]*f^2, 0] && IntegerQ[p]
Int[(g_. + h_.*x_)^m_.*(e_.*x_ + f_.*Sqrt[a_. + c_.*x_^2])^n_., x_Symbol] := 1/(2^(m + 1)*e^(m + 1))* Subst[Int[ x^(n - m - 2)*(a*f^2 + x^2)*(-a*f^2*h + 2*e*g*x + h*x^2)^m, x], x, e*x + f*Sqrt[a + c*x^2]] /; FreeQ[{a, c, e, f, g, h, n}, x] && EqQ[e^2 - c*f^2, 0] && IntegerQ[m]
Int[x_^p_.*(g_ + i_.*x_^2)^m_.*(e_.*x_ + f_.*Sqrt[a_ + c_.*x_^2])^n_., x_Symbol] := 1/(2^(2*m + p + 1)*e^(p + 1)*f^(2*m))*(i/c)^m* Subst[Int[ x^(n - 2*m - p - 2)*(-a*f^2 + x^2)^p*(a*f^2 + x^2)^(2*m + 1), x], x, e*x + f*Sqrt[a + c*x^2]] /; FreeQ[{a, c, e, f, g, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && IntegersQ[p, 2*m] && (IntegerQ[m] || GtQ[i/c, 0])
Int[(g_. + h_.*x_ + i_.*x_^2)^ m_.*(d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2])^n_., x_Symbol] := 2/f^(2*m)*(i/c)^m* Subst[ Int[x^n*(d^2*e - (b*d - a*e)*f^2 - (2*d*e - b*f^2)*x + e*x^2)^(2*m + 1)/(-2*d*e + b*f^2 + 2*e*x)^(2*(m + 1)), x], x, d + e*x + f*Sqrt[a + b*x + c*x^2]] /; FreeQ[{a, b, c, d, e, f, g, h, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && EqQ[c*h - b*i, 0] && IntegerQ[2*m] && (IntegerQ[m] || GtQ[i/c, 0])
Int[(g_ + i_.*x_^2)^m_.*(d_. + e_.*x_ + f_.*Sqrt[a_ + c_.*x_^2])^n_., x_Symbol] := 1/(2^(2*m + 1)*e*f^(2*m))*(i/c)^m* Subst[ Int[x^n*(d^2 + a*f^2 - 2*d*x + x^2)^(2*m + 1)/(-d + x)^(2*(m + 1)), x], x, d + e*x + f*Sqrt[a + c*x^2]] /; FreeQ[{a, c, d, e, f, g, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && IntegerQ[2*m] && (IntegerQ[m] || GtQ[i/c, 0])
Int[(g_. + h_.*x_ + i_.*x_^2)^ m_.*(d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2])^n_., x_Symbol] := (i/c)^(m - 1/2)*Sqrt[g + h*x + i*x^2]/Sqrt[a + b*x + c*x^2]* Int[(a + b*x + c*x^2)^m*(d + e*x + f*Sqrt[a + b*x + c*x^2])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && EqQ[c*h - b*i, 0] && IGtQ[m + 1/2, 0] && Not[GtQ[i/c, 0]]
Int[(g_ + i_.*x_^2)^m_.*(d_. + e_.*x_ + f_.*Sqrt[a_ + c_.*x_^2])^n_., x_Symbol] := (i/c)^(m - 1/2)*Sqrt[g + i*x^2]/Sqrt[a + c*x^2]* Int[(a + c*x^2)^m*(d + e*x + f*Sqrt[a + c*x^2])^n, x] /; FreeQ[{a, c, d, e, f, g, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && IGtQ[m + 1/2, 0] && Not[GtQ[i/c, 0]]
Int[(g_. + h_.*x_ + i_.*x_^2)^ m_.*(d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2])^n_., x_Symbol] := (i/c)^(m + 1/2)*Sqrt[a + b*x + c*x^2]/Sqrt[g + h*x + i*x^2]* Int[(a + b*x + c*x^2)^m*(d + e*x + f*Sqrt[a + b*x + c*x^2])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && EqQ[c*h - b*i, 0] && ILtQ[m - 1/2, 0] && Not[GtQ[i/c, 0]]
Int[(g_ + i_.*x_^2)^m_.*(d_. + e_.*x_ + f_.*Sqrt[a_ + c_.*x_^2])^n_., x_Symbol] := (i/c)^(m + 1/2)*Sqrt[a + c*x^2]/Sqrt[g + i*x^2]* Int[(a + c*x^2)^m*(d + e*x + f*Sqrt[a + c*x^2])^n, x] /; FreeQ[{a, c, d, e, f, g, i, n}, x] && EqQ[e^2 - c*f^2, 0] && EqQ[c*g - a*i, 0] && ILtQ[m - 1/2, 0] && Not[GtQ[i/c, 0]]
Int[w_^m_.*(u_ + f_.*(j_. + k_.*Sqrt[v_]))^n_., x_Symbol] := Int[ExpandToSum[w, x]^ m*(ExpandToSum[u + f*j, x] + f*k*Sqrt[ExpandToSum[v, x]])^n, x] /; FreeQ[{f, j, k, m, n}, x] && LinearQ[u, x] && QuadraticQ[{v, w}, x] && Not[ LinearMatchQ[u, x] && QuadraticMatchQ[{v, w}, x] && (EqQ[j, 0] || EqQ[f, 1])] && EqQ[Coefficient[u, x, 1]^2 - Coefficient[v, x, 2]*f^2*k^2, 0]
Int[1/((a_ + b_.*x_^n_.)*Sqrt[c_.*x_^2 + d_.*(a_ + b_.*x_^n_.)^p_.]), x_Symbol] := 1/a*Subst[Int[1/(1 - c*x^2), x], x, x/Sqrt[c*x^2 + d*(a + b*x^n)^(2/n)]] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 2/n]
Int[Sqrt[a_ + b_.*Sqrt[c_ + d_.*x_^2]], x_Symbol] := 2*b^2*d*x^3/(3*(a + b*Sqrt[c + d*x^2])^(3/2)) + 2*a*x/Sqrt[a + b*Sqrt[c + d*x^2]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2*c, 0]
Int[Sqrt[ a_.*x_^2 + b_.*x_*Sqrt[c_ + d_.*x_^2]]/(x_*Sqrt[c_ + d_.*x_^2]), x_Symbol] := Sqrt[2]*b/a* Subst[Int[1/Sqrt[1 + x^2/a], x], x, a*x + b*Sqrt[c + d*x^2]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2*d, 0] && EqQ[b^2*c + a, 0]
Int[Sqrt[ e_.*x_*(a_.*x_ + b_.*Sqrt[c_ + d_.*x_^2])]/(x_* Sqrt[c_ + d_.*x_^2]), x_Symbol] := Int[Sqrt[a*e*x^2 + b*e*x*Sqrt[c + d*x^2]]/(x*Sqrt[c + d*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2*d, 0] && EqQ[b^2*c*e + a, 0]
Int[Sqrt[c_.*x_^2 + d_.*Sqrt[a_ + b_.*x_^4]]/Sqrt[a_ + b_.*x_^4], x_Symbol] := d*Subst[Int[1/(1 - 2*c*x^2), x], x, x/Sqrt[c*x^2 + d*Sqrt[a + b*x^4]]] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2 - b*d^2, 0]
Int[(c_. + d_.*x_)^m_.* Sqrt[b_.*x_^2 + Sqrt[a_ + e_.*x_^4]]/Sqrt[a_ + e_.*x_^4], x_Symbol] := (1 - I)/2*Int[(c + d*x)^m/Sqrt[Sqrt[a] - I*b*x^2], x] + (1 + I)/2*Int[(c + d*x)^m/Sqrt[Sqrt[a] + I*b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[e, b^2] && GtQ[a, 0]
Int[1/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := 2/(3*c)*Int[1/Sqrt[a + b*x^3], x] + 1/(3*c)*Int[(c - 2*d*x)/((c + d*x)*Sqrt[a + b*x^3]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c^3 - 4*a*d^3, 0]
Int[1/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := -6*a*d^3/(c*(b*c^3 - 28*a*d^3))*Int[1/Sqrt[a + b*x^3], x] + 1/(c*(b*c^3 - 28*a*d^3))* Int[Simp[c*(b*c^3 - 22*a*d^3) + 6*a*d^4*x, x]/((c + d*x)*Sqrt[a + b*x^3]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2*c^6 - 20*a*b*c^3*d^3 - 8*a^2*d^6, 0]
Int[1/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{q = Rt[b/a, 3]}, -q/((1 + Sqrt[3])*d - c*q)*Int[1/Sqrt[a + b*x^3], x] + d/((1 + Sqrt[3])*d - c*q)* Int[(1 + Sqrt[3] + q*x)/((c + d*x)*Sqrt[a + b*x^3]), x]] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2*c^6 - 20*a*b*c^3*d^3 - 8*a^2*d^6, 0]
Int[(e_ + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := 2*e/d* Subst[Int[1/(1 + 3*a*x^2), x], x, (1 + 2*d*x/c)/Sqrt[a + b*x^3]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && EqQ[b*c^3 - 4*a*d^3, 0] && EqQ[2*d*e + c*f, 0]
Int[(e_ + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := -2*e/d* Subst[Int[1/(9 - a*x^2), x], x, (1 + f*x/e)^2/Sqrt[a + b*x^3]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && EqQ[b*c^3 + 8*a*d^3, 0] && EqQ[2*d*e + c*f, 0]
Int[(e_. + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := (2*d*e + c*f)/(3*c*d)*Int[1/Sqrt[a + b*x^3], x] + (d*e - c*f)/(3*c*d)* Int[(c - 2*d*x)/((c + d*x)*Sqrt[a + b*x^3]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && (EqQ[b*c^3 - 4*a*d^3, 0] || EqQ[b*c^3 + 8*a*d^3, 0]) && NeQ[2*d*e + c*f, 0]
Int[(e_ + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{k = Simplify[(d*e + 2*c*f)/(c*f)]}, (1 + k)*e/d* Subst[Int[1/(1 + (3 + 2*k)*a*x^2), x], x, (1 + (1 + k)*d*x/c)/Sqrt[a + b*x^3]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && EqQ[b^2*c^6 - 20*a*b*c^3*d^3 - 8*a^2*d^6, 0] && EqQ[6*a*d^4*e - c*f*(b*c^3 - 22*a*d^3), 0]
Int[(e_. + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := -(6*a*d^4*e - c*f*(b*c^3 - 22*a*d^3))/(c*d*(b*c^3 - 28*a*d^3))* Int[1/Sqrt[a + b*x^3], x] + (d*e - c*f)/(c*d*(b*c^3 - 28*a*d^3))* Int[(c*(b*c^3 - 22*a*d^3) + 6*a*d^4*x)/((c + d*x)* Sqrt[a + b*x^3]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && EqQ[b^2*c^6 - 20*a*b*c^3*d^3 - 8*a^2*d^6, 0] && NeQ[6*a*d^4*e - c*f*(b*c^3 - 22*a*d^3), 0]
(* Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] := With[{q=(1+Sqrt[3])*f/e}, 4*3^(1/4)*Sqrt[2-Sqrt[3]]*f*(1+Sqrt[3]+q*x)^2*Sqrt[(1+q^3*x^3)/(1+ Sqrt[3]+q*x)^4]/(q*Sqrt[a+b*x^3])* Subst[Int[1/(((1-Sqrt[3])*d-c*q+((1+Sqrt[3])*d-c*q)*x)* Sqrt[7-4*Sqrt[3]-2*(3-2*Sqrt[3])*x^2-x^4]),x],x,(-1+Sqrt[3]-q*x) /(1+Sqrt[3]+q*x)]] /; FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] &&  EqQ[b*e^3-2*(5+3*Sqrt[3])*a*f^3,0] &&  NeQ[b*c^3-2*(5-3*Sqrt[3])*a*d^3,0] *)
Int[(e_ + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{q = Simplify[(1 + Sqrt[3])*f/e]}, 4*3^(1/4)*Sqrt[2 - Sqrt[3]]*f*(1 + q*x)* Sqrt[(1 - q*x + q^2*x^2)/(1 + Sqrt[3] + q*x)^2]/ (q*Sqrt[a + b*x^3]*Sqrt[(1 + q*x)/(1 + Sqrt[3] + q*x)^2])* Subst[ Int[1/(((1 - Sqrt[3])*d - c*q + ((1 + Sqrt[3])*d - c*q)*x)* Sqrt[1 - x^2]*Sqrt[7 - 4*Sqrt[3] + x^2]), x], x, (-1 + Sqrt[3] - q*x)/(1 + Sqrt[3] + q*x)]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && EqQ[b*e^3 - 2*(5 + 3*Sqrt[3])*a*f^3, 0] && NeQ[b*c^3 - 2*(5 - 3*Sqrt[3])*a*d^3, 0]
Int[(e_ + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{q = Simplify[(-1 + Sqrt[3])*f/e]}, 4*3^(1/4)*Sqrt[2 + Sqrt[3]]*f*(1 - q*x)* Sqrt[(1 + q*x + q^2*x^2)/(1 - Sqrt[3] - q*x)^2]/ (q*Sqrt[a + b*x^3]*Sqrt[-(1 - q*x)/(1 - Sqrt[3] - q*x)^2])* Subst[ Int[1/(((1 + Sqrt[3])*d + c*q + ((1 - Sqrt[3])*d + c*q)*x)* Sqrt[1 - x^2]*Sqrt[7 + 4*Sqrt[3] + x^2]), x], x, (1 + Sqrt[3] - q*x)/(-1 + Sqrt[3] + q*x)]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && EqQ[b*e^3 - 2*(5 - 3*Sqrt[3])*a*f^3, 0] && NeQ[b*c^3 - 2*(5 + 3*Sqrt[3])*a*d^3, 0]
Int[(e_. + f_.*x_)/((c_ + d_.*x_)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := With[{q = Rt[b/a, 3]}, ((1 + Sqrt[3])*f - e*q)/((1 + Sqrt[3])*d - c*q)* Int[1/Sqrt[a + b*x^3], x] + (d*e - c*f)/((1 + Sqrt[3])*d - c*q)* Int[(1 + Sqrt[3] + q*x)/((c + d*x)*Sqrt[a + b*x^3]), x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && NeQ[b^2*c^6 - 20*a*b*c^3*d^3 - 8*a^2*d^6, 0] && NeQ[b^2*e^6 - 20*a*b*e^3*f^3 - 8*a^2*f^6, 0]
Int[(f_ + g_.*x_ + h_.*x_^2)/((c_ + d_.*x_ + e_.*x_^2)* Sqrt[a_ + b_.*x_^3]), x_Symbol] := -2*g*h* Subst[Int[1/(2*e*h - (b*d*f - 2*a*e*h)*x^2), x], x, (1 + 2*h*x/g)/Sqrt[a + b*x^3]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && NeQ[b*d*f - 2*a*e*h, 0] && EqQ[b*g^3 - 8*a*h^3, 0] && EqQ[g^2 + 2*f*h, 0] && EqQ[b*d*f + b*c*g - 4*a*e*h, 0]
Int[(f_ + g_.*x_ + h_.*x_^2)/((c_ + e_.*x_^2)*Sqrt[a_ + b_.*x_^3]), x_Symbol] := -g/e*Subst[Int[1/(1 + a*x^2), x], x, (1 + 2*h*x/g)/Sqrt[a + b*x^3]] /; FreeQ[{a, b, c, e, f, g, h}, x] && EqQ[b*g^3 - 8*a*h^3, 0] && EqQ[g^2 + 2*f*h, 0] && EqQ[b*c*g - 4*a*e*h, 0]
Int[Sqrt[a_ + b_.*x_^3]/(c_ + d_.*x_), x_Symbol] := b/d*Int[x^2/Sqrt[a + b*x^3], x] + b*c/d^3*Int[(c - d*x)/Sqrt[a + b*x^3], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b*c^3 - a*d^3, 0]
Int[Sqrt[a_ + b_.*x_^3]/(c_ + d_.*x_), x_Symbol] := b/d*Int[x^2/Sqrt[a + b*x^3], x] + b*c/d^3*Int[(c - d*x)/Sqrt[a + b*x^3], x] - (b*c^3 - a*d^3)/d^3*Int[1/((c + d*x)*Sqrt[a + b*x^3]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c^3 - a*d^3, 0]
Int[1/((c_ + d_.*x_)*(a_ + b_.*x_^3)^(1/3)), x_Symbol] := Sqrt[3]* ArcTan[(1 - 2^(1/3)*Rt[b, 3]*(c - d*x)/(d*(a + b*x^3)^(1/3)))/ Sqrt[3]]/(2^(4/3)*Rt[b, 3]*c) + Log[(c + d*x)^2*(c - d*x)]/(2^(7/3)*Rt[b, 3]*c) - (3*Log[ Rt[b, 3]*(c - d*x) + 2^(2/3)*d*(a + b*x^3)^(1/3)])/(2^(7/3)* Rt[b, 3]*c) /; FreeQ[{a, b, c, d}, x] && EqQ[b*c^3 + a*d^3, 0]
Int[1/((c_ + d_.*x_)*(a_ + b_.*x_^3)^(1/3)), x_Symbol] := 1/(2*c)*Int[1/(a + b*x^3)^(1/3), x] + 1/(2*c)*Int[(c - d*x)/((c + d*x)*(a + b*x^3)^(1/3)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[2*b*c^3 - a*d^3, 0]
Int[(e_ + f_.*x_)/((c_ + d_.*x_)*(a_ + b_.*x_^3)^(1/3)), x_Symbol] := Sqrt[3]*f* ArcTan[(1 + 2*Rt[b, 3]*(2*c + d*x)/(d*(a + b*x^3)^(1/3)))/ Sqrt[3]]/(Rt[b, 3]*d) + (f*Log[c + d*x])/(Rt[b, 3]*d) - (3*f*Log[Rt[b, 3]*(2*c + d*x) - d*(a + b*x^3)^(1/3)])/(2* Rt[b, 3]*d) /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[d*e + c*f, 0] && EqQ[2*b*c^3 - a*d^3, 0]
Int[(e_. + f_.*x_)/((c_. + d_.*x_)*(a_ + b_.*x_^3)^(1/3)), x_Symbol] := f/d*Int[1/(a + b*x^3)^(1/3), x] + (d*e - c*f)/d* Int[1/((c + d*x)*(a + b*x^3)^(1/3)), x] /; FreeQ[{a, b, c, d, e, f}, x]
Int[(a_ + b_.*x_^3)^(2/3)/(c_ + d_.*x_), x_Symbol] := (a + b*x^3)^(2/3)/(2*d) - b*c/d^2*Int[x/(a + b*x^3)^(1/3), x] + 1/d^2*Int[(a*d^2 + b*c^2*x)/((c + d*x)*(a + b*x^3)^(1/3)), x] /; FreeQ[{a, b, c, d}, x]
Int[1/((c_ + d_.*x_)*(a_ + b_.*x_^3)^(2/3)), x_Symbol] := With[{q = Rt[b, 3]}, -d*ArcTan[(1 + 2*q*x/(a + b*x^3)^(1/3))/Sqrt[3]]/(2*Sqrt[3]*q^2* c^2) + Sqrt[3]*d* ArcTan[(1 + 2*q*(2*c + d*x)/(d*(a + b*x^3)^(1/3)))/Sqrt[3]]/(2* q^2*c^2) - d*Log[c + d*x]/(2*q^2*c^2) - d*Log[q*x - (a + b*x^3)^(1/3)]/(4*q^2*c^2) + 3*d*Log[q*(2*c + d*x) - d*(a + b*x^3)^(1/3)]/(4*q^2*c^2)] /; FreeQ[{a, b, c, d}, x] && EqQ[2*b*c^3 - a*d^3, 0]
Int[x_^m_.*Px_*(c_ + d_.*x_)^q_*(a_ + b_.*x_^3)^p_., x_Symbol] := Int[ExpandIntegrand[(c^3 + d^3*x^3)^q*(a + b*x^3)^p, x^m*Px/(c^2 - c*d*x + d^2*x^2)^q, x], x] /; FreeQ[{a, b, c, d, m, p}, x] && PolyQ[Px, x] && ILtQ[q, 0] && IntegerQ[m] && RationalQ[p] && EqQ[Denominator[p], 3]
Int[Px_.*(c_ + d_.*x_)^q_*(a_ + b_.*x_^3)^p_., x_Symbol] := Int[ExpandIntegrand[(c^3 + d^3*x^3)^q*(a + b*x^3)^p, Px/(c^2 - c*d*x + d^2*x^2)^q, x], x] /; FreeQ[{a, b, c, d, p}, x] && PolyQ[Px, x] && ILtQ[q, 0] && RationalQ[p] && EqQ[Denominator[p], 3]
Int[x_^m_.*Px_*(c_ + d_.*x_ + e_.*x_^2)^q_*(a_ + b_.*x_^3)^p_., x_Symbol] := 1/c^q* Int[ExpandIntegrand[(c^3 - d^3*x^3)^q*(a + b*x^3)^p, x^m*Px/(c - d*x)^q, x], x] /; FreeQ[{a, b, c, d, e, m, p}, x] && PolyQ[Px, x] && EqQ[d^2 - c*e, 0] && ILtQ[q, 0] && IntegerQ[m] && RationalQ[p] && EqQ[Denominator[p], 3]
Int[Px_.*(c_ + d_.*x_ + e_.*x_^2)^q_*(a_ + b_.*x_^3)^p_., x_Symbol] := 1/c^q* Int[ExpandIntegrand[(c^3 - d^3*x^3)^q*(a + b*x^3)^p, Px/(c - d*x)^q, x], x] /; FreeQ[{a, b, c, d, e, p}, x] && PolyQ[Px, x] && EqQ[d^2 - c*e, 0] && ILtQ[q, 0] && RationalQ[p] && EqQ[Denominator[p], 3]
Int[(c_ + d_.*x_^n_.)^q_*(a_ + b_.*x_^nn_.)^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*x^nn)^ p, (c/(c^2 - d^2*x^(2*n)) - d*x^n/(c^2 - d^2*x^(2*n)))^(-q), x], x] /; FreeQ[{a, b, c, d, n, nn, p}, x] && Not[IntegerQ[p]] && ILtQ[q, 0] && IGtQ[Log[2, nn/n], 0]
Int[(e_.*x_)^m_.*(c_ + d_.*x_^n_.)^q_*(a_ + b_.*x_^nn_.)^p_, x_Symbol] := (e*x)^m/x^m* Int[ExpandIntegrand[ x^m*(a + b*x^nn)^ p, (c/(c^2 - d^2*x^(2*n)) - d*x^n/(c^2 - d^2*x^(2*n)))^(-q), x], x] /; FreeQ[{a, b, c, d, e, m, n, nn, p}, x] && Not[IntegerQ[p]] && ILtQ[q, 0] && IGtQ[Log[2, nn/n], 0]
Int[x_^m_./(c_ + d_.*x_^n_ + e_.*Sqrt[a_ + b_.*x_^n_]), x_Symbol] := 1/n*Subst[Int[x^((m + 1)/n - 1)/(c + d*x + e*Sqrt[a + b*x]), x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[b*c - a*d, 0] && IntegerQ[(m + 1)/n]
Int[u_./(c_ + d_.*x_^n_ + e_.*Sqrt[a_ + b_.*x_^n_]), x_Symbol] := c*Int[u/(c^2 - a*e^2 + c*d*x^n), x] - a*e*Int[u/((c^2 - a*e^2 + c*d*x^n)*Sqrt[a + b*x^n]), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[b*c - a*d, 0]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Miscellaneous/1.3.4 Normalizing algebraic functions.m
*)

(* ::Subsection::Closed:: *)
(* 1.3.4 Normalizing algebraic functions *)
Int[u_.*(c_.*(d_*(a_. + b_.* x_))^q_)^p_, x_Symbol] := (c*(d*(a + b*x))^q)^p/(a + b*x)^(p*q)*Int[u*(a + b*x)^(p*q), x] /; FreeQ[{a, b, c, d, q, p}, x] && Not[IntegerQ[q]] && Not[IntegerQ[p]]
Int[u_.*(c_.*(d_.*(a_. + b_.* x_)^n_)^q_)^p_, x_Symbol] := (c*(d*(a + b*x)^n)^q)^p/(a + b*x)^(n*p*q)* Int[u*(a + b*x)^(n*p*q), x] /; FreeQ[{a, b, c, d, n, q, p}, x] && Not[IntegerQ[q]] && Not[IntegerQ[p]]
Int[u_.*(c_.*(a_. + b_.*x_^n_.)^q_)^p_, x_Symbol] := Simp[(c*(a + b*x^n)^q)^p/(a + b*x^n)^(p*q)]* Int[u*(a + b*x^n)^(p*q), x] /; FreeQ[{a, b, c, n, p, q}, x] && GeQ[a, 0]
Int[u_.*(c_.*(a_ + b_.*x_^n_.)^q_)^p_, x_Symbol] := Simp[(c*(a + b*x^n)^q)^p/(1 + b*x^n/a)^(p*q)]* Int[u*(1 + b*x^n/a)^(p*q), x] /; FreeQ[{a, b, c, n, p, q}, x] && Not[GeQ[a, 0]]
Int[u_.*(e_.*(a_. + b_.*x_^n_.)^q_.*(c_ + d_.*x_^n_.)^q_.)^p_, x_Symbol] := Int[u*(e*(d/b)^q*(a + b*x^n)^(2*q))^p, x] /; FreeQ[{a, b, c, d, e, n, p}, x] && IntegerQ[q] && EqQ[b*c - a*d, 0]
Int[u_.*(e_.*(a_. + b_.*x_^n_.)^q_*(c_ + d_.*x_^n_.)^q_)^p_, x_Symbol] := Int[u*(e*(-a^2*d/b + b*d*x^(2*n))^q)^p, x] /; FreeQ[{a, b, c, d, e, n, p}, x] && IntegerQ[q] && EqQ[b*c + a*d, 0]
(* Int[u_.*((a_.+b_.*x_^n_.)*(c_+d_.*x_^n_.))^p_,x_Symbol] := Int[u*(a+b*x^n)^p*(c+d*x^n)^p,x] /; FreeQ[{a,b,c,d,n,p},x] && EqQ[b+d,0] && GtQ[a,0] && GtQ[c,0] *)
Int[u_.*(e_.*(a_. + b_.*x_^n_.)*(c_ + d_.*x_^n_.))^p_, x_Symbol] := Int[u*(a*c*e + (b*c + a*d)*e*x^n + b*d*e*x^(2*n))^p, x] /; FreeQ[{a, b, c, d, e, n, p}, x]
Int[u_.*(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := (b*e/d)^p*Int[u, x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*c - a*d, 0]
Int[u_.*(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := Int[u*(a*e + b*e*x^n)^p/(c + d*x^n)^p, x] /; FreeQ[{a, b, c, d, e, n, p}, x] && GtQ[b*d*e, 0] && GtQ[c - a*d/b, 0]
(* Int[u_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] := Int[u*(a*e+b*e*x^n)^p/(c+d*x^n)^p,x] /; FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c+a*d,0] && GtQ[b*e/d,0] &&  GtQ[c,0] *)
(* Int[u_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] := Int[u*(-a*e-b*e*x^n)^p/(-c-d*x^n)^p,x] /; FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c+a*d,0] && GtQ[b*e/d,0] &&  LtQ[c,0] *)
Int[(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := With[{q = Denominator[p]}, q*e*(b*c - a*d)/n*Subst[ Int[x^(q*(p + 1) - 1)*(-a*e + c*x^q)^(1/n - 1)/(b*e - d*x^q)^(1/n + 1), x], x, (e*(a + b*x^n)/(c + d*x^n))^(1/q)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[p] && IntegerQ[1/n]
Int[x_^m_.*(e_.*(a_. + b_.*x_)/(c_ + d_.*x_))^p_, x_Symbol] := With[{q = Denominator[p]}, q*e*(b*c - a*d)* Subst[Int[ x^(q*(p + 1) - 1)*(-a*e + c*x^q)^m/(b*e - d*x^q)^(m + 2), x], x, (e*(a + b*x)/(c + d*x))^(1/q)]] /; FreeQ[{a, b, c, d, e, m}, x] && FractionQ[p] && IntegerQ[m]
Int[x_^m_.*(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(e*(a + b*x)/(c + d*x))^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(f_*x_)^m_*(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := Simp[(c*x)^m/x^m]*Int[x^m*(e*(a + b*x^n)/(c + d*x^n))^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[u_^r_.*(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := With[{q = Denominator[p]}, q*e*(b*c - a*d)/n* Subst[Int[ SimplifyIntegrand[ x^(q*(p + 1) - 1)*(-a*e + c*x^q)^(1/n - 1)/(b*e - d*x^q)^(1/n + 1)* ReplaceAll[u, x -> (-a*e + c*x^q)^(1/n)/(b*e - d*x^q)^(1/n)]^r, x], x], x, (e*(a + b*x^n)/(c + d*x^n))^(1/q)]] /; FreeQ[{a, b, c, d, e}, x] && PolynomialQ[u, x] && FractionQ[p] && IntegerQ[1/n] && IntegerQ[r]
Int[x_^m_.*u_^r_.*(e_.*(a_. + b_.*x_^n_.)/(c_ + d_.*x_^n_.))^p_, x_Symbol] := With[{q = Denominator[p]}, q*e*(b*c - a*d)/n* Subst[Int[ SimplifyIntegrand[ x^(q*(p + 1) - 1)*(-a*e + c*x^q)^((m + 1)/n - 1)/(b*e - d*x^q)^((m + 1)/n + 1)* ReplaceAll[u, x -> (-a*e + c*x^q)^(1/n)/(b*e - d*x^q)^(1/n)]^r, x], x], x, (e*(a + b*x^n)/(c + d*x^n))^(1/q)]] /; FreeQ[{a, b, c, d, e}, x] && PolynomialQ[u, x] && FractionQ[p] && IntegerQ[1/n] && IntegersQ[m, r]
Int[u_.*(a_ + b_./(c_ + d_.*x_^n_))^p_, x_Symbol] := Int[u*((b + a*c + a*d*x^n)/(c + d*x^n))^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[u_.*(e_.*(a_. + b_.*x_^n_.)^q_.*(c_ + d_.*x_^n_)^r_.)^p_, x_Symbol] := Simp[(e*(a + b*x^n)^q*(c + d*x^n)^r)^ p/((a + b*x^n)^(p*q)*(c + d*x^n)^(p*r))]* Int[u*(a + b*x^n)^(p*q)*(c + d*x^n)^(p*r), x] /; FreeQ[{a, b, c, d, e, n, p, q, r}, x]
Int[(a_. + b_.*(c_./x_)^n_)^p_, x_Symbol] := -c*Subst[Int[(a + b*x^n)^p/x^2, x], x, c/x] /; FreeQ[{a, b, c, n, p}, x]
Int[x_^m_.*(a_. + b_.*(c_./x_)^n_)^p_, x_Symbol] := -c^(m + 1)*Subst[Int[(a + b*x^n)^p/x^(m + 2), x], x, c/x] /; FreeQ[{a, b, c, n, p}, x] && IntegerQ[m]
Int[(d_.*x_)^m_*(a_. + b_.*(c_./x_)^n_)^p_, x_Symbol] := -c*(d*x)^m*(c/x)^m*Subst[Int[(a + b*x^n)^p/x^(m + 2), x], x, c/x] /; FreeQ[{a, b, c, d, m, n, p}, x] && Not[IntegerQ[m]]
Int[(a_. + b_.*(d_./x_)^n_ + c_.*(d_./x_)^n2_.)^p_, x_Symbol] := -d*Subst[Int[(a + b*x^n + c*x^(2*n))^p/x^2, x], x, d/x] /; FreeQ[{a, b, c, d, n, p}, x] && EqQ[n2, 2*n]
Int[x_^m_.*(a_ + b_.*(d_./x_)^n_ + c_.*(d_./x_)^n2_.)^p_, x_Symbol] := -d^(m + 1)* Subst[Int[(a + b*x^n + c*x^(2*n))^p/x^(m + 2), x], x, d/x] /; FreeQ[{a, b, c, d, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m]
Int[(e_.*x_)^m_*(a_ + b_.*(d_./x_)^n_ + c_.*(d_./x_)^n2_.)^p_, x_Symbol] := -d*(e*x)^m*(d/x)^m* Subst[Int[(a + b*x^n + c*x^(2*n))^p/x^(m + 2), x], x, d/x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[m]]
Int[(a_. + b_.*(d_./x_)^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -d*Subst[Int[(a + b*x^n + c/d^(2*n)*x^(2*n))^p/x^2, x], x, d/x] /; FreeQ[{a, b, c, d, n, p}, x] && EqQ[n2, -2*n] && IntegerQ[2*n]
Int[x_^m_.*(a_ + b_.*(d_./x_)^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -d^(m + 1)* Subst[Int[(a + b*x^n + c/d^(2*n)*x^(2*n))^p/x^(m + 2), x], x, d/x] /; FreeQ[{a, b, c, d, n, p}, x] && EqQ[n2, -2*n] && IntegerQ[2*n] && IntegerQ[m]
Int[(e_.*x_)^m_*(a_ + b_.*(d_./x_)^n_ + c_.*x_^n2_.)^p_, x_Symbol] := -d*(e*x)^m*(d/x)^m* Subst[Int[(a + b*x^n + c/d^(2*n)*x^(2*n))^p/x^(m + 2), x], x, d/x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, -2*n] && Not[IntegerQ[m]] && IntegerQ[2*n]
Int[u_.*(e_.*(a_ + b_.*x_^n_.)^r_.)^p_*(f_.*(c_ + d_.*x_^n_.)^s_)^q_, x_Symbol] := (e*(a + b*x^n)^r)^ p*(f*(c + d*x^n)^s)^q/((a + b*x^n)^(p*r)*(c + d*x^n)^(q*s))* Int[u*(a + b*x^n)^(p*r)*(c + d*x^n)^(q*s), x] /; FreeQ[{a, b, c, d, e, f, n, p, q, r, s}, x]
Int[u_^m_, x_Symbol] := Int[ExpandToSum[u, x]^m, x] /; FreeQ[m, x] && LinearQ[u, x] && Not[LinearMatchQ[u, x]]
Int[u_^m_.*v_^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n, x] /; FreeQ[{m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*v_^n_.*w_^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n*ExpandToSum[w, x]^p, x] /; FreeQ[{m, n, p}, x] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]
Int[u_^m_.*v_^n_.*w_^p_.*z_^q_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n*ExpandToSum[w, x]^p* ExpandToSum[z, x]^q, x] /; FreeQ[{m, n, p, q}, x] && LinearQ[{u, v, w, z}, x] && Not[LinearMatchQ[{u, v, w, z}, x]]
Int[u_^p_, x_Symbol] := Int[ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(c_.*x_)^m_.*u_^p_., x_Symbol] := Int[(c*x)^m*ExpandToSum[u, x]^p, x] /; FreeQ[{c, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[u_^p_.*v_^q_., x_Symbol] := Int[ExpandToSum[u, x]^p*ExpandToSum[v, x]^q, x] /; FreeQ[{p, q}, x] && BinomialQ[{u, v}, x] && EqQ[BinomialDegree[u, x] - BinomialDegree[v, x], 0] && Not[BinomialMatchQ[{u, v}, x]]
Int[(e_.*x_)^m_.*u_^p_.*v_^q_., x_Symbol] := Int[(e*x)^m*ExpandToSum[u, x]^p*ExpandToSum[v, x]^q, x] /; FreeQ[{e, m, p, q}, x] && BinomialQ[{u, v}, x] && EqQ[BinomialDegree[u, x] - BinomialDegree[v, x], 0] && Not[BinomialMatchQ[{u, v}, x]]
Int[u_^m_.*v_^p_.*w_^q_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^p*ExpandToSum[w, x]^q, x] /; FreeQ[{m, p, q}, x] && BinomialQ[{u, v, w}, x] && EqQ[BinomialDegree[u, x] - BinomialDegree[v, x], 0] && EqQ[BinomialDegree[u, x] - BinomialDegree[w, x], 0] && Not[BinomialMatchQ[{u, v, w}, x]]
Int[(g_.*x_)^m_.*u_^p_.*v_^q_.*z_^r_., x_Symbol] := Int[(g*x)^m*ExpandToSum[u, x]^p*ExpandToSum[v, x]^q* ExpandToSum[z, x]^r, x] /; FreeQ[{g, m, p, q, r}, x] && BinomialQ[{u, v, z}, x] && EqQ[BinomialDegree[u, x] - BinomialDegree[v, x], 0] && EqQ[BinomialDegree[u, x] - BinomialDegree[z, x], 0] && Not[BinomialMatchQ[{u, v, z}, x]]
Int[(c_.*x_)^m_.*Pq_*u_^p_., x_Symbol] := Int[(c*x)^m*Pq*ExpandToSum[u, x]^p, x] /; FreeQ[{c, m, p}, x] && PolyQ[Pq, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[u_^p_, x_Symbol] := Int[ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && GeneralizedBinomialQ[u, x] && Not[GeneralizedBinomialMatchQ[u, x]]
Int[(c_.*x_)^m_.*u_^p_., x_Symbol] := Int[(c*x)^m*ExpandToSum[u, x]^p, x] /; FreeQ[{c, m, p}, x] && GeneralizedBinomialQ[u, x] && Not[GeneralizedBinomialMatchQ[u, x]]
Int[u_^p_, x_Symbol] := Int[ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && QuadraticQ[u, x] && Not[QuadraticMatchQ[u, x]]
Int[u_^m_.*v_^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^p, x] /; FreeQ[{m, p}, x] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]
Int[u_^m_.*v_^n_.*w_^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*ExpandToSum[v, x]^n*ExpandToSum[w, x]^p, x] /; FreeQ[{m, n, p}, x] && LinearQ[{u, v}, x] && QuadraticQ[w, x] && Not[LinearMatchQ[{u, v}, x] && QuadraticMatchQ[w, x]]
Int[u_^p_.*v_^q_., x_Symbol] := Int[ExpandToSum[u, x]^p*ExpandToSum[v, x]^q, x] /; FreeQ[{p, q}, x] && QuadraticQ[{u, v}, x] && Not[QuadraticMatchQ[{u, v}, x]]
Int[z_^m_.*u_^p_.*v_^q_., x_Symbol] := Int[ExpandToSum[z, x]^m*ExpandToSum[u, x]^p*ExpandToSum[v, x]^q, x] /; FreeQ[{m, p, q}, x] && LinearQ[z, x] && QuadraticQ[{u, v}, x] && Not[LinearMatchQ[z, x] && QuadraticMatchQ[{u, v}, x]]
Int[Pq_*u_^p_., x_Symbol] := Int[Pq*ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && PolyQ[Pq, x] && QuadraticQ[u, x] && Not[QuadraticMatchQ[u, x]]
Int[u_^m_.*Pq_*v_^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*Pq*ExpandToSum[v, x]^p, x] /; FreeQ[{m, p}, x] && PolyQ[Pq, x] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]
Int[u_^p_, x_Symbol] := Int[ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && TrinomialQ[u, x] && Not[TrinomialMatchQ[u, x]]
Int[(d_.*x_)^m_.*u_^p_., x_Symbol] := Int[(d*x)^m*ExpandToSum[u, x]^p, x] /; FreeQ[{d, m, p}, x] && TrinomialQ[u, x] && Not[TrinomialMatchQ[u, x]]
Int[u_^q_.*v_^p_., x_Symbol] := Int[ExpandToSum[u, x]^q*ExpandToSum[v, x]^p, x] /; FreeQ[{p, q}, x] && BinomialQ[u, x] && TrinomialQ[v, x] && Not[BinomialMatchQ[u, x] && TrinomialMatchQ[v, x]]
Int[u_^q_.*v_^p_., x_Symbol] := Int[ExpandToSum[u, x]^q*ExpandToSum[v, x]^p, x] /; FreeQ[{p, q}, x] && BinomialQ[u, x] && BinomialQ[v, x] && Not[BinomialMatchQ[u, x] && BinomialMatchQ[v, x]]
Int[(f_.*x_)^m_.*z_^q_.*u_^p_., x_Symbol] := Int[(f*x)^m*ExpandToSum[z, x]^q*ExpandToSum[u, x]^p, x] /; FreeQ[{f, m, p, q}, x] && BinomialQ[z, x] && TrinomialQ[u, x] && Not[BinomialMatchQ[z, x] && TrinomialMatchQ[u, x]]
Int[(f_.*x_)^m_.*z_^q_.*u_^p_., x_Symbol] := Int[(f*x)^m*ExpandToSum[z, x]^q*ExpandToSum[u, x]^p, x] /; FreeQ[{f, m, p, q}, x] && BinomialQ[z, x] && BinomialQ[u, x] && Not[BinomialMatchQ[z, x] && BinomialMatchQ[u, x]]
Int[Pq_*u_^p_., x_Symbol] := Int[Pq*ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && PolyQ[Pq, x] && TrinomialQ[u, x] && Not[TrinomialMatchQ[u, x]]
Int[(d_.*x_)^m_.*Pq_*u_^p_., x_Symbol] := Int[(d*x)^m*Pq*ExpandToSum[u, x]^p, x] /; FreeQ[{d, m, p}, x] && PolyQ[Pq, x] && TrinomialQ[u, x] && Not[TrinomialMatchQ[u, x]]
Int[u_^p_, x_Symbol] := Int[ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && GeneralizedTrinomialQ[u, x] && Not[GeneralizedTrinomialMatchQ[u, x]]
Int[(d_.*x_)^m_.*u_^p_., x_Symbol] := Int[(d*x)^m*ExpandToSum[u, x]^p, x] /; FreeQ[{d, m, p}, x] && GeneralizedTrinomialQ[u, x] && Not[GeneralizedTrinomialMatchQ[u, x]]
Int[z_*u_^p_., x_Symbol] := Int[ExpandToSum[z, x]*ExpandToSum[u, x]^p, x] /; FreeQ[p, x] && BinomialQ[z, x] && GeneralizedTrinomialQ[u, x] && EqQ[BinomialDegree[z, x] - GeneralizedTrinomialDegree[u, x], 0] && Not[BinomialMatchQ[z, x] && GeneralizedTrinomialMatchQ[u, x]]
Int[(f_.*x_)^m_.*z_*u_^p_., x_Symbol] := Int[(f*x)^m*ExpandToSum[z, x]*ExpandToSum[u, x]^p, x] /; FreeQ[{f, m, p}, x] && BinomialQ[z, x] && GeneralizedTrinomialQ[u, x] && EqQ[BinomialDegree[z, x] - GeneralizedTrinomialDegree[u, x], 0] && Not[BinomialMatchQ[z, x] && GeneralizedTrinomialMatchQ[u, x]]

(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Polynomial products/1.3.1 u (a+b x+c x^2+d x^3)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  Px^FracPart[p]/(x^FracPart[p]*(b+c*x+d*x^2)^FracPart[p]) \[Star] Int[u*x^p*(b+c*x+d*x^2)^p,x]] /;
FreeQ[p,x] && PolyQ[Px,x,3] && EqQ[Coeff[Px,x,0],0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(a_.+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  1/(3^(3*p)*a^(2*p)) \[Star] Int[(3*a-b*x)^p*(3*a+2*b*x)^(2*p),x] /;
FreeQ[{a,b,d},x] && EqQ[4*b^3+27*a^2*d,0] && IntegerQ[p]


(* ::Code:: *)
Int[(a_.+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  (a+b*x+d*x^3)^p/((3*a-b*x)^p*(3*a+2*b*x)^(2*p)) \[Star] Int[(3*a-b*x)^p*(3*a+2*b*x)^(2*p),x] /;
FreeQ[{a,b,d,p},x] && EqQ[4*b^3+27*a^2*d,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(a_.+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  With[{r=Rt[-9*a*d^2+Sqrt[3]*d*Sqrt[4*b^3*d+27*a^2*d^2],3]},
  1/d^(2*p) \[Star] Int[Simp[18^(1/3)*b*d/(3*r)-r/18^(1/3)+d*x,x]^p*
    Simp[b*d/3+12^(1/3)*b^2*d^2/(3*r^2)+r^2/(3*12^(1/3))-d*(2^(1/3)*b*d/(3^(1/3)*r)-r/18^(1/3))*x+d^2*x^2,x]^p,x]] /;
FreeQ[{a,b,d},x] && NeQ[4*b^3+27*a^2*d,0] && IntegerQ[p]


(* ::Code:: *)
Int[(a_.+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  With[{r=Rt[-9*a*d^2+Sqrt[3]*d*Sqrt[4*b^3*d+27*a^2*d^2],3]},
  (a+b*x+d*x^3)^p/
    (Simp[18^(1/3)*b*d/(3*r)-r/18^(1/3)+d*x,x]^p*
      Simp[b*d/3+12^(1/3)*b^2*d^2/(3*r^2)+r^2/(3*12^(1/3))-d*(2^(1/3)*b*d/(3^(1/3)*r)-r/18^(1/3))*x+d^2*x^2,x]^p) \[Star] 
    Int[Simp[18^(1/3)*b*d/(3*r)-r/18^(1/3)+d*x,x]^p*
      Simp[b*d/3+12^(1/3)*b^2*d^2/(3*r^2)+r^2/(3*12^(1/3))-d*(2^(1/3)*b*d/(3^(1/3)*r)-r/18^(1/3))*x+d^2*x^2,x]^p,x]] /;
FreeQ[{a,b,d,p},x] && NeQ[4*b^3+27*a^2*d,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[Px_^p_,x_Symbol] :=
  With[{a=Coeff[Px,x,0],b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  1/d^p \[Star] Int[(c+d*x)^p*(b+d*x^2)^p,x] /;
 EqQ[b*c-a*d,0]] /;
PolyQ[Px,x,3] && IntegerQ[p]


(* ::Code:: *)
Int[Px_^p_,x_Symbol] :=
  With[{a=Coeff[Px,x,0],b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  Px^p/((c+d*x)^p*(b+d*x^2)^p) \[Star] Int[(c+d*x)^p*(b+d*x^2)^p,x] /;
 EqQ[b*c-a*d,0]] /;
FreeQ[p,x] && PolyQ[Px,x,3] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[Px_^p_,x_Symbol] :=
  With[{a=Coeff[Px,x,0],b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  Subst[Int[Simp[a-b^2/(3*c)+d*x^3,x]^p,x],x,c/(3*d)+x] /;
 EqQ[c^2-3*b*d,0]] /;
FreeQ[p,x] && PolyQ[Px,x,3]


(* ::Code:: *)
Int[Px_^p_,x_Symbol] :=
  With[{a=Coeff[Px,x,0],b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  1/(4^p*(c^2-3*b*d)^(3*p)) \[Star] Int[(c^3-4*b*c*d+9*a*d^2+d*(c^2-3*b*d)*x)^p*(b*c-9*a*d+2*(c^2-3*b*d)*x)^(2*p),x] /;
 EqQ[b^2*c^2-4*a*c^3-4*b^3*d+18*a*b*c*d-27*a^2*d^2,0] && NeQ[c^2-3*b*d,0]] /;
FreeQ[p,x] && PolyQ[Px,x,3] && IntegerQ[p]


(* ::Code:: *)
Int[Px_^p_,x_Symbol] :=
  With[{a=Coeff[Px,x,0],b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  Px^p/((c^3-4*b*c*d+9*a*d^2+d*(c^2-3*b*d)*x)^p*(b*c-9*a*d+2*(c^2-3*b*d)*x)^(2*p)) \[Star] 
    Int[(c^3-4*b*c*d+9*a*d^2+d*(c^2-3*b*d)*x)^p*(b*c-9*a*d+2*(c^2-3*b*d)*x)^(2*p),x] /;
 EqQ[b^2*c^2-4*a*c^3-4*b^3*d+18*a*b*c*d-27*a^2*d^2,0] && NeQ[c^2-3*b*d,0]] /;
FreeQ[p,x] && PolyQ[Px,x,3] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[Px_^p_,x_Symbol] :=
  With[{a=Coeff[Px,x,0],b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3]},
  Subst[Int[Simp[(2*c^3-9*b*c*d+27*a*d^2)/(27*d^2)-(c^2-3*b*d)*x/(3*d)+d*x^3,x]^p,x],x,c/(3*d)+x]] /;
FreeQ[p,x] && PolyQ[Px,x,3]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_+b_.*x_+d_.*x_^3)^p_.,x_Symbol] :=
  1/(3^(3*p)*a^(2*p)) \[Star] Int[(e+f*x)^m*(3*a-b*x)^p*(3*a+2*b*x)^(2*p),x] /;
FreeQ[{a,b,d,e,f,m},x] && EqQ[4*b^3+27*a^2*d,0] && IntegerQ[p]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  (a+b*x+d*x^3)^p/((3*a-b*x)^p*(3*a+2*b*x)^(2*p)) \[Star] Int[(e+f*x)^m*(3*a-b*x)^p*(3*a+2*b*x)^(2*p),x] /;
FreeQ[{a,b,d,e,f,m,p},x] && EqQ[4*b^3+27*a^2*d,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_+b_.*x_+d_.*x_^3)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(e+f*x)^m*(a+b*x+d*x^3)^p,x],x] /;
FreeQ[{a,b,d,e,f,m},x] && NeQ[4*b^3+27*a^2*d,0] && IGtQ[p,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  With[{r=Rt[-9*a*d^2+Sqrt[3]*d*Sqrt[4*b^3*d+27*a^2*d^2],3]},
  1/d^(2*p) \[Star] Int[(e+f*x)^m*Simp[18^(1/3)*b*d/(3*r)-r/18^(1/3)+d*x,x]^p*
    Simp[b*d/3+12^(1/3)*b^2*d^2/(3*r^2)+r^2/(3*12^(1/3))-d*(2^(1/3)*b*d/(3^(1/3)*r)-r/18^(1/3))*x+d^2*x^2,x]^p,x]] /;
FreeQ[{a,b,d,e,f,m},x] && NeQ[4*b^3+27*a^2*d,0] && ILtQ[p,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_+b_.*x_+d_.*x_^3)^p_,x_Symbol] :=
  With[{r=Rt[-9*a*d^2+Sqrt[3]*d*Sqrt[4*b^3*d+27*a^2*d^2],3]},
  (a+b*x+d*x^3)^p/
    (Simp[18^(1/3)*b*d/(3*r)-r/18^(1/3)+d*x,x]^p*
      Simp[b*d/3+12^(1/3)*b^2*d^2/(3*r^2)+r^2/(3*12^(1/3))-d*(2^(1/3)*b*d/(3^(1/3)*r)-r/18^(1/3))*x+d^2*x^2,x]^p) \[Star] 
    Int[(e+f*x)^m*Simp[18^(1/3)*b*d/(3*r)-r/18^(1/3)+d*x,x]^p*
      Simp[b*d/3+12^(1/3)*b^2*d^2/(3*r^2)+r^2/(3*12^(1/3))-d*(2^(1/3)*b*d/(3^(1/3)*r)-r/18^(1/3))*x+d^2*x^2,x]^p,x]] /;
FreeQ[{a,b,d,e,f,m,p},x] && NeQ[4*b^3+27*a^2*d,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2+d_.*x_^3)^p_,x_Symbol] :=
  Subst[Int[((3*d*e-c*f)/(3*d)+f*x)^m*Simp[a-b^2/(3*c)+d*x^3,x]^p,x],x,x+c/(3*d)] /;
FreeQ[{a,b,c,d,e,f,m,p},x] && EqQ[c^2-3*b*d,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2+d_.*x_^3)^p_,x_Symbol] :=
  1/(4^p*(c^2-3*b*d)^(3*p)) \[Star] Int[(e+f*x)^m*(c^3-4*b*c*d+9*a*d^2+d*(c^2-3*b*d)*x)^p*(b*c-9*a*d+2*(c^2-3*b*d)*x)^(2*p),x] /;
FreeQ[{a,b,c,d,e,f,m,p},x] && NeQ[c^2-3*b*d,0] && EqQ[b^2*c^2-4*a*c^3-4*b^3*d+18*a*b*c*d-27*a^2*d^2,0] && ILtQ[p,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*(a_.+b_.*x_+c_.*x_^2+d_.*x_^3)^p_,x_Symbol] :=
  (a+b*x+c*x^2+d*x^3)^p/((c^3-4*b*c*d+9*a*d^2+d*(c^2-3*b*d)*x)^p*(b*c-9*a*d+2*(c^2-3*b*d)*x)^(2*p)) \[Star] 
    Int[(e+f*x)^m*(c^3-4*b*c*d+9*a*d^2+d*(c^2-3*b*d)*x)^p*(b*c-9*a*d+2*(c^2-3*b*d)*x)^(2*p),x] /;
FreeQ[{a,b,c,d,e,f,m,p},x] && NeQ[c^2-3*b*d,0] && EqQ[b^2*c^2-4*a*c^3-4*b^3*d+18*a*b*c*d-27*a^2*d^2,0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[(e_.+f_.*x_)^m_.*P3_^p_.,x_Symbol] :=
  With[{a=Coeff[P3,x,0],b=Coeff[P3,x,1],c=Coeff[P3,x,2],d=Coeff[P3,x,3]},
  Subst[Int[((3*d*e-c*f)/(3*d)+f*x)^m*Simp[(2*c^3-9*b*c*d+27*a*d^2)/(27*d^2)-(c^2-3*b*d)*x/(3*d)+d*x^3,x]^p,x],x,x+c/(3*d)] /;
 NeQ[c,0]] /;
FreeQ[{e,f,m,p},x] && PolyQ[P3,x,3]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Polynomial products/1.3.2 u (a+b x+c x^2+d x^3+e x^4)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{b=Coeff[Px,x,1],c=Coeff[Px,x,2],d=Coeff[Px,x,3],e=Coeff[Px,x,4]},
  Px^FracPart[p]/(x^FracPart[p]*(b+c*x+d*x^2+e*x^3)^FracPart[p]) \[Star] Int[u*x^p*(b+c*x+d*x^2+e*x^3)^p,x]] /;
FreeQ[p,x] && PolyQ[Px,x,4] && EqQ[Coeff[Px,x,0],0] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[Px_.*(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  e^p \[Star] Int[ExpandIntegrand[Px*(b/d+(d+Sqrt[e*(b^2-4*a*c)/a+8*a*d*e/b])/(2*e)*x+x^2)^p*(b/d+(d-Sqrt[e*(b^2-4*a*c)/a+8*a*d*e/b])/(2*e)*x+x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Px,x] && ILtQ[p,0] && EqQ[a*d^2-b^2*e,0]


(* ::Code:: *)
Int[Px_.*(a_+b_.*x_+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  e^p \[Star] Int[ExpandIntegrand[Px*(b/d+(d+Sqrt[d^2+8*a*d*e/b])/(2*e)*x+x^2)^p*(b/d+(d-Sqrt[d^2+8*a*d*e/b])/(2*e)*x+x^2)^p,x],x] /;
FreeQ[{a,b,d,e},x] && PolyQ[Px,x] && ILtQ[p,0] && EqQ[a*d^2-b^2*e,0]


(* ::Code:: *)
Int[Px_.*(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  With[{S=Root[a*d^2-b^2*e+(b*d^2-4*b*c*e+8*a*d*e)*x+(c*d^2-4*c^2*e+2*b*d*e+16*a*e^2)*x^2+(d^3-4*c*d*e+8*b*e^2)*x^3,3]},
  Subst[Int[ReplaceAll[Px,x->x+S]*ExpandToSum[a+b*(x+S)+c*(x+S)^2+d*(x+S)^3+e*(x+S)^4,x]^p,x],x,x-S] /;
 RationalQ[S]] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Px,x] && ILtQ[p,0] && RationalQ[a,b,c,d,e] && NeQ[a*d^2-b^2*e,0]


(* ::Code:: *)
Int[Px_.*(a_+b_.*x_+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  With[{S=Root[a*d^2-b^2*e+(b*d^2+8*a*d*e)*x+(2*b*d*e+16*a*e^2)*x^2+(d^3+8*b*e^2)*x^3,3]},
  Subst[Int[ReplaceAll[Px,x->x+S]*ExpandToSum[a+b*(x+S)+d*(x+S)^3+e*(x+S)^4,x]^p,x],x,x-S] /;
 RationalQ[S]] /;
FreeQ[{a,b,d,e},x] && PolyQ[Px,x] && ILtQ[p,0] && RationalQ[a,b,d,e] && NeQ[a*d^2-b^2*e,0]


(* ::Code:: *)
Int[x_^m_.*Px_.*(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  e^p \[Star] Int[ExpandIntegrand[x^m*Px*(b/d+(d+Sqrt[e*(b^2-4*a*c)/a+8*a*d*e/b])/(2*e)*x+x^2)^p*(b/d+(d-Sqrt[e*(b^2-4*a*c)/a+8*a*d*e/b])/(2*e)*x+x^2)^p,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && PolyQ[Px,x] && ILtQ[p,0] && EqQ[a*d^2-b^2*e,0]


(* ::Code:: *)
Int[x_^m_.*Px_.*(a_+b_.*x_+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  e^p \[Star] Int[ExpandIntegrand[x^m*Px*(b/d+(d+Sqrt[d^2+8*a*d*e/b])/(2*e)*x+x^2)^p*(b/d+(d-Sqrt[d^2+8*a*d*e/b])/(2*e)*x+x^2)^p,x],x] /;
FreeQ[{a,b,d,e,m},x] && PolyQ[Px,x] && ILtQ[p,0] && EqQ[a*d^2-b^2*e,0]


(* ::Code:: *)
Int[Px_.*(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  1/a^(3*p) \[Star] Int[ExpandIntegrand[Px*(a^5-b^5*x^5)^p/(a-b*x)^p,x],x] /;
FreeQ[{a,b,c,d,e},x] && PolyQ[Px,x] && ILtQ[p,0] && NeQ[a,0] && EqQ[c,b^2/a] && EqQ[d,b^3/a^2] && EqQ[e,b^4/a^3]


(* ::Code:: *)
Int[x_^m_.*Px_.*(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4)^p_,x_Symbol] :=
  1/a^(3*p) \[Star] Int[ExpandIntegrand[x^m*Px*(a^5-b^5*x^5)^p/(a-b*x)^p,x],x] /;
FreeQ[{a,b,c,d,e,m},x] && PolyQ[Px,x] && ILtQ[p,0] && NeQ[a,0] && EqQ[c,b^2/a] && EqQ[d,b^3/a^2] && EqQ[e,b^4/a^3]


(* ::Code:: *)
Int[(A_.+B_.*x_+C_.*x_^2)/(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4),x_Symbol] :=
  With[{q=Rt[C*(2*e*(B*d-4*A*e)+C*(d^2-4*c*e)),2]},
  -2*C^2/q*ArcTanh[(C*d-B*e+2*C*e*x)/q] + 
  2*C^2/q*ArcTanh[C*(4*B*c*C-3*B^2*d-4*A*C*d+12*A*B*e+4*C*(2*c*C-B*d+2*A*e)*x+4*C*(2*C*d-B*e)*x^2+8*C^2*e*x^3)/(q*(B^2-4*A*C))]] /;
FreeQ[{a,b,c,d,e,A,B,C},x] && EqQ[B^2*d+2*C*(b*C+A*d)-2*B*(c*C+2*A*e),0] && 
  EqQ[2*B^2*c*C-8*a*C^3-B^3*d-4*A*B*C*d+4*A*(B^2+2*A*C)*e,0] && PosQ[C*(2*e*(B*d-4*A*e)+C*(d^2-4*c*e))]


(* ::Code:: *)
Int[(A_.+C_.*x_^2)/(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4),x_Symbol] :=
  With[{q=Rt[C*(-8*A*e^2+C*(d^2-4*c*e)),2]},
  -2*C^2/q*ArcTanh[C*(d+2*e*x)/q] + 2*C^2/q*ArcTanh[C*(A*d-2*(c*C+A*e)*x-2*C*d*x^2-2*C*e*x^3)/(A*q)]] /;
FreeQ[{a,b,c,d,e,A,C},x] && EqQ[b*C+A*d,0] && EqQ[a*C^2-A^2*e,0] && PosQ[C*(-8*A*e^2+C*(d^2-4*c*e))]


(* ::Code:: *)
Int[(A_.+B_.*x_+C_.*x_^2)/(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4),x_Symbol] :=
  With[{q=Rt[-C*(2*e*(B*d-4*A*e)+C*(d^2-4*c*e)),2]},
  2*C^2/q*ArcTan[(C*d-B*e+2*C*e*x)/q] - 
  2*C^2/q*ArcTan[C*(4*B*c*C-3*B^2*d-4*A*C*d+12*A*B*e+4*C*(2*c*C-B*d+2*A*e)*x+4*C*(2*C*d-B*e)*x^2+8*C^2*e*x^3)/(q*(B^2-4*A*C))]] /;
FreeQ[{a,b,c,d,e,A,B,C},x] && EqQ[B^2*d+2*C*(b*C+A*d)-2*B*(c*C+2*A*e),0] && 
  EqQ[2*B^2*c*C-8*a*C^3-B^3*d-4*A*B*C*d+4*A*(B^2+2*A*C)*e,0] && NegQ[C*(2*e*(B*d-4*A*e)+C*(d^2-4*c*e))]


(* ::Code:: *)
Int[(A_.+C_.*x_^2)/(a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4),x_Symbol] :=
  With[{q=Rt[-C*(-8*A*e^2+C*(d^2-4*c*e)),2]},
  2*C^2/q*ArcTan[(C*d+2*C*e*x)/q] - 2*C^2/q*ArcTan[-C*(-A*d+2*(c*C+A*e)*x+2*C*d*x^2+2*C*e*x^3)/(A*q)]] /;
FreeQ[{a,b,c,d,e,A,C},x] && EqQ[b*C+A*d,0] && EqQ[a*C^2-A^2*e,0] && NegQ[C*(-8*A*e^2+C*(d^2-4*c*e))]


(* ::Code:: *)
Int[P4_^p_,x_Symbol] :=
  With[{a=Coeff[P4,x,0],b=Coeff[P4,x,1],c=Coeff[P4,x,2],d=Coeff[P4,x,3],e=Coeff[P4,x,4]},
  -16*a^2 \[Star] Subst[
    Int[1/(b-4*a*x)^2*(a*(-3*b^4+16*a*b^2*c-64*a^2*b*d+256*a^3*e-32*a^2*(3*b^2-8*a*c)*x^2+256*a^4*x^4)/(b-4*a*x)^4)^p,x],
    x,b/(4*a)+1/x] /;
 NeQ[a,0] && NeQ[b,0] && EqQ[b^3-4*a*b*c+8*a^2*d,0]] /;
FreeQ[p,x] && PolyQ[P4,x,4] && IntegerQ[2*p] && Not[IGtQ[p,0]]


(* ::Code:: *)
Int[x_/Sqrt[a_+b_.*x_+c_.*x_^2+e_.*x_^4],x_Symbol] :=
  With[{Px=1/320*(33*b^2*c+6*a*c^2+40*a^2*e)-22/5*a*c*e*x^2+22/15*b*c*e*x^3+1/4*e*(5*c^2+4*a*e)*x^4+
    4/3*b*e^2*x^5+2*c*e^2*x^6+e^3*x^8},
  1/(8*Rt[e,2])*Log[Px + (1/(8*Rt[e,2]*x) \[Star] D[Px,x])*Sqrt[a+b*x+c*x^2+e*x^4]]] /;
FreeQ[{a,b,c,e},x] && EqQ[71*c^2+100*a*e,0] && EqQ[1152*c^3-125*b^2*e,0]


(* ::Code:: *)
Int[(A_+B_.*x_)/Sqrt[a_+b_.*x_+c_.*x_^2+d_.*x_^3+e_.*x_^4],x_Symbol] :=
  B \[Star] Subst[Int[x/Sqrt[(-3*d^4+16*c*d^2*e-64*b*d*e^2+256*a*e^3)/(256*e^3)+(d^3-4*c*d*e+8*b*e^2)*x/(8*e^2)-
    (3*d^2-8*c*e)*x^2/(8*e)+e*x^4],x],x,d/(4*e)+x] /;
FreeQ[{a,b,c,d,e,A,B},x] && EqQ[B*d-4*A*e,0] && 
  EqQ[d*(141*d^3-752*c*d*e-400*b*e^2)+16*e^2*(71*c^2+100*a*e),0] && 
  EqQ[144*(3*d^2-8*c*e)^3+125*(d^3-4*c*d*e+8*b*e^2)^2,0]


(* ::Code:: *)
Int[(f_+g_.*x_^2)/((d_+e_.*x_+d_.*x_^2)*Sqrt[a_+b_.*x_+c_.*x_^2+b_.*x_^3+a_.*x_^4]),x_Symbol] :=
  a*f/(d*Rt[a^2*(2*a-c),2])*ArcTan[(a*b+(4*a^2+b^2-2*a*c)*x+a*b*x^2)/(2*Rt[a^2*(2*a-c),2]*Sqrt[a+b*x+c*x^2+b*x^3+a*x^4])] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[b*d-a*e,0] && EqQ[f+g,0] && PosQ[a^2*(2*a-c)]


(* ::Code:: *)
Int[(f_+g_.*x_^2)/((d_+e_.*x_+d_.*x_^2)*Sqrt[a_+b_.*x_+c_.*x_^2+b_.*x_^3+a_.*x_^4]),x_Symbol] :=
  -a*f/(d*Rt[-a^2*(2*a-c),2])*ArcTanh[(a*b+(4*a^2+b^2-2*a*c)*x+a*b*x^2)/(2*Rt[-a^2*(2*a-c),2]*Sqrt[a+b*x+c*x^2+b*x^3+a*x^4])] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[b*d-a*e,0] && EqQ[f+g,0] && NegQ[a^2*(2*a-c)]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Polynomial products/1.3.3 P(x)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(c_.*x_)^m_.*Pq_*u_^p_.,x_Symbol] :=
  Int[(c*x)^m*Pq*ExpandToSum[u,x]^p,x] /;
FreeQ[{c,m,p},x] && PolyQ[Pq,x] && BinomialQ[u,x] && Not[BinomialMatchQ[u,x]]


(* ::Code:: *)
Int[Pq_*u_^p_.,x_Symbol] :=
  Int[Pq*ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && PolyQ[Pq,x] && QuadraticQ[u,x] && Not[QuadraticMatchQ[u,x]]


(* ::Code:: *)
Int[u_^m_.*Pq_*v_^p_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*Pq*ExpandToSum[v,x]^p,x] /;
FreeQ[{m,p},x] && PolyQ[Pq,x] && LinearQ[u,x] && QuadraticQ[v,x] && Not[LinearMatchQ[u,x] && QuadraticMatchQ[v,x]]


(* ::Code:: *)
Int[Pq_*u_^p_.,x_Symbol] :=
  Int[Pq*ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && PolyQ[Pq,x] && TrinomialQ[u,x] && Not[TrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(d_.*x_)^m_.*Pq_*u_^p_.,x_Symbol] :=
  Int[(d*x)^m*Pq*ExpandToSum[u,x]^p,x] /;
FreeQ[{d,m,p},x] && PolyQ[Pq,x] && TrinomialQ[u,x] && Not[TrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[u_.*Px_^p_*Qx_^q_,x_Symbol] :=
  Module[{Rx=PolyGCD[Px,Qx,x]},
  Int[u*Rx^(p+q)*PolynomialQuotient[Px,Rx,x]^p*PolynomialQuotient[Qx,Rx,x]^q,x] /;
 NeQ[Rx,1]] /;
IGtQ[p,0] && ILtQ[q,0] && PolyQ[Px,x] && PolyQ[Qx,x]


(* ::Code:: *)
Int[u_.*Px_*Qx_^q_,x_Symbol] :=
  Module[{Rx=PolyGCD[Px,Qx,x]},
  Int[u*Rx^(q+1)*PolynomialQuotient[Px,Rx,x]*PolynomialQuotient[Qx,Rx,x]^q,x] /;
 NeQ[Rx,1]] /;
ILtQ[q,0] && PolyQ[Px,x] && PolyQ[Qx,x]


(* ::Code:: *)
Int[Pn_^p_.,x_Symbol] :=
  With[{S=Coeff[Pn,x,Expon[Pn,x]-1]/(Expon[Pn,x]*Coeff[Pn,x,Expon[Pn,x]])},
  Subst[Int[ExpandToSum[ReplaceAll[Pn,x->x-S],x]^p,x],x,x+S] /;
 BinomialQ[ReplaceAll[Pn,x->x-S],x] || IntegerQ[Expon[Pn,x]/2] && TrinomialQ[ReplaceAll[Pn,x->x-S],x]] /;
FreeQ[p,x] && PolyQ[Pn,x] && GtQ[Expon[Pn,x],2] && NeQ[Coeff[Pn,x,Expon[Pn,x]-1],0]


(* ::Code:: *)
(* Int[(a_+b_.*x_)^m_.*Pn_^p_.,x_Symbol] :=
  With[{S=Coeff[Pn,x,Expon[Pn,x]-1]/(Expon[Pn,x]*Coeff[Pn,x,Expon[Pn,x]])},
  Subst[Int[Simp[a-b*S+b*x,x]^m*ExpandToSum[ReplaceAll[Pn,x->x-S],x]^p,x],x,x+S] /;
 BinomialQ[ReplaceAll[Pn,x->x-S],x] || IntegerQ[Expon[Pn,x]/2] && TrinomialQ[ReplaceAll[Pn,x->x-S],x]] /;
FreeQ[{a,b,m,p},x] && PolyQ[Pn,x] && GtQ[Expon[Pn,x],2] && NeQ[Coeff[Pn,x,Expon[Pn,x]-1],0] *)


(* ::Code:: *)
(* Int[(a_+b_.*x_+c_.*x_^2)^m_.*Pn_^p_.,x_Symbol] :=
  With[{S=Coeff[Pn,x,Expon[Pn,x]-1]/(Expon[Pn,x]*Coeff[Pn,x,Expon[Pn,x]])},
  Subst[Int[Simp[a-b*S+c*S^2+(b-2*c*S)*x+c*x^2,x]^m*ExpandToSum[ReplaceAll[Pn,x->x-S],x]^p,x],x,x+S] /;
 BinomialQ[ReplaceAll[Pn,x->x-S],x] || IntegerQ[Expon[Pn,x]/2] && TrinomialQ[ReplaceAll[Pn,x->x-S],x]] /;
FreeQ[{a,b,c,m,p},x] && PolyQ[Pn,x] && GtQ[Expon[Pn,x],2] && NeQ[Coeff[Pn,x,Expon[Pn,x]-1],0] *)


(* ::Code:: *)
Int[Pn_^p_.*Qx_,x_Symbol] :=
  With[{S=Coeff[Pn,x,Expon[Pn,x]-1]/(Expon[Pn,x]*Coeff[Pn,x,Expon[Pn,x]])},
  Subst[Int[ExpandToSum[ReplaceAll[Pn,x->x-S],x]^p*ExpandToSum[ReplaceAll[Qx,x->x-S],x],x],x,x+S] /;
 BinomialQ[ReplaceAll[Pn,x->x-S],x] || IntegerQ[Expon[Pn,x]/2] && TrinomialQ[ReplaceAll[Pn,x->x-S],x]] /;
FreeQ[p,x] && PolyQ[Pn,x] && GtQ[Expon[Pn,x],2] && NeQ[Coeff[Pn,x,Expon[Pn,x]-1],0] && PolyQ[Qx,x] && Not[MonomialQ[Qx,x] && IGtQ[p,0]]


(* ::Code:: *)
(* Int[u_*Pn_^p_.,x_Symbol] :=
  With[{S=Coeff[Pn,x,Expon[Pn,x]-1]/(Expon[Pn,x]*Coeff[Pn,x,Expon[Pn,x]])},
  Subst[Int[ReplaceAll[u,x->x-S]*ExpandToSum[ReplaceAll[Pn,x->x-S],x]^p,x],x,x+S] /;
 BinomialQ[ReplaceAll[Pn,x->x-S],x] || IntegerQ[Expon[Pn,x]/2] && TrinomialQ[ReplaceAll[Pn,x->x-S],x]] /;
FreeQ[p,x] && PolyQ[Pn,x] && GtQ[Expon[Pn,x],2] && NeQ[Coeff[Pn,x,Expon[Pn,x]-1],0] && Not[MonomialQ[u,x] && IGtQ[p,0]] *)


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{Qx=Factor[ReplaceAll[Px,x->Sqrt[x]]]},
  Int[ExpandIntegrand[u*ReplaceAll[Qx,x->x^2]^p,x],x] /;
 Not[SumQ[NonfreeFactors[Qx,x]]]] /;
PolyQ[Px,x^2] && GtQ[Expon[Px,x],2] && Not[BinomialQ[Px,x]] && Not[TrinomialQ[Px,x]] && ILtQ[p,0] && RationalFunctionQ[u,x]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{Qx=Factor[ReplaceAll[Px,x->Sqrt[x]]]},
  Int[ExpandIntegrand[u,ReplaceAll[Qx,x->x^2]^p,x],x] /;
 Not[SumQ[NonfreeFactors[Qx,x]]]] /;
PolyQ[Px,x^2] && GtQ[Expon[Px,x],2] && Not[BinomialQ[Px,x]] && Not[TrinomialQ[Px,x]] && ILtQ[p,0]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{Qx=Factor[Px]},
  Int[ExpandIntegrand[u*Qx^p,x],x] /;
 Not[SumQ[NonfreeFactors[Qx,x]]]] /;
PolyQ[Px,x] && GtQ[Expon[Px,x],2] && Not[BinomialQ[Px,x]] && Not[TrinomialQ[Px,x]] && ILtQ[p,0] && RationalFunctionQ[u,x]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{Qx=Factor[Px]},
  Int[ExpandIntegrand[u,Qx^p,x],x] /;
 Not[SumQ[NonfreeFactors[Qx,x]]]] /;
PolyQ[Px,x] && GtQ[Expon[Px,x],2] && Not[BinomialQ[Px,x]] && Not[TrinomialQ[Px,x]] && ILtQ[p,0]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{Qx=Factor[Px]},
  Int[u*Qx^p,x] /;
 Not[SumQ[NonfreeFactors[Qx,x]]]] /;
PolyQ[Px,x] && GtQ[Expon[Px,x],2] && Not[BinomialQ[Px,x]] && Not[TrinomialQ[Px,x]] && IGtQ[p,1]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  Int[ExpandToSum[u,Px^p,x],x] /;
PolyQ[Px,x] && GtQ[Expon[Px,x],2] && Not[BinomialQ[Px,x]] && Not[TrinomialQ[Px,x]] && IGtQ[p,0]


(* ::Code:: *)
Int[u_.*Q6_^p_,x_Symbol] :=
  With[{a=Coeff[Q6,x,0],b=Coeff[Q6,x,2],c=Coeff[Q6,x,3],d=Coeff[Q6,x,4],e=Coeff[Q6,x,6]},
  1/(3^(3*p)*a^(2*p)) \[Star] Int[ExpandIntegrand[u*
    (3*a+3*Rt[a,3]^2*Rt[c,3]*x+b*x^2)^p*
    (3*a-3*(-1)^(1/3)*Rt[a,3]^2*Rt[c,3]*x+b*x^2)^p*
    (3*a+3*(-1)^(2/3)*Rt[a,3]^2*Rt[c,3]*x+b*x^2)^p,x],x] /;
 EqQ[b^2-3*a*d,0] && EqQ[b^3-27*a^2*e,0]] /;
ILtQ[p,0] && PolyQ[Q6,x,6] && EqQ[Coeff[Q6,x,1],0] && EqQ[Coeff[Q6,x,5],0] && RationalFunctionQ[u,x]


(* ::Code:: *)
Int[Px_^p_*Fx_.,x_Symbol] :=
  With[{r=Expon[Px,x,Min]},
  Px^FracPart[p]/(x^(r*FracPart[p])*ExpandToSum[Px/x^r,x]^FracPart[p]) \[Star] Int[x^(p*r)*ExpandToSum[Px/x^r,x]^p*Fx,x] /;
 IGtQ[r,0]] /;
FreeQ[p,x] && PolyQ[Px,x] && Not[IntegerQ[p]] && Not[MonomialQ[Px,x]] && Not[PolyQ[Fx,x]]


(* ::Code:: *)
Int[(a_.*x_^r_.+b_.*x_^s_.)^p_*Fx_.,x_Symbol] :=
  (a*x^r+b*x^s)^p/(x^(p*r)*(a+b*x^(s-r))^p) \[Star] Int[x^(p*r)*(a+b*x^(s-r))^p*Fx,x] /;
FreeQ[{a,b,p,r,s},x] && Not[IntegerQ[p]] && PosQ[s-r] && Not[EqQ[p,1] && EqQ[Fx,1]]


(* ::Code:: *)
Int[(a_.*x_^r_.+b_.*x_^s_.+c_.*x_^t_.)^p_*Fx_.,x_Symbol] :=
  (a*x^r+b*x^s+c*x^t)^p/(x^(p*r)*(a+b*x^(s-r)+c*x^(t-r))^p) \[Star] Int[x^(p*r)*(a+b*x^(s-r)+c*x^(t-r))^p*Fx,x] /;
FreeQ[{a,b,c,p,r,s,t},x] && Not[IntegerQ[p]] && PosQ[s-r] && PosQ[t-r] && Not[EqQ[p,1] && EqQ[Fx,1]]


(* ::Code:: *)
Int[(a_.*x_^r_.+b_.*x_^s_.+c_.*x_^t_.+d_.*x_^q_.)^p_*Fx_.,x_Symbol] :=
  (a*x^r+b*x^s+c*x^t+d*x^q)^p/(x^(p*r)*(a+b*x^(s-r)+c*x^(t-r)+d*x^(q-r))^p) \[Star] Int[x^(p*r)*(a+b*x^(s-r)+c*x^(t-r)+d*x^(q-r))^p*Fx,x] /;
FreeQ[{a,b,c,d,p,r,s,t,q},x] && Not[IntegerQ[p]] && PosQ[s-r] && PosQ[t-r] && PosQ[q-r] && Not[EqQ[p,1] && EqQ[Fx,1]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.3 Polynomial products/1.3.4 P(x) Q(x)^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*Pn_^p_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-g)/h]},
  1/h \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p,x],x,g+h*x] /;
 BinomialQ[Px,x]] /;
FreeQ[{g,h,m,p},x] && PolyQ[Pn,x]


(* ::Code:: *)
Int[u_^m_.*Pn_^p_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]]},
  1/Coeff[u,x,1] \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p,x],x,u] /;
 BinomialQ[Px,x]] /;
FreeQ[{m,p},x] && LinearQ[u,x] && PolyQ[Pn,x] && NeQ[Coeff[u,x,0],0]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*Pn_^p_.*Qn_^q_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-g)/h], Qx=ReplaceAll[Qn,x->(x-g)/h]},
  1/h \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p*ExpandToSum[Qx,x]^q,x],x,g+h*x] /;
 BinomialQ[Px,x] && BinomialQ[Qx,x]] /;
FreeQ[{g,h,m,p,q},x] && PolyQ[Pn,x] && PolyQ[Qn,x] && EqQ[Expon[Pn,x],Expon[Qn,x]]


(* ::Code:: *)
Int[u_^m_.*Pn_^p_.*Qn_^q_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]], Qx=ReplaceAll[Qn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]]},
  1/Coeff[u,x,1] \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p*ExpandToSum[Qx,x]^q,x],x,u] /;
 BinomialQ[Px,x] && BinomialQ[Qx,x]] /;
FreeQ[{m,p,q},x] && LinearQ[u,x] && PolyQ[Pn,x] && PolyQ[Qn,x] && EqQ[Expon[Pn,x],Expon[Qn,x]] && NeQ[Coeff[u,x,0],0]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*Pn_^p_.*Qn_^q_.*Rn_^r_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-g)/h], Qx=ReplaceAll[Qn,x->(x-g)/h], Rx=ReplaceAll[Rn,x->(x-g)/h]},
  1/h \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p*ExpandToSum[Qx,x]^q*ExpandToSum[Rx,x]^r,x],x,g+h*x] /;
 BinomialQ[Px,x] && BinomialQ[Qx,x] && BinomialQ[Rx,x]] /;
FreeQ[{g,h,m,p,q,r},x] && PolyQ[Pn,x] && PolyQ[Qn,x] && PolyQ[Rn,x] && 
  EqQ[Expon[Pn,x],Expon[Qn,x]] && EqQ[Expon[Pn,x],Expon[Rn,x]]


(* ::Code:: *)
Int[u_^m_.*Pn_^p_.*Qn_^q_.*Rn_^r_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]], Qx=ReplaceAll[Qn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]], 
    Rx=ReplaceAll[Rn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]]},
  1/Coeff[u,x,1] \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p*ExpandToSum[Qx,x]^q*ExpandToSum[Rx,x]^r,x],x,u] /;
 BinomialQ[Px,x] && BinomialQ[Qx,x] && BinomialQ[Rx,x]] /;
FreeQ[{m,p,q,r},x] && LinearQ[u,x] && PolyQ[Pn,x] && PolyQ[Qn,x] && PolyQ[Rn,x] && 
  EqQ[Expon[Pn,x],Expon[Qn,x]] && EqQ[Expon[Pn,x],Expon[Rn,x]] && NeQ[Coeff[u,x,0],0]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*Pn_^p_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-g)/h]},
  1/h \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p,x],x,g+h*x] /;
 BinomialQ[Px,x]] /;
FreeQ[{g,h,m,p},x] && PolyQ[Pn,x]


(* ::Code:: *)
Int[u_^m_.*Pn_^p_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]]},
  1/Coeff[u,x,1] \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p,x],x,u] /;
 BinomialQ[Px,x]] /;
FreeQ[{m,p},x] && LinearQ[u,x] && PolyQ[Pn,x] && NeQ[Coeff[u,x,0],0]


(* ::Code:: *)
Int[(g_+h_.*x_)^m_.*Pn_^p_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-g)/h]},
  1/h \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p,x],x,g+h*x] /;
 TrinomialQ[Px,x]] /;
FreeQ[{g,h,m,p},x] && PolyQ[Pn,x]


(* ::Code:: *)
Int[u_^m_.*Pn_^p_.,x_Symbol] :=
  With[{Px=ReplaceAll[Pn,x->(x-Coeff[u,x,0])/Coeff[u,x,1]]},
  1/Coeff[u,x,1] \[Star] Subst[Int[x^m*ExpandToSum[Px,x]^p,x],x,u] /;
 TrinomialQ[Px,x]] /;
FreeQ[{m,p},x] && LinearQ[u,x] && PolyQ[Pn,x] && NeQ[Coeff[u,x,0],0]


(* ::Code:: *)
Int[Sqrt[v_]/(d_+e_.*x_^4),x_Symbol] :=
  With[{a=Coeff[v,x,0],b=Coeff[v,x,2],c=Coeff[v,x,4]},
  a/d \[Star] Subst[Int[1/(1-2*b*x^2+(b^2-4*a*c)*x^4),x],x,x/Sqrt[v]] /;
 EqQ[c*d+a*e,0] && PosQ[a*c]] /;
FreeQ[{d,e},x] && PolyQ[v,x^2,2]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^2+c_.*x_^4]/(d_+e_.*x_^4),x_Symbol] :=
  With[{q=Sqrt[b^2-4*a*c]},
  -a*Sqrt[b+q]/(2*Sqrt[2]*Rt[-a*c,2]*d)*ArcTan[Sqrt[b+q]*x*(b-q+2*c*x^2)/(2*Sqrt[2]*Rt[-a*c,2]*Sqrt[a+b*x^2+c*x^4])] + 
  a*Sqrt[-b+q]/(2*Sqrt[2]*Rt[-a*c,2]*d)*ArcTanh[Sqrt[-b+q]*x*(b+q+2*c*x^2)/(2*Sqrt[2]*Rt[-a*c,2]*Sqrt[a+b*x^2+c*x^4])]] /;
FreeQ[{a,b,c,d,e},x] && EqQ[c*d+a*e,0] && NegQ[a*c]


(* ::Code:: *)
Int[(A_+B_.*x_^n_)/(a_+b_.*x_^2+c_.*x_^n_+d_.*x_^n2_), x_Symbol] :=
  A^2*(n-1) \[Star] Subst[Int[1/(a+A^2*b*(n-1)^2*x^2),x],x,x/(A*(n-1)-B*x^n)] /;
FreeQ[{a,b,c,d,A,B,n},x] && EqQ[n2,2*n] && NeQ[n,2] && EqQ[a*B^2-A^2*d*(n-1)^2,0] && EqQ[B*c+2*A*d*(n-1),0]


(* ::Code:: *)
Int[x_^m_.*(A_+B_.*x_^n_.)/(a_+b_.*x_^k_.+c_.*x_^n_.+d_.*x_^n2_), x_Symbol] :=
  A^2*(m-n+1)/(m+1) \[Star] Subst[Int[1/(a+A^2*b*(m-n+1)^2*x^2),x],x,x^(m+1)/(A*(m-n+1)+B*(m+1)*x^n)] /;
FreeQ[{a,b,c,d,A,B,m,n},x] && EqQ[n2,2*n] && EqQ[k,2*(m+1)] && EqQ[a*B^2*(m+1)^2-A^2*d*(m-n+1)^2,0] && EqQ[B*c*(m+1)-2*A*d*(m-n+1),0]


(* ::Code:: *)
Int[(a_+b_.*x_^2+c_.*x_^4)/(d_+e_.*x_^2+f_.*x_^4+g_.*x_^6),x_Symbol] :=
  With[{q=Rt[(-a*c*f^2+12*a^2*g^2+f*(3*c^2*d-2*a*b*g))/(c*g*(3*c*d-a*f)),2],
        r=Rt[(a*c*f^2+4*g*(b*c*d+a^2*g)-f*(3*c^2*d+2*a*b*g))/(c*g*(3*c*d-a*f)),2]},
  c/(g*q)*ArcTan[(r+2*x)/q] - 
  c/(g*q)*ArcTan[(r-2*x)/q] - 
  c/(g*q)*ArcTan[(3*c*d-a*f)*x/(g*q*(b*c*d-2*a^2*g)*(b*c*d-a*b*f+4*a^2*g))*
    (b*c^2*d*f-a*b^2*f*g-2*a^2*c*f*g+6*a^2*b*g^2+c*(3*c^2*d*f-a*c*f^2-b*c*d*g+2*a^2*g^2)*x^2+c^2*g*(3*c*d-a*f)*x^4)]] /;
FreeQ[{a,b,c,d,e,f,g},x] && EqQ[9*c^3*d^2-c*(b^2+6*a*c)*d*f+a^2*c*f^2+2*a*b*(3*c*d+a*f)*g-12*a^3*g^2,0] && 
  EqQ[3*c^4*d^2*e-3*a^2*c^2*d*f*g+a^3*c*f^2*g+2*a^3*g^2*(b*f-6*a*g)-c^3*d*(2*b*d*f+a*e*f-12*a*d*g),0] && 
  NeQ[3*c*d-a*f,0] && NeQ[b*c*d-2*a^2*g,0] && NeQ[b*c*d-a*b*f+4*a^2*g,0] && 
  PosQ[(-a*c*f^2+12*a^2*g^2+f*(3*c^2*d-2*a*b*g))/(c*g*(3*c*d-a*f))]


(* ::Code:: *)
Int[(a_+c_.*x_^4)/(d_+e_.*x_^2+f_.*x_^4+g_.*x_^6),x_Symbol] :=
  With[{q=Rt[(-a*c*f^2+12*a^2*g^2+3*f*c^2*d)/(c*g*(3*c*d-a*f)),2],
        r=Rt[(a*c*f^2+4*a^2*g^2-3*c^2*d*f)/(c*g*(3*c*d-a*f)),2]},
  c/(g*q)*ArcTan[(r+2*x)/q] - 
  c/(g*q)*ArcTan[(r-2*x)/q] - 
  c/(g*q)*ArcTan[(c*(3*c*d-a*f)*x*(2*a^2*f*g-(3*c^2*d*f-a*c*f^2+2*a^2*g^2)*x^2-c*(3*c*d-a*f)*g*x^4))/(8*a^4*g^3*q)]] /;
FreeQ[{a,c,d,e,f,g},x] && EqQ[9*c^3*d^2-6*a*c^2*d*f+a^2*c*f^2-12*a^3*g^2,0] && 
  EqQ[3*c^4*d^2*e-3*a^2*c^2*d*f*g+a^3*c*f^2*g-12*a^4*g^3-a*c^3*d*(e*f-12*d*g),0] && 
  NeQ[3*c*d-a*f,0] && PosQ[(-a*c*f^2+12*a^2*g^2+3*c^2*d*f)/(c*g*(3*c*d-a*f))]


(* ::Code:: *)
Int[Pm_/Qn_,x_Symbol] :=
  With[{m=Expon[Pm,x],n=Expon[Qn,x]},
  Coeff[Pm,x,m]*Log[Qn]/(n*Coeff[Qn,x,n]) + Simplify[Pm-Coeff[Pm,x,m]*D[Qn,x]/(n*Coeff[Qn,x,n])] \[Star] Int[1/Qn,x]/;
 EqQ[m,n-1] && EqQ[D[Simplify[Pm-Coeff[Pm,x,m]/(n*Coeff[Qn,x,n])*D[Qn,x]],x],0]] /;
PolyQ[Pm,x] && PolyQ[Qn,x]


(* ::Code:: *)
Int[Pm_*Qn_^p_,x_Symbol] :=
  With[{m=Expon[Pm,x],n=Expon[Qn,x]},
  Coeff[Pm,x,m]*Qn^(p+1)/(n*(p+1)*Coeff[Qn,x,n]) + Simplify[Pm-Coeff[Pm,x,m]*D[Qn,x]/(n*Coeff[Qn,x,n])] \[Star] Int[Qn^p,x]/;
 EqQ[m,n-1] && EqQ[D[Simplify[Pm-Coeff[Pm,x,m]/(n*Coeff[Qn,x,n])*D[Qn,x]],x],0]] /;
FreeQ[p,x] && PolyQ[Pm,x] && PolyQ[Qn,x] && NeQ[p,-1]


(* ::Code:: *)
Int[Pm_/Qn_,x_Symbol] :=
  With[{m=Expon[Pm,x],n=Expon[Qn,x]},
  Coeff[Pm,x,m]*Log[Qn]/(n*Coeff[Qn,x,n]) + 
  1/(n*Coeff[Qn,x,n]) \[Star] Int[ExpandToSum[n*Coeff[Qn,x,n]*Pm-Coeff[Pm,x,m]*D[Qn,x],x]/Qn,x]/;
 EqQ[m,n-1]] /;
PolyQ[Pm,x] && PolyQ[Qn,x]


(* ::Code:: *)
Int[Pm_*Qn_^p_,x_Symbol] :=
  With[{m=Expon[Pm,x],n=Expon[Qn,x]},
  Coeff[Pm,x,m]*Qn^(p+1)/(n*(p+1)*Coeff[Qn,x,n]) + 
  1/(n*Coeff[Qn,x,n]) \[Star] Int[ExpandToSum[n*Coeff[Qn,x,n]*Pm-Coeff[Pm,x,m]*D[Qn,x],x]*Qn^p,x]/;
 EqQ[m,n-1]] /;
FreeQ[p,x] && PolyQ[Pm,x] && PolyQ[Qn,x] && NeQ[p,-1]


(* ::Code:: *)
Int[Pm_*Qn_^p_.,x_Symbol] :=
  With[{m=Expon[Pm,x],n=Expon[Qn,x]},
  Coeff[Pm,x,m]*x^(m-n+1)*Qn^(p+1)/((m+n*p+1)*Coeff[Qn,x,n]) + 
  1/((m+n*p+1)*Coeff[Qn,x,n]) \[Star] 
    Int[ExpandToSum[(m+n*p+1)*Coeff[Qn,x,n]*Pm-Coeff[Pm,x,m]*x^(m-n)*((m-n+1)*Qn+(p+1)*x*D[Qn,x]),x]*Qn^p,x] /;
 LtQ[1,n,m+1] && m+n*p+1<0] /;
FreeQ[p,x] && PolyQ[Pm,x] && PolyQ[Qn,x] && LtQ[p,-1]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.4 Miscellaneous/1.4.1 Algebraic function simplification.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_*(c_+d_.*x_)^n_.*(a_+b_.*x_^2)^p_.,x_Symbol] :=
  Int[u*(c+d*x)^(n+p)*(a/c+b/d*x)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b*c^2+a*d^2,0] && (IntegerQ[p] || GtQ[a,0] && GtQ[c,0] && Not[IntegerQ[n]])


(* ::Code:: *)
Int[u_*(d_+e_.*x_)^q_.*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[u*(d+e*x)^(p+q)*(a/d+c/e*x)^p,x] /;
FreeQ[{a,b,c,d,e,q},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && IntegerQ[p]


(* ::Code:: *)
(* Int[u_*(d_+e_.*x_)^q_.*(a_+b_.*x_+c_.*x_^2)^p_,x_Symbol] :=
  Int[u*(a+b*x+c*x^2)^(p+q)/(a/d+c*x/e)^q,x] /;
FreeQ[{a,b,c,d,e,p},x] && EqQ[c*d^2-b*d*e+a*e^2,0] && IntegerQ[q] && FractionQ[p] && LtQ[0,(p+q)^2,p^2] *)


(* ::Code:: *)
(* Int[u_*(d_+e_.*x_)^q_.*(a_+c_.*x_^2)^p_,x_Symbol] :=
(*Int[u*(a+c*x^2)^(p+q)/(a/d+c*x/e)^q,x] /; *)
  d^(2*q)/a^q \[Star] Int[u*(a+c*x^2)^(p+q)/(d-e*x)^q,x] /;
FreeQ[{a,c,d,e,p},x] && EqQ[c*d^2+a*e^2,0] && IntegerQ[q] && FractionQ[p] && LtQ[0,(p+q)^2,p^2] *)


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*x_^n_)^p_.*Fx_,x_Symbol] :=
  Int[x^(m+n*p)*(b+a*x^(-n))^p*Fx,x] /;
FreeQ[{a,b,m,n},x] && IntegerQ[p] && NegQ[n]


(* ::Code:: *)
Int[u_.*Px_,x_Symbol] :=
  With[{a=Rt[Coeff[Px,x,0],Expon[Px,x]],b=Rt[Coeff[Px,x,Expon[Px,x]],Expon[Px,x]]},
  Int[u*(a+b*x)^Expon[Px,x],x] /;
 EqQ[Px,(a+b*x)^Expon[Px,x]]] /;
PolyQ[Px,x] && GtQ[Expon[Px,x],1] && NeQ[Coeff[Px,x,0],0] && Not[MatchQ[Px,a_.*v_^Expon[Px,x] /; FreeQ[a,x] && LinearQ[v,x]]] 


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{a=Rt[Coeff[Px,x,0],Expon[Px,x]],b=Rt[Coeff[Px,x,Expon[Px,x]],Expon[Px,x]]},
  Int[u*(a+b*x)^(Expon[Px,x]*p),x] /;
 EqQ[Px,(a+b*x)^Expon[Px,x]]] /;
IntegerQ[p] && PolyQ[Px,x] && GtQ[Expon[Px,x],1] && NeQ[Coeff[Px,x,0],0]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{a=Rt[Coeff[Px,x,0],Expon[Px,x]],b=Rt[Coeff[Px,x,Expon[Px,x]],Expon[Px,x]]},
  ((a+b*x)^Expon[Px,x])^p/(a+b*x)^(Expon[Px,x]*p) \[Star] Int[u*(a+b*x)^(Expon[Px,x]*p),x] /;
 EqQ[Px,(a+b*x)^Expon[Px,x]]] /;
Not[IntegerQ[p]] && PolyQ[Px,x] && GtQ[Expon[Px,x],1] && NeQ[Coeff[Px,x,0],0]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  ShowStep["","Int[a*u + b*v + \[CenterEllipsis],x]","a*Integrate[u,x] + b*Integrate[v,x] + \[CenterEllipsis]",Hold[
  IntSum[u,x]]] /;
SimplifyFlag && SumQ[u],

Int[u_,x_Symbol] :=
  IntSum[u,x] /;
SumQ[u]]


(* ::Code:: *)
(* Int[Px_,x_Symbol] :=
  Int[ExpandIntegrand[Px,x],x] /;
PolyQ[Px,x] *)


(* ::Code:: *)
Int[(c_.*x_)^m_.*u_,x_Symbol] :=
  Int[ExpandIntegrand[(c*x)^m*u,x],x] /;
FreeQ[{c,m},x] && SumQ[u] && Not[LinearQ[u,x]] && Not[MatchQ[u,a_+b_.*v_ /; FreeQ[{a,b},x] && InverseFunctionQ[v]]]


(* ::Code:: *)
Int[u_.*(a_+b_.*v_)^m_.*(c_+d_.*v_)^n_.,x_Symbol] :=
  (b/d)^m \[Star] Int[u*(c+d*v)^(m+n),x] /;
FreeQ[{a,b,c,d,n},x] && EqQ[b*c-a*d,0] && IntegerQ[m] && (Not[IntegerQ[n]] || SimplerQ[c+d*x,a+b*x])


(* ::Code:: *)
Int[u_.*(a_+b_.*v_)^m_*(c_+d_.*v_)^n_,x_Symbol] :=
  (b/d)^m \[Star] Int[u*(c+d*v)^(m+n),x] /;
FreeQ[{a,b,c,d,m,n},x] && EqQ[b*c-a*d,0] && GtQ[b/d,0] && Not[IntegerQ[m] || IntegerQ[n]]


(* ::Code:: *)
Int[u_.*(a_+b_.*v_)^m_*(c_+d_.*v_)^n_,x_Symbol] :=
  (a+b*v)^m/(c+d*v)^m \[Star] Int[u*(c+d*v)^(m+n),x] /;
FreeQ[{a,b,c,d,m,n},x] && EqQ[b*c-a*d,0] && Not[IntegerQ[m] || IntegerQ[n] || GtQ[b/d,0]]


(* ::Code:: *)
(* Int[u_.*(a_.*v_)^m_*(b_.*v_+c_.*v_^2),x_Symbol] :=
  1/a \[Star] Int[u*(a*v)^(m+1)*(b+c*v),x] /;
FreeQ[{a,b,c},x] && LeQ[m,-1] *)


(* ::Code:: *)
Int[u_.*(a_+b_.*v_)^m_*(A_.+B_.*v_+C_.*v_^2),x_Symbol] :=
  1/b^2 \[Star] Int[u*(a+b*v)^(m+1)*Simp[b*B-a*C+b*C*v,x],x] /;
FreeQ[{a,b,A,B,C},x] && EqQ[A*b^2-a*b*B+a^2*C,0] && LeQ[m,-1]


(* ::Code:: *)
Int[u_.*(a_+b_.*x_^n_.)^m_.*(c_+d_.*x_^q_.)^p_.,x_Symbol] :=
  (d/a)^p \[Star] Int[u*(a+b*x^n)^(m+p)/x^(n*p),x] /;
FreeQ[{a,b,c,d,m,n},x] && EqQ[q,-n] && IntegerQ[p] && EqQ[a*c-b*d,0] && Not[IntegerQ[m] && NegQ[n]]


(* ::Code:: *)
Int[u_.*(a_+b_.*x_^n_.)^m_.*(c_+d_.*x_^j_)^p_.,x_Symbol] :=
  (-b^2/d)^m \[Star] Int[u*(a-b*x^n)^(-m),x] /;
FreeQ[{a,b,c,d,m,n,p},x] && EqQ[j,2*n] && EqQ[p,-m] && EqQ[b^2*c+a^2*d,0] && GtQ[a,0] && LtQ[d,0] && GtQ[b^2,0]


(* ::Code:: *)
(* Int[u_*(a_+b_.*x_+c_.*x_^2)^p_.,x_Symbol] :=
  Int[u*Cancel[(b/2+c*x)^(2*p)/c^p],x] /;
FreeQ[{a,b,c},x] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)


(* ::Code:: *)
(* Int[u_*(a_+b_.*x_^n_+c_.*x_^n2_.)^p_.,x_Symbol] :=
  1/c^p \[Star] Int[u*(b/2+c*x^n)^(2*p),x] /;
FreeQ[{a,b,c,n},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] && IntegerQ[p] *)


(* ::Code:: *)
Int[Px_*(a_+b_.*x_^n_)^p_,x_Symbol] :=
  Coeff[Px,x,n-1]*(a+b*x^n)^(p+1)/(b*n*(p+1)) + 
  Int[(Px-Coeff[Px,x,n-1]*x^(n-1))*(a+b*x^n)^p,x] /;
FreeQ[{a,b},x] && PolyQ[Px,x] && IGtQ[p,1] && IGtQ[n,1] && NeQ[Coeff[Px,x,n-1],0] && NeQ[Px,Coeff[Px,x,n-1]*x^(n-1)] && 
  Not[MatchQ[Px,Qx_.*(c_+d_.*x^m_)^q_ /; 
    FreeQ[{c,d},x] && PolyQ[Qx,x] && IGtQ[q,1] && IGtQ[m,1] && NeQ[Coeff[Qx*(a+b*x^n)^p,x,m-1],0] && GtQ[m*q,n*p]]]


(* ::Code:: *)
Int[Px_*x_^m_.*(a_+b_.*x_^n_.)^p_,x_Symbol] :=
  Coeff[Px,x,n-m-1]*(a+b*x^n)^(p+1)/(b*n*(p+1)) + 
  Int[(Px-Coeff[Px,x,n-m-1]*x^(n-m-1))*x^m*(a+b*x^n)^p,x] /;
FreeQ[{a,b,m,n},x] && PolyQ[Px,x] && IGtQ[p,1] && IGtQ[n-m,0] && NeQ[Coeff[Px,x,n-m-1],0]


(* ::Code:: *)
Int[u_.*Px_^p_.*Qx_^q_.,x_Symbol] :=
  Int[u*PolynomialQuotient[Px,Qx,x]^p*Qx^(p+q),x] /;
FreeQ[q,x] && PolyQ[Px,x] && PolyQ[Qx,x] && EqQ[PolynomialRemainder[Px,Qx,x],0] && IntegerQ[p] && LtQ[p*q,0]


(* ::Code:: *)
Int[Pp_/Qq_,x_Symbol] :=
  With[{p=Expon[Pp,x],q=Expon[Qq,x]},
  Coeff[Pp,x,p]*Log[RemoveContent[Qq,x]]/(q*Coeff[Qq,x,q])/;
 EqQ[p,q-1] && EqQ[Pp,Simplify[Coeff[Pp,x,p]/(q*Coeff[Qq,x,q])*D[Qq,x]]]] /;
PolyQ[Pp,x] && PolyQ[Qq,x]


(* ::Code:: *)
Int[Pp_*Qq_^m_.,x_Symbol] :=
  With[{p=Expon[Pp,x],q=Expon[Qq,x]},
  Coeff[Pp,x,p]*x^(p-q+1)*Qq^(m+1)/((p+m*q+1)*Coeff[Qq,x,q]) /;
 NeQ[p+m*q+1,0] && EqQ[(p+m*q+1)*Coeff[Qq,x,q]*Pp,Coeff[Pp,x,p]*x^(p-q)*((p-q+1)*Qq+(m+1)*x*D[Qq,x])]] /;
FreeQ[m,x] && PolyQ[Pp,x] && PolyQ[Qq,x] && NeQ[m,-1]


(* ::Code:: *)
Int[x_^m_.*(a1_+b1_.*x_^n_.)^p_*(a2_+b2_.*x_^n_.)^p_,x_Symbol] :=
  (a1+b1*x^n)^(p+1)*(a2+b2*x^n)^(p+1)/(2*b1*b2*n*(p+1)) /;
FreeQ[{a1,b1,a2,b2,m,n,p},x] && EqQ[a2*b1+a1*b2,0] && EqQ[m-2*n+1,0] && NeQ[p,-1]


(* ::Code:: *)
Int[Pp_*Qq_^m_.*Rr_^n_.,x_Symbol] :=
  With[{p=Expon[Pp,x],q=Expon[Qq,x],r=Expon[Rr,x]},
  Coeff[Pp,x,p]*x^(p-q-r+1)*Qq^(m+1)*Rr^(n+1)/((p+m*q+n*r+1)*Coeff[Qq,x,q]*Coeff[Rr,x,r]) /;
 NeQ[p+m*q+n*r+1,0] && 
 EqQ[(p+m*q+n*r+1)*Coeff[Qq,x,q]*Coeff[Rr,x,r]*Pp,Coeff[Pp,x,p]*x^(p-q-r)*((p-q-r+1)*Qq*Rr+(m+1)*x*Rr*D[Qq,x]+(n+1)*x*Qq*D[Rr,x])]] /;
FreeQ[{m,n},x] && PolyQ[Pp,x] && PolyQ[Qq,x] && PolyQ[Rr,x] && NeQ[m,-1] && NeQ[n,-1]


(* ::Code:: *)
Int[Qr_*(a_.+b_.*Pq_^n_.)^p_.,x_Symbol] :=
  With[{q=Expon[Pq,x],r=Expon[Qr,x]},
  Coeff[Qr,x,r]/(q*Coeff[Pq,x,q]) \[Star] Subst[Int[(a+b*x^n)^p,x],x,Pq] /;
 EqQ[r,q-1] && EqQ[Coeff[Qr,x,r]*D[Pq,x],q*Coeff[Pq,x,q]*Qr]] /;
FreeQ[{a,b,n,p},x] && PolyQ[Pq,x] && PolyQ[Qr,x]


(* ::Code:: *)
Int[Qr_*(a_.+b_.*Pq_^n_.+c_.*Pq_^n2_.)^p_.,x_Symbol] :=
  Module[{q=Expon[Pq,x],r=Expon[Qr,x]},
  Coeff[Qr,x,r]/(q*Coeff[Pq,x,q]) \[Star] Subst[Int[(a+b*x^n+c*x^(2*n))^p,x],x,Pq] /;
 EqQ[r,q-1] && EqQ[Coeff[Qr,x,r]*D[Pq,x],q*Coeff[Pq,x,q]*Qr]] /;
FreeQ[{a,b,c,n,p},x] && EqQ[n2,2*n] && PolyQ[Pq,x] && PolyQ[Qr,x]


(* ::Code:: *)
Int[Px_^p_.*Fx_.,x_Symbol] :=
  With[{r=Expon[Px,x,Min]},
  Int[x^(p*r)*ExpandToSum[Px/x^r,x]^p*Fx,x] /;
 IGtQ[r,0]] /;
PolyQ[Px,x] && IntegerQ[p] && Not[MonomialQ[Px,x]] && (ILtQ[p,0] || Not[PolyQ[u,x]])


(* ::Code:: *)
Int[(a_.*x_^r_.+b_.*x_^s_.)^p_.*Fx_.,x_Symbol] :=
  Int[x^(p*r)*(a+b*x^(s-r))^p*Fx,x] /;
FreeQ[{a,b,r,s},x] && IntegerQ[p] && PosQ[s-r] && Not[EqQ[p,1] && EqQ[u,1]]


(* ::Code:: *)
Int[(a_.*x_^r_.+b_.*x_^s_.+c_.*x_^t_.)^p_.*Fx_.,x_Symbol] :=
  Int[x^(p*r)*(a+b*x^(s-r)+c*x^(t-r))^p*Fx,x] /;
FreeQ[{a,b,c,r,s,t},x] && IntegerQ[p] && PosQ[s-r] && PosQ[t-r] && Not[EqQ[p,1] && EqQ[u,1]]


(* ::Code:: *)
Int[(a_.*x_^r_.+b_.*x_^s_.+c_.*x_^t_.+d_.*x_^q_.)^p_.*Fx_.,x_Symbol] :=
  Int[x^(p*r)*(a+b*x^(s-r)+c*x^(t-r)+d*x^(q-r))^p*Fx,x] /;
FreeQ[{a,b,c,d,r,s,t,q},x] && IntegerQ[p] && PosQ[s-r] && PosQ[t-r] && PosQ[q-r] && Not[EqQ[p,1] && EqQ[u,1]]


(* ::Code:: *)
Int[v_^m_.*(b_*v_)^n_*Fx_.,x_Symbol] :=
  1/b^m \[Star] Int[(b*v)^(m+n)*Fx,x] /;
FreeQ[{b,n},x] && IntegerQ[m]


(* ::Code:: *)
Int[(a_.*v_)^m_*(b_.*v_)^n_*Fx_.,x_Symbol] :=
  a^(m+1/2)*b^(n-1/2)*Sqrt[b*v]/Sqrt[a*v] \[Star] Int[v^(m+n)*Fx,x] /;
FreeQ[{a,b,m},x] && Not[IntegerQ[m]] && IGtQ[n+1/2,0] && IntegerQ[m+n]


(* ::Code:: *)
(* Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_,x_Symbol] :=
  b^(n-1/2)*Sqrt[b*v]/(a^(n-1/2)*Sqrt[a*v]) \[Star] Int[u*(a*v)^(m+n),x] /;
FreeQ[{a,b,m},x] && Not[IntegerQ[m]] && IGtQ[n+1/2,0] && Not[IntegerQ[m+n]] *)


(* ::Code:: *)
Int[(a_.*v_)^m_*(b_.*v_)^n_*Fx_.,x_Symbol] :=
  a^(m-1/2)*b^(n+1/2)*Sqrt[a*v]/Sqrt[b*v] \[Star] Int[v^(m+n)*Fx,x] /;
FreeQ[{a,b,m},x] && Not[IntegerQ[m]] && ILtQ[n-1/2,0] && IntegerQ[m+n]


(* ::Code:: *)
(* Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_,x_Symbol] :=
  b^(n+1/2)*Sqrt[a*v]/(a^(n+1/2)*Sqrt[b*v]) \[Star] Int[u*(a*v)^(m+n),x] /;
FreeQ[{a,b,m},x] && Not[IntegerQ[m]] && ILtQ[n-1/2,0] && Not[IntegerQ[m+n]] *)


(* ::Code:: *)
Int[(a_.*v_)^m_*(b_.*v_)^n_*Fx_.,x_Symbol] :=
  a^(m+n)*(b*v)^n/(a*v)^n \[Star] Int[v^(m+n)*Fx,x] /;
FreeQ[{a,b,m,n},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && IntegerQ[m+n]


(* ::Code:: *)
Int[(a_.*v_)^m_*(b_.*v_)^n_*Fx_.,x_Symbol] :=
  b^IntPart[n]*(b*v)^FracPart[n]/(a^IntPart[n]*(a*v)^FracPart[n]) \[Star] Int[(a*v)^(m+n)*Fx,x] /;
FreeQ[{a,b,m,n},x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegerQ[m+n]]


(* ::Code:: *)
Int[x_^m_*Fx_,x_Symbol] :=
  With[{k=Denominator[m]},
  k \[Star] Subst[Int[x^(k*(m+1)-1)*SubstPower[Fx,x,k],x],x,x^(1/k)]] /;
FractionQ[m] && AlgebraicFunctionQ[Fx,x]


(* ::Code:: *)
Int[u_.*(a1_+b1_.*x_^non2_.)^p_.*(a2_+b2_.*x_^non2_.)^p_.*(c_+d_.*x_^n_.)^q_.,x_Symbol] :=
  Int[u*(a1*a2+b1*b2*x^n)^p*(c+d*x^n)^q,x] /;
FreeQ[{a1,b1,a2,b2,c,d,n,p,q},x] && EqQ[non2,n/2] && EqQ[a2*b1+a1*b2,0] && (IntegerQ[p] || GtQ[a1,0] && GtQ[a2,0])


(* ::Code:: *)
Int[u_.*(a1_+b1_.*x_^non2_.)^p_.*(a2_+b2_.*x_^non2_.)^p_.*(c_+d_.*x_^n_.+e_.*x_^n2_.)^q_.,x_Symbol] :=
  Int[u*(a1*a2+b1*b2*x^n)^p*(c+d*x^n+e*x^(2*n))^q,x] /;
FreeQ[{a1,b1,a2,b2,c,d,e,n,p,q},x] && EqQ[non2,n/2] && EqQ[n2,2*n] && EqQ[a2*b1+a1*b2,0] && (IntegerQ[p] || GtQ[a1,0] && GtQ[a2,0])


(* ::Code:: *)
Int[u_.*(a1_+b1_.*x_^non2_.)^p_*(a2_+b2_.*x_^non2_.)^p_*(c_+d_.*x_^n_.)^q_.,x_Symbol] :=
  (a1+b1*x^(n/2))^FracPart[p]*(a2+b2*x^(n/2))^FracPart[p]/(a1*a2+b1*b2*x^n)^FracPart[p] \[Star] 
    Int[u*(a1*a2+b1*b2*x^n)^p*(c+d*x^n)^q,x] /;
FreeQ[{a1,b1,a2,b2,c,d,n,p,q},x] && EqQ[non2,n/2] && EqQ[a2*b1+a1*b2,0] && Not[EqQ[n,2] && IGtQ[q,0]]


(* ::Code:: *)
Int[u_.*(a1_+b1_.*x_^non2_.)^p_.*(a2_+b2_.*x_^non2_.)^p_.*(c_+d_.*x_^n_.+e_.*x_^n2_.)^q_.,x_Symbol] :=
  (a1+b1*x^(n/2))^FracPart[p]*(a2+b2*x^(n/2))^FracPart[p]/(a1*a2+b1*b2*x^n)^FracPart[p] \[Star] 
    Int[u*(a1*a2+b1*b2*x^n)^p*(c+d*x^n+e*x^(2*n))^q,x] /;
FreeQ[{a1,b1,a2,b2,c,d,e,n,p,q},x] && EqQ[non2,n/2] && EqQ[n2,2*n] && EqQ[a2*b1+a1*b2,0]


(* ::Code:: *)
Int[(a_+b_.*x_^n_)^p_.*(c_+d_.*x_^n_)^q_.*(e1_+f1_.*x_^n2_.)^r_.*(e2_+f2_.*x_^n2_.)^r_.,x_Symbol] :=
  Int[(a+b*x^n)^p*(c+d*x^n)^q*(e1*e2+f1*f2*x^n)^r,x] /;
FreeQ[{a,b,c,d,e1,f1,e2,f2,n,p,q,r},x] && EqQ[n2,n/2] && EqQ[e2*f1+e1*f2,0] && (IntegerQ[r] || GtQ[e1,0] && GtQ[e2,0])


(* ::Code:: *)
Int[(a_+b_.*x_^n_)^p_.*(c_+d_.*x_^n_)^q_.*(e1_+f1_.*x_^n2_.)^r_.*(e2_+f2_.*x_^n2_.)^r_.,x_Symbol] :=
  (e1+f1*x^(n/2))^FracPart[r]*(e2+f2*x^(n/2))^FracPart[r]/(e1*e2+f1*f2*x^n)^FracPart[r] \[Star] 
    Int[(a+b*x^n)^p*(c+d*x^n)^q*(e1*e2+f1*f2*x^n)^r,x] /;
FreeQ[{a,b,c,d,e1,f1,e2,f2,n,p,q,r},x] && EqQ[n2,n/2] && EqQ[e2*f1+e1*f2,0]


(* ::Code:: *)
Int[u_.*(c_.*(d_*(a_.+b_.* x_))^q_)^p_,x_Symbol] :=
  (c*(d*(a+b*x))^q)^p/(a+b*x)^(p*q) \[Star] Int[u*(a+b*x)^(p*q),x] /;
FreeQ[{a,b,c,d,q,p},x] && Not[IntegerQ[q]] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[u_.*(c_.*(d_.*(a_.+b_.* x_)^n_)^q_)^p_,x_Symbol] :=
  (c*(d*(a+b*x)^n)^q)^p/(a+b*x)^(n*p*q) \[Star] Int[u*(a+b*x)^(n*p*q),x] /;
FreeQ[{a,b,c,d,n,q,p},x] && Not[IntegerQ[q]] && Not[IntegerQ[p]]


(* ::Code:: *)
Int[u_.*(c_.*(a_.+b_.*x_^n_.)^q_)^p_,x_Symbol] :=
  Simp[(c*(a+b*x^n)^q)^p/(a+b*x^n)^(p*q)] \[Star] Int[u*(a+b*x^n)^(p*q),x] /;
FreeQ[{a,b,c,n,p,q},x] && GeQ[a,0]


(* ::Code:: *)
Int[u_.*(c_.*(a_+b_.*x_^n_.)^q_)^p_,x_Symbol] :=
  Simp[(c*(a+b*x^n)^q)^p/(1+b*x^n/a)^(p*q)] \[Star] Int[u*(1+b*x^n/a)^(p*q),x] /;
FreeQ[{a,b,c,n,p,q},x] && Not[GeQ[a,0]]


(* ::Code:: *)
Int[u_.*(e_.*(a_.+b_.*x_^n_.)^q_.*(c_+d_.*x_^n_.)^q_.)^p_,x_Symbol] :=
  Int[u*(e*(d/b)^q*(a+b*x^n)^(2*q))^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && IntegerQ[q] && EqQ[b*c-a*d,0]


(* ::Code:: *)
Int[u_.*(e_.*(a_.+b_.*x_^n_.)^q_*(c_+d_.*x_^n_.)^q_)^p_,x_Symbol] :=
  Int[u*(e*(-a^2*d/b+b*d*x^(2*n))^q)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && IntegerQ[q] && EqQ[b*c+a*d,0]


(* ::Code:: *)
(* Int[u_.*((a_.+b_.*x_^n_.)*(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  Int[u*(a+b*x^n)^p*(c+d*x^n)^p,x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[b+d,0] && GtQ[a,0] && GtQ[c,0] *)


(* ::Code:: *)
Int[u_.*(e_.*(a_.+b_.*x_^n_.)*(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  Int[u*(a*c*e+(b*c+a*d)*e*x^n+b*d*e*x^(2*n))^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x]


(* ::Code:: *)
Int[u_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  (b*e/d)^p \[Star] Int[u,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c-a*d,0]


(* ::Code:: *)
Int[u_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  Int[u*(a*e+b*e*x^n)^p/(c+d*x^n)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && GtQ[b*d*e,0] && GtQ[c-a*d/b,0]


(* ::Code:: *)
(* Int[u_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  Int[u*(a*e+b*e*x^n)^p/(c+d*x^n)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c+a*d,0] && GtQ[b*e/d,0] && GtQ[c,0] *)


(* ::Code:: *)
(* Int[u_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  Int[u*(-a*e-b*e*x^n)^p/(-c-d*x^n)^p,x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[b*c+a*d,0] && GtQ[b*e/d,0] && LtQ[c,0] *)


(* ::Code:: *)
Int[(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  With[{q=Denominator[p]},
  q*e*(b*c-a*d)/n \[Star] Subst[
    Int[x^(q*(p+1)-1)*(-a*e+c*x^q)^(1/n-1)/(b*e-d*x^q)^(1/n+1),x],x,(e*(a+b*x^n)/(c+d*x^n))^(1/q)]] /;
FreeQ[{a,b,c,d,e},x] && FractionQ[p] && IntegerQ[1/n]


(* ::Code:: *)
Int[x_^m_.*(e_.*(a_.+b_.*x_)/(c_+d_.*x_))^p_,x_Symbol] :=
  With[{q=Denominator[p]},
  q*e*(b*c-a*d) \[Star] Subst[Int[x^(q*(p+1)-1)*(-a*e+c*x^q)^m/(b*e-d*x^q)^(m+2),x],x,(e*(a+b*x)/(c+d*x))^(1/q)]] /;
FreeQ[{a,b,c,d,e,m},x] && FractionQ[p] && IntegerQ[m]


(* ::Code:: *)
Int[x_^m_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  1/n \[Star] Subst[Int[x^(Simplify[(m+1)/n]-1)*(e*(a+b*x)/(c+d*x))^p,x],x,x^n] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && IntegerQ[Simplify[(m+1)/n]]


(* ::Code:: *)
Int[(f_*x_)^m_*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  Simp[(c*x)^m/x^m] \[Star] Int[x^m*(e*(a+b*x^n)/(c+d*x^n))^p,x] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && IntegerQ[Simplify[(m+1)/n]]


(* ::Code:: *)
Int[u_^r_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  With[{q=Denominator[p]},
  q*e*(b*c-a*d)/n \[Star] Subst[Int[SimplifyIntegrand[x^(q*(p+1)-1)*(-a*e+c*x^q)^(1/n-1)/(b*e-d*x^q)^(1/n+1)*
    ReplaceAll[u,x->(-a*e+c*x^q)^(1/n)/(b*e-d*x^q)^(1/n)]^r,x],x],x,(e*(a+b*x^n)/(c+d*x^n))^(1/q)]] /;
FreeQ[{a,b,c,d,e},x] && PolynomialQ[u,x] && FractionQ[p] && IntegerQ[1/n] && IntegerQ[r]


(* ::Code:: *)
Int[x_^m_.*u_^r_.*(e_.*(a_.+b_.*x_^n_.)/(c_+d_.*x_^n_.))^p_,x_Symbol] :=
  With[{q=Denominator[p]},
  q*e*(b*c-a*d)/n \[Star] Subst[Int[SimplifyIntegrand[x^(q*(p+1)-1)*(-a*e+c*x^q)^((m+1)/n-1)/(b*e-d*x^q)^((m+1)/n+1)*
    ReplaceAll[u,x->(-a*e+c*x^q)^(1/n)/(b*e-d*x^q)^(1/n)]^r,x],x],x,(e*(a+b*x^n)/(c+d*x^n))^(1/q)]] /;
FreeQ[{a,b,c,d,e},x] && PolynomialQ[u,x] && FractionQ[p] && IntegerQ[1/n] && IntegersQ[m,r]


(* ::Code:: *)
Int[u_.*(a_+b_./(c_+d_.*x_^n_))^p_,x_Symbol] :=
  Int[u*((b+a*c+a*d*x^n)/(c+d*x^n))^p,x] /;
FreeQ[{a,b,c,d,n,p},x]


(* ::Code:: *)
Int[u_.*(e_.*(a_.+b_.*x_^n_.)^q_.*(c_+d_.*x_^n_)^r_.)^p_,x_Symbol] :=
  Simp[(e*(a+b*x^n)^q*(c+d*x^n)^r)^p/((a+b*x^n)^(p*q)*(c+d*x^n)^(p*r))] \[Star] 
    Int[u*(a+b*x^n)^(p*q)*(c+d*x^n)^(p*r),x] /;
FreeQ[{a,b,c,d,e,n,p,q,r},x]


(* ::Code:: *)
Int[(a_.+b_.*(c_./x_)^n_)^p_,x_Symbol] :=
  -c \[Star] Subst[Int[(a+b*x^n)^p/x^2,x],x,c/x] /;
FreeQ[{a,b,c,n,p},x]


(* ::Code:: *)
Int[x_^m_.*(a_.+b_.*(c_./x_)^n_)^p_,x_Symbol] :=
  -c^(m+1) \[Star] Subst[Int[(a+b*x^n)^p/x^(m+2),x],x,c/x] /;
FreeQ[{a,b,c,n,p},x] && IntegerQ[m]


(* ::Code:: *)
Int[(d_.*x_)^m_*(a_.+b_.*(c_./x_)^n_)^p_,x_Symbol] :=
  -c*(d*x)^m*(c/x)^m \[Star] Subst[Int[(a+b*x^n)^p/x^(m+2),x],x,c/x] /;
FreeQ[{a,b,c,d,m,n,p},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[(a_.+b_.*(d_./x_)^n_+c_.*(d_./x_)^n2_.)^p_,x_Symbol] :=
  -d \[Star] Subst[Int[(a+b*x^n+c*x^(2*n))^p/x^2,x],x,d/x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n2,2*n]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*(d_./x_)^n_+c_.*(d_./x_)^n2_.)^p_,x_Symbol] :=
  -d^(m+1) \[Star] Subst[Int[(a+b*x^n+c*x^(2*n))^p/x^(m+2),x],x,d/x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n2,2*n] && IntegerQ[m]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*(d_./x_)^n_+c_.*(d_./x_)^n2_.)^p_,x_Symbol] :=
  -d*(e*x)^m*(d/x)^m \[Star] Subst[Int[(a+b*x^n+c*x^(2*n))^p/x^(m+2),x],x,d/x] /;
FreeQ[{a,b,c,d,e,m,n,p},x] && EqQ[n2,2*n] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[(a_.+b_.*(d_./x_)^n_+c_.*x_^n2_.)^p_,x_Symbol] :=
  -d \[Star] Subst[Int[(a+b*x^n+c/d^(2*n)*x^(2*n))^p/x^2,x],x,d/x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n2,-2*n] && IntegerQ[2*n]


(* ::Code:: *)
Int[x_^m_.*(a_+b_.*(d_./x_)^n_+c_.*x_^n2_.)^p_,x_Symbol] :=
  -d^(m+1) \[Star] Subst[Int[(a+b*x^n+c/d^(2*n)*x^(2*n))^p/x^(m+2),x],x,d/x] /;
FreeQ[{a,b,c,d,n,p},x] && EqQ[n2,-2*n] && IntegerQ[2*n] && IntegerQ[m]


(* ::Code:: *)
Int[(e_.*x_)^m_*(a_+b_.*(d_./x_)^n_+c_.*x_^n2_.)^p_,x_Symbol] :=
  -d*(e*x)^m*(d/x)^m \[Star] Subst[Int[(a+b*x^n+c/d^(2*n)*x^(2*n))^p/x^(m+2),x],x,d/x] /;
FreeQ[{a,b,c,d,e,n,p},x] && EqQ[n2,-2*n] && Not[IntegerQ[m]] && IntegerQ[2*n]


(* ::Code:: *)
Int[u_.*(e_.*(a_+b_.*x_^n_.)^r_.)^p_*(f_.*(c_+d_.*x_^n_.)^s_)^q_,x_Symbol] :=
  (e*(a+b*x^n)^r)^p*(f*(c+d*x^n)^s)^q/((a+b*x^n)^(p*r)*(c+d*x^n)^(q*s)) \[Star] 
    Int[u*(a+b*x^n)^(p*r)*(c+d*x^n)^(q*s),x] /;
FreeQ[{a,b,c,d,e,f,n,p,q,r,s},x]


(* ::Code:: *)
Int[u_.*Px_,x_Symbol] :=
  With[{a=Rt[Coeff[Px,x^2,0],Expon[Px,x^2]],b=Rt[Coeff[Px,x^2,Expon[Px,x^2]],Expon[Px,x^2]]},
  Int[u*(a+b*x^2)^Expon[Px,x^2],x] /;
 EqQ[Px,(a+b*x^2)^Expon[Px,x^2]]] /;
PolyQ[Px,x^2] && GtQ[Expon[Px,x^2],1] && NeQ[Coeff[Px,x^2,0],0] && Not[MatchQ[Px,a_.*v_^Expon[Px,x^2] /; FreeQ[a,x] && BinomialQ[v,x,2]]] 


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{a=Rt[Coeff[Px,x^2,0],Expon[Px,x^2]],b=Rt[Coeff[Px,x^2,Expon[Px,x^2]],Expon[Px,x^2]]},
  Int[u*(a+b*x^2)^(Expon[Px,x^2]*p),x] /;
 EqQ[Px,(a+b*x^2)^Expon[Px,x^2]]] /;
IntegerQ[p] && PolyQ[Px,x^2] && GtQ[Expon[Px,x^2],1] && NeQ[Coeff[Px,x^2,0],0]


(* ::Code:: *)
Int[u_.*Px_^p_,x_Symbol] :=
  With[{a=Rt[Coeff[Px,x^2,0],Expon[Px,x^2]],b=Rt[Coeff[Px,x^2,Expon[Px,x^2]],Expon[Px,x^2]]},
  ((a+b*x^2)^Expon[Px,x^2])^p/(a+b*x^2)^(Expon[Px,x^2]*p) \[Star] Int[u*(a+b*x^2)^(Expon[Px,x^2]*p),x] /;
 EqQ[Px,(a+b*x^2)^Expon[Px,x^2]]] /;
Not[IntegerQ[p]] && PolyQ[Px,x^2] && GtQ[Expon[Px,x^2],1] && NeQ[Coeff[Px,x^2,0],0]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.4 Miscellaneous/1.4.2 Algebraic function normalization.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_^m_,x_Symbol] :=
  Int[ExpandToSum[u,x]^m,x] /;
FreeQ[m,x] && LinearQ[u,x] && Not[LinearMatchQ[u,x]]


(* ::Code:: *)
Int[u_^m_.*v_^n_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*ExpandToSum[v,x]^n,x] /;
FreeQ[{m,n},x] && LinearQ[{u,v},x] && Not[LinearMatchQ[{u,v},x]]


(* ::Code:: *)
Int[u_^m_.*v_^n_.*w_^p_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*ExpandToSum[v,x]^n*ExpandToSum[w,x]^p,x] /;
FreeQ[{m,n,p},x] && LinearQ[{u,v,w},x] && Not[LinearMatchQ[{u,v,w},x]]


(* ::Code:: *)
Int[u_^m_.*v_^n_.*w_^p_.*z_^q_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*ExpandToSum[v,x]^n*ExpandToSum[w,x]^p*ExpandToSum[z,x]^q,x] /;
FreeQ[{m,n,p,q},x] && LinearQ[{u,v,w,z},x] && Not[LinearMatchQ[{u,v,w,z},x]]


(* ::Code:: *)
Int[u_^p_,x_Symbol] :=
  Int[ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && BinomialQ[u,x] && Not[BinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(c_.*x_)^m_.*u_^p_.,x_Symbol] :=
  Int[(c*x)^m*ExpandToSum[u,x]^p,x] /;
FreeQ[{c,m,p},x] && BinomialQ[u,x] && Not[BinomialMatchQ[u,x]]


(* ::Code:: *)
Int[u_^p_.*v_^q_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^p*ExpandToSum[v,x]^q,x] /;
FreeQ[{p,q},x] && BinomialQ[{u,v},x] && EqQ[BinomialDegree[u,x]-BinomialDegree[v,x],0] && Not[BinomialMatchQ[{u,v},x]]


(* ::Code:: *)
Int[(e_.*x_)^m_.*u_^p_.*v_^q_.,x_Symbol] :=
  Int[(e*x)^m*ExpandToSum[u,x]^p*ExpandToSum[v,x]^q,x] /;
FreeQ[{e,m,p,q},x] && BinomialQ[{u,v},x] && EqQ[BinomialDegree[u,x]-BinomialDegree[v,x],0] && Not[BinomialMatchQ[{u,v},x]]


(* ::Code:: *)
Int[u_^m_.*v_^p_.*w_^q_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*ExpandToSum[v,x]^p*ExpandToSum[w,x]^q,x] /;
FreeQ[{m,p,q},x] && BinomialQ[{u,v,w},x] && EqQ[BinomialDegree[u,x]-BinomialDegree[v,x],0] && 
  EqQ[BinomialDegree[u,x]-BinomialDegree[w,x],0] && Not[BinomialMatchQ[{u,v,w},x]]


(* ::Code:: *)
Int[(g_.*x_)^m_.*u_^p_.*v_^q_.*z_^r_.,x_Symbol] :=
  Int[(g*x)^m*ExpandToSum[u,x]^p*ExpandToSum[v,x]^q*ExpandToSum[z,x]^r,x] /;
FreeQ[{g,m,p,q,r},x] && BinomialQ[{u,v,z},x] && EqQ[BinomialDegree[u,x]-BinomialDegree[v,x],0] && 
  EqQ[BinomialDegree[u,x]-BinomialDegree[z,x],0] && Not[BinomialMatchQ[{u,v,z},x]]


(* ::Code:: *)
Int[u_^p_,x_Symbol] :=
  Int[ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && GeneralizedBinomialQ[u,x] && Not[GeneralizedBinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(c_.*x_)^m_.*u_^p_.,x_Symbol] :=
  Int[(c*x)^m*ExpandToSum[u,x]^p,x] /;
FreeQ[{c,m,p},x] && GeneralizedBinomialQ[u,x] && Not[GeneralizedBinomialMatchQ[u,x]]


(* ::Code:: *)
Int[u_^p_,x_Symbol] :=
  Int[ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && QuadraticQ[u,x] && Not[QuadraticMatchQ[u,x]]


(* ::Code:: *)
Int[u_^m_.*v_^p_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*ExpandToSum[v,x]^p,x] /;
FreeQ[{m,p},x] && LinearQ[u,x] && QuadraticQ[v,x] && Not[LinearMatchQ[u,x] && QuadraticMatchQ[v,x]]


(* ::Code:: *)
Int[u_^m_.*v_^n_.*w_^p_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^m*ExpandToSum[v,x]^n*ExpandToSum[w,x]^p,x] /;
FreeQ[{m,n,p},x] && LinearQ[{u,v},x] && QuadraticQ[w,x] && Not[LinearMatchQ[{u,v},x] && QuadraticMatchQ[w,x]]


(* ::Code:: *)
Int[u_^p_.*v_^q_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^p*ExpandToSum[v,x]^q,x] /;
FreeQ[{p,q},x] && QuadraticQ[{u,v},x] && Not[QuadraticMatchQ[{u,v},x]]


(* ::Code:: *)
Int[z_^m_.*u_^p_.*v_^q_.,x_Symbol] :=
  Int[ExpandToSum[z,x]^m*ExpandToSum[u,x]^p*ExpandToSum[v,x]^q,x] /;
FreeQ[{m,p,q},x] && LinearQ[z,x] && QuadraticQ[{u,v},x] && Not[LinearMatchQ[z,x] && QuadraticMatchQ[{u,v},x]] && 
  Not[MatchQ[z^m*u^p*v^q, (d_.+e_.*x)^m*(f_.+g_.*x)^2*(a_.+b_.*x+c_.*x^2)^t_. /; FreeQ[{a,b,c,d,e,f,g,t},x]]] && 
  Not[MatchQ[z^m*u^p*v^q, (d_.+e_.*x)^m*(f_.+g_.*x)^2*(a_.+c_.*x^2)^t_. /; FreeQ[{a,c,d,e,f,g,t},x]]]


(* ::Code:: *)
Int[u_^p_,x_Symbol] :=
  Int[ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && TrinomialQ[u,x] && Not[TrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(d_.*x_)^m_.*u_^p_.,x_Symbol] :=
  Int[(d*x)^m*ExpandToSum[u,x]^p,x] /;
FreeQ[{d,m,p},x] && TrinomialQ[u,x] && Not[TrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[u_^q_.*v_^p_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^q*ExpandToSum[v,x]^p,x] /;
FreeQ[{p,q},x] && BinomialQ[u,x] && TrinomialQ[v,x] && Not[BinomialMatchQ[u,x] && TrinomialMatchQ[v,x]]


(* ::Code:: *)
Int[u_^q_.*v_^p_.,x_Symbol] :=
  Int[ExpandToSum[u,x]^q*ExpandToSum[v,x]^p,x] /;
FreeQ[{p,q},x] && BinomialQ[u,x] && BinomialQ[v,x] && Not[BinomialMatchQ[u,x] && BinomialMatchQ[v,x]]


(* ::Code:: *)
Int[(f_.*x_)^m_.*z_^q_.*u_^p_.,x_Symbol] :=
  Int[(f*x)^m*ExpandToSum[z,x]^q*ExpandToSum[u,x]^p,x] /;
FreeQ[{f,m,p,q},x] && BinomialQ[z,x] && TrinomialQ[u,x] && Not[BinomialMatchQ[z,x] && TrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(f_.*x_)^m_.*z_^q_.*u_^p_.,x_Symbol] :=
  Int[(f*x)^m*ExpandToSum[z,x]^q*ExpandToSum[u,x]^p,x] /;
FreeQ[{f,m,p,q},x] && BinomialQ[z,x] && BinomialQ[u,x] && Not[BinomialMatchQ[z,x] && BinomialMatchQ[u,x]]


(* ::Code:: *)
Int[Px_*z_^q_.*u_^p_.,x_Symbol] :=
  Int[Px*ExpandToSum[z,x]^q*ExpandToSum[u,x]^p,x] /;
FreeQ[{p,q},x] && PolyQ[Px,x] && BinomialQ[z,x] && TrinomialQ[u,x] && Not[BinomialMatchQ[z,x] && TrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[Px_*z_^q_.*u_^p_.,x_Symbol] :=
  Int[Px*ExpandToSum[z,x]^q*ExpandToSum[u,x]^p,x] /;
FreeQ[{p,q},x] && BinomialQ[z,x] && BinomialQ[u,x] && Not[BinomialMatchQ[z,x] && BinomialMatchQ[u,x]]


(* ::Code:: *)
Int[u_^p_,x_Symbol] :=
  Int[ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && GeneralizedTrinomialQ[u,x] && Not[GeneralizedTrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(d_.*x_)^m_.*u_^p_.,x_Symbol] :=
  Int[(d*x)^m*ExpandToSum[u,x]^p,x] /;
FreeQ[{d,m,p},x] && GeneralizedTrinomialQ[u,x] && Not[GeneralizedTrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[z_*u_^p_.,x_Symbol] :=
  Int[ExpandToSum[z,x]*ExpandToSum[u,x]^p,x] /;
FreeQ[p,x] && BinomialQ[z,x] && GeneralizedTrinomialQ[u,x] && 
  EqQ[BinomialDegree[z,x]-GeneralizedTrinomialDegree[u,x],0] && Not[BinomialMatchQ[z,x] && GeneralizedTrinomialMatchQ[u,x]]


(* ::Code:: *)
Int[(f_.*x_)^m_.*z_*u_^p_.,x_Symbol] :=
  Int[(f*x)^m*ExpandToSum[z,x]*ExpandToSum[u,x]^p,x] /;
FreeQ[{f,m,p},x] && BinomialQ[z,x] && GeneralizedTrinomialQ[u,x] && 
  EqQ[BinomialDegree[z,x]-GeneralizedTrinomialDegree[u,x],0] && Not[BinomialMatchQ[z,x] && GeneralizedTrinomialMatchQ[u,x]]




(*FILE: 
Rubi/IntegrationRules/1 Algebraic functions/1.4 Miscellaneous/1.4.3 Miscellaneous algebraic functions.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_/(e_.*Sqrt[a_.+b_.*x_]+f_.*Sqrt[c_.+d_.*x_]),x_Symbol] :=
  c/(e*(b*c-a*d)) \[Star] Int[(u*Sqrt[a+b*x])/x,x] - a/(f*(b*c-a*d)) \[Star] Int[(u*Sqrt[c+d*x])/x,x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b*c-a*d,0] && EqQ[a*e^2-c*f^2,0]


(* ::Code:: *)
Int[u_/(e_.*Sqrt[a_.+b_.*x_]+f_.*Sqrt[c_.+d_.*x_]),x_Symbol] :=
  -d/(e*(b*c-a*d)) \[Star] Int[u*Sqrt[a+b*x],x] + b/(f*(b*c-a*d)) \[Star] Int[u*Sqrt[c+d*x],x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[b*c-a*d,0] && EqQ[b*e^2-d*f^2,0]


(* ::Code:: *)
Int[u_/(e_.*Sqrt[a_.+b_.*x_]+f_.*Sqrt[c_.+d_.*x_]),x_Symbol] :=
  e \[Star] Int[(u*Sqrt[a+b*x])/(a*e^2-c*f^2+(b*e^2-d*f^2)*x),x] - 
  f \[Star] Int[(u*Sqrt[c+d*x])/(a*e^2-c*f^2+(b*e^2-d*f^2)*x),x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[a*e^2-c*f^2,0] && NeQ[b*e^2-d*f^2,0]


(* ::Code:: *)
Int[u_./(d_.*x_^n_.+c_.*Sqrt[a_.+b_.*x_^p_.]),x_Symbol] :=
  -b/(a*d) \[Star] Int[u*x^n,x] + 1/(a*c) \[Star] Int[u*Sqrt[a+b*x^(2*n)],x] /;
FreeQ[{a,b,c,d,n},x] && EqQ[p,2*n] && EqQ[b*c^2-d^2,0]


(* ::Code:: *)
Int[x_^m_./(d_.*x_^n_.+c_.*Sqrt[a_.+b_.*x_^p_.]),x_Symbol] :=
  -d \[Star] Int[x^(m+n)/(a*c^2+(b*c^2-d^2)*x^(2*n)),x] + 
  c \[Star] Int[(x^m*Sqrt[a+b*x^(2*n)])/(a*c^2+(b*c^2-d^2)*x^(2*n)),x] /;
FreeQ[{a,b,c,d,m,n},x] && EqQ[p,2*n] && NeQ[b*c^2-d^2,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_^3)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{r=Numerator[Rt[a/b,3]], s=Denominator[Rt[a/b,3]]},
  r/(3*a) \[Star] Int[1/((r+s*x)*Sqrt[d+e*x+f*x^2]),x] +
  r/(3*a) \[Star] Int[(2*r-s*x)/((r^2-r*s*x+s^2*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,d,e,f},x] && PosQ[a/b]


(* ::Code:: *)
Int[1/((a_+b_.*x_^3)*Sqrt[d_.+f_.*x_^2]),x_Symbol] :=
  With[{r=Numerator[Rt[a/b,3]], s=Denominator[Rt[a/b,3]]},
  r/(3*a) \[Star] Int[1/((r+s*x)*Sqrt[d+f*x^2]),x] +
  r/(3*a) \[Star] Int[(2*r-s*x)/((r^2-r*s*x+s^2*x^2)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,d,f},x] && PosQ[a/b]


(* ::Code:: *)
Int[1/((a_+b_.*x_^3)*Sqrt[d_.+e_.*x_+f_.*x_^2]),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,3]], s=Denominator[Rt[-a/b,3]]},
  r/(3*a) \[Star] Int[1/((r-s*x)*Sqrt[d+e*x+f*x^2]),x] +
  r/(3*a) \[Star] Int[(2*r+s*x)/((r^2+r*s*x+s^2*x^2)*Sqrt[d+e*x+f*x^2]),x]] /;
FreeQ[{a,b,d,e,f},x] && NegQ[a/b]


(* ::Code:: *)
Int[1/((a_+b_.*x_^3)*Sqrt[d_.+f_.*x_^2]),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,3]], s=Denominator[Rt[-a/b,3]]},
  r/(3*a) \[Star] Int[1/((r-s*x)*Sqrt[d+f*x^2]),x] +
  r/(3*a) \[Star] Int[(2*r+s*x)/((r^2+r*s*x+s^2*x^2)*Sqrt[d+f*x^2]),x]] /;
FreeQ[{a,b,d,f},x] && NegQ[a/b]


(* ::Code:: *)
Int[u_*(A_+B_.*x_^4)/Sqrt[v_],x_Symbol] :=
  With[{a=Coeff[v,x,0],b=Coeff[v,x,2],c=Coeff[v,x,4],d=Coeff[1/u,x,0],e=Coeff[1/u,x,2],f=Coeff[1/u,x,4]},
  A \[Star] Subst[Int[1/(d-(b*d-a*e)*x^2),x],x,x/Sqrt[v]] /;
 EqQ[a*B+A*c,0] && EqQ[c*d-a*f,0]] /;
FreeQ[{A,B},x] && PolyQ[v,x^2,2] && PolyQ[1/u,x^2,2]


(* ::Code:: *)
Int[1/((a_+b_.*x_)*Sqrt[c_+d_.*x_^2]*Sqrt[e_+f_.*x_^2]),x_Symbol] :=
  a \[Star] Int[1/((a^2-b^2*x^2)*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] - b \[Star] Int[x/((a^2-b^2*x^2)*Sqrt[c+d*x^2]*Sqrt[e+f*x^2]),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(g_.+h_.*x_)*Sqrt[d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2]],x_Symbol] :=
  2*(f*(5*b*c*g^2-2*b^2*g*h-3*a*c*g*h+2*a*b*h^2)+c*f*(10*c*g^2-b*g*h+a*h^2)*x+9*c^2*f*g*h*x^2+3*c^2*f*h^2*x^3-
    (e*g-d*h)*(5*c*g-2*b*h+c*h*x)*Sqrt[a+b*x+c*x^2])/
  (15*c^2*f*(g+h*x))*Sqrt[d+e*x+f*Sqrt[a+b*x+c*x^2]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && EqQ[(e*g-d*h)^2-f^2*(c*g^2-b*g*h+a*h^2),0] && EqQ[2*e^2*g-2*d*e*h-f^2*(2*c*g-b*h),0]


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(u_+f_.*(j_.+k_.*Sqrt[v_]))^n_.,x_Symbol] :=
  Int[(g+h*x)^m*(ExpandToSum[u+f*j,x]+f*k*Sqrt[ExpandToSum[v,x]])^n,x] /;
FreeQ[{f,g,h,j,k,m,n},x] && LinearQ[u,x] && QuadraticQ[v,x] && 
  Not[LinearMatchQ[u,x] && QuadraticMatchQ[v,x] && (EqQ[j,0] || EqQ[f,1])] && 
  EqQ[(Coefficient[u,x,1]*g-h*(Coefficient[u,x,0]+f*j))^2-f^2*k^2*(Coefficient[v,x,2]*g^2-Coefficient[v,x,1]*g*h+Coefficient[v,x,0]*h^2),0]


(* ::Code:: *)
(* Int[1/(d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2]),x_Symbol] :=
  Int[(d+e*x)/(d^2-a*f^2+(2*d*e-b*f^2)*x),x] - 
  f \[Star] Int[Sqrt[a+b*x+c*x^2]/(d^2-a*f^2+(2*d*e-b*f^2)*x),x] /;
FreeQ[{a,b,c,d,e,f},x] && EqQ[e^2-c*f^2,0] *)


(* ::Code:: *)
(* Int[1/(d_.+e_.*x_+f_.*Sqrt[a_.+c_.*x_^2]),x_Symbol] :=
  Int[(d+e*x)/(d^2-a*f^2+2*d*e*x),x] - 
  f \[Star] Int[Sqrt[a+c*x^2]/(d^2-a*f^2+2*d*e*x),x] /;
FreeQ[{a,c,d,e,f},x] && EqQ[e^2-c*f^2,0] *)


(* ::Code:: *)
Int[(g_.+h_.*(d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2])^n_)^p_.,x_Symbol] :=
  2 \[Star] Subst[Int[(g+h*x^n)^p*(d^2*e-(b*d-a*e)*f^2-(2*d*e-b*f^2)*x+e*x^2)/(-2*d*e+b*f^2+2*e*x)^2,x],x,d+e*x+f*Sqrt[a+b*x+c*x^2]] /;
FreeQ[{a,b,c,d,e,f,g,h,n},x] && EqQ[e^2-c*f^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(g_.+h_.*(d_.+e_.*x_+f_.*Sqrt[a_+c_.*x_^2])^n_)^p_.,x_Symbol] :=
  1/(2*e) \[Star] Subst[Int[(g+h*x^n)^p*(d^2+a*f^2-2*d*x+x^2)/(d-x)^2,x],x,d+e*x+f*Sqrt[a+c*x^2]] /;
FreeQ[{a,c,d,e,f,g,h,n},x] && EqQ[e^2-c*f^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(g_.+h_.*(u_+f_. Sqrt[v_])^n_)^p_.,x_Symbol] :=
  Int[(g+h*(ExpandToSum[u,x]+f*Sqrt[ExpandToSum[v,x]])^n)^p,x] /;
FreeQ[{f,g,h,n},x] && LinearQ[u,x] && QuadraticQ[v,x] && Not[LinearMatchQ[u,x] && QuadraticMatchQ[v,x]] && 
  EqQ[Coefficient[u,x,1]^2-Coefficient[v,x,2]*f^2,0] && IntegerQ[p]


(* ::Code:: *)
Int[(g_.+h_.*x_)^m_.*(e_.*x_+f_.*Sqrt[a_.+c_.*x_^2])^n_.,x_Symbol] :=
  1/(2^(m+1)*e^(m+1)) \[Star] Subst[Int[x^(n-m-2)*(a*f^2+x^2)*(-a*f^2*h+2*e*g*x+h*x^2)^m,x],x,e*x+f*Sqrt[a+c*x^2]] /;
FreeQ[{a,c,e,f,g,h,n},x] && EqQ[e^2-c*f^2,0] && IntegerQ[m]


(* ::Code:: *)
Int[x_^p_.*(g_+i_.*x_^2)^m_.*(e_.*x_+f_.*Sqrt[a_+c_.*x_^2])^n_.,x_Symbol] :=
  1/(2^(2*m+p+1)*e^(p+1)*f^(2*m))*(i/c)^m \[Star] Subst[Int[x^(n-2*m-p-2)*(-a*f^2+x^2)^p*(a*f^2+x^2)^(2*m+1),x],x,e*x+f*Sqrt[a+c*x^2]] /;
FreeQ[{a,c,e,f,g,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && IntegersQ[p,2*m] && (IntegerQ[m] || GtQ[i/c,0])


(* ::Code:: *)
Int[(g_.+h_.*x_+i_.*x_^2)^m_.*(d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2])^n_.,x_Symbol] :=
  2/f^(2*m)*(i/c)^m \[Star] 
    Subst[Int[x^n*(d^2*e-(b*d-a*e)*f^2-(2*d*e-b*f^2)*x+e*x^2)^(2*m+1)/(-2*d*e+b*f^2+2*e*x)^(2*(m+1)),x],x,d+e*x+f*Sqrt[a+b*x+c*x^2]] /;
FreeQ[{a,b,c,d,e,f,g,h,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && EqQ[c*h-b*i,0] && IntegerQ[2*m] && (IntegerQ[m] || GtQ[i/c,0])


(* ::Code:: *)
Int[(g_+i_.*x_^2)^m_.*(d_.+e_.*x_+f_.*Sqrt[a_+c_.*x_^2])^n_.,x_Symbol] :=
  1/(2^(2*m+1)*e*f^(2*m))*(i/c)^m \[Star] 
    Subst[Int[x^n*(d^2+a*f^2-2*d*x+x^2)^(2*m+1)/(-d+x)^(2*(m+1)),x],x,d+e*x+f*Sqrt[a+c*x^2]] /;
FreeQ[{a,c,d,e,f,g,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && IntegerQ[2*m] && (IntegerQ[m] || GtQ[i/c,0])


(* ::Code:: *)
Int[(g_.+h_.*x_+i_.*x_^2)^m_.*(d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2])^n_.,x_Symbol] :=
  (i/c)^(m-1/2)*Sqrt[g+h*x+i*x^2]/Sqrt[a+b*x+c*x^2] \[Star] Int[(a+b*x+c*x^2)^m*(d+e*x+f*Sqrt[a+b*x+c*x^2])^n,x] /;
FreeQ[{a,b,c,d,e,f,g,h,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && EqQ[c*h-b*i,0] && IGtQ[m+1/2,0] && Not[GtQ[i/c,0]]


(* ::Code:: *)
Int[(g_+i_.*x_^2)^m_.*(d_.+e_.*x_+f_.*Sqrt[a_+c_.*x_^2])^n_.,x_Symbol] :=
  (i/c)^(m-1/2)*Sqrt[g+i*x^2]/Sqrt[a+c*x^2] \[Star] Int[(a+c*x^2)^m*(d+e*x+f*Sqrt[a+c*x^2])^n,x] /;
FreeQ[{a,c,d,e,f,g,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && IGtQ[m+1/2,0] && Not[GtQ[i/c,0]]


(* ::Code:: *)
Int[(g_.+h_.*x_+i_.*x_^2)^m_.*(d_.+e_.*x_+f_.*Sqrt[a_.+b_.*x_+c_.*x_^2])^n_.,x_Symbol] :=
  (i/c)^(m+1/2)*Sqrt[a+b*x+c*x^2]/Sqrt[g+h*x+i*x^2] \[Star] Int[(a+b*x+c*x^2)^m*(d+e*x+f*Sqrt[a+b*x+c*x^2])^n,x] /;
FreeQ[{a,b,c,d,e,f,g,h,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && EqQ[c*h-b*i,0] && ILtQ[m-1/2,0] && Not[GtQ[i/c,0]]


(* ::Code:: *)
Int[(g_+i_.*x_^2)^m_.*(d_.+e_.*x_+f_.*Sqrt[a_+c_.*x_^2])^n_.,x_Symbol] :=
  (i/c)^(m+1/2)*Sqrt[a+c*x^2]/Sqrt[g+i*x^2] \[Star] Int[(a+c*x^2)^m*(d+e*x+f*Sqrt[a+c*x^2])^n,x] /;
FreeQ[{a,c,d,e,f,g,i,n},x] && EqQ[e^2-c*f^2,0] && EqQ[c*g-a*i,0] && ILtQ[m-1/2,0] && Not[GtQ[i/c,0]]


(* ::Code:: *)
Int[w_^m_.*(u_+f_.*(j_.+k_.*Sqrt[v_]))^n_.,x_Symbol] :=
  Int[ExpandToSum[w,x]^m*(ExpandToSum[u+f*j,x]+f*k*Sqrt[ExpandToSum[v,x]])^n,x] /;
FreeQ[{f,j,k,m,n},x] && LinearQ[u,x] && QuadraticQ[{v,w},x] && 
  Not[LinearMatchQ[u,x] && QuadraticMatchQ[{v,w},x] && (EqQ[j,0] || EqQ[f,1])] && 
  EqQ[Coefficient[u,x,1]^2-Coefficient[v,x,2]*f^2*k^2,0]


(* ::Code:: *)
Int[1/((a_+b_.*x_^n_.)*Sqrt[c_.*x_^2+d_.*(a_+b_.*x_^n_.)^p_.]),x_Symbol] :=
  1/a \[Star] Subst[Int[1/(1-c*x^2),x],x,x/Sqrt[c*x^2+d*(a+b*x^n)^(2/n)]] /;
FreeQ[{a,b,c,d,n},x] && EqQ[p,2/n]


(* ::Code:: *)
Int[Sqrt[a_+b_.*Sqrt[c_+d_.*x_^2]],x_Symbol] :=
  2*b^2*d*x^3/(3*(a+b*Sqrt[c+d*x^2])^(3/2)) + 2*a*x/Sqrt[a+b*Sqrt[c+d*x^2]] /;
FreeQ[{a,b,c,d},x] && EqQ[a^2-b^2*c,0]


(* ::Code:: *)
Int[Sqrt[a_.*x_^2+b_.*x_*Sqrt[c_+d_.*x_^2]]/(x_*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  Sqrt[2]*b/a \[Star] Subst[Int[1/Sqrt[1+x^2/a],x],x,a*x+b*Sqrt[c+d*x^2]] /;
FreeQ[{a,b,c,d},x] && EqQ[a^2-b^2*d,0] && EqQ[b^2*c+a,0]


(* ::Code:: *)
Int[Sqrt[e_.*x_*(a_.*x_+b_.*Sqrt[c_+d_.*x_^2])]/(x_*Sqrt[c_+d_.*x_^2]),x_Symbol] :=
  Int[Sqrt[a*e*x^2+b*e*x*Sqrt[c+d*x^2]]/(x*Sqrt[c+d*x^2]),x] /;
FreeQ[{a,b,c,d,e},x] && EqQ[a^2-b^2*d,0] && EqQ[b^2*c*e+a,0]


(* ::Code:: *)
Int[Sqrt[c_.*x_^2+d_.*Sqrt[a_+b_.*x_^4]]/Sqrt[a_+b_.*x_^4],x_Symbol] :=
  d \[Star] Subst[Int[1/(1-2*c*x^2),x],x,x/Sqrt[c*x^2+d*Sqrt[a+b*x^4]]] /;
FreeQ[{a,b,c,d},x] && EqQ[c^2-b*d^2,0]


(* ::Code:: *)
Int[(c_.+d_.*x_)^m_.*Sqrt[b_.*x_^2+Sqrt[a_+e_.*x_^4]]/Sqrt[a_+e_.*x_^4],x_Symbol] :=
  (1-I)/2 \[Star] Int[(c+d*x)^m/Sqrt[Sqrt[a]-I*b*x^2],x] +
  (1+I)/2 \[Star] Int[(c+d*x)^m/Sqrt[Sqrt[a]+I*b*x^2],x] /;
FreeQ[{a,b,c,d,m},x] && EqQ[e,b^2] && GtQ[a,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  2/(3*c) \[Star] Int[1/Sqrt[a+b*x^3],x] + 1/(3*c) \[Star] Int[(c-2*d*x)/((c+d*x)*Sqrt[a+b*x^3]),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^3-4*a*d^3,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  -6*a*d^3/(c*(b*c^3-28*a*d^3)) \[Star] Int[1/Sqrt[a+b*x^3],x] + 
  1/(c*(b*c^3-28*a*d^3)) \[Star] Int[Simp[c*(b*c^3-22*a*d^3)+6*a*d^4*x,x]/((c+d*x)*Sqrt[a+b*x^3]),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b^2*c^6-20*a*b*c^3*d^3-8*a^2*d^6,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  With[{q=Rt[b/a,3]},
  -q/((1+Sqrt[3])*d-c*q) \[Star] Int[1/Sqrt[a+b*x^3],x] + 
  d/((1+Sqrt[3])*d-c*q) \[Star] Int[(1+Sqrt[3]+q*x)/((c+d*x)*Sqrt[a+b*x^3]),x]] /;
FreeQ[{a,b,c,d},x] && NeQ[b^2*c^6-20*a*b*c^3*d^3-8*a^2*d^6,0]


(* ::Code:: *)
Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  2*e/d \[Star] Subst[Int[1/(1+3*a*x^2),x],x,(1+2*d*x/c)/Sqrt[a+b*x^3]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b*c^3-4*a*d^3,0] && EqQ[2*d*e+c*f,0]


(* ::Code:: *)
Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  -2*e/d \[Star] Subst[Int[1/(9-a*x^2),x],x,(1+f*x/e)^2/Sqrt[a+b*x^3]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b*c^3+8*a*d^3,0] && EqQ[2*d*e+c*f,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  (2*d*e+c*f)/(3*c*d) \[Star] Int[1/Sqrt[a+b*x^3],x] + 
  (d*e-c*f)/(3*c*d) \[Star] Int[(c-2*d*x)/((c+d*x)*Sqrt[a+b*x^3]),x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && (EqQ[b*c^3-4*a*d^3,0] || EqQ[b*c^3+8*a*d^3,0]) && NeQ[2*d*e+c*f,0]


(* ::Code:: *)
Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  With[{k=Simplify[(d*e+2*c*f)/(c*f)]},
  (1+k)*e/d \[Star] Subst[Int[1/(1+(3+2*k)*a*x^2),x],x,(1+(1+k)*d*x/c)/Sqrt[a+b*x^3]]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b^2*c^6-20*a*b*c^3*d^3-8*a^2*d^6,0] && EqQ[6*a*d^4*e-c*f*(b*c^3-22*a*d^3),0]


(* ::Code:: *)
Int[(e_.+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  -(6*a*d^4*e-c*f*(b*c^3-22*a*d^3))/(c*d*(b*c^3-28*a*d^3)) \[Star] Int[1/Sqrt[a+b*x^3],x] + 
  (d*e-c*f)/(c*d*(b*c^3-28*a*d^3)) \[Star] Int[(c*(b*c^3-22*a*d^3)+6*a*d^4*x)/((c+d*x)*Sqrt[a+b*x^3]),x] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b^2*c^6-20*a*b*c^3*d^3-8*a^2*d^6,0] && NeQ[6*a*d^4*e-c*f*(b*c^3-22*a*d^3),0]


(* ::Code:: *)
(* Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  With[{q=(1+Sqrt[3])*f/e},
  4*3^(1/4)*Sqrt[2-Sqrt[3]]*f*(1+Sqrt[3]+q*x)^2*Sqrt[(1+q^3*x^3)/(1+Sqrt[3]+q*x)^4]/(q*Sqrt[a+b*x^3]) \[Star] 
    Subst[Int[1/(((1-Sqrt[3])*d-c*q+((1+Sqrt[3])*d-c*q)*x)*
      Sqrt[7-4*Sqrt[3]-2*(3-2*Sqrt[3])*x^2-x^4]),x],x,(-1+Sqrt[3]-q*x)/(1+Sqrt[3]+q*x)]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b*e^3-2*(5+3*Sqrt[3])*a*f^3,0] && NeQ[b*c^3-2*(5-3*Sqrt[3])*a*d^3,0] *)


(* ::Code:: *)
Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  With[{q=Simplify[(1+Sqrt[3])*f/e]},
  4*3^(1/4)*Sqrt[2-Sqrt[3]]*f*(1+q*x)*Sqrt[(1-q*x+q^2*x^2)/(1+Sqrt[3]+q*x)^2]/
    (q*Sqrt[a+b*x^3]*Sqrt[(1+q*x)/(1+Sqrt[3]+q*x)^2]) \[Star] 
    Subst[Int[1/(((1-Sqrt[3])*d-c*q+((1+Sqrt[3])*d-c*q)*x)*Sqrt[1-x^2]*Sqrt[7-4*Sqrt[3]+x^2]),x],x,(-1+Sqrt[3]-q*x)/(1+Sqrt[3]+q*x)]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b*e^3-2*(5+3*Sqrt[3])*a*f^3,0] && NeQ[b*c^3-2*(5-3*Sqrt[3])*a*d^3,0]


(* ::Code:: *)
Int[(e_+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  With[{q=Simplify[(-1+Sqrt[3])*f/e]},
  4*3^(1/4)*Sqrt[2+Sqrt[3]]*f*(1-q*x)*Sqrt[(1+q*x+q^2*x^2)/(1-Sqrt[3]-q*x)^2]/(q*Sqrt[a+b*x^3]*Sqrt[-(1-q*x)/(1-Sqrt[3]-q*x)^2]) \[Star] 
    Subst[Int[1/(((1+Sqrt[3])*d+c*q+((1-Sqrt[3])*d+c*q)*x)*Sqrt[1-x^2]*Sqrt[7+4*Sqrt[3]+x^2]),x],x,(1+Sqrt[3]-q*x)/(-1+Sqrt[3]+q*x)]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && EqQ[b*e^3-2*(5-3*Sqrt[3])*a*f^3,0] && NeQ[b*c^3-2*(5+3*Sqrt[3])*a*d^3,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)/((c_+d_.*x_)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  With[{q=Rt[b/a,3]},
  ((1+Sqrt[3])*f-e*q)/((1+Sqrt[3])*d-c*q) \[Star] Int[1/Sqrt[a+b*x^3],x] + 
  (d*e-c*f)/((1+Sqrt[3])*d-c*q) \[Star] Int[(1+Sqrt[3]+q*x)/((c+d*x)*Sqrt[a+b*x^3]),x]] /;
FreeQ[{a,b,c,d,e,f},x] && NeQ[d*e-c*f,0] && NeQ[b^2*c^6-20*a*b*c^3*d^3-8*a^2*d^6,0] && NeQ[b^2*e^6-20*a*b*e^3*f^3-8*a^2*f^6,0]


(* ::Code:: *)
Int[(f_+g_.*x_+h_.*x_^2)/((c_+d_.*x_+e_.*x_^2)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  -2*g*h \[Star] Subst[Int[1/(2*e*h-(b*d*f-2*a*e*h)*x^2),x],x,(1+2*h*x/g)/Sqrt[a+b*x^3]] /;
FreeQ[{a,b,c,d,e,f,g,h},x] && NeQ[b*d*f-2*a*e*h,0] && EqQ[b*g^3-8*a*h^3,0] && EqQ[g^2+2*f*h,0] && EqQ[b*d*f+b*c*g-4*a*e*h,0]


(* ::Code:: *)
Int[(f_+g_.*x_+h_.*x_^2)/((c_+e_.*x_^2)*Sqrt[a_+b_.*x_^3]),x_Symbol] :=
  -g/e \[Star] Subst[Int[1/(1+a*x^2),x],x,(1+2*h*x/g)/Sqrt[a+b*x^3]] /;
FreeQ[{a,b,c,e,f,g,h},x] && EqQ[b*g^3-8*a*h^3,0] && EqQ[g^2+2*f*h,0] && EqQ[b*c*g-4*a*e*h,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^3]/(c_+d_.*x_),x_Symbol] :=
  b/d \[Star] Int[x^2/Sqrt[a+b*x^3],x] + 
  b*c/d^3 \[Star] Int[(c-d*x)/Sqrt[a+b*x^3],x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^3-a*d^3,0]


(* ::Code:: *)
Int[Sqrt[a_+b_.*x_^3]/(c_+d_.*x_),x_Symbol] :=
  b/d \[Star] Int[x^2/Sqrt[a+b*x^3],x] + 
  b*c/d^3 \[Star] Int[(c-d*x)/Sqrt[a+b*x^3],x] - 
  (b*c^3-a*d^3)/d^3 \[Star] Int[1/((c+d*x)*Sqrt[a+b*x^3]),x] /;
FreeQ[{a,b,c,d},x] && NeQ[b*c^3-a*d^3,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^3)^(1/3)),x_Symbol] :=
  Sqrt[3]*ArcTan[(1-2^(1/3)*Rt[b,3]*(c-d*x)/(d*(a+b*x^3)^(1/3)))/Sqrt[3]]/(2^(4/3)*Rt[b,3]*c) + 
  Log[(c+d*x)^2*(c-d*x)]/(2^(7/3)*Rt[b,3]*c) - 
  (3*Log[Rt[b,3]*(c-d*x)+2^(2/3)*d*(a+b*x^3)^(1/3)])/(2^(7/3)*Rt[b,3]*c) /;
FreeQ[{a,b,c,d},x] && EqQ[b*c^3+a*d^3,0]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^3)^(1/3)),x_Symbol] :=
  1/(2*c) \[Star] Int[1/(a+b*x^3)^(1/3),x] + 1/(2*c) \[Star] Int[(c-d*x)/((c+d*x)*(a+b*x^3)^(1/3)),x] /;
FreeQ[{a,b,c,d},x] && EqQ[2*b*c^3-a*d^3,0]


(* ::Code:: *)
Int[(e_+f_.*x_)/((c_+d_.*x_)*(a_+b_.*x_^3)^(1/3)),x_Symbol] :=
  Sqrt[3]*f*ArcTan[(1+2*Rt[b,3]*(2*c+d*x)/(d*(a+b*x^3)^(1/3)))/Sqrt[3]]/(Rt[b,3]*d) + 
  (f*Log[c+d*x])/(Rt[b,3]*d) - 
  (3*f*Log[Rt[b,3]*(2*c+d*x)-d*(a+b*x^3)^(1/3)])/(2*Rt[b,3]*d) /;
FreeQ[{a,b,c,d,e,f},x] && EqQ[d*e+c*f,0] && EqQ[2*b*c^3-a*d^3,0]


(* ::Code:: *)
Int[(e_.+f_.*x_)/((c_.+d_.*x_)*(a_+b_.*x_^3)^(1/3)),x_Symbol] :=
  f/d \[Star] Int[1/(a+b*x^3)^(1/3),x] + (d*e-c*f)/d \[Star] Int[1/((c+d*x)*(a+b*x^3)^(1/3)),x] /;
FreeQ[{a,b,c,d,e,f},x]


(* ::Code:: *)
Int[(a_+b_.*x_^3)^(2/3)/(c_+d_.*x_),x_Symbol] :=
  (a+b*x^3)^(2/3)/(2*d) - 
  b*c/d^2 \[Star] Int[x/(a+b*x^3)^(1/3),x] + 
  1/d^2 \[Star] Int[(a*d^2+b*c^2*x)/((c+d*x)*(a+b*x^3)^(1/3)),x] /;
FreeQ[{a,b,c,d},x]


(* ::Code:: *)
Int[1/((c_+d_.*x_)*(a_+b_.*x_^3)^(2/3)),x_Symbol] :=
  With[{q=Rt[b,3]},
  -d*ArcTan[(1+2*q*x/(a+b*x^3)^(1/3))/Sqrt[3]]/(2*Sqrt[3]*q^2*c^2) + 
  Sqrt[3]*d*ArcTan[(1+2*q*(2*c+d*x)/(d*(a+b*x^3)^(1/3)))/Sqrt[3]]/(2*q^2*c^2) - 
  d*Log[c+d*x]/(2*q^2*c^2) - 
  d*Log[q*x-(a+b*x^3)^(1/3)]/(4*q^2*c^2) + 
  3*d*Log[q*(2*c+d*x)-d*(a+b*x^3)^(1/3)]/(4*q^2*c^2)] /;
FreeQ[{a,b,c,d},x] && EqQ[2*b*c^3-a*d^3,0]


(* ::Code:: *)
Int[x_^m_.*Px_*(c_+d_.*x_)^q_*(a_+b_.*x_^3)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(c^3+d^3*x^3)^q*(a+b*x^3)^p,x^m*Px/(c^2-c*d*x+d^2*x^2)^q,x],x] /;
FreeQ[{a,b,c,d,m,p},x] && PolyQ[Px,x] && ILtQ[q,0] && IntegerQ[m] && RationalQ[p] && EqQ[Denominator[p],3]


(* ::Code:: *)
Int[Px_.*(c_+d_.*x_)^q_*(a_+b_.*x_^3)^p_.,x_Symbol] :=
  Int[ExpandIntegrand[(c^3+d^3*x^3)^q*(a+b*x^3)^p,Px/(c^2-c*d*x+d^2*x^2)^q,x],x] /;
FreeQ[{a,b,c,d,p},x] && PolyQ[Px,x] && ILtQ[q,0] && RationalQ[p] && EqQ[Denominator[p],3]


(* ::Code:: *)
Int[x_^m_.*Px_*(c_+d_.*x_+e_.*x_^2)^q_*(a_+b_.*x_^3)^p_.,x_Symbol] :=
  1/c^q \[Star] Int[ExpandIntegrand[(c^3-d^3*x^3)^q*(a+b*x^3)^p,x^m*Px/(c-d*x)^q,x],x] /;
FreeQ[{a,b,c,d,e,m,p},x] && PolyQ[Px,x] && EqQ[d^2-c*e,0] && ILtQ[q,0] && IntegerQ[m] && RationalQ[p] && EqQ[Denominator[p],3]


(* ::Code:: *)
Int[Px_.*(c_+d_.*x_+e_.*x_^2)^q_*(a_+b_.*x_^3)^p_.,x_Symbol] :=
  1/c^q \[Star] Int[ExpandIntegrand[(c^3-d^3*x^3)^q*(a+b*x^3)^p,Px/(c-d*x)^q,x],x] /;
FreeQ[{a,b,c,d,e,p},x] && PolyQ[Px,x] && EqQ[d^2-c*e,0] && ILtQ[q,0] && RationalQ[p] && EqQ[Denominator[p],3]


(* ::Code:: *)
Int[(c_+d_.*x_^n_.)^q_*(a_+b_.*x_^nn_.)^p_,x_Symbol] :=
  Int[ExpandToSum[(c-d*x^n)^(-q),x]*(a+b*x^nn)^p/(c^2-d^2*x^(2*n))^(-q),x] /;
FreeQ[{a,b,c,d,n,nn,p},x] && Not[IntegerQ[p]] && ILtQ[q,0] && IGtQ[Log[2,nn/n],0]


(* ::Code:: *)
Int[(e_.*x_)^m_.*(c_+d_.*x_^n_.)^q_*(a_+b_.*x_^nn_.)^p_,x_Symbol] :=
  (e*x)^m/x^m \[Star] Int[x^m*ExpandToSum[(c-d*x^n)^(-q),x]*(a+b*x^nn)^p/(c^2-d^2*x^(2*n))^(-q),x] /;
FreeQ[{a,b,c,d,e,m,n,nn,p},x] && Not[IntegerQ[p]] && ILtQ[q,0] && IGtQ[Log[2,nn/n],0]


(* ::Code:: *)
Int[x_^m_./(c_+d_.*x_^n_+e_.*Sqrt[a_+b_.*x_^n_]),x_Symbol] :=
  1/n \[Star] Subst[Int[x^((m+1)/n-1)/(c+d*x+e*Sqrt[a+b*x]),x],x,x^n] /;
FreeQ[{a,b,c,d,e,m,n},x] && EqQ[b*c-a*d,0] && IntegerQ[(m+1)/n]


(* ::Code:: *)
Int[u_./(c_+d_.*x_^n_+e_.*Sqrt[a_+b_.*x_^n_]),x_Symbol] :=
  c \[Star] Int[u/(c^2-a*e^2+c*d*x^n),x] - a*e \[Star] Int[u/((c^2-a*e^2+c*d*x^n)*Sqrt[a+b*x^n]),x] /;
FreeQ[{a,b,c,d,e,n},x] && EqQ[b*c-a*d,0]




(*FILE: 
Rubi/IntegrationRules/2 Exponentials/2.1 (c+d x)^m (a+b (F^(g (e+f x)))^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 2.1 (c+d x)^m (a+b (F^(g (e+f x)))^n)^p *)
$UseGamma = False;
Int[(c_. + d_.*x_)^m_.*(b_.*F_^(g_.*(e_. + f_.*x_)))^n_., x_Symbol] := (c + d*x)^m*(b*F^(g*(e + f*x)))^n/(f*g*n*Log[F]) - d*m/(f*g*n*Log[F])* Int[(c + d*x)^(m - 1)*(b*F^(g*(e + f*x)))^n, x] /; FreeQ[{F, b, c, d, e, f, g, n}, x] && GtQ[m, 0] && IntegerQ[2*m] && Not[TrueQ[$UseGamma]]
Int[(c_. + d_.*x_)^m_*(b_.*F_^(g_.*(e_. + f_.*x_)))^n_., x_Symbol] := (c + d*x)^(m + 1)*(b*F^(g*(e + f*x)))^n/(d*(m + 1)) - f*g*n*Log[F]/(d*(m + 1))* Int[(c + d*x)^(m + 1)*(b*F^(g*(e + f*x)))^n, x] /; FreeQ[{F, b, c, d, e, f, g, n}, x] && LtQ[m, -1] && IntegerQ[2*m] && Not[TrueQ[$UseGamma]]
Int[F_^(g_.*(e_. + f_.*x_))/(c_. + d_.*x_), x_Symbol] := F^(g*(e - c*f/d))/d*ExpIntegralEi[f*g*(c + d*x)*Log[F]/d] /; FreeQ[{F, c, d, e, f, g}, x] && Not[TrueQ[$UseGamma]]
Int[(c_. + d_.*x_)^m_.*F_^(g_.*(e_. + f_.*x_)), x_Symbol] := (-d)^m*F^(g*(e - c*f/d))/(f^(m + 1)*g^(m + 1)*Log[F]^(m + 1))* Gamma[m + 1, -f*g*Log[F]/d*(c + d*x)] /; FreeQ[{F, c, d, e, f, g}, x] && IntegerQ[m]
Int[F_^(g_.*(e_. + f_.*x_))/Sqrt[c_. + d_.*x_], x_Symbol] := 2/d*Subst[Int[F^(g*(e - c*f/d) + f*g*x^2/d), x], x, Sqrt[c + d*x]] /; FreeQ[{F, c, d, e, f, g}, x] && Not[TrueQ[$UseGamma]]
Int[(c_. + d_.*x_)^m_*F_^(g_.*(e_. + f_.*x_)), x_Symbol] := -F^(g*(e - c*f/d))*(c + d*x)^ FracPart[ m]/(d*(-f*g*Log[F]/d)^(IntPart[m] + 1)*(-f*g* Log[F]*(c + d*x)/d)^FracPart[m])* Gamma[m + 1, (-f*g*Log[F]/d)*(c + d*x)] /; FreeQ[{F, c, d, e, f, g, m}, x] && Not[IntegerQ[m]]
Int[(c_. + d_.*x_)^m_.*(b_.*F_^(g_.*(e_. + f_.*x_)))^n_, x_Symbol] := (b*F^(g*(e + f*x)))^n/F^(g*n*(e + f*x))* Int[(c + d*x)^m*F^(g*n*(e + f*x)), x] /; FreeQ[{F, b, c, d, e, f, g, m, n}, x]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_., x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*(F^(g*(e + f*x)))^n)^p, x], x] /; FreeQ[{F, a, b, c, d, e, f, g, m, n}, x] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.), x_Symbol] := (c + d*x)^(m + 1)/(a*d*(m + 1)) - b/a*Int[(c + d*x)^ m*(F^(g*(e + f*x)))^n/(a + b*(F^(g*(e + f*x)))^n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && IGtQ[m, 0]
(* Int[(c_.+d_.*x_)^m_./(a_+b_.*(F_^(g_.*(e_.+f_.*x_)))^n_.),x_Symbol]  := -(c+d*x)^m/(a*f*g*n*Log[F])*Log[1+a/(b*(F^(g*(e+f*x)))^n)] + d*m/(a*f*g*n*Log[F])*Int[(c+d*x)^(m-1)*Log[1+a/(b*(F^(g*(e+f*x)))^n) ],x] /; FreeQ[{F,a,b,c,d,e,f,g,n},x] && IGtQ[m,0] *)
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_, x_Symbol] := 1/a*Int[(c + d*x)^m*(a + b*(F^(g*(e + f*x)))^n)^(p + 1), x] - b/a* Int[(c + d*x)^m*(F^(g*(e + f*x)))^n*(a + b*(F^(g*(e + f*x)))^n)^p, x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && ILtQ[p, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_, x_Symbol] := With[{u = IntHide[(a + b*(F^(g*(e + f*x)))^n)^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && IGtQ[m, 0] && LtQ[p, -1]
Int[u_^m_.*(a_. + b_.*(F_^(g_.*v_))^n_.)^p_., x_Symbol] := Int[NormalizePowerOfLinear[u, x]^ m*(a + b*(F^(g*ExpandToSum[v, x]))^n)^p, x] /; FreeQ[{F, a, b, g, n, p}, x] && LinearQ[v, x] && PowerOfLinearQ[u, x] && Not[LinearMatchQ[v, x] && PowerOfLinearMatchQ[u, x]] && IntegerQ[m]
Int[u_^m_.*(a_. + b_.*(F_^(g_.*v_))^n_.)^p_., x_Symbol] := Module[{uu = NormalizePowerOfLinear[u, x], z}, z = If[PowerQ[uu] && FreeQ[uu[[2]], x], uu[[1]]^(m*uu[[2]]), uu^m]; uu^m/z*Int[z*(a + b*(F^(g*ExpandToSum[v, x]))^n)^p, x]] /; FreeQ[{F, a, b, g, m, n, p}, x] && LinearQ[v, x] && PowerOfLinearQ[u, x] && Not[LinearMatchQ[v, x] && PowerOfLinearMatchQ[u, x]] && Not[IntegerQ[m]]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_., x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*(F^(g*(e + f*x)))^n)^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/2 Exponentials/2.2 (c+d x)^m (F^(g (e+f x)))^n (a+b (F^(g (e+f x)))^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 2.2 (c+d x)^m (F^(g (e+f x)))^n (a+b (F^(g (e+f x)))^n)^p *)
Int[(c_. + d_.*x_)^ m_.*(F_^(g_.*(e_. + f_.*x_)))^ n_./(a_ + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.), x_Symbol] := (c + d*x)^m/(b*f*g*n*Log[F])*Log[1 + b*(F^(g*(e + f*x)))^n/a] - d*m/(b*f*g*n*Log[F])* Int[(c + d*x)^(m - 1)*Log[1 + b*(F^(g*(e + f*x)))^n/a], x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(F_^(g_.*(e_. + f_.*x_)))^ n_.*(a_. + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_., x_Symbol] := (c + d*x)^ m*(a + b*(F^(g*(e + f*x)))^n)^(p + 1)/(b*f*g*n*(p + 1)* Log[F]) - d*m/(b*f*g*n*(p + 1)*Log[F])* Int[(c + d*x)^(m - 1)*(a + b*(F^(g*(e + f*x)))^n)^(p + 1), x] /; FreeQ[{F, a, b, c, d, e, f, g, m, n, p}, x] && NeQ[p, -1]
Int[(c_. + d_.*x_)^m_.*(F_^(g_.*(e_. + f_.*x_)))^ n_.*(a_. + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_., x_Symbol] := Unintegrable[(c + d*x)^m*(F^(g*(e + f*x)))^ n*(a + b*(F^(g*(e + f*x)))^n)^p, x] /; FreeQ[{F, a, b, c, d, e, f, g, m, n, p}, x]
Int[(c_. + d_.*x_)^m_.*(k_.*G_^(j_.*(h_. + i_.*x_)))^ q_.*(a_. + b_.*(F_^(g_.*(e_. + f_.*x_)))^n_.)^p_., x_Symbol] := (k*G^(j*(h + i*x)))^q/(F^(g*(e + f*x)))^n* Int[(c + d*x)^m*(F^(g*(e + f*x)))^n*(a + b*(F^(g*(e + f*x)))^n)^p, x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i, j, k, m, n, p, q}, x] && EqQ[f*g*n*Log[F] - i*j*q*Log[G], 0] && NeQ[(k*G^(j*(h + i*x)))^q - (F^(g*(e + f*x)))^n, 0]

(*FILE: 
Rubi/IntegrationRules/2 Exponentials/2.3 Miscellaneous exponentials.m
*)

(* ::Subsection::Closed:: *)
(* 2.3 Miscellaneous exponentials *)
Int[(F_^(c_.*(a_. + b_.*x_)))^n_., x_Symbol] := (F^(c*(a + b*x)))^n/(b*c*n*Log[F]) /; FreeQ[{F, a, b, c, n}, x]
Int[u_*F_^(c_.*v_), x_Symbol] := Int[ExpandIntegrand[u*F^(c*ExpandToSum[v, x]), x], x] /; FreeQ[{F, c}, x] && PolynomialQ[u, x] && LinearQ[v, x] && TrueQ[$UseGamma]
Int[u_*F_^(c_.*v_), x_Symbol] := Int[ExpandIntegrand[F^(c*ExpandToSum[v, x]), u, x], x] /; FreeQ[{F, c}, x] && PolynomialQ[u, x] && LinearQ[v, x] && Not[TrueQ[$UseGamma]]
Int[u_^m_.*F_^(c_.*v_)*w_, x_Symbol] := With[{b = Coefficient[v, x, 1], d = Coefficient[u, x, 0], e = Coefficient[u, x, 1], f = Coefficient[w, x, 0], g = Coefficient[w, x, 1]}, g*u^(m + 1)*F^(c*v)/(b*c*e*Log[F]) /; EqQ[e*g*(m + 1) - b*c*(e*f - d*g)*Log[F], 0]] /; FreeQ[{F, c, m}, x] && LinearQ[{u, v, w}, x]
Int[w_*u_^m_.*F_^(c_.*v_), x_Symbol] := Int[ExpandIntegrand[ w*NormalizePowerOfLinear[u, x]^m*F^(c*ExpandToSum[v, x]), x], x] /; FreeQ[{F, c}, x] && PolynomialQ[w, x] && LinearQ[v, x] && PowerOfLinearQ[u, x] && IntegerQ[m] && TrueQ[$UseGamma]
Int[w_*u_^m_.*F_^(c_.*v_), x_Symbol] := Int[ExpandIntegrand[F^(c*ExpandToSum[v, x]), w*NormalizePowerOfLinear[u, x]^m, x], x] /; FreeQ[{F, c}, x] && PolynomialQ[w, x] && LinearQ[v, x] && PowerOfLinearQ[u, x] && IntegerQ[m] && Not[TrueQ[$UseGamma]]
Int[w_*u_^m_.*F_^(c_.*v_), x_Symbol] := Module[{uu = NormalizePowerOfLinear[u, x], z}, z = If[PowerQ[uu] && FreeQ[uu[[2]], x], uu[[1]]^(m*uu[[2]]), uu^m]; uu^m/z*Int[ExpandIntegrand[w*z*F^(c*ExpandToSum[v, x]), x], x]] /; FreeQ[{F, c, m}, x] && PolynomialQ[w, x] && LinearQ[v, x] && PowerOfLinearQ[u, x] && Not[IntegerQ[m]]
Int[F_^(c_.*(a_. + b_.*x_))* Log[d_.*x_]^n_.*(e_ + h_.*(f_. + g_.*x_)*Log[d_.*x_]), x_Symbol] := e*x*F^(c*(a + b*x))*Log[d*x]^(n + 1)/(n + 1) /; FreeQ[{F, a, b, c, d, e, f, g, h, n}, x] && EqQ[e - f*h*(n + 1), 0] && EqQ[g*h*(n + 1) - b*c*e*Log[F], 0] && NeQ[n, -1]
Int[x_^m_.*F_^(c_.*(a_. + b_.*x_))* Log[d_.*x_]^n_.*(e_ + h_.*(f_. + g_.*x_)*Log[d_.*x_]), x_Symbol] := e*x^(m + 1)*F^(c*(a + b*x))*Log[d*x]^(n + 1)/(n + 1) /; FreeQ[{F, a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*(m + 1) - f*h*(n + 1), 0] && EqQ[g*h*(n + 1) - b*c*e*Log[F], 0] && NeQ[n, -1]
Int[F_^(a_. + b_.*(c_. + d_.*x_)), x_Symbol] := F^(a + b*(c + d*x))/(b*d*Log[F]) /; FreeQ[{F, a, b, c, d}, x]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^2), x_Symbol] := F^a*Sqrt[Pi]* Erfi[(c + d*x)*Rt[b*Log[F], 2]]/(2*d*Rt[b*Log[F], 2]) /; FreeQ[{F, a, b, c, d}, x] && PosQ[b]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^2), x_Symbol] := F^a*Sqrt[Pi]* Erf[(c + d*x)*Rt[-b*Log[F], 2]]/(2*d*Rt[-b*Log[F], 2]) /; FreeQ[{F, a, b, c, d}, x] && NegQ[b]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (c + d*x)*F^(a + b*(c + d*x)^n)/d - b*n*Log[F]*Int[(c + d*x)^n*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d}, x] && IntegerQ[2/n] && ILtQ[n, 0]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := With[{k = Denominator[n]}, k/d* Subst[Int[x^(k - 1)*F^(a + b*x^(k*n)), x], x, (c + d*x)^(1/k)]] /; FreeQ[{F, a, b, c, d}, x] && IntegerQ[2/n] && Not[IntegerQ[n]]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := -F^a*(c + d*x)* Gamma[1/n, -b*(c + d*x)^n*Log[F]]/(d* n*(-b*(c + d*x)^n*Log[F])^(1/n)) /; FreeQ[{F, a, b, c, d, n}, x] && Not[IntegerQ[2/n]]
Int[(e_. + f_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (e + f*x)^n*F^(a + b*(c + d*x)^n)/(b*f*n*(c + d*x)^n*Log[F]) /; FreeQ[{F, a, b, c, d, e, f, n}, x] && EqQ[m, n - 1] && EqQ[d*e - c*f, 0]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^n_)/(e_. + f_.*x_), x_Symbol] := F^a*ExpIntegralEi[b*(c + d*x)^n*Log[F]]/(f*n) /; FreeQ[{F, a, b, c, d, e, f, n}, x] && EqQ[d*e - c*f, 0]
Int[(c_. + d_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := 1/(d*(m + 1))*Subst[Int[F^(a + b*x^2), x], x, (c + d*x)^(m + 1)] /; FreeQ[{F, a, b, c, d, m, n}, x] && EqQ[n, 2*(m + 1)]
Int[(c_. + d_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (c + d*x)^(m - n + 1)*F^(a + b*(c + d*x)^n)/(b*d*n*Log[F]) - (m - n + 1)/(b*n*Log[F])* Int[(c + d*x)^(m - n)*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d}, x] && IntegerQ[2*(m + 1)/n] && LtQ[0, (m + 1)/n, 5] && IntegerQ[n] && (LtQ[0, n, m + 1] || LtQ[m, n, 0])
Int[(c_. + d_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (c + d*x)^(m - n + 1)*F^(a + b*(c + d*x)^n)/(b*d*n*Log[F]) - (m - n + 1)/(b*n*Log[F])* Int[(c + d*x)^Simplify[m - n]*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d, m, n}, x] && IntegerQ[2*Simplify[(m + 1)/n]] && LtQ[0, Simplify[(m + 1)/n], 5] && Not[RationalQ[m]] && SumSimplerQ[m, -n]
Int[(c_. + d_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (c + d*x)^(m + 1)*F^(a + b*(c + d*x)^n)/(d*(m + 1)) - b*n*Log[F]/(m + 1)* Int[(c + d*x)^(m + n)*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d}, x] && IntegerQ[2*(m + 1)/n] && LtQ[-4, (m + 1)/n, 5] && IntegerQ[ n] && (GtQ[n, 0] && LtQ[m, -1] || GtQ[-n, 0] && LeQ[-n, m + 1])
Int[(c_. + d_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (c + d*x)^(m + 1)*F^(a + b*(c + d*x)^n)/(d*(m + 1)) - b*n*Log[F]/(m + 1)* Int[(c + d*x)^Simplify[m + n]*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d, m, n}, x] && IntegerQ[2*Simplify[(m + 1)/n]] && LtQ[-4, Simplify[(m + 1)/n], 5] && Not[RationalQ[m]] && SumSimplerQ[m, n]
Int[(c_. + d_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := With[{k = Denominator[n]}, k/d* Subst[Int[x^(k*(m + 1) - 1)*F^(a + b*x^(k*n)), x], x, (c + d*x)^(1/k)]] /; FreeQ[{F, a, b, c, d, m, n}, x] && IntegerQ[2*(m + 1)/n] && LtQ[0, (m + 1)/n, 5] && Not[IntegerQ[n]]
Int[(e_. + f_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (e + f*x)^m/(c + d*x)^m*Int[(c + d*x)^m*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d, e, f, m, n}, x] && EqQ[d*e - c*f, 0] && IntegerQ[2*Simplify[(m + 1)/n]] && Not[IntegerQ[m]] && NeQ[f, d] && NeQ[c*e, 0]
Int[(e_. + f_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := With[{p = Simplify[(m + 1)/n]}, -F^a*(f/d)^m/(d*n*(-b*Log[F])^p)* Simplify[FunctionExpand[Gamma[p, -b*(c + d*x)^n*Log[F]]]] /; IGtQ[p, 0]] /; FreeQ[{F, a, b, c, d, e, f, m, n}, x] && EqQ[d*e - c*f, 0] && Not[TrueQ[$UseGamma]]
Int[(e_. + f_.*x_)^m_.*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (*-F^a*(e+f*x)^(m+1)/(f*n)*ExpIntegralE[1-(m+1)/n,-b*(c+d*x)^n*Log[F] ] *) -F^a*(e + f*x)^(m + 1)/(f*n*(-b*(c + d*x)^n*Log[F])^((m + 1)/n))* Gamma[(m + 1)/n, -b*(c + d*x)^n*Log[F]] /; FreeQ[{F, a, b, c, d, e, f, m, n}, x] && EqQ[d*e - c*f, 0]
Int[(e_. + f_.*x_)^m_*F_^(a_. + b_.*(c_. + d_.*x_)^2), x_Symbol] := f*(e + f*x)^(m - 1)*F^(a + b*(c + d*x)^2)/(2*b*d^2*Log[F]) + (d*e - c*f)/d*Int[(e + f*x)^(m - 1)*F^(a + b*(c + d*x)^2), x] - (m - 1)*f^2/(2*b*d^2*Log[F])* Int[(e + f*x)^(m - 2)*F^(a + b*(c + d*x)^2), x] /; FreeQ[{F, a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && FractionQ[m] && GtQ[m, 1]
Int[(e_. + f_.*x_)^m_*F_^(a_. + b_.*(c_. + d_.*x_)^2), x_Symbol] := f*(e + f*x)^(m + 1)*F^(a + b*(c + d*x)^2)/((m + 1)*f^2) + 2*b*d*(d*e - c*f)*Log[F]/(f^2*(m + 1))* Int[(e + f*x)^(m + 1)*F^(a + b*(c + d*x)^2), x] - 2*b*d^2*Log[F]/(f^2*(m + 1))* Int[(e + f*x)^(m + 2)*F^(a + b*(c + d*x)^2), x] /; FreeQ[{F, a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && LtQ[m, -1]
Int[(e_. + f_.*x_)^m_*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := (e + f*x)^(m + 1)*F^(a + b*(c + d*x)^n)/(f*(m + 1)) - b*d*n*Log[F]/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(c + d*x)^(n - 1)*F^(a + b*(c + d*x)^n), x] /; FreeQ[{F, a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && IGtQ[n, 2] && LtQ[m, -1]
Int[F_^(a_. + b_./(c_. + d_.*x_))/(e_. + f_.*x_), x_Symbol] := d/f*Int[F^(a + b/(c + d*x))/(c + d*x), x] - (d*e - c*f)/f*Int[F^(a + b/(c + d*x))/((c + d*x)*(e + f*x)), x] /; FreeQ[{F, a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0]
Int[(e_. + f_.*x_)^m_*F_^(a_. + b_./(c_. + d_.*x_)), x_Symbol] := (e + f*x)^(m + 1)*F^(a + b/(c + d*x))/(f*(m + 1)) + b*d*Log[F]/(f*(m + 1))* Int[(e + f*x)^(m + 1)*F^(a + b/(c + d*x))/(c + d*x)^2, x] /; FreeQ[{F, a, b, c, d, e, f}, x] && NeQ[d*e - c*f, 0] && ILtQ[m, -1]
Int[F_^(a_. + b_.*(c_. + d_.*x_)^n_)/(e_. + f_.*x_), x_Symbol] := Unintegrable[F^(a + b*(c + d*x)^n)/(e + f*x), x] /; FreeQ[{F, a, b, c, d, e, f, n}, x] && NeQ[d*e - c*f, 0]
Int[u_^m_.*F_^v_, x_Symbol] := Int[ExpandToSum[u, x]^m*F^ExpandToSum[v, x], x] /; FreeQ[{F, m}, x] && LinearQ[u, x] && BinomialQ[v, x] && Not[LinearMatchQ[u, x] && BinomialMatchQ[v, x]]
Int[u_*F_^(a_. + b_.*(c_. + d_.*x_)^n_), x_Symbol] := Int[ExpandLinearProduct[F^(a + b*(c + d*x)^n), u, c, d, x], x] /; FreeQ[{F, a, b, c, d, n}, x] && PolynomialQ[u, x]
Int[u_.*F_^(a_. + b_.*v_), x_Symbol] := Int[u*F^(a + b*NormalizePowerOfLinear[v, x]), x] /; FreeQ[{F, a, b}, x] && PolynomialQ[u, x] && PowerOfLinearQ[v, x] && Not[PowerOfLinearMatchQ[v, x]]
(* Int[u_.*F_^(a_.+b_.*v_^n_),x_Symbol] := Int[u*F^(a+b*ExpandToSum[v,x]^n),x] /; FreeQ[{F,a,b,n},x] && PolynomialQ[u,x] && LinearQ[v,x] &&  Not[LinearMatchQ[v,x]] *)
(* Int[u_.*F_^u_,x_Symbol] := Int[u*F^ExpandToSum[u,x],x] /; FreeQ[F,x] && PolynomialQ[u,x] && BinomialQ[u,x] &&  Not[BinomialMatchQ[u,x]] *)
Int[F_^(a_. + b_./(c_. + d_.*x_))/((e_. + f_.*x_)*(g_. + h_.*x_)), x_Symbol] := -d/(f*(d*g - c*h))* Subst[Int[F^(a - b*h/(d*g - c*h) + d*b*x/(d*g - c*h))/x, x], x, (g + h*x)/(c + d*x)] /; FreeQ[{F, a, b, c, d, e, f}, x] && EqQ[d*e - c*f, 0]
Int[(g_. + h_.*x_)^m_.*F_^(e_. + f_.*(a_. + b_.*x_)/(c_. + d_.*x_)), x_Symbol] := F^(e + f*b/d)*Int[(g + h*x)^m, x] /; FreeQ[{F, a, b, c, d, e, f, g, h, m}, x] && EqQ[b*c - a*d, 0]
Int[(g_. + h_.*x_)^m_.*F_^(e_. + f_.*(a_. + b_.*x_)/(c_. + d_.*x_)), x_Symbol] := Int[(g + h*x)^m*F^((d*e + b*f)/d - f*(b*c - a*d)/(d*(c + d*x))), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, m}, x] && NeQ[b*c - a*d, 0] && EqQ[d*g - c*h, 0]
Int[F_^(e_. + f_.*(a_. + b_.*x_)/(c_. + d_.*x_))/(g_. + h_.*x_), x_Symbol] := d/h*Int[F^(e + f*(a + b*x)/(c + d*x))/(c + d*x), x] - (d*g - c*h)/h* Int[F^(e + f*(a + b*x)/(c + d*x))/((c + d*x)*(g + h*x)), x] /; FreeQ[{F, a, b, c, d, e, f, g, h}, x] && NeQ[b*c - a*d, 0] && NeQ[d*g - c*h, 0]
Int[(g_. + h_.*x_)^m_*F_^(e_. + f_.*(a_. + b_.*x_)/(c_. + d_.*x_)), x_Symbol] := (g + h*x)^(m + 1)*F^(e + f*(a + b*x)/(c + d*x))/(h*(m + 1)) - f*(b*c - a*d)*Log[F]/(h*(m + 1))* Int[(g + h*x)^(m + 1)*F^(e + f*(a + b*x)/(c + d*x))/(c + d*x)^2, x] /; FreeQ[{F, a, b, c, d, e, f, g, h}, x] && NeQ[b*c - a*d, 0] && NeQ[d*g - c*h, 0] && ILtQ[m, -1]
Int[F_^(e_. + f_.*(a_. + b_.*x_)/(c_. + d_.*x_))/((g_. + h_.*x_)*(i_. + j_.*x_)), x_Symbol] := -d/(h*(d*i - c*j))* Subst[Int[ F^(e + f*(b*i - a*j)/(d*i - c*j) - (b*c - a*d)*f*x/(d*i - c*j))/ x, x], x, (i + j*x)/(c + d*x)] /; FreeQ[{F, a, b, c, d, e, f, g, h}, x] && EqQ[d*g - c*h, 0]
Int[F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := F^(a - b^2/(4*c))*Int[F^((b + 2*c*x)^2/(4*c)), x] /; FreeQ[{F, a, b, c}, x]
Int[F_^v_, x_Symbol] := Int[F^ExpandToSum[v, x], x] /; FreeQ[F, x] && QuadraticQ[v, x] && Not[QuadraticMatchQ[v, x]]
Int[(d_. + e_.*x_)*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*F^(a + b*x + c*x^2)/(2*c*Log[F]) /; FreeQ[{F, a, b, c, d, e}, x] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*(d + e*x)^(m - 1)*F^(a + b*x + c*x^2)/(2*c*Log[F]) - (m - 1)*e^2/(2*c*Log[F])* Int[(d + e*x)^(m - 2)*F^(a + b*x + c*x^2), x] /; FreeQ[{F, a, b, c, d, e}, x] && EqQ[b*e - 2*c*d, 0] && GtQ[m, 1]
Int[F_^(a_. + b_.*x_ + c_.*x_^2)/(d_. + e_.*x_), x_Symbol] := 1/(2*e)*F^(a - b^2/(4*c))* ExpIntegralEi[(b + 2*c*x)^2*Log[F]/(4*c)] /; FreeQ[{F, a, b, c, d, e}, x] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := (d + e*x)^(m + 1)*F^(a + b*x + c*x^2)/(e*(m + 1)) - 2*c*Log[F]/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*F^(a + b*x + c*x^2), x] /; FreeQ[{F, a, b, c, d, e}, x] && EqQ[b*e - 2*c*d, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*F^(a + b*x + c*x^2)/(2*c*Log[F]) - (b*e - 2*c*d)/(2*c)*Int[F^(a + b*x + c*x^2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := e*(d + e*x)^(m - 1)*F^(a + b*x + c*x^2)/(2*c*Log[F]) - (b*e - 2*c*d)/(2*c)* Int[(d + e*x)^(m - 1)*F^(a + b*x + c*x^2), x] - (m - 1)*e^2/(2*c*Log[F])* Int[(d + e*x)^(m - 2)*F^(a + b*x + c*x^2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && GtQ[m, 1]
Int[(d_. + e_.*x_)^m_*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := (d + e*x)^(m + 1)*F^(a + b*x + c*x^2)/(e*(m + 1)) - (b*e - 2*c*d)*Log[F]/(e^2*(m + 1))* Int[(d + e*x)^(m + 1)*F^(a + b*x + c*x^2), x] - 2*c*Log[F]/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*F^(a + b*x + c*x^2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_.*F_^(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Unintegrable[(d + e*x)^m*F^(a + b*x + c*x^2), x] /; FreeQ[{F, a, b, c, d, e, m}, x]
Int[u_^m_.*F_^v_, x_Symbol] := Int[ExpandToSum[u, x]^m*F^ExpandToSum[v, x], x] /; FreeQ[{F, m}, x] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]
Int[x_^m_.*F_^(e_.*(c_. + d_.*x_))*(a_. + b_.*F_^v_)^p_, x_Symbol] := With[{u = IntHide[F^(e*(c + d*x))*(a + b*F^v)^p, x]}, Dist[x^m, u, x] - m*Int[x^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e}, x] && EqQ[v, 2*e*(c + d*x)] && GtQ[m, 0] && ILtQ[p, 0]
Int[(F_^(e_.*(c_. + d_.*x_)))^ n_.*(a_ + b_.*(F_^(e_.*(c_. + d_.*x_)))^n_.)^p_., x_Symbol] := 1/(d*e*n*Log[F])* Subst[Int[(a + b*x)^p, x], x, (F^(e*(c + d*x)))^n] /; FreeQ[{F, a, b, c, d, e, n, p}, x]
Int[(G_^(h_. (f_. + g_.*x_)))^ m_.*(a_ + b_.*(F_^(e_.*(c_. + d_.*x_)))^n_.)^p_., x_Symbol] := (G^(h*(f + g*x)))^m/(F^(e*(c + d*x)))^n* Int[(F^(e*(c + d*x)))^n*(a + b*(F^(e*(c + d*x)))^n)^p, x] /; FreeQ[{F, G, a, b, c, d, e, f, g, h, m, n, p}, x] && EqQ[d*e*n*Log[F], g*h*m*Log[G]]
Int[G_^(h_. (f_. + g_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := With[{m = FullSimplify[g*h*Log[G]/(d*e*Log[F])]}, Denominator[m]*G^(f*h - c*g*h/d)/(d*e*Log[F])* Subst[Int[x^(Numerator[m] - 1)*(a + b*x^Denominator[m])^p, x], x, F^(e*(c + d*x)/Denominator[m])] /; LeQ[m, -1] || GeQ[m, 1]] /; FreeQ[{F, G, a, b, c, d, e, f, g, h, p}, x]
Int[G_^(h_. (f_. + g_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := With[{m = FullSimplify[d*e*Log[F]/(g*h*Log[G])]}, Denominator[m]/(g*h*Log[G])* Subst[Int[ x^(Denominator[m] - 1)*(a + b*F^(c*e - d*e*f/g)*x^Numerator[m])^p, x], x, G^(h*(f + g*x)/Denominator[m])] /; LtQ[m, -1] || GtQ[m, 1]] /; FreeQ[{F, G, a, b, c, d, e, f, g, h, p}, x]
Int[G_^(h_. (f_. + g_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := Int[Expand[G^(h*(f + g*x))*(a + b*F^(e*(c + d*x)))^p, x], x] /; FreeQ[{F, G, a, b, c, d, e, f, g, h}, x] && IGtQ[p, 0]
Int[G_^(h_. (f_. + g_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_, x_Symbol] := a^p*G^(h*(f + g*x))/(g*h*Log[G])* Hypergeometric2F1[-p, g*h*Log[G]/(d*e*Log[F]), g*h*Log[G]/(d*e*Log[F]) + 1, Simplify[-b/a*F^(e*(c + d*x))]] /; FreeQ[{F, G, a, b, c, d, e, f, g, h, p}, x] && (ILtQ[p, 0] || GtQ[a, 0])
Int[G_^(h_. (f_. + g_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_, x_Symbol] := (a + b*F^(e*(c + d*x)))^p/(1 + (b/a)*F^(e*(c + d*x)))^p* Int[G^(h*(f + g*x))*(1 + b/a*F^(e*(c + d*x)))^p, x] /; FreeQ[{F, G, a, b, c, d, e, f, g, h, p}, x] && Not[ILtQ[p, 0] || GtQ[a, 0]]
Int[G_^(h_. u_)*(a_ + b_.*F_^(e_.*v_))^p_, x_Symbol] := Int[G^(h*ExpandToSum[u, x])*(a + b*F^(e*ExpandToSum[v, x]))^p, x] /; FreeQ[{F, G, a, b, e, h, p}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
(* Int[(c_.+d_.*x_)^m_.*F_^(g_.*(e_.+f_.*x_))/(a_+b_.*F_^(h_.*(e_.+f_. *x_))),x_Symbol] := 1/b*Int[(c+d*x)^m*F^((g-h)*(e+f*x)),x] - a/b*Int[(c+d*x)^m*F^((g-h)*(e+f*x))/(a+b*F^(h*(e+f*x))),x] /; FreeQ[{F,a,b,c,d,e,f,g,h,m},x] && LeQ[0,g/h-1,g/h] *)
(* Int[(c_.+d_.*x_)^m_.*F_^(g_.*(e_.+f_.*x_))/(a_+b_.*F_^(h_.*(e_.+f_. *x_))),x_Symbol] := 1/a*Int[(c+d*x)^m*F^(g*(e+f*x)),x] - b/a*Int[(c+d*x)^m*F^((g+h)*(e+f*x))/(a+b*F^(h*(e+f*x))),x] /; FreeQ[{F,a,b,c,d,e,f,g,h,m},x] && LeQ[g/h,g/h+1,0] *)
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*F_^u_)^p_.*(c_. + d_.*F_^v_)^q_., x_Symbol] := With[{w = ExpandIntegrand[(e + f*x)^m, (a + b*F^u)^p*(c + d*F^v)^q, x]}, Int[w, x] /; SumQ[w]] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && IntegersQ[p, q] && LinearQ[{u, v}, x] && RationalQ[Simplify[u/v]]
Int[G_^(h_. (f_. + g_.*x_))* H_^(t_. (r_. + s_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := With[{m = FullSimplify[(g*h*Log[G] + s*t*Log[H])/(d*e*Log[F])]}, Denominator[m]*G^(f*h - c*g*h/d)*H^(r*t - c*s*t/d)/(d*e*Log[F])* Subst[Int[x^(Numerator[m] - 1)*(a + b*x^Denominator[m])^p, x], x, F^(e*(c + d*x)/Denominator[m])] /; RationalQ[m]] /; FreeQ[{F, G, H, a, b, c, d, e, f, g, h, r, s, t, p}, x]
Int[G_^(h_. (f_. + g_.*x_))* H_^(t_. (r_. + s_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := G^((f - c*g/d)*h)* Int[H^(t*(r + s*x))*(b + a*F^(-e*(c + d*x)))^p, x] /; FreeQ[{F, G, H, a, b, c, d, e, f, g, h, r, s, t}, x] && EqQ[d*e*p*Log[F] + g*h*Log[G], 0] && IntegerQ[p]
Int[G_^(h_. (f_. + g_.*x_))* H_^(t_. (r_. + s_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := Int[Expand[ G^(h*(f + g*x))*H^(t*(r + s*x))*(a + b*F^(e*(c + d*x)))^p, x], x] /; FreeQ[{F, G, H, a, b, c, d, e, f, g, h, r, s, t}, x] && IGtQ[p, 0]
Int[G_^(h_. (f_. + g_.*x_))* H_^(t_. (r_. + s_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_, x_Symbol] := a^p*G^(h*(f + g*x))*H^(t*(r + s*x))/(g*h*Log[G] + s*t*Log[H])* Hypergeometric2F1[-p, (g*h*Log[G] + s*t*Log[H])/(d*e* Log[F]), (g*h*Log[G] + s*t*Log[H])/(d*e*Log[F]) + 1, Simplify[-b/a*F^(e*(c + d*x))]] /; FreeQ[{F, G, H, a, b, c, d, e, f, g, h, r, s, t}, x] && ILtQ[p, 0]
Int[G_^(h_. (f_. + g_.*x_))* H_^(t_. (r_. + s_.*x_))*(a_ + b_.*F_^(e_.*(c_. + d_.*x_)))^p_, x_Symbol] := G^(h*(f + g*x))* H^(t*(r + s*x))*(a + b*F^(e*(c + d*x)))^ p/((g*h*Log[G] + s*t*Log[H])*((a + b*F^(e*(c + d*x)))/a)^p)* Hypergeometric2F1[-p, (g*h*Log[G] + s*t*Log[H])/(d*e* Log[F]), (g*h*Log[G] + s*t*Log[H])/(d*e*Log[F]) + 1, Simplify[-b/a*F^(e*(c + d*x))]] /; FreeQ[{F, G, H, a, b, c, d, e, f, g, h, r, s, t, p}, x] && Not[IntegerQ[p]]
Int[G_^(h_. u_)*H_^(t_. w_)*(a_ + b_.*F_^(e_.*v_))^p_, x_Symbol] := Int[G^(h*ExpandToSum[u, x])* H^(t*ExpandToSum[w, x])*(a + b*F^(e*ExpandToSum[v, x]))^p, x] /; FreeQ[{F, G, H, a, b, e, h, t, p}, x] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]
Int[F_^(e_.*(c_. + d_.*x_))*(a_.*x_^n_. + b_.*F_^(e_.*(c_. + d_.*x_)))^p_., x_Symbol] := (a*x^n + b*F^(e*(c + d*x)))^(p + 1)/(b*d*e*(p + 1)*Log[F]) - a*n/(b*d*e*Log[F])* Int[x^(n - 1)*(a*x^n + b*F^(e*(c + d*x)))^p, x] /; FreeQ[{F, a, b, c, d, e, n, p}, x] && NeQ[p, -1]
Int[x_^m_.* F_^(e_.*(c_. + d_.*x_))*(a_.*x_^n_. + b_.*F_^(e_.*(c_. + d_.*x_)))^ p_., x_Symbol] := x^m*(a*x^n + b*F^(e*(c + d*x)))^(p + 1)/(b*d*e*(p + 1)*Log[F]) - a*n/(b*d*e*Log[F])* Int[x^(m + n - 1)*(a*x^n + b*F^(e*(c + d*x)))^p, x] - m/(b*d*e*(p + 1)*Log[F])* Int[x^(m - 1)*(a*x^n + b*F^(e*(c + d*x)))^(p + 1), x] /; FreeQ[{F, a, b, c, d, e, m, n, p}, x] && NeQ[p, -1]
Int[(f_. + g_.*x_)^m_./(a_. + b_.*F_^u_ + c_.*F_^v_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[(f + g*x)^m/(b - q + 2*c*F^u), x] - 2*c/q*Int[(f + g*x)^m/(b + q + 2*c*F^u), x]] /; FreeQ[{F, a, b, c, f, g}, x] && EqQ[v, 2*u] && LinearQ[u, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[m, 0]
Int[(f_. + g_.*x_)^m_.*F_^u_/(a_. + b_.*F_^u_ + c_.*F_^v_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[(f + g*x)^m*F^u/(b - q + 2*c*F^u), x] - 2*c/q*Int[(f + g*x)^m*F^u/(b + q + 2*c*F^u), x]] /; FreeQ[{F, a, b, c, f, g}, x] && EqQ[v, 2*u] && LinearQ[u, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[m, 0]
Int[(f_. + g_.*x_)^m_.*(h_ + i_.*F_^u_)/(a_. + b_.*F_^u_ + c_.*F_^v_), x_Symbol] := With[{q = Rt[b^2 - 4*a*c, 2]}, (Simplify[(2*c*h - b*i)/q] + i)* Int[(f + g*x)^m/(b - q + 2*c*F^u), x] - (Simplify[(2*c*h - b*i)/q] - i)* Int[(f + g*x)^m/(b + q + 2*c*F^u), x]] /; FreeQ[{F, a, b, c, f, g, h, i}, x] && EqQ[v, 2*u] && LinearQ[u, x] && NeQ[b^2 - 4*a*c, 0] && IGtQ[m, 0]
Int[x_^m_./(a_.*F_^(c_. + d_.*x_) + b_.*F_^v_), x_Symbol] := With[{u = IntHide[1/(a*F^(c + d*x) + b*F^v), x]}, x^m*u - m*Int[x^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d}, x] && EqQ[v, -(c + d*x)] && GtQ[m, 0]
Int[u_/(a_ + b_.*F_^v_ + c_.*F_^w_), x_Symbol] := Int[u*F^v/(c + a*F^v + b*F^(2*v)), x] /; FreeQ[{F, a, b, c}, x] && EqQ[w, -v] && LinearQ[v, x] && If[RationalQ[Coefficient[v, x, 1]], GtQ[Coefficient[v, x, 1], 0], LtQ[LeafCount[v], LeafCount[w]]]
Int[F_^(g_.*(d_. + e_.*x_)^n_.)/(a_. + b_.*x_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[F^(g*(d + e*x)^n), 1/(a + b*x + c*x^2), x], x] /; FreeQ[{F, a, b, c, d, e, g, n}, x]
Int[F_^(g_.*(d_. + e_.*x_)^n_.)/(a_ + c_.*x_^2), x_Symbol] := Int[ExpandIntegrand[F^(g*(d + e*x)^n), 1/(a + c*x^2), x], x] /; FreeQ[{F, a, c, d, e, g, n}, x]
Int[u_^m_.*F_^(g_.*(d_. + e_.*x_)^n_.)/(a_. + b_.*x_ + c_*x_^2), x_Symbol] := Int[ExpandIntegrand[F^(g*(d + e*x)^n), u^m/(a + b*x + c*x^2), x], x] /; FreeQ[{F, a, b, c, d, e, g, n}, x] && PolynomialQ[u, x] && IntegerQ[m]
Int[u_^m_.*F_^(g_.*(d_. + e_.*x_)^n_.)/(a_ + c_*x_^2), x_Symbol] := Int[ExpandIntegrand[F^(g*(d + e*x)^n), u^m/(a + c*x^2), x], x] /; FreeQ[{F, a, c, d, e, g, n}, x] && PolynomialQ[u, x] && IntegerQ[m]
Int[F_^((a_. + b_.*x_^4)/x_^2), x_Symbol] := Sqrt[Pi]*Exp[2*Sqrt[-a*Log[F]]*Sqrt[-b*Log[F]]]* Erf[(Sqrt[-a*Log[F]] + Sqrt[-b*Log[F]]*x^2)/x]/ (4*Sqrt[-b*Log[F]]) - Sqrt[Pi]*Exp[-2*Sqrt[-a*Log[F]]*Sqrt[-b*Log[F]]]* Erf[(Sqrt[-a*Log[F]] - Sqrt[-b*Log[F]]*x^2)/x]/ (4*Sqrt[-b*Log[F]]) /; FreeQ[{F, a, b}, x]
Int[x_^m_.*(E^x_ + x_^m_.)^n_, x_Symbol] := -(E^x + x^m)^(n + 1)/(n + 1) + Int[(E^x + x^m)^(n + 1), x] + m*Int[x^(m - 1)*(E^x + x^m)^n, x] /; RationalQ[m, n] && GtQ[m, 0] && LtQ[n, 0] && NeQ[n, -1]
Int[u_.*F_^(a_.*(v_. + b_.*Log[z_])), x_Symbol] := Int[u*F^(a*v)*z^(a*b*Log[F]), x] /; FreeQ[{F, a, b}, x]
Int[F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.]^2)), x_Symbol] := (d + e*x)/(e*n*(c*(d + e*x)^n)^(1/n))* Subst[Int[E^(a*f*Log[F] + x/n + b*f*Log[F]*x^2), x], x, Log[c*(d + e*x)^n]] /; FreeQ[{F, a, b, c, d, e, f, n}, x]
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.]^2)), x_Symbol] := (g + h*x)^(m + 1)/(h*n*(c*(d + e*x)^n)^((m + 1)/n))* Subst[Int[E^(a*f*Log[F] + ((m + 1)*x)/n + b*f*Log[F]*x^2), x], x, Log[c*(d + e*x)^n]] /; FreeQ[{F, a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*g - d*h, 0]
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.]^2)), x_Symbol] := 1/e^(m + 1)* Subst[Int[ ExpandIntegrand[F^(f*(a + b*Log[c*x^n]^2)), (e*g - d*h + h*x)^m, x], x], x, d + e*x] /; FreeQ[{F, a, b, c, d, e, f, g, h, n}, x] && IGtQ[m, 0]
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.]^2)), x_Symbol] := Unintegrable[(g + h*x)^m*F^(f*(a + b*Log[c*(d + e*x)^n]^2)), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, m, n}, x]
Int[F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.])^2), x_Symbol] := c^(2*a*b*f*Log[F])* Int[(d + e*x)^(2*a*b*f*n*Log[F])* F^(a^2*f + b^2*f*Log[c*(d + e*x)^n]^2), x] /; FreeQ[{F, a, b, c, d, e, f, n}, x] && IntegerQ[2*a*b*f*Log[F]]
Int[F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.])^2), x_Symbol] := (c*(d + e*x)^n)^(2*a*b*f*Log[F])/(d + e*x)^(2*a*b*f*n*Log[F])* Int[(d + e*x)^(2*a*b*f*n*Log[F])* F^(a^2*f + b^2*f*Log[c*(d + e*x)^n]^2), x] /; FreeQ[{F, a, b, c, d, e, f, n}, x] && Not[IntegerQ[2*a*b*f*Log[F]]]
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.])^2), x_Symbol] := h^m*c^(2*a*b*f*Log[F])/e^m* Int[(d + e*x)^(m + 2*a*b*f*n*Log[F])* F^(a^2*f + b^2*f*Log[c*(d + e*x)^n]^2), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*g - d*h, 0] && IntegerQ[2*a*b*f*Log[F]] && (IntegerQ[m] || EqQ[h, e])
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.])^2), x_Symbol] := (g + h*x)^ m*(c*(d + e*x)^n)^(2*a*b*f*Log[F])/(d + e*x)^(m + 2*a*b*f*n*Log[F])* Int[(d + e*x)^(m + 2*a*b*f*n*Log[F])* F^(a^2*f + b^2*f*Log[c*(d + e*x)^n]^2), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*g - d*h, 0]
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.])^2), x_Symbol] := 1/e^(m + 1)* Subst[Int[ ExpandIntegrand[F^(f*(a + b*Log[c*x^n])^2), (e*g - d*h + h*x)^m, x], x], x, d + e*x] /; FreeQ[{F, a, b, c, d, e, f, g, h, n}, x] && IGtQ[m, 0]
Int[(g_. + h_.*x_)^m_.* F_^(f_.*(a_. + b_.*Log[c_.*(d_. + e_.*x_)^n_.])^2), x_Symbol] := Unintegrable[(g + h*x)^m*F^(f*(a + b*Log[c*(d + e*x)^n])^2), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, m, n}, x]
Int[Log[a_ + b_.*(F_^(e_.*(c_. + d_.*x_)))^n_.], x_Symbol] := 1/(d*e*n*Log[F])* Subst[Int[Log[a + b*x]/x, x], x, (F^(e*(c + d*x)))^n] /; FreeQ[{F, a, b, c, d, e, n}, x] && GtQ[a, 0]
Int[Log[a_ + b_.*(F_^(e_.*(c_. + d_.*x_)))^n_.], x_Symbol] := x*Log[a + b*(F^(e*(c + d*x)))^n] - b*d*e*n*Log[F]* Int[x*(F^(e*(c + d*x)))^n/(a + b*(F^(e*(c + d*x)))^n), x] /; FreeQ[{F, a, b, c, d, e, n}, x] && Not[GtQ[a, 0]]
(* Int[u_.*(a_.*F_^v_)^n_,x_Symbol] := a^n*Int[u*F^(n*v),x] /; FreeQ[{F,a},x] && IntegerQ[n] *)
Int[u_.*(a_.*F_^v_)^n_, x_Symbol] := (a*F^v)^n/F^(n*v)*Int[u*F^(n*v), x] /; FreeQ[{F, a, n}, x] && Not[IntegerQ[n]]
Int[u_, x_Symbol] := With[{v = FunctionOfExponential[u, x]}, v/D[v, x]* Subst[Int[FunctionOfExponentialFunction[u, x]/x, x], x, v]] /; FunctionOfExponentialQ[u, x] && Not[ MatchQ[u, w_*(a_.*v_^n_)^m_ /; FreeQ[{a, m, n}, x] && IntegerQ[m*n]]] && Not[ MatchQ[u, E^(c_.*(a_. + b_.*x))*F_[v_] /; FreeQ[{a, b, c}, x] && InverseFunctionQ[F[x]]]]
Int[u_.*(a_.*F_^v_ + b_.*F_^w_)^n_, x_Symbol] := Int[u*F^(n*v)*(a + b*F^ExpandToSum[w - v, x])^n, x] /; FreeQ[{F, a, b, n}, x] && ILtQ[n, 0] && LinearQ[{v, w}, x]
Int[u_.*(a_.*F_^v_ + b_.*G_^w_)^n_, x_Symbol] := Int[u*F^(n*v)*(a + b*E^ExpandToSum[Log[G]*w - Log[F]*v, x])^n, x] /; FreeQ[{F, G, a, b, n}, x] && ILtQ[n, 0] && LinearQ[{v, w}, x]
Int[u_.*(a_.*F_^v_ + b_.*F_^w_)^n_, x_Symbol] := (a*F^v + b*F^w)^n/(F^(n*v)*(a + b*F^ExpandToSum[w - v, x])^n)* Int[u*F^(n*v)*(a + b*F^ExpandToSum[w - v, x])^n, x] /; FreeQ[{F, a, b, n}, x] && Not[IntegerQ[n]] && LinearQ[{v, w}, x]
Int[u_.*(a_.*F_^v_ + b_.*G_^w_)^n_, x_Symbol] := (a*F^v + b*G^w)^ n/(F^(n*v)*(a + b*E^ExpandToSum[Log[G]*w - Log[F]*v, x])^n)* Int[u*F^(n*v)*(a + b*E^ExpandToSum[Log[G]*w - Log[F]*v, x])^n, x] /; FreeQ[{F, G, a, b, n}, x] && Not[IntegerQ[n]] && LinearQ[{v, w}, x]
Int[u_.*F_^v_*G_^w_, x_Symbol] := With[{z = v*Log[F] + w*Log[G]}, Int[u*NormalizeIntegrand[E^z, x], x] /; BinomialQ[z, x] || PolynomialQ[z, x] && LeQ[Exponent[z, x], 2]] /; FreeQ[{F, G}, x]
Int[F_^u_*(v_ + w_)*y_., x_Symbol] := With[{z = v*y/(Log[F]*D[u, x])}, F^u*z /; EqQ[D[z, x], w*y]] /; FreeQ[F, x]
Int[F_^u_*v_^n_.*w_, x_Symbol] := With[{z = Log[F]*v*D[u, x] + (n + 1)*D[v, x]}, Coefficient[w, x, Exponent[w, x]]/ Coefficient[z, x, Exponent[z, x]]*F^u*v^(n + 1) /; EqQ[Exponent[w, x], Exponent[z, x]] && EqQ[w*Coefficient[z, x, Exponent[z, x]], z*Coefficient[w, x, Exponent[w, x]]]] /; FreeQ[{F, n}, x] && PolynomialQ[u, x] && PolynomialQ[v, x] && PolynomialQ[w, x]
Int[(a_. + b_.*F_^(c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]))^ n_./(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := 2*e*g/(C*(e*f - d*g))* Subst[Int[(a + b*F^(c*x))^n/x, x], x, Sqrt[d + e*x]/Sqrt[f + g*x]] /; FreeQ[{a, b, c, d, e, f, g, A, B, C, F}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[B*e*g - C*(e*f + d*g), 0] && IGtQ[n, 0]
Int[(a_. + b_.*F_^(c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]))^ n_./(A_ + C_.*x_^2), x_Symbol] := 2*e*g/(C*(e*f - d*g))* Subst[Int[(a + b*F^(c*x))^n/x, x], x, Sqrt[d + e*x]/Sqrt[f + g*x]] /; FreeQ[{a, b, c, d, e, f, g, A, C, F}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[e*f + d*g, 0] && IGtQ[n, 0]
Int[(a_. + b_.*F_^(c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]))^ n_/(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := Unintegrable[(a + b*F^(c*Sqrt[d + e*x]/Sqrt[f + g*x]))^ n/(A + B*x + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, C, F, n}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[B*e*g - C*(e*f + d*g), 0] && Not[IGtQ[n, 0]]
Int[(a_. + b_.*F_^(c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]))^ n_/(A_ + C_.*x_^2), x_Symbol] := Unintegrable[(a + b*F^(c*Sqrt[d + e*x]/Sqrt[f + g*x]))^ n/(A + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, g, A, C, F, n}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[e*f + d*g, 0] && Not[IGtQ[n, 0]]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.1.1 (a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.1.1 (a+b log(c x^n))^p *)
Int[Log[c_.*x_^n_.], x_Symbol] := x*Log[c*x^n] - n*x /; FreeQ[{c, n}, x]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := x*(a + b*Log[c*x^n])^p - b*n*p*Int[(a + b*Log[c*x^n])^(p - 1), x] /; FreeQ[{a, b, c, n}, x] && GtQ[p, 0] && IntegerQ[2*p]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_, x_Symbol] := x*(a + b*Log[c*x^n])^(p + 1)/(b*n*(p + 1)) - 1/(b*n*(p + 1))*Int[(a + b*Log[c*x^n])^(p + 1), x] /; FreeQ[{a, b, c, n}, x] && LtQ[p, -1] && IntegerQ[2*p]
Int[1/Log[c_.*x_], x_Symbol] := LogIntegral[c*x]/c /; FreeQ[c, x]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_, x_Symbol] := 1/(n*c^(1/n))*Subst[Int[E^(x/n)*(a + b*x)^p, x], x, Log[c*x^n]] /; FreeQ[{a, b, c, p}, x] && IntegerQ[1/n]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_, x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[E^(x/n)*(a + b*x)^p, x], x, Log[c*x^n]] /; FreeQ[{a, b, c, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.1.2 (d x)^m (a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.1.2 (d x)^m (a+b log(c x^n))^p *)
Int[(a_. + b_.*Log[c_.*x_^n_.])/x_, x_Symbol] := (a + b*Log[c*x^n])^2/(2*b*n) /; FreeQ[{a, b, c, n}, x]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := 1/(b*n)*Subst[Int[x^p, x], x, a + b*Log[c*x^n]] /; FreeQ[{a, b, c, n, p}, x]
Int[(d_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := b*(d*x)^(m + 1)*Log[c*x^n]/(d*(m + 1)) /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[m, -1] && EqQ[a*(m + 1) - b*n, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (d*x)^(m + 1)*(a + b*Log[c*x^n])/(d*(m + 1)) - b*n*(d*x)^(m + 1)/(d*(m + 1)^2) /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := (d*x)^(m + 1)*(a + b*Log[c*x^n])^p/(d*(m + 1)) - b*n*p/(m + 1)*Int[(d*x)^m*(a + b*Log[c*x^n])^(p - 1), x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[m, -1] && GtQ[p, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^p_, x_Symbol] := (d*x)^(m + 1)*(a + b*Log[c*x^n])^(p + 1)/(b*d*n*(p + 1)) - (m + 1)/(b*n*(p + 1))*Int[(d*x)^m*(a + b*Log[c*x^n])^(p + 1), x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[m, -1] && LtQ[p, -1]
Int[x_^m_./Log[c_.*x_^n_], x_Symbol] := 1/n*Subst[Int[1/Log[c*x], x], x, x^n] /; FreeQ[{c, m, n}, x] && EqQ[m, n - 1]
Int[(d_*x_)^m_./Log[c_.*x_^n_], x_Symbol] := (d*x)^m/x^m*Int[x^m/Log[c*x^n], x] /; FreeQ[{c, d, m, n}, x] && EqQ[m, n - 1]
Int[x_^m_.*(a_. + b_.*Log[c_.*x_])^p_, x_Symbol] := 1/c^(m + 1)*Subst[Int[E^((m + 1)*x)*(a + b*x)^p, x], x, Log[c*x]] /; FreeQ[{a, b, c, p}, x] && IntegerQ[m]
Int[(d_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^p_, x_Symbol] := (d*x)^(m + 1)/(d*n*(c*x^n)^((m + 1)/n))* Subst[Int[E^((m + 1)/n*x)*(a + b*x)^p, x], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(d_.*x_^q_)^m_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := (d*x^q)^m/x^(m*q)*Int[x^(m*q)*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p, q}, x]
Int[(d1_.*x_^q1_)^m1_*(d2_.*x_^q2_)^m2_*(a_. + b_.*Log[c_.*x_^n_.])^ p_., x_Symbol] := (d1*x^q1)^m1*(d2*x^q2)^m2/x^(m1*q1 + m2*q2)* Int[x^(m1*q1 + m2*q2)*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d1, d2, m1, m2, n, p, q1, q2}, x]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.1.3 (d+e x^r)^q (a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.1.3 (d+e x^r)^q (a+b log(c x^n))^p *)
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[(d + e*x^r)^q, x]}, u*(a + b*Log[c*x^n]) - b*n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[q, 0]
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[(d + e*x^r)^q, x]}, Dist[(a + b*Log[c*x^n]), u] - b*n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[q, 0]
Int[(d_ + e_.*x_^r_.)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := x*(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])/d - b*n/d*Int[(d + e*x^r)^(q + 1), x] /; FreeQ[{a, b, c, d, e, n, q, r}, x] && EqQ[r*(q + 1) + 1, 0]
(* Int[(a_.+b_.*Log[c_.*x_^n_.])^p_./(d_+e_.*x_^r_.),x_Symbol] := 1/e*Int[(a+b*Log[c*x^n])^p/x^r,x] - d/e*Int[(a+b*Log[c*x^n])^p/(x^r*(d+e*x^r)),x] /; FreeQ[{a,b,c,d,e,n,r},x] && IGtQ[p,0] && IGtQ[r,0] *)
Int[Log[c_.*x_]/(d_ + e_.*x_), x_Symbol] := -1/e*PolyLog[2, 1 - c*x] /; FreeQ[{c, d, e}, x] && EqQ[e + c*d, 0]
Int[(a_. + b_.*Log[c_.*x_])/(d_ + e_.*x_), x_Symbol] := (a + b*Log[-c*d/e])*Log[d + e*x]/e + b*Int[Log[-e*x/d]/(d + e*x), x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[-c*d/e, 0]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_./(d_ + e_.*x_), x_Symbol] := Log[1 + e*x/d]*(a + b*Log[c*x^n])^p/e - b*n*p/e*Int[Log[1 + e*x/d]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_./(d_ + e_.*x_)^2, x_Symbol] := x*(a + b*Log[c*x^n])^p/(d*(d + e*x)) - b*n*p/d*Int[(a + b*Log[c*x^n])^(p - 1)/(d + e*x), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && GtQ[p, 0]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := (d + e*x)^(q + 1)*(a + b*Log[c*x^n])^p/(e*(q + 1)) - b*n*p/(e*(q + 1))* Int[((d + e*x)^(q + 1)*(a + b*Log[c*x^n])^(p - 1))/x, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x] && GtQ[p, 0] && NeQ[q, -1] && (EqQ[p, 1] || IntegersQ[2*p, 2*q] && Not[IGtQ[q, 0]] || EqQ[p, 2] && NeQ[q, 1])
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_, x_Symbol] := x*(d + e*x)^q*(a + b*Log[c*x^n])^(p + 1)/(b*n*(p + 1)) + d*q/(b*n*(p + 1))* Int[(d + e*x)^(q - 1)*(a + b*Log[c*x^n])^(p + 1), x] - (q + 1)/(b*n*(p + 1))* Int[(d + e*x)^q*(a + b*Log[c*x^n])^(p + 1), x] /; FreeQ[{a, b, c, d, e, n}, x] && LtQ[p, -1] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := x*(d + e*x^2)^q*(a + b*Log[c*x^n])/(2*q + 1) - b*n/(2*q + 1)*Int[(d + e*x^2)^q, x] + 2*d*q/(2*q + 1)*Int[(d + e*x^2)^(q - 1)*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, n}, x] && GtQ[q, 0]
Int[(a_. + b_.*Log[c_.*x_^n_.])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := x*(a + b*Log[c*x^n])/(d*Sqrt[d + e*x^2]) - b*n/d*Int[1/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, n}, x]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := -x*(d + e*x^2)^(q + 1)*(a + b*Log[c*x^n])/(2*d*(q + 1)) + b*n/(2*d*(q + 1))*Int[(d + e*x^2)^(q + 1), x] + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, n}, x] && LtQ[q, -1]
Int[(a_. + b_.*Log[c_.*x_^n_.])/(d_ + e_.*x_^2), x_Symbol] := With[{u = IntHide[1/(d + e*x^2), x]}, u*(a + b*Log[c*x^n]) - b*n*Int[u/x, x]] /; FreeQ[{a, b, c, d, e, n}, x]
Int[(a_. + b_.*Log[c_.*x_^n_.])/Sqrt[d_ + e_.*x_^2], x_Symbol] := ArcSinh[Rt[e, 2]*x/Sqrt[d]]*(a + b*Log[c*x^n])/Rt[e, 2] - b*n/Rt[e, 2]*Int[ArcSinh[Rt[e, 2]*x/Sqrt[d]]/x, x] /; FreeQ[{a, b, c, d, e, n}, x] && GtQ[d, 0] && PosQ[e]
Int[(a_. + b_.*Log[c_.*x_^n_.])/Sqrt[d_ + e_.*x_^2], x_Symbol] := ArcSin[Rt[-e, 2]*x/Sqrt[d]]*(a + b*Log[c*x^n])/Rt[-e, 2] - b*n/Rt[-e, 2]*Int[ArcSin[Rt[-e, 2]*x/Sqrt[d]]/x, x] /; FreeQ[{a, b, c, d, e, n}, x] && GtQ[d, 0] && NegQ[e]
Int[(a_. + b_.*Log[c_.*x_^n_.])/Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 + e/d*x^2]/Sqrt[d + e*x^2]* Int[(a + b*Log[c*x^n])/Sqrt[1 + e/d*x^2], x] /; FreeQ[{a, b, c, d, e, n}, x] && Not[GtQ[d, 0]]
Int[(a_. + b_.*Log[c_.*x_^n_.])/(Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]), x_Symbol] := Sqrt[1 + e1*e2/(d1*d2)*x^2]/(Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x])* Int[(a + b*Log[c*x^n])/Sqrt[1 + e1*e2/(d1*d2)*x^2], x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[d2*e1 + d1*e2, 0]
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[(d + e*x^r)^q, x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[SimplifyIntegrand[u/x, x], x] /; EqQ[r, 1] && IntegerQ[q - 1/2] || EqQ[r, 2] && EqQ[q, -1] || InverseFunctionFreeQ[u, x]] /; FreeQ[{a, b, c, d, e, n, q, r}, x] && IntegerQ[2*q] && IntegerQ[r]
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*x^n])^p, (d + e*x^r)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, n, p, q, r}, x] && IntegerQ[q] && (GtQ[q, 0] || IGtQ[p, 0] && IntegerQ[r])
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n, p, q, r}, x]
Int[u_^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[ExpandToSum[u, x]^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p, q}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.1.4 (f x)^m (d+e x^r)^q (a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.1.4 (f x)^m (d+e x^r)^q (a+b log(c x^n))^p *)
Int[x_^m_.*(d_ + e_./x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[(e + d*x)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[m, q] && IntegerQ[q]
Int[x_^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^r)^q, x]}, u*(a + b*Log[c*x^n]) - b*n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[q, 0] && IGtQ[m, 0]
Int[x_^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^r)^q, x]}, Dist[(a + b*Log[c*x^n]), u] - b*n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[q, 0] && IntegerQ[m] && Not[EqQ[q, 1] && EqQ[m, -1]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (f*x)^(m + 1)*(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])/(d* f*(m + 1)) - b*n/(d*(m + 1))*Int[(f*x)^m*(d + e*x^r)^(q + 1), x] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m + r*(q + 1) + 1, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*x_^n_])^p_., x_Symbol] := f^m/n*Subst[Int[(d + e*x)^q*(a + b*Log[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && (IntegerQ[m] || GtQ[f, 0]) && EqQ[r, n]
Int[(f_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^p_./(d_ + e_.*x_^r_), x_Symbol] := f^m*Log[1 + e*x^r/d]*(a + b*Log[c*x^n])^p/(e*r) - b*f^m*n*p/(e*r)* Int[Log[1 + e*x^r/d]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, f, m, n, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && (IntegerQ[m] || GtQ[f, 0]) && NeQ[r, n]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := f^m*(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])^p/(e*r*(q + 1)) - b*f^m*n*p/(e*r*(q + 1))* Int[(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && (IntegerQ[m] || GtQ[f, 0]) && NeQ[r, n] && NeQ[q, -1]
Int[(f_*x_)^m_.*(d_ + e_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := (f*x)^m/x^m*Int[x^m*(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && Not[(IntegerQ[m] || GtQ[f, 0])]
(* Int[x_^m_.*(a_.+b_.*Log[c_.*x_^n_.])^p_./(d_+e_.*x_^r_.),x_Symbol]  := 1/e*Int[x^(m-r)*(a+b*Log[c*x^n])^p,x] - d/e*Int[(x^(m-r)*(a+b*Log[c*x^n])^p)/(d+e*x^r),x] /; FreeQ[{a,b,c,d,e,m,n,r},x] && IGtQ[p,0] && IGtQ[r,0] && IGeQ[m-r,0] *)
Int[(a_. + b_.*Log[c_.*x_^n_])/(x_*(d_ + e_.*x_^r_.)), x_Symbol] := 1/n*Subst[Int[(a + b*Log[c*x])/(x*(d + e*x^(r/n))), x], x, x^n] /; FreeQ[{a, b, c, d, e, n, r}, x] && IntegerQ[r/n]
(* Int[(a_.+b_.*Log[c_.*x_^n_.])^p_./(x_*(d_+e_.*x_)),x_Symbol] := 1/d*Int[(a+b*Log[c*x^n])^p/x,x] -  e/d*Int[(a+b*Log[c*x^n])^p/(d+e*x),x] /; FreeQ[{a,b,c,d,e,n},x] && IGtQ[p,0] *)
(* Int[(a_.+b_.*Log[c_.*x_^n_.])^p_./(x_*(d_+e_.*x_^r_.)),x_Symbol] := (r*Log[x]-Log[1+(e*x^r)/d])*(a+b*Log[c*x^n])^p/(d*r) - b*n*p/d*Int[Log[x]*(a+b*Log[c*x^n])^(p-1)/x,x] + b*n*p/(d*r)*Int[Log[1+(e*x^r)/d]*(a+b*Log[c*x^n])^(p-1)/x,x] /; FreeQ[{a,b,c,d,e,n,r},x] && IGtQ[p,0] *)
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_./(x_*(d_ + e_.*x_^r_.)), x_Symbol] := -Log[1 + d/(e*x^r)]*(a + b*Log[c*x^n])^p/(d*r) + b*n*p/(d*r)* Int[Log[1 + d/(e*x^r)]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[p, 0]
Int[x_^m_.*(a_. + b_.*Log[c_.*x_^n_.])^p_./(d_ + e_.*x_^r_.), x_Symbol] := 1/d*Int[x^m*(a + b*Log[c*x^n])^p, x] - e/d*Int[(x^(m + r)*(a + b*Log[c*x^n])^p)/(d + e*x^r), x] /; FreeQ[{a, b, c, d, e, m, n, r}, x] && IGtQ[p, 0] && IGtQ[r, 0] && ILtQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := -(f*x)^(m + 1)*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^ p/(d*f*(q + 1)) + b*n*p/(d*(q + 1))* Int[(f*x)^m*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, n, q}, x] && EqQ[m + q + 2, 0] && IGtQ[p, 0] && LtQ[q, -1]
Int[x_^m_.*(d_ + e_.*x_)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x)^q, x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, n}, x] && ILtQ[m + q + 2, 0] && IGtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := -(f*x)^(m + 1)*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^ p/(d*f*(q + 1)) + (m + q + 2)/(d*(q + 1))* Int[(f*x)^m*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^p, x] + b*n*p/(d*(q + 1))* Int[(f*x)^m*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && ILtQ[m + q + 2, 0] && IGtQ[p, 0] && LtQ[q, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (f*x)^m*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])/(e*(q + 1)) - f/(e*(q + 1))* Int[(f*x)^(m - 1)*(d + e*x)^(q + 1)*(a*m + b*n + b*m*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && ILtQ[q, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := -(f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*Log[c*x^n])/(2*d* f*(q + 1)) + 1/(2*d*(q + 1))* Int[(f*x)^ m*(d + e*x^2)^(q + 1)*(a*(m + 2*q + 3) + b*n + b*(m + 2*q + 3)*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && ILtQ[q, -1] && ILtQ[m, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := d^IntPart[q]*(d + e*x^2)^FracPart[q]/(1 + e/d*x^2)^FracPart[q]* Int[x^m*(1 + e/d*x^2)^q*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[m/2] && IntegerQ[q - 1/2] && Not[LtQ[m + 2*q, -2] || GtQ[d, 0]]
Int[x_^m_.*(d1_ + e1_.*x_)^q_*(d2_ + e2_.*x_)^ q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (d1 + e1*x)^q*(d2 + e2*x)^q/(1 + e1*e2/(d1*d2)*x^2)^q* Int[x^m*(1 + e1*e2/(d1*d2)*x^2)^q*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[d2*e1 + d1*e2, 0] && IntegerQ[m] && IntegerQ[q - 1/2]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := d*Int[(d + e*x)^(q - 1)*(a + b*Log[c*x^n])^p/x, x] + e*Int[(d + e*x)^(q - 1)*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 0] && GtQ[q, 0] && IntegerQ[2*q]
Int[(d_ + e_.*x_)^q_*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := 1/d*Int[(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^p/x, x] - e/d*Int[(d + e*x)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 0] && LtQ[q, -1] && IntegerQ[2*q]
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])/x_, x_Symbol] := With[{u = IntHide[(d + e*x^r)^q/x, x]}, u*(a + b*Log[c*x^n]) - b*n*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IntegerQ[q - 1/2]
Int[(d_ + e_.*x_^r_.)^q_*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := 1/d*Int[(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])^p/x, x] - e/d*Int[x^(r - 1)*(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[p, 0] && ILtQ[q, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^r)^q, x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[SimplifyIntegrand[u/x, x], x] /; (EqQ[r, 1] || EqQ[r, 2]) && IntegerQ[m] && IntegerQ[q - 1/2] || InverseFunctionFreeQ[u, x]] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && IntegerQ[2*q] && (IntegerQ[m] && IntegerQ[r] || IGtQ[q, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*x^n]), (f*x)^m*(d + e*x^r)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && IntegerQ[q] && (GtQ[q, 0] || IntegerQ[m] && IntegerQ[r])
Int[x_^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(d + e*x^(r/n))^ q*(a + b*Log[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n, p, q, r}, x] && IntegerQ[q] && IntegerQ[r/n] && IntegerQ[Simplify[(m + 1)/n]] && (GtQ[(m + 1)/n, 0] || IGtQ[p, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*x^n])^p, (f*x)^m*(d + e*x^r)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && IntegerQ[ q] && (GtQ[q, 0] || IGtQ[p, 0] && IntegerQ[m] && IntegerQ[r])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x]
Int[(f_.*x_)^m_.*u_^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[(f*x)^m*ExpandToSum[u, x]^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, f, m, n, p, q}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_)^q_*(a_. + b_.*Log[c_.*x_^n_.])^ p_., x_Symbol] := (f + g*x)^(m + 1)*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^ p/((q + 1)*(e*f - d*g)) - b*n*p/((q + 1)*(e*f - d*g))* Int[(f + g*x)^(m + 1)*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, q}, x] && NeQ[e*f - d*g, 0] && EqQ[m + q + 2, 0] && IGtQ[p, 0] && LtQ[q, -1]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.1.5 u (a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.1.5 u (a+b log(c x^n))^p *)
Int[(A_. + B_.*Log[c_.*(d_. + e_.*x_)^n_.])/ Sqrt[a_ + b_.*Log[c_.*(d_. + e_.*x_)^n_.]], x_Symbol] := B*(d + e*x)*Sqrt[a + b*Log[c*(d + e*x)^n]]/(b*e) + (2*A*b - B*(2*a + b*n))/(2*b)* Int[1/Sqrt[a + b*Log[c*(d + e*x)^n]], x] /; FreeQ[{a, b, c, d, e, A, B, n}, x]
Int[x_^m_.*(d_ + e_./x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[(e + d*x)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[m, q] && IntegerQ[q]
Int[x_^m_.*(d_ + e_.*x_^r_.)^q_.*Log[c_.*x_^n_.], x_Symbol] := With[{u = IntHide[x^m*(d + e*x^r)^q, x]}, Dist[Log[c*x^n], u, x] - n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{c, d, e, n, r}, x] && IGtQ[q, 0] && IntegerQ[m] && Not[EqQ[q, 1] && EqQ[m, -1]]
Int[x_^m_.*(d_ + e_.*x_^r_.)^q_.*(a_ + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^r)^q, x]}, u*(a + b*Log[c*x^n]) - b*n*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[q, 0] && IntegerQ[m] && Not[EqQ[q, 1] && EqQ[m, -1]]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (f*x)^(m + 1)*(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])/(d* f*(m + 1)) - b*n/(d*(m + 1))*Int[(f*x)^m*(d + e*x^r)^(q + 1), x] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m + r*(q + 1) + 1, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*x_^n_])^p_., x_Symbol] := f^m/n*Subst[Int[(d + e*x)^q*(a + b*Log[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && (IntegerQ[m] || GtQ[f, 0]) && EqQ[r, n]
Int[(f_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^p_./(d_ + e_.*x_^r_), x_Symbol] := f^m*Log[1 + e*x^r/d]*(a + b*Log[c*x^n])^p/(e*r) - b*f^m*n*p/(e*r)* Int[Log[1 + e*x^r/d]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, f, m, n, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && (IntegerQ[m] || GtQ[f, 0]) && NeQ[r, n]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := f^m*(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])^p/(e*r*(q + 1)) - b*f^m*n*p/(e*r*(q + 1))* Int[(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && (IntegerQ[m] || GtQ[f, 0]) && NeQ[r, n] && NeQ[q, -1]
Int[(f_*x_)^m_.*(d_ + e_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := (f*x)^m/x^m*Int[x^m*(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && EqQ[m, r - 1] && IGtQ[p, 0] && Not[(IntegerQ[m] || GtQ[f, 0])]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (f*x)^m*(d + e*x)^(q + 1)*(a + b*Log[c*x^n])/(e*(q + 1)) - f/(e*(q + 1))* Int[(f*x)^(m - 1)*(d + e*x)^(q + 1)*(a*m + b*n + b*m*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && ILtQ[q, -1] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := -(f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*Log[c*x^n])/(2*d* f*(q + 1)) + 1/(2*d*(q + 1))* Int[(f*x)^ m*(d + e*x^2)^(q + 1)*(a*(m + 2*q + 3) + b*n + b*(m + 2*q + 3)*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && ILtQ[q, -1] && ILtQ[m, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := d^IntPart[q]*(d + e*x^2)^FracPart[q]/(1 + e/d*x^2)^FracPart[q]* Int[x^m*(1 + e/d*x^2)^q*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[m/2] && IntegerQ[q - 1/2] && Not[LtQ[m + 2*q, -2] || GtQ[d, 0]]
Int[x_^m_.*(d1_ + e1_.*x_)^q_*(d2_ + e2_.*x_)^ q_*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := (d1 + e1*x)^q*(d2 + e2*x)^q/(1 + e1*e2/(d1*d2)*x^2)^q* Int[x^m*(1 + e1*e2/(d1*d2)*x^2)^q*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[d2*e1 + d1*e2, 0] && IntegerQ[m] && IntegerQ[q - 1/2]
Int[(a_. + b_.*Log[c_.*x_^n_])/(x_*(d_ + e_.*x_^r_.)), x_Symbol] := 1/n*Subst[Int[(a + b*Log[c*x])/(x*(d + e*x^(r/n))), x], x, x^n] /; FreeQ[{a, b, c, d, e, n, r}, x] && IntegerQ[r/n]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := 1/d*Int[(a + b*Log[c*x^n])^p/x, x] - e/d*Int[(a + b*Log[c*x^n])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 0]
(* Int[(a_.+b_.*Log[c_.*x_^n_.])^p_./(x_*(d_+e_.*x_^r_.)),x_Symbol] := (r*Log[x]-Log[1+(e*x^r)/d])*(a+b*Log[c*x^n])^p/(d*r) - b*n*p/d*Int[Log[x]*(a+b*Log[c*x^n])^(p-1)/x,x] + b*n*p/(d*r)*Int[Log[1+(e*x^r)/d]*(a+b*Log[c*x^n])^(p-1)/x,x] /; FreeQ[{a,b,c,d,e,n,r},x] && IGtQ[p,0] *)
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_./(x_*(d_ + e_.*x_^r_.)), x_Symbol] := -Log[1 + d/(e*x^r)]*(a + b*Log[c*x^n])^p/(d*r) + b*n*p/(d*r)* Int[Log[1 + d/(e*x^r)]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[p, 0]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := d*Int[(d + e*x)^(q - 1)*(a + b*Log[c*x^n])^p/x, x] + e*Int[(d + e*x)^(q - 1)*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 0] && GtQ[q, 0] && IntegerQ[2*q]
Int[(d_ + e_.*x_)^q_*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := 1/d*Int[(d + e*x)^(q + 1)*(a + b*Log[c*x^n])^p/x, x] - e/d*Int[(d + e*x)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 0] && LtQ[q, -1] && IntegerQ[2*q]
Int[(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])/x_, x_Symbol] := With[{u = IntHide[(d + e*x^r)^q/x, x]}, u*(a + b*Log[c*x^n]) - b*n*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, n, r}, x] && IntegerQ[q - 1/2]
Int[(d_ + e_.*x_^r_.)^q_*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := 1/d*Int[(d + e*x^r)^(q + 1)*(a + b*Log[c*x^n])^p/x, x] - e/d*Int[x^(r - 1)*(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, n, r}, x] && IGtQ[p, 0] && ILtQ[q, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^r)^q, x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[SimplifyIntegrand[u/x, x], x] /; (EqQ[r, 1] || EqQ[r, 2]) && IntegerQ[m] && IntegerQ[q - 1/2] || InverseFunctionFreeQ[u, x]] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && IntegerQ[2*q] && (IntegerQ[m] && IntegerQ[r] || IGtQ[q, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*x^n]), (f*x)^m*(d + e*x^r)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m, n, q, r}, x] && IntegerQ[q] && (GtQ[q, 0] || IntegerQ[m] && IntegerQ[r])
Int[x_^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(d + e*x^(r/n))^ q*(a + b*Log[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n, p, q, r}, x] && IntegerQ[q] && IntegerQ[r/n] && IntegerQ[Simplify[(m + 1)/n]] && (GtQ[(m + 1)/n, 0] || IGtQ[p, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*x^n])^p, (f*x)^m*(d + e*x^r)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x] && IntegerQ[ q] && (GtQ[q, 0] || IGtQ[p, 0] && IntegerQ[m] && IntegerQ[r])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^r_.)^q_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^r)^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q, r}, x]
Int[(f_.*x_)^m_.*u_^q_.*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[(f*x)^m*ExpandToSum[u, x]^q*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, f, m, n, p, q}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[Polyx_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[ExpandIntegrand[Polyx*(a + b*Log[c*x^n])^p, x], x] /; FreeQ[{a, b, c, n, p}, x] && PolynomialQ[Polyx, x]
Int[RFx_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*x^n])^p, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, n}, x] && RationalFunctionQ[RFx, x] && IGtQ[p, 0]
Int[RFx_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = ExpandIntegrand[RFx*(a + b*Log[c*x^n])^p, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, n}, x] && RationalFunctionQ[RFx, x] && IGtQ[p, 0]
Int[AFx_*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[AFx*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x] && AlgebraicFunctionQ[AFx, x, True]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_.*(d_ + e_.*Log[c_.*x_^n_.])^q_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[c*x^n])^p*(d + e*Log[c*x^n])^q, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[p] && IntegerQ[q]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_.*(d_. + e_.*Log[f_.*x_^r_.]), x_Symbol] := With[{u = IntHide[(a + b*Log[c*x^n])^p, x]}, Dist[d + e*Log[f*x^r], u, x] - e*r*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, f, n, p, r}, x]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_.*(d_. + e_.*Log[f_.*x_^r_.])^q_., x_Symbol] := x*(a + b*Log[c*x^n])^p*(d + e*Log[f*x^r])^q - e*q*r*Int[(a + b*Log[c*x^n])^p*(d + e*Log[f*x^r])^(q - 1), x] - b*n*p*Int[(a + b*Log[c*x^n])^(p - 1)*(d + e*Log[f*x^r])^q, x] /; FreeQ[{a, b, c, d, e, f, n, r}, x] && IGtQ[p, 0] && IGtQ[q, 0]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_.*(d_. + e_.*Log[f_.*x_^r_.])^q_., x_Symbol] := Unintegrable[(a + b*Log[c*x^n])^p*(d + e*Log[f*x^r])^q, x] /; FreeQ[{a, b, c, d, e, f, n, p, q, r}, x]
Int[(a_. + b_.*Log[v_])^p_.*(c_. + d_.*Log[v_])^q_., x_Symbol] := 1/Coeff[v, x, 1]* Subst[Int[(a + b*Log[x])^p*(c + d*Log[x])^q, x], x, v] /; FreeQ[{a, b, c, d, p, q}, x] && LinearQ[v, x] && NeQ[Coeff[v, x, 0], 0]
Int[(a_. + b_.*Log[c_.*x_^n_.])^p_.*(d_. + e_.*Log[c_.*x_^n_.])^q_./ x_, x_Symbol] := 1/n*Subst[Int[(a + b*x)^p*(d + e*x)^q, x], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, e, n, p, q}, x]
Int[(g_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_.*(d_. + e_.*Log[f_.*x_^r_.]), x_Symbol] := With[{u = IntHide[(g*x)^m*(a + b*Log[c*x^n])^p, x]}, Dist[(d + e*Log[f*x^r]), u, x] - e*r*Int[SimplifyIntegrand[u/x, x], x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, r}, x] && Not[EqQ[p, 1] && EqQ[a, 0] && NeQ[d, 0]]
Int[(g_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_.*(d_. + e_.*Log[f_.*x_^r_.])^q_., x_Symbol] := (g*x)^(m + 1)*(a + b*Log[c*x^n])^ p*(d + e*Log[f*x^r])^q/(g*(m + 1)) - e*q*r/(m + 1)* Int[(g*x)^m*(a + b*Log[c*x^n])^p*(d + e*Log[f*x^r])^(q - 1), x] - b*n*p/(m + 1)* Int[(g*x)^m*(a + b*Log[c*x^n])^(p - 1)*(d + e*Log[f*x^r])^q, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, r}, x] && IGtQ[p, 0] && IGtQ[q, 0] && NeQ[m, -1]
Int[(g_.*x_)^m_.*(a_. + b_.*Log[c_.*x_^n_.])^ p_.*(d_. + e_.*Log[f_.*x_^r_.])^q_., x_Symbol] := Unintegrable[(g*x)^m*(a + b*Log[c*x^n])^p*(d + e*Log[f*x^r])^q, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r}, x]
Int[u_^m_.*(a_. + b_.*Log[v_])^p_.*(c_. + d_.*Log[v_])^q_., x_Symbol] := With[{e = Coeff[u, x, 0], f = Coeff[u, x, 1], g = Coeff[v, x, 0], h = Coeff[v, x, 1]}, 1/h* Subst[Int[(f*x/h)^m*(a + b*Log[x])^p*(c + d*Log[x])^q, x], x, v] /; EqQ[f*g - e*h, 0] && NeQ[g, 0]] /; FreeQ[{a, b, c, d, m, p, q}, x] && LinearQ[{u, v}, x]
Int[Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = IntHide[Log[d*(e + f*x^m)^r], x]}, Dist[(a + b*Log[c*x^n])^p, u, x] - b*n*p*Int[Dist[(a + b*Log[c*x^n])^(p - 1)/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, r, m, n}, x] && IGtQ[p, 0] && RationalQ[ m] && (EqQ[p, 1] || FractionQ[m] && IntegerQ[1/m] || EqQ[r, 1] && EqQ[m, 1] && EqQ[d*e, 1])
Int[Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = IntHide[(a + b*Log[c*x^n])^p, x]}, Dist[Log[d*(e + f*x^m)^r], u, x] - f*m*r*Int[Dist[x^(m - 1)/(e + f*x^m), u, x], x]] /; FreeQ[{a, b, c, d, e, f, r, m, n}, x] && IGtQ[p, 0] && IntegerQ[m]
Int[Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[Log[d*(e + f*x^m)^r]*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, f, r, m, n, p}, x]
Int[Log[d_.*u_^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[Log[d*ExpandToSum[u, x]^r]*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, r, n, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[Log[d_.*(e_ + f_.*x_^m_.)]*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := -PolyLog[2, -d*f*x^m]*(a + b*Log[c*x^n])^p/m + b*n*p/m* Int[PolyLog[2, -d*f*x^m]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0] && EqQ[d*e, 1]
Int[Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := Log[d*(e + f*x^m)^r]*(a + b*Log[c*x^n])^(p + 1)/(b*n*(p + 1)) - f*m*r/(b*n*(p + 1))* Int[x^(m - 1)*(a + b*Log[c*x^n])^(p + 1)/(e + f*x^m), x] /; FreeQ[{a, b, c, d, e, f, r, m, n}, x] && IGtQ[p, 0] && NeQ[d*e, 1]
Int[(g_.*x_)^q_.* Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[(g*x)^q*Log[d*(e + f*x^m)^r], x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, g, r, m, n, q}, x] && (IntegerQ[(q + 1)/m] || RationalQ[m] && RationalQ[q]) && NeQ[q, -1]
Int[(g_.*x_)^q_.* Log[d_.*(e_ + f_.*x_^m_.)]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = IntHide[(g*x)^q*Log[d*(e + f*x^m)], x]}, Dist[(a + b*Log[c*x^n])^p, u, x] - b*n*p*Int[Dist[(a + b*Log[c*x^n])^(p - 1)/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, q}, x] && IGtQ[p, 0] && RationalQ[m] && RationalQ[q] && NeQ[q, -1] && (EqQ[p, 1] || FractionQ[m] && IntegerQ[(q + 1)/m] || IGtQ[q, 0] && IntegerQ[(q + 1)/m] && EqQ[d*e, 1])
Int[(g_.*x_)^q_.* Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := With[{u = IntHide[(g*x)^q*(a + b*Log[c*x^n])^p, x]}, Dist[Log[d*(e + f*x^m)^r], u, x] - f*m*r*Int[Dist[x^(m - 1)/(e + f*x^m), u, x], x]] /; FreeQ[{a, b, c, d, e, f, g, r, m, n, q}, x] && IGtQ[p, 0] && RationalQ[m] && RationalQ[q]
Int[(g_.*x_)^q_.* Log[d_.*(e_ + f_.*x_^m_.)^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(g*x)^q*Log[d*(e + f*x^m)^r]*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, r, m, n, p, q}, x]
Int[(g_.*x_)^q_.*Log[d_.*u_^r_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Int[(g*x)^q*Log[d*ExpandToSum[u, x]^r]*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, g, r, n, p, q}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[PolyLog[k_, e_.*x_^q_.]*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := -b*n*x*PolyLog[k, e*x^q] + x*PolyLog[k, e*x^q]*(a + b*Log[c*x^n]) + b*n*q*Int[PolyLog[k - 1, e*x^q], x] - q*Int[PolyLog[k - 1, e*x^q]*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, e, n, q}, x] && IGtQ[k, 0]
Int[PolyLog[k_, e_.*x_^q_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[PolyLog[k, e*x^q]*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, e, n, p, q}, x]
Int[PolyLog[k_, e_.*x_^q_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := PolyLog[k + 1, e*x^q]*(a + b*Log[c*x^n])^p/q - b*n*p/q*Int[PolyLog[k + 1, e*x^q]*(a + b*Log[c*x^n])^(p - 1)/x, x] /; FreeQ[{a, b, c, e, k, n, q}, x] && GtQ[p, 0]
Int[PolyLog[k_, e_.*x_^q_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_./x_, x_Symbol] := PolyLog[k, e*x^q]*(a + b*Log[c*x^n])^(p + 1)/(b*n*(p + 1)) - q/(b*n*(p + 1))* Int[PolyLog[k - 1, e*x^q]*(a + b*Log[c*x^n])^(p + 1)/x, x] /; FreeQ[{a, b, c, e, k, n, q}, x] && LtQ[p, -1]
Int[(d_.*x_)^m_.*PolyLog[k_, e_.*x_^q_.]*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := -b*n*(d*x)^(m + 1)*PolyLog[k, e*x^q]/(d*(m + 1)^2) + (d*x)^(m + 1)* PolyLog[k, e*x^q]*(a + b*Log[c*x^n])/(d*(m + 1)) + b*n*q/(m + 1)^2*Int[(d*x)^m*PolyLog[k - 1, e*x^q], x] - q/(m + 1)* Int[(d*x)^m*PolyLog[k - 1, e*x^q]*(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, m, n, q}, x] && IGtQ[k, 0]
Int[(d_.*x_)^m_.* PolyLog[k_, e_.*x_^q_.]*(a_. + b_.*Log[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(d*x)^m*PolyLog[k, e*x^q]*(a + b*Log[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x]
Int[Px_.*F_[d_.*(e_. + f_.*x_)]^m_.*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[Px*F[d*(e + f*x)]^m, x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && PolynomialQ[Px, x] && IGtQ[m, 0] && MemberQ[{ArcSin, ArcCos, ArcSinh, ArcCosh}, F]
Int[Px_.*F_[d_.*(e_. + f_.*x_)]*(a_. + b_.*Log[c_.*x_^n_.]), x_Symbol] := With[{u = IntHide[Px*F[d*(e + f*x)], x]}, Dist[(a + b*Log[c*x^n]), u, x] - b*n*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && PolynomialQ[Px, x] && MemberQ[{ArcTan, ArcCot, ArcTanh, ArcCoth}, F]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.2.1 (f+g x)^m (A+B log(e ((a+b x) over (c+d x))^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.2.1 (f+g x)^m (A+B log(e ((a+b x) over (c+d x))^n))^p *)
Int[(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (a + b*x)*(A + B*Log[e*((a + b*x)/(c + d*x))^n])^p/b - B*n*p*(b*c - a*d)/b* Int[(A + B*Log[e*((a + b*x)/(c + d*x))^n])^(p - 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[p, 0]
Int[(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^p_., x_Symbol] := (a + b*x)*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])^p/b - B*n*p*(b*c - a*d)/b* Int[(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])^(p - 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && EqQ[n + mn, 0] && NeQ[b*c - a*d, 0] && IGtQ[p, 0]
(* Int[(A_.+B_.*Log[e_.*((a_.+b_.*x_)^n1_.*(c_.+d_.*x_)^n2_)^n_.])^p_. ,x_Symbol] := (a+b*x)*(A+B*Log[e*((a+b*x)^n1/(c+d*x)^n1)^n])^p/b - B*n*p*(b*c-a*d)/b*Int[(A+B*Log[e*((a+b*x)^n1/(c+d*x)^n1)^n])^(p-1)/( c+d*x),x] /; FreeQ[{a,b,c,d,e,A,B,n},x] && EqQ[n1+n2,0] && GtQ[n1,0] && (EqQ[n1,1]  || EqQ[n,1]) && NeQ[b*c-a*d,0] && IGtQ[p,0] *)
Int[(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_, x_Symbol] := Unintegrable[(A + B*Log[e*((a + b*x)/(c + d*x))^n])^p, x] /; FreeQ[{a, b, c, d, e, A, B, n, p}, x]
Int[(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^p_, x_Symbol] := Unintegrable[(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, A, B, n, p}, x] && EqQ[n + mn, 0]
Int[(A_. + B_.*Log[e_.*(u_/v_)^n_.])^p_., x_Symbol] := Int[(A + B*Log[e*(ExpandToSum[u, x]/ExpandToSum[v, x])^n])^p, x] /; FreeQ[{e, A, B, n, p}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[(A_. + B_.*Log[e_.*u_^n_.*v_^mn_])^p_., x_Symbol] := Int[(A + B*Log[e*ExpandToSum[u, x]^n/ExpandToSum[v, x]^n])^p, x] /; FreeQ[{e, A, B, n, p}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])/(f_. + g_.*x_), x_Symbol] := -Log[-(b*c - a*d)/(d*(a + b*x))]*(A + B*Log[e*((a + b*x)/(c + d*x))^n])/g + B*n*(b*c - a*d)/g* Int[Log[-(b*c - a*d)/(d*(a + b*x))]/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0]
Int[(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])/(f_. + g_.*x_), x_Symbol] := -Log[-(b*c - a*d)/(d*(a + b*x))]*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])/g + B*n*(b*c - a*d)/g* Int[Log[-(b*c - a*d)/(d*(a + b*x))]/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && EqQ[n + mn, 0] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0]
Int[(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])/(f_. + g_.*x_), x_Symbol] := -Log[(b*c - a*d)/(b*(c + d*x))]*(A + B*Log[e*((a + b*x)/(c + d*x))^n])/g + B*n*(b*c - a*d)/g* Int[Log[(b*c - a*d)/(b*(c + d*x))]/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[d*f - c*g, 0]
Int[(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])/(f_. + g_.*x_), x_Symbol] := -Log[(b*c - a*d)/(b*(c + d*x))]*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])/g + B*n*(b*c - a*d)/g* Int[Log[(b*c - a*d)/(b*(c + d*x))]/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && EqQ[n + mn, 0] && NeQ[b*c - a*d, 0] && EqQ[d*f - c*g, 0]
Int[(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])/(f_. + g_.*x_), x_Symbol] := Log[f + g*x]*(A + B*Log[e*((a + b*x)/(c + d*x))^n])/g - b*B*n/g*Int[Log[f + g*x]/(a + b*x), x] + B*d*n/g*Int[Log[f + g*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && NeQ[b*c - a*d, 0]
Int[(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])/(f_. + g_.*x_), x_Symbol] := Log[f + g*x]*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])/g - b*B*n/g*Int[Log[f + g*x]/(a + b*x), x] + B*d*n/g*Int[Log[f + g*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && EqQ[n + mn, 0] && NeQ[b*c - a*d, 0]
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.]), x_Symbol] := (f + g*x)^(m + 1)*(A + B*Log[e*((a + b*x)/(c + d*x))^n])/(g*(m + 1)) - B*n*(b*c - a*d)/(g*(m + 1))* Int[(f + g*x)^(m + 1)/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[m, -1] && NeQ[m, -2]
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_]), x_Symbol] := (f + g*x)^(m + 1)*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])/(g*(m + 1)) - B*n*(b*c - a*d)/(g*(m + 1))* Int[(f + g*x)^(m + 1)/((a + b*x)*(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, m, n}, x] && EqQ[n + mn, 0] && NeQ[b*c - a*d, 0] && NeQ[m, -1] && Not[EqQ[m, -2] && IntegerQ[n]]
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (b*c - a*d)^(m + 1)*(g/b)^m* Subst[Int[x^m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && NeQ[b*c - a*d, 0] && IntegersQ[m, p] && EqQ[b*f - a*g, 0] && (GtQ[p, 0] || LtQ[m, -1])
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := (b*c - a*d)^(m + 1)*(g/b)^m* Subst[Int[x^m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && IntegersQ[m, p] && EqQ[b*f - a*g, 0] && (GtQ[p, 0] || LtQ[m, -1])
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (b*c - a*d)^(m + 1)*(g/d)^m* Subst[Int[(A + B*Log[e*x^n])^p/(b - d*x)^(m + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && NeQ[b*c - a*d, 0] && IntegersQ[m, p] && EqQ[d*f - c*g, 0] && (GtQ[p, 0] || LtQ[m, -1])
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := (b*c - a*d)^(m + 1)*(g/d)^m* Subst[Int[(A + B*Log[e*x^n])^p/(b - d*x)^(m + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && IntegersQ[m, p] && EqQ[d*f - c*g, 0] && (GtQ[p, 0] || LtQ[m, -1])
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (b*c - a*d)* Subst[Int[(b*f - a*g - (d*f - c*g)*x)^ m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IGtQ[p, 0]
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := (b*c - a*d)* Subst[Int[(b*f - a*g - (d*f - c*g)*x)^ m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, A, B, n}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IGtQ[p, 0]
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := Unintegrable[(f + g*x)^m*(A + B*Log[e*((a + b*x)/(c + d*x))^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, A, B, m, n, p}, x]
Int[(f_. + g_.*x_)^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := Unintegrable[(f + g*x)^m*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, A, B, m, n, p}, x] && EqQ[n + mn, 0] && IntegerQ[n]
Int[w_^m_.*(A_. + B_.*Log[e_.*(u_/v_)^n_.])^p_., x_Symbol] := Int[ExpandToSum[w, x]^ m*(A + B*Log[e*(ExpandToSum[u, x]/ExpandToSum[v, x])^n])^p, x] /; FreeQ[{e, A, B, m, n, p}, x] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]
Int[w_^m_.*(A_. + B_.*Log[e_.*u_^n_.*v_^mn_])^p_., x_Symbol] := Int[ExpandToSum[w, x]^ m*(A + B*Log[e*ExpandToSum[u, x]^n/ExpandToSum[v, x]^n])^p, x] /; FreeQ[{e, A, B, m, n, p}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.2.2 (f+g x)^m (h+i x)^q (A+B log(e ((a+b x) over (c+d x))^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.2.2 (f+g x)^m (h+i x)^q (A+B log(e ((a+b x) over (c+d x))^n))^p *)
Int[(f_. + g_.*x_)^ m_.*(h_. + i_.*x_)*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.]), x_Symbol] := (f + g*x)^(m + 1)*(h + i*x)*(A + B*Log[e*((a + b*x)/(c + d*x))^n])/(g*(m + 2)) + i*(b*c - a*d)/(b*d*(m + 2))* Int[(f + g*x)^m*(A - B*n + B*Log[e*((a + b*x)/(c + d*x))^n]), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0] && EqQ[d*h - c*i, 0] && IGtQ[m, -2]
Int[(f_. + g_.*x_)^ m_.*(h_. + i_.*x_)*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_]), x_Symbol] := (f + g*x)^(m + 1)*(h + i*x)*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])/(g*(m + 2)) + i*(b*c - a*d)/(b*d*(m + 2))* Int[(f + g*x)^m*(A - B*n + B*Log[e*(a + b*x)^n/(c + d*x)^n]), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, m, n}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0] && EqQ[d*h - c*i, 0] && IGtQ[m, -2]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (b*c - a*d)^(m + q + 1)*(g/b)^m*(i/d)^q* Subst[Int[x^m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + q + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0] && EqQ[d*h - c*i, 0] && IntegersQ[m, q]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := (b*c - a*d)^(m + q + 1)*(g/b)^m*(i/d)^q* Subst[Int[x^m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + q + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, n, p}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0] && EqQ[d*h - c*i, 0] && IntegersQ[m, q]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := d^2*(g*(a + b*x)/b)^ m/(i^2*(b*c - a*d)*(i*(c + d*x)/d)^m*((a + b*x)/(c + d*x))^m)* Subst[Int[x^m*(A + B*Log[e*x^n])^p, x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, m, n, p, q}, x] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0] && EqQ[d*h - c*i, 0] && EqQ[m + q + 2, 0]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := d^2*(g*(a + b*x)/b)^ m/(i^2*(b*c - a*d)*(i*(c + d*x)/d)^m*((a + b*x)/(c + d*x))^m)* Subst[Int[x^m*(A + B*Log[e*x^n])^p, x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, m, n, p, q}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && EqQ[b*f - a*g, 0] && EqQ[d*h - c*i, 0] && EqQ[m + q + 2, 0]
(* Int[(f_.+g_.*x_)^m_.*(h_.+i_.*x_)^q_.*(A_.+B_.*Log[e_.*(a_.+b_.*x_) ^n_.*(c_.+d_.*x_)^mn_])^p_.,x_Symbol] := b*d*(f+g*x)^(m+1)/(g*i*(b*c-a*d)*(h+i*x)^(m+1)*((a+b*x)/(c+d*x))^(m+ 1))* Subst[Int[x^m*(A+B*Log[e*x^n])^p,x],x,(a+b*x)/(c+d*x)] /; FreeQ[{a,b,c,d,e,f,g,h,i,A,B,m,n,p,q},x] && EqQ[n+mn,0] &&  NeQ[b*c-a*d,0] && EqQ[b*f-a*g,0] && EqQ[d*h-c*i,0] && EqQ[m+q+2,0] *)
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (b*c - a*d)^(q + 1)*(i/d)^q* Subst[Int[(b*f - a*g - (d*f - c*g)*x)^ m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + q + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, n}, x] && NeQ[b*c - a*d, 0] && IntegersQ[m, q] && IGtQ[p, 0] && EqQ[d*h - c*i, 0]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := (b*c - a*d)^(q + 1)*(i/d)^q* Subst[Int[(b*f - a*g - (d*f - c*g)*x)^ m*(A + B*Log[e*x^n])^p/(b - d*x)^(m + q + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, n}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && IntegersQ[m, q] && IGtQ[p, 0] && EqQ[d*h - c*i, 0]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := (b*c - a*d)* Subst[Int[(b*f - a*g - (d*f - c*g)*x)^ m*(b*h - a*i - (d*h - c*i)*x)^ q*(A + B*Log[e*x^n])^p/(b - d*x)^(m + q + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, n}, x] && NeQ[b*c - a*d, 0] && IntegersQ[m, q] && IGtQ[p, 0]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := (b*c - a*d)* Subst[Int[(b*f - a*g - (d*f - c*g)*x)^ m*(b*h - a*i - (d*h - c*i)*x)^ q*(A + B*Log[e*x^n])^p/(b - d*x)^(m + q + 2), x], x, (a + b*x)/(c + d*x)] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, n}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && IntegersQ[m, q] && IGtQ[p, 0]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := Unintegrable[(f + g*x)^m*(h + i*x)^ q*(A + B*Log[e*((a + b*x)/(c + d*x))^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, m, n, p, q}, x]
Int[(f_. + g_.*x_)^m_.*(h_. + i_.*x_)^ q_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := Unintegrable[(f + g*x)^m*(h + i*x)^ q*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, A, B, m, n, p, q}, x] && EqQ[n + mn, 0] && IntegerQ[n]
Int[w_^m_.*y_^q_.*(A_. + B_.*Log[e_.*(u_/v_)^n_.])^p_., x_Symbol] := Int[ExpandToSum[w, x]^m* ExpandToSum[y, x]^ q*(A + B*Log[e*(ExpandToSum[u, x]/ExpandToSum[v, x])^n])^p, x] /; FreeQ[{e, A, B, m, n, p, q}, x] && LinearQ[{u, v, w, y}, x] && Not[LinearMatchQ[{u, v, w, y}, x]]
Int[w_^m_.*y_^q_.*(A_. + B_.*Log[e_.*u_^n_.*v_^mn_])^p_., x_Symbol] := Int[ExpandToSum[w, x]^m* ExpandToSum[y, x]^ q*(A + B*Log[e*ExpandToSum[u, x]^n/ExpandToSum[v, x]^n])^p, x] /; FreeQ[{e, A, B, m, n, p, q}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && LinearQ[{u, v, w, y}, x] && Not[LinearMatchQ[{u, v, w, y}, x]]
Int[w_.*(A_. + B_.*Log[e_.*u_^n_.*v_^mn_])^p_., x_Symbol] := Subst[Int[w*(A + B*Log[e*(u/v)^n])^p, x], e*(u/v)^n, e*u^n/v^n] /; FreeQ[{e, A, B, n, p}, x] && EqQ[n + mn, 0] && LinearQ[{u, v}, x] && Not[IntegerQ[n]]
(* Int[w_.*(A_.+B_.*Log[e_.*(f_.*u_^q_.*v_^mq_)^n_.])^p_.,x_Symbol] := Subst[Int[w*(A+B*Log[e*f^n*(u/v)^(n*q)])^p,x],e*f^n*(u/v)^(n*q),e*( f*(u^q/v^q))^n] /; FreeQ[{e,f,A,B,n,p,q},x] && EqQ[q+mq,0] && LinearQ[{u,v},x] &&  Not[IntegerQ[n]] *)
Int[(f_. + g_.*x_ + h_.*x_^2)^ m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^p_., x_Symbol] := h^m/(b^m*d^m)* Int[(a + b*x)^m*(c + d*x)^m*(A + B*Log[e*((a + b*x)/(c + d*x))^n])^ p, x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B, n, p}, x] && EqQ[b*d*f - a*c*h, 0] && EqQ[b*d*g - h*(b*c + a*d), 0] && IntegerQ[m]
Int[(f_. + g_.*x_ + h_.*x_^2)^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := h^m/(b^m*d^m)* Int[(a + b*x)^m*(c + d*x)^m*(A + B*Log[e*(a + b*x)^n/(c + d*x)^n])^ p, x] /; FreeQ[{a, b, c, d, e, f, g, h, A, B, n, p}, x] && EqQ[n + mn, 0] && IGtQ[n, 0] && EqQ[b*d*f - a*c*h, 0] && EqQ[b*d*g - h*(b*c + a*d), 0] && IntegerQ[m]
Int[P2x_^m_.*(A_. + B_.*Log[e_.*((a_. + b_.*x_)/(c_. + d_.*x_))^n_.])^ p_., x_Symbol] := With[{f = Coeff[P2x, x, 0], g = Coeff[P2x, x, 1], h = Coeff[P2x, x, 2]}, (b*c - a*d)* Subst[ Int[(b^2*f - a*b*g + a^2*h - (2*b*d*f - b*c*g - a*d*g + 2*a*c*h)* x + (d^2*f - c*d*g + c^2*h)*x^2)^m*(A + B*Log[e*x^n])^p/ (b - d*x)^(2*(m + 1)), x], x, (a + b*x)/(c + d*x)]] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && PolyQ[P2x, x, 2] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IGtQ[p, 0]
Int[P2x_^ m_.*(A_. + B_.*Log[e_.*(a_. + b_.*x_)^n_.*(c_. + d_.*x_)^mn_])^ p_., x_Symbol] := With[{f = Coeff[P2x, x, 0], g = Coeff[P2x, x, 1], h = Coeff[P2x, x, 2]}, (b*c - a*d)* Subst[ Int[(b^2*f - a*b*g + a^2*h - (2*b*d*f - b*c*g - a*d*g + 2*a*c*h)* x + (d^2*f - c*d*g + c^2*h)*x^2)^m*(A + B*Log[e*x^n])^p/ (b - d*x)^(2*(m + 1)), x], x, (a + b*x)/(c + d*x)]] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && PolyQ[P2x, x, 2] && EqQ[n + mn, 0] && IGtQ[n, 0] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IGtQ[p, 0]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.2.3 u log(e (f (a+b x)^p (c+d x)^q)^r)^s.m
*)

(* ::Subsection::Closed:: *)
(* 3.2.3 u log(e (f (a+b x)^p (c+d x)^q)^r)^s *)
Int[u_.*Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := Int[u*Log[e*(b^p*f/d^p*(c + d*x)^(p + q))^r]^s, x] /; FreeQ[{a, b, c, d, e, f, p, q, r, s}, x] && EqQ[b*c - a*d, 0] && IntegerQ[p]
Int[Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := (a + b*x)*Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^s/b - r*s*(p + q)* Int[Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s - 1), x] + q*r*s*(b*c - a*d)/b* Int[Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s - 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, p, q, r, s}, x] && NeQ[b*c - a*d, 0] && NeQ[p + q, 0] && IGtQ[s, 0] && LtQ[s, 4]
Int[Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]/(g_. + h_.*x_), x_Symbol] := Log[g + h*x]*Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]/h - b*p*r/h*Int[Log[g + h*x]/(a + b*x), x] - d*q*r/h*Int[Log[g + h*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, p, q, r}, x] && NeQ[b*c - a*d, 0]
Int[(g_. + h_.*x_)^m_.* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.], x_Symbol] := (g + h*x)^(m + 1)* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]/(h*(m + 1)) - b*p*r/(h*(m + 1))*Int[(g + h*x)^(m + 1)/(a + b*x), x] - d*q*r/(h*(m + 1))*Int[(g + h*x)^(m + 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, m, p, q, r}, x] && NeQ[b*c - a*d, 0] && NeQ[m, -1]
Int[Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^2/(g_. + h_.*x_), x_Symbol] := Int[(Log[(a + b*x)^(p*r)] + Log[(c + d*x)^(q*r)])^2/(g + h*x), x] + (Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r] - Log[(a + b*x)^(p*r)] - Log[(c + d*x)^(q*r)])* (2*Int[Log[(c + d*x)^(q*r)]/(g + h*x), x] + Int[(Log[(a + b*x)^(p*r)] - Log[(c + d*x)^(q*r)] + Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r])/(g + h*x), x]) /; FreeQ[{a, b, c, d, e, f, g, h, p, q, r}, x] && NeQ[b*c - a*d, 0] && EqQ[b*g - a*h, 0]
(* Int[Log[e_.*(f_.*(a_.+b_.*x_)^p_.*(c_.+d_.*x_)^q_.)^r_.]^2/(g_.+h_. *x_),x_Symbol] := Int[(Log[(a+b*x)^(p*r)]+Log[(c+d*x)^(q*r)])^2/(g+h*x),x] + (Log[e*(f*(a+b*x)^p*(c+d*x)^q)^r]-Log[(a+b*x)^(p*r)]-Log[(c+d*x)^(q* r)])* Int[(Log[(a+b*x)^(p*r)]+Log[(c+d*x)^(q*r)]+Log[e*(f*(a+b*x)^p*(c+ d*x)^q)^r])/(g+h*x),x] /; FreeQ[{a,b,c,d,e,f,g,h,p,q,r},x] && NeQ[b*c-a*d,0] && EqQ[b*g-a*h,0] *)
Int[Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^2/(g_. + h_.*x_), x_Symbol] := Log[g + h*x]*Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^2/h - 2*b*p*r/h* Int[Log[g + h*x]*Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]/(a + b*x), x] - 2*d*q*r/h* Int[Log[g + h*x]*Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, p, q, r}, x] && NeQ[b*c - a*d, 0]
Int[(g_. + h_.*x_)^m_.* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_, x_Symbol] := (g + h*x)^(m + 1)* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^s/(h*(m + 1)) - b*p*r*s/(h*(m + 1))* Int[(g + h*x)^(m + 1)* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s - 1)/(a + b*x), x] - d*q*r*s/(h*(m + 1))* Int[(g + h*x)^(m + 1)* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s - 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, m, p, q, r, s}, x] && NeQ[b*c - a*d, 0] && IGtQ[s, 0] && NeQ[m, -1]
Int[(s_. + t_.*Log[i_.*(g_. + h_.*x_)^n_.])^m_.* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]/(j_. + k_.*x_), x_Symbol] := (s + t*Log[i*(g + h*x)^n])^(m + 1)* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]/(k*n*t*(m + 1)) - b*p*r/(k*n*t*(m + 1))* Int[(s + t*Log[i*(g + h*x)^n])^(m + 1)/(a + b*x), x] - d*q*r/(k*n*t*(m + 1))* Int[(s + t*Log[i*(g + h*x)^n])^(m + 1)/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, k, s, t, m, n, p, q, r}, x] && NeQ[b*c - a*d, 0] && EqQ[h*j - g*k, 0] && IGtQ[m, 0]
Int[(s_. + t_.*Log[i_.*(g_. + h_.*x_)^n_.])* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]/(j_. + k_.*x_), x_Symbol] := (Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r] - Log[(a + b*x)^(p*r)] - Log[(c + d*x)^(q*r)])* Int[(s + t*Log[i*(g + h*x)^n])/(j + k*x), x] + Int[(Log[(a + b*x)^(p*r)]*(s + t*Log[i*(g + h*x)^n]))/(j + k*x), x] + Int[(Log[(c + d*x)^(q*r)]*(s + t*Log[i*(g + h*x)^n]))/(j + k*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, k, s, t, n, p, q, r}, x] && NeQ[b*c - a*d, 0]
Int[(s_. + t_.*Log[i_.*(g_. + h_.*x_)^n_.])^m_.* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^ u_./(j_. + k_.*x_), x_Symbol] := Unintegrable[(s + t*Log[i*(g + h*x)^n])^m* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^u/(j + k*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, k, s, t, m, n, p, q, r, u}, x] && NeQ[b*c - a*d, 0]
Int[u_*Log[v_]* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := With[{g = Simplify[(v - 1)*(c + d*x)/(a + b*x)], h = Simplify[u*(a + b*x)*(c + d*x)]}, -h*PolyLog[2, 1 - v]* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^s/(b*c - a*d) + h*p*r*s* Int[PolyLog[2, 1 - v]* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s - 1)/((a + b*x)*(c + d*x)), x] /; FreeQ[{g, h}, x]] /; FreeQ[{a, b, c, d, e, f, p, q, r, s}, x] && NeQ[b*c - a*d, 0] && IGtQ[s, 0] && EqQ[p + q, 0]
Int[v_*Log[i_.*(j_.*(g_. + h_.*x_)^t_.)^u_.]* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := With[{k = Simplify[v*(a + b*x)*(c + d*x)]}, k*Log[i*(j*(g + h*x)^t)^u]* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s + 1)/(p* r*(s + 1)*(b*c - a*d)) - k*h*t*u/(p*r*(s + 1)*(b*c - a*d))* Int[Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s + 1)/(g + h*x), x] /; FreeQ[k, x]] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, p, q, r, s, t, u}, x] && NeQ[b*c - a*d, 0] && EqQ[p + q, 0] && NeQ[s, -1]
Int[u_*PolyLog[n_, v_]* Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := With[{g = Simplify[v*(c + d*x)/(a + b*x)], h = Simplify[u*(a + b*x)*(c + d*x)]}, h*PolyLog[n + 1, v]* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^s/(b*c - a*d) - h*p*r*s* Int[PolyLog[n + 1, v]* Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^(s - 1)/((a + b*x)*(c + d*x)), x] /; FreeQ[{g, h}, x]] /; FreeQ[{a, b, c, d, e, f, n, p, q, r, s}, x] && NeQ[b*c - a*d, 0] && IGtQ[s, 0] && EqQ[p + q, 0]
Int[(a_. + b_.*Log[c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]])^ n_./(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := 2*e*g/(C*(e*f - d*g))* Subst[Int[(a + b*Log[c*x])^n/x, x], x, Sqrt[d + e*x]/Sqrt[f + g*x]] /; FreeQ[{a, b, c, d, e, f, g, A, B, C, n}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[B*e*g - C*(e*f + d*g), 0]
Int[(a_. + b_.*Log[c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]])^ n_./(A_. + C_.*x_^2), x_Symbol] := g/(C*f)* Subst[Int[(a + b*Log[c*x])^n/x, x], x, Sqrt[d + e*x]/Sqrt[f + g*x]] /; FreeQ[{a, b, c, d, e, f, g, A, C, n}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[e*f + d*g, 0]
Int[RFx_.*Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.], x_Symbol] := p*r*Int[RFx*Log[a + b*x], x] + q*r*Int[RFx*Log[c + d*x], x] - (p*r*Log[a + b*x] + q*r*Log[c + d*x] - Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r])*Int[RFx, x] /; FreeQ[{a, b, c, d, e, f, p, q, r}, x] && RationalFunctionQ[RFx, x] && NeQ[b*c - a*d, 0] && Not[ MatchQ[RFx, u_.*(a + b*x)^m_.*(c + d*x)^n_. /; IntegersQ[m, n]]]
(* Int[RFx_*Log[e_.*(f_.*(a_.+b_.*x_)^p_.*(c_.+d_.*x_)^q_.)^r_.],x_ Symbol] := With[{u=IntHide[RFx,x]}, u*Log[e*(f*(a+b*x)^p*(c+d*x)^q)^r] - b*p*r*Int[u/(a+b*x),x] -  d*q*r*Int[u/(c+d*x),x] /; NonsumQ[u]] /; FreeQ[{a,b,c,d,e,f,p,q,r},x] && RationalFunctionQ[RFx,x] &&  NeQ[b*c-a*d,0] *)
Int[RFx_*Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := With[{u = ExpandIntegrand[Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^s, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, p, q, r, s}, x] && RationalFunctionQ[RFx, x] && IGtQ[s, 0]
Int[RFx_*Log[e_.*(f_.*(a_. + b_.*x_)^p_.*(c_. + d_.*x_)^q_.)^r_.]^s_., x_Symbol] := Unintegrable[RFx*Log[e*(f*(a + b*x)^p*(c + d*x)^q)^r]^s, x] /; FreeQ[{a, b, c, d, e, f, p, q, r, s}, x] && RationalFunctionQ[RFx, x]
Int[u_.*Log[e_.*(f_.*v_^p_.*w_^q_.)^r_.]^s_., x_Symbol] := Int[u*Log[e*(f*ExpandToSum[v, x]^p*ExpandToSum[w, x]^q)^r]^s, x] /; FreeQ[{e, f, p, q, r, s}, x] && LinearQ[{v, w}, x] && Not[LinearMatchQ[{v, w}, x]] && AlgebraicFunctionQ[u, x]
Int[u_.*Log[e_.*(f_.*(g_ + v_./w_))^r_.]^s_., x_Symbol] := Int[u*Log[e*(f*ExpandToSum[v + g*w, x]/ExpandToSum[w, x])^r]^s, x] /; FreeQ[{e, f, g, r, s}, x] && LinearQ[w, x] && (FreeQ[v, x] || LinearQ[v, x]) && AlgebraicFunctionQ[u, x]
(* Int[Log[g_.*(h_.*(a_.+b_.*x_)^p_.)^q_.]*Log[i_.*(j_.*(c_.+d_.*x_)^ r_.)^s_.]/(e_+f_.*x_),x_Symbol] := 1/f*Subst[Int[Log[g*(h*Simp[-(b*e-a*f)/f+b*x/f,x]^p)^q]*Log[i*(j* Simp[-(d*e-c*f)/f+d*x/f,x]^r)^s]/x,x],x,e+f*x] /; FreeQ[{a,b,c,d,e,f,g,h,i,j,p,q,r,s},x] *)

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.3 u (a+b log(c (d+e x)^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.3 u (a+b log(c (d+e x)^n))^p *)
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := 1/e*Subst[Int[(a + b*Log[c*x^n])^p, x], x, d + e*x] /; FreeQ[{a, b, c, d, e, n, p}, x]
Int[(f_ + g_. x_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := 1/e*Subst[Int[(f*x/d)^q*(a + b*Log[c*x^n])^p, x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q}, x] && EqQ[e*f - d*g, 0]
Int[Log[c_.*(d_ + e_.*x_^n_.)]/x_, x_Symbol] := -PolyLog[2, -c*e*x^n]/n /; FreeQ[{c, d, e, n}, x] && EqQ[c*d, 1]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)])/x_, x_Symbol] := (a + b*Log[c*d])*Log[x] + b*Int[Log[1 + e*x/d]/x, x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[c*d, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)])/(f_. + g_. x_), x_Symbol] := 1/g*Subst[Int[(a + b*Log[1 + c*e*x/g])/x, x], x, f + g*x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[e*f - d*g, 0] && EqQ[g + c*(e*f - d*g), 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])/(f_. + g_. x_), x_Symbol] := Log[e*(f + g*x)/(e*f - d*g)]*(a + b*Log[c*(d + e*x)^n])/g - b*e*n/g*Int[Log[(e*(f + g*x))/(e*f - d*g)]/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0]
Int[(f_. + g_.*x_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := (f + g*x)^(q + 1)*(a + b*Log[c*(d + e*x)^n])/(g*(q + 1)) - b*e*n/(g*(q + 1))*Int[(f + g*x)^(q + 1)/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n, q}, x] && NeQ[e*f - d*g, 0] && NeQ[q, -1]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_/(f_. + g_. x_), x_Symbol] := Log[e*(f + g*x)/(e*f - d*g)]*(a + b*Log[c*(d + e*x)^n])^p/g - b*e*n*p/g* Int[Log[(e*(f + g*x))/(e*f - d*g)]*(a + b*Log[c*(d + e*x)^n])^(p - 1)/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && IGtQ[p, 1]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_/(f_. + g_.*x_)^2, x_Symbol] := (d + e*x)*(a + b*Log[c*(d + e*x)^n])^p/((e*f - d*g)*(f + g*x)) - b*e*n*p/(e*f - d*g)* Int[(a + b*Log[c*(d + e*x)^n])^(p - 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && GtQ[p, 0]
Int[(f_. + g_.*x_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_, x_Symbol] := (f + g*x)^(q + 1)*(a + b*Log[c*(d + e*x)^n])^p/(g*(q + 1)) - b*e*n*p/(g*(q + 1))* Int[(f + g*x)^(q + 1)*(a + b*Log[c*(d + e*x)^n])^(p - 1)/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n, q}, x] && NeQ[e*f - d*g, 0] && GtQ[p, 0] && NeQ[q, -1] && IntegersQ[2*p, 2*q] && (Not[IGtQ[q, 0]] || EqQ[p, 2] && NeQ[q, 1])
Int[(f_. + g_.*x_)^q_./(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := Int[ExpandIntegrand[(f + g*x)^q/(a + b*Log[c*(d + e*x)^n]), x], x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && IGtQ[q, 0]
Int[(f_. + g_.*x_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_, x_Symbol] := (d + e*x)*(f + g*x)^ q*(a + b*Log[c*(d + e*x)^n])^(p + 1)/(b*e*n*(p + 1)) + q*(e*f - d*g)/(b*e*n*(p + 1))* Int[(f + g*x)^(q - 1)*(a + b*Log[c*(d + e*x)^n])^(p + 1), x] - (q + 1)/(b*n*(p + 1))* Int[(f + g*x)^q*(a + b*Log[c*(d + e*x)^n])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && NeQ[e*f - d*g, 0] && LtQ[p, -1] && GtQ[q, 0]
Int[(f_. + g_.*x_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_, x_Symbol] := Int[ExpandIntegrand[(f + g*x)^q*(a + b*Log[c*(d + e*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[e*f - d*g, 0] && IGtQ[q, 0]
Int[Log[c_./(d_ + e_.*x_)]/(f_ + g_.*x_^2), x_Symbol] := -e/g*Subst[Int[Log[2*d*x]/(1 - 2*d*x), x], x, 1/(d + e*x)] /; FreeQ[{c, d, e, f, g}, x] && EqQ[c, 2*d] && EqQ[e^2*f + d^2*g, 0]
Int[(a_. + b_.*Log[c_./(d_ + e_.*x_)])/(f_ + g_.*x_^2), x_Symbol] := (a + b*Log[c/(2*d)])*Int[1/(f + g*x^2), x] + b*Int[Log[2*d/(d + e*x)]/(f + g*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e^2*f + d^2*g, 0] && GtQ[c/(2*d), 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])/Sqrt[f_ + g_.*x_^2], x_Symbol] := With[{u = IntHide[1/Sqrt[f + g*x^2], x]}, u*(a + b*Log[c*(d + e*x)^n]) - b*e*n*Int[SimplifyIntegrand[u/(d + e*x), x], x]] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && GtQ[f, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])/(Sqrt[f1_ + g1_.*x_]* Sqrt[f2_ + g2_.*x_]), x_Symbol] := With[{u = IntHide[1/Sqrt[f1*f2 + g1*g2*x^2], x]}, u*(a + b*Log[c*(d + e*x)^n]) - b*e*n*Int[SimplifyIntegrand[u/(d + e*x), x], x]] /; FreeQ[{a, b, c, d, e, f1, g1, f2, g2, n}, x] && EqQ[f2*g1 + f1*g2, 0] && GtQ[f1, 0] && GtQ[f2, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])/Sqrt[f_ + g_.*x_^2], x_Symbol] := Sqrt[1 + g/f*x^2]/Sqrt[f + g*x^2]* Int[(a + b*Log[c*(d + e*x)^n])/Sqrt[1 + g/f*x^2], x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && Not[GtQ[f, 0]]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])/(Sqrt[f1_ + g1_.*x_]* Sqrt[f2_ + g2_.*x_]), x_Symbol] := Sqrt[1 + g1*g2/(f1*f2)*x^2]/(Sqrt[f1 + g1*x]*Sqrt[f2 + g2*x])* Int[(a + b*Log[c*(d + e*x)^n])/Sqrt[1 + g1*g2/(f1*f2)*x^2], x] /; FreeQ[{a, b, c, d, e, f1, g1, f2, g2, n}, x] && EqQ[f2*g1 + f1*g2, 0]
Int[(f_. + g_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := With[{k = Denominator[r]}, k*Subst[ Int[x^(k - 1)*(f + g*x^(k*r))^q*(a + b*Log[c*(d + e*x^k)^n])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, n, p, q}, x] && FractionQ[r] && IGtQ[p, 0]
Int[(f_ + g_.*x_^r_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[c*(d + e*x)^n])^p, (f + g*x^r)^q, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, r}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || IntegerQ[r] && NeQ[r, 1])
Int[x_^m_.*Log[c_.*(d_ + e_.*x_)]/(f_ + g_. x_), x_Symbol] := Int[ExpandIntegrand[Log[c*(d + e*x)], x^m/(f + g*x), x], x] /; FreeQ[{c, d, e, f, g}, x] && EqQ[e*f - d*g, 0] && EqQ[c*d, 1] && IntegerQ[m]
Int[(f_. + g_. x_)^q_.*(h_. + i_. x_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := 1/e*Subst[ Int[(g*x/e)^q*((e*h - d*i)/e + i*x/e)^r*(a + b*Log[c*x^n])^p, x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, h, i, n, p, q, r}, x] && EqQ[e*f - d*g, 0] && (IGtQ[p, 0] || IGtQ[r, 0]) && IntegerQ[2*r]
Int[x_^m_.*(f_ + g_./x_)^q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_., x_Symbol] := Int[(g + f*x)^q*(a + b*Log[c*(d + e*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q}, x] && EqQ[m, q] && IntegerQ[q]
Int[x_^m_.*(f_. + g_.*x_^r_.)^ q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := (f + g*x^r)^(q + 1)*(a + b*Log[c*(d + e*x)^n])^p/(g*r*(q + 1)) - b*e*n*p/(g*r*(q + 1))* Int[(f + g*x^r)^(q + 1)*(a + b*Log[c*(d + e*x)^n])^(p - 1)/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, q, r}, x] && EqQ[m, r - 1] && NeQ[q, -1] && IGtQ[p, 0]
Int[x_^m_.*(f_ + g_.*x_^r_.)^ q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := With[{u = IntHide[x^m*(f + g*x^r)^q, x]}, Dist[(a + b*Log[c*(d + e*x)^n]), u, x] - b*e*n*Int[SimplifyIntegrand[u/(d + e*x), x], x] /; InverseFunctionFreeQ[u, x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, q, r}, x] && IntegerQ[m] && IntegerQ[q] && IntegerQ[r]
Int[x_^m_.*(f_. + g_.*x_^r_)^ q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := With[{k = Denominator[r]}, k*Subst[ Int[x^(k*(m + 1) - 1)*(f + g*x^(k*r))^ q*(a + b*Log[c*(d + e*x^k)^n])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, n, p, q}, x] && FractionQ[r] && IGtQ[p, 0] && IntegerQ[m]
Int[(h_.*x_)^m_.*(f_ + g_.*x_^r_.)^ q_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[c*(d + e*x)^n])^ p, (h*x)^m*(f + g*x^r)^q, x], x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q, r}, x] && IntegerQ[m] && IntegerQ[q]
Int[Polyx_*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := Int[ExpandIntegrand[Polyx*(a + b*Log[c*(d + e*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, n, p}, x] && PolynomialQ[Polyx, x]
Int[RFx_*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*(d + e*x)^n])^p, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, n}, x] && RationalFunctionQ[RFx, x] && IntegerQ[p]
Int[RFx_*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := With[{u = ExpandIntegrand[RFx*(a + b*Log[c*(d + e*x)^n])^p, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, n}, x] && RationalFunctionQ[RFx, x] && IntegerQ[p]
Int[AFx_*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := Unintegrable[AFx*(a + b*Log[c*(d + e*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, n, p}, x] && AlgebraicFunctionQ[AFx, x, True]
Int[u_^q_.*(a_. + b_.*Log[c_.*v_^n_.])^p_., x_Symbol] := Int[ExpandToSum[u, x]^q*(a + b*Log[c*ExpandToSum[v, x]^n])^p, x] /; FreeQ[{a, b, c, n, p, q}, x] && BinomialQ[u, x] && LinearQ[v, x] && Not[BinomialMatchQ[u, x] && LinearMatchQ[v, x]]
Int[Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := -x*(m - Log[f*x^m])*(a + b*Log[c*(d + e*x)^n]) + b*e*m*n*Int[x/(d + e*x), x] - b*e*n*Int[(x*Log[f*x^m])/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_, x_Symbol] := With[{u = IntHide[(a + b*Log[c*(d + e*x)^n])^p, x]}, Dist[Log[f*x^m], u, x] - m*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 1]
Int[Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := Unintegrable[Log[f*x^m]*(a + b*Log[c*(d + e*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])/x_, x_Symbol] := Log[f*x^m]^2*(a + b*Log[c*(d + e*x)^n])/(2*m) - b*e*n/(2*m)*Int[Log[f*x^m]^2/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(g_.*x_)^q_.* Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := -1/(g*(q + 1))*(m*(g*x)^(q + 1)/(q + 1) - (g*x)^(q + 1)* Log[f*x^m])*(a + b*Log[c*(d + e*x)^n]) + b*e*m*n/(g*(q + 1)^2)*Int[(g*x)^(q + 1)/(d + e*x), x] - b*e*n/(g*(q + 1))*Int[(g*x)^(q + 1)*Log[f*x^m]/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, q}, x] && NeQ[q, -1]
Int[Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_./x_, x_Symbol] := Log[f*x^m]^2*(a + b*Log[c*(d + e*x)^n])^p/(2*m) - b*e*n*p/(2*m)* Int[Log[f*x^m]^2*(a + b*Log[c*(d + e*x)^n])^(p - 1)/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(g_.*x_)^q_.* Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_, x_Symbol] := With[{u = IntHide[(g*x)^q*(a + b*Log[c*(d + e*x)^n])^p, x]}, Dist[Log[f*x^m], u, x] - m*Int[Dist[1/x, u, x], x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, q}, x] && IGtQ[p, 1] && IGtQ[q, 0]
(* Int[(g_.*x_)^q_.*Log[f_.*x_^m_.]*(a_.+b_.*Log[c_.*(d_+e_.*x_)^n_.]) ^p_,x_Symbol] := With[{u=IntHide[(a+b*Log[c*(d+e*x)^n])^p,x]}, Dist[(g*x)^q*Log[f*x^m],u,x] - g*m*Int[Dist[(g*x)^(q-1),u,x],x] -  g*q*Int[Dist[(g*x)^(q-1)*Log[f*x^m],u,x],x]] /; FreeQ[{a,b,c,d,e,f,g,m,n,q},x] && IGtQ[p,1] *)
Int[(g_.*x_)^q_.* Log[f_.*x_^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := Unintegrable[(g*x)^q*Log[f*x^m]*(a + b*Log[c*(d + e*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q}, x]
Int[Log[f_.*(g_. + h_.*x_)^m_.]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^p_., x_Symbol] := 1/e*Subst[Int[Log[f*(g*x/d)^m]*(a + b*Log[c*x^n])^p, x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x] && EqQ[e*f - d*g, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])*(f_. + g_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := x*(a + b*Log[c*(d + e*x)^n])*(f + g*Log[c*(d + e*x)^n]) - e*n* Int[(x*(b*f + a*g + 2*b*g*Log[c*(d + e*x)^n]))/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_.*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.]), x_Symbol] := x*(a + b*Log[c*(d + e*x)^n])^p*(f + g*Log[h*(i + j*x)^m]) - g*j*m*Int[x*(a + b*Log[c*(d + e*x)^n])^p/(i + j*x), x] - b*e*n*p* Int[x*(a + b*Log[c*(d + e*x)^n])^(p - 1)*(f + g*Log[h*(i + j*x)^m])/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, m, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_.*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.])^q_., x_Symbol] := Unintegrable[(a + b*Log[c*(d + e*x)^n])^ p*(f + g*Log[h*(i + j*x)^m])^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, m, n, p}, x]
Int[(k_. + l_.*x_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_.*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.]), x_Symbol] := 1/e*Subst[ Int[(k*x/d)^r*(a + b*Log[c*x^n])^ p*(f + g*Log[h*((e*i - d*j)/e + j*x/e)^m]), x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, k, l, n, p, r}, x] && EqQ[e*k - d*l, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])*(f_. + g_.*Log[c_.*(d_ + e_.*x_)^n_.])/x_, x_Symbol] := Log[x]*(a + b*Log[c*(d + e*x)^n])*(f + g*Log[c*(d + e*x)^n]) - e*n* Int[(Log[x]*(b*f + a*g + 2*b*g*Log[c*(d + e*x)^n]))/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x]
Int[x_^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])*(f_. + g_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := x^(m + 1)*(a + b*Log[c*(d + e*x)^n])*(f + g*Log[c*(d + e*x)^n])/(m + 1) - e*n/(m + 1)* Int[(x^(m + 1)*(b*f + a*g + 2*b*g*Log[c*(d + e*x)^n]))/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, n, m}, x] && NeQ[m, -1]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.])/x_, x_Symbol] := Log[x]*(a + b*Log[c*(d + e*x)^n])*(f + g*Log[h*(i + j*x)^m]) - e*g*m*Int[Log[x]*(a + b*Log[c*(d + e*x)^n])/(d + e*x), x] - b*j*n*Int[Log[x]*(f + g*Log[h*(i + j*x)^m])/(i + j*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, m, n}, x] && EqQ[e*i - d*j, 0]
Int[Log[a_ + b_.*x_]*Log[c_ + d_.*x_]/x_, x_Symbol] := Log[-b*x/a]*Log[a + b*x]*Log[c + d*x] - 1/2*(Log[-b*x/a] - Log[-d*x/c])*(Log[a + b*x] + Log[a*(c + d*x)/(c*(a + b*x))])^2 + 1/2*(Log[-b*x/a] - Log[-(b*c - a*d)*x/(a*(c + d*x))] + Log[(b*c - a*d)/(b*(c + d*x))])* Log[a*(c + d*x)/(c*(a + b*x))]^2 + (Log[c + d*x] - Log[a*(c + d*x)/(c*(a + b*x))])* PolyLog[2, 1 + b*x/a] + (Log[a + b*x] + Log[a*(c + d*x)/(c*(a + b*x))])* PolyLog[2, 1 + d*x/c] - Log[a*(c + d*x)/(c*(a + b*x))]* PolyLog[2, d*(a + b*x)/(b*(c + d*x))] + Log[a*(c + d*x)/(c*(a + b*x))]* PolyLog[2, c*(a + b*x)/(a*(c + d*x))] - PolyLog[3, 1 + b*x/a] - PolyLog[3, 1 + d*x/c] - PolyLog[3, d*(a + b*x)/(b*(c + d*x))] + PolyLog[3, c*(a + b*x)/(a*(c + d*x))] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0]
Int[Log[v_]*Log[w_]/x_, x_Symbol] := Int[Log[ExpandToSum[v, x]]*Log[ExpandToSum[w, x]]/x, x] /; LinearQ[{v, w}, x] && Not[LinearMatchQ[{v, w}, x]]
Int[Log[c_.*(d_ + e_.*x_)^n_.]*Log[h_.*(i_. + j_.*x_)^m_.]/x_, x_Symbol] := m*Int[Log[i + j*x]*Log[c*(d + e*x)^n]/x, x] - (m*Log[i + j*x] - Log[h*(i + j*x)^m])* Int[Log[c*(d + e*x)^n]/x, x] /; FreeQ[{c, d, e, h, i, j, m, n}, x] && NeQ[e*i - d*j, 0] && NeQ[i + j*x, h*(i + j*x)^m]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])*(f_ + g_.*Log[h_.*(i_. + j_.*x_)^m_.])/x_, x_Symbol] := f*Int[(a + b*Log[c*(d + e*x)^n])/x, x] + g*Int[Log[h*(i + j*x)^m]*(a + b*Log[c*(d + e*x)^n])/x, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, m, n}, x] && NeQ[e*i - d*j, 0]
Int[x_^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_.*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.]), x_Symbol] := x^(r + 1)*(a + b*Log[c*(d + e*x)^n])^ p*(f + g*Log[h*(i + j*x)^m])/(r + 1) - g*j*m/(r + 1)* Int[x^(r + 1)*(a + b*Log[c*(d + e*x)^n])^p/(i + j*x), x] - b*e*n*p/(r + 1)* Int[x^(r + 1)*(a + b*Log[c*(d + e*x)^n])^(p - 1)*(f + g*Log[h*(i + j*x)^m])/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, m, n}, x] && IGtQ[p, 0] && IntegerQ[r] && (EqQ[p, 1] || GtQ[r, 0]) && NeQ[r, -1]
Int[(k_ + l_.*x_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.]), x_Symbol] := 1/l*Subst[ Int[x^r*(a + b*Log[c*(-(e*k - d*l)/l + e*x/l)^n])*(f + g*Log[h*(-(j*k - i*l)/l + j*x/l)^m]), x], x, k + l*x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, k, l, m, n}, x] && IntegerQ[r]
Int[(k_. + l_.*x_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_.*(f_. + g_.*Log[h_.*(i_. + j_.*x_)^m_.])^q_., x_Symbol] := Unintegrable[(k + l*x)^r*(a + b*Log[c*(d + e*x)^n])^ p*(f + g*Log[h*(i + j*x)^m])^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, j, k, l, m, n, p, q, r}, x]
Int[PolyLog[k_, h_ + i_.*x_]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])^ p_./(f_ + g_.*x_), x_Symbol] := 1/g*Subst[Int[PolyLog[k, h*x/d]*(a + b*Log[c*x^n])^p/x, x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, h, i, k, n}, x] && EqQ[e*f - d*g, 0] && EqQ[g*h - f*i, 0] && IGtQ[p, 0]
Int[Px_.* F_[f_.*(g_. + h_.*x_)]*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.]), x_Symbol] := With[{u = IntHide[Px*F[f*(g + h*x)], x]}, Dist[(a + b*Log[c*(d + e*x)^n]), u, x] - b*e*n*Int[SimplifyIntegrand[u/(d + e*x), x], x]] /; FreeQ[{a, b, c, d, e, f, g, h, n}, x] && PolynomialQ[Px, x] && MemberQ[{ArcSin, ArcCos, ArcTan, ArcCot, ArcSinh, ArcCosh, ArcTanh, ArcCoth}, F]
Int[u_.*(a_. + b_.*Log[c_.*v_^n_.])^p_., x_Symbol] := Int[u*(a + b*Log[c*ExpandToSum[v, x]^n])^p, x] /; FreeQ[{a, b, c, n, p}, x] && LinearQ[v, x] && Not[LinearMatchQ[v, x]] && Not[EqQ[n, 1] && MatchQ[c*v, e_.*(f_ + g_.*x) /; FreeQ[{e, f, g}, x]]]
Int[u_.*(a_. + b_.*Log[c_.*(d_.*(e_. + f_. x_)^m_.)^n_])^p_., x_Symbol] := Subst[Int[u*(a + b*Log[c*d^n*(e + f*x)^(m*n)])^p, x], c*d^n*(e + f*x)^(m*n), c*(d*(e + f*x)^m)^n] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]] && Not[EqQ[d, 1] && EqQ[m, 1]] && IntegralFreeQ[IntHide[u*(a + b*Log[c*d^n*(e + f*x)^(m*n)])^p, x]]
Int[AFx_*(a_. + b_.*Log[c_.*(d_.*(e_. + f_. x_)^m_.)^n_])^p_., x_Symbol] := Unintegrable[AFx*(a + b*Log[c*(d*(e + f*x)^m)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && AlgebraicFunctionQ[AFx, x, True]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.4 u (a+b log(c (d+e x^m)^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 3.4 u (a+b log(c (d+e x^m)^n))^p *)
Int[Pq_^m_.*Log[u_], x_Symbol] := With[{C = FullSimplify[Pq^m*(1 - u)/D[u, x]]}, C*PolyLog[2, 1 - u] /; FreeQ[C, x]] /; IntegerQ[m] && PolyQ[Pq, x] && RationalFunctionQ[u, x] && LeQ[RationalFunctionExponents[u, x][[2]], Expon[Pq, x]]
Int[Log[c_.*(d_ + e_.*x_^n_)^p_.], x_Symbol] := x*Log[c*(d + e*x^n)^p] - e*n*p*Int[x^n/(d + e*x^n), x] /; FreeQ[{c, d, e, n, p}, x]
Int[(a_. + b_.*Log[c_.*(d_ + e_./x_)^p_.])^q_, x_Symbol] := (e + d*x)*(a + b*Log[c*(d + e/x)^p])^q/d + b*e*p*q/d*Int[(a + b*Log[c*(d + e/x)^p])^(q - 1)/x, x] /; FreeQ[{a, b, c, d, e, p}, x] && IGtQ[q, 0]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_, x_Symbol] := x*(a + b*Log[c*(d + e*x^n)^p])^q - b*e*n*p*q* Int[x^n*(a + b*Log[c*(d + e*x^n)^p])^(q - 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && IGtQ[q, 0] && (EqQ[q, 1] || IntegerQ[n])
(* Int[(a_.+b_.*Log[c_.*(d_+e_.*x_^n_)^p_.])^q_,x_Symbol] := With[{k=Denominator[n]}, k*Subst[Int[x^(k-1)*(a+b*Log[c*(d+e*x^(k*n))^p])^q,x],x,x^(1/k)]] /; FreeQ[{a,b,c,d,e,p,q},x] && LtQ[-1,n,1] && (GtQ[n,0] || IGtQ[q,0]) *)
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*Log[c*(d + e*x^(k*n))^p])^q, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e, p, q}, x] && FractionQ[n]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_, x_Symbol] := Unintegrable[(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, n, p, q}, x]
Int[(a_. + b_.*Log[c_.*v_^p_.])^q_., x_Symbol] := Int[(a + b*Log[c*ExpandToSum[v, x]^p])^q, x] /; FreeQ[{a, b, c, p, q}, x] && BinomialQ[v, x] && Not[BinomialMatchQ[v, x]]
Int[x_^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Log[c*(d + e*x)^p])^q, x], x, x^n] /; FreeQ[{a, b, c, d, e, m, n, p, q}, x] && IntegerQ[ Simplify[(m + 1)/n]] && (GtQ[(m + 1)/n, 0] || IGtQ[q, 0]) && Not[EqQ[q, 1] && ILtQ[n, 0] && IGtQ[m, 0]]
Int[(f_.*x_)^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.]), x_Symbol] := (f*x)^(m + 1)*(a + b*Log[c*(d + e*x^n)^p])/(f*(m + 1)) - b*e*n*p/(f*(m + 1))*Int[x^(n - 1)*(f*x)^(m + 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && NeQ[m, -1]
Int[(f_*x_)^m_*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := (f*x)^m/x^m*Int[x^m*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && IntegerQ[Simplify[(m + 1)/n]] && (GtQ[(m + 1)/n, 0] || IGtQ[q, 0])
Int[(f_.*x_)^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_, x_Symbol] := (f*x)^(m + 1)*(a + b*Log[c*(d + e*x^n)^p])^q/(f*(m + 1)) - b*e*n*p*q/(f^n*(m + 1))* Int[(f*x)^(m + n)*(a + b*Log[c*(d + e*x^n)^p])^(q - 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && IGtQ[q, 1] && IntegerQ[n] && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[ Int[x^(k*(m + 1) - 1)*(a + b*Log[c*(d + e*x^(k*n))^p])^q, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e, m, p, q}, x] && FractionQ[n]
Int[(f_*x_)^m_*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := (f*x)^m/x^m*Int[x^m*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, m, p, q}, x] && FractionQ[n]
Int[(f_.*x_)^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := Unintegrable[(f*x)^m*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x]
Int[(f_.*x_)^m_.*(a_. + b_.*Log[c_.*v_^p_.])^q_., x_Symbol] := Int[(f*x)^m*(a + b*Log[c*ExpandToSum[v, x]^p])^q, x] /; FreeQ[{a, b, c, f, m, p, q}, x] && BinomialQ[v, x] && Not[BinomialMatchQ[v, x]]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])/(f_. + g_.*x_), x_Symbol] := Log[f + g*x]*(a + b*Log[c*(d + e*x^n)^p])/g - b*e*n*p/g*Int[x^(n - 1)*Log[f + g*x]/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && RationalQ[n]
Int[(f_. + g_.*x_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.]), x_Symbol] := (f + g*x)^(r + 1)*(a + b*Log[c*(d + e*x^n)^p])/(g*(r + 1)) - b*e*n*p/(g*(r + 1))* Int[x^(n - 1)*(f + g*x)^(r + 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f, g, n, p, r}, x] && (IGtQ[r, 0] || RationalQ[n]) && NeQ[r, -1]
Int[(f_. + g_.*x_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := Unintegrable[(f + g*x)^r*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r}, x]
Int[u_^r_.*(a_. + b_.*Log[c_.*v_^p_.])^q_., x_Symbol] := Int[ExpandToSum[u, x]^r*(a + b*Log[c*ExpandToSum[v, x]^p])^q, x] /; FreeQ[{a, b, c, p, q, r}, x] && LinearQ[u, x] && BinomialQ[v, x] && Not[LinearMatchQ[u, x] && BinomialMatchQ[v, x]]
Int[x_^m_.*(f_. + g_.*x_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[c*(d + e*x^n)^p])^q, x^m*(f + g*x)^r, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q}, x] && IntegerQ[m] && IntegerQ[r]
Int[(h_.*x_)^m_*(f_. + g_.*x_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_.)^p_.])^q_., x_Symbol] := With[{k = Denominator[m]}, k/h* Subst[Int[ x^(k*(m + 1) - 1)*(f + g*x^k/h)^ r*(a + b*Log[c*(d + e*x^(k*n)/h^n)^p])^q, x], x, (h*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, h, p, r}, x] && FractionQ[m] && IntegerQ[n] && IntegerQ[r]
Int[(h_.*x_)^m_.*(f_. + g_.*x_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := Unintegrable[(h*x)^m*(f + g*x)^r*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q, r}, x]
Int[(h_.*x_)^m_.*u_^r_.*(a_. + b_.*Log[c_.*v_^p_.])^q_., x_Symbol] := Int[(h*x)^m* ExpandToSum[u, x]^r*(a + b*Log[c*ExpandToSum[v, x]^p])^q, x] /; FreeQ[{a, b, c, h, m, p, q, r}, x] && LinearQ[u, x] && BinomialQ[v, x] && Not[LinearMatchQ[u, x] && BinomialMatchQ[v, x]]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])/(f_ + g_.*x_^2), x_Symbol] := With[{u = IntHide[1/(f + g*x^2), x]}, u*(a + b*Log[c*(d + e*x^n)^p]) - b*e*n*p*Int[u*x^(n - 1)/(d + e*x^n), x]] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && IntegerQ[n]
Int[(f_ + g_.*x_^s_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^ q_., x_Symbol] := With[{t = ExpandIntegrand[(a + b*Log[c*(d + e*x^n)^p])^q, (f + g*x^s)^r, x]}, Int[t, x] /; SumQ[t]] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r, s}, x] && IntegerQ[n] && IGtQ[q, 0] && IntegerQ[r] && IntegerQ[s] && (EqQ[q, 1] || GtQ[r, 0] && GtQ[s, 1] || LtQ[s, 0] && LtQ[r, 0])
Int[(f_ + g_.*x_^s_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^ q_., x_Symbol] := With[{k = Denominator[n]}, k*Subst[ Int[x^(k - 1)*(f + g*x^(k*s))^ r*(a + b*Log[c*(d + e*x^(k*n))^p])^q, x], x, x^(1/k)] /; IntegerQ[k*s]] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r, s}, x] && FractionQ[n]
Int[(f_ + g_.*x_^s_)^r_. (a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^ q_., x_Symbol] := Unintegrable[(f + g*x^s)^r*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r, s}, x]
Int[u_^r_.*(a_. + b_.*Log[c_.*v_^p_.])^q_., x_Symbol] := Int[ExpandToSum[u, x]^r*(a + b*Log[c*ExpandToSum[v, x]^p])^q, x] /; FreeQ[{a, b, c, p, q, r}, x] && BinomialQ[{u, v}, x] && Not[BinomialMatchQ[{u, v}, x]]
Int[x_^m_.*(f_ + g_.*x_^s_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(f + g*x^(s/n))^ r*(a + b*Log[c*(d + e*x)^p])^q, x], x, x^n] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r, s}, x] && IntegerQ[r] && IntegerQ[s/n] && IntegerQ[Simplify[(m + 1)/n]] && (GtQ[(m + 1)/n, 0] || IGtQ[q, 0])
Int[x_^m_.*(f_ + g_.*x_^s_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[c*(d + e*x^n)^p])^q, x^m*(f + g*x^s)^r, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r, s}, x] && IGtQ[q, 0] && IntegerQ[m] && IntegerQ[r] && IntegerQ[s]
Int[(f_ + g_.*x_^s_)^r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^ q_., x_Symbol] := With[{k = Denominator[n]}, k*Subst[ Int[x^(k - 1)*(f + g*x^(k*s))^ r*(a + b*Log[c*(d + e*x^(k*n))^p])^q, x], x, x^(1/k)] /; IntegerQ[k*s]] /; FreeQ[{a, b, c, d, e, f, g, n, p, q, r, s}, x] && FractionQ[n]
Int[x_^m_.*(f_ + g_.*x_^s_)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := 1/n*Subst[ Int[x^(m + 1/n - 1)*(f + g*x^(s/n))^r*(a + b*Log[c*(d + e*x)^p])^ q, x], x, x^n] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q, r, s}, x] && FractionQ[n] && IntegerQ[1/n] && IntegerQ[s/n]
Int[(h_.*x_)^m_*(f_. + g_.*x_^s_.)^ r_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_.)^p_.])^q_., x_Symbol] := With[{k = Denominator[m]}, k/h* Subst[Int[ x^(k*(m + 1) - 1)*(f + g*x^(k*s)/h^s)^ r*(a + b*Log[c*(d + e*x^(k*n)/h^n)^p])^q, x], x, (h*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, h, p, r}, x] && FractionQ[m] && IntegerQ[n] && IntegerQ[s]
Int[(h_.*x_)^m_.*(f_ + g_.*x_^s_)^ r_. (a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])^q_., x_Symbol] := Unintegrable[(h*x)^m*(f + g*x^s)^r*(a + b*Log[c*(d + e*x^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q, r, s}, x]
Int[(h_.*x_)^m_.*u_^r_.*(a_. + b_.*Log[c_.*v_^p_.])^q_., x_Symbol] := Int[(h*x)^m* ExpandToSum[u, x]^r*(a + b*Log[c*ExpandToSum[v, x]^p])^q, x] /; FreeQ[{a, b, c, h, m, p, q, r}, x] && BinomialQ[{u, v}, x] && Not[BinomialMatchQ[{u, v}, x]]
Int[Log[f_.*x_^q_.]^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.])/x_, x_Symbol] := Log[f*x^q]^(m + 1)*(a + b*Log[c*(d + e*x^n)^p])/(q*(m + 1)) - b*e*n*p/(q*(m + 1))* Int[x^(n - 1)*Log[f*x^q]^(m + 1)/(d + e*x^n), x] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && NeQ[m, -1]
Int[F_[f_.*x_]^m_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_^n_)^p_.]), x_Symbol] := With[{u = IntHide[F[f*x]^m, x]}, Dist[a + b*Log[c*(d + e*x^n)^p], u, x] - b*e*n*p*Int[SimplifyIntegrand[u*x^(n - 1)/(d + e*x^n), x], x]] /; FreeQ[{a, b, c, d, e, f, p}, x] && MemberQ[{ArcSin, ArcCos, ArcSinh, ArcCosh}, F] && IGtQ[m, 0] && IGtQ[n, 1]
Int[(a_. + b_.*Log[c_.*(d_ + e_.*(f_. + g_.*x_)^n_)^p_.])^q_., x_Symbol] := 1/g*Subst[Int[(a + b*Log[c*(d + e*x^n)^p])^q, x], x, f + g*x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && IGtQ[q, 0] && (EqQ[q, 1] || IntegerQ[n])
Int[(a_. + b_.*Log[c_.*(d_ + e_.*(f_. + g_.*x_)^n_)^p_.])^q_., x_Symbol] := Unintegrable[(a + b*Log[c*(d + e*(f + g*x)^n)^p])^q, x] /; FreeQ[{a, b, c, d, e, f, g, n, p, q}, x]

(*FILE: 
Rubi/IntegrationRules/3 Logarithms/3.5 Miscellaneous logarithms.m
*)

(* ::Subsection::Closed:: *)
(* 3.5 Miscellaneous logarithms *)
Int[u_*Log[v_], x_Symbol] := With[{w = DerivativeDivides[v, u*(1 - v), x]}, w*PolyLog[2, 1 - v] /; Not[FalseQ[w]]]
Int[(a_. + b_.*Log[u_])*Log[v_]*w_, x_Symbol] := With[{z = DerivativeDivides[v, w*(1 - v), x]}, z*(a + b*Log[u])*PolyLog[2, 1 - v] - b*Int[SimplifyIntegrand[z*PolyLog[2, 1 - v]*D[u, x]/u, x], x] /; Not[FalseQ[z]]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x]
Int[Log[c_.*Log[d_.*x_^n_.]^p_.], x_Symbol] := x*Log[c*Log[d*x^n]^p] - n*p*Int[1/Log[d*x^n], x] /; FreeQ[{c, d, n, p}, x]
Int[(a_. + b_.*Log[c_.*Log[d_.*x_^n_.]^p_.])/x_, x_Symbol] := Log[d*x^n]*(a + b*Log[c*Log[d*x^n]^p])/n - b*p*Log[x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(e_.*x_)^m_.*(a_. + b_.*Log[c_.*Log[d_.*x_^n_.]^p_.]), x_Symbol] := (e*x)^(m + 1)*(a + b*Log[c*Log[d*x^n]^p])/(e*(m + 1)) - b*n*p/(m + 1)*Int[(e*x)^m/Log[d*x^n], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[m, -1]
Int[(a_. + b_.*Log[c_.*RFx_^p_.])^n_., x_Symbol] := x*(a + b*Log[c*RFx^p])^n - b*n*p* Int[SimplifyIntegrand[ x*(a + b*Log[c*RFx^p])^(n - 1)*D[RFx, x]/RFx, x], x] /; FreeQ[{a, b, c, p}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[(a_. + b_.*Log[c_.*RFx_^p_.])^n_./(d_. + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*Log[c*RFx^p])^n/e - b*n*p/e* Int[Log[d + e*x]*(a + b*Log[c*RFx^p])^(n - 1)*D[RFx, x]/RFx, x] /; FreeQ[{a, b, c, d, e, p}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*Log[c_.*RFx_^p_.])^n_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*Log[c*RFx^p])^n/(e*(m + 1)) - b*n*p/(e*(m + 1))* Int[SimplifyIntegrand[(d + e*x)^(m + 1)*(a + b*Log[c*RFx^p])^(n - 1)*D[RFx, x]/RFx, x], x] /; FreeQ[{a, b, c, d, e, m, p}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && (EqQ[n, 1] || IntegerQ[m]) && NeQ[m, -1]
Int[Log[c_.*RFx_^n_.]/(d_ + e_.*x_^2), x_Symbol] := With[{u = IntHide[1/(d + e*x^2), x]}, u*Log[c*RFx^n] - n*Int[SimplifyIntegrand[u*D[RFx, x]/RFx, x], x]] /; FreeQ[{c, d, e, n}, x] && RationalFunctionQ[RFx, x] && Not[PolynomialQ[RFx, x]]
Int[Log[c_.*Px_^n_.]/Qx_, x_Symbol] := With[{u = IntHide[1/Qx, x]}, u*Log[c*Px^n] - n*Int[SimplifyIntegrand[u*D[Px, x]/Px, x], x]] /; FreeQ[{c, n}, x] && QuadraticQ[{Qx, Px}, x] && EqQ[D[Px/Qx, x], 0]
Int[RGx_*(a_. + b_.*Log[c_.*RFx_^p_.])^n_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*Log[c*RFx^p])^n, RGx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, p}, x] && RationalFunctionQ[RFx, x] && RationalFunctionQ[RGx, x] && IGtQ[n, 0]
Int[RGx_*(a_. + b_.*Log[c_.*RFx_^p_.])^n_., x_Symbol] := With[{u = ExpandIntegrand[RGx*(a + b*Log[c*RFx^p])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, p}, x] && RationalFunctionQ[RFx, x] && RationalFunctionQ[RGx, x] && IGtQ[n, 0]
Int[RFx_*(a_. + b_.*Log[u_]), x_Symbol] := With[{lst = SubstForFractionalPowerOfLinear[RFx*(a + b*Log[u]), x]}, lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])] /; Not[FalseQ[lst]]] /; FreeQ[{a, b}, x] && RationalFunctionQ[RFx, x]
Int[(f_. + g_.*x_)^m_.*Log[1 + e_.*(F_^(c_.*(a_. + b_.*x_)))^n_.], x_Symbol] := -(f + g*x)^m*PolyLog[2, -e*(F^(c*(a + b*x)))^n]/(b*c*n*Log[F]) + g*m/(b*c*n*Log[F])* Int[(f + g*x)^(m - 1)*PolyLog[2, -e*(F^(c*(a + b*x)))^n], x] /; FreeQ[{F, a, b, c, e, f, g, n}, x] && GtQ[m, 0]
Int[(f_. + g_.*x_)^m_.*Log[d_ + e_.*(F_^(c_.*(a_. + b_.*x_)))^n_.], x_Symbol] := (f + g*x)^(m + 1)*Log[d + e*(F^(c*(a + b*x)))^n]/(g*(m + 1)) - (f + g*x)^(m + 1)* Log[1 + e/d*(F^(c*(a + b*x)))^n]/(g*(m + 1)) + Int[(f + g*x)^m*Log[1 + e/d*(F^(c*(a + b*x)))^n], x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && GtQ[m, 0] && NeQ[d, 1]
Int[Log[d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2]], x_Symbol] := x*Log[d + e*x + f*Sqrt[a + b*x + c*x^2]] + f^2*(b^2 - 4*a*c)/2* Int[x/((2*d*e - b*f^2)*(a + b*x + c*x^2) - f*(b*d - 2*a*e + (2*c*d - b*e)*x)*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e^2 - c*f^2, 0]
Int[Log[d_. + e_.*x_ + f_.*Sqrt[a_. + c_.*x_^2]], x_Symbol] := x*Log[d + e*x + f*Sqrt[a + c*x^2]] - a*c*f^2* Int[x/(d*e*(a + c*x^2) + f*(a*e - c*d*x)*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, d, e, f}, x] && EqQ[e^2 - c*f^2, 0]
Int[(g_.*x_)^m_.* Log[d_. + e_.*x_ + f_.*Sqrt[a_. + b_.*x_ + c_.*x_^2]], x_Symbol] := (g*x)^(m + 1)* Log[d + e*x + f*Sqrt[a + b*x + c*x^2]]/(g*(m + 1)) + f^2*(b^2 - 4*a*c)/(2*g*(m + 1))* Int[(g*x)^(m + 1)/((2*d*e - b*f^2)*(a + b*x + c*x^2) - f*(b*d - 2*a*e + (2*c*d - b*e)*x)*Sqrt[a + b*x + c*x^2]), x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && EqQ[e^2 - c*f^2, 0] && NeQ[m, -1] && IntegerQ[2*m]
Int[(g_.*x_)^m_.*Log[d_. + e_.*x_ + f_.*Sqrt[a_. + c_.*x_^2]], x_Symbol] := (g*x)^(m + 1)*Log[d + e*x + f*Sqrt[a + c*x^2]]/(g*(m + 1)) - a*c*f^2/(g*(m + 1))* Int[(g*x)^(m + 1)/(d*e*(a + c*x^2) + f*(a*e - c*d*x)*Sqrt[a + c*x^2]), x] /; FreeQ[{a, c, d, e, f, g, m}, x] && EqQ[e^2 - c*f^2, 0] && NeQ[m, -1] && IntegerQ[2*m]
Int[v_.*Log[d_. + e_.*x_ + f_.*Sqrt[u_]], x_Symbol] := Int[v*Log[d + e*x + f*Sqrt[ExpandToSum[u, x]]], x] /; FreeQ[{d, e, f}, x] && QuadraticQ[u, x] && Not[QuadraticMatchQ[u, x]] && (EqQ[v, 1] || MatchQ[v, (g_.*x)^m_. /; FreeQ[{g, m}, x]])
Int[Log[c_.*x_^n_.]^r_./(x_*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)), x_Symbol] := Log[a*x^m + b*Log[c*x^n]^q]/(b*n*q) - a*m/(b*n*q)*Int[x^(m - 1)/(a*x^m + b*Log[c*x^n]^q), x] /; FreeQ[{a, b, c, m, n, q, r}, x] && EqQ[r, q - 1]
Int[Log[c_.*x_^n_.]^r_.*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)^p_./x_, x_Symbol] := Int[ExpandIntegrand[Log[c*x^n]^r/x, (a*x^m + b*Log[c*x^n]^q)^p, x], x] /; FreeQ[{a, b, c, m, n, p, q, r}, x] && EqQ[r, q - 1] && IGtQ[p, 0]
Int[Log[c_.*x_^n_.]^r_.*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)^p_./x_, x_Symbol] := (a*x^m + b*Log[c*x^n]^q)^(p + 1)/(b*n*q*(p + 1)) - a*m/(b*n*q)*Int[x^(m - 1)*(a*x^m + b*Log[c*x^n]^q)^p, x] /; FreeQ[{a, b, c, m, n, p, q, r}, x] && EqQ[r, q - 1] && NeQ[p, -1]
Int[(d_.*x_^m_. + e_.*Log[c_.*x_^n_.]^r_.)/(x_*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)), x_Symbol] := e*Log[a*x^m + b*Log[c*x^n]^q]/(b*n*q) /; FreeQ[{a, b, c, d, e, m, n, q, r}, x] && EqQ[r, q - 1] && EqQ[a*e*m - b*d*n*q, 0]
Int[(u_ + d_.*x_^m_. + e_.*Log[c_.*x_^n_.]^r_.)/(x_*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)), x_Symbol] := e*Log[a*x^m + b*Log[c*x^n]^q]/(b*n*q) + Int[u/(x*(a*x^m + b*Log[c*x^n]^q)), x] /; FreeQ[{a, b, c, d, e, m, n, q, r}, x] && EqQ[r, q - 1] && EqQ[a*e*m - b*d*n*q, 0]
Int[(d_.*x_^m_. + e_.*Log[c_.*x_^n_.]^r_.)/(x_*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)), x_Symbol] := e*Log[a*x^m + b*Log[c*x^n]^q]/(b*n*q) - (a*e*m - b*d*n*q)/(b*n*q)* Int[x^(m - 1)/(a*x^m + b*Log[c*x^n]^q), x] /; FreeQ[{a, b, c, d, e, m, n, q, r}, x] && EqQ[r, q - 1] && NeQ[a*e*m - b*d*n*q, 0]
Int[(d_.*x_^m_. + e_.*Log[c_.*x_^n_.]^r_.)*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)^ p_./x_, x_Symbol] := e*(a*x^m + b*Log[c*x^n]^q)^(p + 1)/(b*n*q*(p + 1)) /; FreeQ[{a, b, c, d, e, m, n, p, q, r}, x] && EqQ[r, q - 1] && NeQ[p, -1] && EqQ[a*e*m - b*d*n*q, 0]
Int[(d_.*x_^m_. + e_.*Log[c_.*x_^n_.]^r_.)*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)^ p_./x_, x_Symbol] := e*(a*x^m + b*Log[c*x^n]^q)^(p + 1)/(b*n*q*(p + 1)) - (a*e*m - b*d*n*q)/(b*n*q)* Int[x^(m - 1)*(a*x^m + b*Log[c*x^n]^q)^p, x] /; FreeQ[{a, b, c, d, e, m, n, p, q, r}, x] && EqQ[r, q - 1] && NeQ[p, -1] && NeQ[a*e*m - b*d*n*q, 0]
Int[(d_.*x_^m_. + e_.*x_^m_.*Log[c_.*x_^n_.] + f_.*Log[c_.*x_^n_.]^ q_.)/(x_*(a_.*x_^m_. + b_.*Log[c_.*x_^n_.]^q_)^2), x_Symbol] := d*Log[c*x^n]/(a*n*(a*x^m + b*Log[c*x^n]^q)) /; FreeQ[{a, b, c, d, e, f, m, n, q}, x] && EqQ[e*n + d*m, 0] && EqQ[a*f + b*d*(q - 1), 0]
Int[(d_ + e_.*Log[c_.*x_^n_.])/(a_.*x_ + b_.*Log[c_.*x_^n_.]^q_)^2, x_Symbol] := -e*Log[c*x^n]/(a*(a*x + b*Log[c*x^n]^q)) + (d + e*n)/a* Int[1/(x*(a*x + b*Log[c*x^n]^q)), x] /; FreeQ[{a, b, c, d, e, n, q}, x] && EqQ[d + e*n*q, 0]
Int[Log[u_], x_Symbol] := x*Log[u] - Int[SimplifyIntegrand[x*D[u, x]/u, x], x] /; InverseFunctionFreeQ[u, x]
Int[Log[u_], x_Symbol] := x*Log[u] - Int[SimplifyIntegrand[x*Simplify[D[u, x]/u], x], x] /; ProductQ[u]
Int[Log[u_]/(a_. + b_.*x_), x_Symbol] := Log[a + b*x]*Log[u]/b - 1/b*Int[SimplifyIntegrand[Log[a + b*x]*D[u, x]/u, x], x] /; FreeQ[{a, b}, x] && RationalFunctionQ[D[u, x]/u, x] && (NeQ[a, 0] || Not[BinomialQ[u, x] && EqQ[BinomialDegree[u, x]^2, 1]])
Int[(a_. + b_.*x_)^m_.*Log[u_], x_Symbol] := (a + b*x)^(m + 1)*Log[u]/(b*(m + 1)) - 1/(b*(m + 1))* Int[SimplifyIntegrand[(a + b*x)^(m + 1)*D[u, x]/u, x], x] /; FreeQ[{a, b, m}, x] && InverseFunctionFreeQ[u, x] && NeQ[m, -1] (* && Not[FunctionOfQ[x^(m+1),u,x]] && FalseQ[PowerVariableExpn[u,m+1, x]] *)
Int[Log[u_]/Qx_, x_Symbol] := With[{v = IntHide[1/Qx, x]}, v*Log[u] - Int[SimplifyIntegrand[v*D[u, x]/u, x], x]] /; QuadraticQ[Qx, x] && InverseFunctionFreeQ[u, x]
Int[u_^(a_.*x_)*Log[u_], x_Symbol] := u^(a*x)/a - Int[SimplifyIntegrand[x*u^(a*x - 1)*D[u, x], x], x] /; FreeQ[a, x] && InverseFunctionFreeQ[u, x]
Int[v_*Log[u_], x_Symbol] := With[{w = IntHide[v, x]}, Dist[Log[u], w, x] - Int[SimplifyIntegrand[w*D[u, x]/u, x], x] /; InverseFunctionFreeQ[w, x]] /; InverseFunctionFreeQ[u, x]
Int[v_*Log[u_], x_Symbol] := With[{w = IntHide[v, x]}, Dist[Log[u], w, x] - Int[SimplifyIntegrand[w*Simplify[D[u, x]/u], x], x] /; InverseFunctionFreeQ[w, x]] /; ProductQ[u]
Int[Log[v_]*Log[w_], x_Symbol] := x*Log[v]*Log[w] - Int[SimplifyIntegrand[x*Log[w]*D[v, x]/v, x], x] - Int[SimplifyIntegrand[x*Log[v]*D[w, x]/w, x], x] /; InverseFunctionFreeQ[v, x] && InverseFunctionFreeQ[w, x]
Int[u_*Log[v_]*Log[w_], x_Symbol] := With[{z = IntHide[u, x]}, Dist[Log[v]*Log[w], z, x] - Int[SimplifyIntegrand[z*Log[w]*D[v, x]/v, x], x] - Int[SimplifyIntegrand[z*Log[v]*D[w, x]/w, x], x] /; InverseFunctionFreeQ[z, x]] /; InverseFunctionFreeQ[v, x] && InverseFunctionFreeQ[w, x]
Int[f_^(a_.*Log[u_]), x_Symbol] := Int[u^(a*Log[f]), x] /; FreeQ[{a, f}, x]
(* If[TrueQ[$LoadShowSteps], Int[u_/x_,x_Symbol] := With[{lst=FunctionOfLog[u,x]}, ShowStep["","Int[F[Log[a*x^n]]/x,x]","Subst[Int[F[x],x],x,Log[a*x^n] ]/n",Hold[ 1/lst[[3]]*Subst[Int[lst[[1]],x],x,Log[lst[[2]]]]]] /; Not[FalseQ[lst]]] /; SimplifyFlag && NonsumQ[u], Int[u_/x_,x_Symbol] := With[{lst=FunctionOfLog[u,x]}, 1/lst[[3]]*Subst[Int[lst[[1]],x],x,Log[lst[[2]]]] /; Not[FalseQ[lst]]] /; NonsumQ[u]] *)
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = FunctionOfLog[Cancel[x*u], x]}, ShowStep["", "Int[F[Log[a*x^n]]/x,x]", "Subst[Int[F[x],x],x,Log[a*x^n]]/n", Hold[ 1/lst[[3]]*Subst[Int[lst[[1]], x], x, Log[lst[[2]]]]]] /; Not[FalseQ[lst]]] /; SimplifyFlag && NonsumQ[u], Int[u_, x_Symbol] := With[{lst = FunctionOfLog[Cancel[x*u], x]}, 1/lst[[3]]*Subst[Int[lst[[1]], x], x, Log[lst[[2]]]] /; Not[FalseQ[lst]]] /; NonsumQ[u]]
Int[u_.*Log[Gamma[v_]], x_Symbol] := (Log[Gamma[v]] - LogGamma[v])*Int[u, x] + Int[u*LogGamma[v], x]
Int[u_.*(a_.*x_^m_. + b_.*x_^r_.*Log[c_.*x_^n_.]^q_.)^p_., x_Symbol] := Int[u*x^(p*r)*(a*x^(m - r) + b*Log[c*x^n]^q)^p, x] /; FreeQ[{a, b, c, m, n, p, q, r}, x] && IntegerQ[p]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.0.1 (a sin)^m (b trg)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.0.1 (a sin)^m (b trg)^n *)
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := Int[DeactivateTrig[u, x], x] /; SimplifyFlag && FunctionOfTrigOfLinearQ[u, x], Int[u_, x_Symbol] := Int[DeactivateTrig[u, x], x] /; FunctionOfTrigOfLinearQ[u, x]]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*cos[e_. + f_.*x_])^n_., x_Symbol] := (a*Sin[e + f*x])^(m + 1)*(b*Cos[e + f*x])^(n + 1)/(a*b*f*(m + 1)) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n + 2, 0] && NeQ[m, -1]
Int[(a_.*sin[e_. + f_.*x_])^m_.*cos[e_. + f_.*x_]^n_., x_Symbol] := 1/(a*f)* Subst[Int[x^m*(1 - x^2/a^2)^((n - 1)/2), x], x, a*Sin[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n - 1)/2] && Not[IntegerQ[(m - 1)/2] && LtQ[0, m, n]]
Int[(a_.*cos[e_. + f_.*x_])^m_.*sin[e_. + f_.*x_]^n_., x_Symbol] := -1/(a*f)* Subst[Int[x^m*(1 - x^2/a^2)^((n - 1)/2), x], x, a*Cos[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n - 1)/2] && Not[IntegerQ[(m - 1)/2] && GtQ[m, 0] && LeQ[m, n]]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*cos[e_. + f_.*x_])^n_, x_Symbol] := -a*(a*Sin[e + f*x])^(m - 1)*(b*Cos[e + f*x])^(n + 1)/(b* f*(n + 1)) + a^2*(m - 1)/(b^2*(n + 1))* Int[(a*Sin[e + f*x])^(m - 2)*(b*Cos[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[m, 1] && LtQ[n, -1] && (IntegersQ[2*m, 2*n] || EqQ[m + n, 0])
Int[(a_.*cos[e_. + f_.*x_])^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a*(a*Cos[e + f*x])^(m - 1)*(b*Sin[e + f*x])^(n + 1)/(b*f*(n + 1)) + a^2*(m - 1)/(b^2*(n + 1))* Int[(a*Cos[e + f*x])^(m - 2)*(b*Sin[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[m, 1] && LtQ[n, -1] && (IntegersQ[2*m, 2*n] || EqQ[m + n, 0])
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*cos[e_. + f_.*x_])^n_, x_Symbol] := -a*(b*Cos[e + f*x])^(n + 1)*(a*Sin[e + f*x])^(m - 1)/(b* f*(m + n)) + a^2*(m - 1)/(m + n)* Int[(b*Cos[e + f*x])^n*(a*Sin[e + f*x])^(m - 2), x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*cos[e_. + f_.*x_])^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a*(b*Sin[e + f*x])^(n + 1)*(a*Cos[e + f*x])^(m - 1)/(b*f*(m + n)) + a^2*(m - 1)/(m + n)* Int[(b*Sin[e + f*x])^n*(a*Cos[e + f*x])^(m - 2), x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*cos[e_. + f_.*x_])^n_, x_Symbol] := (b*Cos[e + f*x])^(n + 1)*(a*Sin[e + f*x])^(m + 1)/(a*b*f*(m + 1)) + (m + n + 2)/(a^2*(m + 1))* Int[(b*Cos[e + f*x])^n*(a*Sin[e + f*x])^(m + 2), x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[(a_.*cos[e_. + f_.*x_])^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -(b*Sin[e + f*x])^(n + 1)*(a*Cos[e + f*x])^(m + 1)/(a*b* f*(m + 1)) + (m + n + 2)/(a^2*(m + 1))* Int[(b*Sin[e + f*x])^n*(a*Cos[e + f*x])^(m + 2), x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[Sqrt[a_.*sin[e_. + f_.*x_]]*Sqrt[b_.*cos[e_. + f_.*x_]], x_Symbol] := Sqrt[a*Sin[e + f*x]]*Sqrt[b*Cos[e + f*x]]/Sqrt[Sin[2*e + 2*f*x]]* Int[Sqrt[Sin[2*e + 2*f*x]], x] /; FreeQ[{a, b, e, f}, x]
Int[1/(Sqrt[a_.*sin[e_. + f_.*x_]]*Sqrt[b_.*cos[e_. + f_.*x_]]), x_Symbol] := Sqrt[Sin[2*e + 2*f*x]]/(Sqrt[a*Sin[e + f*x]]*Sqrt[b*Cos[e + f*x]])* Int[1/Sqrt[Sin[2*e + 2*f*x]], x] /; FreeQ[{a, b, e, f}, x]
(* Int[(a_.*sin[e_.+f_.*x_])^m_*(b_.*cos[e_.+f_.*x_])^n_,x_Symbol] := (a*Sin[e+f*x])^m*(b*Cos[e+f*x])^n/(a*Tan[e+f*x])^m*Int[(a*Tan[e+f*x] )^m,x] /; FreeQ[{a,b,e,f,m,n},x] && EqQ[m+n,0] *)
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*cos[e_. + f_.*x_])^n_, x_Symbol] := With[{k = Denominator[m]}, k*a*b/f* Subst[Int[x^(k*(m + 1) - 1)/(a^2 + b^2*x^(2*k)), x], x, (a*Sin[e + f*x])^(1/k)/(b*Cos[e + f*x])^(1/k)]] /; FreeQ[{a, b, e, f}, x] && EqQ[m + n, 0] && GtQ[m, 0] && LtQ[m, 1]
Int[(a_.*cos[e_. + f_.*x_])^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := With[{k = Denominator[m]}, -k*a*b/f* Subst[Int[x^(k*(m + 1) - 1)/(a^2 + b^2*x^(2*k)), x], x, (a*Cos[e + f*x])^(1/k)/(b*Sin[e + f*x])^(1/k)]] /; FreeQ[{a, b, e, f}, x] && EqQ[m + n, 0] && GtQ[m, 0] && LtQ[m, 1]
(* Int[(a_.*sin[e_.+f_.*x_])^m_*(b_.*cos[e_.+f_.*x_])^n_,x_Symbol] := b^(2*IntPart[(n-1)/2]+1)*(b*Cos[e+f*x])^(2*FracPart[(n-1)/2])/(a*f*( Cos[e+f*x]^2)^FracPart[(n-1)/2])* Subst[Int[x^m*(1-x^2/a^2)^((n-1)/2),x],x,a*Sin[e+f*x]] /; FreeQ[{a,b,e,f,m,n},x] && (RationalQ[n] || Not[RationalQ[m]] &&  (EqQ[b,1] || NeQ[a,1])) *)
(* Int[(a_.*cos[e_.+f_.*x_])^m_*(b_.*sin[e_.+f_.*x_])^n_,x_Symbol] := -b^(2*IntPart[(n-1)/2]+1)*(b*Sin[e+f*x])^(2*FracPart[(n-1)/2])/(a*f* (Sin[e+f*x]^2)^FracPart[(n-1)/2])* Subst[Int[x^m*(1-x^2/a^2)^((n-1)/2),x],x,a*Cos[e+f*x]] /; FreeQ[{a,b,e,f,m,n},x] *)
Int[(a_.*cos[e_. + f_.*x_])^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b^(2*IntPart[(n - 1)/2] + 1)*(b*Sin[e + f*x])^(2* FracPart[(n - 1)/2])*(a*Cos[e + f*x])^(m + 1)/(a* f*(m + 1)*(Sin[e + f*x]^2)^FracPart[(n - 1)/2])* Hypergeometric2F1[(1 + m)/2, (1 - n)/2, (3 + m)/2, Cos[e + f*x]^2] /; FreeQ[{a, b, e, f, m, n}, x] && SimplerQ[n, m]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*cos[e_. + f_.*x_])^n_, x_Symbol] := b^(2*IntPart[(n - 1)/2] + 1)*(b*Cos[e + f*x])^(2* FracPart[(n - 1)/2])*(a*Sin[e + f*x])^(m + 1)/(a* f*(m + 1)*(Cos[e + f*x]^2)^FracPart[(n - 1)/2])* Hypergeometric2F1[(1 + m)/2, (1 - n)/2, (3 + m)/2, Sin[e + f*x]^2] /; FreeQ[{a, b, e, f, m, n}, x]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*sec[e_. + f_.*x_])^n_., x_Symbol] := b*(a*Sin[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n - 1)/(a*f*(m + 1)) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m - n + 2, 0] && NeQ[m, -1]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := a*b*(a*Sin[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n - 1)/(f*(n - 1)) - a^2*b^2*(m - 1)/(n - 1)* Int[(a*Sin[e + f*x])^(m - 2)*(b*Sec[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && GtQ[m, 1] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := (a*Sin[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n + 1)/(a*b*f*(m - n)) - (n + 1)/(b^2*(m - n))* Int[(a*Sin[e + f*x])^m*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := (a*Sin[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n + 1)/(a*b*f*(m + 1)) - (n + 1)/(a^2*b^2*(m + 1))* Int[(a*Sin[e + f*x])^(m + 2)*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && LtQ[n, -1] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := (a*Sin[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n + 1)/(a*b*f*(m - n)) - (n + 1)/(b^2*(m - n))* Int[(a*Sin[e + f*x])^m*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && NeQ[m - n, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := -a*b*(a*Sin[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n - 1)/(f*(m - n)) + a^2*(m - 1)/(m - n)* Int[(a*Sin[e + f*x])^(m - 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && NeQ[m - n, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := b*(a*Sin[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n - 1)/(a*f*(m + 1)) + (m - n + 2)/(a^2*(m + 1))* Int[(a*Sin[e + f*x])^(m + 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := (b*Cos[e + f*x])^n*(b*Sec[e + f*x])^n* Int[(a*Sin[e + f*x])^m/(b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && IntegerQ[m - 1/2] && IntegerQ[n - 1/2]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := 1/b^2*(b*Cos[e + f*x])^(n + 1)*(b*Sec[e + f*x])^(n + 1)* Int[(a*Sin[e + f*x])^m/(b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && LtQ[n, 1]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := b^2*(b*Cos[e + f*x])^(n - 1)*(b*Sec[e + f*x])^(n - 1)* Int[(a*Sin[e + f*x])^m/(b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := (a*b)^IntPart[n]*(a*Sin[e + f*x])^FracPart[n]*(b*Csc[e + f*x])^ FracPart[n]*Int[(a*Sin[e + f*x])^(m - n), x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.0.2 (a trg)^m (b tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.0.2 (a trg)^m (b tan)^n *)
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := -b*(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n - 1)/(f*m) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n - 1, 0]
Int[sin[e_. + f_.*x_]^m_.*tan[e_. + f_.*x_]^n_., x_Symbol] := -1/f*Subst[Int[(1 - x^2)^((m + n - 1)/2)/x^n, x], x, Cos[e + f*x]] /; FreeQ[{e, f}, x] && IntegersQ[m, n, (m + n - 1)/2]
Int[sin[e_. + f_.*x_]^m_*(b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, b*ff/f* Subst[Int[(ff*x)^(m + n)/(b^2 + ff^2*x^2)^(m/2 + 1), x], x, b*Tan[e + f*x]/ff]] /; FreeQ[{b, e, f, n}, x] && IntegerQ[m/2]
Int[(a_.*sin[e_. + f_.*x_])^m_.*tan[e_. + f_.*x_]^n_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(ff*x)^(m + n)/(a^2 - ff^2*x^2)^((n + 1)/2), x], x, a*Sin[e + f*x]/ff]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n + 1)/2]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(a*Sin[e + f*x])^(m + 2)*(b*Tan[e + f*x])^(n - 1)/(a^2* f*(n - 1)) - b^2*(m + 2)/(a^2*(n - 1))* Int[(a*Sin[e + f*x])^(m + 2)*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && (LtQ[m, -1] || EqQ[m, -1] && EqQ[n, 3/2]) && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n - 1)/(f*(n - 1)) - b^2*(m + n - 1)/(n - 1)* Int[(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && IntegersQ[2*m, 2*n] && Not[GtQ[m, 1] && Not[IntegerQ[(m - 1)/2]]]
Int[Sqrt[a_.*sin[e_. + f_.*x_]]/(b_.*tan[e_. + f_.*x_])^(3/2), x_Symbol] := 2*Sqrt[a*Sin[e + f*x]]/(b*f*Sqrt[b*Tan[e + f*x]]) + a^2/b^2*Int[Sqrt[b*Tan[e + f*x]]/(a*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, e, f}, x]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n + 1)/(b*f*m) - a^2*(n + 1)/(b^2*m)* Int[(a*Sin[e + f*x])^(m - 2)*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && LtQ[n, -1] && GtQ[m, 1] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n + 1)/(b*f*(m + n + 1)) - (n + 1)/(b^2*(m + n + 1))* Int[(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && NeQ[m + n + 1, 0] && IntegersQ[2*m, 2*n] && Not[EqQ[n, -3/2] && EqQ[m, 1]]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := -b*(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n - 1)/(f*m) + a^2*(m + n - 1)/m* Int[(a*Sin[e + f*x])^(m - 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && (GtQ[m, 1] || EqQ[m, 1] && EqQ[n, 1/2]) && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := b*(a*Sin[e + f*x])^(m + 2)*(b*Tan[e + f*x])^(n - 1)/(a^2* f*(m + n + 1)) + (m + 2)/(a^2*(m + n + 1))* Int[(a*Sin[e + f*x])^(m + 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && NeQ[m + n + 1, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*sin[e_. + f_.*x_])^m_*tan[e_. + f_.*x_]^n_, x_Symbol] := 1/a^n*Int[(a*Sin[e + f*x])^(m + n)/Cos[e + f*x]^n, x] /; FreeQ[{a, e, f, m}, x] && IntegerQ[n] && Not[IntegerQ[m]]
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := Cos[e + f*x]^n*(b*Tan[e + f*x])^n/(a*Sin[e + f*x])^n* Int[(a*Sin[e + f*x])^(m + n)/Cos[e + f*x]^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[n]] && (ILtQ[m, 0] || EqQ[m, 1] && EqQ[n, -1/2] || IntegersQ[m - 1/2, n - 1/2])
Int[(a_.*sin[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*Cos[ e + f*x]^(n + 1)*(b*Tan[e + f*x])^(n + 1)/(b*(a*Sin[e + f*x])^(n + 1))* Int[(a*Sin[e + f*x])^(m + n)/Cos[e + f*x]^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[n]]
Int[(a_.*cos[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/a)^FracPart[m]* Int[(b*Tan[e + f*x])^n/(Sec[e + f*x]/a)^m, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]
Int[(a_.*cot[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Cot[e + f*x])^m*(b*Tan[e + f*x])^m* Int[(b*Tan[e + f*x])^(n - m), x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := -(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n + 1)/(b*f*m) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n + 1, 0]
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := a/f*Subst[Int[(a*x)^(m - 1)*(-1 + x^2)^((n - 1)/2), x], x, Sec[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n - 1)/2] && Not[IntegerQ[m/2] && LtQ[0, m, n + 1]]
Int[sec[e_. + f_.*x_]^m_*(b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := 1/f*Subst[Int[(b*x)^n*(1 + x^2)^(m/2 - 1), x], x, Tan[e + f*x]] /; FreeQ[{b, e, f, n}, x] && IntegerQ[m/2] && Not[IntegerQ[(n - 1)/2] && LtQ[0, n, m - 1]]
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a^2*(a*Sec[e + f*x])^(m - 2)*(b*Tan[e + f*x])^(n + 1)/(b* f*(n + 1)) - a^2*(m - 2)/(b^2*(n + 1))* Int[(a*Sec[e + f*x])^(m - 2)*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && LtQ[n, -1] && (GtQ[m, 1] || EqQ[m, 1] && EqQ[n, -3/2]) && IntegersQ[2*m, 2*n]
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n + 1)/(b*f*(n + 1)) - (m + n + 1)/(b^2*(n + 1))* Int[(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && IntegersQ[2*m, 2*n]
Int[(a_.*sec[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n - 1)/(f*m) - b^2*(n - 1)/(a^2*m)* Int[(a*Sec[e + f*x])^(m + 2)*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && (LtQ[m, -1] || EqQ[m, -1] && EqQ[n, 3/2]) && IntegersQ[2*m, 2*n]
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n - 1)/(f*(m + n - 1)) - b^2*(n - 1)/(m + n - 1)* Int[(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*sec[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := -(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n + 1)/(b*f*m) + (m + n + 1)/(a^2*m)* Int[(a*Sec[e + f*x])^(m + 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && (LtQ[m, -1] || EqQ[m, -1] && EqQ[n, -1/2]) && IntegersQ[2*m, 2*n]
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a^2*(a*Sec[e + f*x])^(m - 2)*(b*Tan[e + f*x])^(n + 1)/(b* f*(m + n - 1)) + a^2*(m - 2)/(m + n - 1)* Int[(a*Sec[e + f*x])^(m - 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && (GtQ[m, 1] || EqQ[m, 1] && EqQ[n, 1/2]) && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[sec[e_. + f_.*x_]/Sqrt[b_.*tan[e_. + f_.*x_]], x_Symbol] := Sqrt[Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*Sqrt[b*Tan[e + f*x]])* Int[1/(Sqrt[Cos[e + f*x]]*Sqrt[Sin[e + f*x]]), x] /; FreeQ[{b, e, f}, x]
Int[Sqrt[b_.*tan[e_. + f_.*x_]]/sec[e_. + f_.*x_], x_Symbol] := Sqrt[Cos[e + f*x]]*Sqrt[b*Tan[e + f*x]]/Sqrt[Sin[e + f*x]]* Int[Sqrt[Cos[e + f*x]]*Sqrt[Sin[e + f*x]], x] /; FreeQ[{b, e, f}, x]
Int[(a_.*sec[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a^(m + n)*(b*Tan[e + f*x])^ n/((a*Sec[e + f*x])^n*(b*Sin[e + f*x])^n)* Int[(b*Sin[e + f*x])^n/Cos[e + f*x]^(m + n), x] /; FreeQ[{a, b, e, f, m, n}, x] && IntegerQ[n + 1/2] && IntegerQ[m + 1/2]
(* Int[(a_.*sec[e_.+f_.*x_])^m_.*(b_.*tan[e_.+f_.*x_])^n_,x_Symbol]:= (a*Sec[e+f*x])^m*(b*Tan[e+f*x])^(n+1)*(Cos[e+f*x]^2)^((m+n+1)/2)/(b* f*(b*Sin[e+f*x])^(n+1))* Subst[Int[x^n/(1-x^2/b^2)^((m+n+1)/2),x],x,b*Sin[e+f*x]] /; FreeQ[{a,b,e,f,m,n},x] && Not[IntegerQ[(n-1)/2]] &&  Not[IntegerQ[m/2]] *)
Int[(a_.*sec[e_. + f_.*x_])^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Sec[e + f*x])^ m*(b*Tan[e + f*x])^(n + 1)*(Cos[e + f*x]^2)^((m + n + 1)/2)/(b* f*(n + 1))* Hypergeometric2F1[(n + 1)/2, (m + n + 1)/2, (n + 3)/2, Sin[e + f*x]^2] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[(n - 1)/2]] && Not[IntegerQ[m/2]]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/a)^FracPart[m]* Int[(b*Tan[e + f*x])^n/(Sin[e + f*x]/a)^m, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.0.3 (a csc)^m (b sec)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.0.3 (a csc)^m (b sec)^n *)
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := a*b*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n - 1)/(f*(n - 1)) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n - 2, 0] && NeQ[n, 1]
Int[csc[e_. + f_.*x_]^m_.*sec[e_. + f_.*x_]^n_., x_Symbol] := 1/f*Subst[Int[(1 + x^2)^((m + n)/2 - 1)/x^m, x], x, Tan[e + f*x]] /; FreeQ[{e, f}, x] && IntegersQ[m, n, (m + n)/2]
Int[(a_.*csc[e_. + f_.*x_])^m_*sec[e_. + f_.*x_]^n_., x_Symbol] := -1/(f*a^n)* Subst[Int[x^(m + n - 1)/(-1 + x^2/a^2)^((n + 1)/2), x], x, a*Csc[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n + 1)/2] && Not[IntegerQ[(m + 1)/2] && LtQ[0, m, n]]
Int[(a_.*sec[e_. + f_.*x_])^m_*csc[e_. + f_.*x_]^n_., x_Symbol] := 1/(f*a^n)* Subst[Int[x^(m + n - 1)/(-1 + x^2/a^2)^((n + 1)/2), x], x, a*Sec[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n + 1)/2] && Not[IntegerQ[(m + 1)/2] && LtQ[0, m, n]]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := -a*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n + 1)/(f* b*(m - 1)) + a^2*(n + 1)/(b^2*(m - 1))* Int[(a*Csc[e + f*x])^(m - 2)*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[m, 1] && LtQ[n, -1] && IntegersQ[2*m, 2*n]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := b*(a*Csc[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n - 1)/(f*a*(n - 1)) + b^2*(m + 1)/(a^2*(n - 1))* Int[(a*Csc[e + f*x])^(m + 2)*(b*Sec[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_., x_Symbol] := -a*b*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n - 1)/(f*(m - 1)) + a^2*(m + n - 2)/(m - 1)* Int[(a*Csc[e + f*x])^(m - 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && IntegersQ[2*m, 2*n] && Not[GtQ[n, m]]
Int[(a_.*csc[e_. + f_.*x_])^m_.*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := a*b*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n - 1)/(f*(n - 1)) + b^2*(m + n - 2)/(n - 1)* Int[(a*Csc[e + f*x])^m*(b*Sec[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && IntegersQ[2*m, 2*n]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_., x_Symbol] := b*(a*Csc[e + f*x])^(m + 1)*(b*Sec[e + f*x])^(n - 1)/(a*f*(m + n)) + (m + 1)/(a^2*(m + n))* Int[(a*Csc[e + f*x])^(m + 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*csc[e_. + f_.*x_])^m_.*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := -a*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n + 1)/(b* f*(m + n)) + (n + 1)/(b^2*(m + n))* Int[(a*Csc[e + f*x])^m*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := (a*Csc[e + f*x])^m*(b*Sec[e + f*x])^n/Tan[e + f*x]^n* Int[Tan[e + f*x]^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[IntegerQ[n]] && EqQ[m + n, 0]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := (a*Csc[e + f*x])^m*(b*Sec[e + f*x])^n*(a*Sin[e + f*x])^ m*(b*Cos[e + f*x])^n* Int[(a*Sin[e + f*x])^(-m)*(b*Cos[e + f*x])^(-n), x] /; FreeQ[{a, b, e, f, m, n}, x] && IntegerQ[m - 1/2] && IntegerQ[n - 1/2]
Int[(a_.*csc[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_])^n_, x_Symbol] := a^2/b^2*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n + 1)*(a* Sin[e + f*x])^(m - 1)*(b*Cos[e + f*x])^(n + 1)* Int[(a*Sin[e + f*x])^(-m)*(b*Cos[e + f*x])^(-n), x] /; FreeQ[{a, b, e, f, m, n}, x] && Not[SimplerQ[-m, -n]]
Int[(a_.*sec[e_. + f_.*x_])^m_*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a^2/b^2*(a*Sec[e + f*x])^(m - 1)*(b*Csc[e + f*x])^(n + 1)*(a* Cos[e + f*x])^(m - 1)*(b*Sin[e + f*x])^(n + 1)* Int[(a*Cos[e + f*x])^(-m)*(b*Sin[e + f*x])^(-n), x] /; FreeQ[{a, b, e, f, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.1.1 (a+b sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.1.1 (a+b sin)^n *)
Int[sin[c_. + d_.*x_]^n_, x_Symbol] := -1/d*Subst[Int[Expand[(1 - x^2)^((n - 1)/2), x], x], x, Cos[c + d*x]] /; FreeQ[{c, d}, x] && IGtQ[(n - 1)/2, 0]
Int[sin[c_. + d_.*x_/2]^2, x_Symbol] := x/2 - Sin[2*c + d*x]/(2*d) /; FreeQ[{c, d}, x]
Int[(b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := (* -Cot[c+d*x]*(c*Sin[c+d*x])^n/(d*n) +  b^2*(n-1)/n*Int[(b*Sin[c+d*x])^(n-2),x] *) -b*Cos[c + d*x]*(b*Sin[c + d*x])^(n - 1)/(d*n) + b^2*(n - 1)/n*Int[(b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{b, c, d}, x] && GtQ[n, 1] && IntegerQ[2*n]
Int[(b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := Cos[c + d*x]*(b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1)) + (n + 2)/(b^2*(n + 1))*Int[(b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{b, c, d}, x] && LtQ[n, -1] && IntegerQ[2*n]
Int[sin[c_. + Pi/2 + d_.*x_], x_Symbol] := Sin[c + d*x]/d /; FreeQ[{c, d}, x]
Int[sin[c_. + d_.*x_], x_Symbol] := -Cos[c + d*x]/d /; FreeQ[{c, d}, x]
(* Int[1/sin[c_.+d_.*x_],x_Symbol] := Int[Csc[c+d*x],x] /; FreeQ[{c,d},x] *)
Int[Sqrt[sin[c_. + d_.*x_]], x_Symbol] := 2/d*EllipticE[1/2*(c - Pi/2 + d*x), 2] /; FreeQ[{c, d}, x]
Int[1/Sqrt[sin[c_. + d_.*x_]], x_Symbol] := 2/d*EllipticF[1/2*(c - Pi/2 + d*x), 2] /; FreeQ[{c, d}, x]
Int[(b_*sin[c_. + d_.*x_])^n_, x_Symbol] := (b*Sin[c + d*x])^n/Sin[c + d*x]^n*Int[Sin[c + d*x]^n, x] /; FreeQ[{b, c, d}, x] && LtQ[-1, n, 1] && IntegerQ[2*n]
(* Int[(b_.*sin[c_.+d_.*x_])^n_,x_Symbol] := Cos[c+d*x]/(b*d*Sqrt[Cos[c+d*x]^2])*Subst[Int[x^n/Sqrt[1-x^2/b^2],x] ,x,b*Sin[c+d*x]] /; FreeQ[{b,c,d,n},x] && Not[IntegerQ[2*n] || IntegerQ[3*n]] *)
Int[(b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := Cos[c + d*x]*(b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1)*Sqrt[Cos[c + d*x]^2])* Hypergeometric2F1[1/2, (n + 1)/2, (n + 3)/2, Sin[c + d*x]^2] /; FreeQ[{b, c, d, n}, x] && Not[IntegerQ[2*n]]
Int[(a_ + b_.*sin[c_. + d_.*x_])^2, x_Symbol] := (2*a^2 + b^2)*x/2 - 2*a*b*Cos[c + d*x]/d - b^2*Cos[c + d*x]*Sin[c + d*x]/(2*d) /; FreeQ[{a, b, c, d}, x]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(a + b*sin[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := -2*b*Cos[c + d*x]/(d*Sqrt[a + b*Sin[c + d*x]]) /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -b*Cos[c + d*x]*(a + b*Sin[c + d*x])^(n - 1)/(d*n) + a*(2*n - 1)/n*Int[(a + b*Sin[c + d*x])^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && IGtQ[n - 1/2, 0]
Int[1/(a_ + b_.*sin[c_. + d_.*x_]), x_Symbol] := -Cos[c + d*x]/(d*(b + a*Sin[c + d*x])) /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[1/Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := -2/d*Subst[Int[1/(2*a - x^2), x], x, b*Cos[c + d*x]/Sqrt[a + b*Sin[c + d*x]]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := b*Cos[c + d*x]*(a + b*Sin[c + d*x])^n/(a*d*(2*n + 1)) + (n + 1)/(a*(2*n + 1))*Int[(a + b*Sin[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
(* Int[(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] := a^2*Cos[c+d*x]/(d*Sqrt[a+b*Sin[c+d*x]]*Sqrt[a-b*Sin[c+d*x]])*Subst[ Int[(a+b*x)^(n-1/2)/Sqrt[a-b*x],x],x,Sin[c+d*x]] /; FreeQ[{a,b,c,d,n},x] && EqQ[a^2-b^2,0] && Not[IntegerQ[2*n]] *)
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -2^(n + 1/2)*a^(n - 1/2)*b* Cos[c + d*x]/(d*Sqrt[a + b*Sin[c + d*x]])* Hypergeometric2F1[1/2, 1/2 - n, 3/2, 1/2*(1 - b*Sin[c + d*x]/a)] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[2*n]] && GtQ[a, 0]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := a^IntPart[n]*(a + b*Sin[c + d*x])^ FracPart[n]/(1 + b/a*Sin[c + d*x])^FracPart[n]* Int[(1 + b/a*Sin[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[2*n]] && Not[GtQ[a, 0]]
Int[Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := 2*Sqrt[a + b]/d*EllipticE[1/2*(c - Pi/2 + d*x), 2*b/(a + b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a + b, 0]
Int[Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := 2*Sqrt[a - b]/d*EllipticE[1/2*(c + Pi/2 + d*x), -2*b/(a - b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a - b, 0]
Int[Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := Sqrt[a + b*Sin[c + d*x]]/Sqrt[(a + b*Sin[c + d*x])/(a + b)]* Int[Sqrt[a/(a + b) + b/(a + b)*Sin[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && Not[GtQ[a + b, 0]]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -b*Cos[c + d*x]*(a + b*Sin[c + d*x])^(n - 1)/(d*n) + 1/n* Int[(a + b*Sin[c + d*x])^(n - 2)* Simp[a^2*n + b^2*(n - 1) + a*b*(2*n - 1)*Sin[c + d*x], x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[1/(a_ + b_.*sin[c_. + d_.*x_]), x_Symbol] := With[{q = Rt[a^2 - b^2, 2]}, x/q + 2/(d*q)*ArcTan[b*Cos[c + d*x]/(a + q + b*Sin[c + d*x])]] /; FreeQ[{a, b, c, d}, x] && GtQ[a^2 - b^2, 0] && PosQ[a]
Int[1/(a_ + b_.*sin[c_. + d_.*x_]), x_Symbol] := With[{q = Rt[a^2 - b^2, 2]}, -x/q - 2/(d*q)*ArcTan[b*Cos[c + d*x]/(a - q + b*Sin[c + d*x])]] /; FreeQ[{a, b, c, d}, x] && GtQ[a^2 - b^2, 0] && NegQ[a]
Int[1/(a_ + b_.*sin[c_. + Pi/2 + d_.*x_]), x_Symbol] := With[{e = FreeFactors[Tan[(c + d*x)/2], x]}, 2*e/d* Subst[Int[1/(a + b + (a - b)*e^2*x^2), x], x, Tan[(c + d*x)/2]/e]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[1/(a_ + b_.*sin[c_. + d_.*x_]), x_Symbol] := With[{e = FreeFactors[Tan[(c + d*x)/2], x]}, 2*e/d* Subst[Int[1/(a + 2*b*e*x + a*e^2*x^2), x], x, Tan[(c + d*x)/2]/e]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[1/Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := 2/(d*Sqrt[a + b])*EllipticF[1/2*(c - Pi/2 + d*x), 2*b/(a + b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a + b, 0]
Int[1/Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := 2/(d*Sqrt[a - b])*EllipticF[1/2*(c + Pi/2 + d*x), -2*b/(a - b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a - b, 0]
Int[1/Sqrt[a_ + b_.*sin[c_. + d_.*x_]], x_Symbol] := Sqrt[(a + b*Sin[c + d*x])/(a + b)]/Sqrt[a + b*Sin[c + d*x]]* Int[1/Sqrt[a/(a + b) + b/(a + b)*Sin[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && Not[GtQ[a + b, 0]]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -b*Cos[ c + d*x]*(a + b*Sin[c + d*x])^(n + 1)/(d*(n + 1)*(a^2 - b^2)) + 1/((n + 1)*(a^2 - b^2))* Int[(a + b*Sin[c + d*x])^(n + 1)* Simp[a*(n + 1) - b*(n + 2)*Sin[c + d*x], x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[(a_ + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := Cos[c + d*x]/(d*Sqrt[1 + Sin[c + d*x]]*Sqrt[1 - Sin[c + d*x]])* Subst[Int[(a + b*x)^n/(Sqrt[1 + x]*Sqrt[1 - x]), x], x, Sin[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] && Not[IntegerQ[2*n]]
Int[(a_ + b_.*sin[c_. + d_.*x_]*cos[c_. + d_.*x_])^n_, x_Symbol] := Int[(a + b*Sin[2*c + 2*d*x]/2)^n, x] /; FreeQ[{a, b, c, d, n}, x]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.1.2 (g cos)^p (a+b sin)^m.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.1.2 (g cos)^p (a+b sin)^m *)
Int[cos[e_. + f_.*x_]^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := 1/(b^p*f)* Subst[Int[(a + x)^(m + (p - 1)/2)*(a - x)^((p - 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0] && (GeQ[p, -1] || Not[IntegerQ[m + 1/2]])
Int[cos[e_. + f_.*x_]^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := 1/(b^p*f)* Subst[Int[(a + x)^m*(b^2 - x^2)^((p - 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)/(f*g*(p + 1)) + a*Int[(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, p}, x] && (IntegerQ[2*p] || NeQ[a^2 - b^2, 0])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (a/g)^(2*m)* Int[(g*Cos[e + f*x])^(2*m + p)/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && LtQ[p, -1] && GeQ[2*m + p, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^m/(a*f*g*m) /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[Simplify[m + p + 1], 0] && Not[ILtQ[p, 0]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(a*f*g*Simplify[2*m + p + 1]) + Simplify[m + p + 1]/(a*Simplify[2*m + p + 1])* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && ILtQ[Simplify[m + p + 1], 0] && NeQ[2*m + p + 1, 0] && Not[IGtQ[m, 0]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)/(f* g*(m - 1)) /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p - 1, 0] && NeQ[m, 1]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)/(f* g*(m + p)) + a*(2*m + p - 1)/(m + p)* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[(2*m + p - 1)/2], 0] && NeQ[m + p, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(a*f*g*(p + 1)) + a*(m + p + 1)/(g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && LeQ[p, -2*m] && IntegersQ[m + 1/2, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)/(f* g*(p + 1)) + b^2*(2*m + p - 1)/(g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1] && LtQ[p, -1] && IntegersQ[2*m, 2*p]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/Sqrt[g_.*cos[e_. + f_.*x_]], x_Symbol] := a*Sqrt[1 + Cos[e + f*x]]* Sqrt[a + b*Sin[e + f*x]]/(a + a*Cos[e + f*x] + b*Sin[e + f*x])* Int[Sqrt[1 + Cos[e + f*x]]/Sqrt[g*Cos[e + f*x]], x] + b*Sqrt[1 + Cos[e + f*x]]* Sqrt[a + b*Sin[e + f*x]]/(a + a*Cos[e + f*x] + b*Sin[e + f*x])* Int[Sin[e + f*x]/(Sqrt[g*Cos[e + f*x]]*Sqrt[1 + Cos[e + f*x]]), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)/(f* g*(m + p)) + a*(2*m + p - 1)/(m + p)* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && NeQ[m + p, 0] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + p)) + g^2*(p - 1)/(a*(m + p))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[p, 1] && (GtQ[m, -2] || EqQ[2*m + p + 1, 0] || EqQ[m, -2] && IntegerQ[p]) && NeQ[m + p, 0] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := 2*g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(2*m + p + 1)) + g^2*(p - 1)/(b^2*(2*m + p + 1))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && LeQ[m, -2] && GtQ[p, 1] && NeQ[2*m + p + 1, 0] && Not[ILtQ[m + p + 1, 0]] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(a*f*g*(2*m + p + 1)) + (m + p + 1)/(a*(2*m + p + 1))* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && NeQ[2*m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)/(b*f*(p - 1)) + g^2/a*Int[(g*Cos[e + f*x])^(p - 2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[p, 1] && IntegerQ[2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)/(a*f*g*(p - 1)*(a + b*Sin[e + f*x])) + p/(a*(p - 1))*Int[(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && Not[GeQ[p, 1]] && IntegerQ[2*p]
Int[Sqrt[g_.*cos[e_. + f_.*x_]]/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := g*Sqrt[1 + Cos[e + f*x]]* Sqrt[a + b*Sin[e + f*x]]/(a + a*Cos[e + f*x] + b*Sin[e + f*x])* Int[Sqrt[1 + Cos[e + f*x]]/Sqrt[g*Cos[e + f*x]], x] - g*Sqrt[1 + Cos[e + f*x]]* Sqrt[a + b*Sin[e + f*x]]/(b + b*Cos[e + f*x] + a*Sin[e + f*x])* Int[Sin[e + f*x]/(Sqrt[g*Cos[e + f*x]]*Sqrt[1 + Cos[e + f*x]]), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^(3/2)/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := g*Sqrt[g*Cos[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]/(b*f) + g^2/(2*a)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[g*Cos[e + f*x]], x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)/(f* g*(2*p - 1)*(a + b*Sin[e + f*x])^(3/2)) + 2*a*(p - 2)/(2*p - 1)* Int[(g*Cos[e + f*x])^p/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[p, 2] && IntegerQ[2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)/(a*f*g*(p + 1)* Sqrt[a + b*Sin[e + f*x]]) + a*(2*p + 1)/(2*g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && LtQ[p, -1] && IntegerQ[2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := a^m*(g*Cos[e + f*x])^(p + 1)/(f* g*(1 + Sin[e + f*x])^((p + 1)/2)*(1 - Sin[e + f*x])^((p + 1)/2))* Subst[ Int[(1 + b/a*x)^(m + (p - 1)/2)*(1 - b/a*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := a^2*(g*Cos[e + f*x])^(p + 1)/(f* g*(a + b*Sin[e + f*x])^((p + 1)/2)*(a - b*Sin[e + f*x])^((p + 1)/2))* Subst[Int[(a + b*x)^(m + (p - 1)/2)*(a - b*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^m* Sin[e + f*x]/(f*g*(p + 1)) + 1/(g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1)*(a*(p + 2) + b*(m + p + 2)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 1] && LtQ[p, -1] && (IntegersQ[2*m, 2*p] || IntegerQ[m])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*(b + a*Sin[e + f*x])/(f*g*(p + 1)) + 1/(g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 2)*(b^2*(m - 1) + a^2*(p + 2) + a*b*(m + p + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && LtQ[p, -1] && (IntegersQ[2*m, 2*p] || IntegerQ[m])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)/(f* g*(m + p)) + 1/(m + p)* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m - 2)*(b^2*(m - 1) + a^2*(m + p) + a*b*(2*m + p - 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && NeQ[m + p, 0] && (IntegersQ[2*m, 2*p] || IntegerQ[m])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + 1)) + g^2*(p - 1)/(b*(m + 1))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1)* Sin[e + f*x], x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[p, 1] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)/(f* g*(a^2 - b^2)*(m + 1)) + 1/((a^2 - b^2)*(m + 1))* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m + 1)*(a*(m + 1) - b*(m + p + 2)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + p)) + g^2*(p - 1)/(b*(m + p))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^ m*(b + a*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[p, 1] && NeQ[m + p, 0] && IntegersQ[2*m, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)*(b - a*Sin[e + f*x])/(f*g*(a^2 - b^2)*(p + 1)) + 1/(g^2*(a^2 - b^2)*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^ m*(a^2*(p + 2) - b^2*(m + p + 2) + a*b*(m + p + 3)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && LtQ[p, -1] && IntegersQ[2*m, 2*p]
Int[1/(Sqrt[g_.*cos[e_. + f_.*x_]]*Sqrt[a_ + b_.*sin[e_. + f_.*x_]]), x_Symbol] := 2*Sqrt[2]*Sqrt[g*Cos[e + f*x]]* Sqrt[(a + b*Sin[e + f*x])/((a - b)*(1 - Sin[e + f*x]))]/ (f*g*Sqrt[a + b*Sin[e + f*x]]* Sqrt[(1 + Cos[e + f*x] + Sin[e + f*x])/(1 + Cos[e + f*x] - Sin[e + f*x])])* Subst[Int[1/Sqrt[1 + (a + b)*x^4/(a - b)], x], x, Sqrt[(1 + Cos[e + f*x] + Sin[e + f*x])/(1 + Cos[e + f*x] - Sin[e + f*x])]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(1 - Sin[e + f*x])*(a + b*Sin[e + f*x])^(m + 1)*(-(a - b)*(1 - Sin[e + f*x])/((a + b)*(1 + Sin[e + f*x])))^(m/2)/ (f*(a + b)*(m + 1))* Hypergeometric2F1[m + 1, m/2 + 1, m + 2, 2*(a + b*Sin[e + f*x])/((a + b)*(1 + Sin[e + f*x]))] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && EqQ[m + p + 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)/(f* g*(a - b)*(p + 1)) + a/(g^2*(a - b))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^ m/(1 - Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && EqQ[m + p + 2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)/(f* g*(a - b)*(p + 1)) - b*(m + p + 2)/(g^2*(a - b)*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m, x] + a/(g^2*(a - b))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^ m/(1 - Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m + p + 2, 0]
Int[Sqrt[g_.*cos[e_. + f_.*x_]]/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := With[{q = Rt[-a^2 + b^2, 2]}, a*g/(2*b)*Int[1/(Sqrt[g*Cos[e + f*x]]*(q + b*Cos[e + f*x])), x] - a*g/(2*b)* Int[1/(Sqrt[g*Cos[e + f*x]]*(q - b*Cos[e + f*x])), x] + b*g/f* Subst[Int[Sqrt[x]/(g^2*(a^2 - b^2) + b^2*x^2), x], x, g*Cos[e + f*x]]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[1/(Sqrt[g_.*cos[e_. + f_.*x_]]*(a_ + b_.*sin[e_. + f_.*x_])), x_Symbol] := With[{q = Rt[-a^2 + b^2, 2]}, -a/(2*q)* Int[1/(Sqrt[g*Cos[e + f*x]]*(q + b*Cos[e + f*x])), x] - a/(2*q)* Int[1/(Sqrt[g*Cos[e + f*x]]*(q - b*Cos[e + f*x])), x] + b*g/f* Subst[Int[1/(Sqrt[x]*(g^2*(a^2 - b^2) + b^2*x^2)), x], x, g*Cos[e + f*x]]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)/ (b* f*(m + p)*(-b*(1 - Sin[e + f*x])/(a + b*Sin[e + f*x]))^((p - 1)/ 2)*(b*(1 + Sin[e + f*x])/(a + b*Sin[e + f*x]))^((p - 1)/2))* AppellF1[-p - m, (1 - p)/2, (1 - p)/2, 1 - p - m, (a + b)/(a + b*Sin[e + f*x]), (a - b)/(a + b*Sin[e + f*x])] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m, 0] && Not[IGtQ[m + p + 1, 0]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)/(f*(1 - (a + b*Sin[e + f*x])/(a - b))^((p - 1)/ 2)*(1 - (a + b*Sin[e + f*x])/(a + b))^((p - 1)/2))* Subst[ Int[(-b/(a - b) - b*x/(a - b))^((p - 1)/2)*(b/(a + b) - b*x/(a + b))^((p - 1)/2)*(a + b*x)^m, x], x, Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && Not[IGtQ[m, 0]]
Int[(g_.*sec[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := g^(2*IntPart[p])*(g*Cos[e + f*x])^FracPart[p]*(g*Sec[e + f*x])^ FracPart[p]*Int[(a + b*Sin[e + f*x])^m/(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, m, p}, x] && Not[IntegerQ[p]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.1.3 (g tan)^p (a+b sin)^m.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.1.3 (g tan)^p (a+b sin)^m *)
Int[(g_.*tan[e_. + f_.*x_])^p_./(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := 1/a*Int[Sec[e + f*x]^2*(g*Tan[e + f*x])^p, x] - 1/(b*g)*Int[Sec[e + f*x]*(g*Tan[e + f*x])^(p + 1), x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && NeQ[p, -1]
Int[tan[e_. + f_.*x_]^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := 1/f*Subst[Int[x^p*(a + x)^(m - (p + 1)/2)/(a - x)^((p + 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[(p + 1)/2]
Int[tan[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := a^p*Int[Sin[e + f*x]^p/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p] && EqQ[p, 2*m]
Int[tan[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := a^p*Int[ ExpandIntegrand[ Sin[e + f*x]^ p*(a + b*Sin[e + f*x])^(m - p/2)/(a - b*Sin[e + f*x])^(p/2), x], x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p/2] && (LtQ[p, 0] || GtQ[m - p/2, 0])
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := Int[ExpandIntegrand[(g*Tan[e + f*x])^p, (a + b*Sin[e + f*x])^m, x], x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := a^(2*m)* Int[ExpandIntegrand[(g*Tan[e + f*x])^p* Sec[e + f*x]^(-m), (a*Sec[e + f*x] - b*Tan[e + f*x])^(-m), x], x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && ILtQ[m, 0]
Int[tan[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(a + b*Sin[e + f*x])^m/(a*f*(2*m - 1)*Cos[e + f*x]) - 1/(a^2*(2*m - 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(a*m - b*(2*m - 1)*Sin[e + f*x])/ Cos[e + f*x]^2, x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && LtQ[m, 0]
Int[tan[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -(a + b*Sin[e + f*x])^(m + 1)/(b*f*m*Cos[e + f*x]) + 1/(b*m)* Int[(a + b*Sin[e + f*x])^m*(b*(m + 1) + a*Sin[e + f*x])/ Cos[e + f*x]^2, x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && Not[LtQ[m, 0]]
Int[tan[e_. + f_.*x_]^4*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[(a + b*Sin[e + f*x])^m, x] - Int[(a + b*Sin[e + f*x])^m*(1 - 2*Sin[e + f*x]^2)/Cos[e + f*x]^4, x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^2, x_Symbol] := -(a + b*Sin[e + f*x])^(m + 1)/(a*f*Tan[e + f*x]) + 1/b^2* Int[(a + b*Sin[e + f*x])^(m + 1)*(b*m - a*(m + 1)*Sin[e + f*x])/ Sin[e + f*x], x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && LtQ[m, -1]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_./tan[e_. + f_.*x_]^2, x_Symbol] := -(a + b*Sin[e + f*x])^m/(f*Tan[e + f*x]) + 1/a* Int[(a + b*Sin[e + f*x])^m*(b*m - a*(m + 1)*Sin[e + f*x])/ Sin[e + f*x], x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^4, x_Symbol] := -2/(a*b)*Int[(a + b*Sin[e + f*x])^(m + 2)/Sin[e + f*x]^3, x] + 1/a^2* Int[(a + b*Sin[e + f*x])^(m + 2)*(1 + Sin[e + f*x]^2)/ Sin[e + f*x]^4, x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && LtQ[m, -1]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^4, x_Symbol] := Int[(a + b*Sin[e + f*x])^m, x] + Int[(a + b*Sin[e + f*x])^m*(1 - 2*Sin[e + f*x]^2)/Sin[e + f*x]^4, x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && Not[LtQ[m, -1]]
Int[tan[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Sqrt[a + b*Sin[e + f*x]]* Sqrt[a - b*Sin[e + f*x]]/(b*f*Cos[e + f*x])* Subst[Int[x^p*(a + x)^(m - (p + 1)/2)/(a - x)^((p + 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && IntegerQ[p/2]
Int[(g_.*tan[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (g*Tan[e + f*x])^(p + 1)*(a - b*Sin[e + f*x])^((p + 1)/ 2)*(a + b*Sin[e + f*x])^((p + 1)/2)/(f* g*(b*Sin[e + f*x])^(p + 1))* Subst[Int[x^p*(a + x)^(m - (p + 1)/2)/(a - x)^((p + 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[p]]
Int[tan[e_. + f_.*x_]^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := 1/f*Subst[Int[(x^p*(a + x)^m)/(b^2 - x^2)^((p + 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[(p + 1)/2]
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := Int[ExpandIntegrand[(g*Tan[e + f*x])^p, (a + b*Sin[e + f*x])^m, x], x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^2, x_Symbol] := Int[(a + b*Sin[e + f*x])^m*(1 - Sin[e + f*x]^2)/Sin[e + f*x]^2, x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^4, x_Symbol] := -Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(3*a*f*Sin[e + f*x]^3) - (3*a^2 + b^2*(m - 2))* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(3*a^2*b*f*(m + 1)* Sin[e + f*x]^2) - 1/(3*a^2*b*(m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)/Sin[e + f*x]^3* Simp[6*a^2 - b^2*(m - 1)*(m - 2) + a*b*(m + 1)*Sin[e + f*x] - (3*a^2 - b^2*m*(m - 2))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
(* Int[(a_+b_.*sin[e_.+f_.*x_])^m_/tan[e_.+f_.*x_]^4,x_Symbol] := -Cos[e+f*x]*(a+b*Sin[e+f*x])^(m+1)/(3*a*f*Sin[e+f*x]^3) - Cos[e+f*x]*(a+b*Sin[e+f*x])^(m+1)/(b*f*m*Sin[e+f*x]^2) - 1/(3*a*b*m)*Int[(a+b*Sin[e+f*x])^m/Sin[e+f*x]^3* Simp[6*a^2-b^2*m*(m-2)+a*b*(m+3)*Sin[e+f*x]-(3*a^2-b^2*m*(m-1))* Sin[e+f*x]^2,x],x] /; FreeQ[{a,b,e,f,m},x] && NeQ[a^2-b^2,0] && Not[LtQ[m,-1]] &&  IntegerQ[2*m] *)
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^4, x_Symbol] := -Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(3*a*f*Sin[e + f*x]^3) - b*(m - 2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(6*a^2*f* Sin[e + f*x]^2) - 1/(6*a^2)*Int[(a + b*Sin[e + f*x])^m/Sin[e + f*x]^2* Simp[8*a^2 - b^2*(m - 1)*(m - 2) + a*b*m*Sin[e + f*x] - (6*a^2 - b^2*m*(m - 2))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]] && IntegerQ[2*m]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_/tan[e_. + f_.*x_]^6, x_Symbol] := -Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(5*a*f*Sin[e + f*x]^5) - b*(m - 4)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(20*a^2*f* Sin[e + f*x]^4) + a*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b^2*f*m*(m - 1)* Sin[e + f*x]^3) + Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*m*Sin[e + f*x]^2) + 1/(20*a^2*b^2*m*(m - 1))* Int[(a + b*Sin[e + f*x])^m/Sin[e + f*x]^4* Simp[60*a^4 - 44*a^2*b^2*(m - 1)*m + b^4*m*(m - 1)*(m - 3)*(m - 4) + a*b*m*(20*a^2 - b^2*m*(m - 1))*Sin[e + f*x] - (40*a^4 + b^4*m*(m - 1)*(m - 2)*(m - 4) - 20*a^2*b^2*(m - 1)*(2*m + 1))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && NeQ[m, 1] && IntegerQ[2*m]
Int[(g_.*tan[e_. + f_.*x_])^p_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := a/(a^2 - b^2)*Int[(g*Tan[e + f*x])^p/Sin[e + f*x]^2, x] - b*g/(a^2 - b^2)*Int[(g*Tan[e + f*x])^(p - 1)/Cos[e + f*x], x] - a^2*g^2/(a^2 - b^2)* Int[(g*Tan[e + f*x])^(p - 2)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*p] && GtQ[p, 1]
Int[(g_.*tan[e_. + f_.*x_])^p_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := 1/a*Int[(g*Tan[e + f*x])^p/Cos[e + f*x]^2, x] - b/(a^2*g)*Int[(g*Tan[e + f*x])^(p + 1)/Cos[e + f*x], x] - (a^2 - b^2)/(a^2*g^2)* Int[(g*Tan[e + f*x])^(p + 2)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*p] && LtQ[p, -1]
Int[Sqrt[g_.*tan[e_. + f_.*x_]]/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := Sqrt[Cos[e + f*x]]*Sqrt[g*Tan[e + f*x]]/Sqrt[Sin[e + f*x]]* Int[Sqrt[Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[1/(Sqrt[g_*tan[e_. + f_.*x_]]*(a_ + b_.*sin[e_. + f_.*x_])), x_Symbol] := Sqrt[Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*Sqrt[g*Tan[e + f*x]])* Int[Sqrt[Cos[e + f*x]]/(Sqrt[Sin[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[tan[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[ExpandIntegrand[ Sin[e + f*x]^p*(a + b*Sin[e + f*x])^m/(1 - Sin[e + f*x]^2)^(p/2), x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[m, p/2]
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := Unintegrable[(g*Tan[e + f*x])^p*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x]
Int[(g_.*cot[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_., x_Symbol] := g^(2*IntPart[p])*(g*Cot[e + f*x])^FracPart[p]*(g*Tan[e + f*x])^ FracPart[p]*Int[(a + b*Sin[e + f*x])^m/(g*Tan[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, m, p}, x] && Not[IntegerQ[p]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.10 (c+d x)^m (a+b sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.10 (c+d x)^m (a+b sin)^n *)
Int[(c_. + d_.*x_)^m_.*sin[e_. + f_.*x_], x_Symbol] := -(c + d*x)^m*Cos[e + f*x]/f + d*m/f*Int[(c + d*x)^(m - 1)*Cos[e + f*x], x] /; FreeQ[{c, d, e, f}, x] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_*sin[e_. + f_.*x_], x_Symbol] := (c + d*x)^(m + 1)*Sin[e + f*x]/(d*(m + 1)) - f/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Cos[e + f*x], x] /; FreeQ[{c, d, e, f}, x] && LtQ[m, -1]
Int[sin[e_. + f_.*Complex[0, fz_]*x_]/(c_. + d_.*x_), x_Symbol] := I*SinhIntegral[c*f*fz/d + f*fz*x]/d /; FreeQ[{c, d, e, f, fz}, x] && EqQ[d*e - c*f*fz*I, 0]
Int[sin[e_. + f_.*x_]/(c_. + d_.*x_), x_Symbol] := SinIntegral[e + f*x]/d /; FreeQ[{c, d, e, f}, x] && EqQ[d*e - c*f, 0]
Int[sin[e_. + f_.*Complex[0, fz_]*x_]/(c_. + d_.*x_), x_Symbol] := CoshIntegral[-c*f*fz/d - f*fz*x]/d /; FreeQ[{c, d, e, f, fz}, x] && EqQ[d*(e - Pi/2) - c*f*fz*I, 0] && NegQ[c*f*fz/d, 0]
Int[sin[e_. + f_.*Complex[0, fz_]*x_]/(c_. + d_.*x_), x_Symbol] := CoshIntegral[c*f*fz/d + f*fz*x]/d /; FreeQ[{c, d, e, f, fz}, x] && EqQ[d*(e - Pi/2) - c*f*fz*I, 0]
Int[sin[e_. + f_.*x_]/(c_. + d_.*x_), x_Symbol] := CosIntegral[e - Pi/2 + f*x]/d /; FreeQ[{c, d, e, f}, x] && EqQ[d*(e - Pi/2) - c*f, 0]
Int[sin[e_. + f_.*x_]/(c_. + d_.*x_), x_Symbol] := Cos[(d*e - c*f)/d]*Int[Sin[c*f/d + f*x]/(c + d*x), x] + Sin[(d*e - c*f)/d]*Int[Cos[c*f/d + f*x]/(c + d*x), x] /; FreeQ[{c, d, e, f}, x] && NeQ[d*e - c*f, 0]
Int[sin[e_. + Pi/2 + f_.*x_]/Sqrt[c_. + d_.*x_], x_Symbol] := 2/d*Subst[Int[Cos[f*x^2/d], x], x, Sqrt[c + d*x]] /; FreeQ[{c, d, e, f}, x] && ComplexFreeQ[f] && EqQ[d*e - c*f, 0]
Int[sin[e_. + f_.*x_]/Sqrt[c_. + d_.*x_], x_Symbol] := 2/d*Subst[Int[Sin[f*x^2/d], x], x, Sqrt[c + d*x]] /; FreeQ[{c, d, e, f}, x] && ComplexFreeQ[f] && EqQ[d*e - c*f, 0]
Int[sin[e_. + f_.*x_]/Sqrt[c_. + d_.*x_], x_Symbol] := Cos[(d*e - c*f)/d]*Int[Sin[c*f/d + f*x]/Sqrt[c + d*x], x] + Sin[(d*e - c*f)/d]*Int[Cos[c*f/d + f*x]/Sqrt[c + d*x], x] /; FreeQ[{c, d, e, f}, x] && ComplexFreeQ[f] && NeQ[d*e - c*f, 0]
Int[(c_. + d_.*x_)^m_.*sin[e_. + k_.*Pi + f_.*x_], x_Symbol] := I/2*Int[(c + d*x)^m*E^(-I*k*Pi)*E^(-I*(e + f*x)), x] - I/2*Int[(c + d*x)^m*E^(I*k*Pi)*E^(I*(e + f*x)), x] /; FreeQ[{c, d, e, f, m}, x] && IntegerQ[2*k]
Int[(c_. + d_.*x_)^m_.*sin[e_. + f_.*x_], x_Symbol] := I/2*Int[(c + d*x)^m*E^(-I*(e + f*x)), x] - I/2*Int[(c + d*x)^m*E^(I*(e + f*x)), x] /; FreeQ[{c, d, e, f, m}, x]
Int[(c_. + d_.*x_)^m_.*sin[e_. + f_.*x_/2]^2, x_Symbol] := 1/2*Int[(c + d*x)^m, x] - 1/2*Int[(c + d*x)^m*Cos[2*e + f*x], x] /; FreeQ[{c, d, e, f, m}, x]
Int[(c_. + d_.*x_)*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := d*(b*Sin[e + f*x])^n/(f^2*n^2) - b*(c + d*x)*Cos[e + f*x]*(b*Sin[e + f*x])^(n - 1)/(f*n) + b^2*(n - 1)/n*Int[(c + d*x)*(b*Sin[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1]
Int[(c_. + d_.*x_)^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := d*m*(c + d*x)^(m - 1)*(b*Sin[e + f*x])^n/(f^2*n^2) - b*(c + d*x)^m*Cos[e + f*x]*(b*Sin[e + f*x])^(n - 1)/(f*n) + b^2*(n - 1)/n*Int[(c + d*x)^m*(b*Sin[e + f*x])^(n - 2), x] - d^2*m*(m - 1)/(f^2*n^2)* Int[(c + d*x)^(m - 2)*(b*Sin[e + f*x])^n, x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && GtQ[m, 1]
Int[(c_. + d_.*x_)^m_*sin[e_. + f_.*x_]^n_, x_Symbol] := Int[ExpandTrigReduce[(c + d*x)^m, Sin[e + f*x]^n, x], x] /; FreeQ[{c, d, e, f, m}, x] && IGtQ[n, 1] && (Not[RationalQ[m]] || GeQ[m, -1] && LtQ[m, 1])
Int[(c_. + d_.*x_)^m_*sin[e_. + f_.*x_]^n_, x_Symbol] := (c + d*x)^(m + 1)*Sin[e + f*x]^n/(d*(m + 1)) - f*n/(d*(m + 1))* Int[ExpandTrigReduce[(c + d*x)^(m + 1), Cos[e + f*x]*Sin[e + f*x]^(n - 1), x], x] /; FreeQ[{c, d, e, f, m}, x] && IGtQ[n, 1] && GeQ[m, -2] && LtQ[m, -1]
Int[(c_. + d_.*x_)^m_*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (c + d*x)^(m + 1)*(b*Sin[e + f*x])^n/(d*(m + 1)) - b*f*n*(c + d*x)^(m + 2)* Cos[e + f*x]*(b*Sin[e + f*x])^(n - 1)/(d^2*(m + 1)*(m + 2)) - f^2*n^2/(d^2*(m + 1)*(m + 2))* Int[(c + d*x)^(m + 2)*(b*Sin[e + f*x])^n, x] + b^2*f^2*n*(n - 1)/(d^2*(m + 1)*(m + 2))* Int[(c + d*x)^(m + 2)*(b*Sin[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && LtQ[m, -2]
Int[(c_. + d_.*x_)*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (c + d*x)*Cos[e + f*x]*(b*Sin[e + f*x])^(n + 1)/(b*f*(n + 1)) - d*(b*Sin[e + f*x])^(n + 2)/(b^2*f^2*(n + 1)*(n + 2)) + (n + 2)/(b^2*(n + 1))* Int[(c + d*x)*(b*Sin[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && NeQ[n, -2]
Int[(c_. + d_.*x_)^m_.*(b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (c + d*x)^m*Cos[e + f*x]*(b*Sin[e + f*x])^(n + 1)/(b*f*(n + 1)) - d*m*(c + d*x)^(m - 1)*(b*Sin[e + f*x])^(n + 2)/(b^2* f^2*(n + 1)*(n + 2)) + (n + 2)/(b^2*(n + 1))* Int[(c + d*x)^m*(b*Sin[e + f*x])^(n + 2), x] + d^2*m*(m - 1)/(b^2*f^2*(n + 1)*(n + 2))* Int[(c + d*x)^(m - 2)*(b*Sin[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && NeQ[n, -2] && GtQ[m, 1]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*sin[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*Sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 0] && (EqQ[n, 1] || IGtQ[m, 0] || NeQ[a^2 - b^2, 0])
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*sin[e_. + f_.*x_])^n_., x_Symbol] := (2*a)^n* Int[(c + d*x)^m*Sin[1/2*(e + Pi*a/(2*b)) + f*x/2]^(2*n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[n] && (GtQ[n, 0] || IGtQ[m, 0])
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (2*a)^IntPart[n]*(a + b*Sin[e + f*x])^FracPart[n]/ Sin[e/2 + a*Pi/(4*b) + f*x/2]^(2*FracPart[n])* Int[(c + d*x)^m*Sin[e/2 + a*Pi/(4*b) + f*x/2]^(2*n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[n + 1/2] && (GtQ[n, 0] || IGtQ[m, 0])
(* Int[(c_.+d_.*x_)^m_.*(a_+b_.*sin[e_.+f_.*x_])^n_.,x_Symbol] := (2*a)^n*Int[(c+d*x)^m*Cos[1/2*(e-Pi*a/(2*b))+f*x/2]^(2*n),x] /; FreeQ[{a,b,c,d,e,f,m},x] && EqQ[a^2-b^2,0] && IntegerQ[n] &&  (GtQ[n,0] || IGtQ[m,0]) *)
(* Int[(c_.+d_.*x_)^m_.*(a_+b_.*sin[e_.+f_.*x_])^n_,x_Symbol] := (2*a)^IntPart[n]*(a+b*Sin[e+f*x])^FracPart[n]/Cos[1/2*(e-Pi*a/(2*b)) +f*x/2]^(2*FracPart[n])* Int[(c+d*x)^m*Cos[1/2*(e-Pi*a/(2*b))+f*x/2]^(2*n),x] /; FreeQ[{a,b,c,d,e,f,m},x] && EqQ[a^2-b^2,0] && IntegerQ[n+1/2] &&  (GtQ[n,0] || IGtQ[m,0]) *)
Int[(c_. + d_.*x_)^ m_./(a_ + b_.*sin[e_. + k_.*Pi + f_.*Complex[0, fz_]*x_]), x_Symbol] := 2*Int[(c + d*x)^m*E^(-I*Pi*(k - 1/2))* E^(-I*e + f*fz*x)/(b + 2*a*E^(-I*Pi*(k - 1/2))*E^(-I*e + f*fz*x) - b*E^(-2*I*k*Pi)*E^(2*(-I*e + f*fz*x))), x] /; FreeQ[{a, b, c, d, e, f, fz}, x] && IntegerQ[2*k] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*sin[e_. + k_.*Pi + f_.*x_]), x_Symbol] := 2*Int[(c + d*x)^m*E^(I*Pi*(k - 1/2))* E^(I*(e + f*x))/(b + 2*a*E^(I*Pi*(k - 1/2))*E^(I*(e + f*x)) - b*E^(2*I*k*Pi)*E^(2*I*(e + f*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IntegerQ[2*k] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
(* Int[(c_.+d_.*x_)^m_./(a_+b_.*sin[e_.+f_.*Complex[0,fz_]*x_]),x_ Symbol] := 2*I*Int[(c+d*x)^m*E^(-I*e+f*fz*x)/(b+2*I*a*E^(-I*e+f*fz*x)-b*E^(2*(- I*e+f*fz*x))),x] /; FreeQ[{a,b,c,d,e,f,fz},x] && NeQ[a^2-b^2,0] && IGtQ[m,0] *)
(* Int[(c_.+d_.*x_)^m_./(a_+b_.*sin[e_.+f_.*x_]),x_Symbol] := -2*I*Int[(c+d*x)^m*E^(I*(e+f*x))/(b-2*I*a*E^(I*(e+f*x))-b*E^(2*I*(e+ f*x))),x] /; FreeQ[{a,b,c,d,e,f},x] && NeQ[a^2-b^2,0] && IGtQ[m,0] *)
Int[(c_. + d_.*x_)^m_./(a_ + b_.*sin[e_. + f_.*Complex[0, fz_]*x_]), x_Symbol] := 2*Int[(c + d*x)^m* E^(-I*e + f*fz*x)/(-I*b + 2*a*E^(-I*e + f*fz*x) + I*b*E^(2*(-I*e + f*fz*x))), x] /; FreeQ[{a, b, c, d, e, f, fz}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := 2*Int[(c + d*x)^m* E^(I*(e + f*x))/(I*b + 2*a*E^(I*(e + f*x)) - I*b*E^(2*I*(e + f*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*sin[e_. + f_.*x_])^2, x_Symbol] := b*(c + d*x)^m*Cos[e + f*x]/(f*(a^2 - b^2)*(a + b*Sin[e + f*x])) + a/(a^2 - b^2)*Int[(c + d*x)^m/(a + b*Sin[e + f*x]), x] - b*d*m/(f*(a^2 - b^2))* Int[(c + d*x)^(m - 1)*Cos[e + f*x]/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*(c + d*x)^m* Cos[e + f* x]*(a + b*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(a^2 - b^2)) + a/(a^2 - b^2)* Int[(c + d*x)^m*(a + b*Sin[e + f*x])^(n + 1), x] + b*d*m/(f*(n + 1)*(a^2 - b^2))* Int[(c + d*x)^(m - 1)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(n + 1), x] - b*(n + 2)/((n + 1)*(a^2 - b^2))* Int[(c + d*x)^m*Sin[e + f*x]*(a + b*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 - b^2, 0] && ILtQ[n, -2] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*sin[e_. + f_.*x_])^n_., x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[u_^m_.*(a_. + b_.*Sin[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Sin[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*(a_. + b_.*Cos[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Cos[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.11 (e x)^m (a+b x^n)^p sin.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.11 (e x)^m (a+b x^n)^p sin *)
Int[(a_ + b_.*x_^n_)^p_.*Sin[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_.*Cos[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := x^(-n + 1)*(a + b*x^n)^(p + 1)*Sin[c + d*x]/(b*n*(p + 1)) - (-n + 1)/(b*n*(p + 1))* Int[x^(-n)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] - d/(b*n*(p + 1))* Int[x^(-n + 1)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, -1] && IGtQ[n, 2]
Int[(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := x^(-n + 1)*(a + b*x^n)^(p + 1)*Cos[c + d*x]/(b*n*(p + 1)) - (-n + 1)/(b*n*(p + 1))* Int[x^(-n)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] + d/(b*n*(p + 1))* Int[x^(-n + 1)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, -1] && IGtQ[n, 2]
Int[(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := Int[x^(n*p)*(b + a*x^(-n))^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := Int[x^(n*p)*(b + a*x^(-n))^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := Unintegrable[(a + b*x^n)^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := Unintegrable[(a + b*x^n)^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Sin[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], (e*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Cos[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], (e*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := e^m*(a + b*x^n)^(p + 1)*Sin[c + d*x]/(b*n*(p + 1)) - d*e^m/(b*n*(p + 1))*Int[(a + b*x^n)^(p + 1)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && ILtQ[p, -1] && EqQ[m, n - 1] && (IntegerQ[n] || GtQ[e, 0])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := e^m*(a + b*x^n)^(p + 1)*Cos[c + d*x]/(b*n*(p + 1)) + d*e^m/(b*n*(p + 1))*Int[(a + b*x^n)^(p + 1)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && ILtQ[p, -1] && EqQ[m, n - 1] && (IntegerQ[n] || GtQ[e, 0])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := x^(m - n + 1)*(a + b*x^n)^(p + 1)*Sin[c + d*x]/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] - d/(b*n*(p + 1))* Int[x^(m - n + 1)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, -1] && IGtQ[n, 0] && (GtQ[m - n + 1, 0] || GtQ[n, 2]) && RationalQ[m]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := x^(m - n + 1)*(a + b*x^n)^(p + 1)*Cos[c + d*x]/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] + d/(b*n*(p + 1))* Int[x^(m - n + 1)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, -1] && IGtQ[n, 0] && (GtQ[m - n + 1, 0] || GtQ[n, 2]) && RationalQ[m]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], x^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1]) && IntegerQ[m]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], x^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1]) && IntegerQ[m]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Sin[c_. + d_.*x_], x_Symbol] := Int[x^(m + n*p)*(b + a*x^(-n))^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Cos[c_. + d_.*x_], x_Symbol] := Int[x^(m + n*p)*(b + a*x^(-n))^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Sin[c_. + d_.*x_], x_Symbol] := Unintegrable[(e*x)^m*(a + b*x^n)^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Cos[c_. + d_.*x_], x_Symbol] := Unintegrable[(e*x)^m*(a + b*x^n)^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.12 (e x)^m (a+b sin(c+d x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.12 (e x)^m (a+b sin(c+d x^n))^p *)
Int[Sin[d_.*(e_. + f_.*x_)^2], x_Symbol] := Sqrt[Pi/2]/(f*Rt[d, 2])*FresnelS[Sqrt[2/Pi]*Rt[d, 2]*(e + f*x)] /; FreeQ[{d, e, f}, x]
Int[Cos[d_.*(e_. + f_.*x_)^2], x_Symbol] := Sqrt[Pi/2]/(f*Rt[d, 2])*FresnelC[Sqrt[2/Pi]*Rt[d, 2]*(e + f*x)] /; FreeQ[{d, e, f}, x]
Int[Sin[c_ + d_.*(e_. + f_.*x_)^2], x_Symbol] := Sin[c]*Int[Cos[d*(e + f*x)^2], x] + Cos[c]*Int[Sin[d*(e + f*x)^2], x] /; FreeQ[{c, d, e, f}, x]
Int[Cos[c_ + d_.*(e_. + f_.*x_)^2], x_Symbol] := Cos[c]*Int[Cos[d*(e + f*x)^2], x] - Sin[c]*Int[Sin[d*(e + f*x)^2], x] /; FreeQ[{c, d, e, f}, x]
Int[Sin[c_. + d_.*(e_. + f_.*x_)^n_], x_Symbol] := I/2*Int[E^(-c*I - d*I*(e + f*x)^n), x] - I/2*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f}, x] && IGtQ[n, 2]
Int[Cos[c_. + d_.*(e_. + f_.*x_)^n_], x_Symbol] := 1/2*Int[E^(-c*I - d*I*(e + f*x)^n), x] + 1/2*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f}, x] && IGtQ[n, 2]
Int[(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Sin[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 1] && IGtQ[n, 1]
Int[(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Cos[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 1] && IGtQ[n, 1]
Int[(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^p_., x_Symbol] := -1/f*Subst[Int[(a + b*Sin[c + d*x^(-n)])^p/x^2, x], x, 1/(e + f*x)] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[n, 0] && EqQ[n, -2]
Int[(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^p_., x_Symbol] := -1/f*Subst[Int[(a + b*Cos[c + d*x^(-n)])^p/x^2, x], x, 1/(e + f*x)] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[n, 0] && EqQ[n, -2]
Int[(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^p_., x_Symbol] := 1/(n*f)* Subst[Int[x^(1/n - 1)*(a + b*Sin[c + d*x])^p, x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^p_., x_Symbol] := 1/(n*f)* Subst[Int[x^(1/n - 1)*(a + b*Cos[c + d*x])^p, x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k/f* Subst[Int[x^(k - 1)*(a + b*Sin[c + d*x^(k*n)])^p, x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && FractionQ[n]
Int[(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k/f* Subst[Int[x^(k - 1)*(a + b*Cos[c + d*x^(k*n)])^p, x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && FractionQ[n]
Int[Sin[c_. + d_.*(e_. + f_.*x_)^n_], x_Symbol] := I/2*Int[E^(-c*I - d*I*(e + f*x)^n), x] - I/2*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f, n}, x]
Int[Cos[c_. + d_.*(e_. + f_.*x_)^n_], x_Symbol] := 1/2*Int[E^(-c*I - d*I*(e + f*x)^n), x] + 1/2*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f, n}, x]
Int[(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Sin[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[p, 1]
Int[(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Cos[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[p, 1]
Int[(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^p_, x_Symbol] := Unintegrable[(a + b*Sin[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, n, p}, x]
Int[(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^p_, x_Symbol] := Unintegrable[(a + b*Cos[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, n, p}, x]
Int[(a_. + b_.*Sin[c_. + d_.*u_^n_])^p_., x_Symbol] := Int[(a + b*Sin[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && Not[LinearMatchQ[u, x]]
Int[(a_. + b_.*Cos[c_. + d_.*u_^n_])^p_., x_Symbol] := Int[(a + b*Cos[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && Not[LinearMatchQ[u, x]]
Int[(a_. + b_.*Sin[u_])^p_., x_Symbol] := Int[(a + b*Sin[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(a_. + b_.*Cos[u_])^p_., x_Symbol] := Int[(a + b*Cos[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[Sin[d_.*x_^n_]/x_, x_Symbol] := SinIntegral[d*x^n]/n /; FreeQ[{d, n}, x]
Int[Cos[d_.*x_^n_]/x_, x_Symbol] := CosIntegral[d*x^n]/n /; FreeQ[{d, n}, x]
Int[Sin[c_ + d_.*x_^n_]/x_, x_Symbol] := Sin[c]*Int[Cos[d*x^n]/x, x] + Cos[c]*Int[Sin[d*x^n]/x, x] /; FreeQ[{c, d, n}, x]
Int[Cos[c_ + d_.*x_^n_]/x_, x_Symbol] := Cos[c]*Int[Cos[d*x^n]/x, x] - Sin[c]*Int[Sin[d*x^n]/x, x] /; FreeQ[{c, d, n}, x]
Int[x_^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Sin[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IntegerQ[ Simplify[(m + 1)/n]] && (EqQ[p, 1] || EqQ[m, n - 1] || IntegerQ[p] && GtQ[Simplify[(m + 1)/n], 0])
Int[x_^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Cos[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IntegerQ[ Simplify[(m + 1)/n]] && (EqQ[p, 1] || EqQ[m, n - 1] || IntegerQ[p] && GtQ[Simplify[(m + 1)/n], 0])
Int[(e_*x_)^m_*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(e_*x_)^m_*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*Sin[a_. + b_.*x_^n_], x_Symbol] := 2/n*Subst[Int[Sin[a + b*x^2], x], x, x^(n/2)] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n/2 - 1]
Int[x_^m_.*Cos[a_. + b_.*x_^n_], x_Symbol] := 2/n*Subst[Int[Cos[a + b*x^2], x], x, x^(n/2)] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n/2 - 1]
Int[(e_.*x_)^m_.*Sin[c_. + d_.*x_^n_], x_Symbol] := -e^(n - 1)*(e*x)^(m - n + 1)*Cos[c + d*x^n]/(d*n) + e^n*(m - n + 1)/(d*n)*Int[(e*x)^(m - n)*Cos[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[n, m + 1]
Int[(e_.*x_)^m_.*Cos[c_. + d_.*x_^n_], x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*Sin[c + d*x^n]/(d*n) - e^n*(m - n + 1)/(d*n)*Int[(e*x)^(m - n)*Sin[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[n, m + 1]
Int[(e_.*x_)^m_*Sin[c_. + d_.*x_^n_], x_Symbol] := (e*x)^(m + 1)*Sin[c + d*x^n]/(e*(m + 1)) - d*n/(e^n*(m + 1))*Int[(e*x)^(m + n)*Cos[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[(e_.*x_)^m_*Cos[c_. + d_.*x_^n_], x_Symbol] := (e*x)^(m + 1)*Cos[c + d*x^n]/(e*(m + 1)) + d*n/(e^n*(m + 1))*Int[(e*x)^(m + n)*Sin[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[(e_.*x_)^m_.*Sin[c_. + d_.*x_^n_], x_Symbol] := I/2*Int[(e*x)^m*E^(-c*I - d*I*x^n), x] - I/2*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m}, x] && IGtQ[n, 0]
Int[(e_.*x_)^m_.*Cos[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[(e*x)^m*E^(-c*I - d*I*x^n), x] + 1/2*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m}, x] && IGtQ[n, 0]
Int[x_^m_.*Sin[a_. + b_.*x_^n_/2]^2, x_Symbol] := 1/2*Int[x^m, x] - 1/2*Int[x^m*Cos[2*a + b*x^n], x] /; FreeQ[{a, b, m, n}, x]
Int[x_^m_.*Cos[a_. + b_.*x_^n_/2]^2, x_Symbol] := 1/2*Int[x^m, x] + 1/2*Int[x^m*Cos[2*a + b*x^n], x] /; FreeQ[{a, b, m, n}, x]
Int[x_^m_.*Sin[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m + 1)*Sin[a + b*x^n]^p/(m + 1) - b*n*p/(m + 1)*Int[Sin[a + b*x^n]^(p - 1)*Cos[a + b*x^n], x] /; FreeQ[{a, b}, x] && IGtQ[p, 1] && EqQ[m + n, 0] && NeQ[n, 1] && IntegerQ[n]
Int[x_^m_.*Cos[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m + 1)*Cos[a + b*x^n]^p/(m + 1) + b*n*p/(m + 1)*Int[Cos[a + b*x^n]^(p - 1)*Sin[a + b*x^n], x] /; FreeQ[{a, b}, x] && IGtQ[p, 1] && EqQ[m + n, 0] && NeQ[n, 1] && IntegerQ[n]
Int[x_^m_.*Sin[a_. + b_.*x_^n_]^p_, x_Symbol] := n*Sin[a + b*x^n]^p/(b^2*n^2*p^2) - x^n*Cos[a + b*x^n]*Sin[a + b*x^n]^(p - 1)/(b*n*p) + (p - 1)/p*Int[x^m*Sin[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && GtQ[p, 1]
Int[x_^m_.*Cos[a_. + b_.*x_^n_]^p_, x_Symbol] := n*Cos[a + b*x^n]^p/(b^2*n^2*p^2) + x^n*Sin[a + b*x^n]*Cos[a + b*x^n]^(p - 1)/(b*n*p) + (p - 1)/p*Int[x^m*Cos[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && GtQ[p, 1]
Int[x_^m_.*Sin[a_. + b_.*x_^n_]^p_, x_Symbol] := (m - n + 1)*x^(m - 2*n + 1)*Sin[a + b*x^n]^p/(b^2*n^2*p^2) - x^(m - n + 1)*Cos[a + b*x^n]*Sin[a + b*x^n]^(p - 1)/(b*n*p) + (p - 1)/p*Int[x^m*Sin[a + b*x^n]^(p - 2), x] - (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*p^2)* Int[x^(m - 2*n)*Sin[a + b*x^n]^p, x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[x_^m_.*Cos[a_. + b_.*x_^n_]^p_, x_Symbol] := (m - n + 1)*x^(m - 2*n + 1)*Cos[a + b*x^n]^p/(b^2*n^2*p^2) + x^(m - n + 1)*Sin[a + b*x^n]*Cos[a + b*x^n]^(p - 1)/(b*n*p) + (p - 1)/p*Int[x^m*Cos[a + b*x^n]^(p - 2), x] - (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*p^2)* Int[x^(m - 2*n)*Cos[a + b*x^n]^p, x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[x_^m_.*Sin[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m + 1)*Sin[a + b*x^n]^p/(m + 1) - b*n*p*x^(m + n + 1)*Cos[a + b*x^n]* Sin[a + b*x^n]^(p - 1)/((m + 1)*(m + n + 1)) - b^2*n^2*p^2/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Sin[a + b*x^n]^p, x] + b^2*n^2*p*(p - 1)/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Sin[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && ILtQ[m, -2*n + 1] && NeQ[m + n + 1, 0]
Int[x_^m_.*Cos[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m + 1)*Cos[a + b*x^n]^p/(m + 1) + b*n*p*x^(m + n + 1)*Sin[a + b*x^n]* Cos[a + b*x^n]^(p - 1)/((m + 1)*(m + n + 1)) - b^2*n^2*p^2/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Cos[a + b*x^n]^p, x] + b^2*n^2*p*(p - 1)/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Cos[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && ILtQ[m, -2*n + 1] && NeQ[m + n + 1, 0]
Int[(e_.*x_)^m_*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, k/e* Subst[Int[x^(k*(m + 1) - 1)*(a + b*Sin[c + d*x^(k*n)/e^n])^p, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && IGtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, k/e* Subst[Int[x^(k*(m + 1) - 1)*(a + b*Cos[c + d*x^(k*n)/e^n])^p, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && IGtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Sin[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(e_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Cos[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[x_^m_.*Sin[a_. + b_.*x_^n_]^p_, x_Symbol] := x^n*Cos[a + b*x^n]*Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - n*Sin[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) + (p + 2)/(p + 1)*Int[x^m*Sin[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^m_.*Cos[a_. + b_.*x_^n_]^p_, x_Symbol] := -x^n*Sin[a + b*x^n]*Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - n*Cos[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) + (p + 2)/(p + 1)*Int[x^m*Cos[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^m_.*Sin[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m - n + 1)*Cos[a + b*x^n]* Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - (m - n + 1)*x^(m - 2*n + 1)* Sin[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) + (p + 2)/(p + 1)*Int[x^m*Sin[a + b*x^n]^(p + 2), x] + (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*(p + 1)*(p + 2))* Int[x^(m - 2*n)*Sin[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b}, x] && LtQ[p, -1] && NeQ[p, -2] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[x_^m_.*Cos[a_. + b_.*x_^n_]^p_, x_Symbol] := -x^(m - n + 1)*Sin[a + b*x^n]*Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - (m - n + 1)*x^(m - 2*n + 1)* Cos[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) + (p + 2)/(p + 1)*Int[x^m*Cos[a + b*x^n]^(p + 2), x] + (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*(p + 1)*(p + 2))* Int[x^(m - 2*n)*Cos[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b}, x] && LtQ[p, -1] && NeQ[p, -2] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[x_^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(a + b*Sin[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0] && ILtQ[n, 0] && IntegerQ[m] && EqQ[n, -2]
Int[x_^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(a + b*Cos[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0] && ILtQ[n, 0] && IntegerQ[m] && EqQ[n, -2]
Int[(e_.*x_)^m_*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, -k/e* Subst[Int[(a + b*Sin[c + d/(e^n*x^(k*n))])^p/x^(k*(m + 1) + 1), x], x, 1/(e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && ILtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, -k/e* Subst[Int[(a + b*Cos[c + d/(e^n*x^(k*n))])^p/x^(k*(m + 1) + 1), x], x, 1/(e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && ILtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := -(e*x)^m*(x^(-1))^m* Subst[Int[(a + b*Sin[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 0] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[(e_.*x_)^m_*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := -(e*x)^m*(x^(-1))^m* Subst[Int[(a + b*Cos[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 0] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Sin[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[p] && FractionQ[n]
Int[x_^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Cos[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[p] && FractionQ[n]
Int[(e_*x_)^m_*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && FractionQ[n]
Int[(e_*x_)^m_*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && FractionQ[n]
Int[x_^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*Sin[c + d*x^Simplify[n/(m + 1)]])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[x_^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*Cos[c + d*x^Simplify[n/(m + 1)]])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[(e_*x_)^m_*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[(e_*x_)^m_*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[(e_.*x_)^m_.*Sin[c_. + d_.*x_^n_], x_Symbol] := I/2*Int[(e*x)^m*E^(-c*I - d*I*x^n), x] - I/2*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*Cos[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[(e*x)^m*E^(-c*I - d*I*x^n), x] + 1/2*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Sin[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Cos[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(e*x)^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(e*x)^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Sin[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Sin[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(e_*x_)^m_.*(a_. + b_.*Cos[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Cos[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := 1/(n*f)* Subst[Int[ ExpandIntegrand[(a + b*Sin[c + d*x])^p, x^(1/n - 1)*(g - e*h/f + h*x^(1/n)/f)^m, x], x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := 1/(n*f)* Subst[Int[ ExpandIntegrand[(a + b*Cos[c + d*x])^p, x^(1/n - 1)*(g - e*h/f + h*x^(1/n)/f)^m, x], x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && IntegerQ[1/n]
(* Int[(g_.+h_.*x_)^m_.*(a_.+b_.*Sin[c_.+d_.*(e_.+f_.*x_)^n_])^p_.,x_ Symbol] := 1/(n*f^(m+1))*Subst[Int[ExpandIntegrand[(a+b*Sin[c+d*x])^p,x^(1/n-1) *(f*g-e*h+h*x^(1/n))^m,x],x],x,(e+f*x)^n] /; FreeQ[{a,b,c,d,e,f,g,h},x] && IGtQ[p,0] && IntegerQ[m] &&  IntegerQ[1/n] *)
(* Int[(g_.+h_.*x_)^m_.*(a_.+b_.*Cos[c_.+d_.*(e_.+f_.*x_)^n_])^p_.,x_ Symbol] := 1/(n*f^(m+1))*Subst[Int[ExpandIntegrand[(a+b*Cos[c+d*x])^p,x^(1/n-1) *(f*g-e*h+h*x^(1/n))^m,x],x],x,(e+f*x)^n] /; FreeQ[{a,b,c,d,e,f,g,h},x] && IGtQ[p,0] && IntegerQ[m] &&  IntegerQ[1/n] *)
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := Module[{k = If[FractionQ[n], Denominator[n], 1]}, k/f^(m + 1)* Subst[Int[ ExpandIntegrand[(a + b*Sin[c + d*x^(k*n)])^p, x^(k - 1)*(f*g - e*h + h*x^k)^m, x], x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[p, 0] && IGtQ[m, 0]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := Module[{k = If[FractionQ[n], Denominator[n], 1]}, k/f^(m + 1)* Subst[Int[ ExpandIntegrand[(a + b*Cos[c + d*x^(k*n)])^p, x^(k - 1)*(f*g - e*h + h*x^k)^m, x], x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[p, 0] && IGtQ[m, 0]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := 1/f*Subst[Int[(h*x/f)^m*(a + b*Sin[c + d*x^n])^p, x], x, e + f*x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && EqQ[f*g - e*h, 0]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := 1/f*Subst[Int[(h*x/f)^m*(a + b*Cos[c + d*x^n])^p, x], x, e + f*x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && EqQ[f*g - e*h, 0]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Sin[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := Unintegrable[(g + h*x)^m*(a + b*Sin[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x]
Int[(g_. + h_.*x_)^m_.*(a_. + b_.*Cos[c_. + d_.*(e_. + f_.*x_)^n_])^ p_., x_Symbol] := Unintegrable[(g + h*x)^m*(a + b*Cos[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x]
Int[v_^m_.*(a_. + b_.*Sin[c_. + d_.*u_^n_])^p_., x_Symbol] := Int[ExpandToSum[v, x]^m*(a + b*Sin[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && LinearQ[u, x] && LinearQ[v, x] && Not[LinearMatchQ[u, x] && LinearMatchQ[v, x]]
Int[v_^m_.*(a_. + b_.*Cos[c_. + d_.*u_^n_])^p_., x_Symbol] := Int[ExpandToSum[v, x]^m*(a + b*Cos[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && LinearQ[u, x] && LinearQ[v, x] && Not[LinearMatchQ[u, x] && LinearMatchQ[v, x]]
Int[x_^m_.*Sin[a_. + b_.*x_^n_.]^p_.*Cos[a_. + b_.*x_^n_.], x_Symbol] := Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1)) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[x_^m_.*Cos[a_. + b_.*x_^n_.]^p_.*Sin[a_. + b_.*x_^n_.], x_Symbol] := -Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1)) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[x_^m_.*Sin[a_. + b_.*x_^n_.]^p_.*Cos[a_. + b_.*x_^n_.], x_Symbol] := x^(m - n + 1)*Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*Sin[a + b*x^n]^(p + 1), x] /; FreeQ[{a, b, p}, x] && LtQ[0, n, m + 1] && NeQ[p, -1]
Int[x_^m_.*Cos[a_. + b_.*x_^n_.]^p_.*Sin[a_. + b_.*x_^n_.], x_Symbol] := -x^(m - n + 1)*Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1)) + (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*Cos[a + b*x^n]^(p + 1), x] /; FreeQ[{a, b, p}, x] && LtQ[0, n, m + 1] && NeQ[p, -1]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.13 (d+e x)^m sin(a+b x+c x^2)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.13 (d+e x)^m sin(a+b x+c x^2)^n *)
Int[Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Int[Sin[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && EqQ[b^2 - 4*a*c, 0]
Int[Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Int[Cos[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && EqQ[b^2 - 4*a*c, 0]
Int[Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Cos[(b^2 - 4*a*c)/(4*c)]*Int[Sin[(b + 2*c*x)^2/(4*c)], x] - Sin[(b^2 - 4*a*c)/(4*c)]*Int[Cos[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Cos[(b^2 - 4*a*c)/(4*c)]*Int[Cos[(b + 2*c*x)^2/(4*c)], x] + Sin[(b^2 - 4*a*c)/(4*c)]*Int[Sin[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[Sin[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[Sin[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 1]
Int[Cos[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[Cos[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 1]
Int[Sin[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[Sin[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Cos[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[Cos[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Sin[v_]^n_., x_Symbol] := Int[Sin[ExpandToSum[v, x]]^n, x] /; IGtQ[n, 0] && QuadraticQ[v, x] && Not[QuadraticMatchQ[v, x]]
Int[Cos[v_]^n_., x_Symbol] := Int[Cos[ExpandToSum[v, x]]^n, x] /; IGtQ[n, 0] && QuadraticQ[v, x] && Not[QuadraticMatchQ[v, x]]
Int[(d_ + e_.*x_)*Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := -e*Cos[a + b*x + c*x^2]/(2*c) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[(d_ + e_.*x_)*Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Sin[a + b*x + c*x^2]/(2*c) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[(d_. + e_.*x_)^m_*Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := -e*(d + e*x)^(m - 1)*Cos[a + b*x + c*x^2]/(2*c) + e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && GtQ[m, 1]
Int[(d_. + e_.*x_)^m_*Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m - 1)*Sin[a + b*x + c*x^2]/(2*c) - e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && GtQ[m, 1]
Int[(d_. + e_.*x_)^m_*Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Sin[a + b*x + c*x^2]/(e*(m + 1)) - 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_*Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Cos[a + b*x + c*x^2]/(e*(m + 1)) + 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)*Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := -e*Cos[a + b*x + c*x^2]/(2*c) + (2*c*d - b*e)/(2*c)*Int[Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[(d_. + e_.*x_)*Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Sin[a + b*x + c*x^2]/(2*c) + (2*c*d - b*e)/(2*c)*Int[Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[(d_. + e_.*x_)^m_*Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := -e*(d + e*x)^(m - 1)*Cos[a + b*x + c*x^2]/(2*c) - (b*e - 2*c*d)/(2*c)* Int[(d + e*x)^(m - 1)*Sin[a + b*x + c*x^2], x] + e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && GtQ[m, 1]
Int[(d_. + e_.*x_)^m_*Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m - 1)*Sin[a + b*x + c*x^2]/(2*c) - (b*e - 2*c*d)/(2*c)* Int[(d + e*x)^(m - 1)*Cos[a + b*x + c*x^2], x] - e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && GtQ[m, 1]
Int[(d_. + e_.*x_)^m_*Sin[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Sin[a + b*x + c*x^2]/(e*(m + 1)) - (b*e - 2*c*d)/(e^2*(m + 1))* Int[(d + e*x)^(m + 1)*Cos[a + b*x + c*x^2], x] - 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_*Cos[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Cos[a + b*x + c*x^2]/(e*(m + 1)) + (b*e - 2*c*d)/(e^2*(m + 1))* Int[(d + e*x)^(m + 1)*Sin[a + b*x + c*x^2], x] + 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && LtQ[m, -1]
Int[(d_. + e_.*x_)^m_.*Sin[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[(d + e*x)^m, Sin[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 1]
Int[(d_. + e_.*x_)^m_.*Cos[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[(d + e*x)^m, Cos[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 1]
Int[(d_. + e_.*x_)^m_.*Sin[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[(d + e*x)^m*Sin[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(d_. + e_.*x_)^m_.*Cos[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[(d + e*x)^m*Cos[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[u_^m_.*Sin[v_]^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*Sin[ExpandToSum[v, x]]^n, x] /; FreeQ[m, x] && IGtQ[n, 0] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]
Int[u_^m_.*Cos[v_]^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*Cos[ExpandToSum[v, x]]^n, x] /; FreeQ[m, x] && IGtQ[n, 0] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.2.1 (a+b sin)^m (c+d sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.2.1 (a+b sin)^m (c+d sin)^n *)
Int[(a_ + b_.*sin[e_. + f_.*x_])*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := (2*a*c + b*d)*x/2 - (b*c + a*d)*Cos[e + f*x]/f - b*d*Cos[e + f*x]*Sin[e + f*x]/(2*f) /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])/(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := b*x/d - (b*c - a*d)/d*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := a^m*c^m*Int[Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && Not[IntegerQ[ n] && (LtQ[m, 0] && GtQ[n, 0] || LtQ[0, n, m] || LtQ[m, n, 0])]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/Sqrt[c_ + d_.*sin[e_. + f_.*x_]], x_Symbol] := a*c*Cos[ e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]])* Int[Cos[e + f*x]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -2*b*Cos[ e + f*x]*(c + d*Sin[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Sin[e + f*x]]) /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[n, -1/2]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -2*b*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^ n/(f*(2*n + 1)) - b*(2*m - 1)/(d*(2*n + 1))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[m - 1/2, 0] && LtQ[n, -1] && Not[ILtQ[m + n, 0] && GtQ[2*m + n + 1, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^ n/(f*(m + n)) + a*(2*m - 1)/(m + n)* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[m - 1/2, 0] && Not[LtQ[n, -1]] && Not[IGtQ[n - 1/2, 0] && LtQ[n, m]] && Not[ILtQ[m + n, 0] && GtQ[2*m + n + 1, 0]]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]])* Int[1/Cos[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*(2*m + 1)) /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && NeQ[m, -1/2]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*(2*m + 1)) + (m + n + 1)/(a*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ILtQ[Simplify[m + n + 1], 0] && NeQ[m, -1/2] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*(2*m + 1)) + (m + n + 1)/(a*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && Not[LtQ[m, n, -1]] && IntegersQ[2*m, 2*n]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^IntPart[m]* c^IntPart[m]*(a + b*Sin[e + f*x])^ FracPart[m]*(c + d*Sin[e + f*x])^FracPart[m]/ Cos[e + f*x]^(2*FracPart[m])* Int[Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (FractionQ[m] || Not[FractionQ[n]])
Int[(a_. + b_.*sin[e_. + f_.*x_])^2/(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -b^2*Cos[e + f*x]/(d*f) + 1/d*Int[Simp[a^2*d - b*(b*c - 2*a*d)*Sin[e + f*x], x]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[1/((a_. + b_.*sin[e_. + f_.*x_])*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := b/(b*c - a*d)*Int[1/(a + b*Sin[e + f*x]), x] - d/(b*c - a*d)*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[(b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_]), x_Symbol] := c*Int[(b*Sin[e + f*x])^m, x] + d/b*Int[(b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{b, c, d, e, f, m}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(f*(m + 1)) /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[a*d*m + b*c*(m + 1), 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(a*f*(2*m + 1)) + (a*d*m + b*c*(m + 1))/(a*b*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(f*(m + 1)) + (a*d*m + b*c*(m + 1))/(b*(m + 1))* Int[(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[(c_. + d_.*sin[e_. + f_.*x_])/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := (b*c - a*d)/b*Int[1/Sqrt[a + b*Sin[e + f*x]], x] + d/b*Int[Sqrt[a + b*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(f*(m + 1)) + 1/(m + 1)* Int[(a + b*Sin[e + f*x])^(m - 1)* Simp[b*d*m + a*c*(m + 1) + (a*d*m + b*c*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && IntegerQ[2*m]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -(b*c - a*d)* Cos[e + f* x]*(a + b*Sin[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[(a*c - b*d)*(m + 1) - (b*c - a*d)*(m + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_]), x_Symbol] := c*Cos[e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]])* Subst[Int[(a + b*x)^m*Sqrt[1 + d/c*x]/Sqrt[1 - d/c*x], x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && Not[IntegerQ[2*m]] && EqQ[c^2 - d^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)/b*Int[(a + b*Sin[e + f*x])^m, x] + d/b*Int[(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandTrig[(a + b*sin[e + f*x])^m*(d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && RationalQ[n]
Int[sin[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(a*f*(2*m + 1)) - 1/(a^2*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(a*m - b*(2*m + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[sin[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m*(b*(m + 1) - a*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^2, x_Symbol] := (b*c - a*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])/(a*f*(2*m + 1)) + 1/(a*b*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*c*d*(m - 1) + b*(d^2 + c^2*(m + 1)) + d*(a*d*(m - 1) + b*c*(m + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^2, x_Symbol] := -d^2*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m* Simp[b*(d^2*(m + 1) + c^2*(m + 2)) - d*(a*d - 2*b*c*(m + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b^2*(b*c - a*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(b*c + a*d)) + b^2/(d*(n + 1)*(b*c + a*d))* Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)* Simp[a*c*(m - 2) - b*d*(m - 2*n - 4) - (b*c*(m - 1) - a*d*(m + 2*n + 1))* Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] && LtQ[n, -1] && (IntegersQ[2*m, 2*n] || IntegerQ[m + 1/2] || IntegerQ[m] && EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b^2*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n)) + 1/(d*(m + n))* Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^n* Simp[a*b*c*(m - 2) + b^2*d*(n + 1) + a^2*d*(m + n) - b*(b*c*(m - 1) - a*d*(3*m + 2*n - 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] && Not[LtQ[n, -1]] && (IntegersQ[2*m, 2*n] || IntegerQ[m + 1/2] || IntegerQ[m] && EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*(2*m + 1)) - 1/(a*b*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)* Simp[a*d*n - b*c*(m + 1) - b*d*(m + n + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && (IntegersQ[2*m, 2*n] || IntegerQ[m] && EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (b*c - a*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n - 1)/(a*f*(2*m + 1)) + 1/(a*b*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 2)* Simp[b*(c^2*(m + 1) + d^2*(n - 1)) + a*c*d*(m - n + 1) + d*(a*d*(m - n + 1) + b*c*(m + n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && GtQ[n, 1] && (IntegersQ[2*m, 2*n] || IntegerQ[m] && EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b^2*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(a*f*(2*m + 1)*(b*c - a*d)) + 1/(a*(2*m + 1)*(b*c - a*d))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[b*c*(m + 1) - a*d*(2*m + n + 2) + b*d*(m + n + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && Not[GtQ[n, 0]] && (IntegersQ[2*m, 2*n] || IntegerQ[m] && EqQ[c, 0])
Int[(c_. + d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := -(b*c - a*d)* Cos[e + f*x]*(c + d*Sin[e + f*x])^(n - 1)/(a* f*(a + b*Sin[e + f*x])) - d/(a*b)* Int[(c + d*Sin[e + f*x])^(n - 2)* Simp[b*d*(n - 1) - a*c*n + (b*c*(n - 1) - a*d*n)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 1] && (IntegerQ[2*n] || EqQ[c, 0])
Int[(c_. + d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := -b^2*Cos[ e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(a* f*(b*c - a*d)*(a + b*Sin[e + f*x])) + d/(a*(b*c - a*d))* Int[(c + d*Sin[e + f*x])^n*(a*n - b*(n + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, 0] && (IntegerQ[2*n] || EqQ[c, 0])
Int[(c_. + d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := -b*Cos[e + f*x]*(c + d*Sin[e + f*x])^n/(a*f*(a + b*Sin[e + f*x])) + d*n/(a*b)* Int[(c + d*Sin[e + f*x])^(n - 1)*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && (IntegerQ[2*n] || EqQ[c, 0])
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -2*b*Cos[ e + f*x]*(c + d*Sin[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Sin[e + f*x]]) + 2*n*(b*c + a*d)/(b*(2*n + 1))* Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 0] && IntegerQ[2*n]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(c_. + d_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := -2*b^2* Cos[e + f*x]/(f*(b*c + a*d)*Sqrt[a + b*Sin[e + f*x]]* Sqrt[c + d*Sin[e + f*x]]) /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (b*c - a*d)* Cos[e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2)* Sqrt[a + b*Sin[e + f*x]]) + (2*n + 3)*(b*c - a*d)/(2*b*(n + 1)*(c^2 - d^2))* Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1] && NeQ[2*n + 3, 0] && IntegerQ[2*n]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -2*b/f* Subst[Int[1/(b*c + a*d - d*x^2), x], x, b*Cos[e + f*x]/Sqrt[a + b*Sin[e + f*x]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/Sqrt[d_.*sin[e_. + f_.*x_]], x_Symbol] := -2/f*Subst[Int[1/Sqrt[1 - x^2/a], x], x, b*Cos[e + f*x]/Sqrt[a + b*Sin[e + f*x]]] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[d, a/b]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/ Sqrt[c_. + d_.*sin[e_. + f_.*x_]], x_Symbol] := -2*b/f* Subst[Int[1/(b + d*x^2), x], x, b*Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]* Sqrt[c + d*Sin[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^2*Cos[ e + f*x]/(f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]])* Subst[Int[(c + d*x)^n/Sqrt[a - b*x], x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[IntegerQ[2*n]]
Int[Sqrt[c_. + d_.*sin[e_. + f_.*x_]]/ Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := d/b*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + (b*c - a*d)/b* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(c_. + d_.*sin[e_. + f_.*x_])^n_/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := -2*d*Cos[ e + f*x]*(c + d*Sin[e + f*x])^(n - 1)/(f*(2*n - 1)* Sqrt[a + b*Sin[e + f*x]]) - 1/(b*(2*n - 1))* Int[(c + d*Sin[e + f*x])^(n - 2)/Sqrt[a + b*Sin[e + f*x]]* Simp[a*c*d - b*(2*d^2*(n - 1) + c^2*(2*n - 1)) + d*(a*d - b*c*(4*n - 3))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[(c_. + d_.*sin[e_. + f_.*x_])^n_/Sqrt[a_ + b_.*sin[e_. + f_.*x_]], x_Symbol] := -d*Cos[ e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2)* Sqrt[a + b*Sin[e + f*x]]) - 1/(2*b*(n + 1)*(c^2 - d^2))* Int[(c + d*Sin[e + f*x])^(n + 1)* Simp[a*d - 2*b*c*(n + 1) + b*d*(2*n + 3)*Sin[e + f*x], x]/ Sqrt[a + b*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[1/(Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := b/(b*c - a*d)*Int[1/Sqrt[a + b*Sin[e + f*x]], x] - d/(b*c - a*d)* Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := -Sqrt[2]/(Sqrt[a]*f)* Subst[Int[1/Sqrt[1 - x^2], x], x, b*Cos[e + f*x]/(a + b*Sin[e + f*x])] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[d, a/b] && GtQ[a, 0]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*a/f* Subst[Int[1/(2*b^2 - (a*c - b*d)*x^2), x], x, b*Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]* Sqrt[c + d*Sin[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -d*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n - 1)/(f*(m + n)) + 1/(b*(m + n))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n - 2)* Simp[d*(a*c*m + b*d*(n - 1)) + b*c^2*(m + n) + d*(a*d*m + b*c*(m + 2*n - 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 1] && IntegerQ[n]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := a^m*Cos[e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]])* Subst[Int[(1 + b/a*x)^(m - 1/2)*(c + d*x)^n/Sqrt[1 - b/a*x], x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && IntegerQ[m]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*(d/b)^n* Cos[e + f*x]/(f*Sqrt[a + b*Sin[e + f*x]]* Sqrt[a - b*Sin[e + f*x]])* Subst[Int[(a - x)^n*(2*a - x)^(m - 1/2)/Sqrt[x], x], x, a - b*Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && GtQ[a, 0] && GtQ[d/b, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := (d/b)^ IntPart[n]*(d*Sin[e + f*x])^FracPart[n]/(b*Sin[e + f*x])^ FracPart[n]*Int[(a + b*Sin[e + f*x])^m*(b*Sin[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && GtQ[a, 0] && Not[GtQ[d/b, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := a^IntPart[m]*(a + b*Sin[e + f*x])^ FracPart[m]/(1 + b/a*Sin[e + f*x])^FracPart[m]* Int[(1 + b/a*Sin[e + f*x])^m*(d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && Not[GtQ[a, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := a^2*Cos[ e + f*x]/(f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]])* Subst[Int[(a + b*x)^(m - 1/2)*(c + d*x)^n/Sqrt[a - b*x], x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^2, x_Symbol] := 2*c*d/b*Int[(b*Sin[e + f*x])^(m + 1), x] + Int[(b*Sin[e + f*x])^m*(c^2 + d^2*Sin[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, m}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^2, x_Symbol] := -(b^2*c^2 - 2*a*b*c*d + a^2*d^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) - 1/(b*(m + 1)*(a^2 - b^2))*Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*(m + 1)*(2*b*c*d - a*(c^2 + d^2)) + (a^2*d^2 - 2*a*b*c*d*(m + 2) + b^2*(d^2*(m + 1) + c^2*(m + 2)))* Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^2, x_Symbol] := -d^2*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m* Simp[b*(d^2*(m + 1) + c^2*(m + 2)) - d*(a*d - 2*b*c*(m + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
(* Int[(a_+b_.*sin[e_.+f_.*x_])^m_.*(d_.*sin[e_.+f_.*x_])^n_.,x_ Symbol] := Int[ExpandTrig[(a+b*sin[e+f*x])^m*(d*sin[e+f*x])^n,x],x] /; FreeQ[{a,b,d,e,f,n},x] && NeQ[a^2-b^2,0] && IGtQ[m,0] *)
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -(b^2*c^2 - 2*a*b*c*d + a^2*d^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2)) + 1/(d*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^(m - 3)*(c + d*Sin[e + f*x])^(n + 1)* Simp[b*(m - 2)*(b*c - a*d)^2 + a*d*(n + 1)*(c*(a^2 + b^2) - 2*a*b*d) + (b*(n + 1)*(a*b*c^2 + c*d*(a^2 + b^2) - 3*a*b*d^2) - a*(n + 2)*(b*c - a*d)^2)*Sin[e + f*x] + b*(b^2*(c^2 - d^2) - m*(b*c - a*d)^2 + d*n*(2*a*b*c - d*(a^2 + b^2)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 2] && LtQ[n, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b^2*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n)) + 1/(d*(m + n))* Int[(a + b*Sin[e + f*x])^(m - 3)*(c + d*Sin[e + f*x])^n* Simp[a^3*d*(m + n) + b^2*(b*c*(m - 2) + a*d*(n + 1)) - b*(a*b*c - b^2*d*(m + n - 1) - 3*a^2*d*(m + n))* Sin[e + f*x] - b^2*(b*c*(m - 1) - a*d*(3*m + 2*n - 2))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 2] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) && Not[IGtQ[n, 2] && (Not[IntegerQ[m]] || EqQ[a, 0] && NeQ[c, 0])]
Int[Sqrt[d_.*sin[e_. + f_.*x_]]/(a_ + b_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := -2*a*d* Cos[e + f*x]/(f*(a^2 - b^2)*Sqrt[a + b*Sin[e + f*x]]* Sqrt[d*Sin[e + f*x]]) - d^2/(a^2 - b^2)* Int[Sqrt[a + b*Sin[e + f*x]]/(d*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[ c_ + d_.*sin[e_. + f_.*x_]]/(a_. + b_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := (c - d)/(a - b)* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] - (b*c - a*d)/(a - b)* Int[(1 + Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^ n/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)* Simp[a*c*(m + 1) + b*d*n + (a*d*(m + 1) - b*c*(m + 2))*Sin[e + f*x] - b*d*(m + n + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && IntegersQ[2*m, 2*n]
Int[(d_.*sin[e_. + f_.*x_])^(3/2)/(a_ + b_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := d/b*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] - a*d/b*Int[Sqrt[d*Sin[e + f*x]]/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(c_ + d_.*sin[e_. + f_.*x_])^(3/2)/(a_. + b_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := d^2/b^2*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + (b*c - a*d)/b^2* Int[Simp[b*c + a*d + 2*b*d*Sin[e + f*x], x]/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -(b*c - a*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 2)* Simp[c*(a*c - b*d)*(m + 1) + d*(b*c - a*d)*(n - 1) + (d*(a*c - b*d)*(m + 1) - c*(b*c - a*d)*(m + 2))*Sin[e + f*x] - d*(b*c - a*d)*(m + n + 1)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && IntegersQ[2*m, 2*n]
Int[1/((a_ + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := 2*b*Cos[ e + f*x]/(f*(a^2 - b^2)*Sqrt[a + b*Sin[e + f*x]]* Sqrt[d*Sin[e + f*x]]) + d/(a^2 - b^2)* Int[(b + a*Sin[e + f*x])/(Sqrt[ a + b*Sin[e + f*x]]*(d*Sin[e + f*x])^(3/2)), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[1/((a_. + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := 1/(a - b)* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] - b/(a - b)* Int[(1 + Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b^2*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[a*(b*c - a*d)*(m + 1) + b^2*d*(m + n + 2) - (b^2*c + b*(b*c - a*d)*(m + 1))* Sin[e + f*x] - b^2*d*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*n] && (EqQ[a, 0] && IntegerQ[m] && Not[IntegerQ[n]] || Not[IntegerQ[2*n] && LtQ[n, -1] && (IntegerQ[n] && Not[IntegerQ[m]] || EqQ[a, 0])])
Int[Sqrt[c_. + d_.*sin[e_. + f_.*x_]]/(a_. + b_.*sin[e_. + f_.*x_]), x_Symbol] := d/b*Int[1/Sqrt[c + d*Sin[e + f*x]], x] + (b*c - a*d)/b* Int[1/((a + b*Sin[e + f*x])*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^(3/2)/(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := b/d*Int[Sqrt[a + b*Sin[e + f*x]], x] - (b*c - a*d)/d* Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/((a_. + b_.*sin[e_. + f_.*x_])* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := 2/(f*(a + b)*Sqrt[c + d])* EllipticPi[2*b/(a + b), 1/2*(e - Pi/2 + f*x), 2*d/(c + d)] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[c + d, 0]
Int[1/((a_. + b_.*sin[e_. + f_.*x_])* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := 2/(f*(a - b)*Sqrt[c - d])* EllipticPi[-2*b/(a - b), 1/2*(e + Pi/2 + f*x), -2*d/(c - d)] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[c - d, 0]
Int[1/((a_. + b_.*sin[e_. + f_.*x_])* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := Sqrt[(c + d*Sin[e + f*x])/(c + d)]/Sqrt[c + d*Sin[e + f*x]]* Int[1/((a + b*Sin[e + f*x])* Sqrt[c/(c + d) + d/(c + d)*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[GtQ[c + d, 0]]
Int[Sqrt[b_.*sin[e_. + f_.*x_]]/Sqrt[c_ + d_.*sin[e_. + f_.*x_]], x_Symbol] := 2*c*Rt[b*(c + d), 2]*Tan[e + f*x]*Sqrt[1 + Csc[e + f*x]]* Sqrt[1 - Csc[e + f*x]]/(d*f*Sqrt[c^2 - d^2])* EllipticPi[(c + d)/d, ArcSin[Sqrt[c + d*Sin[e + f*x]]/Sqrt[b*Sin[e + f*x]]/ Rt[(c + d)/b, 2]], -(c + d)/(c - d)] /; FreeQ[{b, c, d, e, f}, x] && GtQ[c^2 - d^2, 0] && PosQ[(c + d)/b] && GtQ[c^2, 0]
Int[Sqrt[b_.*sin[e_. + f_.*x_]]/Sqrt[c_ + d_.*sin[e_. + f_.*x_]], x_Symbol] := 2*b*Tan[e + f*x]/(d*f)*Rt[(c + d)/b, 2]* Sqrt[c*(1 + Csc[e + f*x])/(c - d)]* Sqrt[c*(1 - Csc[e + f*x])/(c + d)]* EllipticPi[(c + d)/d, ArcSin[Sqrt[c + d*Sin[e + f*x]]/Sqrt[b*Sin[e + f*x]]/ Rt[(c + d)/b, 2]], -(c + d)/(c - d)] /; FreeQ[{b, c, d, e, f}, x] && NeQ[c^2 - d^2, 0] && PosQ[(c + d)/b]
Int[Sqrt[b_.*sin[e_. + f_.*x_]]/Sqrt[c_ + d_.*sin[e_. + f_.*x_]], x_Symbol] := Sqrt[b*Sin[e + f*x]]/Sqrt[-b*Sin[e + f*x]]* Int[Sqrt[-b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{b, c, d, e, f}, x] && NeQ[c^2 - d^2, 0] && NegQ[(c + d)/b]
(* Int[Sqrt[a_+b_.*sin[e_.+f_.*x_]]/Sqrt[d_.*sin[e_.+f_.*x_]],x_ Symbol] := a*Int[1/(Sqrt[a+b*Sin[e+f*x]]*Sqrt[d*Sin[e+f*x]]),x] + b/d*Int[Sqrt[d*Sin[e+f*x]]/Sqrt[a+b*Sin[e+f*x]],x] /; FreeQ[{a,b,d,e,f},x] && NeQ[a^2-b^2,0] *)
(* Int[Sqrt[a_+b_.*sin[e_.+f_.*x_]]/Sqrt[d_.*sin[e_.+f_.*x_]],x_ Symbol] := 2*(a+b*Sin[e+f*x])/(d*f*Rt[(a+b)/d,2]*Cos[e+f*x])*Sqrt[a*(1-Sin[e+f* x])/(a+b*Sin[e+f*x])]*Sqrt[a*(1+Sin[e+f*x])/(a+b*Sin[e+f*x])]* EllipticPi[b/(a+b),ArcSin[Rt[(a+b)/d,2]*(Sqrt[d*Sin[e+f*x]]/Sqrt[ a+b*Sin[e+f*x]])],-(a-b)/(a+b)] /; FreeQ[{a,b,d,e,f},x] && NeQ[a^2-b^2,0] && PosQ[(a+b)/d] *)
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/ Sqrt[c_. + d_.*sin[e_. + f_.*x_]], x_Symbol] := 2*(a + b*Sin[e + f*x])/(d*f*Rt[(a + b)/(c + d), 2]*Cos[e + f*x])* Sqrt[(b*c - a*d)*(1 + Sin[e + f*x])/((c - d)*(a + b*Sin[e + f*x]))]* Sqrt[-(b*c - a*d)*(1 - Sin[e + f*x])/((c + d)*(a + b*Sin[e + f*x]))]* EllipticPi[b*(c + d)/(d*(a + b)), ArcSin[Rt[(a + b)/(c + d), 2]* Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]]], (a - b)*(c + d)/((a + b)*(c - d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && PosQ[(a + b)/(c + d)]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/ Sqrt[c_. + d_.*sin[e_. + f_.*x_]], x_Symbol] := Sqrt[-c - d*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]]* Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[-c - d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NegQ[(a + b)/(c + d)]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*d/(f*Sqrt[a + b*d])* EllipticF[ ArcSin[Cos[e + f*x]/(1 + d*Sin[e + f*x])], -(a - b*d)/(a + b*d)] /; FreeQ[{a, b, d, e, f}, x] && LtQ[a^2 - b^2, 0] && EqQ[d^2, 1] && GtQ[b*d, 0]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := Sqrt[Sign[b]*Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]]* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[Sign[b]*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && LtQ[a^2 - b^2, 0] && GtQ[b^2, 0] && Not[EqQ[d^2, 1] && GtQ[b*d, 0]]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*Sqrt[a^2]* Sqrt[-Cot[e + f*x]^2]/(a*f*Sqrt[a^2 - b^2]*Cot[e + f*x])* Rt[(a + b)/d, 2]* EllipticF[ ArcSin[Sqrt[a + b*Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]]/ Rt[(a + b)/d, 2]], -(a + b)/(a - b)] /; FreeQ[{a, b, d, e, f}, x] && GtQ[a^2 - b^2, 0] && PosQ[(a + b)/d] && GtQ[a^2, 0]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*Tan[e + f*x]/(a*f)*Rt[(a + b)/d, 2]* Sqrt[a*(1 - Csc[e + f*x])/(a + b)]* Sqrt[a*(1 + Csc[e + f*x])/(a - b)]* EllipticF[ ArcSin[Sqrt[a + b*Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]]/ Rt[(a + b)/d, 2]], -(a + b)/(a - b)] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && PosQ[(a + b)/d]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := Sqrt[-d*Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]]* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[-d*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && NegQ[(a + b)/d]
Int[1/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := 2*(c + d*Sin[e + f*x])/(f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]* Cos[e + f*x])* Sqrt[(b*c - a*d)*(1 - Sin[e + f*x])/((a + b)*(c + d*Sin[e + f*x]))]* Sqrt[-(b*c - a*d)*(1 + Sin[e + f*x])/((a - b)*(c + d*Sin[e + f*x]))]* EllipticF[ ArcSin[Rt[(c + d)/(a + b), 2]*(Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]])], (a + b)*(c - d)/((a - b)*(c + d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && PosQ[(c + d)/(a + b)]
Int[1/(Sqrt[a_. + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := Sqrt[-a - b*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]]* Int[1/(Sqrt[-a - b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NegQ[(c + d)/(a + b)]
Int[(d_.*sin[e_. + f_.*x_])^(3/2)/Sqrt[a_. + b_.*sin[e_. + f_.*x_]], x_Symbol] := -a*d/(2*b)* Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + d/(2*b)* Int[Sqrt[d*Sin[e + f*x]]*(a + 2*b*Sin[e + f*x])/ Sqrt[a + b*Sin[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^ n/(f*(m + n)) + 1/(d*(m + n))* Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n - 1)* Simp[a^2*c*d*(m + n) + b*d*(b*c*(m - 1) + a*d*n) + (a*d*(2*b*c + a*d)*(m + n) - b*d*(a*c - b*d*(m + n - 1)))*Sin[e + f*x] + b*d*(b*c*n + a*d*(2*m + n - 1))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[0, m, 2] && LtQ[-1, n, 2] && NeQ[m + n, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b/d*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] - (b*c - a*d)/d* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[m, 0]
Int[(d_.*sin[e_. + f_.*x_])^n_./(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := a*Int[(d*Sin[e + f*x])^n/(a^2 - b^2*Sin[e + f*x]^2), x] - b/d*Int[(d*Sin[e + f*x])^(n + 1)/(a^2 - b^2*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^ n*(a - b*sin[e + f*x])^(-m)/(a^2 - b^2*sin[e + f*x]^2)^(-m), x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
(* Int[(a_.+b_.*sin[e_.+f_.*x_])^m_.*(d_./sin[e_.+f_.*x_])^n_,x_ Symbol] := d^m*Int[(d*Csc[e+f*x])^(n-m)*(b+a*Csc[e+f*x])^m,x] /; FreeQ[{a,b,d,e,f,n},x] && Not[IntegerQ[n]] && IntegerQ[m] *)
(* Int[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(d_./cos[e_.+f_.*x_])^n_,x_ Symbol] := d^m*Int[(d*Sec[e+f*x])^(n-m)*(b+a*Sec[e+f*x])^m,x] /; FreeQ[{a,b,d,e,f,n},x] && Not[IntegerQ[n]] && IntegerQ[m] *)
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_.*(d_.*sin[e_. + f_.*x_])^p_)^n_, x_Symbol] := c^IntPart[n]*(c*(d*Sin[e + f*x])^p)^ FracPart[n]/(d*Sin[e + f*x])^(p*FracPart[n])* Int[(a + b*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]]
Int[(a_. + b_.*cos[e_. + f_.*x_])^ m_.*(c_.*(d_.*cos[e_. + f_.*x_])^p_)^n_, x_Symbol] := c^IntPart[n]*(c*(d*Cos[e + f*x])^p)^ FracPart[n]/(d*Cos[e + f*x])^(p*FracPart[n])* Int[(a + b*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Int[(a + b*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/Sin[e + f*x]^n, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[n]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Int[(b + a*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n/Csc[e + f*x]^m, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_ + b_.*cos[e_. + f_.*x_])^m_.*(c_ + d_.*sec[e_. + f_.*x_])^n_, x_Symbol] := Int[(b + a*Sec[e + f*x])^m*(c + d*Sec[e + f*x])^n/Sec[e + f*x]^m, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Sin[e + f*x]^n*(c + d*Csc[e + f*x])^n/(d + c*Sin[e + f*x])^n* Int[(a + b*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/Sin[e + f*x]^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]
Int[(a_ + b_.*cos[e_. + f_.*x_])^m_*(c_ + d_.*sec[e_. + f_.*x_])^n_, x_Symbol] := Cos[e + f*x]^n*(c + d*Sec[e + f*x])^n/(d + c*Cos[e + f*x])^n* Int[(a + b*Cos[e + f*x])^m*(d + c*Cos[e + f*x])^n/Cos[e + f*x]^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.2.2 (g cos)^p (a+b sin)^m (c+d sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.2.2 (g cos)^p (a+b sin)^m (c+d sin)^n *)
Int[cos[e_. + f_.*x_]*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := 1/(b*f)*Subst[Int[(a + x)^m*(c + d/b*x)^n, x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[cos[e_. + f_.*x_]^p_*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := a*Int[Cos[e + f*x]^p*(d*Sin[e + f*x])^n, x] + b/d*Int[Cos[e + f*x]^p*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(p - 1)/2] && IntegerQ[ n] && (LtQ[p, 0] && NeQ[a^2 - b^2, 0] || LtQ[0, n, p - 1] || LtQ[p + 1, -n, 2*p + 1])
Int[cos[e_. + f_.*x_]^ p_*(d_.*sin[e_. + f_.*x_])^n_./(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := 1/a*Int[Cos[e + f*x]^(p - 2)*(d*Sin[e + f*x])^n, x] - 1/(b*d)*Int[Cos[e + f*x]^(p - 2)*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0] && IntegerQ[ n] && (LtQ[0, n, (p + 1)/2] || LeQ[p, -n] && LtQ[-n, 2*p - 3] || GtQ[n, 0] && LeQ[n, -p])
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := 1/(b^p*f)* Subst[Int[(a + x)^(m + (p - 1)/2)*(a - x)^((p - 1)/2)*(c + d/b*x)^ n, x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, c, d, m, n}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0]
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := 1/(b^p*f)* Subst[Int[(a + x)^m*(c + d/b*x)^n*(b^2 - x^2)^((p - 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IntegerQ[(p - 1)/2] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := a*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n, x] + b/d*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x]
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_./(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := g^2/a*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n, x] - g^2/(b*d)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := a^m*c^m/g^(2*m)* Int[(g*Cos[e + f*x])^(2*m + p)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && Not[IntegerQ[n] && LtQ[n^2, m^2]]
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := 1/(a^(p/2)*c^(p/2))* Int[(a + b*Sin[e + f*x])^(m + p/2)*(c + d*Sin[e + f*x])^(n + p/2), x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2]
Int[(g_.*cos[e_. + f_.*x_])^ p_/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := g*Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]])* Int[(g*Cos[e + f*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^IntPart[m]* c^IntPart[m]*(a + b*Sin[e + f*x])^ FracPart[m]*(c + d*Sin[e + f*x])^FracPart[m]/ (g^(2*IntPart[m])*(g*Cos[e + f*x])^(2*FracPart[m]))* Int[(g*Cos[e + f*x])^(2*m + p)/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p - 1, 0] && EqQ[m - n - 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n/(f*g*(m - n - 1)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p - 1, 0] && NeQ[m - n - 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n/(f*g*(2*n + p + 1)) - b*(2*m + p - 1)/(d*(2*n + p + 1))* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[m + p/2 - 1/2], 0] && LtQ[n, -1] && NeQ[2*n + p + 1, 0] && Not[ILtQ[Simplify[m + n + p], 0] && GtQ[Simplify[2*m + n + 3*p/2 + 1], 0]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n/(f*g*(m + n + p)) + a*(2*m + p - 1)/(m + n + p)* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[m + p/2 - 1/2], 0] && Not[LtQ[n, -1]] && Not[IGtQ[Simplify[n + p/2 - 1/2], 0] && GtQ[m - n, 0]] && Not[ILtQ[Simplify[m + n + p], 0] && GtQ[Simplify[2*m + n + 3*p/2 + 1], 0]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^m_, x_Symbol] := a^IntPart[m]* c^IntPart[m]*(a + b*Sin[e + f*x])^ FracPart[m]*(c + d*Sin[e + f*x])^FracPart[m]/ (g^(2*IntPart[m])*(g*Cos[e + f*x])^(2*FracPart[m]))* Int[(g*Cos[e + f*x])^(2*m + p), x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p + 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*g*(m - n)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + p + 1, 0] && NeQ[m, n]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*g*(2*m + p + 1)) + (m + n + p + 1)/(a*(2*m + p + 1))* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ILtQ[Simplify[m + n + p + 1], 0] && NeQ[2*m + p + 1, 0] && (SumSimplerQ[m, 1] || Not[SumSimplerQ[n, 1]])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n/(f*g*(2*n + p + 1)) - b*(2*m + p - 1)/(d*(2*n + p + 1))* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && LtQ[n, -1] && NeQ[2*n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := -b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n/(f*g*(m + n + p)) + a*(2*m + p - 1)/(m + n + p)* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && NeQ[m + n + p, 0] && Not[LtQ[0, n, m]] && IntegersQ[2*m, 2*n, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*g*(2*m + p + 1)) + (m + n + p + 1)/(a*(2*m + p + 1))* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && NeQ[2*m + p + 1, 0] && Not[LtQ[m, n, -1]] && IntegersQ[2*m, 2*n, 2*p]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^IntPart[m]* c^IntPart[m]*(a + b*Sin[e + f*x])^ FracPart[m]*(c + d*Sin[e + f*x])^FracPart[m]/ (g^(2*IntPart[m])*(g*Cos[e + f*x])^(2*FracPart[m]))* Int[(g*Cos[e + f*x])^(2*m + p)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (FractionQ[m] || Not[FractionQ[n]])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(f*g*(m + p + 1)) /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[a*d*m + b*c*(m + p + 1), 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -(b*c + a*d)*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(a*f*g*(p + 1)) + b*(a*d*m + b*c*(m + p + 1))/(a*g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, -1] && LtQ[p, -1]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(f*g*(m + p + 1)) + (a*d*m + b*c*(m + p + 1))/(b*(m + p + 1))* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[(2*m + p + 1)/2], 0] && NeQ[m + p + 1, 0]
Int[cos[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := 2*(b*c - a*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b^2*f*(2*m + 3)) + 1/(b^3*(2*m + 3))* Int[(a + b*Sin[e + f*x])^(m + 2)*(b*c + 2*a*d*(m + 1) - b*d*(2*m + 3)*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -3/2]
Int[cos[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := d*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 2)/(b^2*f*(m + 3)) - 1/(b^2*(m + 3))* Int[(a + b*Sin[e + f*x])^(m + 1)*(b*d*(m + 2) - a*c*(m + 3) + (b*c*(m + 3) - a*d*(m + 4))*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GeQ[m, -3/2] && LtQ[m, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(a*f*g*(2*m + p + 1)) + (a*d*m + b*c*(m + p + 1))/(a*b*(2*m + p + 1))* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && (LtQ[m, -1] || ILtQ[Simplify[m + p], 0]) && NeQ[2*m + p + 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(f*g*(m + p + 1)) + (a*d*m + b*c*(m + p + 1))/(b*(m + p + 1))* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && NeQ[m + p + 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m*(d + c*Sin[e + f*x])/(f*g*(p + 1)) + 1/(g^2*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1)* Simp[a*c*(p + 2) + b*d*m + b*c*(m + p + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && LtQ[p, -1] && IntegerQ[2*m] && Not[EqQ[m, 1] && NeQ[c^2 - d^2, 0] && SimplerQ[c + d*x, a + b*x]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -d*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(f*g*(m + p + 1)) + 1/(m + p + 1)* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1)* Simp[a*c*(m + p + 1) + b*d*m + (a*d*m + b*c*(m + p + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && Not[LtQ[p, -1]] && IntegerQ[2*m] && Not[EqQ[m, 1] && NeQ[c^2 - d^2, 0] && SimplerQ[c + d*x, a + b*x]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)*(b*c*(m + p + 1) - a*d*p + b*d*(m + 1)*Sin[e + f*x])/(b^2* f*(m + 1)*(m + p + 1)) + g^2*(p - 1)/(b^2*(m + 1)*(m + p + 1))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1)* Simp[b*d*(m + 1) + (b*c*(m + p + 1) - a*d*p)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[p, 1] && NeQ[m + p + 1, 0] && IntegerQ[2*m]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := -(b*c - a*d)*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)/(f*g*(a^2 - b^2)*(m + 1)) + 1/((a^2 - b^2)*(m + 1))* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1)* Simp[(a*c - b*d)*(m + 1) - (b*c - a*d)*(m + p + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)*(b*c*(m + p + 1) - a*d*p + b*d*(m + p)*Sin[e + f*x])/(b^2* f*(m + p)*(m + p + 1)) + g^2*(p - 1)/(b^2*(m + p)*(m + p + 1))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^m* Simp[b*(a*d*m + b*c*(m + p + 1)) + (a*b*c*(m + p + 1) - d*(a^2*p - b^2*(m + p)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[p, 1] && NeQ[m + p, 0] && NeQ[m + p + 1, 0] && IntegerQ[2*m]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := (g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)*(b*c - a*d - (a*c - b*d)*Sin[e + f*x])/(f*g*(a^2 - b^2)*(p + 1)) + 1/(g^2*(a^2 - b^2)*(p + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m* Simp[c*(a^2*(p + 2) - b^2*(m + p + 2)) + a*b*d*m + b*(a*c - b*d)*(m + p + 3)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && LtQ[p, -1] && IntegerQ[2*m]
Int[(g_.*cos[e_. + f_.*x_])^ p_*(c_. + d_.*sin[e_. + f_.*x_])/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := d/b*Int[(g*Cos[e + f*x])^p, x] + (b*c - a*d)/b* Int[(g*Cos[e + f*x])^p/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_]), x_Symbol] := c*g*(g*Cos[e + f*x])^(p - 1)/(f*(1 + Sin[e + f*x])^((p - 1)/2)*(1 - Sin[e + f*x])^((p - 1)/2))* Subst[ Int[(1 + d/c*x)^((p + 1)/2)*(1 - d/c*x)^((p - 1)/2)*(a + b*x)^m, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^(2*m)*Int[(d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p] && EqQ[2*m + p, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_* sin[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)/(2*b*f* g*(m + 1)) + a/(2*g^2)* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[m - p, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_* sin[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^m/(a*f*g*m) - 1/g^2*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + p + 1, 0]
Int[cos[e_. + f_.*x_]^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := 1/a^p* Int[ExpandTrig[(d*sin[e + f*x])^ n*(a - b*sin[e + f*x])^(p/2)*(a + b*sin[e + f*x])^(m + p/2), x], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n, p/2] && (GtQ[m, 0] && GtQ[p, 0] && LtQ[-m - p, n, -1] || GtQ[m, 2] && LtQ[p, 0] && GtQ[m + p/2, 0])
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^ p, (d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m, x], x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[cos[e_. + f_.*x_]^2*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := 1/b^2* Int[(d*Sin[e + f*x])^ n*(a + b*Sin[e + f*x])^(m + 1)*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && (ILtQ[m, 0] || Not[IGtQ[n, 0]])
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (a/g)^(2*m)* Int[(g*Cos[e + f*x])^(2*m + p)*(d*Sin[e + f*x])^ n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && ILtQ[m, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (a/g)^(2*m)* Int[(g*Cos[e + f*x])^(2*m + p)*(d*Sin[e + f*x])^ n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, g, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && RationalQ[p] && (EqQ[2*m + p, 0] || GtQ[2*m + p, 0] && LtQ[p, -1])
Int[(g_.*cos[e_. + f_.*x_])^p_* sin[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^ m/(a*f*g*(2*m + p + 1)) - 1/(a^2*(2*m + p + 1))* Int[(g*Cos[e + f*x])^ p*(a + b*Sin[e + f*x])^(m + 1)*(a*m - b*(2*m + p + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && LeQ[m, -1/2] && NeQ[2*m + p + 1, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_* sin[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)/(b*f* g*(m + p + 2)) + 1/(b*(m + p + 2))* Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^ m*(b*(m + 1) - a*(p + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && NeQ[m + p + 2, 0]
Int[cos[e_. + f_.*x_]^2*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := 1/b^2* Int[(d*Sin[e + f*x])^ n*(a + b*Sin[e + f*x])^(m + 1)*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n]
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := -2/(a*b*d)* Int[(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 2), x] + 1/a^2* Int[(d*Sin[e + f*x])^ n*(a + b*Sin[e + f*x])^(m + 2)*(1 + Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := 1/d^4*Int[(d*Sin[e + f*x])^(n + 4)*(a + b*Sin[e + f*x])^m, x] + Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^ m*(1 - 2*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IGtQ[m, 0]]
Int[cos[e_. + f_.*x_]^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := a^m*Cos[ e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]])* Subst[ Int[(d*x)^n*(1 + b/a*x)^(m + (p - 1)/2)*(1 - b/a*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] && IntegerQ[m]
Int[cos[e_. + f_.*x_]^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Cos[e + f*x]/(a^(p - 2)*f*Sqrt[a + b*Sin[e + f*x]]* Sqrt[a - b*Sin[e + f*x]])* Subst[ Int[(d*x)^n (a + b*x)^(m + p/2 - 1/2)*(a - b*x)^(p/2 - 1/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] && Not[IntegerQ[m]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^ p, (d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m, x], x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && (IntegerQ[p] || IGtQ[n, 0])
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := a^m*g*(g*Cos[e + f*x])^(p - 1)/(f*(1 + Sin[e + f*x])^((p - 1)/2)*(1 - Sin[e + f*x])^((p - 1)/2))* Subst[ Int[(d*x)^n*(1 + b/a*x)^(m + (p - 1)/2)*(1 - b/a*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, n, p}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m]
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)/(f*(a + b*Sin[e + f*x])^((p - 1)/2)*(a - b*Sin[e + f*x])^((p - 1)/2))* Subst[ Int[(d*x)^n*(a + b*x)^(m + (p - 1)/2)*(a - b*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n, p}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_/ Sqrt[d_.*sin[e_. + f_.*x_]], x_Symbol] := -g*(g*Cos[e + f*x])^(p - 1)* Sqrt[d*Sin[e + f*x]]*(a + b*Sin[e + f*x])^(m + 1)/(a*d* f*(m + 1)) + g^2*(2*m + 3)/(2*a*(m + 1))* Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1)/ Sqrt[d*Sin[e + f*x]], x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && EqQ[m + p + 1/2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^m_/ Sqrt[d_.*sin[e_. + f_.*x_]], x_Symbol] := 2*(g*Cos[e + f*x])^(p + 1)* Sqrt[d*Sin[e + f*x]]*(a + b*Sin[e + f*x])^m/(d*f*g*(2*m + 1)) + 2*a*m/(g^2*(2*m + 1))* Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1)/ Sqrt[d*Sin[e + f*x]], x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && EqQ[m + p + 3/2, 0]
Int[cos[e_. + f_.*x_]^2*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^m*(1 - Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n])
(* Int[cos[e_.+f_.*x_]^4*sin[e_.+f_.*x_]^n_*(a_+b_.*sin[e_.+f_.*x_])^ m_,x_Symbol] := (a^2-b^2)*Cos[e+f*x]*Sin[e+f*x]^(n+1)*(a+b*Sin[e+f*x])^(m+1)/(a*b^2* d*(m+1)) - (a^2*(n+1)-b^2*(m+n+2))*Cos[e+f*x]*Sin[e+f*x]^(n+1)*(a+b*Sin[e+f*x]) ^(m+2)/(a^2*b^2*d*(n+1)*(m+1)) + 1/(a^2*b*(n+1)*(m+1))*Int[Sin[e+f*x]^(n+1)*(a+b*Sin[e+f*x])^(m+1)* Simp[a^2*(n+1)*(n+2)-b^2*(m+n+2)*(m+n+3)+a*b*(m+1)*Sin[e+f*x]-(a^ 2*(n+1)*(n+3)-b^2*(m+n+2)*(m+n+4))*Sin[e+f*x]^2,x],x] /; FreeQ[{a,b,d,e,f},x] && NeQ[a^2-b^2,0] && IntegersQ[2*m,2*n] &&  LtQ[m,-1] && LtQ[n,-1] *)
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Cos[e + f*x]*(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1)/(a*d* f*(n + 1)) - (a^2*(n + 1) - b^2*(m + n + 2))* Cos[e + f*x]*(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^(m + 1)/(a^2*b*d^2*f*(n + 1)*(m + 1)) + 1/(a^2*b*d*(n + 1)*(m + 1))* Int[(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1)* Simp[a^2*(n + 1)*(n + 2) - b^2*(m + n + 2)*(m + n + 3) + a*b*(m + 1)* Sin[e + f*x] - (a^2*(n + 1)*(n + 3) - b^2*(m + n + 2)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && LtQ[m, -1] && LtQ[n, -1]
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (a^2 - b^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^(n + 1)/(a*b^2*d*f*(m + 1)) + (a^2*(n - m + 1) - b^2*(m + n + 2))* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 2)*(d*Sin[e + f*x])^(n + 1)/(a^2*b^2*d*f*(m + 1)*(m + 2)) - 1/(a^2*b^2*(m + 1)*(m + 2))* Int[(a + b*Sin[e + f*x])^(m + 2)*(d*Sin[e + f*x])^n* Simp[a^2*(n + 1)*(n + 3) - b^2*(m + n + 2)*(m + n + 3) + a*b*(m + 2)* Sin[e + f*x] - (a^2*(n + 2)*(n + 3) - b^2*(m + n + 2)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && LtQ[m, -1] && Not[LtQ[n, -1]] && (LtQ[m, -2] || EqQ[m + n + 4, 0])
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := (a^2 - b^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^(n + 1)/(a*b^2*d*f*(m + 1)) - Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 2)*(d*Sin[e + f*x])^(n + 1)/(b^2*d*f*(m + n + 4)) - 1/(a*b^2*(m + 1)*(m + n + 4))* Int[(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^n* Simp[a^2*(n + 1)*(n + 3) - b^2*(m + n + 2)*(m + n + 4) + a*b*(m + 1)* Sin[e + f*x] - (a^2*(n + 2)*(n + 3) - b^2*(m + n + 3)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && LtQ[m, -1] && Not[LtQ[n, -1]] && NeQ[m + n + 4, 0]
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^(n + 1)/(a*d* f*(n + 1)) - b*(m + n + 2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^(n + 2)/(a^2*d^2*f*(n + 1)*(n + 2)) - 1/(a^2*d^2*(n + 1)*(n + 2))* Int[(a + b*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n + 2)* Simp[a^2*n*(n + 2) - b^2*(m + n + 2)*(m + n + 3) + a*b*m*Sin[ e + f*x] - (a^2*(n + 1)*(n + 2) - b^2*(m + n + 2)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n]) && Not[m < -1] && LtQ[n, -1] && (LtQ[n, -2] || EqQ[m + n + 4, 0])
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^(n + 1)/(a*d* f*(n + 1)) - Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^(n + 2)/(b*d^2*f*(m + n + 4)) + 1/(a*b*d*(n + 1)*(m + n + 4))* Int[(a + b*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n + 1)* Simp[a^2*(n + 1)*(n + 2) - b^2*(m + n + 2)*(m + n + 4) + a*b*(m + 3)* Sin[e + f*x] - (a^2*(n + 1)*(n + 3) - b^2*(m + n + 3)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n]) && Not[m < -1] && LtQ[n, -1] && NeQ[m + n + 4, 0]
Int[cos[e_. + f_.*x_]^4*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := a*(n + 3)* Cos[e + f*x]*(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1)/(b^2*d* f*(m + n + 3)*(m + n + 4)) - Cos[ e + f*x]*(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^(m + 1)/(b*d^2*f*(m + n + 4)) - 1/(b^2*(m + n + 3)*(m + n + 4))* Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^m* Simp[a^2*(n + 1)*(n + 3) - b^2*(m + n + 3)*(m + n + 4) + a*b*m*Sin[ e + f*x] - (a^2*(n + 2)*(n + 3) - b^2*(m + n + 3)*(m + n + 5))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n]) && Not[m < -1] && Not[LtQ[n, -1]] && NeQ[m + n + 3, 0] && NeQ[m + n + 4, 0]
Int[cos[e_. + f_.*x_]^6*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Cos[e + f*x]*(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1)/(a*d* f*(n + 1)) - b*(m + n + 2)* Cos[e + f*x]*(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^(m + 1)/(a^2*d^2*f*(n + 1)*(n + 2)) - a*(n + 5)* Cos[e + f*x]*(d*Sin[e + f*x])^(n + 3)*(a + b*Sin[e + f*x])^(m + 1)/(b^2*d^3* f*(m + n + 5)*(m + n + 6)) + Cos[ e + f*x]*(d*Sin[e + f*x])^(n + 4)*(a + b*Sin[e + f*x])^(m + 1)/(b*d^4*f*(m + n + 6)) + 1/(a^2*b^2*d^2*(n + 1)*(n + 2)*(m + n + 5)*(m + n + 6))* Int[(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^m* Simp[a^4*(n + 1)*(n + 2)*(n + 3)*(n + 5) - a^2*b^2*(n + 2)*(2*n + 1)*(m + n + 5)*(m + n + 6) + b^4*(m + n + 2)*(m + n + 3)*(m + n + 5)*(m + n + 6) + a*b*m*(a^2*(n + 1)*(n + 2) - b^2*(m + n + 5)*(m + n + 6))* Sin[e + f*x] - (a^4*(n + 1)*(n + 2)*(4 + n)*(n + 5) + b^4*(m + n + 2)*(m + n + 4)*(m + n + 5)*(m + n + 6) - a^2*b^2*(n + 1)*(n + 2)*(m + n + 5)*(2*n + 2*m + 13))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && NeQ[n, -1] && NeQ[n, -2] && NeQ[m + n + 5, 0] && NeQ[m + n + 6, 0] && Not[IGtQ[m, 0]]
Int[cos[e_. + f_.*x_]^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^n*(a + b*sin[e + f*x])^ m*(1 - sin[e + f*x]^2)^(p/2), x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[m, 2*n, p/2] && (LtQ[m, -1] || EqQ[m, -1] && GtQ[p, 0])
Int[(g_.*cos[e_. + f_.*x_])^p_* sin[e_. + f_.*x_]^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p, sin[e + f*x]^n/(a + b*sin[e + f*x]), x], x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[n] && (LtQ[n, 0] || IGtQ[p + 1/2, 0])
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := g^2/a*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n, x] - b*g^2/(a^2*d)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1), x] - g^2*(a^2 - b^2)/(a^2*d^2)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 2)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && GtQ[p, 1] && (LeQ[n, -2] || EqQ[n, -3/2] && EqQ[p, 3/2])
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := g^2/(a*b)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^ n*(b - a*Sin[e + f*x]), x] + g^2*(a^2 - b^2)/(a*b*d)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && GtQ[p, 1] && (LtQ[n, -1] || EqQ[p, 3/2] && EqQ[n, -1/2])
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := g^2/b^2* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^ n*(a - b*Sin[e + f*x]), x] - g^2*(a^2 - b^2)/b^2* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^ n/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && GtQ[p, 1]
(* Int[(g_.*cos[e_.+f_.*x_])^p_*(d_.*sin[e_.+f_.*x_])^n_/(a_+b_.*sin[ e_.+f_.*x_]),x_Symbol] := g^2*Int[(g*Cos[e+f*x])^(p-2)*(d*Sin[e+f*x])^n/(a+b*Sin[e+f*x]),x] -   g^2/d^2*Int[(g*Cos[e+f*x])^(p-2)*(d*Sin[e+f*x])^(n+2)/(a+b*Sin[e+f* x]),x] /; FreeQ[{a,b,d,e,f,g},x] && NeQ[a^2-b^2,0] && IntegersQ[2*n,2*p] &&  GtQ[p,1] *)
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := a*d^2/(a^2 - b^2)* Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 2), x] - b*d/(a^2 - b^2)* Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 1), x] - a^2*d^2/(g^2*(a^2 - b^2))* Int[(g*Cos[e + f*x])^(p + 2)*(d*Sin[e + f*x])^(n - 2)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[p, -1] && GtQ[n, 1]
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := -d/(a^2 - b^2)* Int[(g*Cos[e + f*x])^ p*(d*Sin[e + f*x])^(n - 1)*(b - a*Sin[e + f*x]), x] + a*b*d/(g^2*(a^2 - b^2))* Int[(g*Cos[e + f*x])^(p + 2)*(d*Sin[e + f*x])^(n - 1)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[p, -1] && GtQ[n, 0]
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := 1/(a^2 - b^2)* Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n*(a - b*Sin[e + f*x]), x] - b^2/(g^2*(a^2 - b^2))* Int[(g*Cos[e + f*x])^(p + 2)*(d*Sin[e + f*x])^ n/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[p, -1]
Int[Sqrt[ g_.*cos[e_. + f_.*x_]]/(Sqrt[ sin[e_. + f_.*x_]]*(a_ + b_.*sin[e_. + f_.*x_])), x_Symbol] := -4*Sqrt[2]*g/f* Subst[Int[x^2/(((a + b)*g^2 + (a - b)*x^4)*Sqrt[1 - x^4/g^2]), x], x, Sqrt[g*Cos[e + f*x]]/Sqrt[1 + Sin[e + f*x]]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[ g_.*cos[e_. + f_.*x_]]/(Sqrt[ d_*sin[e_. + f_.*x_]]*(a_ + b_.*sin[e_. + f_.*x_])), x_Symbol] := Sqrt[Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]]* Int[Sqrt[g*Cos[e + f*x]]/(Sqrt[Sin[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[ d_.*sin[e_. + f_.*x_]]/(Sqrt[ cos[e_. + f_.*x_]]*(a_ + b_.*sin[e_. + f_.*x_])), x_Symbol] := With[{q = Rt[-a^2 + b^2, 2]}, 2*Sqrt[2]*d*(b + q)/(f*q)* Subst[Int[1/((d*(b + q) + a*x^2)*Sqrt[1 - x^4/d^2]), x], x, Sqrt[d*Sin[e + f*x]]/Sqrt[1 + Cos[e + f*x]]] - 2*Sqrt[2]*d*(b - q)/(f*q)* Subst[Int[1/((d*(b - q) + a*x^2)*Sqrt[1 - x^4/d^2]), x], x, Sqrt[d*Sin[e + f*x]]/Sqrt[1 + Cos[e + f*x]]]] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[ d_.*sin[e_. + f_.*x_]]/(Sqrt[ g_.*cos[e_. + f_.*x_]]*(a_ + b_.*sin[e_. + f_.*x_])), x_Symbol] := Sqrt[Cos[e + f*x]]/Sqrt[g*Cos[e + f*x]]* Int[Sqrt[d*Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := d/b*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 1), x] - a*d/b* Int[(g*Cos[e + f*x])^ p*(d*Sin[e + f*x])^(n - 1)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[-1, p, 1] && GtQ[n, 0]
Int[(g_.*cos[e_. + f_.*x_])^ p_*(d_.*sin[e_. + f_.*x_])^n_/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := 1/a*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n, x] - b/(a*d)* Int[(g*Cos[e + f*x])^ p*(d*Sin[e + f*x])^(n + 1)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[-1, p, 1] && LtQ[n, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^2, x_Symbol] := 2*a*b/d*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n + 1), x] + Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^ n*(a^2 + b^2*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && NeQ[a^2 - b^2, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^ p, (d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m, x], x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[m] && (GtQ[m, 0] || IntegerQ[n])
Int[(g_.*cos[e_. + f_.*x_])^p_*(d_.*sin[e_. + f_.*x_])^ n_*(a_ + b_.*sin[e_. + f_.*x_])^m_, x_Symbol] := g^2/a* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^ n*(a + b*Sin[e + f*x])^(m + 1), x] - b*g^2/(a^2*d)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1), x] - g^2*(a^2 - b^2)/(a^2*d^2)* Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[m, 2*n, 2*p] && LtQ[m, 0] && GtQ[p, 1] && (LeQ[n, -2] || EqQ[m, -1] && EqQ[n, -3/2] && EqQ[p, 3/2])
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^(2*m)*Int[(c + d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p] && EqQ[2*m + p, 0]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := (a/g)^(2*m)* Int[(g*Cos[e + f*x])^(2*m + p)*(c + d*Sin[e + f*x])^ n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && (EqQ[2*m + p, 0] || GtQ[2*m + p, 0] && LtQ[p, -1])
Int[cos[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := 1/b^2* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^ n*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n]
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^m*Cos[ e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]])* Subst[ Int[(1 + b/a*x)^(m + (p - 1)/2)*(1 - b/a*x)^((p - 1)/2)*(c + d*x)^ n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] && IntegerQ[m]
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Cos[e + f*x]/(a^(p - 2)*f*Sqrt[a + b*Sin[e + f*x]]* Sqrt[a - b*Sin[e + f*x]])* Subst[ Int[(a + b*x)^(m + p/2 - 1/2)*(a - b*x)^(p/2 - 1/2)*(c + d*x)^n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] && Not[IntegerQ[m]]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^ p, (a + b*sin[e + f*x])^m*(c + d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && (IntegerQ[p] || IGtQ[n, 0])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := a^m*g*(g*Cos[e + f*x])^(p - 1)/(f*(1 + Sin[e + f*x])^((p - 1)/2)*(1 - Sin[e + f*x])^((p - 1)/2))* Subst[ Int[(1 + b/a*x)^(m + (p - 1)/2)*(1 - b/a*x)^((p - 1)/2)*(c + d*x)^ n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)/(f*(a + b*Sin[e + f*x])^((p - 1)/2)*(a - b*Sin[e + f*x])^((p - 1)/2))* Subst[ Int[(a + b*x)^(m + (p - 1)/2)*(a - b*x)^((p - 1)/2)*(c + d*x)^n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]]
Int[cos[e_. + f_.*x_]^2*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^ n*(1 - Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n])
Int[cos[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(a + b*sin[e + f*x])^m*(c + d*sin[e + f*x])^ n*(1 - sin[e + f*x]^2)^(p/2), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && IGtQ[p/2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n])
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p*(a + b*sin[e + f*x])^ m*(c + d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n]
Int[(g_.*cos[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := Unintegrable[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[a^2 - b^2, 0]
Int[(g_.*sec[e_. + f_.*x_])^p_*(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := g^(2*IntPart[p])*(g*Cos[e + f*x])^FracPart[p]*(g*Sec[e + f*x])^ FracPart[p]* Int[(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && Not[IntegerQ[p]]
Int[(g_.*csc[e_. + f_.*x_])^p_*(a_. + b_.*cos[e_. + f_.*x_])^ m_.*(c_. + d_.*cos[e_. + f_.*x_])^n_., x_Symbol] := g^(2*IntPart[p])*(g*Sin[e + f*x])^FracPart[p]*(g*Csc[e + f*x])^ FracPart[p]* Int[(a + b*Cos[e + f*x])^ m*(c + d*Cos[e + f*x])^n/(g*Sin[e + f*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && Not[IntegerQ[p]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.2.3 (g sin)^p (a+b sin)^m (c+d sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.2.3 (g sin)^p (a+b sin)^m (c+d sin)^n *)
Int[Sqrt[g_.*sin[e_. + f_.*x_]]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/(c_ + d_.*sin[e_. + f_.*x_]), x_Symbol] := g/d*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[g*Sin[e + f*x]], x] - c*g/d* Int[Sqrt[ a + b*Sin[e + f*x]]/(Sqrt[ g*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[Sqrt[g_.*sin[e_. + f_.*x_]]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]/(c_ + d_.*sin[e_. + f_.*x_]), x_Symbol] := b/d*Int[Sqrt[g*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] - (b*c - a*d)/d* Int[Sqrt[ g*Sin[e + f*x]]/(Sqrt[ a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(Sqrt[ g_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := -2*b/f* Subst[Int[1/(b*c + a*d + c*g*x^2), x], x, b*Cos[e + f*x]/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]])] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(Sqrt[ sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := -Sqrt[a + b]/(c*f)* EllipticE[ ArcSin[Cos[e + f*x]/(1 + Sin[e + f*x])], -(a - b)/(a + b)] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[d, c] && GtQ[b^2 - a^2, 0] && GtQ[b, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(Sqrt[ g_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := -Sqrt[a + b*Sin[e + f*x]]*Sqrt[d*Sin[e + f*x]/(c + d*Sin[e + f*x])]/ (d*f*Sqrt[g*Sin[e + f*x]]* Sqrt[c^2*(a + b*Sin[e + f*x])/((a*c + b*d)*(c + d*Sin[e + f*x]))])* EllipticE[ ArcSin[c* Cos[e + f*x]/(c + d*Sin[e + f*x])], (b*c - a*d)/(b*c + a*d)] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(Sqrt[ g_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := a/c*Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] + (b*c - a*d)/(c*g)* Int[Sqrt[ g*Sin[e + f*x]]/(Sqrt[ a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(sin[ e_. + f_.*x_]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := 1/c*Int[Sqrt[a + b*Sin[e + f*x]]/Sin[e + f*x], x] - d/c*Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(sin[ e_. + f_.*x_]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := a/c*Int[1/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] + (b*c - a*d)/c* Int[1/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[ g_.*sin[e_. + f_.*x_]]/(Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := -a*g/(b*c - a*d)* Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] + c*g/(b*c - a*d)* Int[Sqrt[ a + b*Sin[e + f*x]]/(Sqrt[ g*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[Sqrt[ g_.*sin[e_. + f_.*x_]]/(Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := 2*Sqrt[-Cot[e + f*x]^2]* Sqrt[g*Sin[e + f*x]]/(f*(c + d)*Cot[e + f*x]* Sqrt[a + b*Sin[e + f*x]])*Sqrt[(b + a*Csc[e + f*x])/(a + b)]* EllipticPi[2*c/(c + d), ArcSin[Sqrt[1 - Csc[e + f*x]]/Sqrt[2]], 2*a/(a + b)] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[g_.*sin[e_. + f_.*x_]]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := b/(b*c - a*d)* Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] - d/(b*c - a*d)* Int[Sqrt[ a + b*Sin[e + f*x]]/(Sqrt[ g*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[1/(Sqrt[g_.*sin[e_. + f_.*x_]]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := 1/c*Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] - d/(c*g)* Int[Sqrt[ g*Sin[e + f*x]]/(Sqrt[ a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(sin[e_. + f_.*x_]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := d^2/(c*(b*c - a*d))* Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] + 1/(c*(b*c - a*d))* Int[(b*c - a*d - b*d*Sin[e + f*x])/(Sin[e + f*x]* Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[1/(sin[e_. + f_.*x_]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])), x_Symbol] := 1/c*Int[1/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] - d/c*Int[1/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(sin[e_. + f_.*x_]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -d/c*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + 1/c* Int[Sqrt[a + b*Sin[e + f*x]]* Sqrt[c + d*Sin[e + f*x]]/Sin[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[b*c + a*d, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(sin[e_. + f_.*x_]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*a/f* Subst[Int[1/(1 - a*c*x^2), x], x, Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]* Sqrt[c + d*Sin[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[b*c + a*d, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(sin[e_. + f_.*x_]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := (b*c - a*d)/c* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] + a/c* Int[Sqrt[ c + d*Sin[e + f*x]]/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]/(sin[e_. + f_.*x_]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*(a + b*Sin[e + f*x])/(c*f*Rt[(a + b)/(c + d), 2]*Cos[e + f*x])* Sqrt[-(b*c - a*d)*(1 - Sin[e + f*x])/((c + d)*(a + b*Sin[e + f*x]))]* Sqrt[(b*c - a*d)*(1 + Sin[e + f*x])/((c - d)*(a + b*Sin[e + f*x]))]* EllipticPi[a*(c + d)/(c*(a + b)), ArcSin[Rt[(a + b)/(c + d), 2]* Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]]], (a - b)*(c + d)/((a + b)*(c - d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(sin[e_. + f_.*x_]*Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]])* Int[1/(Cos[e + f*x]*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[1/(sin[e_. + f_.*x_]*Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -b/a*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] + 1/a* Int[Sqrt[ a + b*Sin[e + f*x]]/(Sin[e + f*x]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (NeQ[a^2 - b^2, 0] || NeQ[c^2 - d^2, 0])
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]/sin[e_. + f_.*x_], x_Symbol] := Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]/Cos[e + f*x]* Int[Cot[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]/sin[e_. + f_.*x_], x_Symbol] := d*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + c*Int[ Sqrt[a + b*Sin[e + f*x]]/(Sin[e + f*x]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (NeQ[a^2 - b^2, 0] || NeQ[c^2 - d^2, 0])
Int[sin[e_. + f_.*x_]^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := a^n*c^n*Int[Tan[e + f*x]^p*(a + b*Sin[e + f*x])^(m - n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[p + 2*n, 0] && IntegerQ[n]
Int[(g_.*sin[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Sqrt[a - b*Sin[e + f*x]]* Sqrt[a + b*Sin[e + f*x]]/(f*Cos[e + f*x])* Subst[ Int[(g*x)^p*(a + b*x)^(m - 1/2)*(c + d*x)^n/Sqrt[a - b*x], x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && IntegerQ[m - 1/2]
Int[(g_.*sin[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(g*sin[e + f*x])^p*(a + b*sin[e + f*x])^ m*(c + d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[b*c - a*d, 0] && (IntegersQ[m, n] || IntegersQ[m, p] || IntegersQ[n, p]) && NeQ[p, 2]
Int[(g_.*sin[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*sin[e_. + f_.*x_])^n_, x_Symbol] := Unintegrable[(g*Sin[e + f*x])^p*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[p, 2]
Int[(g_.*sin[e_. + f_.*x_])^p_.*(a_. + b_.*csc[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := g^(m + n)* Int[(g*Sin[e + f*x])^(p - m - n)*(b + a*Sin[e + f*x])^ m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[p]] && IntegerQ[m] && IntegerQ[n]
Int[(g_.*sin[e_. + f_.*x_])^p_.*(a_. + b_.*csc[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := (g*Csc[e + f*x])^p*(g*Sin[e + f*x])^p* Int[(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n/(g*Csc[e + f*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[p]] && Not[IntegerQ[m] && IntegerQ[n]]
Int[(g_.*sin[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := g^n*Int[(g*Sin[e + f*x])^(p - n)*(a + b*Sin[e + f*x])^ m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && IntegerQ[n]
Int[sin[e_. + f_.*x_]^p_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Int[(b + a*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n/ Csc[e + f*x]^(m + p), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m] && IntegerQ[p]
Int[(g_.*sin[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Csc[e + f*x]^p*(g*Sin[e + f*x])^p* Int[(b + a*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n/ Csc[e + f*x]^(m + p), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && Not[IntegerQ[n]] && IntegerQ[m] && Not[IntegerQ[p]]
Int[(g_.*sin[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := (g*Sin[e + f*x])^n*(c + d*Csc[e + f*x])^n/(d + c*Sin[e + f*x])^n* Int[(g*Sin[e + f*x])^(p - n)*(a + b*Sin[e + f*x])^ m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := g^(m + n)* Int[(g*Csc[e + f*x])^(p - m - n)*(b + a*Csc[e + f*x])^ m*(d + c*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[p]] && IntegerQ[m] && IntegerQ[n]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])^n_., x_Symbol] := (g*Csc[e + f*x])^p*(g*Sin[e + f*x])^p* Int[(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(g*Sin[e + f*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[p]] && Not[IntegerQ[m] && IntegerQ[n]]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := g^m*Int[(g*Csc[e + f*x])^(p - m)*(b + a*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && IntegerQ[m]
Int[csc[e_. + f_.*x_]^p_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Int[(a + b*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/ Sin[e + f*x]^(n + p), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && Not[IntegerQ[m]] && IntegerQ[n] && IntegerQ[p]
Int[(g_.*csc[e_. + f_.*x_])^p_*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Sin[e + f*x]^p*(g*Csc[e + f*x])^p* Int[(a + b*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/ Sin[e + f*x]^(n + p), x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && Not[IntegerQ[m]] && IntegerQ[n] && Not[IntegerQ[p]]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := (a + b*Sin[e + f*x])^m*(g*Csc[e + f*x])^m/(b + a*Csc[e + f*x])^m* Int[(g*Csc[e + f*x])^(p - m)*(b + a*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.3.1 (a+b sin)^m (c+d sin)^n (A+B sin).m
*)

(* ::Subsection::Closed:: *)
(* 4.1.3.1 (a+b sin)^m (c+d sin)^n (A+B sin) *)
Int[sin[e_. + f_.*x_]^n_.*(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := Int[ExpandTrig[ sin[e + f*x]^n*(a + b*sin[e + f*x])^m*(A + B*sin[e + f*x]), x], x] /; FreeQ[{a, b, e, f, A, B}, x] && EqQ[A*b + a*B, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && IntegerQ[n]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_ + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := a^m*c^m* Int[Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m)*(A + B*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && Not[IntegerQ[ n] && (LtQ[m, 0] && GtQ[n, 0] || LtQ[0, n, m] || LtQ[m, n, 0])]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_. + d_.*sin[e_. + f_.*x_])*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := Int[(a + b*Sin[e + f*x])^ m*(A*c + (B*c + A*d)*Sin[e + f*x] + B*d*Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_])/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := (A*b + a*B)/(2*a*b)* Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + (B*c + A*d)/(2*c*d)* Int[Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -B*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(f*(m + n + 1)) /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[A*b*(m + n + 1) + a*B*(m - n), 0] && NeQ[m, -1/2]
Int[Sqrt[a_. + b_.*sin[e_. + f_.*x_]]*(c_ + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := B/d*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n + 1), x] - (B*c - A*d)/d* Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_ + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*(2*m + 1)) + (a*B*(m - n) + A*b*(m + n + 1))/(a*b*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (LtQ[m, -1/2] || ILtQ[m + n, 0] && Not[SumSimplerQ[n, 1]]) && NeQ[2*m + 1, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_ + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -B*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(f*(m + n + 1)) - (B*c*(m - n) - A*d*(m + n + 1))/(d*(m + n + 1))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && NeQ[m + n + 1, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (B*c - A*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2)) /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[m + n + 2, 0] && EqQ[A*(a*d*m + b*c*(n + 1)) - B*(a*c*m + b*d*(n + 1)), 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -b^2*(B*c - A*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(b*c + a*d)) - b/(d*(n + 1)*(b*c + a*d))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)* Simp[a*A*d*(m - n - 2) - B*(a*c*(m - 1) + b*d*(n + 1)) - (A*b*d*(m + n + 1) - B*(b*c*m - a*d*(n + 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1/2] && LtQ[n, -1] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -b*B*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 1)) + 1/(d*(m + n + 1))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n* Simp[a*A*d*(m + n + 1) + B*(a*c*(m - 1) + b*d*(n + 1)) + (A*b*d*(m + n + 1) - B*(b*c*m - a*d*(2*m + n)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1/2] && Not[LtQ[n, -1]] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(a*f*(2*m + 1)) - 1/(a*b*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)* Simp[A*(a*d*n - b*c*(m + 1)) - B*(a*c*m + b*d*n) - d*(a*B*(m - n) + A*b*(m + n + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1/2] && GtQ[n, 0] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := b*(A*b - a*B)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(a*f*(2*m + 1)*(b*c - a*d)) + 1/(a*(2*m + 1)*(b*c - a*d))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[B*(a*c*m + b*d*(n + 1)) + A*(b*c*(m + 1) - a*d*(2*m + n + 2)) + d*(A*b - a*B)*(m + n + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1/2] && Not[GtQ[n, 0]] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -2*b*B* Cos[e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(2*n + 3)* Sqrt[a + b*Sin[e + f*x]]) /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A*b*d*(2*n + 3) - B*(b*c - 2*a*d*(n + 1)), 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -b^2*(B*c - A*d)* Cos[e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(d* f*(n + 1)*(b*c + a*d)*Sqrt[a + b*Sin[e + f*x]]) + (A*b*d*(2*n + 3) - B*(b*c - 2*a*d*(n + 1)))/(2* d*(n + 1)*(b*c + a*d))* Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -2*b*B* Cos[e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(2*n + 3)* Sqrt[a + b*Sin[e + f*x]]) + (A*b*d*(2*n + 3) - B*(b*c - 2*a*d*(n + 1)))/(b*d*(2*n + 3))* Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[LtQ[n, -1]]
Int[(A_. + B_.*sin[e_. + f_.*x_])/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := (A*b - a*B)/b* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] + B/b*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -B*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^n/(f*(m + n + 1)) + 1/(b*(m + n + 1))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n - 1)* Simp[A*b*c*(m + n + 1) + B*(a*c*m + b*d*n) + (A*b*d*(m + n + 1) + B*(a*d*m + b*c*n))* Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 0] && (IntegerQ[n] || EqQ[m + 1/2, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (B*c - A*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2)) + 1/(b*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n + 1)* Simp[A*(a*d*m + b*c*(n + 1)) - B*(a*c*m + b*d*(n + 1)) + b*(B*c - A*d)*(m + n + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1] && (IntegerQ[n] || EqQ[m + 1/2, 0])
Int[(A_. + B_.*sin[e_. + f_.*x_])/(Sqrt[ a_ + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := (A*b - a*B)/(b*c - a*d)*Int[1/Sqrt[a + b*Sin[e + f*x]], x] + (B*c - A*d)/(b*c - a*d)* Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*sin[e_. + f_.*x_])/(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := B/d*Int[(a + b*Sin[e + f*x])^m, x] - (B*c - A*d)/d* Int[(a + b*Sin[e + f*x])^m/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NeQ[m + 1/2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)/b* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] + B/b*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NeQ[A*b + a*B, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^2*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (B*c - A*d)*(b*c - a*d)^2* Cos[e + f*x]*(c + d*Sin[e + f*x])^(n + 1)/(f* d^2*(n + 1)*(c^2 - d^2)) - 1/(d^2*(n + 1)*(c^2 - d^2))*Int[(c + d*Sin[e + f*x])^(n + 1)* Simp[d*(n + 1)*(B*(b*c - a*d)^2 - A*d*(a^2*c + b^2*c - 2*a*b*d)) - ((B*c - A*d)*(a^2*d^2*(n + 2) + b^2*(c^2 + d^2*(n + 1))) + 2*a*b*d*(A*c*d*(n + 2) - B*(c^2 + d^2*(n + 1))))* Sin[e + f*x] - b^2*B*d*(n + 1)*(c^2 - d^2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -(b*c - a*d)*(B*c - A*d)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2)) + 1/(d*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)* Simp[b*(b*c - a*d)*(B*c - A*d)*(m - 1) + a*d*(a*A*c + b*B*c - (A*b + a*B)*d)*(n + 1) + (b*(b*d*(B*c - A*d) + a*(A*c*d + B*(c^2 - 2*d^2)))*(n + 1) - a*(b*c - a*d)*(B*c - A*d)*(n + 2))*Sin[e + f*x] + b*(d*(A*b*c + a*B*c - a*A*d)*(m + n + 1) - b*B*(c^2*m + d^2*(n + 1)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] && LtQ[n, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -b*B*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 1)) + 1/(d*(m + n + 1))* Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^n* Simp[a^2*A*d*(m + n + 1) + b*B*(b*c*(m - 1) + a*d*(n + 1)) + (a*d*(2*A*b + a*B)*(m + n + 1) - b*B*(a*c - b*d*(m + n)))*Sin[e + f*x] + b*(A*b*d*(m + n + 1) - B*(b*c*m - a*d*(2*m + n)))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] && Not[IGtQ[n, 1] && (Not[IntegerQ[m]] || EqQ[a, 0] && NeQ[c, 0])]
Int[Sqrt[ c_ + d_.*sin[e_. + f_.*x_]]*(A_. + B_.*sin[e_. + f_.*x_])/(b_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := B*d/b^2*Int[Sqrt[b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + Int[(A*c + (B*c + A*d)*Sin[e + f*x])/((b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{b, c, d, e, f, A, B}, x] && NeQ[c^2 - d^2, 0]
Int[Sqrt[ c_. + d_.*sin[e_. + f_.*x_]]*(A_. + B_.*sin[e_. + f_.*x_])/(a_ + b_.*sin[e_. + f_.*x_])^(3/2), x_Symbol] := B/b*Int[Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + (A*b - a*B)/b* Int[Sqrt[c + d*Sin[e + f*x]]/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_])/((a_ + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := 2*(A*b - a*B)* Cos[e + f*x]/(f*(a^2 - b^2)*Sqrt[a + b*Sin[e + f*x]]* Sqrt[d*Sin[e + f*x]]) + d/(a^2 - b^2)* Int[(A*b - a*B + (a*A - b*B)*Sin[e + f*x])/(Sqrt[ a + b*Sin[e + f*x]]*(d*Sin[e + f*x])^(3/2)), x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[a^2 - b^2, 0]
Int[(A_ + B_.*sin[e_. + f_.*x_])/((b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*A*(c - d)*Tan[e + f*x]/(f*b*c^2)*Rt[(c + d)/b, 2]* Sqrt[c*(1 + Csc[e + f*x])/(c - d)]* Sqrt[c*(1 - Csc[e + f*x])/(c + d)]* EllipticE[ ArcSin[Sqrt[c + d*Sin[e + f*x]]/Sqrt[b*Sin[e + f*x]]/ Rt[(c + d)/b, 2]], -(c + d)/(c - d)] /; FreeQ[{b, c, d, e, f, A, B}, x] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && PosQ[(c + d)/b]
Int[(A_ + B_.*sin[e_. + f_.*x_])/((b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -Sqrt[-b*Sin[e + f*x]]/Sqrt[b*Sin[e + f*x]]* Int[(A + B*Sin[e + f*x])/((-b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{b, c, d, e, f, A, B}, x] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && NegQ[(c + d)/b]
Int[(A_ + B_.*sin[e_. + f_.*x_])/((a_ + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -2*A*(c - d)*(a + b*Sin[e + f*x])/(f*(b*c - a*d)^2*Rt[(a + b)/(c + d), 2]* Cos[e + f*x])* Sqrt[(b*c - a*d)*(1 + Sin[e + f*x])/((c - d)*(a + b*Sin[e + f*x]))]* Sqrt[-(b*c - a*d)*(1 - Sin[e + f*x])/((c + d)*(a + b*Sin[e + f*x]))]* EllipticE[ ArcSin[Rt[(a + b)/(c + d), 2]* Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]]], (a - b)*(c + d)/((a + b)*(c - d))] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && PosQ[(a + b)/(c + d)]
Int[(A_ + B_.*sin[e_. + f_.*x_])/((a_ + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := Sqrt[-c - d*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]]* Int[(A + B*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[-c - d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && NegQ[(a + b)/(c + d)]
Int[(A_. + B_.*sin[e_. + f_.*x_])/((a_. + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := (A - B)/(a - b)* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] - (A*b - a*B)/(a - b)* Int[(1 + Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NeQ[A, B]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := (B*a - A*b)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^ n/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)* Simp[c*(a*A - b*B)*(m + 1) + d*n*(A*b - a*B) + (d*(a*A - b*B)*(m + 1) - c*(A*b - a*B)*(m + 2))*Sin[e + f*x] - d*(A*b - a*B)*(m + n + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -(A*b^2 - a*b*B)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(1 + n)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[(a*A - b*B)*(b*c - a*d)*(m + 1) + b*d*(A*b - a*B)*(m + n + 2) + (A*b - a*B)*(a*d*(m + 1) - b*c*(m + 2))*Sin[e + f*x] - b*d*(A*b - a*B)*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && RationalQ[m] && m < -1 && (EqQ[a, 0] && IntegerQ[m] && Not[IntegerQ[n]] || Not[IntegerQ[2*n] && LtQ[n, -1] && (IntegerQ[n] && Not[IntegerQ[m]] || EqQ[a, 0])])
Int[(A_. + B_.*sin[e_. + f_.*x_])/((a_. + b_.*sin[e_. + f_.*x_])*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := (A*b - a*B)/(b*c - a*d)* Int[1/(a + b*Sin[e + f*x]), x] + (B*c - A*d)/(b*c - a*d)* Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*sin[e_. + f_.*x_])/(c_. + d_.*sin[e_. + f_.*x_]), x_Symbol] := B/d*Int[(a + b*Sin[e + f*x])^m, x] - (B*c - A*d)/d* Int[(a + b*Sin[e + f*x])^m/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[a_. + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := -2*B*Cos[e + f*x]* Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^n/(f*(2*n + 3)) + 1/(2*n + 3)* Int[(c + d*Sin[e + f*x])^(n - 1)/Sqrt[a + b*Sin[e + f*x]]* Simp[a*A*c*(2*n + 3) + B*(b*c + 2*a*d*n) + (B*(a*c + b*d)*(2*n + 1) + A*(b*c + a*d)*(2*n + 3))* Sin[e + f*x] + (A*b*d*(2*n + 3) + B*(a*d + 2*b*c*n))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[n^2, 1/4]
Int[(A_ + B_.*sin[e_. + f_.*x_])/(Sqrt[sin[e_. + f_.*x_]]* Sqrt[a_ + b_.*sin[e_. + f_.*x_]]), x_Symbol] := 4*A/(f*Sqrt[a + b])* EllipticPi[-1, -ArcSin[ Cos[e + f*x]/(1 + Sin[e + f*x])], -(a - b)/(a + b)] /; FreeQ[{a, b, e, f, A, B}, x] && GtQ[b, 0] && GtQ[b^2 - a^2, 0] && EqQ[A, B]
Int[(A_ + B_.*sin[e_. + f_.*x_])/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[d_*sin[e_. + f_.*x_]]), x_Symbol] := Sqrt[Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]]* Int[(A + B*Sin[e + f*x])/(Sqrt[Sin[e + f*x]]* Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, e, f, d, A, B}, x] && GtQ[b, 0] && GtQ[b^2 - a^2, 0] && EqQ[A, B]
Int[(A_. + B_.*sin[e_. + f_.*x_])/(Sqrt[a_ + b_.*sin[e_. + f_.*x_]]* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := B/d*Int[Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] - (B*c - A*d)/d* Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_]), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^ n*(A + B*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
(* Int[(a_+b_.*sin[e_.+f_.*x_])^m_*(c_+d_.*sin[e_.+f_.*x_])^n_*(A_.+B_ .*sin[e_.+f_.*x_])^p_,x_Symbol] := a^m*c^m*Int[Cos[e+f*x]^(2*m)*(c+d*Sin[e+f*x])^(n-m)*(A+B*Sin[e+f*x]) ^p,x] /; FreeQ[{a,b,c,d,e,f,A,B,n,p},x] && EqQ[b*c+a*d,0] && EqQ[a^2-b^2,0] &&  IntegerQ[m] && Not[IntegerQ[n] && (LtQ[m,0] && GtQ[n,0] || LtQ[0,n,m] ||  LtQ[m,n,0])] *)
(* Int[(a_+b_.*cos[e_.+f_.*x_])^m_*(c_+d_.*cos[e_.+f_.*x_])^n_*(A_.+B_ .*cos[e_.+f_.*x_])^p_,x_Symbol] := a^m*c^m*Int[Sin[e+f*x]^(2*m)*(c+d*Cos[e+f*x])^(n-m)*(A+B*Cos[e+f*x]) ^p,x] /; FreeQ[{a,b,c,d,e,f,A,B,n,p},x] && EqQ[b*c+a*d,0] && EqQ[a^2-b^2,0] &&  IntegerQ[m] && Not[IntegerQ[n] && (LtQ[m,0] && GtQ[n,0] || LtQ[0,n,m] ||  LtQ[m,n,0])] *)
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_ + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_])^p_, x_Symbol] := Sqrt[a + b*Sin[e + f*x]]* Sqrt[c + d*Sin[e + f*x]]/(f*Cos[e + f*x])* Subst[ Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2)*(A + B*x)^p, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*cos[e_. + f_.*x_])^m_.*(c_ + d_.*cos[e_. + f_.*x_])^ n_.*(A_. + B_.*cos[e_. + f_.*x_])^p_, x_Symbol] := -Sqrt[a + b*Cos[e + f*x]]*Sqrt[c + d*Cos[e + f*x]]/(f*Sin[e + f*x])* Subst[ Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2)*(A + B*x)^p, x], x, Cos[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.4.1 (a+b sin)^m (A+B sin+C sin^2).m
*)

(* ::Subsection::Closed:: *)
(* 4.1.4.1 (a+b sin)^m (A+B sin+C sin^2) *)
Int[(b_.*sin[e_. + f_.*x_])^ m_.*(B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := 1/b*Int[(b*Sin[e + f*x])^(m + 1)*(B + C*Sin[e + f*x]), x] /; FreeQ[{b, e, f, B, C, m}, x]
Int[(b_.*sin[e_. + f_.*x_])^m_.*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := A*Cos[e + f*x]*(b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)) /; FreeQ[{b, e, f, A, C, m}, x] && EqQ[A*(m + 2) + C*(m + 1), 0]
Int[(b_.*sin[e_. + f_.*x_])^m_*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := A*Cos[ e + f*x]*(b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)) + (A*(m + 2) + C*(m + 1))/(b^2*(m + 1))*Int[(b*Sin[e + f*x])^(m + 2), x] /; FreeQ[{b, e, f, A, C}, x] && LtQ[m, -1]
Int[sin[e_. + f_.*x_]^m_.*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -1/f*Subst[Int[(1 - x^2)^((m - 1)/2)*(A + C - C*x^2), x], x, Cos[e + f*x]] /; FreeQ[{e, f, A, C}, x] && IGtQ[(m + 1)/2, 0]
Int[(b_.*sin[e_. + f_.*x_])^m_.*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[ e + f*x]*(b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + (A*(m + 2) + C*(m + 1))/(m + 2)*Int[(b*Sin[e + f*x])^m, x] /; FreeQ[{b, e, f, A, C, m}, x] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := 1/b^2* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*B - a*C + b*C*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := C/b^2* Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[-a + b*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (A - C)*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x]), x] + C*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x])^2, x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A - B + C, 0] && Not[IntegerQ[2*m]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (A - C)*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x]), x] + C*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x])^2, x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A + C, 0] && Not[IntegerQ[2*m]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (A*b - a*B + b*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(a*f*(2*m + 1)) + 1/(a^2*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*A*(m + 1) + m*(b*B - a*C) + b*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := b*(A + C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(a*f*(2*m + 1)) + 1/(a^2*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*A*(m + 1) - a*C*m + b*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(A*b^2 - a*b*B + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C + b*(A*b - a*B + b*C)*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(A*b^2 + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*b*(A + C)*(m + 1) - (A*b^2 + a^2*C + b^2*(A + C)*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m* Simp[A*b*(m + 2) + b*C*(m + 1) + (b*B*(m + 2) - a*C)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m* Simp[A*b*(m + 2) + b*C*(m + 1) - a*C*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && Not[LtQ[m, -1]]
Int[(b_.*sin[e_. + f_.*x_]^p_)^ m_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p)* Int[(b*Sin[e + f*x])^(m*p)*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m, p}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_]^p_)^ m_*(A_. + B_.*cos[e_. + f_.*x_] + C_.*cos[e_. + f_.*x_]^2), x_Symbol] := (b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p)* Int[(b*Cos[e + f*x])^(m*p)*(A + B*Cos[e + f*x] + C*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m, p}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_]^p_)^m_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p)* Int[(b*Sin[e + f*x])^(m*p)*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m, p}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_]^p_)^m_*(A_. + C_.*cos[e_. + f_.*x_]^2), x_Symbol] := (b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p)* Int[(b*Cos[e + f*x])^(m*p)*(A + C*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m, p}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.4.2 (a+b sin)^m (c+d sin)^n (A+B sin+C sin^2).m
*)

(* ::Subsection::Closed:: *)
(* 4.1.4.2 (a+b sin)^m (c+d sin)^n (A+B sin+C sin^2) *)
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := 1/b^2* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^ n*(b*B - a*C + b*C*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C/b^2* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^ n*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[A*b^2 + a^2*C, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_])*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(b*c - a*d)*(A*b^2 - a*b*B + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b^2* f*(m + 1)*(a^2 - b^2)) - 1/(b^2*(m + 1)*(a^2 - b^2))*Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*(m + 1)*((b*B - a*C)*(b*c - a*d) - A*b*(a*c - b*d)) + (b* B*(a^2*d + b^2*d*(m + 1) - a*b*c*(m + 2)) + (b*c - a*d)*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1))))* Sin[e + f*x] - b*C*d*(m + 1)*(a^2 - b^2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_*(c_. + d_.*sin[e_. + f_.*x_])*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(b*c - a*d)*(A*b^2 + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b^2* f*(m + 1)*(a^2 - b^2)) + 1/(b^2*(m + 1)*(a^2 - b^2))*Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*(m + 1)*(a*C*(b*c - a*d) + A*b*(a*c - b*d)) - ((b*c - a*d)*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1))))* Sin[e + f*x] + b*C*d*(m + 1)*(a^2 - b^2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*d*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 3)) + 1/(b*(m + 3))*Int[(a + b*Sin[e + f*x])^m* Simp[a*C*d + A*b*c*(m + 3) + b*(B*c*(m + 3) + d*(C*(m + 2) + A*(m + 3)))* Sin[e + f*x] - (2*a*C*d - b*(c*C + B*d)*(m + 3))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(c_ + d_.*sin[e_. + f_.*x_])*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*d*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 3)) + 1/(b*(m + 3))*Int[(a + b*Sin[e + f*x])^m* Simp[a*C*d + A*b*c*(m + 3) + b*d*(C*(m + 2) + A*(m + 3))* Sin[e + f*x] - (2*a*C*d - b*c*C*(m + 3))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (a*A - b*B + a*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(2*b*c*f*(2*m + 1)) - 1/(2*b*c*d*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[A*(c^2*(m + 1) + d^2*(2*m + n + 2)) - B*c*d*(m - n - 1) - C*(c^2*m - d^2*(n + 1)) + d*((A*c + B*d)*(m + n + 2) - c*C*(3*m - n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (LtQ[m, -1/2] || EqQ[m + n + 2, 0] && NeQ[2*m + 1, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (a*A + a*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(2*b*c*f*(2*m + 1)) - 1/(2*b*c*d*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[A*(c^2*(m + 1) + d^2*(2*m + n + 2)) - C*(c^2*m - d^2*(n + 1)) + d*(A*c*(m + n + 2) - c*C*(3*m - n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (LtQ[m, -1/2] || EqQ[m + n + 2, 0] && NeQ[2*m + 1, 0])
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/ Sqrt[c_. + d_.*sin[e_. + f_.*x_]], x_Symbol] := -2*C*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(2*m + 3)* Sqrt[c + d*Sin[e + f*x]]) + Int[(a + b*Sin[e + f*x])^m* Simp[A + C + B*Sin[e + f*x], x]/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2)/ Sqrt[c_. + d_.*sin[e_. + f_.*x_]], x_Symbol] := -2*C*Cos[ e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(2*m + 3)* Sqrt[c + d*Sin[e + f*x]]) + (A + C)*Int[(a + b*Sin[e + f*x])^m/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2)) + 1/(b*d*(m + n + 2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n* Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) + (b*B*d*(m + n + 2) - b*c*C*(2*m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && NeQ[m + n + 2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2)) + 1/(b*d*(m + n + 2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n* Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) - b*c*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && NeQ[m + n + 2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (a*A - b*B + a*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(f*(b*c - a*d)*(2*m + 1)) + 1/(b*(b*c - a*d)*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[A*(a*c*(m + 1) - b*d*(2*m + n + 2)) + B*(b*c*m + a*d*(n + 1)) - C*(a*c*m + b*d*(n + 1)) + (d*(a*A - b*B)*(m + n + 2) + C*(b*c*(2*m + 1) - a*d*(m - n - 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := a*(A + C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(f*(b*c - a*d)*(2*m + 1)) + 1/(b*(b*c - a*d)*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[A*(a*c*(m + 1) - b*d*(2*m + n + 2)) - C*(a*c*m + b*d*(n + 1)) + (a*A*d*(m + n + 2) + C*(b*c*(2*m + 1) - a*d*(m - n - 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(c^2*C - B*c*d + A*d^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2)) + 1/(b*d*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n + 1)* Simp[A*d*(a*d*m + b*c*(n + 1)) + (c*C - B*d)*(a*c*m + b*d*(n + 1)) + b*(d*(B*c - A*d)*(m + n + 2) - C*(c^2*(m + 1) + d^2*(n + 1)))* Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[LtQ[m, -1/2]] && (LtQ[n, -1] || EqQ[m + n + 2, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(c^2*C + A*d^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2)) + 1/(b*d*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n + 1)* Simp[A*d*(a*d*m + b*c*(n + 1)) + c*C*(a*c*m + b*d*(n + 1)) - b*(A*d^2*(m + n + 2) + C*(c^2*(m + 1) + d^2*(n + 1)))* Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[LtQ[m, -1/2]] && (LtQ[n, -1] || EqQ[m + n + 2, 0])
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2)) + 1/(b*d*(m + n + 2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n* Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) + (C*(a*d*m - b*c*(m + 1)) + b*B*d*(m + n + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[LtQ[m, -1/2]] && NeQ[m + n + 2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2)) + 1/(b*d*(m + n + 2))* Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n* Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) + C*(a*d*m - b*c*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && Not[LtQ[m, -1/2]] && NeQ[m + n + 2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(c^2*C - B*c*d + A*d^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2)) + 1/(d*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)* Simp[A*d*(b*d*m + a*c*(n + 1)) + (c*C - B*d)*(b*c*m + a*d*(n + 1)) - (d*(A*(a*d*(n + 2) - b*c*(n + 1)) + B*(b*d*(n + 1) - a*c*(n + 2))) - C*(b*c*d*(n + 1) - a*(c^2 + d^2*(n + 1))))*Sin[e + f*x] + b*(d*(B*c - A*d)*(m + n + 2) - C*(c^2*(m + 1) + d^2*(n + 1)))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(c^2*C + A*d^2)* Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2)) + 1/(d*(n + 1)*(c^2 - d^2))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)* Simp[A*d*(b*d*m + a*c*(n + 1)) + c*C*(b*c*m + a*d*(n + 1)) - (A*d*(a*d*(n + 2) - b*c*(n + 1)) - C*(b*c*d*(n + 1) - a*(c^2 + d^2*(n + 1))))*Sin[e + f*x] - b*(A*d^2*(m + n + 2) + C*(c^2*(m + 1) + d^2*(n + 1)))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2)) + 1/(d*(m + n + 2))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n* Simp[a*A*d*(m + n + 2) + C*(b*c*m + a*d*(n + 1)) + (d*(A*b + a*B)*(m + n + 2) - C*(a*c - b*d*(m + n + 1)))* Sin[e + f*x] + (C*(a*d*m - b*c*(m + 1)) + b*B*d*(m + n + 2))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] && Not[IGtQ[n, 0] && (Not[IntegerQ[m]] || EqQ[a, 0] && NeQ[c, 0])]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_.*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -C*Cos[e + f*x]*(a + b*Sin[e + f*x])^ m*(c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2)) + 1/(d*(m + n + 2))* Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n* Simp[a*A*d*(m + n + 2) + C*(b*c*m + a*d*(n + 1)) + (A*b*d*(m + n + 2) - C*(a*c - b*d*(m + n + 1)))*Sin[e + f*x] + C*(a*d*m - b*c*(m + 1))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] && Not[IGtQ[n, 0] && (Not[IntegerQ[m]] || EqQ[a, 0] && NeQ[c, 0])]
Int[(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/((a_ + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := C/(b*d)*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + 1/b* Int[(A*b + (b*B - a*C)*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[d*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[(A_. + C_.*sin[e_. + f_.*x_]^2)/((a_ + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[d_.*sin[e_. + f_.*x_]]), x_Symbol] := C/(b*d)*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + 1/b* Int[(A*b - a*C*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[d*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/((a_. + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := C/b^2*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + 1/b^2* Int[(A*b^2 - a^2*C + b*(b*B - 2*a*C)*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + C_.*sin[e_. + f_.*x_]^2)/((a_. + b_.*sin[e_. + f_.*x_])^(3/2)* Sqrt[c_. + d_.*sin[e_. + f_.*x_]]), x_Symbol] := C/b^2*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + 1/b^2* Int[(A*b^2 - a^2*C - 2*a*b*C*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)* Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(A*b^2 - a*b*B + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[(m + 1)*(b*c - a*d)*(a*A - b*B + a*C) + d*(A*b^2 - a*b*B + a^2*C)*(m + n + 2) - (c*(A*b^2 - a*b*B + a^2*C) + (m + 1)*(b*c - a*d)*(A*b - a*B + b*C))*Sin[e + f*x] - d*(A*b^2 - a*b*B + a^2*C)*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && (EqQ[a, 0] && IntegerQ[m] && Not[IntegerQ[n]] || Not[IntegerQ[2*n] && LtQ[n, -1] && (IntegerQ[n] && Not[IntegerQ[m]] || EqQ[a, 0])])
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(A*b^2 + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n* Simp[a*(m + 1)*(b*c - a*d)*(A + C) + d*(A*b^2 + a^2*C)*(m + n + 2) - (c*(A*b^2 + a^2*C) + b*(m + 1)*(b*c - a*d)*(A + C))* Sin[e + f*x] - d*(A*b^2 + a^2*C)*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && (EqQ[a, 0] && IntegerQ[m] && Not[IntegerQ[n]] || Not[IntegerQ[2*n] && LtQ[n, -1] && (IntegerQ[n] && Not[IntegerQ[m]] || EqQ[a, 0])])
Int[(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/((a_ + b_.*sin[e_. + f_.*x_])*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := C*x/(b*d) + (A*b^2 - a*b*B + a^2*C)/(b*(b*c - a*d))* Int[1/(a + b*Sin[e + f*x]), x] - (c^2*C - B*c*d + A*d^2)/(d*(b*c - a*d))* Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + C_.*sin[e_. + f_.*x_]^2)/((a_ + b_.*sin[e_. + f_.*x_])*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := C*x/(b*d) + (A*b^2 + a^2*C)/(b*(b*c - a*d))* Int[1/(a + b*Sin[e + f*x]), x] - (c^2*C + A*d^2)/(d*(b*c - a*d))*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/(Sqrt[ a_. + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := C/(b*d)*Int[Sqrt[a + b*Sin[e + f*x]], x] - 1/(b*d)* Int[Simp[a*c*C - A*b*d + (b*c*C - b*B*d + a*C*d)*Sin[e + f*x], x]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + C_.*sin[e_. + f_.*x_]^2)/(Sqrt[ a_. + b_.*sin[e_. + f_.*x_]]*(c_. + d_.*sin[e_. + f_.*x_])), x_Symbol] := C/(b*d)*Int[Sqrt[a + b*Sin[e + f*x]], x] - 1/(b*d)* Int[Simp[a*c*C - A*b*d + (b*c*C + a*C*d)*Sin[e + f*x], x]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/(Sqrt[a_. + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -C*Cos[e + f*x]* Sqrt[c + d*Sin[e + f*x]]/(d*f*Sqrt[a + b*Sin[e + f*x]]) + 1/(2*d)* Int[1/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]])* Simp[2*a*A*d - C*(b*c - a*d) - 2*(a*c*C - d*(A*b + a*B))* Sin[e + f*x] + (2*b*B*d - C*(b*c + a*d))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(A_. + C_.*sin[e_. + f_.*x_]^2)/(Sqrt[a_. + b_.*sin[e_. + f_.*x_]]* Sqrt[c_ + d_.*sin[e_. + f_.*x_]]), x_Symbol] := -C*Cos[e + f*x]* Sqrt[c + d*Sin[e + f*x]]/(d*f*Sqrt[a + b*Sin[e + f*x]]) + 1/(2*d)* Int[1/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]])* Simp[2*a*A*d - C*(b*c - a*d) - 2*(a*c*C - A*b*d)*Sin[e + f*x] - C*(b*c + a*d)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2)/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := (b*B - a*C)/b^2*Int[(d*Sin[e + f*x])^n, x] + C/(b*d)*Int[(d*Sin[e + f*x])^(n + 1), x] + (A*b^2 - a*b*B + a^2*C)/b^2* Int[(d*Sin[e + f*x])^n/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2)/(a_ + b_.*sin[e_. + f_.*x_]), x_Symbol] := -a*C/b^2*Int[(d*Sin[e + f*x])^n, x] + C/(b*d)*Int[(d*Sin[e + f*x])^(n + 1), x] + (A*b^2 + a^2*C)/b^2* Int[(d*Sin[e + f*x])^n/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && NeQ[a^2 - b^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^ n*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^ n*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(b_.*sin[e_. + f_.*x_]^p_)^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p)* Int[(b*Sin[e + f*x])^(m*p)*(c + d*Sin[e + f*x])^ n*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, B, C, m, n, p}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_]^p_)^m_*(c_. + d_.*cos[e_. + f_.*x_])^ n_.*(A_. + B_.*cos[e_. + f_.*x_] + C_.*cos[e_. + f_.*x_]^2), x_Symbol] := (b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p)* Int[(b*Cos[e + f*x])^(m*p)*(c + d*Cos[e + f*x])^ n*(A + B*Cos[e + f*x] + C*Cos[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, B, C, m, n, p}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_]^p_)^m_*(c_. + d_.*sin[e_. + f_.*x_])^ n_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol] := (b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p)* Int[(b*Sin[e + f*x])^(m*p)*(c + d*Sin[e + f*x])^ n*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, C, m, n, p}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_]^p_)^m_*(c_. + d_.*cos[e_. + f_.*x_])^ n_.*(A_. + C_.*cos[e_. + f_.*x_]^2), x_Symbol] := (b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p)* Int[(b*Cos[e + f*x])^(m*p)*(c + d*Cos[e + f*x])^ n*(A + C*Cos[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, C, m, n, p}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.5 trig^m (a cos+b sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.5 trig^m (a cos+b sin)^n *)
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := a*(a*Cos[c + d*x] + b*Sin[c + d*x])^n/(b*d*n) /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 + b^2, 0]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -1/d*Subst[Int[(a^2 + b^2 - x^2)^((n - 1)/2), x], x, b*Cos[c + d*x] - a*Sin[c + d*x]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && IGtQ[(n - 1)/2, 0]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -(b*Cos[c + d*x] - a*Sin[c + d*x])*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d* n) + (n - 1)*(a^2 + b^2)/n* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && Not[IntegerQ[(n - 1)/2]] && GtQ[n, 1]
Int[1/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := -1/d*Subst[Int[1/(a^2 + b^2 - x^2), x], x, b*Cos[c + d*x] - a*Sin[c + d*x]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[1/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^2, x_Symbol] := Sin[c + d*x]/(a*d*(a*Cos[c + d*x] + b*Sin[c + d*x])) /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := (b*Cos[c + d*x] - a*Sin[c + d*x])*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/(d*(n + 1)*(a^2 + b^2)) + (n + 2)/((n + 1)*(a^2 + b^2))* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := (a^2 + b^2)^(n/2)*Int[(Cos[c + d*x - ArcTan[a, b]])^n, x] /; FreeQ[{a, b, c, d, n}, x] && Not[GeQ[n, 1] || LeQ[n, -1]] && GtQ[a^2 + b^2, 0]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := (a*Cos[c + d*x] + b*Sin[c + d*x])^ n/((a*Cos[c + d*x] + b*Sin[c + d*x])/Sqrt[a^2 + b^2])^n* Int[Cos[c + d*x - ArcTan[a, b]]^n, x] /; FreeQ[{a, b, c, d, n}, x] && Not[GeQ[n, 1] || LeQ[n, -1]] && Not[GtQ[a^2 + b^2, 0] || EqQ[a^2 + b^2, 0]]
Int[sin[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -a*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1)* Sin[c + d*x]^(n - 1)) + 2*b* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/ Sin[c + d*x]^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[cos[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := b*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1)* Cos[c + d*x]^(n - 1)) + 2*a* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/ Cos[c + d*x]^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[sin[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := a*(a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*b*d*n*Sin[c + d*x]^n) + 1/(2*b)* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/ Sin[c + d*x]^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && LtQ[n, 0]
Int[cos[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -b*(a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*a*d*n*Cos[c + d*x]^n) + 1/(2*a)* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/ Cos[c + d*x]^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && LtQ[n, 0]
Int[sin[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := a*(a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*b*d*n*Sin[c + d*x]^n)* Hypergeometric2F1[1, n, n + 1, (b + a*Cot[c + d*x])/(2*b)] /; FreeQ[{a, b, c, d, n}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && Not[IntegerQ[n]]
Int[cos[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -b*(a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*a*d*n*Cos[c + d*x]^n)* Hypergeometric2F1[1, n, n + 1, (a + b*Tan[c + d*x])/(2*a)] /; FreeQ[{a, b, c, d, n}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && Not[IntegerQ[n]]
Int[sin[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_., x_Symbol] := Int[(b + a*Cot[c + d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && IntegerQ[n] && NeQ[a^2 + b^2, 0]
Int[cos[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_., x_Symbol] := Int[(a + b*Tan[c + d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && IntegerQ[n] && NeQ[a^2 + b^2, 0]
Int[sin[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := 1/d*Subst[Int[x^m*(a + b*x)^n/(1 + x^2)^((m + n + 2)/2), x], x, Tan[c + d*x]] /; FreeQ[{a, b, c, d}, x] && IntegerQ[n] && IntegerQ[(m + n)/2] && NeQ[n, -1] && Not[GtQ[n, 0] && GtQ[m, 1]]
Int[cos[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -1/d*Subst[Int[x^m*(b + a*x)^n/(1 + x^2)^((m + n + 2)/2), x], x, Cot[c + d*x]] /; FreeQ[{a, b, c, d}, x] && IntegerQ[n] && IntegerQ[(m + n)/2] && NeQ[n, -1] && Not[GtQ[n, 0] && GtQ[m, 1]]
Int[sin[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_., x_Symbol] := Int[ExpandTrig[sin[c + d*x]^m*(a*cos[c + d*x] + b*sin[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[m] && IGtQ[n, 0]
Int[cos[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_., x_Symbol] := Int[ExpandTrig[cos[c + d*x]^m*(a*cos[c + d*x] + b*sin[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[m] && IGtQ[n, 0]
Int[sin[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := a^n*b^n* Int[Sin[c + d*x]^m*(b*Cos[c + d*x] + a*Sin[c + d*x])^(-n), x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, 0]
Int[cos[c_. + d_.*x_]^ m_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := a^n*b^n* Int[Cos[c + d*x]^m*(b*Cos[c + d*x] + a*Sin[c + d*x])^(-n), x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, 0]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_/ sin[c_. + d_.*x_], x_Symbol] := a*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1)) + b*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + a^2* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2)/Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_/ cos[c_. + d_.*x_], x_Symbol] := -b*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1)) + a*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + b^2* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2)/Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[sin[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -(a^2 + b^2)* Int[Sin[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] + 2*b* Int[Sin[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + a^2* Int[Sin[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[n, 1] && LtQ[m, -1]
Int[cos[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := -(a^2 + b^2)* Int[Cos[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] + 2*a* Int[Cos[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + b^2* Int[Cos[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[n, 1] && LtQ[m, -1]
Int[sin[c_. + d_.*x_]/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := b*x/(a^2 + b^2) - a/(a^2 + b^2)* Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[cos[c_. + d_.*x_]/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := a*x/(a^2 + b^2) + b/(a^2 + b^2)* Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[sin[c_. + d_.*x_]^ m_/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := -a*Sin[c + d*x]^(m - 1)/(d*(a^2 + b^2)*(m - 1)) + b/(a^2 + b^2)*Int[Sin[c + d*x]^(m - 1), x] + a^2/(a^2 + b^2)* Int[Sin[c + d*x]^(m - 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[m, 1]
Int[cos[c_. + d_.*x_]^ m_/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := b*Cos[c + d*x]^(m - 1)/(d*(a^2 + b^2)*(m - 1)) + a/(a^2 + b^2)*Int[Cos[c + d*x]^(m - 1), x] + b^2/(a^2 + b^2)* Int[Cos[c + d*x]^(m - 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[m, 1]
Int[1/(sin[ c_. + d_.*x_]*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])), x_Symbol] := 1/a*Int[Cot[c + d*x], x] - 1/a* Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[1/(cos[ c_. + d_.*x_]*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])), x_Symbol] := 1/b*Int[Tan[c + d*x], x] + 1/b* Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[sin[c_. + d_.*x_]^ m_/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := Sin[c + d*x]^(m + 1)/(a*d*(m + 1)) - b/a^2*Int[Sin[c + d*x]^(m + 1), x] + (a^2 + b^2)/a^2* Int[Sin[c + d*x]^(m + 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[m, -1]
Int[cos[c_. + d_.*x_]^ m_/(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := -Cos[c + d*x]^(m + 1)/(b*d*(m + 1)) - a/b^2*Int[Cos[c + d*x]^(m + 1), x] + (a^2 + b^2)/b^2* Int[Cos[c + d*x]^(m + 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[m, -1]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_/ sin[c_. + d_.*x_], x_Symbol] := -(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/(a*d*(n + 1)) - b/a^2*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + 1/a^2* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2)/Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_/ cos[c_. + d_.*x_], x_Symbol] := (a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1)) - a/b^2*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + 1/b^2* Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2)/Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[sin[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := (a^2 + b^2)/a^2* Int[Sin[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^n, x] - 2*b/a^2* Int[Sin[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + 1/a^2* Int[Sin[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1] && LtQ[m, -1]
Int[cos[c_. + d_.*x_]^ m_*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_, x_Symbol] := (a^2 + b^2)/b^2* Int[Cos[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^n, x] - 2*a/b^2* Int[Cos[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + 1/b^2* Int[Cos[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1] && LtQ[m, -1]
Int[cos[c_. + d_.*x_]^m_.* sin[c_. + d_.*x_]^ n_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^p_., x_Symbol] := Int[ExpandTrig[ cos[c + d*x]^m*sin[c + d*x]^n*(a*cos[c + d*x] + b*sin[c + d*x])^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0]
Int[cos[c_. + d_.*x_]^m_.* sin[c_. + d_.*x_]^ n_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^p_, x_Symbol] := a^p*b^p* Int[Cos[c + d*x]^m* Sin[c + d*x]^n*(b*Cos[c + d*x] + a*Sin[c + d*x])^(-p), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a^2 + b^2, 0] && ILtQ[p, 0]
Int[cos[c_. + d_.*x_]^m_.* sin[c_. + d_.*x_]^ n_./(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := b/(a^2 + b^2)*Int[Cos[c + d*x]^m*Sin[c + d*x]^(n - 1), x] + a/(a^2 + b^2)*Int[Cos[c + d*x]^(m - 1)*Sin[c + d*x]^n, x] - a*b/(a^2 + b^2)* Int[Cos[c + d*x]^(m - 1)* Sin[c + d*x]^(n - 1)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0] && IGtQ[n, 0]
Int[cos[c_. + d_.*x_]^m_.* sin[c_. + d_.*x_]^ n_./(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_]), x_Symbol] := Int[ExpandTrig[ cos[c + d*x]^m*sin[c + d*x]^n/(a*cos[c + d*x] + b*sin[c + d*x]), x], x] /; FreeQ[{a, b, c, d, m, n}, x] && IntegersQ[m, n]
Int[cos[c_. + d_.*x_]^m_.* sin[c_. + d_.*x_]^ n_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^p_, x_Symbol] := b/(a^2 + b^2)* Int[Cos[c + d*x]^m* Sin[c + d*x]^(n - 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(p + 1), x] + a/(a^2 + b^2)* Int[Cos[c + d*x]^(m - 1)* Sin[c + d*x]^n*(a*Cos[c + d*x] + b*Sin[c + d*x])^(p + 1), x] - a*b/(a^2 + b^2)* Int[Cos[c + d*x]^(m - 1)* Sin[c + d*x]^(n - 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0] && IGtQ[n, 0] && ILtQ[p, 0]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.6 (a+b cos+c sin)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.6 (a+b cos+c sin)^n *)
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := -2*(c*Cos[d + e*x] - b*Sin[d + e*x])/(e* Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := -(c*Cos[d + e*x] - b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)/(e*n) + a*(2*n - 1)/n* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0] && GtQ[n, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := -(c - a*Sin[d + e*x])/(c*e*(c*Cos[d + e*x] - b*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := Int[1/Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := (c*Cos[d + e*x] - b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(2*n + 1)) + (n + 1)/(a*(2*n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0] && LtQ[n, -1]
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := b/(c*e)* Subst[Int[Sqrt[a + x]/x, x], x, b*Cos[d + e*x] + c*Sin[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[b^2 + c^2, 0]
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := Int[Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 + c^2, 0] && GtQ[a + Sqrt[b^2 + c^2], 0]
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/ Sqrt[(a + b*Cos[d + e*x] + c*Sin[d + e*x])/(a + Sqrt[b^2 + c^2])]* Int[ Sqrt[a/(a + Sqrt[b^2 + c^2]) + Sqrt[b^2 + c^2]/(a + Sqrt[b^2 + c^2])* Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[b^2 + c^2, 0] && Not[GtQ[a + Sqrt[b^2 + c^2], 0]]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := -(c*Cos[d + e*x] - b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)/(e*n) + 1/n* Int[Simp[ n*a^2 + (n - 1)*(b^2 + c^2) + a*b*(2*n - 1)*Cos[d + e*x] + a*c*(2*n - 1)*Sin[d + e*x], x]* (a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && GtQ[n, 1]
(* Int[1/(a_+b_.*cos[d_.+e_.*x_]+c_.*sin[d_.+e_.*x_]),x_Symbol] := x/Sqrt[a^2-b^2-c^2] + 2/(e*Sqrt[a^2-b^2-c^2])*ArcTan[(c*Cos[d+e*x]-b*Sin[d+e*x])/(a+Sqrt[ a^2-b^2-c^2]+b*Cos[d+e*x]+c*Sin[d+e*x])] /; FreeQ[{a,b,c,d,e},x] && GtQ[a^2-b^2-c^2,0] *)
(* Int[1/(a_+b_.*cos[d_.+e_.*x_]+c_.*sin[d_.+e_.*x_]),x_Symbol] := Log[RemoveContent[b^2+c^2+(a*b-c*Rt[-a^2+b^2+c^2,2])*Cos[d+e*x]+(a* c+b*Sqrt[-a^2+b^2+c^2])*Sin[d+e*x],x]]/ (2*e*Rt[-a^2+b^2+c^2,2]) - Log[RemoveContent[b^2+c^2+(a*b+c*Rt[-a^2+b^2+c^2,2])*Cos[d+e*x]+(a* c-b*Sqrt[-a^2+b^2+c^2])*Sin[d+e*x],x]]/ (2*e*Rt[-a^2+b^2+c^2,2]) /; FreeQ[{a,b,c,d,e},x] && LtQ[a^2-b^2-c^2,0] *)
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := Module[{f = FreeFactors[Cot[(d + e*x)/2], x]}, -f/e*Subst[Int[1/(a + c*f*x), x], x, Cot[(d + e*x)/2]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a + b, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := Module[{f = FreeFactors[Tan[(d + e*x)/2 + Pi/4], x]}, f/e*Subst[Int[1/(a + b*f*x), x], x, Tan[(d + e*x)/2 + Pi/4]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a + c, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := Module[{f = FreeFactors[Cot[(d + e*x)/2 + Pi/4], x]}, -f/e* Subst[Int[1/(a + b*f*x), x], x, Cot[(d + e*x)/2 + Pi/4]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a - c, 0] && NeQ[a - b, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := Module[{f = FreeFactors[Tan[(d + e*x)/2], x]}, 2*f/e* Subst[Int[1/(a + b + 2*c*f*x + (a - b)*f^2*x^2), x], x, Tan[(d + e*x)/2]/f]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := b/(c*e)* Subst[Int[1/(x*Sqrt[a + x]), x], x, b*Cos[d + e*x] + c*Sin[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[b^2 + c^2, 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := Int[1/Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 + c^2, 0] && GtQ[a + Sqrt[b^2 + c^2], 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := Sqrt[(a + b*Cos[d + e*x] + c*Sin[d + e*x])/(a + Sqrt[b^2 + c^2])]/ Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]* Int[ 1/Sqrt[a/(a + Sqrt[b^2 + c^2]) + Sqrt[b^2 + c^2]/(a + Sqrt[b^2 + c^2])* Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[b^2 + c^2, 0] && Not[GtQ[a + Sqrt[b^2 + c^2], 0]]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^(3/2), x_Symbol] := 2*(c*Cos[d + e*x] - b*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)* Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]) + 1/(a^2 - b^2 - c^2)* Int[Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := (-c*Cos[d + e*x] + b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a*(n + 1) - b*(n + 2)*Cos[d + e*x] - c*(n + 2)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && LtQ[n, -1] && NeQ[n, -3/2]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := (2*a*A - b*B - c*C)* x/(2*a^2) - (b*B + c*C)*(b*Cos[d + e*x] - c*Sin[d + e*x])/(2*a*b*c*e) + (a^2*(b*B - c*C) - 2*a*A*b^2 + b^2*(b*B + c*C))* Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2* b*c*e) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[b^2 + c^2, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := (2*a*A - c*C)*x/(2*a^2) - C*Cos[d + e*x]/(2*a*e) + c*C*Sin[d + e*x]/(2*a*b*e) + (-a^2*C + 2*a*c*A + b^2*C)* Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2* b*e) /; FreeQ[{a, b, c, d, e, A, C}, x] && EqQ[b^2 + c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := (2*a*A - b*B)*x/(2*a^2) - b*B*Cos[d + e*x]/(2*a*c*e) + B*Sin[d + e*x]/(2*a*e) + (a^2*B - 2*a*b*A + b^2*B)* Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2* c*e) /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 + c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := (b*B + c*C)*x/(b^2 + c^2) + (c*B - b*C)* Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*(b*B + c*C), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := c*C*x/(b^2 + c^2) - b*C*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := b*B*x/(b^2 + c^2) + c*B*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := (b*B + c*C)*x/(b^2 + c^2) + (c*B - b*C)* Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) + (A*(b^2 + c^2) - a*(b*B + c*C))/(b^2 + c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*(b*B + c*C), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := c*C*(d + e*x)/(e*(b^2 + c^2)) - b*C*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) + (A*(b^2 + c^2) - a*c*C)/(b^2 + c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol] := b*B*(d + e*x)/(e*(b^2 + c^2)) + c*B*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) + (A*(b^2 + c^2) - a*b*B)/(b^2 + c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) /; FreeQ[{a, b, c, d, e, A, B, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[(b*B + c*C)*n + a*A*(n + 1), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := -(b*C + a*C*Cos[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) /; FreeQ[{a, b, c, d, e, A, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[c*C*n + a*A*(n + 1), 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (B*c + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[b*B*n + a*A*(n + 1), 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + ((b*B + c*C)*n + a*A*(n + 1))/(a*(n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, B, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[(b*B + c*C)*n + a*A*(n + 1), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := -(b*C + a*C*Cos[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + (c*C*n + a*A*(n + 1))/(a*(n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[c*C*n + a*A*(n + 1), 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (B*c + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + (b*B*n + a*A*(n + 1))/(a*(n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[b*B*n + a*A*(n + 1), 0]
Int[(B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (c*B - b*C)*(b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(b^2 + c^2)) /; FreeQ[{b, c, d, e, B, C}, x] && NeQ[n, -1] && NeQ[b^2 + c^2, 0] && EqQ[b*B + c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + 1/(a*(n + 1))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)* Simp[a*(b*B + c*C)*n + a^2*A*(n + 1) + (n*(a^2*B - B*c^2 + b*c*C) + a*b*A*(n + 1))* Cos[d + e*x] + (n*(b*B*c + a^2*C - b^2*C) + a*c*A*(n + 1))* Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := -(b*C + a*C*Cos[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + 1/(a*(n + 1))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)* Simp[a*c*C*n + a^2*A*(n + 1) + (c*b*C*n + a*b*A*(n + 1))* Cos[d + e*x] + (a^2*C*n - b^2*C*n + a*c*A*(n + 1))* Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, C}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol] := (B*c + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + 1/(a*(n + 1))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)* Simp[a*b*B*n + a^2*A*(n + 1) + (a^2*B*n - c^2*B*n + a*b*A*(n + 1))* Cos[d + e*x] + (b*c*B*n + a*c*A*(n + 1))*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/ Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol] := B/b*Int[Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] + (A*b - a*B)/b* Int[1/Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[B*c - b*C, 0] && NeQ[A*b - a*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol] := (c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/ (e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - b*B - c*C, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol] := -(b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol] := (c*B + c*A*Cos[d + e*x] + (a*B - b*A)* Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol] := (c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/ (e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + (a*A - b*B - c*C)/(a^2 - b^2 - c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - b*B - c*C, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol] := -(b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + (a*A - c*C)/(a^2 - b^2 - c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol] := (c*B + c*A*Cos[d + e*x] + (a*B - b*A)* Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + (a*A - b*B)/(a^2 - b^2 - c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := -(c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/ (e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)* Simp[(n + 1)*(a*A - b*B - c*C) + (n + 2)*(a*B - b*A)* Cos[d + e*x] + (n + 2)*(a*C - c*A)*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := (b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/ (e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)* Simp[(n + 1)*(a*A - c*C) - (n + 2)*b*A* Cos[d + e*x] + (n + 2)*(a*C - c*A)*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, C}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol] := -(c*B + c*A*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/ (e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)* Simp[(n + 1)*(a*A - b*B) + (n + 2)*(a*B - b*A)* Cos[d + e*x] - (n + 2)*c*A*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[1/(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]), x_Symbol] := Int[Cos[d + e*x]/(b + a*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[1/(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]), x_Symbol] := Int[Sin[d + e*x]/(b + a*Sin[d + e*x] + c*Cos[d + e*x]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[cos[d_. + e_.*x_]^ n_.*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^n_., x_Symbol] := Int[(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[n]
Int[sin[d_. + e_.*x_]^ n_.*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^n_., x_Symbol] := Int[(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[n]
Int[cos[d_. + e_.*x_]^ n_*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^n_, x_Symbol] := Cos[d + e*x]^ n*(a + b*Sec[d + e*x] + c*Tan[d + e*x])^ n/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n* Int[(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[sin[d_. + e_.*x_]^ n_*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^n_, x_Symbol] := Sin[d + e*x]^ n*(a + b*Csc[d + e*x] + c*Cot[d + e*x])^ n/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n* Int[(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[sec[d_. + e_.*x_]^ n_.*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^m_, x_Symbol] := Int[1/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && IntegerQ[n]
Int[csc[d_. + e_.*x_]^ n_.*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^m_, x_Symbol] := Int[1/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && IntegerQ[n]
Int[sec[d_. + e_.*x_]^ n_.*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^m_, x_Symbol] := Sec[d + e*x]^ n*(b + a*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a + b*Sec[d + e*x] + c*Tan[d + e*x])^n* Int[1/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && Not[IntegerQ[n]]
Int[csc[d_. + e_.*x_]^ n_.*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^m_, x_Symbol] := Csc[d + e*x]^ n*(b + a*Sin[d + e*x] + c*Cos[d + e*x])^ n/(a + b*Csc[d + e*x] + c*Cot[d + e*x])^n* Int[1/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && Not[IntegerQ[n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.7 (d trig)^m (a+b (c sin)^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.7 (d trig)^m (a+b (c sin)^n)^p *)
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol] := (4*A*(2*a + b) + B*(4*a + 3*b))*x/8 - (4*A*b + B*(4*a + 3*b))*Cos[e + f*x]*Sin[e + f*x]/(8*f) - b*B*Cos[e + f*x]*Sin[e + f*x]^3/(4*f) /; FreeQ[{a, b, e, f, A, B}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol] := -B*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^p/(2*f*(p + 1)) + 1/(2*(p + 1))*Int[(a + b*Sin[e + f*x]^2)^(p - 1)* Simp[a*B + 2*a*A*(p + 1) + (2*A*b*(p + 1) + B*(b + 2*a*p + 2*b*p))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && GtQ[p, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_]^2)/(a_ + b_.*sin[e_. + f_.*x_]^2), x_Symbol] := B*x/b + (A*b - a*B)/b*Int[1/(a + b*Sin[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B}, x]
Int[(A_. + B_.*sin[e_. + f_.*x_]^2)/ Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol] := B/b*Int[Sqrt[a + b*Sin[e + f*x]^2], x] + (A*b - a*B)/b* Int[1/Sqrt[a + b*Sin[e + f*x]^2], x] /; FreeQ[{a, b, e, f, A, B}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol] := -(A*b - a*B)*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^(p + 1)/(2*a* f*(a + b)*(p + 1)) - 1/(2*a*(a + b)*(p + 1))*Int[(a + b*Sin[e + f*x]^2)^(p + 1)* Simp[a*B - A*(2*a*(p + 1) + b*(2*p + 3)) + 2*(A*b - a*B)*(p + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && LtQ[p, -1] && NeQ[a + b, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_]^2)^ p_*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^2)^ p*(Sec[e + f*x]^2)^p/(f*(a + (a + b)*Tan[e + f*x]^2)^p)* Subst[ Int[(a + (a + b)*ff^2*x^2)^ p*(A + (A + B)*ff^2*x^2)/(1 + ff^2*x^2)^(p + 2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, A, B}, x] && Not[IntegerQ[p]]
Int[u_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol] := a^p*Int[ActivateTrig[u*cos[e + f*x]^(2*p)], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0] && IntegerQ[p]
Int[u_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol] := Int[ActivateTrig[u*(a*cos[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol] := Sqrt[a]/f*EllipticE[e + f*x, -b/a] /; FreeQ[{a, b, e, f}, x] && GtQ[a, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol] := Sqrt[a + b*Sin[e + f*x]^2]/Sqrt[1 + b*Sin[e + f*x]^2/a]* Int[Sqrt[1 + (b*Sin[e + f*x]^2)/a], x] /; FreeQ[{a, b, e, f}, x] && Not[GtQ[a, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^2, x_Symbol] := (8*a^2 + 8*a*b + 3*b^2)*x/8 - b*(8*a + 3*b)*Cos[e + f*x]*Sin[e + f*x]/(8*f) - b^2*Cos[e + f*x]*Sin[e + f*x]^3/(4*f) /; FreeQ[{a, b, e, f}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol] := -b*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^(p - 1)/(2*f*p) + 1/(2*p)* Int[(a + b*Sin[e + f*x]^2)^(p - 2)* Simp[a*(b + 2*a*p) + b*(2*a + b)*(2*p - 1)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0] && GtQ[p, 1]
Int[1/(a_ + b_.*sin[e_. + f_.*x_]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[1/(a + (a + b)*ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x]
Int[1/Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol] := 1/(Sqrt[a]*f)*EllipticF[e + f*x, -b/a] /; FreeQ[{a, b, e, f}, x] && GtQ[a, 0]
Int[1/Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol] := Sqrt[1 + b*Sin[e + f*x]^2/a]/Sqrt[a + b*Sin[e + f*x]^2]* Int[1/Sqrt[1 + (b*Sin[e + f*x]^2)/a], x] /; FreeQ[{a, b, e, f}, x] && Not[GtQ[a, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol] := -b*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^(p + 1)/(2*a* f*(p + 1)*(a + b)) + 1/(2*a*(p + 1)*(a + b))* Int[(a + b*Sin[e + f*x]^2)^(p + 1)* Simp[2*a*(p + 1) + b*(2*p + 3) - 2*b*(p + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0] && LtQ[p, -1]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[(a + b*ff^2*x^2)^p/Sqrt[1 - ff^2*x^2], x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && Not[IntegerQ[p]]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[x^m*(a + b*ff^2*x^2)^p/Sqrt[1 - ff^2*x^2], x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && Not[IntegerQ[p]]
Int[(d_.*sin[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff* d^(2*IntPart[(m - 1)/2] + 1)*(d*Sin[e + f*x])^(2* FracPart[(m - 1)/2])/(f*(Sin[e + f*x]^2)^ FracPart[(m - 1)/2])* Subst[ Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[cos[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && Not[IntegerQ[p]]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*d^(2*IntPart[(m - 1)/2] + 1)*(d*Cos[e + f*x])^(2* FracPart[(m - 1)/2])/(f*(Cos[e + f*x]^2)^ FracPart[(m - 1)/2])* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, ff^((m + 1)/2)/(2*f)* Subst[Int[x^((m - 1)/2)*(a + b*ff*x)^p/(1 - ff*x)^((m + 1)/2), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^ m*(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p]
Int[tan[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[ Int[x^m*(a + b*ff^2*x^2)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && Not[IntegerQ[p]]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*(d*Tan[e + f*x])^(m + 1)*(Cos[e + f*x]^2)^((m + 1)/2)/(d*f* Sin[e + f*x]^(m + 1))* Subst[ Int[(ff*x)^m*(a + b*ff^2*x^2)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[cos[e_. + f_.*x_]^m_.*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^ p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(m - 1)/2]
Int[(c_.*sin[e_. + f_.*x_])^m_* sin[e_. + f_.*x_]^n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(c*ff*x)^ m*(1 - ff^2*x^2)^((n - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, m, p}, x] && IntegerQ[(n - 1)/2]
Int[cos[e_. + f_.*x_]^m_* sin[e_. + f_.*x_]^n_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(n + 1)/f* Subst[Int[ x^n*(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^((m + n)/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^ p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[m/2]
Int[(c_.*cos[e_. + f_.*x_])^m_*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*c^(2*IntPart[(m - 1)/2] + 1)*(c*Cos[e + f*x])^(2* FracPart[(m - 1)/2])/(f*(Cos[e + f*x]^2)^ FracPart[(m - 1)/2])* Subst[ Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol] := -Cot[e + f*x]*(b*Sin[e + f*x]^2)^p/(2*f*p) + b*(2*p - 1)/(2*p)*Int[(b*Sin[e + f*x]^2)^(p - 1), x] /; FreeQ[{b, e, f}, x] && Not[IntegerQ[p]] && GtQ[p, 1]
Int[(b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol] := Cot[e + f*x]*(b*Sin[e + f*x]^2)^(p + 1)/(b*f*(2*p + 1)) + 2*(p + 1)/(b*(2*p + 1))*Int[(b*Sin[e + f*x]^2)^(p + 1), x] /; FreeQ[{b, e, f}, x] && Not[IntegerQ[p]] && LtQ[p, -1]
Int[tan[e_. + f_.*x_]^m_.*(b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, ff^((m + 1)/2)/(2*f)* Subst[Int[ x^((m - 1)/2)*(b*ff^(n/2)*x^(n/2))^p/(1 - ff*x)^((m + 1)/2), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[tan[e_. + f_.*x_]^m_.*(b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[x^m*(b*(c*ff*x)^n)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{b, c, e, f, n, p}, x] && ILtQ[(m - 1)/2, 0]
Int[u_.*(b_.*sin[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (b*ff^n)^ IntPart[p]*(b*Sin[e + f*x]^n)^ FracPart[p]/(Sin[e + f*x]/ff)^(n*FracPart[p])* Int[ActivateTrig[u]*(Sin[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] && Not[IntegerQ[p]] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[u_.*(b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_, x_Symbol] := b^IntPart[p]*(b*(c*Sin[e + f*x])^n)^ FracPart[p]/(c*Sin[e + f*x])^(n*FracPart[p])* Int[ActivateTrig[u]*(c*Sin[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] && Not[IntegerQ[p]] && Not[IntegerQ[n]] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
(* Int[(a_+b_.*sin[e_.+f_.*x_]^4)^p_.,x_Symbol] := With[{ff=FreeFactors[Tan[e+f*x],x]}, -ff/f*Subst[Int[(a+b+2*a*ff^2*x^2+a*ff^4*x^4)^p/(1+ff^2*x^2)^(2*p+1) ,x],x,Cot[e+f*x]/ff]] /; FreeQ[{a,b,e,f},x] && IntegerQ[p] *)
Int[(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[p]
Int[(a_ + b_.*sin[e_. + f_.*x_]^4)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^4)^ p*(Sec[e + f*x]^2)^(2* p)/(f*(a + 2*a*Tan[e + f*x]^2 + (a + b)*Tan[e + f*x]^4)^p)* Subst[ Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[p - 1/2]
Int[1/(a_ + b_.*sin[e_. + f_.*x_]^n_), x_Symbol] := Module[{k}, Dist[2/(a*n), Sum[Int[1/(1 - Sin[e + f*x]^2/((-1)^(4*k/n)*Rt[-a/b, n/2])), x], {k, 1, n/2}], x]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[n/2]
(* Int[(a_+b_.*sin[e_.+f_.*x_]^n_)^p_,x_Symbol] := With[{ff=FreeFactors[Tan[e+f*x],x]}, -ff/f*Subst[Int[(b+a*(1+ff^2*x^2)^(n/2))^p/(1+ff^2*x^2)^(n*p/2+1),x] ,x,Cot[e+f*x]/ff]] /; FreeQ[{a,b,e,f},x] && IntegerQ[n/2] && IGtQ[p,0] *)
Int[(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^ p/(1 + ff^2*x^2)^(n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[n/2] && IGtQ[p, 0]
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_, x_Symbol] := Int[ExpandTrig[(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, e, f, n}, x] && (IGtQ[p, 0] || EqQ[p, -1] && IntegerQ[n])
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_, x_Symbol] := Unintegrable[(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - 2*b*ff^2*x^2 + b*ff^4*x^4)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*(1 - ff^2*x^2)^(n/2))^ p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*(a*(1 + ff^2*x^2)^(n/2) + b*ff^n*x^n)^ p/(1 + ff^2*x^2)^(m/2 + n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)*(a + b*Sin[e + f*x]^4)^ p*(Sec[e + f*x]^2)^(2*p)/(f* Apart[a*(1 + Tan[e + f*x]^2)^2 + b*Tan[e + f*x]^4]^p)* Subst[ Int[x^m*ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^ p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[p - 1/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := Int[ExpandTrig[sin[e + f*x]^m*(a + b*sin[e + f*x]^n)^p, x], x] /; FreeQ[{a, b, e, f}, x] && IntegersQ[m, p] && (EqQ[n, 4] || GtQ[p, 0] || EqQ[p, -1] && IntegerQ[n])
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[cos[e_. + f_.*x_]^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*(c*ff*x)^n)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (EqQ[n, 4] || GtQ[m, 0] || IGtQ[p, 0] || IntegersQ[m, p])
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^ p/(1 + ff^2*x^2)^(m/2 + n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_/(a_ + b_.*sin[e_. + f_.*x_]^n_), x_Symbol] := Int[Expand[(1 - Sin[e + f*x]^2)^(m/2)/(a + b*Sin[e + f*x]^n), x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m/2, 0] && IntegerQ[(n - 1)/2]
(* Int[cos[e_.+f_.*x_]^m_*(a_+b_.*sin[e_.+f_.*x_]^n_)^p_,x_Symbol] := Int[ExpandTrig[(1-sin[e+f*x]^2)^(m/2)*(a+b*sin[e+f*x]^n)^p,x],x] /; FreeQ[{a,b,e,f},x] && IntegerQ[m/2] && IntegerQ[(n-1)/2] &&  ILtQ[p,-1] && LtQ[m,0] *)
Int[(d_.*cos[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Int[ExpandTrig[(d*cos[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*cos[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Cos[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, ff^((m + 1)/2)/(2*f)* Subst[Int[ x^((m - 1)/2)*(a + b*ff^(n/2)*x^(n/2))^p/(1 - ff*x)^((m + 1)/2), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[x^m*(a + b*(c*ff*x)^n)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && ILtQ[(m - 1)/2, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^m* ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^4)^ p*(Sec[e + f*x]^2)^(2*p)/(f* Apart[a*(1 + Tan[e + f*x]^2)^2 + b*Tan[e + f*x]^4]^p)* Subst[ Int[(d*ff*x)^m* ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p - 1/2]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[(d*x)^ m*(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^ p/(1 + ff^2*x^2)^(n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[n/2] && IGtQ[p, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Int[ExpandTrig[(d*tan[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*cot[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^FracPart[m]* Int[(Tan[e + f*x]/d)^(-m)*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Sec[e + f*x])^FracPart[m]*(Cos[e + f*x]/d)^FracPart[m]* Int[(Cos[e + f*x]/d)^(-m)*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_.)^p_., x_Symbol] := d^(n*p)* Int[(d*Csc[e + f*x])^(m - n*p)*(b + a*Csc[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && IntegersQ[n, p]
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]* Int[(Sin[e + f*x]/d)^(-m)*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_] + d_.*cos[e_. + f_.*x_])^2)^p_, x_Symbol] := Int[(a + b*(Sqrt[c^2 + d^2]*Sin[ArcTan[c, d] + e + f*x])^2)^p, x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[p^2, 1/4] && GtQ[a, 0]
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_] + d_.*cos[e_. + f_.*x_])^2)^p_, x_Symbol] := (a + b*(c*Sin[e + f*x] + d*Cos[e + f*x])^2)^ p/(1 + (b*(c*Sin[e + f*x] + d*Cos[e + f*x])^2)/a)^p* Int[(1 + (b*(c*Sin[e + f*x] + d*Cos[e + f*x])^2)/a)^p, x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[p^2, 1/4] && Not[GtQ[a, 0]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.8 trig^m (a+b cos^p+c sin^q)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.8 trig^m (a+b cos^p+c sin^q)^n *)
Int[sin[d_. + e_.*x_]^ m_*(a_ + b_.*cos[d_. + e_.*x_]^p_ + c_.*sin[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f/e* Subst[Int[ ExpandToSum[ c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*q/2 + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[cos[d_. + e_.*x_]^ m_*(a_ + b_.*sin[d_. + e_.*x_]^p_ + c_.*cos[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f/e* Subst[Int[ ExpandToSum[ c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*q/2 + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[sin[d_. + e_.*x_]^ m_*(a_ + b_.*cos[d_. + e_.*x_]^p_ + c_.*sin[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f/e* Subst[Int[ ExpandToSum[ a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*p/2 + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]
Int[cos[d_. + e_.*x_]^ m_*(a_ + b_.*sin[d_. + e_.*x_]^p_ + c_.*cos[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f/e* Subst[Int[ ExpandToSum[ a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*p/2 + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]
Int[sin[d_. + e_.*x_]^ m_*(a_ + b_.*cos[d_. + e_.*x_]^p_ + c_.*sin[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f/e* Subst[Int[ ExpandToSum[ c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*q/2 + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[cos[d_. + e_.*x_]^ m_*(a_ + b_.*sin[d_. + e_.*x_]^p_ + c_.*cos[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f/e* Subst[Int[ ExpandToSum[ c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*q/2 + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[sin[d_. + e_.*x_]^ m_*(a_ + b_.*cos[d_. + e_.*x_]^p_ + c_.*sin[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f/e* Subst[Int[ ExpandToSum[ a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*p/2 + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]
Int[cos[d_. + e_.*x_]^ m_*(a_ + b_.*sin[d_. + e_.*x_]^p_ + c_.*cos[d_. + e_.*x_]^q_)^n_, x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f/e* Subst[Int[ ExpandToSum[ a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^ n/(1 + f^2*x^2)^(m/2 + n*p/2 + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.1 Sine/4.1.9 trig^m (a+b sin^n+c sin^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.1.9 trig^m (a+b sin^n+c sin^(2 n))^p *)
Int[(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^ p/(b + 2*c*Sin[d + e*x]^n)^(2*p)* Int[u*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^ p/(b + 2*c*Cos[d + e*x]^n)^(2*p)* Int[u*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[1/(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Sin[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Sin[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Cos[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Cos[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Sin[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Cos[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^ p/(b + 2*c*Sin[d + e*x]^n)^(2*p)* Int[Sin[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^ p/(b + 2*c*Cos[d + e*x]^n)^(2*p)* Int[Cos[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_ + c_.*sin[d_. + e_.*x_]^n2_)^ p_, x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f/e* Subst[Int[ ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^ p/(1 + f^2*x^2)^(m/2 + n*p + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_ + c_.*cos[d_. + e_.*x_]^n2_)^ p_, x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f/e* Subst[Int[ ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^ p/(1 + f^2*x^2)^(m/2 + n*p + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := Int[ExpandTrig[ sin[d + e*x]^m*(a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[m, n, p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := Int[ExpandTrig[ cos[d + e*x]^m*(a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[m, n, p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*(f_.*sin[d_. + e_.*x_])^n_. + c_.*(f_.*sin[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p, x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*(f_.*cos[d_. + e_.*x_])^n_. + c_.*(f_.*cos[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p, x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[Cos[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[Sin[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_, x_Symbol] := (a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^ p/(b + 2*c*Sin[d + e*x]^n)^(2*p)* Int[Cos[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_, x_Symbol] := (a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^ p/(b + 2*c*Cos[d + e*x]^n)^(2*p)* Int[Sin[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_ + c_.*sin[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^ p/(1 + f^2*x^2)^(m/2 + n*p + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_ + c_.*cos[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^ p/(1 + f^2*x^2)^(m/2 + n*p + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Int[ExpandTrig[(1 - sin[d + e*x]^2)^(m/2)*(a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Int[ExpandTrig[(1 - cos[d + e*x]^2)^(m/2)*(a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*(f_.*sin[d_. + e_.*x_])^n_ + c_.*(f_.*sin[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g^(m + 1)/e* Subst[Int[ x^m*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^ p/(1 - g^2*x^2)^((m + 1)/2), x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*(f_.*cos[d_. + e_.*x_])^n_ + c_.*(f_.*cos[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g^(m + 1)/e* Subst[Int[ x^m*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^ p/(1 - g^2*x^2)^((m + 1)/2), x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[tan[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[Tan[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[Cot[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_, x_Symbol] := (a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^ p/(b + 2*c*Sin[d + e*x]^n)^(2*p)* Int[Tan[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cot[d_. + e_.*x_]^ m_*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_, x_Symbol] := (a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^ p/(b + 2*c*Cos[d + e*x]^n)^(2*p)* Int[Cot[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_ + c_.*sin[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[ c*x^(2*n) + b*x^n*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^ p/(1 + f^2*x^2)^(n*p + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_ + c_.*cos[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[ c*x^(2*n) + b*x^n*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^ p/(1 + f^2*x^2)^(n*p + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Int[ExpandTrig[ sin[d + e*x]^ m*(a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^ p/(1 - sin[d + e*x]^2)^(m/2), x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Int[ExpandTrig[ cos[d + e*x]^ m*(a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^ p/(1 - cos[d + e*x]^2)^(m/2), x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*(f_.*sin[d_. + e_.*x_])^n_ + c_.*(f_.*sin[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g^(m + 1)/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/ 2)*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p/x^m, x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*(f_.*cos[d_. + e_.*x_])^n_ + c_.*(f_.*cos[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g^(m + 1)/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/ 2)*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p/x^m, x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[cot[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[Cot[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[Tan[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^ p_, x_Symbol] := (a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^ p/(b + 2*c*Sin[d + e*x]^n)^(2*p)* Int[Cot[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[tan[d_. + e_.*x_]^ m_*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^ p_, x_Symbol] := (a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^ p/(b + 2*c*Cos[d + e*x]^n)^(2*p)* Int[Tan[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && Not[IntegerQ[(m - 1)/2]] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*sin[d_. + e_.*x_]^n_ + c_.*sin[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[c + b*(1 + f^2*x^2)^(n/2) + a*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(n*p + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*cos[d_. + e_.*x_]^n_ + c_.*cos[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[c + b*(1 + f^2*x^2)^(n/2) + a*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(n*p + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] && IntegerQ[n/2] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*sin[d_. + e_.*x_]^n_. + c_.*sin[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Int[ExpandTrig[(1 - sin[d + e*x]^2)^(m/ 2)*(a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p/ sin[d + e*x]^m, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cos[d_. + e_.*x_]^n_. + c_.*cos[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Int[ExpandTrig[(1 - cos[d + e*x]^2)^(m/ 2)*(a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p/ cos[d + e*x]^m, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[(A_ + B_.*sin[d_. + e_.*x_])*(a_ + b_.*sin[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Sin[d + e*x])*(b + 2*c*Sin[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*cos[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Cos[d + e*x])*(b + 2*c*Cos[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*sin[d_. + e_.*x_])*(a_ + b_.*sin[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Sin[d + e*x] + c*Sin[d + e*x]^2)^ n/(b + 2*c*Sin[d + e*x])^(2*n)* Int[(A + B*Sin[d + e*x])*(b + 2*c*Sin[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*cos[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Cos[d + e*x] + c*Cos[d + e*x]^2)^ n/(b + 2*c*Cos[d + e*x])^(2*n)* Int[(A + B*Cos[d + e*x])*(b + 2*c*Cos[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*sin[d_. + e_.*x_])/(a_. + b_.*sin[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Sin[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Sin[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*cos[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Cos[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Cos[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*sin[d_. + e_.*x_])*(a_. + b_.*sin[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*sin[d + e*x])*(a + b*sin[d + e*x] + c*sin[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*cos[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*cos[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*cos[d + e*x])*(a + b*cos[d + e*x] + c*cos[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.1.1 (a+b tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.1.1 (a+b tan)^n *)
Int[(b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := b*(b*Tan[c + d*x])^(n - 1)/(d*(n - 1)) - b^2*Int[(b*Tan[c + d*x])^(n - 2), x] /; FreeQ[{b, c, d}, x] && GtQ[n, 1]
Int[(b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := (b*Tan[c + d*x])^(n + 1)/(b*d*(n + 1)) - 1/b^2*Int[(b*Tan[c + d*x])^(n + 2), x] /; FreeQ[{b, c, d}, x] && LtQ[n, -1]
Int[tan[c_. + d_.*x_], x_Symbol] := -Log[RemoveContent[Cos[c + d*x], x]]/d /; FreeQ[{c, d}, x]
(* Int[1/tan[c_.+d_.*x_],x_Symbol] := Log[RemoveContent[Sin[c+d*x],x]]/d /; FreeQ[{c,d},x] *)
Int[(b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := b/d*Subst[Int[x^n/(b^2 + x^2), x], x, b*Tan[c + d*x]] /; FreeQ[{b, c, d, n}, x] && Not[IntegerQ[n]]
Int[(a_ + b_.*tan[c_. + d_.*x_])^2, x_Symbol] := (a^2 - b^2)*x + b^2*Tan[c + d*x]/d + 2*a*b*Int[Tan[c + d*x], x] /; FreeQ[{a, b, c, d}, x]
(* Int[(a_+b_.*tan[c_.+d_.*x_])^n_,x_Symbol] := Int[ExpandIntegrand[(a+b*Tan[c+d*x])^n,x],x] /; FreeQ[{a,b,c,d},x] && IGtQ[n,0] *)
Int[(a_ + b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := b*(a + b*Tan[c + d*x])^(n - 1)/(d*(n - 1)) + 2*a*Int[(a + b*Tan[c + d*x])^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[(a_ + b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := a*(a + b*Tan[c + d*x])^n/(2*b*d*n) + 1/(2*a)*Int[(a + b*Tan[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, 0]
Int[Sqrt[a_ + b_.*tan[c_. + d_.*x_]], x_Symbol] := -2*b/d*Subst[Int[1/(2*a - x^2), x], x, Sqrt[a + b*Tan[c + d*x]]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 + b^2, 0]
Int[(a_ + b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := -b/d*Subst[Int[(a + x)^(n - 1)/(a - x), x], x, b*Tan[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 + b^2, 0]
Int[(a_ + b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := b*(a + b*Tan[c + d*x])^(n - 1)/(d*(n - 1)) + Int[(a^2 - b^2 + 2*a*b*Tan[c + d*x])*(a + b*Tan[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[(a_ + b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := b*(a + b*Tan[c + d*x])^(n + 1)/(d*(n + 1)*(a^2 + b^2)) + 1/(a^2 + b^2)* Int[(a - b*Tan[c + d*x])*(a + b*Tan[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[1/(a_ + b_.*tan[c_. + d_.*x_]), x_Symbol] := a*x/(a^2 + b^2) + b/(a^2 + b^2)*Int[(b - a*Tan[c + d*x])/(a + b*Tan[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[(a_ + b_.*tan[c_. + d_.*x_])^n_, x_Symbol] := b/d*Subst[Int[(a + x)^n/(b^2 + x^2), x], x, b*Tan[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 + b^2, 0]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.1.2 (d sec)^m (a+b tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.1.2 (d sec)^m (a+b tan)^n *)
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := b*(d*Sec[e + f*x])^m/(f*m) + a*Int[(d*Sec[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, m}, x] && (IntegerQ[2*m] || NeQ[a^2 + b^2, 0])
Int[sec[e_. + f_.*x_]^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := 1/(a^(m - 2)*b*f)* Subst[Int[(a - x)^(m/2 - 1)*(a + x)^(n + m/2 - 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, n}, x] && EqQ[a^2 + b^2, 0] && IntegerQ[m/2]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^n/(a*f*m) /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && EqQ[Simplify[m + n], 0]
Int[sec[e_. + f_.*x_]/Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := -2*a/(b*f)* Subst[Int[1/(2 - a*x^2), x], x, Sec[e + f*x]/Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^n/(a*f*m) + a/(2*d^2)* Int[(d*Sec[e + f*x])^(m + 2)*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && EqQ[m/2 + n, 0] && GtQ[n, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := 2*d^2*(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1)/(b* f*(m - 2)) + 2*d^2/a* Int[(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && EqQ[m/2 + n, 0] && LtQ[n, -1]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (a/d)^(2*IntPart[n])*(a + b*Tan[e + f*x])^ FracPart[n]*(a - b*Tan[e + f*x])^ FracPart[n]/(d*Sec[e + f*x])^(2*FracPart[n])* Int[1/(a - b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && EqQ[Simplify[m/2 + n], 0]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := 2*b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1)/(f*m) /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && EqQ[Simplify[m/2 + n - 1], 0]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1)/(f*(m + n - 1)) + a*(m + 2*n - 2)/(m + n - 1)* Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && IGtQ[Simplify[m/2 + n - 1], 0] && Not[IntegerQ[n]]
Int[Sqrt[d_.*sec[e_. + f_.*x_]]*Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := -4*b*d^2/f* Subst[Int[x^2/(a^2 + d^2*x^4), x], x, Sqrt[a + b*Tan[e + f*x]]/Sqrt[d*Sec[e + f*x]]] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := 2*b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1)/(f*m) - b^2*(m + 2*n - 2)/(d^2*m)* Int[(d*Sec[e + f*x])^(m + 2)*(a + b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 1] && (IGtQ[n/2, 0] && ILtQ[m - 1/2, 0] || EqQ[n, 2] && LtQ[m, 0] || LeQ[m, -1] && GtQ[m + n, 0] || ILtQ[m, 0] && LtQ[m/2 + n - 1, 0] && IntegerQ[n] || EqQ[n, 3/2] && EqQ[m, -1/2]) && IntegerQ[2*m]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^n/(a*f*m) + a*(m + n)/(m*d^2)* Int[(d*Sec[e + f*x])^(m + 2)*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1)/(f*(m + n - 1)) + a*(m + 2*n - 2)/(m + n - 1)* Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 0] && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[(d_.*sec[e_. + f_.*x_])^(3/2)/Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := d*Sec[e + f*x]/(Sqrt[a - b*Tan[e + f*x]]*Sqrt[a + b*Tan[e + f*x]])* Int[Sqrt[d*Sec[e + f*x]]*Sqrt[a - b*Tan[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := 2*d^2*(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1)/(b* f*(m + 2*n)) - d^2*(m - 2)/(b^2*(m + 2*n))* Int[(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, -1] && (ILtQ[n/2, 0] && IGtQ[m - 1/2, 0] || EqQ[n, -2] || IGtQ[m + n, 0] || IntegersQ[n, m + 1/2] && GtQ[2*m + n + 1, 0]) && IntegerQ[2*m]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := d^2*(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1)/(b* f*(m + n - 1)) + d^2*(m - 2)/(a*(m + n - 1))* Int[(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, 0] && GtQ[m, 1] && Not[ILtQ[m + n, 0]] && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^n/(b*f*(m + 2*n)) + Simplify[m + n]/(a*(m + 2*n))* Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, 0] && NeQ[m + 2*n, 0] && IntegersQ[2*m, 2*n]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(d*Sec[e + f*x])^ m*(a + b*Tan[e + f*x])^(n - 1)/(f*Simplify[m + n - 1]) + a*(m + 2*n - 2)/Simplify[m + n - 1]* Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && IGtQ[Simplify[m + n - 1], 0] && RationalQ[n]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^n/(b*f*(m + 2*n)) + Simplify[m + n]/(a*(m + 2*n))* Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && ILtQ[Simplify[m + n], 0] && NeQ[m + 2*n, 0]
(* Int[(d_.*sec[e_.+f_.*x_])^m_.*(a_+b_.*tan[e_.+f_.*x_])^n_,x_Symbol]  := a^n*(d*Sec[e+f*x])^m/(b*f*(Sec[e+f*x]^2)^(m/2))*Subst[Int[(1+x/a)^( n+m/2-1)*(1-x/a)^(m/2-1),x],x,b*Tan[e+f*x]] /; FreeQ[{a,b,d,e,f,m},x] && EqQ[a^2+b^2,0] && IntegerQ[n] *)
(* Int[(d_.*sec[e_.+f_.*x_])^m_.*(a_+b_.*tan[e_.+f_.*x_])^n_,x_Symbol]  := (d*Sec[e+f*x])^m/(b*f*(Sec[e+f*x]^2)^(m/2))*Subst[Int[(a+x)^n*(1+x^ 2/b^2)^(m/2-1),x],x,b*Tan[e+f*x]] /; FreeQ[{a,b,d,e,f,m,n},x] && EqQ[a^2+b^2,0] *)
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := (d*Sec[e + f*x])^ m/((a + b*Tan[e + f*x])^(m/2)*(a - b*Tan[e + f*x])^(m/2))* Int[(a + b*Tan[e + f*x])^(m/2 + n)*(a - b*Tan[e + f*x])^(m/2), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0]
Int[sec[e_. + f_.*x_]^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := 1/(b*f)* Subst[Int[(a + x)^n*(1 + x^2/b^2)^(m/2 - 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, n}, x] && NeQ[a^2 + b^2, 0] && IntegerQ[m/2]
Int[(a_ + b_.*tan[e_. + f_.*x_])^2/sec[e_. + f_.*x_], x_Symbol] := b^2*ArcTanh[Sin[e + f*x]]/f - 2*a*b*Cos[e + f*x]/f + (a^2 - b^2)*Sin[e + f*x]/f /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^2, x_Symbol] := b*(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])/(f*(m + 1)) + 1/(m + 1)* Int[(d*Sec[e + f*x])^ m*(a^2*(m + 1) - b^2 + a*b*(m + 2)*Tan[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 + b^2, 0] && NeQ[m, -1]
Int[sec[e_. + f_.*x_]/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := -1/f*Subst[Int[1/(a^2 + b^2 - x^2), x], x, (b - a*Tan[e + f*x])/Sec[e + f*x]] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := -d^2/b^2*Int[(d*Sec[e + f*x])^(m - 2)*(a - b*Tan[e + f*x]), x] + d^2*(a^2 + b^2)/b^2* Int[(d*Sec[e + f*x])^(m - 2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 1]
Int[(d_.*sec[e_. + f_.*x_])^m_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(a^2 + b^2)*Int[(d*Sec[e + f*x])^m*(a - b*Tan[e + f*x]), x] + b^2/(d^2*(a^2 + b^2))* Int[(d*Sec[e + f*x])^(m + 2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 + b^2, 0] && ILtQ[m, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := d^(2*IntPart[m/2])*(d*Sec[e + f*x])^(2*FracPart[m/2])/(b* f*(Sec[e + f*x]^2)^FracPart[m/2])* Subst[Int[(a + x)^n*(1 + x^2/b^2)^(m/2 - 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 + b^2, 0] && Not[IntegerQ[m/2]]
Int[Sqrt[a_ + b_.*tan[e_. + f_.*x_]]/Sqrt[d_. cos[e_. + f_.*x_]], x_Symbol] := -4*b/f* Subst[Int[x^2/(a^2*d^2 + x^4), x], x, Sqrt[d*Cos[e + f*x]]*Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[1/((d_. cos[e_. + f_.*x_])^(3/2)* Sqrt[a_ + b_.*tan[e_. + f_.*x_]]), x_Symbol] := 1/(d*Cos[e + f*x]*Sqrt[a - b*Tan[e + f*x]]* Sqrt[a + b*Tan[e + f*x]])* Int[Sqrt[a - b*Tan[e + f*x]]/Sqrt[d*Cos[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := (d*Cos[e + f*x])^m*(d*Sec[e + f*x])^m* Int[(a + b*Tan[e + f*x])^n/(d*Sec[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.1.3 (d sin)^m (a+b tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.1.3 (d sin)^m (a+b tan)^n *)
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b/f*Subst[Int[x^m*(a + x)^n/(b^2 + x^2)^(m/2 + 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, n}, x] && IntegerQ[m/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := Int[Expand[Sin[e + f*x]^m*(a + b*Tan[e + f*x])^n, x], x] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IGtQ[n, 0]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := Int[Sin[e + f*x]^m*(a*Cos[e + f*x] + b*Sin[e + f*x])^n/ Cos[e + f*x]^n, x] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && ILtQ[n, 0] && (LtQ[m, 5] && GtQ[n, -4] || EqQ[m, 5] && EqQ[n, -1])
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_. + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]* Int[(a + b*Tan[e + f*x])^n/(Sin[e + f*x]/d)^m, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && Not[IntegerQ[m]]
Int[cos[e_. + f_.*x_]^m_.* sin[e_. + f_.*x_]^p_.*(a_ + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := Int[Cos[e + f*x]^(m - n)* Sin[e + f*x]^p*(a*Cos[e + f*x] + b*Sin[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, p}, x] && IntegerQ[n]
Int[sin[e_. + f_.*x_]^m_.* cos[e_. + f_.*x_]^p_.*(a_ + b_.*cot[e_. + f_.*x_])^n_., x_Symbol] := Int[Sin[e + f*x]^(m - n)* Cos[e + f*x]^p*(a*Sin[e + f*x] + b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, p}, x] && IntegerQ[n]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.10 (c+d x)^m (a+b tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.10 (c+d x)^m (a+b tan)^n *)
Int[(c_. + d_.*x_)^m_.*tan[e_. + k_.*Pi + f_.*Complex[0, fz_]*x_], x_Symbol] := -I*(c + d*x)^(m + 1)/(d*(m + 1)) + 2*I*Int[(c + d*x)^m*E^(-2*I*k*Pi)* E^(2*(-I*e + f*fz*x))/(1 + E^(-2*I*k*Pi)*E^(2*(-I*e + f*fz*x))), x] /; FreeQ[{c, d, e, f, fz}, x] && IntegerQ[4*k] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*tan[e_. + k_.*Pi + f_.*x_], x_Symbol] := I*(c + d*x)^(m + 1)/(d*(m + 1)) - 2*I*Int[(c + d*x)^m*E^(2*I*k*Pi)* E^(2*I*(e + f*x))/(1 + E^(2*I*k*Pi)*E^(2*I*(e + f*x))), x] /; FreeQ[{c, d, e, f}, x] && IntegerQ[4*k] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*tan[e_. + f_.*Complex[0, fz_]*x_], x_Symbol] := -I*(c + d*x)^(m + 1)/(d*(m + 1)) + 2*I*Int[(c + d*x)^m* E^(2*(-I*e + f*fz*x))/(1 + E^(2*(-I*e + f*fz*x))), x] /; FreeQ[{c, d, e, f, fz}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*tan[e_. + f_.*x_], x_Symbol] := I*(c + d*x)^(m + 1)/(d*(m + 1)) - 2*I*Int[(c + d*x)^m*E^(2*I*(e + f*x))/(1 + E^(2*I*(e + f*x))), x] /; FreeQ[{c, d, e, f}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(c + d*x)^m*(b*Tan[e + f*x])^(n - 1)/(f*(n - 1)) - b*d*m/(f*(n - 1))* Int[(c + d*x)^(m - 1)*(b*Tan[e + f*x])^(n - 1), x] - b^2*Int[(c + d*x)^m*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (c + d*x)^m*(b*Tan[e + f*x])^(n + 1)/(b*f*(n + 1)) - d*m/(b*f*(n + 1))* Int[(c + d*x)^(m - 1)*(b*Tan[e + f*x])^(n + 1), x] - 1/b^2*Int[(c + d*x)^m*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*Tan[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := (c + d*x)^(m + 1)/(2*a*d*(m + 1)) - a*(c + d*x)^m/(2*b*f*(a + b*Tan[e + f*x])) + a*d*m/(2*b*f)*Int[(c + d*x)^(m - 1)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && GtQ[m, 0]
Int[1/((c_. + d_.*x_)^2*(a_ + b_.*tan[e_. + f_.*x_])), x_Symbol] := -1/(d*(c + d*x)*(a + b*Tan[e + f*x])) + f/(b*d)*Int[Cos[2*e + 2*f*x]/(c + d*x), x] - f/(a*d)*Int[Sin[2*e + 2*f*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)^m_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := f*(c + d*x)^(m + 2)/(b*d^2*(m + 1)*(m + 2)) + (c + d*x)^(m + 1)/(d*(m + 1)*(a + b*Tan[e + f*x])) + 2*b*f/(a*d*(m + 1))* Int[(c + d*x)^(m + 1)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && LtQ[m, -1] && NeQ[m, -2]
(* Int[(c_.+d_.*x_)^m_/(a_+b_.*tan[e_.+f_.*x_]),x_Symbol] := (c+d*x)^(m+1)/(d*(m+1)*(a+b*Tan[e+f*x])) + f/(b*d*(m+1))*Int[(c+d*x)^(m+1),x] + 2*b*f/(a*d*(m+1))*Int[(c+d*x)^(m+1)/(a+b*Tan[e+f*x]),x] /; FreeQ[{a,b,c,d,e,f},x] && EqQ[a^2+b^2,0] && LtQ[m,-1] *)
Int[1/((c_. + d_.*x_)*(a_ + b_.*tan[e_. + f_.*x_])), x_Symbol] := Log[c + d*x]/(2*a*d) + 1/(2*a)*Int[Cos[2*e + 2*f*x]/(c + d*x), x] + 1/(2*b)*Int[Sin[2*e + 2*f*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)^m_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := (c + d*x)^(m + 1)/(2*a*d*(m + 1)) + 1/(2*a)*Int[(c + d*x)^m*E^(2*a/b*(e + f*x)), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && Not[IntegerQ[m]]
Int[(c_. + d_.*x_)^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(c + d*x)^ m, (1/(2*a) + Cos[2*e + 2*f*x]/(2*a) + Sin[2*e + 2*f*x]/(2*b))^(-n), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && ILtQ[m, 0] && ILtQ[n, 0]
Int[(c_. + d_.*x_)^m_*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(c + d*x)^ m, (1/(2*a) + E^(2*a/b*(e + f*x))/(2*a))^(-n), x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, 0]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := With[{u = IntHide[(a + b*Tan[e + f*x])^n, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[Dist[(c + d*x)^(m - 1), u, x], x]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, -1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*tan[e_. + k_.*Pi + f_.*x_]), x_Symbol] := (c + d*x)^(m + 1)/(d*(m + 1)*(a + I*b)) + 2*I*b* Int[(c + d*x)^m*E^(2*I*k*Pi)* E^Simp[2*I*(e + f*x), x]/((a + I*b)^2 + (a^2 + b^2)*E^(2*I*k*Pi)* E^Simp[2*I*(e + f*x), x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IntegerQ[4*k] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_./(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := (c + d*x)^(m + 1)/(d*(m + 1)*(a + I*b)) + 2*I*b* Int[(c + d*x)^m* E^Simp[2*I*(e + f*x), x]/((a + I*b)^2 + (a^2 + b^2)*E^Simp[2*I*(e + f*x), x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)/(a_ + b_.*tan[e_. + f_.*x_])^2, x_Symbol] := -(c + d*x)^2/(2*d*(a^2 + b^2)) - b*(c + d*x)/(f*(a^2 + b^2)*(a + b*Tan[e + f*x])) + 1/(f*(a^2 + b^2))* Int[(b*d + 2*a*c*f + 2*a*d*f*x)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*tan[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(c + d*x)^ m, (1/(a - I*b) - 2*I*b/(a^2 + b^2 + (a - I*b)^2*E^(2*I*(e + f*x))))^(-n), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0] && ILtQ[n, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)*Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := -Sqrt[2]*b*(c + d*x)* ArcTanh[Sqrt[a + b*Tan[e + f*x]]/(Sqrt[2]*Rt[a, 2])]/(Rt[a, 2]* f) + Sqrt[2]*b*d/(Rt[a, 2]*f)* Int[ArcTanh[Sqrt[a + b*Tan[e + f*x]]/(Sqrt[2]*Rt[a, 2])], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)*Sqrt[a_. + b_.*tan[e_. + f_.*x_]], x_Symbol] := -I*Rt[a - I*b, 2]*(c + d*x)/f* ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a - I*b, 2]] + I*Rt[a + I*b, 2]*(c + d*x)/f* ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a + I*b, 2]] + I*d*Rt[a - I*b, 2]/f* Int[ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a - I*b, 2]], x] - I*d*Rt[a + I*b, 2]/f* Int[ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a + I*b, 2]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)/Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := 1/(2*a)*Int[(c + d*x)*Sqrt[a + b*Tan[e + f*x]], x] + a/2*Int[(c + d*x)*Sec[e + f*x]^2/(a + b*Tan[e + f*x])^(3/2), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)/Sqrt[a_. + b_.*tan[e_. + f_.*x_]], x_Symbol] := -I*(c + d*x)/(f*Rt[a - I*b, 2])* ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a - I*b, 2]] + I*(c + d*x)/(f*Rt[a + I*b, 2])* ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a + I*b, 2]] + I*d/(f*Rt[a - I*b, 2])* Int[ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a - I*b, 2]], x] - I*d/(f*Rt[a + I*b, 2])* Int[ArcTanh[Sqrt[a + b*Tan[e + f*x]]/Rt[a + I*b, 2]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[(c_. + d_.*x_)^m_.*tan[e_. + f_.*x_]^n_., x_Symbol] := If[MatchQ[f, f1_.*Complex[0, j_]], If[MatchQ[e, e1_. + Pi/2], I^n*Unintegrable[(c + d*x)^m*Coth[-I*(e - Pi/2) - I*f*x]^n, x], I^n*Unintegrable[(c + d*x)^m*Tanh[-I*e - I*f*x]^n, x]], If[MatchQ[e, e1_. + Pi/2], (-1)^n*Unintegrable[(c + d*x)^m*Cot[e - Pi/2 + f*x]^n, x], Unintegrable[(c + d*x)^m*Tan[e + f*x]^n, x]]] /; FreeQ[{c, d, e, f, m, n}, x] && IntegerQ[n]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*tan[e_. + f_.*x_])^n_., x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[u_^m_.*(a_. + b_.*Tan[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Tan[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*(a_. + b_.*Cot[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Cot[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.11 (e x)^m (a+b tan(c+d x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.11 (e x)^m (a+b tan(c+d x^n))^p *)
Int[(a_. + b_.*Tan[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Tan[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Cot[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Cot[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Tan[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(a + b*Tan[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Cot[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(a + b*Cot[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Tan[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Tan[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Cot[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Cot[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Tan[u_])^p_., x_Symbol] := Int[(a + b*Tan[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(a_. + b_.*Cot[u_])^p_., x_Symbol] := Int[(a + b*Cot[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*(a_. + b_.*Tan[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Tan[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*(a_. + b_.*Cot[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Cot[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*Tan[c_. + d_.*x_^n_]^2, x_Symbol] := x^(m - n + 1)*Tan[c + d*x^n]/(d*n) - Int[x^m, x] - (m - n + 1)/(d*n)*Int[x^(m - n)*Tan[c + d*x^n], x] /; FreeQ[{c, d, m, n}, x]
Int[x_^m_.*Cot[c_. + d_.*x_^n_]^2, x_Symbol] := -x^(m - n + 1)*Cot[c + d*x^n]/(d*n) - Int[x^m, x] + (m - n + 1)/(d*n)*Int[x^(m - n)*Cot[c + d*x^n], x] /; FreeQ[{c, d, m, n}, x]
(* Int[x_^m_.*Tan[a_.+b_.*x_^n_]^p_,x_Symbol] := x^(m-n+1)*Tan[a+b*x^n]^(p-1)/(b*n*(p-1)) - (m-n+1)/(b*n*(p-1))*Int[x^(m-n)*Tan[a+b*x^n]^(p-1),x] - Int[x^m*Tan[a+b*x^n]^(p-2),x] /; FreeQ[{a,b},x] && LtQ[0,n,m+1] && GtQ[p,1] *)
(* Int[x_^m_.*Cot[a_.+b_.*x_^n_]^p_,x_Symbol] := -x^(m-n+1)*Cot[a+b*x^n]^(p-1)/(b*n*(p-1)) + (m-n+1)/(b*n*(p-1))*Int[x^(m-n)*Cot[a+b*x^n]^(p-1),x] - Int[x^m*Cot[a+b*x^n]^(p-2),x] /; FreeQ[{a,b},x] && LtQ[0,n,m+1] && GtQ[p,1] *)
(* Int[x_^m_.*Tan[a_.+b_.*x_^n_]^p_,x_Symbol] := x^(m-n+1)*Tan[a+b*x^n]^(p+1)/(b*n*(p+1)) - (m-n+1)/(b*n*(p+1))*Int[x^(m-n)*Tan[a+b*x^n]^(p+1),x] - Int[x^m*Tan[a+b*x^n]^(p+2),x] /; FreeQ[{a,b},x] && LtQ[0,n,m+1] && LtQ[p,-1] *)
(* Int[x_^m_.*Cot[a_.+b_.*x_^n_]^p_,x_Symbol] := -x^(m-n+1)*Cot[a+b*x^n]^(p+1)/(b*n*(p+1)) + (m-n+1)/(b*n*(p+1))*Int[x^(m-n)*Cot[a+b*x^n]^(p+1),x] - Int[x^m*Cot[a+b*x^n]^(p+2),x] /; FreeQ[{a,b},x] && LtQ[0,n,m+1] && LtQ[p,-1] *)
Int[x_^m_.*(a_. + b_.*Tan[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[x^m*(a + b*Tan[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[x_^m_.*(a_. + b_.*Cot[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[x^m*(a + b*Cot[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Tan[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Tan[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Cot[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cot[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Tan[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Tan[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(e_*x_)^m_.*(a_. + b_.*Cot[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Cot[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*Sec[a_. + b_.*x_^n_.]^p_.*Tan[a_. + b_.*x_^n_.]^q_., x_Symbol] := x^(m - n + 1)*Sec[a + b*x^n]^p/(b*n*p) - (m - n + 1)/(b*n*p)*Int[x^(m - n)*Sec[a + b*x^n]^p, x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m, n] && EqQ[q, 1]
Int[x_^m_.*Csc[a_. + b_.*x_^n_.]^p_.*Cot[a_. + b_.*x_^n_.]^q_., x_Symbol] := -x^(m - n + 1)*Csc[a + b*x^n]^p/(b*n*p) + (m - n + 1)/(b*n*p)*Int[x^(m - n)*Csc[a + b*x^n]^p, x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m, n] && EqQ[q, 1]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.12 (d+e x)^m tan(a+b x+c x^2)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.12 (d+e x)^m tan(a+b x+c x^2)^n *)
Int[Tan[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[Tan[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Cot[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[Cot[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[(d_ + e_.*x_)*Tan[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := -e*Log[Cos[a + b*x + c*x^2]]/(2*c) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[(d_ + e_.*x_)*Cot[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Log[Sin[a + b*x + c*x^2]]/(2*c) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[(d_. + e_.*x_)*Tan[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := -e*Log[Cos[a + b*x + c*x^2]]/(2*c) + (2*c*d - b*e)/(2*c)*Int[Tan[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[(d_. + e_.*x_)*Cot[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Log[Sin[a + b*x + c*x^2]]/(2*c) + (2*c*d - b*e)/(2*c)*Int[Cot[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
(* Int[x_^m_*Tan[a_.+b_.*x_+c_.*x_^2],x_Symbol] := -x^(m-1)*Log[Cos[a+b*x+c*x^2]]/(2*c) - b/(2*c)*Int[x^(m-1)*Tan[a+b*x+c*x^2],x] + (m-1)/(2*c)*Int[x^(m-2)*Log[Cos[a+b*x+c*x^2]],x] /; FreeQ[{a,b,c},x] && GtQ[m,1] *)
(* Int[x_^m_*Cot[a_.+b_.*x_+c_.*x_^2],x_Symbol] := x^(m-1)*Log[Sin[a+b*x+c*x^2]]/(2*c) - b/(2*c)*Int[x^(m-1)*Cot[a+b*x+c*x^2],x] - (m-1)/(2*c)*Int[x^(m-2)*Log[Sin[a+b*x+c*x^2]],x] /; FreeQ[{a,b,c},x] && GtQ[m,1]*)
Int[(d_. + e_.*x_)^m_.*Tan[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[(d + e*x)^m*Tan[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(d_. + e_.*x_)^m_.*Cot[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Unintegrable[(d + e*x)^m*Cot[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.2.1 (a+b tan)^m (c+d tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.2.1 (a+b tan)^m (c+d tan)^n *)
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_.*(c_ + d_.*tan[e_. + f_.*x_])^n_., x_Symbol] := a^m*c^m*Int[Sec[e + f*x]^(2*m)*(c + d*Tan[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 + b^2, 0] && IntegerQ[m] && Not[IGtQ[n, 0] && (LtQ[m, 0] || GtQ[m, n])]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_ + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*c/f* Subst[Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 + b^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])*(c_ + d_.*tan[e_. + f_.*x_]), x_Symbol] := (a*c - b*d)*x + b*d*Tan[e + f*x]/f /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + a*d, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := (a*c - b*d)*x + b*d*Tan[e + f*x]/f + (b*c + a*d)*Int[Tan[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[b*c + a*d, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := -(b*c - a*d)*(a + b*Tan[e + f*x])^m/(2*a*f*m) + (b*c + a*d)/(2*a*b)*Int[(a + b*Tan[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[m, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := d*(a + b*Tan[e + f*x])^m/(f*m) + (b*c + a*d)/b* Int[(a + b*Tan[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && Not[LtQ[m, 0]]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := d*(a + b*Tan[e + f*x])^m/(f*m) + Int[(a + b*Tan[e + f*x])^(m - 1)* Simp[a*c - b*d + (b*c + a*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && GtQ[m, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)*(a + b*Tan[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 + b^2)) + 1/(a^2 + b^2)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[a*c + b*d - (b*c - a*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && LtQ[m, -1]
Int[(c_ + d_.*tan[e_. + f_.*x_])/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := c/(b*f)*Log[RemoveContent[a*Cos[e + f*x] + b*Sin[e + f*x], x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && EqQ[a*c + b*d, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := (a*c + b*d)*x/(a^2 + b^2) + (b*c - a*d)/(a^2 + b^2)* Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[a*c + b*d, 0]
Int[(c_ + d_.*tan[e_. + f_.*x_])/Sqrt[b_.*tan[e_. + f_.*x_]], x_Symbol] := -2*d^2/f* Subst[Int[1/(2*c*d + b*x^2), x], x, (c - d*Tan[e + f*x])/Sqrt[b*Tan[e + f*x]]] /; FreeQ[{b, c, d, e, f}, x] && EqQ[c^2 - d^2, 0]
(* Int[(c_+d_.*tan[e_.+f_.*x_])/Sqrt[b_.*tan[e_.+f_.*x_]],x_Symbol] := (c+d)/2*Int[(1+Tan[e+f*x])/Sqrt[b*Tan[e+f*x]],x] + (c-d)/2*Int[(1-Tan[e+f*x])/Sqrt[b*Tan[e+f*x]],x] /; FreeQ[{b,c,d,e,f},x] && NeQ[c^2+d^2,0] && NeQ[c^2-d^2,0] *)
Int[(c_ + d_.*tan[e_. + f_.*x_])/Sqrt[b_.*tan[e_. + f_.*x_]], x_Symbol] := 2*c^2/f*Subst[Int[1/(b*c - d*x^2), x], x, Sqrt[b*Tan[e + f*x]]] /; FreeQ[{b, c, d, e, f}, x] && EqQ[c^2 + d^2, 0]
(* Int[(c_+d_.*tan[e_.+f_.*x_])/Sqrt[b_.*tan[e_.+f_.*x_]],x_Symbol] := (c+I*d)/2*Int[(1-I*Tan[e+f*x])/Sqrt[b*Tan[e+f*x]],x] +  (c-I*d)/2*Int[(1+I*Tan[e+f*x])/Sqrt[b*Tan[e+f*x]],x] /; FreeQ[{b,c,d,e,f},x] && NeQ[c^2-d^2,0] && NeQ[c^2+d^2,0] *)
Int[(c_ + d_.*tan[e_. + f_.*x_])/Sqrt[b_.*tan[e_. + f_.*x_]], x_Symbol] := 2/f*Subst[Int[(b*c + d*x^2)/(b^2 + x^4), x], x, Sqrt[b*Tan[e + f*x]]] /; FreeQ[{b, c, d, e, f}, x] && NeQ[c^2 - d^2, 0] && NeQ[c^2 + d^2, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])/Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := -2*d^2/f* Subst[Int[1/(2*b*c*d - 4*a*d^2 + x^2), x], x, (b*c - 2*a*d - b*d*Tan[e + f*x])/Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[2*a*c*d - b*(c^2 - d^2), 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])/Sqrt[a_ + b_.*tan[e_. + f_.*x_]], x_Symbol] := With[{q = Rt[a^2 + b^2, 2]}, 1/(2*q)* Int[(a*c + b*d + c*q + (b*c - a*d + d*q)*Tan[e + f*x])/ Sqrt[a + b*Tan[e + f*x]], x] - 1/(2*q)* Int[(a*c + b*d - c*q + (b*c - a*d - d*q)*Tan[e + f*x])/ Sqrt[a + b*Tan[e + f*x]], x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && NeQ[2*a*c*d - b*(c^2 - d^2), 0] && (PerfectSquareQ[a^2 + b^2] || RationalQ[a, b, c, d])
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_ + d_.*tan[e_. + f_.*x_]), x_Symbol] := c*d/f*Subst[Int[(a + b/d*x)^m/(d^2 + c*x), x], x, d*Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && EqQ[c^2 + d^2, 0]
Int[(b_.*tan[e_. + f_.*x_])^m_*(c_ + d_.*tan[e_. + f_.*x_]), x_Symbol] := c*Int[(b*Tan[e + f*x])^m, x] + d/b*Int[(b*Tan[e + f*x])^(m + 1), x] /; FreeQ[{b, c, d, e, f, m}, x] && NeQ[c^2 + d^2, 0] && Not[IntegerQ[2*m]]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := (c + I*d)/2*Int[(a + b*Tan[e + f*x])^m*(1 - I*Tan[e + f*x]), x] + (c - I*d)/2*Int[(a + b*Tan[e + f*x])^m*(1 + I*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && Not[IntegerQ[m]]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^2, x_Symbol] := -b*(a*c + b*d)^2*(a + b*Tan[e + f*x])^m/(2*a^3*f*m) + 1/(2*a^2)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[a*c^2 - 2*b*c*d + a*d^2 - 2*b*d^2*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LeQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])^2/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := d*(2*b*c - a*d)*x/b^2 + d^2/b*Int[Tan[e + f*x], x] + (b*c - a*d)^2/b^2* Int[1/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^2, x_Symbol] := (b*c - a*d)^2*(a + b*Tan[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 + b^2)) + 1/(a^2 + b^2)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[a*c^2 + 2*b*c*d - a*d^2 - (b*c^2 - 2*a*c*d - b*d^2)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^2, x_Symbol] := d^2*(a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)) + Int[(a + b*Tan[e + f*x])^m* Simp[c^2 - d^2 + 2*c*d*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && Not[LeQ[m, -1]] && Not[EqQ[m, 2] && EqQ[a, 0]]
Int[Sqrt[a_ + b_.*tan[e_. + f_.*x_]]/ Sqrt[c_. + d_.*tan[e_. + f_.*x_]], x_Symbol] := -2*a*b/f* Subst[Int[1/(a*c - b*d - 2*a^2*x^2), x], x, Sqrt[c + d*Tan[e + f*x]]/Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*b*(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)/(f*(m - 1)*(a*c - b*d)) + 2*a^2/(a*c - b*d)* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n, 0] && GtQ[m, 1/2]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n/(2*b*f*m) - (a*c - b*d)/(2*b^2)* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n, 0] && LeQ[m, -1/2]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d)) + 1/(2*a)* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n + 1, 0] && LtQ[m, -1]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := -d*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(f*m*(c^2 + d^2)) + a/(a*c - b*d)* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n + 1, 0] && Not[LtQ[m, -1]]
Int[(c_. + d_.*tan[e_. + f_.*x_])^n_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := -(a*c + b*d)*(c + d*Tan[e + f*x])^ n/(2*(b*c - a*d)*f*(a + b*Tan[e + f*x])) + 1/(2*a*(b*c - a*d))* Int[(c + d*Tan[e + f*x])^(n - 1)* Simp[a*c*d*(n - 1) + b*c^2 + b*d^2*n - d*(b*c - a*d)*(n - 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[0, n, 1]
Int[(c_. + d_.*tan[e_. + f_.*x_])^n_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)*(c + d*Tan[e + f*x])^(n - 1)/(2*a*f*(a + b*Tan[e + f*x])) + 1/(2*a^2)* Int[(c + d*Tan[e + f*x])^(n - 2)* Simp[a*c^2 + a*d^2*(n - 1) - b*c*d*n - d*(a*c*(n - 2) + b*d*n)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[n, 1]
Int[1/((a_. + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])), x_Symbol] := b/(b*c - a*d)*Int[1/(a + b*Tan[e + f*x]), x] - d/(b*c - a*d)*Int[1/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])^n_/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := -a*(c + d*Tan[e + f*x])^(n + 1)/(2* f*(b*c - a*d)*(a + b*Tan[e + f*x])) + 1/(2*a*(b*c - a*d))* Int[(c + d*Tan[e + f*x])^n* Simp[b*c + a*d*(n - 1) - b*d*n*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && Not[GtQ[n, 0]]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := -a^2*(b*c - a*d)*(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(b*c + a*d)*(n + 1)) + a/(d*(b*c + a*d)*(n + 1))* Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)* Simp[b*(b*c*(m - 2) - a*d*(m - 2*n - 4)) + (a*b*c*(m - 2) + b^2*d*(n + 1) - a^2*d*(m + n - 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && LtQ[n, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*tan[e_. + f_.*x_])^(3/2)/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := 2*a^2/(a*c - b*d)*Int[Sqrt[a + b*Tan[e + f*x]], x] - (2*b*c*d + a*(c^2 - d^2))/(a*(c^2 + d^2))* Int[(a - b*Tan[e + f*x])* Sqrt[a + b*Tan[e + f*x]]/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^(3/2)/ Sqrt[c_. + d_.*tan[e_. + f_.*x_]], x_Symbol] := 2*a*Int[Sqrt[a + b*Tan[e + f*x]]/Sqrt[c + d*Tan[e + f*x]], x] + b/a* Int[(b + a*Tan[e + f*x])* Sqrt[a + b*Tan[e + f*x]]/Sqrt[c + d*Tan[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b^2*(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)/(d* f*(m + n - 1)) + a/(d*(m + n - 1))* Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^n* Simp[b*c*(m - 2) + a*d*(m + 2*n) + (a*c*(m - 2) + b*d*(3*m + 2*n - 4))* Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && IntegerQ[2*m] && GtQ[m, 1] && NeQ[m + n - 1, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*Sqrt[c_. + d_.*tan[e_. + f_.*x_]], x_Symbol] := -b*(a + b*Tan[e + f*x])^m*Sqrt[c + d*Tan[e + f*x]]/(2*a*f*m) + 1/(4*a^2*m)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[2*a*c*m + b*d + a*d*(2*m + 1)*Tan[e + f*x], x]/ Sqrt[c + d*Tan[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, 0] && IntegersQ[2*m]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := -(b*c - a*d)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n - 1)/(2*a*f*m) + 1/(2*a^2*m)* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 2)* Simp[c*(a*c*m + b*d*(n - 1)) - d*(b*c*m + a*d*(n - 1)) - d*(b*d*(m - n + 1) - a*c*(m + n - 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, 0] && GtQ[n, 1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d)) + 1/(2*a*m*(b*c - a*d))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[b*c*m - a*d*(2*m + n + 1) + b*d*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := d*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n - 1)/(f*(m + n - 1)) - 1/(a*(m + n - 1))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n - 2)* Simp[d*(b*c*m + a*d*(-1 + n)) - a*c^2*(m + n - 1) + d*(b*d*m - a*c*(m + 2*n - 2))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[n, 1] && NeQ[m + n - 1, 0] && (IntegerQ[n] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := d*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 + d^2)) - 1/(a*(c^2 + d^2)*(n + 1))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)* Simp[b*d*m - a*c*(n + 1) + a*d*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1] && (IntegerQ[n] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := a/(a*c - b*d)*Int[(a + b*Tan[e + f*x])^m, x] - d/(a*c - b*d)* Int[(a + b*Tan[e + f*x])^ m*(b + a*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[a_ + b_.*tan[e_. + f_.*x_]]* Sqrt[c_. + d_.*tan[e_. + f_.*x_]], x_Symbol] := (a*c - b*d)/a* Int[Sqrt[a + b*Tan[e + f*x]]/Sqrt[c + d*Tan[e + f*x]], x] + d/a* Int[Sqrt[a + b*Tan[e + f*x]]*(b + a*Tan[e + f*x])/ Sqrt[c + d*Tan[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := a*b/f* Subst[Int[(a + x)^(m - 1)*(c + d/b*x)^n/(b^2 + a*x), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (b*c - a*d)^2*(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2)) - 1/(d*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^(m - 3)*(c + d*Tan[e + f*x])^(n + 1)* Simp[a^2*d*(b*d*(m - 2) - a*c*(n + 1)) + b*(b*c - 2*a*d)*(b*c*(m - 2) + a*d*(n + 1)) - d*(n + 1)*(3*a^2*b*c - b^3*c - a^3*d + 3*a*b^2*d)* Tan[e + f*x] - b*(a*d*(2*b*c - a*d)*(m + n - 1) - b^2*(c^2*(m - 2) - d^2*(n + 1)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 2] && LtQ[n, -1] && IntegerQ[2*m]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b^2*(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)/(d* f*(m + n - 1)) + 1/(d*(m + n - 1))* Int[(a + b*Tan[e + f*x])^(m - 3)*(c + d*Tan[e + f*x])^n* Simp[a^3*d*(m + n - 1) - b^2*(b*c*(m - 2) + a*d*(1 + n)) + b*d*(m + n - 1)*(3*a^2 - b^2)*Tan[e + f*x] - b^2*(b*c*(m - 2) - a*d*(3*m + 2*n - 4))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && IntegerQ[2*m] && GtQ[m, 2] && (GeQ[n, -1] || IntegerQ[m]) && Not[IGtQ[n, 2] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := (b*c - a*d)*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 + b^2)) + 1/((m + 1)*(a^2 + b^2))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 2)* Simp[a*c^2*(m + 1) + a*d^2*(n - 1) + b*c*d*(m - n + 2) - (b*c^2 - 2*a*c*d - b*d^2)*(m + 1)* Tan[e + f*x] - d*(b*c - a*d)*(m + n)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && IntegerQ[2*m]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^ n/(f*(m + 1)*(a^2 + b^2)) + 1/((m + 1)*(a^2 + b^2))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)* Simp[a*c*(m + 1) - b*d*n - (b*c - a*d)*(m + 1)*Tan[e + f*x] - b*d*(m + n + 1)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && GtQ[n, 0] && IntegerQ[2*m]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b^2*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(a^2 + b^2)*(b*c - a*d)) + 1/((m + 1)*(a^2 + b^2)*(b*c - a*d))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2) - b*(b*c - a*d)*(m + 1)*Tan[e + f*x] - b^2*d*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && IntegerQ[2*m] && LtQ[m, -1] && (LtQ[n, 0] || IntegerQ[m]) && Not[ILtQ[n, -1] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := b*(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^ n/(f*(m + n - 1)) + 1/(m + n - 1)* Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n - 1)* Simp[a^2*c*(m + n - 1) - b*(b*c*(m - 1) + a*d*n) + (2*a*b*c + a^2*d - b^2*d)*(m + n - 1)*Tan[e + f*x] + b*(b*c*n + a*d*(2*m + n - 2))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && GtQ[n, 0] && IntegerQ[2*n]
Int[1/((a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])), x_Symbol] := (a*c - b*d)*x/((a^2 + b^2)*(c^2 + d^2)) + b^2/((b*c - a*d)*(a^2 + b^2))* Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] - d^2/((b*c - a*d)*(c^2 + d^2))* Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[a_. + b_.*tan[e_. + f_.*x_]]/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(c^2 + d^2)* Int[Simp[a*c + b*d + (b*c - a*d)*Tan[e + f*x], x]/ Sqrt[a + b*Tan[e + f*x]], x] - d*(b*c - a*d)/(c^2 + d^2)* Int[(1 + Tan[e + f*x]^2)/(Sqrt[ a + b*Tan[e + f*x]]*(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^(3/2)/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(c^2 + d^2)* Int[Simp[ a^2*c - b^2*c + 2*a*b*d + (2*a*b*c - a^2*d + b^2*d)*Tan[e + f*x], x]/ Sqrt[a + b*Tan[e + f*x]], x] + (b*c - a*d)^2/(c^2 + d^2)* Int[(1 + Tan[e + f*x]^2)/(Sqrt[ a + b*Tan[e + f*x]]*(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(c^2 + d^2)*Int[(a + b*Tan[e + f*x])^m*(c - d*Tan[e + f*x]), x] + d^2/(c^2 + d^2)* Int[(a + b*Tan[e + f*x])^ m*(1 + Tan[e + f*x]^2)/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && Not[IntegerQ[m]]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_ + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + b*ff*x)^m*(c + d*ff*x)^n/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(d_./tan[e_. + f_.*x_])^n_, x_Symbol] := d^m*Int[(b + a*Cot[e + f*x])^m*(d*Cot[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_. + b_.*cot[e_. + f_.*x_])^m_.*(d_./cot[e_. + f_.*x_])^n_, x_Symbol] := d^m*Int[(b + a*Tan[e + f*x])^m*(d*Tan[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(c_.*(d_.*tan[e_. + f_.*x_])^p_)^n_, x_Symbol] := c^IntPart[n]*(c*(d*Tan[e + f*x])^p)^ FracPart[n]/(d*Tan[e + f*x])^(p*FracPart[n])* Int[(a + b*Tan[e + f*x])^m*(d*Tan[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]
Int[(a_. + b_.*cot[e_. + f_.*x_])^ m_.*(c_.*(d_.*cot[e_. + f_.*x_])^p_)^n_, x_Symbol] := c^IntPart[n]*(c*(d*Cot[e + f*x])^p)^ FracPart[n]/(d*Cot[e + f*x])^(p*FracPart[n])* Int[(a + b*Cot[e + f*x])^m*(d*Cot[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.2.3 (g tan)^p (a+b tan)^m (c+d tan)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.2.3 (g tan)^p (a+b tan)^m (c+d tan)^n *)
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*tan[e_. + f_.*x_])^ m_*(c_ + d_.*tan[e_. + f_.*x_])^n_, x_Symbol] := Unintegrable[(g*Tan[e + f*x])^p*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x]
Int[(g_.*cot[e_. + f_.*x_])^p_*(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(c_ + d_.*tan[e_. + f_.*x_])^n_., x_Symbol] := g^(m + n)* Int[(g*Cot[e + f*x])^(p - m - n)*(b + a*Cot[e + f*x])^ m*(d + c*Cot[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && Not[IntegerQ[p]] && IntegerQ[m] && IntegerQ[n]
Int[(g_.*tan[e_. + f_.*x_])^p_*(a_. + b_.*cot[e_. + f_.*x_])^ m_.*(c_ + d_.*cot[e_. + f_.*x_])^n_., x_Symbol] := g^(m + n)* Int[(g*Tan[e + f*x])^(p - m - n)*(b + a*Tan[e + f*x])^ m*(d + c*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && Not[IntegerQ[p]] && IntegerQ[m] && IntegerQ[n]
Int[(g_.*tan[e_. + f_.*x_]^q_)^p_*(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(c_ + d_.*tan[e_. + f_.*x_])^n_., x_Symbol] := (g*Tan[e + f*x]^q)^p/(g*Tan[e + f*x])^(p*q)* Int[(g*Tan[e + f*x])^(p*q)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q}, x] && Not[IntegerQ[p]] && Not[IntegerQ[m] && IntegerQ[n]]
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*tan[e_. + f_.*x_])^ m_.*(c_ + d_.*cot[e_. + f_.*x_])^n_., x_Symbol] := g^n*Int[(g*Tan[e + f*x])^(p - n)*(a + b*Tan[e + f*x])^ m*(d + c*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && IntegerQ[n]
Int[tan[e_. + f_.*x_]^p_.*(a_ + b_.*tan[e_. + f_.*x_])^ m_.*(c_ + d_.*cot[e_. + f_.*x_])^n_, x_Symbol] := Int[(b + a*Cot[e + f*x])^m*(c + d*Cot[e + f*x])^n/ Cot[e + f*x]^(m + p), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m] && IntegerQ[p]
Int[(g_.*tan[e_. + f_.*x_])^p_*(a_ + b_.*tan[e_. + f_.*x_])^ m_.*(c_ + d_.*cot[e_. + f_.*x_])^n_, x_Symbol] := Cot[e + f*x]^p*(g*Tan[e + f*x])^p* Int[(b + a*Cot[e + f*x])^m*(c + d*Cot[e + f*x])^n/ Cot[e + f*x]^(m + p), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && Not[IntegerQ[n]] && IntegerQ[m] && Not[IntegerQ[p]]
Int[(g_.*tan[e_. + f_.*x_])^p_.*(a_ + b_.*tan[e_. + f_.*x_])^ m_*(c_ + d_.*cot[e_. + f_.*x_])^n_, x_Symbol] := (g*Tan[e + f*x])^n*(c + d*Cot[e + f*x])^n/(d + c*Tan[e + f*x])^n* Int[(g*Tan[e + f*x])^(p - n)*(a + b*Tan[e + f*x])^ m*(d + c*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.3.1 (a+b tan)^m (c+d tan)^n (A+B tan).m
*)

(* ::Subsection::Closed:: *)
(* 4.3.3.1 (a+b tan)^m (c+d tan)^n (A+B tan) *)
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_.*(c_ + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := a*c/f* Subst[Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1)*(A + B*x), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 + b^2, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])*(A_. + B_.*tan[e_. + f_.*x_])/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := B*d/b*Int[Tan[e + f*x], x] + 1/b*Int[Simp[A*b*c + (A*b*d + B*(b*c - a*d))*Tan[e + f*x], x]/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^ m_*(c_. + d_.*tan[e_. + f_.*x_])*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := -(A*b - a*B)*(a*c + b*d)*(a + b*Tan[e + f*x])^m/(2*a^2*f*m) + 1/(2*a*b)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[A*b*c + a*B*c + a*A*d + b*B*d + 2*a*B*d*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_*(c_. + d_.*tan[e_. + f_.*x_])*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)*(A*b - a*B)*(a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 + b^2)) + 1/(a^2 + b^2)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[a*A*c + b*B*c + A*b*d - a*B*d - (A*b*c - a*B*c - a*A*d - b*B*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(c_. + d_.*tan[e_. + f_.*x_])*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := B*d*(a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)) + Int[(a + b*Tan[e + f*x])^m* Simp[A*c - B*d + (B*c + A*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && Not[LeQ[m, -1]]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := -a^2*(B*c - A*d)*(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(b*c + a*d)*(n + 1)) - a/(d*(b*c + a*d)*(n + 1))* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)* Simp[A*b*d*(m - n - 2) - B*(b*c*(m - 1) + a*d*(n + 1)) + (a*A*d*(m + n) - B*(a*c*(m - 1) + b*d*(n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && GtQ[m, 1] && LtQ[n, -1]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := b*B*(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)/(d* f*(m + n)) + 1/(d*(m + n))* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^n* Simp[a*A*d*(m + n) + B*(a*c*(m - 1) - b*d*(n + 1)) - (B*(b*c - a*d)*(m - 1) - d*(A*b + a*B)*(m + n))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && GtQ[m, 1] && Not[LtQ[n, -1]]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := -(A*b - a*B)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^n/(2*a*f*m) + 1/(2*a^2*m)* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)* Simp[A*(a*c*m + b*d*n) - B*(b*c*m + a*d*n) - d*(b*B*(m - n) - a*A*(m + n))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[m, 0] && GtQ[n, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (a*A + b*B)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d)) + 1/(2*a*m*(b*c - a*d))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[A*(b*c*m - a*d*(2*m + n + 1)) + B*(a*c*m - b*d*(n + 1)) + d*(A*b - a*B)*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[m, 0] && Not[GtQ[n, 0]]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := B*(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n/(f*(m + n)) + 1/(a*(m + n))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n - 1)* Simp[a*A*c*(m + n) - B*(b*c*m + a*d*n) + (a*A*d*(m + n) - B*(b*d*m - a*c*n))* Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && GtQ[n, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (A*d - B*c)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 + d^2)) - 1/(a*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)* Simp[A*(b*d*m - a*c*(n + 1)) - B*(b*c*m + a*d*(n + 1)) - a*(B*c - A*d)*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := b*B/f* Subst[Int[(a + b*x)^(m - 1)*(c + d*x)^n, x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && EqQ[A*b + a*B, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^ m_*(A_. + B_.*tan[e_. + f_.*x_])/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := (A*b + a*B)/(b*c + a*d)*Int[(a + b*Tan[e + f*x])^m, x] - (B*c - A*d)/(b*c + a*d)* Int[(a + b*Tan[e + f*x])^ m*(a - b*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[A*b + a*B, 0]
(* Int[(a_+b_.*tan[e_.+f_.*x_])^m_*(c_.+d_.*tan[e_.+f_.*x_])^n_*(A_.+ B_.*tan[e_.+f_.*x_]),x_Symbol] := (A*b-a*B)/b*Int[(a+b*Tan[e+f*x])^m*(c+d*Tan[e+f*x])^n,x] + B/b*Int[(a+b*Tan[e+f*x])^(m+1)*(c+d*Tan[e+f*x])^n,x] /; FreeQ[{a,b,c,d,e,f,A,B,m},x] && NeQ[b*c-a*d,0] && EqQ[a^2+b^2,0] &&  NeQ[c^2+d^2,0] *)
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (A*b + a*B)/b* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n, x] - B/b* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^ n*(a - b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[A*b + a*B, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_ + B_.*tan[e_. + f_.*x_]), x_Symbol] := A^2/f* Subst[Int[(a + b*x)^m*(c + d*x)^n/(A - B*x), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegersQ[2*m, 2*n]] && EqQ[A^2 + B^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (A + I*B)/2* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^ n*(1 - I*Tan[e + f*x]), x] + (A - I*B)/2* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^ n*(1 + I*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegersQ[2*m, 2*n]] && NeQ[A^2 + B^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^2*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := -(B*c - A*d)*(b*c - a*d)^2*(c + d*Tan[e + f*x])^(n + 1)/(f* d^2*(n + 1)*(c^2 + d^2)) + 1/(d*(c^2 + d^2))*Int[(c + d*Tan[e + f*x])^(n + 1)* Simp[B*(b*c - a*d)^2 + A*d*(a^2*c - b^2*c + 2*a*b*d) + d*(B*(a^2*c - b^2*c + 2*a*b*d) + A*(2*a*b*c - a^2*d + b^2*d))* Tan[e + f*x] + b^2*B*(c^2 + d^2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (b*c - a*d)*(B*c - A*d)*(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2)) - 1/(d*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)* Simp[a*A* d*(b*d*(m - 1) - a*c*(n + 1)) + (b*B*c - (A*b + a*B)*d)*(b*c*(m - 1) + a*d*(n + 1)) - d*((a*A - b*B)*(b*c - a*d) + (A*b + a*B)*(a*c + b*d))*(n + 1)* Tan[e + f*x] - b*(d*(A*b*c + a*B*c - a*A*d)*(m + n) - b*B*(c^2*(m - 1) - d^2*(n + 1)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && LtQ[n, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_. + b_.*tan[e_. + f_.*x_])^2*(A_. + B_.*tan[e_. + f_.*x_])/(c_. + d_.*tan[e_. + f_.*x_]), x_Symbol] := b^2*B*Tan[e + f*x]/(d*f) + 1/d*Int[(a^2*A*d - b^2*B*c + (2*a*A*b + B*(a^2 - b^2))*d* Tan[e + f*x] + (A*b^2*d - b*B*(b*c - 2*a*d))* Tan[e + f*x]^2)/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := b*B*(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)/(d* f*(m + n)) + 1/(d*(m + n))* Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^n* Simp[a^2*A*d*(m + n) - b*B*(b*c*(m - 1) + a*d*(n + 1)) + d*(m + n)*(2*a*A*b + B*(a^2 - b^2))*Tan[e + f*x] - (b*B*(b*c - a*d)*(m - 1) - b*(A*b + a*B)*d*(m + n))* Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) && Not[IGtQ[n, 1] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^ n/(f*(m + 1)*(a^2 + b^2)) + 1/(b*(m + 1)*(a^2 + b^2))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)* Simp[b*B*(b*c*(m + 1) + a*d*n) + A*b*(a*c*(m + 1) - b*d*n) - b*(A*(b*c - a*d) - B*(a*c + b*d))*(m + 1)*Tan[e + f*x] - b*d*(A*b - a*B)*(m + n + 1)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := b*(A*b - a*B)*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 + b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 + b^2))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[b*B*(b*c*(m + 1) + a*d*(n + 1)) + A*(a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2)) - (A*b - a*B)*(b*c - a*d)*(m + 1)*Tan[e + f*x] - b*d*(A*b - a*B)*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) && Not[ILtQ[n, -1] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := B*(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n/(f*(m + n)) + 1/(m + n)* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n - 1)* Simp[a*A*c*(m + n) - B*(b*c*m + a*d*n) + (A*b*c + a*B*c + a*A*d - b*B*d)*(m + n)* Tan[e + f*x] + (A*b*d*(m + n) + B*(a*d*m + b*c*n))* Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[0, m, 1] && LtQ[0, n, 1]
Int[(A_. + B_.*tan[e_. + f_.*x_])/((a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])), x_Symbol] := (B*(b*c + a*d) + A*(a*c - b*d))*x/((a^2 + b^2)*(c^2 + d^2)) + b*(A*b - a*B)/((b*c - a*d)*(a^2 + b^2))* Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] + d*(B*c - A*d)/((b*c - a*d)*(c^2 + d^2))* Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[ c_. + d_.*tan[e_. + f_.*x_]]*(A_. + B_.*tan[e_. + f_.*x_])/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(a^2 + b^2)* Int[Simp[ A*(a*c + b*d) + B*(b*c - a*d) - (A*(b*c - a*d) - B*(a*c + b*d))*Tan[e + f*x], x]/Sqrt[c + d*Tan[e + f*x]], x] - (b*c - a*d)*(B*a - A*b)/(a^2 + b^2)* Int[(1 + Tan[e + f*x]^2)/((a + b*Tan[e + f*x])* Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_])/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(a^2 + b^2)* Int[(c + d*Tan[e + f*x])^n* Simp[a*A + b*B - (A*b - a*B)*Tan[e + f*x], x], x] + b*(A*b - a*B)/(a^2 + b^2)* Int[(c + d*Tan[e + f*x])^ n*(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[a_. + b_.*tan[e_. + f_.*x_]]*(A_. + B_.*tan[e_. + f_.*x_])/ Sqrt[c_. + d_.*tan[e_. + f_.*x_]], x_Symbol] := Int[Simp[a*A - b*B + (A*b + a*B)*Tan[e + f*x], x]/(Sqrt[a + b*Tan[e + f*x]]*Sqrt[c + d*Tan[e + f*x]]), x] + b*B* Int[(1 + Tan[e + f*x]^2)/(Sqrt[a + b*Tan[e + f*x]]* Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
(* Int[(A_.+B_.*tan[e_.+f_.*x_])/(Sqrt[a_.+b_.*tan[e_.+f_.*x_]]*Sqrt[ c_.+d_.*tan[e_.+f_.*x_]]),x_Symbol] := A^2/f*Subst[Int[1/((A-B*x)*Sqrt[a+b*x]*Sqrt[c+d*x]),x],x,Tan[e+f*x]]  /; FreeQ[{a,b,c,d,e,f,A,B},x] && NeQ[b*c-a*d,0] && NeQ[a^2+b^2,0] &&  NeQ[c^2+d^2,0] && EqQ[A^2+B^2,0] *)
(* Int[(A_.+B_.*tan[e_.+f_.*x_])/(Sqrt[a_.+b_.*tan[e_.+f_.*x_]]*Sqrt[ c_.+d_.*tan[e_.+f_.*x_]]),x_Symbol] := (A+I*B)/2*Int[(1-I*Tan[e+f*x])/(Sqrt[a+b*Tan[e+f*x]]*Sqrt[c+d*Tan[e+ f*x]]),x] + (A-I*B)/2*Int[(1+I*Tan[e+f*x])/(Sqrt[a+b*Tan[e+f*x]]*Sqrt[c+d*Tan[e+ f*x]]),x] /; FreeQ[{a,b,c,d,e,f,A,B},x] && NeQ[b*c-a*d,0] && NeQ[a^2+b^2,0] &&  NeQ[c^2+d^2,0] && NeQ[A^2+B^2,0] *)
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := A^2/f* Subst[Int[(a + b*x)^m*(c + d*x)^n/(A - B*x), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && EqQ[A^2 + B^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_]), x_Symbol] := (A + I*B)/2* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^ n*(1 - I*Tan[e + f*x]), x] + (A - I*B)/2* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^ n*(1 + I*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[A^2 + B^2, 0]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.4.1 (a+b tan)^m (A+B tan+C tan^2).m
*)

(* ::Subsection::Closed:: *)
(* 4.3.4.1 (a+b tan)^m (A+B tan+C tan^2) *)
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(A_ + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := A/(b*f)*Subst[Int[(a + x)^m, x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A, C]
Int[(a_. + b_.*cot[e_. + f_.*x_])^m_.*(A_ + C_.*cot[e_. + f_.*x_]^2), x_Symbol] := -A/(b*f)*Subst[Int[(a + x)^m, x], x, b*Cot[e + f*x]] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A, C]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := 1/b^2* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[b*B - a*C + b*C*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := -C/b^2*Int[(a + b*Tan[e + f*x])^(m + 1)*(a - b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := -(a*A + b*B - a*C)* Tan[e + f*x]*(a + b*Tan[e + f*x])^m/(2*a*f*m) + 1/(2*a^2*m)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[(b*B - a*C) + a*A*(2*m + 1) - (b*C*(m - 1) + (A*b - a*B)*(m + 1))* Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && LeQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := -(a*A - a*C)*Tan[e + f*x]*(a + b*Tan[e + f*x])^m/(2*a*f*m) + 1/(2*a^2*m)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[-a*C + a*A*(2*m + 1) - (b*C*(m - 1) + A*b*(m + 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[A*b^2 + a^2*C, 0] && LeQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[(A_ + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2)/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := (a*A + b*B - a*C)*x/(a^2 + b^2) + (A*b^2 - a*b*B + a^2*C)/(a^2 + b^2)* Int[(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 + b^2, 0] && EqQ[A*b - a*B - b*C, 0]
Int[(A_ + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2)/ tan[e_. + f_.*x_], x_Symbol] := B*x + A*Int[1/Tan[e + f*x], x] + C*Int[Tan[e + f*x], x] /; FreeQ[{e, f, A, B, C}, x] && NeQ[A, C]
Int[(A_ + C_.*tan[e_. + f_.*x_]^2)/tan[e_. + f_.*x_], x_Symbol] := A*Int[1/Tan[e + f*x], x] + C*Int[Tan[e + f*x], x] /; FreeQ[{e, f, A, C}, x] && NeQ[A, C]
Int[(A_ + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2)/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := (a*A + b*B - a*C)*x/(a^2 + b^2) - (A*b - a*B - b*C)/(a^2 + b^2)*Int[Tan[e + f*x], x] + (A*b^2 - a*b*B + a^2*C)/(a^2 + b^2)* Int[(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && NeQ[a^2 + b^2, 0] && NeQ[A*b - a*B - b*C, 0]
Int[(A_ + C_.*tan[e_. + f_.*x_]^2)/(a_ + b_.*tan[e_. + f_.*x_]), x_Symbol] := a*(A - C)*x/(a^2 + b^2) - b*(A - C)/(a^2 + b^2)*Int[Tan[e + f*x], x] + (a^2*C + A*b^2)/(a^2 + b^2)* Int[(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2*C + A*b^2, 0] && NeQ[a^2 + b^2, 0] && NeQ[A, C]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 - a*b*B + a^2*C)*(a + b*Tan[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 + b^2)) + 1/(a^2 + b^2)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[b*B + a*(A - C) - (A*b - a*B - b*C)*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 + a^2*C)*(a + b*Tan[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 + b^2)) + 1/(a^2 + b^2)* Int[(a + b*Tan[e + f*x])^(m + 1)* Simp[a*(A - C) - (A*b - b*C)*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[A*b^2 + a^2*C, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^ m_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)) + Int[(a + b*Tan[e + f*x])^m*Simp[A - C + B*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && Not[LeQ[m, -1]]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)) + (A - C)* Int[(a + b*Tan[e + f*x])^m, x] /; FreeQ[{a, b, e, f, A, C, m}, x] && NeQ[A*b^2 + a^2*C, 0] && Not[LeQ[m, -1]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.4.2 (a+b tan)^m (c+d tan)^n (A+B tan+C tan^2).m
*)

(* ::Subsection::Closed:: *)
(* 4.3.4.2 (a+b tan)^m (c+d tan)^n (A+B tan+C tan^2) *)
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := 1/b^2* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^ n*(b*B - a*C + b*C*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := -C/b^2* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^ n*(a - b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[A*b^2 + a^2*C, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_ + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := A/f*Subst[Int[(a + b*x)^m*(c + d*x)^n, x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[A, C]
Int[(a_. + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := -(b*c - a*d)*(c^2*C - B*c*d + A*d^2)*(c + d*Tan[e + f*x])^(n + 1)/(d^2* f*(n + 1)*(c^2 + d^2)) + 1/(d*(c^2 + d^2))*Int[(c + d*Tan[e + f*x])^(n + 1)* Simp[a*d*(A*c - c*C + B*d) + b*(c^2*C - B*c*d + A*d^2) + d*(A*b*c + a*B*c - b*c*C - a*A*d + b*B*d + a*C*d)* Tan[e + f*x] + b*C*(c^2 + d^2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1]
Int[(a_. + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := -(b*c - a*d)*(c^2*C + A*d^2)*(c + d*Tan[e + f*x])^(n + 1)/(d^2* f*(n + 1)*(c^2 + d^2)) + 1/(d*(c^2 + d^2))*Int[(c + d*Tan[e + f*x])^(n + 1)* Simp[a*d*(A*c - c*C) + b*(c^2*C + A*d^2) + d*(A*b*c - b*c*C - a*A*d + a*C*d)*Tan[e + f*x] + b*C*(c^2 + d^2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1]
Int[(a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := b*C*Tan[e + f*x]*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 2)) - 1/(d*(n + 2))*Int[(c + d*Tan[e + f*x])^n* Simp[b*c*C - a*A*d*(n + 2) - (A*b + a*B - b*C)*d*(n + 2)* Tan[e + f*x] - (a*C*d*(n + 2) - b*(c*C - B*d*(n + 2)))* Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] && Not[LtQ[n, -1]]
Int[(a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := b*C*Tan[e + f*x]*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 2)) - 1/(d*(n + 2))*Int[(c + d*Tan[e + f*x])^n* Simp[b*c*C - a*A*d*(n + 2) - (A*b - b*C)*d*(n + 2)* Tan[e + f*x] - (a*C*d*(n + 2) - b*c*C)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] && Not[LtQ[n, -1]]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (a*A + b*B - a*C)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d)) + 1/(2*a*m*(b*c - a*d))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[b*(c*(A + C)*m - B*d*(n + 1)) + a*(B*c*m + C*d*(n + 1) - A*d*(2*m + n + 1)) + (b*C*d*(m - n - 1) + A*b*d*(m + n + 1) + a*(2*c*C*m - B*d*(m + n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && (LtQ[m, 0] || EqQ[m + n + 1, 0])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := a*(A - C)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d)) + 1/(2*a*m*(b*c - a*d))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[b*c*(A + C)*m + a*(C*d*(n + 1) - A*d*(2*m + n + 1)) + (b*C*d*(m - n - 1) + A*b*d*(m + n + 1) + 2*a*c*C*m)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && (LtQ[m, 0] || EqQ[m + n + 1, 0])
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (c^2*C - B*c*d + A*d^2)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2)) - 1/(a*d*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)* Simp[b*(c^2*C - B*c*d + A*d^2)*m - a*d*(n + 1)*(A*c - c*C + B*d) - a*(d*(B*c - A*d)*(m + n + 1) - C*(c^2*m - d^2*(n + 1)))* Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && Not[LtQ[m, 0]] && LtQ[n, -1] && NeQ[c^2 + d^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (c^2*C + A*d^2)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2)) - 1/(a*d*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)* Simp[b*(c^2*C + A*d^2)*m - a*d*(n + 1)*(A*c - c*C) - a*(-A*d^2*(m + n + 1) - C*(c^2*m - d^2*(n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && Not[LtQ[m, 0]] && LtQ[n, -1] && NeQ[c^2 + d^2, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1)) + 1/(b*d*(m + n + 1))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n* Simp[A*b*d*(m + n + 1) + C*(a*c*m - b*d*(n + 1)) - (C*m*(b*c - a*d) - b*B*d*(m + n + 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && Not[LtQ[m, 0]] && NeQ[m + n + 1, 0]
Int[(a_ + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_.*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1)) + 1/(b*d*(m + n + 1))* Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n* Simp[A*b*d*(m + n + 1) + C*(a*c*m - b*d*(n + 1)) - C*m*(b*c - a*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && Not[LtQ[m, 0]] && NeQ[m + n + 1, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (A*d^2 + c*(c*C - B*d))*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2)) - 1/(d*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)* Simp[A*d*(b*d*m - a*c*(n + 1)) + (c*C - B*d)*(b*c*m + a*d*(n + 1)) - d*(n + 1)*((A - C)*(b*c - a*d) + B*(a*c + b*d))*Tan[e + f*x] - b*(d*(B*c - A*d)*(m + n + 1) - C*(c^2*m - d^2*(n + 1)))* Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (A*d^2 + c^2*C)*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2)) - 1/(d*(n + 1)*(c^2 + d^2))* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)* Simp[A*d*(b*d*m - a*c*(n + 1)) + c*C*(b*c*m + a*d*(n + 1)) - d*(n + 1)*((A - C)*(b*c - a*d))*Tan[e + f*x] + b*(A*d^2*(m + n + 1) + C*(c^2*m - d^2*(n + 1)))* Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1)) + 1/(d*(m + n + 1))* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^n* Simp[a*A*d*(m + n + 1) - C*(b*c*m + a*d*(n + 1)) + d*(A*b + a*B - b*C)*(m + n + 1)* Tan[e + f*x] - (C*m*(b*c - a*d) - b*B*d*(m + n + 1))* Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] && Not[IGtQ[n, 0] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_.*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^ m*(c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1)) + 1/(d*(m + n + 1))* Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^n* Simp[a*A*d*(m + n + 1) - C*(b*c*m + a*d*(n + 1)) + d*(A*b - b*C)*(m + n + 1)*Tan[e + f*x] - C*m*(b*c - a*d)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] && Not[IGtQ[n, 0] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 - a*(b*B - a*C))*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 + b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 + b^2))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[A*(a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2)) + (b*B - a*C)*(b*c*(m + 1) + a*d*(n + 1)) - (m + 1)*(b*c - a*d)*(A*b - a*B - b*C)*Tan[e + f*x] - d*(A*b^2 - a*(b*B - a*C))*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && Not[ILtQ[n, -1] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 + a^2*C)*(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 + b^2)) + 1/((m + 1)*(b*c - a*d)*(a^2 + b^2))* Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n* Simp[A*(a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2)) - a*C*(b*c*(m + 1) + a*d*(n + 1)) - (m + 1)*(b*c - a*d)*(A*b - b*C)*Tan[e + f*x] - d*(A*b^2 + a^2*C)*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && Not[ILtQ[n, -1] && (Not[IntegerQ[m]] || EqQ[c, 0] && NeQ[a, 0])]
Int[(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2)/((a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])), x_Symbol] := (a*(A*c - c*C + B*d) + b*(B*c - A*d + C*d))* x/((a^2 + b^2)*(c^2 + d^2)) + (A*b^2 - a*b*B + a^2*C)/((b*c - a*d)*(a^2 + b^2))* Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] - (c^2*C - B*c*d + A*d^2)/((b*c - a*d)*(c^2 + d^2))* Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(A_. + C_.*tan[e_. + f_.*x_]^2)/((a_ + b_.*tan[e_. + f_.*x_])*(c_. + d_.*tan[e_. + f_.*x_])), x_Symbol] := (a*(A*c - c*C) - b*(A*d - C*d))*x/((a^2 + b^2)*(c^2 + d^2)) + (A*b^2 + a^2*C)/((b*c - a*d)*(a^2 + b^2))* Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] - (c^2*C + A*d^2)/((b*c - a*d)*(c^2 + d^2))* Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2)/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(a^2 + b^2)* Int[(c + d*Tan[e + f*x])^n* Simp[b*B + a*(A - C) + (a*B - b*(A - C))*Tan[e + f*x], x], x] + (A*b^2 - a*b*B + a^2*C)/(a^2 + b^2)* Int[(c + d*Tan[e + f*x])^ n*(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && Not[GtQ[n, 0]] && Not[LeQ[n, -1]]
Int[(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2)/(a_. + b_.*tan[e_. + f_.*x_]), x_Symbol] := 1/(a^2 + b^2)* Int[(c + d*Tan[e + f*x])^n* Simp[a*(A - C) - (A*b - b*C)*Tan[e + f*x], x], x] + (A*b^2 + a^2*C)/(a^2 + b^2)* Int[(c + d*Tan[e + f*x])^ n*(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && Not[GtQ[n, 0]] && Not[LeQ[n, -1]]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + B_.*tan[e_. + f_.*x_] + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + b*ff*x)^m*(c + d*ff*x)^ n*(A + B*ff*x + C*ff^2*x^2)/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[(a_. + b_.*tan[e_. + f_.*x_])^m_*(c_. + d_.*tan[e_. + f_.*x_])^ n_*(A_. + C_.*tan[e_. + f_.*x_]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + b*ff*x)^m*(c + d*ff*x)^ n*(A + C*ff^2*x^2)/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.7 (d trig)^m (a+b (c tan)^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.7 (d trig)^m (a+b (c tan)^n)^p *)
Int[u_.*(a_ + b_.*tan[e_. + f_.*x_]^2)^p_, x_Symbol] := Int[ActivateTrig[u*(a*sec[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a, b]
Int[u_.*(b_.*tan[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (b*ff^n)^ IntPart[p]*(b*Tan[e + f*x]^n)^ FracPart[p]/(Tan[e + f*x]/ff)^(n*FracPart[p])* Int[ActivateTrig[u]*(Tan[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] && Not[IntegerQ[p]] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[u_.*(b_.*(c_.*tan[e_. + f_.*x_])^n_)^p_, x_Symbol] := b^IntPart[p]*(b*(c*Tan[e + f*x])^n)^ FracPart[p]/(c*Tan[e + f*x])^(n*FracPart[p])* Int[ActivateTrig[u]*(c*Tan[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] && Not[IntegerQ[p]] && Not[IntegerQ[n]] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[1/(a_ + b_.*tan[e_. + f_.*x_]^2), x_Symbol] := x/(a - b) - b/(a - b)*Int[Sec[e + f*x]^2/(a + b*Tan[e + f*x]^2), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a, b]
Int[(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, c*ff/f* Subst[Int[(a + b*(ff*x)^n)^p/(c^2 + ff^2*x^2), x], x, c*Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && (IntegersQ[n, p] || IGtQ[p, 0] || EqQ[n^2, 4] || EqQ[n^2, 16])
Int[(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^p_., x_Symbol] := Unintegrable[(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, c*ff^(m + 1)/f* Subst[Int[x^m*(a + b*(ff*x)^n)^p/(c^2 + ff^2*x^2)^(m/2 + 1), x], x, c*Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[m/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*tan[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, 1/(f*ff^m)* Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*(a - b + b*ff^2*x^2)^p/ x^(m + 1), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*tan[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, 1/(f*ff^m)* Subst[Int[(-1 + ff^2*x^2)^((m - 1)/ 2)*(a + b*(-1 + ff^2*x^2)^(n/2))^p/x^(m + 1), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^m*(a + b*(c*tan[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*sin[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_]^2)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(d*Sin[e + f*x])^m*(Sec[e + f*x]^2)^(m/2)/(f*Tan[e + f*x]^m)* Subst[ Int[(ff*x)^m*(a + b*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/d)^FracPart[m]* Int[(Sec[e + f*x]/d)^(-m)*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, c*ff/f* Subst[Int[(d*ff*x/c)^m*(a + b*(ff*x)^n)^p/(c^2 + ff^2*x^2), x], x, c*Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && (IGtQ[p, 0] || EqQ[n, 2] || EqQ[n, 4] || IntegerQ[p] && RationalQ[n])
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Int[ExpandTrig[(d*tan[e + f*x])^m*(a + b*(c*tan[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*cot[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_]^n_.)^p_., x_Symbol] := d^(n*p)* Int[(d*Cot[e + f*x])^(m - n*p)*(b + a*Cot[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && IntegersQ[n, p]
Int[(d_.*cot[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^FracPart[m]* Int[(Tan[e + f*x]/d)^(-m)*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[sec[e_. + f_.*x_]^m_*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/(c^(m - 1)*f)* Subst[Int[(c^2 + ff^2*x^2)^(m/2 - 1)*(a + b*(ff*x)^n)^p, x], x, c*Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[ m/2] && (IntegersQ[n, p] || IGtQ[m, 0] || IGtQ[p, 0] || EqQ[n^2, 4] || EqQ[n^2, 16])
Int[sec[e_. + f_.*x_]^m_.*(a_ + b_.*tan[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[ ExpandToSum[b*(ff*x)^n + a*(1 - ff^2*x^2)^(n/2), x]^ p/(1 - ff^2*x^2)^((m + n*p + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sec[e_. + f_.*x_]^m_.*(a_ + b_.*tan[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[ 1/(1 - ff^2*x^2)^((m + 1)/ 2)*((b*(ff*x)^n + a*(1 - ff^2*x^2)^(n/2))/(1 - ff^2*x^2)^(n/2))^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && Not[IntegerQ[p]]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Int[ExpandTrig[(d*sec[e + f*x])^m*(a + b*(c*tan[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*tan[e_. + f_.*x_]^2)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(d*Sec[e + f*x])^m/(f*(Sec[e + f*x]^2)^(m/2))* Subst[Int[(1 + ff^2*x^2)^(m/2 - 1)*(a + b*ff^2*x^2)^p, x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Sec[e + f*x])^m*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*tan[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]* Int[(Sin[e + f*x]/d)^(-m)*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.3 Tangent/4.3.9 trig^m (a+b tan^n+c tan^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.3.9 trig^m (a+b tan^n+c tan^(2 n))^p *)
Int[(a_ + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_ + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_ + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^ p/(b + 2*c*Tan[d + e*x]^n)^(2*p)* Int[(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_ + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^ p/(b + 2*c*Cot[d + e*x]^n)^(2*p)* Int[(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[1/(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Tan[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Tan[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Cot[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Cot[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*tan[d_. + e_.*x_])^n_. + c_.*(f_.*tan[d_. + e_.*x_])^n2_.)^p_, x_Symbol] := f/e*Subst[ Int[x^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*cot[d_. + e_.*x_])^n_. + c_.*(f_.*cot[d_. + e_.*x_])^n2_.)^p_, x_Symbol] := -f/e*Subst[ Int[x^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/2)* ExpandToSum[ a*(g*x)^(2*n) + b*(g*x)^n*(1 - g^2*x^2)^(n/2) + c*(1 - g^2*x^2)^n, x]^p/(g*x)^(2*n*p), x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/2)* ExpandToSum[ a*(g*x)^(2*n) + b*(g*x)^n*(1 - g^2*x^2)^(n/2) + c*(1 - g^2*x^2)^n, x]^p/(g*x)^(2*n*p), x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*tan[d_. + e_.*x_])^n_. + c_.*(f_.*tan[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := f^(m + 1)/e* Subst[Int[(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*cot[d_. + e_.*x_])^n_. + c_.*(f_.*cot[d_. + e_.*x_])^n2_.)^p_., x_Symbol] := -f^(m + 1)/e* Subst[Int[(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g/e* Subst[Int[(1 - g^2*x^2)^((m - 2*n*p - 1)/2)* ExpandToSum[c*x^(2*n) + b*x^n*(1 - x^2)^(n/2) + a*(1 - x^2)^n, x]^p, x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g/e* Subst[Int[(1 - g^2*x^2)^((m - 2*n*p - 1)/2)* ExpandToSum[c*x^(2*n) + b*x^n*(1 - x^2)^(n/2) + a*(1 - x^2)^n, x]^p, x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Tan[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Cot[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^ p/(b + 2*c*Tan[d + e*x]^n)^(2*p)* Int[Tan[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^ p/(b + 2*c*Cot[d + e*x]^n)^(2*p)* Int[Cot[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*(f_.*tan[d_. + e_.*x_])^n_. + c_.*(f_.*tan[d_. + e_.*x_])^n2_.)^p_, x_Symbol] := f/e*Subst[Int[(x/f)^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*(f_.*cot[d_. + e_.*x_])^n_. + c_.*(f_.*cot[d_. + e_.*x_])^n2_.)^p_, x_Symbol] := -f/e*Subst[Int[(x/f)^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := 1/(4^p*c^p)*Int[Cot[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_., x_Symbol] := 1/(4^p*c^p)*Int[Tan[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^ p/(b + 2*c*Tan[d + e*x]^n)^(2*p)* Int[Cot[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^ p/(b + 2*c*Cot[d + e*x]^n)^(2*p)* Int[Tan[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_ + c_.*tan[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{g = FreeFactors[Cot[d + e*x], x]}, g/e* Subst[Int[(g*x)^(m - 2*n*p)*(c + b*(g*x)^n + a*(g*x)^(2*n))^ p/(1 + g^2*x^2), x], x, Cot[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_ + c_.*cot[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{g = FreeFactors[Tan[d + e*x], x]}, -g/e* Subst[Int[(g*x)^(m - 2*n*p)*(c + b*(g*x)^n + a*(g*x)^(2*n))^ p/(1 + g^2*x^2), x], x, Tan[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2]
Int[(A_ + B_.*tan[d_. + e_.*x_])*(a_ + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Tan[d + e*x])*(b + 2*c*Tan[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*cot[d_. + e_.*x_])*(a_ + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Cot[d + e*x])*(b + 2*c*Cot[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*tan[d_. + e_.*x_])*(a_ + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Tan[d + e*x] + c*Tan[d + e*x]^2)^ n/(b + 2*c*Tan[d + e*x])^(2*n)* Int[(A + B*Tan[d + e*x])*(b + 2*c*Tan[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*cot[d_. + e_.*x_])*(a_ + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Cot[d + e*x] + c*Cot[d + e*x]^2)^ n/(b + 2*c*Cot[d + e*x])^(2*n)* Int[(A + B*Cot[d + e*x])*(b + 2*c*Cot[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*tan[d_. + e_.*x_])/(a_. + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)* Int[1/Simp[b + q + 2*c*Tan[d + e*x], x], x] + (B - (b*B - 2*A*c)/q)* Int[1/Simp[b - q + 2*c*Tan[d + e*x], x], x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*cot[d_. + e_.*x_])/(a_. + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)* Int[1/Simp[b + q + 2*c*Cot[d + e*x], x], x] + (B - (b*B - 2*A*c)/q)* Int[1/Simp[b - q + 2*c*Cot[d + e*x], x], x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*tan[d_. + e_.*x_])*(a_. + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*tan[d + e*x])*(a + b*tan[d + e*x] + c*tan[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*cot[d_. + e_.*x_])*(a_. + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*cot[d + e*x])*(a + b*cot[d + e*x] + c*cot[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.1.1 (a+b sec)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.1.1 (a+b sec)^n *)
Int[csc[c_. + d_.*x_]^n_, x_Symbol] := -1/d*Subst[Int[ExpandIntegrand[(1 + x^2)^(n/2 - 1), x], x], x, Cot[c + d*x]] /; FreeQ[{c, d}, x] && IGtQ[n/2, 0]
Int[(b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -b*Cos[c + d*x]*(b*Csc[c + d*x])^(n - 1)/(d*(n - 1)) + b^2*(n - 2)/(n - 1)*Int[(b*Csc[c + d*x])^(n - 2), x] /; FreeQ[{b, c, d}, x] && GtQ[n, 1] && IntegerQ[2*n]
Int[(b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Cos[c + d*x]*(b*Csc[c + d*x])^(n + 1)/(b*d*n) + (n + 1)/(b^2*n)*Int[(b*Csc[c + d*x])^(n + 2), x] /; FreeQ[{b, c, d}, x] && LtQ[n, -1] && IntegerQ[2*n]
Int[csc[c_. + d_.*x_], x_Symbol] := (* -ArcCoth[Cos[c+d*x]]/d /; *) -ArcTanh[Cos[c + d*x]]/d /; FreeQ[{c, d}, x]
(* Int[1/csc[c_.+d_.*x_],x_Symbol] := -Cos[c+d*x]/d /; FreeQ[{c,d},x] *)
Int[(b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := (b*Csc[c + d*x])^n*Sin[c + d*x]^n*Int[1/Sin[c + d*x]^n, x] /; FreeQ[{b, c, d}, x] && EqQ[n^2, 1/4]
Int[(b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := (b*Csc[c + d*x])^(n - 1)*((Sin[c + d*x]/b)^(n - 1)* Int[1/(Sin[c + d*x]/b)^n, x]) /; FreeQ[{b, c, d, n}, x] && Not[IntegerQ[n]]
Int[(a_ + b_.*csc[c_. + d_.*x_])^2, x_Symbol] := a^2*x + 2*a*b*Int[Csc[c + d*x], x] + b^2*Int[Csc[c + d*x]^2, x] /; FreeQ[{a, b, c, d}, x]
Int[Sqrt[a_ + b_.*csc[c_. + d_.*x_]], x_Symbol] := -2*b/d* Subst[Int[1/(a + x^2), x], x, b*Cot[c + d*x]/Sqrt[a + b*Csc[c + d*x]]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -b^2*Cot[c + d*x]*(a + b*Csc[c + d*x])^(n - 2)/(d*(n - 1)) + a/(n - 1)* Int[(a + b*Csc[c + d*x])^(n - 2)*(a*(n - 1) + b*(3*n - 4)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[1/Sqrt[a_ + b_.*csc[c_. + d_.*x_]], x_Symbol] := 1/a*Int[Sqrt[a + b*Csc[c + d*x]], x] - b/a*Int[Csc[c + d*x]/Sqrt[a + b*Csc[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -Cot[c + d*x]*(a + b*Csc[c + d*x])^n/(d*(2*n + 1)) + 1/(a^2*(2*n + 1))* Int[(a + b*Csc[c + d*x])^(n + 1)*(a*(2*n + 1) - b*(n + 1)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegerQ[2*n]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := a^n*Cot[ c + d*x]/(d*Sqrt[1 + Csc[c + d*x]]*Sqrt[1 - Csc[c + d*x]])* Subst[Int[(1 + b*x/a)^(n - 1/2)/(x*Sqrt[1 - b*x/a]), x], x, Csc[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[2*n]] && GtQ[a, 0]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := a^IntPart[n]*(a + b*Csc[c + d*x])^ FracPart[n]/(1 + b/a*Csc[c + d*x])^FracPart[n]* Int[(1 + b/a*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[2*n]] && Not[GtQ[a, 0]]
Int[Sqrt[a_ + b_.*csc[c_. + d_.*x_]], x_Symbol] := 2*(a + b*Csc[c + d*x])/(d*Rt[a + b, 2]*Cot[c + d*x])* Sqrt[b*(1 + Csc[c + d*x])/(a + b*Csc[c + d*x])]* Sqrt[-b*(1 - Csc[c + d*x])/(a + b*Csc[c + d*x])]* EllipticPi[a/(a + b), ArcSin[Rt[a + b, 2]/Sqrt[a + b*Csc[c + d*x]]], (a - b)/(a + b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[c_. + d_.*x_])^(3/2), x_Symbol] := Int[(a^2 + b*(2*a - b)*Csc[c + d*x])/Sqrt[a + b*Csc[c + d*x]], x] + b^2* Int[Csc[c + d*x]*(1 + Csc[c + d*x])/Sqrt[a + b*Csc[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -b^2*Cot[c + d*x]*(a + b*Csc[c + d*x])^(n - 2)/(d*(n - 1)) + 1/(n - 1)*Int[(a + b*Csc[c + d*x])^(n - 3)* Simp[a^3*(n - 1) + (b*(b^2*(n - 2) + 3*a^2*(n - 1)))* Csc[c + d*x] + (a*b^2*(3*n - 4))*Csc[c + d*x]^2, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 2] && IntegerQ[2*n]
Int[1/(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := x/a - 1/a*Int[1/(1 + a/b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[1/Sqrt[a_ + b_.*csc[c_. + d_.*x_]], x_Symbol] := 2*Rt[a + b, 2]/(a*d*Cot[c + d*x])* Sqrt[b*(1 - Csc[c + d*x])/(a + b)]* Sqrt[-b*(1 + Csc[c + d*x])/(a - b)]* EllipticPi[(a + b)/a, ArcSin[Sqrt[a + b*Csc[c + d*x]]/Rt[a + b, 2]], (a + b)/(a - b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := b^2*Cot[ c + d*x]*(a + b*Csc[c + d*x])^(n + 1)/(a*d*(n + 1)*(a^2 - b^2)) + 1/(a*(n + 1)*(a^2 - b^2))* Int[(a + b*Csc[c + d*x])^(n + 1)* Simp[(a^2 - b^2)*(n + 1) - a*b*(n + 1)*Csc[c + d*x] + b^2*(n + 2)*Csc[c + d*x]^2, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Unintegrable[(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] && Not[IntegerQ[2*n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.1.2 (d sec)^n (a+b sec)^m.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.1.2 (d sec)^n (a+b sec)^m *)
Int[(a_ + b_.*csc[e_. + f_.*x_])*(d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := a*Int[(d*Csc[e + f*x])^n, x] + b/d*Int[(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, n}, x]
Int[(a_ + b_.*csc[e_. + f_.*x_])^2*(d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := 2*a*b/d*Int[(d*Csc[e + f*x])^(n + 1), x] + Int[(d*Csc[e + f*x])^n*(a^2 + b^2*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x]
Int[csc[e_. + f_.*x_]^2/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := 1/b*Int[Csc[e + f*x], x] - a/b*Int[Csc[e + f*x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x]
Int[csc[e_. + f_.*x_]^3/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := -Cot[e + f*x]/(b*f) - a/b*Int[Csc[e + f*x]^2/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandTrig[(a + b*csc[e + f*x])^m*(d*csc[e + f*x])^n, x], x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && RationalQ[n]
Int[csc[e_. + f_.*x_]*Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*b*Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]) /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -b*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)/(f*m) + a*(2*m - 1)/m*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1/2] && IntegerQ[2*m]
Int[csc[e_. + f_.*x_]/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := -Cot[e + f*x]/(f*(b + a*Csc[e + f*x])) /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2/f*Subst[Int[1/(2*a + x^2), x], x, b*Cot[e + f*x]/Sqrt[a + b*Csc[e + f*x]]] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := b*Cot[ e + f*x]*(a + b*Csc[e + f*x])^ m/(a*f*(2*m + 1)) + (m + 1)/(a*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2] && IntegerQ[2*m]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(2*m + 1)) + m/(b*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + a*m/(b*(m + 1))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[csc[e_. + f_.*x_]^3*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(a*f*(2*m + 1)) - 1/(a^2*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(a*m - b*(2*m + 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[csc[e_. + f_.*x_]^3*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^ m*(b*(m + 1) - a*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := -2*a/(b*f)*Sqrt[a*d/b]* Subst[Int[1/Sqrt[1 + x^2/a], x], x, b*Cot[e + f*x]/Sqrt[a + b*Csc[e + f*x]]] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[a*d/b, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := -2*b*d/f* Subst[Int[1/(b - d*x^2), x], x, b*Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]])] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && Not[GtQ[a*d/b, 0]]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -2*b*d* Cot[e + f*x]*(d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)* Sqrt[a + b*Csc[e + f*x]]) + 2*a*d*(n - 1)/(b*(2*n - 1))* Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := -2*a*Cot[ e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]]) /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a*Cot[ e + f*x]*(d*Csc[e + f*x])^n/(f*n*Sqrt[a + b*Csc[e + f*x]]) + a*(2*n + 1)/(2*b*d*n)* Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, -1/2] && IntegerQ[2*n]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a^2*d* Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]])* Subst[Int[(d*x)^(n - 1)/Sqrt[a - b*x], x], x, Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0]
Int[Sqrt[d_.*csc[e_. + f_.*x_]]/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -Sqrt[2]*Sqrt[a]/(b*f)* Subst[Int[1/Sqrt[1 + x^2], x], x, b*Cot[e + f*x]/(a + b*Csc[e + f*x])] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[d - a/b, 0] && GtQ[a, 0]
Int[Sqrt[d_.*csc[e_. + f_.*x_]]/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*b*d/(a*f)* Subst[Int[1/(2*b - d*x^2), x], x, b*Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]])] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -a*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^ n/(f*m) + b*(2*m - 1)/(d*m)* Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n, 0] && GtQ[m, 1/2] && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := b*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 1)/(a*f*(2*m + 1)) + d*(m + 1)/(b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n, 0] && LtQ[m, -1/2] && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(2*m + 1)) + m/(a*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(m + 1)) + a*m/(b*d*(m + 1))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && Not[LtQ[m, -1/2]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := b^2*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^ n/(f*n) - a/(d*n)* Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^(n + 1)*(b*(m - 2*n - 2) - a*(m + 2*n - 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1] && (LtQ[n, -1] || EqQ[m, 3/2] && EqQ[n, -1/2]) && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -b^2*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^ n/(f*(m + n - 1)) + b/(m + n - 1)* Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^ n*(b*(m + 2*n - 1) + a*(3*m + 2*n - 4)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1] && NeQ[m + n - 1, 0] && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := b*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 1)/(a*f*(2*m + 1)) - d/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*(a*(n - 1) - b*(m + n)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && (IntegersQ[2*m, 2*n] || IntegerQ[m])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -d^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 2)/(f*(2*m + 1)) + d^2/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)*(b*(n - 2) + a*(m - n + 2)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 2] && (IntegersQ[2*m, 2*n] || IntegerQ[m])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(2*m + 1)) + 1/(a^2*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n*(a*(2*m + n + 1) - b*(m + n + 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && (IntegersQ[2*m, 2*n] || IntegerQ[m])
Int[(d_.*csc[e_. + f_.*x_])^n_/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := d^2*Cot[ e + f*x]*(d*Csc[e + f*x])^(n - 2)/(f*(a + b*Csc[e + f*x])) - d^2/(a*b)* Int[(d*Csc[e + f*x])^(n - 2)*(b*(n - 2) - a*(n - 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 1]
Int[(d_.*csc[e_. + f_.*x_])^n_/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*(a + b*Csc[e + f*x])) - 1/a^2*Int[(d*Csc[e + f*x])^n*(a*(n - 1) - b*n*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := -b*d*Cot[ e + f*x]*(d*Csc[e + f*x])^(n - 1)/(a*f*(a + b*Csc[e + f*x])) + d*(n - 1)/(a*b)* Int[(d*Csc[e + f*x])^(n - 1)*(a - b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^(3/2)/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := d/b*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]], x] - a*d/b*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*d^2* Cot[e + f*x]*(d*Csc[e + f*x])^(n - 2)/(f*(2*n - 3)* Sqrt[a + b*Csc[e + f*x]]) + d^2/(b*(2*n - 3))* Int[(d*Csc[e + f*x])^(n - 2)*(2*b*(n - 2) - a*Csc[e + f*x])/ Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 2] && IntegerQ[2*n]
Int[(d_.*csc[e_. + f_.*x_])^n_/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*n*Sqrt[a + b*Csc[e + f*x]]) + 1/(2*b*d*n)* Int[(d*Csc[e + f*x])^(n + 1)*(a + b*(2*n + 1)*Csc[e + f*x])/ Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, 0] && IntegerQ[2*n]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -d^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 2)/(f*(m + n - 1)) + d^2/(b*(m + n - 1))* Int[(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 2)*(b*(n - 2) + a*m*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 2] && NeQ[m + n - 1, 0] && IntegerQ[n]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -(a*d/b)^n* Cot[e + f*x]/(a^(n - 2)*f*Sqrt[a + b*Csc[e + f*x]]* Sqrt[a - b*Csc[e + f*x]])* Subst[Int[(a - x)^(n - 1)*(2*a - x)^(m - 1/2)/Sqrt[x], x], x, a - b*Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && GtQ[a, 0] && Not[IntegerQ[n]] && GtQ[a*d/b, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -(-a*d/b)^n* Cot[e + f*x]/(a^(n - 1)*f*Sqrt[a + b*Csc[e + f*x]]* Sqrt[a - b*Csc[e + f*x]])* Subst[Int[x^(m - 1/2)*(a - x)^(n - 1)/Sqrt[2*a - x], x], x, a + b*Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && GtQ[a, 0] && Not[IntegerQ[n]] && LtQ[a*d/b, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := a^2*d* Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]* Sqrt[a - b*Csc[e + f*x]])* Subst[Int[(d*x)^(n - 1)*(a + b*x)^(m - 1/2)/Sqrt[a - b*x], x], x, Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && GtQ[a, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := a^IntPart[m]*(a + b*Csc[e + f*x])^ FracPart[m]/(1 + b/a*Csc[e + f*x])^FracPart[m]* Int[(1 + b/a*Csc[e + f*x])^m*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[m]] && Not[GtQ[a, 0]]
Int[csc[e_. + f_.*x_]*Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := (a - b)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + b*Int[Csc[e + f*x]*(1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -b*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)/(f*m) + 1/m* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*(b^2*(m - 1) + a^2*m + a*b*(2*m - 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && IntegerQ[2*m]
(* Int[csc[e_.+f_.*x_]/(a_+b_.*csc[e_.+f_.*x_]),x_Symbol] := -2/f*Subst[Int[1/(a+b-(a-b)*x^2),x],x,Cot[e+f*x]/(1+Csc[e+f*x])] /; FreeQ[{a,b,e,f},x] && NeQ[a^2-b^2,0] *)
Int[csc[e_. + f_.*x_]/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := 1/b*Int[1/(1 + a/b*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*Rt[a + b, 2]/(b*f*Cot[e + f*x])* Sqrt[(b*(1 - Csc[e + f*x]))/(a + b)]* Sqrt[-b*(1 + Csc[e + f*x])/(a - b)]* EllipticF[ ArcSin[Sqrt[a + b*Csc[e + f*x]]/Rt[a + b, 2]], (a + b)/(a - b)] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -b*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(a*(m + 1) - b*(m + 2)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := Cot[e + f*x]/(f*Sqrt[1 + Csc[e + f*x]]*Sqrt[1 - Csc[e + f*x]])* Subst[Int[(a + b*x)^m/(Sqrt[1 + x]*Sqrt[1 - x]), x], x, Csc[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && Not[IntegerQ[2*m]]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + m/(m + 1)* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(b + a*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := a*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2)) - 1/((m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(b*(m + 1) - a*(m + 2)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[e_. + f_.*x_]^2/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + Int[Csc[e + f*x]*(1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -a/b*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] + 1/b*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]^3*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -a^2*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[a*b*(m + 1) - (a^2 + b^2*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[e_. + f_.*x_]^3*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^ m*(b*(m + 1) - a*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a^2*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^ n/(f*n) - 1/(d*n)*Int[(a + b*Csc[e + f*x])^(m - 3)*(d*Csc[e + f*x])^(n + 1)* Simp[a^2*b*(m - 2*n - 2) - a*(3*b^2*n + a^2*(n + 1))*Csc[e + f*x] - b*(b^2*n + a^2*(m + n - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 2] && (IntegerQ[m] && LtQ[n, -1] || IntegersQ[m + 1/2, 2*n] && LeQ[n, -1])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -b^2*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^ n/(f*(m + n - 1)) + 1/(d*(m + n - 1))* Int[(a + b*Csc[e + f*x])^(m - 3)*(d*Csc[e + f*x])^n* Simp[a^3*d*(m + n - 1) + a*b^2*d*n + b*(b^2*d*(m + n - 2) + 3*a^2*d*(m + n - 1))*Csc[e + f*x] + a*b^2*d*(3*m + 2*n - 4)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 2] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) && Not[IGtQ[n, 2] && Not[IntegerQ[m]]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -b*d*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)* Simp[b*d*(n - 1) + a*d*(m + 1)*Csc[e + f*x] - b*d*(m + n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && IntegersQ[2*m, 2*n]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a*d^2* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)/(f*(m + 1)*(a^2 - b^2)) - d^2/((m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)*(a*(n - 2) + b*(m + 1)*Csc[e + f*x] - a*(m + n)*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && IntegersQ[2*m, 2*n]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -a^2*d^3* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 3)/(b*f*(m + 1)*(a^2 - b^2)) + d^3/(b*(m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 3)* Simp[a^2*(n - 3) + a*b*(m + 1)*Csc[e + f*x] - (a^2*(n - 2) + b^2*(m + 1))* Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && (IGtQ[n, 3] || IntegersQ[n + 1/2, 2*m] && GtQ[n, 2])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*n) - 1/(a*d*n)*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[b*(m + n + 1) - a*(n + 1)*Csc[e + f*x] - b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m + 1/2, 0] && ILtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := b^2*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* (a^2*(m + 1) - b^2*(m + n + 1) - a*b*(m + 1)*Csc[e + f*x] + b^2*(m + n + 2)*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[Sqrt[d_.*csc[e_. + f_.*x_]]/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := Sqrt[d*Sin[e + f*x]]*Sqrt[d*Csc[e + f*x]]/d* Int[Sqrt[d*Sin[e + f*x]]/(b + a*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^(3/2)/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := d*Sqrt[d*Sin[e + f*x]]*Sqrt[d*Csc[e + f*x]]* Int[1/(Sqrt[d*Sin[e + f*x]]*(b + a*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^(5/2)/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := d/b*Int[(d*Csc[e + f*x])^(3/2), x] - a*d/b*Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := -d^3*Cot[e + f*x]*(d*Csc[e + f*x])^(n - 3)/(b*f*(n - 2)) + d^3/(b*(n - 2))* Int[(d*Csc[e + f*x])^(n - 3)* Simp[a*(n - 3) + b*(n - 3)*Csc[e + f*x] - a*(n - 2)*Csc[e + f*x]^2, x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 3]
Int[1/(Sqrt[d_.*csc[e_. + f_.*x_]]*(a_ + b_.*csc[e_. + f_.*x_])), x_Symbol] := b^2/(a^2*d^2)*Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] + 1/a^2*Int[(a - b*Csc[e + f*x])/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := Cot[e + f*x]*(d*Csc[e + f*x])^n/(a*f*n) - 1/(a*d*n)*Int[(d*Csc[e + f*x])^(n + 1)/(a + b*Csc[e + f*x])* Simp[b*n - a*(n + 1)*Csc[e + f*x] - b*(n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegerQ[2*n]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := a*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + b/d*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -2*d*Cos[e + f*x]* Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)) + d^2/(2*n - 1)* Int[(d*Csc[e + f*x])^(n - 2)* Simp[2*a*(n - 2) + b*(2*n - 3)*Csc[e + f*x] + a*Csc[e + f*x]^2, x]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := Sqrt[a + b*Csc[e + f*x]]/(Sqrt[d*Csc[e + f*x]]* Sqrt[b + a*Sin[e + f*x]])*Int[Sqrt[b + a*Sin[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Cot[e + f*x]*Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^n/(f*n) - 1/(2*d*n)* Int[(d*Csc[e + f*x])^(n + 1)* Simp[b - 2*a*(n + 1)*Csc[e + f*x] - b*(2*n + 3)*Csc[e + f*x]^2, x]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegerQ[2*n]
Int[Sqrt[d_.*csc[e_. + f_.*x_]]/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := Sqrt[d*Csc[e + f*x]]* Sqrt[b + a*Sin[e + f*x]]/Sqrt[a + b*Csc[e + f*x]]* Int[1/Sqrt[b + a*Sin[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^(3/2)/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := d*Sqrt[d*Csc[e + f*x]]* Sqrt[b + a*Sin[e + f*x]]/Sqrt[a + b*Csc[e + f*x]]* Int[1/(Sin[e + f*x]*Sqrt[b + a*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*d^2*Cos[e + f*x]*(d*Csc[e + f*x])^(n - 2)* Sqrt[a + b*Csc[e + f*x]]/(b*f*(2*n - 3)) + d^3/(b*(2*n - 3))* Int[(d*Csc[e + f*x])^(n - 3)/Sqrt[a + b*Csc[e + f*x]]* Simp[2*a*(n - 3) + b*(2*n - 5)*Csc[e + f*x] - 2*a*(n - 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 2] && IntegerQ[2*n]
Int[1/(csc[e_. + f_.*x_]*Sqrt[a_ + b_.*csc[e_. + f_.*x_]]), x_Symbol] := -Cos[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/(a*f) - b/(2*a)*Int[(1 + Csc[e + f*x]^2)/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[1/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*Sqrt[d_.*csc[e_. + f_.*x_]]), x_Symbol] := 1/a*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] - b/(a*d)*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := Cos[e + f*x]*(d*Csc[e + f*x])^(n + 1)* Sqrt[a + b*Csc[e + f*x]]/(a*d*f*n) + 1/(2*a*d*n)*Int[(d*Csc[e + f*x])^(n + 1)/Sqrt[a + b*Csc[e + f*x]]* Simp[-b*(2*n + 1) + 2*a*(n + 1)*Csc[e + f*x] + b*(2*n + 3)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[(a_ + b_.*csc[e_. + f_.*x_])^(3/2)*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a*Cot[e + f*x]* Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^n/(f*n) + 1/(2*d*n)*Int[(d*Csc[e + f*x])^(n + 1)/Sqrt[a + b*Csc[e + f*x]]* Simp[a*b*(2*n - 1) + 2*(b^2*n + a^2*(n + 1))*Csc[e + f*x] + a*b*(2*n + 3)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegersQ[2*n]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -d^3*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 3)/(b*f*(m + n - 1)) + d^3/(b*(m + n - 1))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 3)* Simp[a*(n - 3) + b*(m + n - 2)*Csc[e + f*x] - a*(n - 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 3] && (IntegerQ[n] || IntegersQ[2*m, 2*n]) && Not[IGtQ[m, 2]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -b*d*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n - 1)/(f*(m + n - 1)) + d/(m + n - 1)* Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^(n - 1)* Simp[a*b*(n - 1) + (b^2*(m + n - 2) + a^2*(m + n - 1))* Csc[e + f*x] + a*b*(2*m + n - 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 2] && LtQ[0, n, 3] && NeQ[m + n - 1, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -d^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 2)/(f*(m + n - 1)) + d^2/(b*(m + n - 1))* Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n - 2)* Simp[a*b*(n - 2) + b^2*(m + n - 2)*Csc[e + f*x] + a*b*m*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[-1, m, 2] && LtQ[1, n, 3] && NeQ[m + n - 1, 0] && (IntegerQ[n] || IntegersQ[2*m, 2*n])
Int[(a_ + b_.*csc[e_. + f_.*x_])^(3/2)/Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := a*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] + b/d*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^n_.*(a_ + b_.*csc[e_. + f_.*x_])^m_., x_Symbol] := Sin[e + f*x]^n*(d*Csc[e + f*x])^n* Int[(b + a*Sin[e + f*x])^m/Sin[e + f*x]^(m + n), x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_. + b_.*sec[e_. + f_.*x_])^p_, x_Symbol] := (d*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/d)^FracPart[m]* Int[(Sec[e + f*x]/d)^(-m)*(a + b*Sec[e + f*x])^p, x] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]] && Not[IntegerQ[p]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.1.3 (d sin)^n (a+b sec)^m.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.1.3 (d sin)^n (a+b sec)^m *)
Int[(g_.*cos[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^m_., x_Symbol] := Int[(g*Cos[e + f*x])^p*(b + a*Sin[e + f*x])^m/Sin[e + f*x]^m, x] /; FreeQ[{a, b, e, f, g, p}, x] && IntegerQ[m]
Int[cos[e_. + f_.*x_]^p_.*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -1/(f*b^(p - 1))* Subst[Int[(-a + b*x)^((p - 1)/2)*(a + b*x)^(m + (p - 1)/2)/ x^(p + 1), x], x, Csc[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0]
Int[cos[e_. + f_.*x_]^p_.*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := -1/f*Subst[ Int[(-1 + x)^((p - 1)/2)*(1 + x)^((p - 1)/2)*(a + b*x)^m/ x^(p + 1), x], x, Csc[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_/cos[e_. + f_.*x_]^2, x_Symbol] := Tan[e + f*x]*(a + b*Csc[e + f*x])^m/f + b*m*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, m}, x]
Int[(g_.*cos[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^m_, x_Symbol] := Sin[e + f*x]^ FracPart[m]*(a + b*Csc[e + f*x])^FracPart[m]/(b + a*Sin[e + f*x])^ FracPart[m]* Int[(g*Cos[e + f*x])^p*(b + a*Sin[e + f*x])^m/Sin[e + f*x]^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x] && (EqQ[a^2 - b^2, 0] || IntegersQ[2*m, p])
Int[(g_.*cos[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^m_., x_Symbol] := Unintegrable[(g*Cos[e + f*x])^p*(a + b*Csc[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x]
(* Int[(g_.*sec[e_.+f_.*x_])^p_*(a_+b_.*csc[e_.+f_.*x_])^m_.,x_Symbol]  := Int[(g*Sec[e+f*x])^p*(b+a*Sin[e+f*x])^m/Sin[e+f*x]^m,x] /; FreeQ[{a,b,e,f,g,p},x] && Not[IntegerQ[p]] && IntegerQ[m] *)
Int[(g_.*sec[e_. + f_.*x_])^p_*(a_ + b_.*csc[e_. + f_.*x_])^m_., x_Symbol] := g^IntPart[p]*(g*Sec[e + f*x])^FracPart[p]*Cos[e + f*x]^FracPart[p]* Int[(a + b*Csc[e + f*x])^m/Cos[e + f*x]^p, x] /; FreeQ[{a, b, e, f, g, m, p}, x] && Not[IntegerQ[p]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.1.4 (d tan)^n (a+b sec)^m.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.1.4 (d tan)^n (a+b sec)^m *)
Int[cot[c_. + d_.*x_]^m_.*(a_ + b_.*csc[c_. + d_.*x_])^n_., x_Symbol] := 1/(a^(m - n - 1)*b^n*d)* Subst[Int[(a - b*x)^((m - 1)/2)*(a + b*x)^((m - 1)/2 + n)/ x^(m + n), x], x, Sin[c + d*x]] /; FreeQ[{a, b, c, d}, x] && IntegerQ[(m - 1)/2] && EqQ[a^2 - b^2, 0] && IntegerQ[n]
Int[cot[c_. + d_.*x_]^m_.*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -1/(d*b^(m - 1))* Subst[Int[(-a + b*x)^((m - 1)/2)*(a + b*x)^((m - 1)/2 + n)/x, x], x, Csc[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && IntegerQ[(m - 1)/2] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[n]]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := -e*(e*Cot[c + d*x])^(m - 1)*(a*m + b*(m - 1)*Csc[c + d*x])/(d* m*(m - 1)) - e^2/m* Int[(e*Cot[c + d*x])^(m - 2)*(a*m + b*(m - 1)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[m, 1]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := -(e*Cot[c + d*x])^(m + 1)*(a + b*Csc[c + d*x])/(d*e*(m + 1)) - 1/(e^2*(m + 1))* Int[(e*Cot[c + d*x])^(m + 2)*(a*(m + 1) + b*(m + 2)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && LtQ[m, -1]
Int[(a_ + b_.*csc[c_. + d_.*x_])/cot[c_. + d_.*x_], x_Symbol] := Int[(b + a*Sin[c + d*x])/Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x]
Int[(e_.*cot[c_. + d_.*x_])^m_.*(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := a*Int[(e*Cot[c + d*x])^m, x] + b*Int[(e*Cot[c + d*x])^m*Csc[c + d*x], x] /; FreeQ[{a, b, c, d, e, m}, x]
Int[cot[c_. + d_.*x_]^m_.*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -(-1)^((m - 1)/2)/(d*b^(m - 1))* Subst[Int[(b^2 - x^2)^((m - 1)/2)*(a + x)^n/x, x], x, b*Csc[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && IntegerQ[(m - 1)/2] && NeQ[a^2 - b^2, 0]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(e*Cot[c + d*x])^m, (a + b*Csc[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 0]
Int[cot[c_. + d_.*x_]^m_.*(a_ + b_.*csc[c_. + d_.*x_])^n_., x_Symbol] := -2*a^(m/2 + n + 1/2)/d* Subst[Int[x^m*(2 + a*x^2)^(m/2 + n - 1/2)/(1 + a*x^2), x], x, Cot[c + d*x]/Sqrt[a + b*Csc[c + d*x]]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m/2] && IntegerQ[n - 1/2]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := a^(2*n)*e^(-2*n)* Int[(e*Cot[c + d*x])^(m + 2*n)/(-a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[a^2 - b^2, 0] && ILtQ[n, 0]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := -2^(m + n + 1)*(e*Cot[c + d*x])^(m + 1)*(a + b*Csc[c + d*x])^ n/(d*e*(m + 1))*(a/(a + b*Csc[c + d*x]))^(m + n + 1)* AppellF1[(m + 1)/2, m + n, 1, (m + 3)/ 2, -(a - b*Csc[c + d*x])/(a + b*Csc[c + d*x]), (a - b*Csc[c + d*x])/(a + b*Csc[c + d*x])] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[IntegerQ[n]]
Int[Sqrt[e_.*cot[c_. + d_.*x_]]/(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := 1/a*Int[Sqrt[e*Cot[c + d*x]], x] - b/a*Int[Sqrt[e*Cot[c + d*x]]/(b + a*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0]
Int[(e_.*cot[c_. + d_.*x_])^m_/(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := -e^2/b^2*Int[(e*Cot[c + d*x])^(m - 2)*(a - b*Csc[c + d*x]), x] + e^2*(a^2 - b^2)/b^2* Int[(e*Cot[c + d*x])^(m - 2)/(a + b*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m - 1/2, 0]
Int[1/(Sqrt[e_.*cot[c_. + d_.*x_]]*(a_ + b_.*csc[c_. + d_.*x_])), x_Symbol] := 1/a*Int[1/Sqrt[e*Cot[c + d*x]], x] - b/a*Int[1/(Sqrt[e*Cot[c + d*x]]*(b + a*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0]
Int[(e_.*cot[c_. + d_.*x_])^m_/(a_ + b_.*csc[c_. + d_.*x_]), x_Symbol] := 1/(a^2 - b^2)*Int[(e*Cot[c + d*x])^m*(a - b*Csc[c + d*x]), x] + b^2/(e^2*(a^2 - b^2))* Int[(e*Cot[c + d*x])^(m + 2)/(a + b*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m + 1/2, 0]
Int[cot[c_. + d_.*x_]^2*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Int[(-1 + Csc[c + d*x]^2)*(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0]
Int[cot[c_. + d_.*x_]^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(a + b*Csc[c + d*x])^ n, (-1 + Csc[c + d*x]^2)^(m/2), x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m/2, 0] && IntegerQ[n - 1/2]
Int[cot[c_. + d_.*x_]^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(a + b*Csc[c + d*x])^ n, (-1 + Sec[c + d*x]^2)^(-m/2), x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m/2, 0] && IntegerQ[n - 1/2] && EqQ[m, -2]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(e*Cot[c + d*x])^m, (a + b*Csc[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[cot[c_. + d_.*x_]^m_.*(a_ + b_.*csc[c_. + d_.*x_])^n_, x_Symbol] := Int[Cos[c + d*x]^m*(b + a*Sin[c + d*x])^n/Sin[c + d*x]^(m + n), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[n] && IntegerQ[m] && (IntegerQ[m/2] || LeQ[m, 1])
Int[(e_.*cot[c_. + d_.*x_])^m_.*(a_. + b_.*csc[c_. + d_.*x_])^n_., x_Symbol] := Unintegrable[(e*Cot[c + d*x])^m*(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*cot[c_. + d_.*x_])^m_*(a_ + b_.*sec[c_. + d_.*x_])^n_., x_Symbol] := (e*Cot[c + d*x])^m*Tan[c + d*x]^m* Int[(a + b*Sec[c + d*x])^n/Tan[c + d*x]^m, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && Not[IntegerQ[m]]
Int[(e_.*tan[c_. + d_.*x_]^p_)^m_*(a_ + b_.*sec[c_. + d_.*x_])^n_., x_Symbol] := (e*Tan[c + d*x]^p)^m/(e*Tan[c + d*x])^(m*p)* Int[(e*Tan[c + d*x])^(m*p)*(a + b*Sec[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && Not[IntegerQ[m]]
Int[(e_.*cot[c_. + d_.*x_]^p_)^m_*(a_ + b_.*csc[c_. + d_.*x_])^n_., x_Symbol] := (e*Cot[c + d*x]^p)^m/(e*Cot[c + d*x])^(m*p)* Int[(e*Cot[c + d*x])^(m*p)*(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.10 (c+d x)^m (a+b sec)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.10 (c+d x)^m (a+b sec)^n *)
Int[(c_. + d_.*x_)^m_.*csc[e_. + k_.*Pi + f_.*Complex[0, fz_]*x_], x_Symbol] := -2*(c + d*x)^m*ArcTanh[E^(-I*k*Pi)*E^(-I*e + f*fz*x)]/(f*fz*I) - d*m/(f*fz*I)* Int[(c + d*x)^(m - 1)*Log[1 - E^(-I*k*Pi)*E^(-I*e + f*fz*x)], x] + d*m/(f*fz*I)* Int[(c + d*x)^(m - 1)*Log[1 + E^(-I*k*Pi)*E^(-I*e + f*fz*x)], x] /; FreeQ[{c, d, e, f, fz}, x] && IntegerQ[2*k] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*csc[e_. + k_.*Pi + f_.*x_], x_Symbol] := -2*(c + d*x)^m*ArcTanh[E^(I*k*Pi)*E^(I*(e + f*x))]/f - d*m/f* Int[(c + d*x)^(m - 1)*Log[1 - E^(I*k*Pi)*E^(I*(e + f*x))], x] + d*m/f* Int[(c + d*x)^(m - 1)*Log[1 + E^(I*k*Pi)*E^(I*(e + f*x))], x] /; FreeQ[{c, d, e, f}, x] && IntegerQ[2*k] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*csc[e_. + f_.*Complex[0, fz_]*x_], x_Symbol] := -2*(c + d*x)^m*ArcTanh[E^(-I*e + f*fz*x)]/(f*fz*I) - d*m/(f*fz*I)* Int[(c + d*x)^(m - 1)*Log[1 - E^(-I*e + f*fz*x)], x] + d*m/(f*fz*I)* Int[(c + d*x)^(m - 1)*Log[1 + E^(-I*e + f*fz*x)], x] /; FreeQ[{c, d, e, f, fz}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*csc[e_. + f_.*x_], x_Symbol] := -2*(c + d*x)^m*ArcTanh[E^(I*(e + f*x))]/f - d*m/f*Int[(c + d*x)^(m - 1)*Log[1 - E^(I*(e + f*x))], x] + d*m/f*Int[(c + d*x)^(m - 1)*Log[1 + E^(I*(e + f*x))], x] /; FreeQ[{c, d, e, f}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*csc[e_. + f_.*x_]^2, x_Symbol] := -(c + d*x)^m*Cot[e + f*x]/f + d*m/f*Int[(c + d*x)^(m - 1)*Cot[e + f*x], x] /; FreeQ[{c, d, e, f}, x] && GtQ[m, 0]
Int[(c_. + d_.*x_)*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -b^2*(c + d*x)* Cot[e + f*x]*(b*Csc[e + f*x])^(n - 2)/(f*(n - 1)) - b^2*d*(b*Csc[e + f*x])^(n - 2)/(f^2*(n - 1)*(n - 2)) + b^2*(n - 2)/(n - 1)*Int[(c + d*x)*(b*Csc[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && NeQ[n, 2]
Int[(c_. + d_.*x_)^m_*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -b^2*(c + d*x)^m* Cot[e + f*x]*(b*Csc[e + f*x])^(n - 2)/(f*(n - 1)) - b^2*d* m*(c + d*x)^(m - 1)*(b*Csc[e + f*x])^(n - 2)/(f^2*(n - 1)*(n - 2)) + b^2*(n - 2)/(n - 1)* Int[(c + d*x)^m*(b*Csc[e + f*x])^(n - 2), x] + b^2*d^2*m*(m - 1)/(f^2*(n - 1)*(n - 2))* Int[(c + d*x)^(m - 2)*(b*Csc[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && NeQ[n, 2] && GtQ[m, 1]
Int[(c_. + d_.*x_)*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := d*(b*Csc[e + f*x])^n/(f^2*n^2) + (c + d*x)*Cos[e + f*x]*(b*Csc[e + f*x])^(n + 1)/(b*f*n) + (n + 1)/(b^2*n)*Int[(c + d*x)*(b*Csc[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1]
Int[(c_. + d_.*x_)^m_*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := d*m*(c + d*x)^(m - 1)*(b*Csc[e + f*x])^n/(f^2*n^2) + (c + d*x)^m*Cos[e + f*x]*(b*Csc[e + f*x])^(n + 1)/(b*f*n) + (n + 1)/(b^2*n)*Int[(c + d*x)^m*(b*Csc[e + f*x])^(n + 2), x] - d^2*m*(m - 1)/(f^2*n^2)* Int[(c + d*x)^(m - 2)*(b*Csc[e + f*x])^n, x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && GtQ[m, 1]
Int[(c_. + d_.*x_)^m_.*(b_.*csc[e_. + f_.*x_])^n_, x_Symbol] := (b*Sin[e + f*x])^n*(b*Csc[e + f*x])^n* Int[(c + d*x)^m/(b*Sin[e + f*x])^n, x] /; FreeQ[{b, c, d, e, f, m, n}, x] && Not[IntegerQ[n]]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*Csc[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(c_. + d_.*x_)^m_.*(a_ + b_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, Sin[e + f*x]^(-n)/(b + a*Sin[e + f*x])^(-n), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[n, 0] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*csc[e_. + f_.*x_]^n_., x_Symbol] := If[MatchQ[f, f1_.*Complex[0, j_]], If[MatchQ[e, e1_. + Pi/2], Unintegrable[(c + d*x)^m*Sech[I*(e - Pi/2) + I*f*x]^n, x], (-I)^n*Unintegrable[(c + d*x)^m*Csch[-I*e - I*f*x]^n, x]], If[MatchQ[e, e1_. + Pi/2], Unintegrable[(c + d*x)^m*Sec[e - Pi/2 + f*x]^n, x], Unintegrable[(c + d*x)^m*Csc[e + f*x]^n, x]]] /; FreeQ[{c, d, e, f, m, n}, x] && IntegerQ[n]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[u_^m_.*(a_. + b_.*Sec[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Sec[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*(a_. + b_.*Csc[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Csc[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.11 (e x)^m (a+b sec(c+d x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.11 (e x)^m (a+b sec(c+d x^n))^p *)
Int[(a_. + b_.*Sec[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Sec[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Csc[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Csc[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Sec[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(a + b*Sec[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Csc[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(a + b*Csc[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Sec[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Sec[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Csc[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Csc[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Sec[u_])^p_., x_Symbol] := Int[(a + b*Sec[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(a_. + b_.*Csc[u_])^p_., x_Symbol] := Int[(a + b*Csc[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*(a_. + b_.*Sec[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Sec[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*(a_. + b_.*Csc[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Csc[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*(a_. + b_.*Sec[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[x^m*(a + b*Sec[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[x_^m_.*(a_. + b_.*Csc[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[x^m*(a + b*Csc[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Sec[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sec[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Csc[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Csc[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Sec[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Sec[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(e_*x_)^m_.*(a_. + b_.*Csc[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Csc[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*Sec[a_. + b_.*x_^n_.]^p_*Sin[a_. + b_.*x_^n_.], x_Symbol] := x^(m - n + 1)*Sec[a + b*x^n]^(p - 1)/(b*n*(p - 1)) - (m - n + 1)/(b*n*(p - 1))* Int[x^(m - n)*Sec[a + b*x^n]^(p - 1), x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m - n, 0] && NeQ[p, 1]
Int[x_^m_.*Csc[a_. + b_.*x_^n_.]^p_*Cos[a_. + b_.*x_^n_.], x_Symbol] := -x^(m - n + 1)*Csc[a + b*x^n]^(p - 1)/(b*n*(p - 1)) + (m - n + 1)/(b*n*(p - 1))* Int[x^(m - n)*Csc[a + b*x^n]^(p - 1), x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m - n, 0] && NeQ[p, 1]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.2.1 (a+b sec)^m (c+d sec)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.2.1 (a+b sec)^m (c+d sec)^n *)
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := c^n*Int[ ExpandTrig[(1 + d/c*csc[e + f*x])^n, (a + b*csc[e + f*x])^m, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && ILtQ[n, 0] && LtQ[m + n, 2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := (-a*c)^m*Int[Cot[e + f*x]^(2*m)*(c + d*Csc[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && RationalQ[n] && Not[IntegerQ[n] && GtQ[m - n, 0]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^m_, x_Symbol] := (-a*c)^(m + 1/2)* Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Int[Cot[e + f*x]^(2*m), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m + 1/2]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := 2*a*c* Cot[e + f*x]*(c + d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)* Sqrt[a + b*Csc[e + f*x]]) + c*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && GtQ[n, 1/2]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -2*a*Cot[ e + f*x]*(c + d*Csc[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]]) + 1/c* Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^(3/2)*(c_ + d_.*csc[e_. + f_.*x_])^ n_., x_Symbol] := -4*a^2* Cot[e + f*x]*(c + d*Csc[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]]) + a/c* Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^(3/2)*(c_ + d_.*csc[e_. + f_.*x_])^ n_., x_Symbol] := -2*a^2* Cot[e + f*x]*(c + d*Csc[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]]) + a*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && Not[LeQ[n, -1/2]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^(5/2)*(c_ + d_.*csc[e_. + f_.*x_])^ n_., x_Symbol] := -8*a^3* Cot[e + f*x]*(c + d*Csc[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]]) + a^2/c^2* Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n + 2), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -a*c*Cot[ e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Subst[ Int[(b + a*x)^(m - 1/2)*(d + c*x)^(n - 1/2)/x^(m + n), x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && EqQ[m + n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := a*c*Cot[ e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Subst[Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2)/x, x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := a*c*x + b*d*Int[Csc[e + f*x]^2, x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := a*c*x + (b*c + a*d)*Int[Csc[e + f*x], x] + b*d*Int[Csc[e + f*x]^2, x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[b*c + a*d, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := c*Int[Sqrt[a + b*Csc[e + f*x]], x] + d*Int[Sqrt[a + b*Csc[e + f*x]]*Csc[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := a*c*Int[1/Sqrt[a + b*Csc[e + f*x]], x] + Int[Csc[e + f*x]*(b*c + a*d + b*d*Csc[e + f*x])/ Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := -b*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)/(f*m) + 1/m* Int[(a + b*Csc[e + f*x])^(m - 1)* Simp[a*c*m + (b*c*m + a*d*(2*m - 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && GtQ[m, 1] && EqQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := -b*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)/(f*m) + 1/m*Int[(a + b*Csc[e + f*x])^(m - 2)* Simp[a^2*c*m + (b^2*d*(m - 1) + 2*a*b*c*m + a^2*d*m)* Csc[e + f*x] + b*(b*c*m + a*d*(2*m - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && GtQ[m, 1] && NeQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[(c_ + d_.*csc[e_. + f_.*x_])/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := c*x/a - (b*c - a*d)/a*Int[Csc[e + f*x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[(c_ + d_.*csc[e_. + f_.*x_])/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := c/a*Int[Sqrt[a + b*Csc[e + f*x]], x] - (b*c - a*d)/a* Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(c_ + d_.*csc[e_. + f_.*x_])/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := c*Int[1/Sqrt[a + b*Csc[e + f*x]], x] + d*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := -(b*c - a*d)* Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(b*f*(2*m + 1)) + 1/(a^2*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[a*c*(2*m + 1) - (b*c - a*d)*(m + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && EqQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := b*(b*c - a*d)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(a* f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))*Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[c*(a^2 - b^2)*(m + 1) - (a*(b*c - a*d)*(m + 1))* Csc[e + f*x] + b*(b*c - a*d)*(m + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && NeQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := c*Int[(a + b*Csc[e + f*x])^m, x] + d*Int[(a + b*Csc[e + f*x])^m*Csc[e + f*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && Not[IntegerQ[2*m]]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := 1/c*Int[Sqrt[a + b*Csc[e + f*x]], x] - d/c*Int[Csc[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := a/c*Int[1/Sqrt[a + b*Csc[e + f*x]], x] + (b*c - a*d)/c* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^(3/2)/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := a/c*Int[Sqrt[a + b*Csc[e + f*x]], x] + (b*c - a*d)/c* Int[Csc[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
(* Int[(a_+b_.*csc[e_.+f_.*x_])^(3/2)/(c_+d_.*csc[e_.+f_.*x_]),x_ Symbol] := b/d*Int[Sqrt[a+b*Csc[e+f*x]],x] -  (b*c-a*d)/d*Int[Sqrt[a+b*Csc[e+f*x]]/(c+d*Csc[e+f*x]),x] /; FreeQ[{a,b,c,d,e,f},x] && NeQ[b*c-a*d,0] && NeQ[a^2-b^2,0] &&  NeQ[c^2-d^2,0] *)
Int[(a_ + b_.*csc[e_. + f_.*x_])^(3/2)/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := 1/(c*d)* Int[(a^2*d + b^2*c*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] - (b*c - a*d)^2/(c*d)* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := 1/(c*(b*c - a*d))* Int[(b*c - a*d - b*d*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] + d^2/(c*(b*c - a*d))* Int[Csc[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[1/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := 1/c*Int[1/Sqrt[a + b*Csc[e + f*x]], x] - d/c*Int[Csc[ e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]/Cot[e + f*x]* Int[Cot[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := c*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] + d*Int[ Csc[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := 1/c*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]], x] - d/c* Int[Csc[e + f*x]* Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := -2*a/f* Subst[Int[1/(1 + a*c*x^2), x], x, Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := a/c*Int[Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + (b*c - a*d)/c* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := 2*(a + b*Csc[e + f*x])/(c*f*Rt[(a + b)/(c + d), 2]*Cot[e + f*x])* Sqrt[(b*c - a*d)*(1 + Csc[e + f*x])/((c - d)*(a + b*Csc[e + f*x]))]* Sqrt[-(b*c - a*d)*(1 - Csc[e + f*x])/((c + d)*(a + b*Csc[e + f*x]))]* EllipticPi[a*(c + d)/(c*(a + b)), ArcSin[Rt[(a + b)/(c + d), 2]* Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]]], (a - b)*(c + d)/((a + b)*(c - d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]* Sqrt[c_ + d_.*csc[e_. + f_.*x_]]), x_Symbol] := Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Int[1/Cot[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[1/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]* Sqrt[c_ + d_.*csc[e_. + f_.*x_]]), x_Symbol] := 1/a*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] - b/a* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_])^(3/2), x_Symbol] := 1/c*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] - d/c* Int[Csc[e + f*x]* Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])^(3/2), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 - d^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := a^2*Cot[ e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]])* Subst[ Int[(a + b*x)^(m - 1/2)*(c + d*x)^n/(x*Sqrt[a - b*x]), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && IntegerQ[m - 1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/ Sin[e + f*x]^(m + n), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IntegerQ[n] && LeQ[-2, m + n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Sqrt[d + c*Sin[e + f*x]]* Sqrt[a + b*Csc[e + f*x]]/(Sqrt[b + a*Sin[e + f*x]]* Sqrt[c + d*Csc[e + f*x]])* Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/ Sin[e + f*x]^(m + n), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m + 1/2] && IntegerQ[n + 1/2] && LeQ[-2, m + n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Sin[e + f*x]^(m + n)*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^ n/((b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n)* Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/ Sin[e + f*x]^Simplify[m + n], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n, 0] && Not[IntegerQ[2*m]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(a + b*csc[e + f*x])^m, (c + d*csc[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(a_. + b_.*sec[e_. + f_.*x_])^m_.*(d_./sec[e_. + f_.*x_])^n_, x_Symbol] := d^m*Int[(b + a*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_. + b_.*csc[e_. + f_.*x_])^m_.*(d_./csc[e_. + f_.*x_])^n_, x_Symbol] := d^m*Int[(b + a*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_. + b_.*sec[e_. + f_.*x_])^ m_.*(c_.*(d_.*sec[e_. + f_.*x_])^p_)^n_, x_Symbol] := c^IntPart[n]*(c*(d*Sec[e + f*x])^p)^ FracPart[n]/(d*Sec[e + f*x])^(p*FracPart[n])* Int[(a + b*Sec[e + f*x])^m*(d*Sec[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]]
Int[(a_. + b_.*csc[e_. + f_.*x_])^ m_.*(c_.*(d_.*csc[e_. + f_.*x_])^p_)^n_, x_Symbol] := c^IntPart[n]*(c*(d*Csc[e + f*x])^p)^ FracPart[n]/(d*Csc[e + f*x])^(p*FracPart[n])* Int[(a + b*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.2.2 (g sec)^p (a+b sec)^m (c+d sec)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.2.2 (g sec)^p (a+b sec)^m (c+d sec)^n *)
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n/(a*f*(2*m + 1)) /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && NeQ[2*m + 1, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n/(a*f*(2*m + 1)) + (m + n + 1)/(a*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ILtQ[m + n + 1, 0] && NeQ[2*m + 1, 0] && Not[LtQ[n, 0]] && Not[IGtQ[n + 1/2, 0] && LtQ[n + 1/2, -(m + n)]]
Int[csc[e_. + f_.*x_]* Sqrt[c_ + d_.*csc[e_. + f_.*x_]]/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := a*c*Log[1 + b/a*Csc[e + f*x]]* Cot[e + f*x]/(b*f*Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]]) /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^m_.* Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := 2*a*c* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m/(b*f*(2*m + 1)*Sqrt[c + d*Csc[e + f*x]]) /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[m, -1/2]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := 2*a*c* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^(n - 1)/(b*f*(2*m + 1)) - d*(2*n - 1)/(b*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n - 1/2, 0] && LtQ[m, -1/2]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := -d*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^(n - 1)/(f*(m + n)) + c*(2*n - 1)/(m + n)* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n - 1/2, 0] && Not[LtQ[m, -1/2]] && Not[IGtQ[m - 1/2, 0] && LtQ[m, n]]
Int[csc[e_. + f_.*x_]*(c_ + d_.*csc[e_. + f_.*x_])^n_./ Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*d*Cot[ e + f*x]*(c + d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)* Sqrt[a + b*Csc[e + f*x]]) + 2*c*(2*n - 1)/(2*n - 1)* Int[Csc[e + f*x]*(c + d*Csc[e + f*x])^(n - 1)/ Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := 2*a*c* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^(n - 1)/(b*f*(2*m + 1)) - d*(2*n - 1)/(b*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n, 0] && LtQ[m, -1/2] && IntegerQ[2*m]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := (-a*c)^m* Int[ExpandTrig[ csc[e + f*x]*cot[e + f*x]^(2*m), (c + d*csc[e + f*x])^(n - m), x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n] && GeQ[n - m, 0] && GtQ[m*n, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^m_, x_Symbol] := (-a*c)^(m + 1/2)* Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Int[Csc[e + f*x]*Cot[e + f*x]^(2*m), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m + 1/2]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n/(a*f*(2*m + 1)) + (m + n + 1)/(a*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (ILtQ[m, 0] && ILtQ[n - 1/2, 0] || ILtQ[m - 1/2, 0] && ILtQ[n - 1/2, 0] && LtQ[m, n])
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a*c*Cot[ e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Subst[Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(c_ + d_.*csc[e_. + f_.*x_])^n_., x_Symbol] := (-a*c)^m* Int[ExpandTrig[(g*csc[e + f*x])^p* cot[e + f*x]^(2*m), (c + d*csc[e + f*x])^(n - m), x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n] && GeQ[n - m, 0] && GtQ[m*n, 0]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^m_, x_Symbol] := (-a*c)^(m + 1/2)* Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])* Int[(g*Csc[e + f*x])^p*Cot[e + f*x]^(2*m), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m + 1/2]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a*c*g* Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]])* Subst[ Int[(g*x)^(p - 1)*(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[g_.*csc[e_. + f_.*x_]]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := -2*b*g/f* Subst[Int[1/(b*c + a*d - c*g*x^2), x], x, b*Cot[e + f*x]/(Sqrt[g*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[g_.*csc[e_. + f_.*x_]]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := a/c*Int[Sqrt[g*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + (b*c - a*d)/(c*g)* Int[(g*Csc[e + f*x])^(3/2)/(Sqrt[ a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := -2*b/f* Subst[Int[1/(b*c + a*d + d*x^2), x], x, b*Cot[e + f*x]/Sqrt[a + b*Csc[e + f*x]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := -Sqrt[a + b*Csc[e + f*x]]* Sqrt[c/(c + d*Csc[e + f*x])]/(d*f* Sqrt[c*d*(a + b*Csc[e + f*x])/((b*c + a*d)*(c + d*Csc[e + f*x]))])* EllipticE[ ArcSin[c* Cot[e + f*x]/(c + d*Csc[e + f*x])], -(b*c - a*d)/(b*c + a*d)] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := b/d*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] - (b*c - a*d)/d* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^(3/2)* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := g/d*Int[Sqrt[g*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]], x] - c*g/d* Int[Sqrt[g*Csc[e + f*x]]* Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^(3/2)* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_]), x_Symbol] := b/d*Int[(g*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] - (b*c - a*d)/d* Int[(g*Csc[e + f*x])^(3/2)/(Sqrt[ a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := b/(b*c - a*d)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] - d/(b*c - a*d)* Int[Csc[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[csc[e_. + f_.*x_]/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := -2*Cot[ e + f*x]/(f*(c + d)*Sqrt[a + b*Csc[e + f*x]]* Sqrt[-Cot[e + f*x]^2])*Sqrt[(a + b*Csc[e + f*x])/(a + b)]* EllipticPi[2*d/(c + d), ArcSin[Sqrt[1 - Csc[e + f*x]]/Sqrt[2]], 2*b/(a + b)] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^(3/2)/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := -a*g/(b*c - a*d)* Int[Sqrt[g*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + c*g/(b*c - a*d)* Int[Sqrt[g*Csc[e + f*x]]* Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^(3/2)/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := g*Sqrt[g*Csc[e + f*x]]* Sqrt[b + a*Sin[e + f*x]]/Sqrt[a + b*Csc[e + f*x]]* Int[1/(Sqrt[b + a*Sin[e + f*x]]*(d + c*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]^2/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := -a/(b*c - a*d)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + c/(b*c - a*d)* Int[Csc[e + f*x]*Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[csc[e_. + f_.*x_]^2/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := 1/d*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] - c/d* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^(5/2)/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := -c^2*g^2/(d*(b*c - a*d))* Int[Sqrt[g*Csc[e + f*x]]* Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x]), x] + g^2/(d*(b*c - a*d))* Int[Sqrt[g*Csc[e + f*x]]*(a*c + (b*c - a*d)*Csc[e + f*x])/ Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^(5/2)/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])), x_Symbol] := g/d*Int[(g*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] - c*g/d* Int[(g*Csc[e + f*x])^(3/2)/(Sqrt[ a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := -2*b/f* Subst[Int[1/(1 - b*d*x^2), x], x, Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := -(b*c - a*d)/d* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]]), x] + b/d* Int[Csc[e + f*x]* Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/Sqrt[c_ + d_.*csc[e_. + f_.*x_]], x_Symbol] := -2*(a + b*Csc[e + f*x])/(d*f*Sqrt[(a + b)/(c + d)]*Cot[e + f*x])* Sqrt[-(b*c - a*d)*(1 - Csc[e + f*x])/((c + d)*(a + b*Csc[e + f*x]))]* Sqrt[(b*c - a*d)*(1 + Csc[e + f*x])/((c - d)*(a + b*Csc[e + f*x]))]* EllipticPi[b*(c + d)/(d*(a + b)), ArcSin[Sqrt[(a + b)/(c + d)]* Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]]], (a - b)*(c + d)/((a + b)*(c - d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[e_. + f_.*x_]/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]* Sqrt[c_ + d_.*csc[e_. + f_.*x_]]), x_Symbol] := -2*a/(b*f)* Subst[Int[1/(2 + (a*c - b*d)*x^2), x], x, Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[e_. + f_.*x_]/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]* Sqrt[c_ + d_.*csc[e_. + f_.*x_]]), x_Symbol] := -2*(c + d*Csc[e + f*x])/(f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]* Cot[e + f*x])* Sqrt[(b*c - a*d)*(1 - Csc[e + f*x])/((a + b)*(c + d*Csc[e + f*x]))]* Sqrt[-(b*c - a*d)*(1 + Csc[e + f*x])/((a - b)*(c + d*Csc[e + f*x]))]* EllipticF[ ArcSin[Rt[(c + d)/(a + b), 2]*(Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]])], (a + b)*(c - d)/((a - b)*(c + d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[e_. + f_.*x_]^2/(Sqrt[a_ + b_.*csc[e_. + f_.*x_]]* Sqrt[c_ + d_.*csc[e_. + f_.*x_]]), x_Symbol] := -a/b*Int[ Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]), x] + 1/b* Int[Csc[e + f*x]* Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[csc[e_. + f_.*x_]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]/(c_ + d_.*csc[e_. + f_.*x_])^(3/2), x_Symbol] := (a - b)/(c - d)* Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]* Sqrt[c + d*Csc[e + f*x]]), x] + (b*c - a*d)/(c - d)* Int[Csc[e + f*x]*(1 + Csc[e + f*x])/(Sqrt[ a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(3/2)), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := a^2*g* Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]* Sqrt[a - b*Csc[e + f*x]])* Subst[ Int[(g*x)^(p - 1)*(a + b*x)^(m - 1/2)*(c + d*x)^n/Sqrt[a - b*x], x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && (EqQ[p, 1] || IntegerQ[m - 1/2])
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := 1/g^(m + n)* Int[(g*Csc[e + f*x])^(m + n + p)*(b + a*Sin[e + f*x])^ m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IntegerQ[n]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := (g*Csc[e + f*x])^(m + p)*(c + d*Csc[e + f*x])^ n/(g^m*(d + c*Sin[e + f*x])^n)* Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n + p, 0] && IntegerQ[m]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := (g*Csc[e + f*x])^p*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^ n/((b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n)* Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n + p, 0] && Not[IntegerQ[m]]
Int[csc[e_. + f_.*x_]^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Sqrt[d + c*Sin[e + f*x]]* Sqrt[a + b*Csc[e + f*x]]/(Sqrt[b + a*Sin[e + f*x]]* Sqrt[c + d*Csc[e + f*x]])* Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n/ Sin[e + f*x]^(m + n + p), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m - 1/2] && IntegerQ[n - 1/2] && IntegerQ[p] && LeQ[-2, m + n + p, -1]
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(c_ + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Int[ExpandTrig[(g*csc[e + f*x])^p*(a + b*csc[e + f*x])^ m*(c + d*csc[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && (IntegersQ[m, n] || IntegersQ[m, p] || IntegersQ[n, p])
Int[(g_.*csc[e_. + f_.*x_])^p_.*(a_. + b_.*csc[e_. + f_.*x_])^ m_*(c_. + d_.*csc[e_. + f_.*x_])^n_, x_Symbol] := Unintegrable[(g*Csc[e + f*x])^p*(a + b*Csc[e + f*x])^ m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x]
Int[sec[e_. + f_.*x_]*(A_ + B_.*sec[e_. + f_.*x_])/(Sqrt[ a_ + b_.*sec[e_. + f_.*x_]]*(c_ + d_.*sec[e_. + f_.*x_])^(3/ 2)), x_Symbol] := 2*A*(1 + Sec[e + f*x])* Sqrt[(b*c - a*d)*(1 - Sec[e + f*x])/((a + b)*(c + d*Sec[e + f*x]))]/ (f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]*Tan[e + f*x]* Sqrt[-(b*c - a*d)*(1 + Sec[e + f*x])/((a - b)*(c + d*Sec[e + f*x]))])* EllipticE[ ArcSin[Rt[(c + d)/(a + b), 2]* Sqrt[a + b*Sec[e + f*x]]/Sqrt[c + d*Sec[e + f*x]]], (a + b)*(c - d)/((a - b)*(c + d))] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B]
Int[csc[e_. + f_.*x_]*(A_ + B_.*csc[e_. + f_.*x_])/(Sqrt[ a_ + b_.*csc[e_. + f_.*x_]]*(c_ + d_.*csc[e_. + f_.*x_])^(3/ 2)), x_Symbol] := -2*A*(1 + Csc[e + f*x])* Sqrt[(b*c - a*d)*(1 - Csc[e + f*x])/((a + b)*(c + d*Csc[e + f*x]))]/ (f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]*Cot[e + f*x]* Sqrt[-(b*c - a*d)*(1 + Csc[e + f*x])/((a - b)*(c + d*Csc[e + f*x]))])* EllipticE[ ArcSin[Rt[(c + d)/(a + b), 2]* Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]]], (a + b)*(c - d)/((a - b)*(c + d))] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.3.1 (a+b sec)^m (d sec)^n (A+B sec).m
*)

(* ::Subsection::Closed:: *)
(* 4.5.3.1 (a+b sec)^m (d sec)^n (A+B sec) *)
Int[(a_ + b_.*csc[e_. + f_.*x_])*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*a*Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*n) + 1/(d*n)* Int[(d*Csc[e + f*x])^(n + 1)* Simp[n*(B*a + A*b) + (B*b*n + A*a*(n + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(d_.*csc[e_. + f_.*x_])^ n_.*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -b*B*Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*(n + 1)) + 1/(n + 1)* Int[(d*Csc[e + f*x])^n* Simp[A*a*(n + 1) + B*b*n + (A*b + B*a)*(n + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && Not[LeQ[n, -1]]
Int[csc[e_. + f_.*x_]*(A_ + B_.*csc[e_. + f_.*x_])/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := B/b*Int[Csc[e + f*x], x] + (A*b - a*B)/b* Int[Csc[e + f*x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) /; FreeQ[{a, b, A, B, e, f, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[a*B*m + A*b*(m + 1), 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(a*f*(2*m + 1)) + (a*B*m + A*b*(m + 1))/(a*b*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[a*B*m + A*b*(m + 1), 0] && LtQ[m, -1/2]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + (a*B*m + A*b*(m + 1))/(b*(m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] /; FreeQ[{a, b, A, B, e, f, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[a*B*m + A*b*(m + 1), 0] && Not[LtQ[m, -1/2]]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + 1/(m + 1)* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)* Simp[b*B*m + a*A*(m + 1) + (a*B*m + A*b*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -(A*b - a*B)* Cot[e + f* x]*(a + b*Csc[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[(a*A - b*B)*(m + 1) - (A*b - a*B)*(m + 2)*Csc[e + f*x], x], x] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[e_. + f_.*x_]*(A_ + B_.*csc[e_. + f_.*x_])/ Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := -2*(A*b - a*B)*Rt[a + b*B/A, 2]*Sqrt[b*(1 - Csc[e + f*x])/(a + b)]* Sqrt[-b*(1 + Csc[e + f*x])/(a - b)]/(b^2*f*Cot[e + f*x])* EllipticE[ ArcSin[Sqrt[a + b*Csc[e + f*x]]/ Rt[a + b*B/A, 2]], (a*A + b*B)/(a*A - b*B)] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[a^2 - b^2, 0] && EqQ[A^2 - B^2, 0]
Int[csc[e_. + f_.*x_]*(A_ + B_.*csc[e_. + f_.*x_])/ Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := (A - B)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + B*Int[Csc[e + f*x]*(1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[a^2 - b^2, 0] && NeQ[A^2 - B^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := 2*Sqrt[2]*A*(a + b*Csc[e + f*x])^m*(A - B*Csc[e + f*x])* Sqrt[(A + B*Csc[e + f*x])/A]/(B*f* Cot[e + f*x]*(A*(a + b*Csc[e + f*x])/(a*A + b*B))^m)* AppellF1[1/2, -(1/2), -m, 3/2, (A - B*Csc[e + f*x])/(2*A), (b*(A - B*Csc[e + f*x]))/(A*b + a*B)] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && EqQ[A^2 - B^2, 0] && Not[IntegerQ[2*m]]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)/b*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] + B/b*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, A, B, e, f, m}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(b*f*(2*m + 1)) + 1/(b^2*(2*m + 1))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[A*b*m - a*B*m + b*B*(2*m + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := a*(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) - 1/(b*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[b*(A*b - a*B)*(m + 1) - (a*A*b*(m + 2) - B*(a^2 + b^2*(m + 1)))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m* Simp[b*B*(m + 1) + (A*b*(m + 2) - a*B)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && Not[LtQ[m, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) /; FreeQ[{a, b, d, e, f, A, B, m, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && EqQ[a*A*m - b*B*n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(b*f*(2*m + 1)) + (a*A*m + b*B*(m + 1))/(a^2*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && LeQ[m, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - (a*A*m - b*B*n)/(b*d*n)* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, A, B, m, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && Not[LeQ[m, -1]]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -2*b*B* Cot[e + f*x]*(d*Csc[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]]) /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[A*b*(2*n + 1) + 2*a*B*n, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*b^2* Cot[e + f*x]*(d*Csc[e + f*x])^n/(a*f*n*Sqrt[a + b*Csc[e + f*x]]) + (A*b*(2*n + 1) + 2*a*B*n)/(2*a*d*n)* Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[A*b*(2*n + 1) + 2*a*B*n, 0] && LtQ[n, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -2*b*B* Cot[e + f*x]*(d*Csc[e + f*x])^ n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]]) + (A*b*(2*n + 1) + 2*a*B*n)/(b*(2*n + 1))* Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[A*b*(2*n + 1) + 2*a*B*n, 0] && Not[LtQ[n, 0]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := a*A*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^ n/(f*n) - b/(a*d*n)* Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)* Simp[a*A*(m - n - 1) - b*B*n - (a*B*n + A*b*(m + n))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 1/2] && LtQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -b*B*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^ n/(f*(m + n)) + 1/(d*(m + n))* Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^n* Simp[a*A*d*(m + n) + B*(b*d*n) + (A*b*d*(m + n) + a*B*d*(2*m + n - 1))* Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 1/2] && Not[LtQ[n, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := d*(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 1)/(a*f*(2*m + 1)) - 1/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)* Simp[A*(a*d*(n - 1)) - B*(b*d*(n - 1)) - d*(a*B*(m - n + 1) + A*b*(m + n))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2] && GtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(b*f*(2*m + 1)) - 1/(a^2*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* Simp[b*B*n - a*A*(2*m + n + 1) + (A*b - a*B)*(m + n + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2] && Not[GtQ[n, 0]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 1)/(f*(m + n)) + d/(b*(m + n))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 1)* Simp[b*B*(n - 1) + (A*b*(m + n) + a*B*m)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && GtQ[n, 1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - 1/(b*d*n)* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[a*A*m - b*B*n - A*b*(m + n + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := (A*b - a*B)/b*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n, x] + B/b*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^2*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := a^2*A*Cos[e + f*x]*(d*Csc[e + f*x])^(n + 1)/(d*f*n) + 1/(d*n)* Int[(d*Csc[e + f*x])^(n + 1)*(a*(2*A*b + a*B)* n + (2*a*b*B*n + A*(b^2*n + a^2*(n + 1)))*Csc[e + f*x] + b^2*B*n*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := a*A*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^ n/(f*n) + 1/(d*n)*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^(n + 1)* Simp[a*(a*B*n - A*b*(m - n - 1)) + (2*a*b*B*n + A*(b^2*n + a^2*(1 + n)))*Csc[e + f*x] + b*(b*B*n + a*A*(m + n))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -b*B*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^ n/(f*(m + n)) + 1/(m + n)*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^n* Simp[a^2*A*(m + n) + a*b*B*n + (a*(2*A*b + a*B)*(m + n) + b^2*B*(m + n - 1))* Csc[e + f*x] + b*(A*b*(m + n) + a*B*(2*m + n - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && Not[IGtQ[n, 1] && Not[IntegerQ[m]]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -d*(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 - b^2)) + 1/((m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)* Simp[d*(n - 1)*(A*b - a*B) + d*(a*A - b*B)*(m + 1)*Csc[e + f*x] - d*(A*b - a*B)*(m + n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[0, n, 1]
Int[csc[e_. + f_.*x_]^3*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -a^2*(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b^2* f*(m + 1)*(a^2 - b^2)) + 1/(b^2*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[a*b*(A*b - a*B)*(m + 1) - (A*b - a*B)*(a^2 + b^2*(m + 1))* Csc[e + f*x] + b*B*(m + 1)*(a^2 - b^2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := a*d^2*(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)/(b*f*(m + 1)*(a^2 - b^2)) - d/(b*(m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)* Simp[a*d*(A*b - a*B)*(n - 2) + b*d*(A*b - a*B)*(m + 1)* Csc[e + f*x] - (a*A*b*d*(m + n) - d*B*(a^2*(n - 1) + b^2*(m + 1)))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := b*(A*b - a*B)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* Simp[A*(a^2*(m + 1) - b^2*(m + n + 1)) + a*b*B*n - a*(A*b - a*B)*(m + 1)*Csc[e + f*x] + b*(A*b - a*B)*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && Not[ILtQ[m + 1/2, 0] && ILtQ[n, 0]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n - 1)/(f*(m + n)) + d/(m + n)* Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n - 1)* Simp[a*B*(n - 1) + (b*B*(m + n - 1) + a*A*(m + n))* Csc[e + f*x] + (a*B*m + A*b*(m + n))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 1] && GtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - 1/(d*n)*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)* Simp[A*b*m - a*B*n - (b*B*n + a*A*(n + 1))*Csc[e + f*x] - A*b*(m + n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 1] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := -B*d^2* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)/(b*f*(m + n)) + d^2/(b*(m + n))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 2)* Simp[a*B*(n - 2) + B*b*(m + n - 1)*Csc[e + f*x] + (A*b*(m + n) - a*B*(n - 1))* Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[n, 1] && NeQ[m + n, 0] && Not[IGtQ[m, 1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := A*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*n) + 1/(a*d*n)*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[a*B*n - A*b*(m + n + 1) + A*a*(n + 1)*Csc[e + f*x] + A*b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[(A_ + B_.*csc[e_. + f_.*x_])/(Sqrt[d_.*csc[e_. + f_.*x_]]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]), x_Symbol] := A/a*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] - (A*b - a*B)/(a*d)* Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[d_.*csc[e_. + f_.*x_]]*(A_ + B_.*csc[e_. + f_.*x_])/ Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := A*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + B/d*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[a_ + b_.*csc[e_. + f_.*x_]]*(A_ + B_.*csc[e_. + f_.*x_])/ Sqrt[d_.*csc[e_. + f_.*x_]], x_Symbol] := B/d*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]], x] + A*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[(d_.*csc[e_. + f_.*x_])^ n_*(A_ + B_.*csc[e_. + f_.*x_])/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := A/a*Int[(d*Csc[e + f*x])^n, x] - (A*b - a*B)/(a*d)* Int[(d*Csc[e + f*x])^(n + 1)/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_.*(A_ + B_.*csc[e_. + f_.*x_]), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^ n*(A + B*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, B, m, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
(* Int[(a_+b_.*csc[e_.+f_.*x_])^m_.*(c_+d_.*csc[e_.+f_.*x_])^n_.*(A_.+ B_.*csc[e_.+f_.*x_])^p_.,x_Symbol] := (-a*c)^m*Int[Cot[e+f*x]^(2*m)*(c+d*Csc[e+f*x])^(n-m)*(A+B*Csc[e+f*x] )^p,x] /; FreeQ[{a,b,c,d,e,f,A,B,n,p},x] && EqQ[b*c+a*d,0] && EqQ[a^2-b^2,0] &&  IntegerQ[m] && Not[IntegerQ[n] && (LtQ[m,0] && GtQ[n,0] || LtQ[0,n,m] ||  LtQ[m,n,0])] *)
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_ + d_.*csc[e_. + f_.*x_])^ n_.*(A_. + B_.*csc[e_. + f_.*x_])^p_., x_Symbol] := (-a*c)^m* Int[Cos[e + f*x]^(2*m)*(d + c*Sin[e + f*x])^(n - m)*(B + A*Sin[e + f*x])^p/Sin[e + f*x]^(m + n + p), x] /; FreeQ[{a, b, c, d, e, f, A, B, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n, p]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.4.1 (a+b sec)^m (A+B sec+C sec^2).m
*)

(* ::Subsection::Closed:: *)
(* 4.5.4.1 (a+b sec)^m (A+B sec+C sec^2) *)
Int[(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := 1/b^2* Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[b*B - a*C + b*C*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := C/b^2* Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[-a + b*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[(b_.*csc[e_. + f_.*x_])^m_.*(A_ + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[e + f*x]*(b*Csc[e + f*x])^m/(f*m) /; FreeQ[{b, e, f, A, C, m}, x] && EqQ[C*m + A*(m + 1), 0]
Int[csc[e_. + f_.*x_]^m_.*(A_ + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := Int[(C + A*Sin[e + f*x]^2)/Sin[e + f*x]^(m + 2), x] /; FreeQ[{e, f, A, C}, x] && NeQ[C*m + A*(m + 1), 0] && ILtQ[(m + 1)/2, 0]
Int[(b_.*csc[e_. + f_.*x_])^m_.*(A_ + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[e + f*x]*(b*Csc[e + f*x])^m/(f*m) + (C*m + A*(m + 1))/(b^2*m)*Int[(b*Csc[e + f*x])^(m + 2), x] /; FreeQ[{b, e, f, A, C}, x] && NeQ[C*m + A*(m + 1), 0] && LeQ[m, -1]
Int[(b_.*csc[e_. + f_.*x_])^m_.*(A_ + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(b*Csc[e + f*x])^m/(f*(m + 1)) + (C*m + A*(m + 1))/(m + 1)*Int[(b*Csc[e + f*x])^m, x] /; FreeQ[{b, e, f, A, C, m}, x] && NeQ[C*m + A*(m + 1), 0] && Not[LeQ[m, -1]]
Int[(b_.*csc[e_. + f_.*x_])^ m_.*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := B/b*Int[(b*Csc[e + f*x])^(m + 1), x] + Int[(b*Csc[e + f*x])^m*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m}, x]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -b*C*Csc[e + f*x]*Cot[e + f*x]/(2*f) + 1/2* Int[Simp[ 2*A*a + (2*B*a + b*(2*A + C))*Csc[e + f*x] + 2*(a*C + B*b)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -b*C*Csc[e + f*x]*Cot[e + f*x]/(2*f) + 1/2* Int[Simp[2*A*a + b*(2*A + C)*Csc[e + f*x] + 2*a*C*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x]
Int[(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2)/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := C/b*Int[Csc[e + f*x], x] + 1/b*Int[(A*b + (b*B - a*C)*Csc[e + f*x])/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B, C}, x]
Int[(A_. + C_.*csc[e_. + f_.*x_]^2)/(a_ + b_.*csc[e_. + f_.*x_]), x_Symbol] := C/b*Int[Csc[e + f*x], x] + 1/b*Int[(A*b - a*C*Csc[e + f*x])/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, A, C}, x]
Int[(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -(a*A - b*B + a*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(a*f*(2*m + 1)) + 1/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[A*b*(2*m + 1) + (b*B*(m + 1) - a*(A*(m + 1) - C*m))* Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -a*(A + C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(a*f*(2*m + 1)) + 1/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[A*b*(2*m + 1) - a*(A*(m + 1) - C*m)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + 1/(b*(m + 1))* Int[(a + b*Csc[e + f*x])^m* Simp[A*b*(m + 1) + (a*C*m + b*B*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + 1/(b*(m + 1))* Int[(a + b*Csc[e + f*x])^m* Simp[A*b*(m + 1) + a*C*m*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^ m_.*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + 1/(m + 1)*Int[(a + b*Csc[e + f*x])^(m - 1)* Simp[a*A*(m + 1) + ((A*b + a*B)*(m + 1) + b*C*m)* Csc[e + f*x] + (b*B*(m + 1) + a*C*m)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && IGtQ[2*m, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(m + 1)) + 1/(m + 1)* Int[(a + b*Csc[e + f*x])^(m - 1)* Simp[a*A*(m + 1) + (A*b*(m + 1) + b*C*m)*Csc[e + f*x] + a*C*m*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && IGtQ[2*m, 0]
Int[(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2)/ Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := Int[(A + (B - C)*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] + C*Int[Csc[e + f*x]*(1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[(A_. + C_.*csc[e_. + f_.*x_]^2)/Sqrt[a_ + b_.*csc[e_. + f_.*x_]], x_Symbol] := Int[(A - C*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] + C*Int[Csc[e + f*x]*(1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 - a*b*B + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(a* f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))*Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[A*(a^2 - b^2)*(m + 1) - a*(A*b - a*B + b*C)*(m + 1)* Csc[e + f*x] + (A*b^2 - a*b*B + a^2*C)*(m + 2)* Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(a* f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))*Int[(a + b*Csc[e + f*x])^(m + 1)* Simp[A*(a^2 - b^2)*(m + 1) - a*b*(A + C)*(m + 1)*Csc[e + f*x] + (A*b^2 + a^2*C)*(m + 2)* Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[2*m] && LtQ[m, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := 1/b*Int[(a + b*Csc[e + f*x])^m*(A*b + (b*B - a*C)*Csc[e + f*x]), x] + C/b*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] && Not[IntegerQ[2*m]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := 1/b*Int[(a + b*Csc[e + f*x])^m*(A*b - a*C*Csc[e + f*x]), x] + C/b*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] && Not[IntegerQ[2*m]]
Int[(b_.*cos[e_. + f_.*x_])^ m_*(A_. + B_.*sec[e_. + f_.*x_] + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := b^2*Int[(b*Cos[e + f*x])^(m - 2)*(C + B*Cos[e + f*x] + A*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := b^2*Int[(b*Sin[e + f*x])^(m - 2)*(C + B*Sin[e + f*x] + A*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_])^m_*(A_. + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := b^2*Int[(b*Cos[e + f*x])^(m - 2)*(C + A*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_])^m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := b^2*Int[(b*Sin[e + f*x])^(m - 2)*(C + A*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m}, x] && Not[IntegerQ[m]]
Int[(a_.*(b_.*sec[e_. + f_.*x_])^p_)^ m_*(A_. + B_.*sec[e_. + f_.*x_] + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := a^IntPart[m]*(a*(b*Sec[e + f*x])^p)^ FracPart[m]/(b*Sec[e + f*x])^(p*FracPart[m])* Int[(b*Sec[e + f*x])^(m*p)*(A + B*Sec[e + f*x] + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B, C, m, p}, x] && Not[IntegerQ[m]]
Int[(a_.*(b_.*csc[e_. + f_.*x_])^p_)^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := a^IntPart[m]*(a*(b*Csc[e + f*x])^p)^ FracPart[m]/(b*Csc[e + f*x])^(p*FracPart[m])* Int[(b*Csc[e + f*x])^(m*p)*(A + B*Csc[e + f*x] + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B, C, m, p}, x] && Not[IntegerQ[m]]
Int[(a_.*(b_.*sec[e_. + f_.*x_])^p_)^ m_*(A_. + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := a^IntPart[m]*(a*(b*Sec[e + f*x])^p)^ FracPart[m]/(b*Sec[e + f*x])^(p*FracPart[m])* Int[(b*Sec[e + f*x])^(m*p)*(A + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, C, m, p}, x] && Not[IntegerQ[m]]
Int[(a_.*(b_.*csc[e_. + f_.*x_])^p_)^ m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := a^IntPart[m]*(a*(b*Csc[e + f*x])^p)^ FracPart[m]/(b*Csc[e + f*x])^(p*FracPart[m])* Int[(b*Csc[e + f*x])^(m*p)*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, C, m, p}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.4.2 (a+b sec)^m (d sec)^n (A+B sec+C sec^2).m
*)

(* ::Subsection::Closed:: *)
(* 4.5.4.2 (a+b sec)^m (d sec)^n (A+B sec+C sec^2) *)
Int[(a_. + b_.*csc[e_. + f_.*x_])^m_.*(c_. + d_.*csc[e_. + f_.*x_])^ n_.*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := 1/b^2* Int[(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^ n*(b*B - a*C + b*C*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_. + b_.*csc[e_. + f_.*x_])^m_.*(c_. + d_.*csc[e_. + f_.*x_])^ n_.*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C/b^2* Int[(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^ n*(a - b*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*a*Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*n) + 1/(d*n)* Int[(d*Csc[e + f*x])^(n + 1)* Simp[n*(B*a + A*b) + (n*(a*C + B*b) + A*a*(n + 1))* Csc[e + f*x] + b*C*n*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && LtQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*a*Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*n) + 1/(d*n)* Int[(d*Csc[e + f*x])^(n + 1)* Simp[A*b*n + a*(C*n + A*(n + 1))*Csc[e + f*x] + b*C*n*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && LtQ[n, -1]
Int[(d_.*csc[e_. + f_.*x_])^ n_.*(a_ + b_.*csc[e_. + f_.*x_])*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -b*C*Csc[e + f*x]*Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*(n + 2)) + 1/(n + 2)* Int[(d*Csc[e + f*x])^n* Simp[A*a*(n + 2) + (B*a*(n + 2) + b*(C*(n + 1) + A*(n + 2)))* Csc[e + f*x] + (a*C + B*b)*(n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && Not[LtQ[n, -1]]
Int[(d_.*csc[e_. + f_.*x_])^ n_.*(a_ + b_.*csc[e_. + f_.*x_])*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -b*C*Csc[e + f*x]*Cot[e + f*x]*(d*Csc[e + f*x])^n/(f*(n + 2)) + 1/(n + 2)* Int[(d*Csc[e + f*x])^n* Simp[A*a*(n + 2) + b*(C*(n + 1) + A*(n + 2))*Csc[e + f*x] + a*C*(n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && Not[LtQ[n, -1]]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -(a*A - b*B + a*C)*Cot[e + f*x]* Csc[e + f*x]*(a + b*Csc[e + f*x])^m/(a*f*(2*m + 1)) - 1/(a*b*(2*m + 1))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[a*B - b*C - 2*A*b*(m + 1) - (b*B*(m + 2) - a*(A*(m + 2) - C*(m - 1)))* Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -(A + C)*Cot[e + f*x]* Csc[e + f*x]*(a + b*Csc[e + f*x])^m/(f*(2*m + 1)) - 1/(a*b*(2*m + 1))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[-b*C - 2*A*b*(m + 1) + a*(A*(m + 2) - C*(m - 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -(A*b^2 - a*b*B + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[b*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C + b*(A*b - a*B + b*C)*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -(A*b^2 + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[a*b*(A + C)*(m + 1) - (A*b^2 + a^2*C + b*(A*b + b*C)*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m* Simp[b*A*(m + 2) + b*C*(m + 1) + (b*B*(m + 2) - a*C)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && Not[LtQ[m, -1]]
Int[csc[e_. + f_.*x_]*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m* Simp[b*A*(m + 2) + b*C*(m + 1) - a*C*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && Not[LtQ[m, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -(a*A - b*B + a*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(a*f*(2*m + 1)) - 1/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* Simp[a*B*n - b*C*n - A*b*(2*m + n + 1) - (b*B*(m + n + 1) - a*(A*(m + n + 1) - C*(m - n)))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -a*(A + C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(a*f*(2*m + 1)) + 1/(a*b*(2*m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* Simp[b*C*n + A*b*(2*m + n + 1) - (a*(A*(m + n + 1) - C*(m - n)))* Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1/2]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - 1/(b*d*n)* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[a*A*m - b*B*n - b*(A*(m + n + 1) + C*n)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && (LtQ[n, -1/2] || EqQ[m + n + 1, 0])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - 1/(b*d*n)* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[a*A*m - b*(A*(m + n + 1) + C*n)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, C, m}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && (LtQ[n, -1/2] || EqQ[m + n + 1, 0])
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(m + n + 1)) + 1/(b*(m + n + 1))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n* Simp[A*b*(m + n + 1) + b*C*n + (a*C*m + b*B*(m + n + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && Not[LtQ[n, -1/2]] && NeQ[m + n + 1, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(m + n + 1)) + 1/(b*(m + n + 1))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n* Simp[A*b*(m + n + 1) + b*C*n + a*C*m*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, C, m, n}, x] && EqQ[a^2 - b^2, 0] && Not[LtQ[m, -1/2]] && Not[LtQ[n, -1/2]] && NeQ[m + n + 1, 0]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := a*(A*b^2 - a*b*B + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b^2* f*(m + 1)*(a^2 - b^2)) - 1/(b^2*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[b*(m + 1)*(-a*(b*B - a*C) + A*b^2) + (b*B*(a^2 + b^2*(m + 1)) - a*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1))))*Csc[e + f*x] - b*C*(m + 1)*(a^2 - b^2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := a*(A*b^2 + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b^2* f*(m + 1)*(a^2 - b^2)) - 1/(b^2*(m + 1)*(a^2 - b^2))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)* Simp[b*(m + 1)*(a^2*C + A*b^2) - a*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1)))*Csc[e + f*x] - b*C*(m + 1)*(a^2 - b^2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Csc[e + f*x]* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 3)) + 1/(b*(m + 3))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m* Simp[a*C + b*(C*(m + 2) + A*(m + 3))* Csc[e + f*x] - (2*a*C - b*B*(m + 3))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
Int[csc[e_. + f_.*x_]^2*(a_ + b_.*csc[e_. + f_.*x_])^ m_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Csc[e + f*x]* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 3)) + 1/(b*(m + 3))* Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m* Simp[a*C + b*(C*(m + 2) + A*(m + 3))*Csc[e + f*x] - 2*a*C*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] && Not[LtQ[m, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - 1/(d*n)*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)* Simp[A*b*m - a*B*n - (b*B*n + a*(C*n + A*(n + 1)))*Csc[e + f*x] - b*(C*n + A*(m + n + 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n/(f*n) - 1/(d*n)*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)* Simp[A*b*m - a*(C*n + A*(n + 1))*Csc[e + f*x] - b*(C*n + A*(m + n + 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(m + n + 1)) + 1/(m + n + 1)*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^n* Simp[a*A*(m + n + 1) + a*C*n + ((A*b + a*B)*(m + n + 1) + b*C*(m + n))* Csc[e + f*x] + (b*B*(m + n + 1) + a*C*m)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && Not[LeQ[n, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*Cot[e + f*x]*(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^n/(f*(m + n + 1)) + 1/(m + n + 1)*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^n* Simp[a*A*(m + n + 1) + a*C*n + b*(A*(m + n + 1) + C*(m + n))*Csc[e + f*x] + a*C*m*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && Not[LeQ[n, -1]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -d*(A*b^2 - a*b*B + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)/(b*f*(a^2 - b^2)*(m + 1)) + d/(b*(a^2 - b^2)*(m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)* Simp[A*b^2*(n - 1) - a*(b*B - a*C)*(n - 1) + b*(a*A - b*B + a*C)*(m + 1)*Csc[e + f*x] - (b*(A*b - a*B)*(m + n + 1) + C*(a^2*n + b^2*(m + 1)))* Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -d*(A*b^2 + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)/(b*f*(a^2 - b^2)*(m + 1)) + d/(b*(a^2 - b^2)*(m + 1))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)* Simp[A*b^2*(n - 1) + a^2*C*(n - 1) + a*b*(A + C)*(m + 1)* Csc[e + f*x] - (A*b^2*(m + n + 1) + C*(a^2*n + b^2*(m + 1)))* Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 - a*b*B + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* Simp[a*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C)*(m + n + 1) - a*(A*b - a*B + b*C)*(m + 1)*Csc[e + f*x] + (A*b^2 - a*b*B + a^2*C)*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && Not[ILtQ[m + 1/2, 0] && ILtQ[n, 0]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := (A*b^2 + a^2*C)* Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*(m + 1)*(a^2 - b^2)) + 1/(a*(m + 1)*(a^2 - b^2))* Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n* Simp[a^2*(A + C)*(m + 1) - (A*b^2 + a^2*C)*(m + n + 1) - a*b*(A + C)*(m + 1)* Csc[e + f*x] + (A*b^2 + a^2*C)*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && Not[ILtQ[m + 1/2, 0] && ILtQ[n, 0]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*d*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)/(b*f*(m + n + 1)) + d/(b*(m + n + 1))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 1)* Simp[a*C*(n - 1) + (A*b*(m + n + 1) + b*C*(m + n))* Csc[e + f*x] + (b*B*(m + n + 1) - a*C*n)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 0] (* && Not[IGtQ[m,0] && Not[IntegerQ[n]]] *)
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := -C*d*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)/(b*f*(m + n + 1)) + d/(b*(m + n + 1))* Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 1)* Simp[a*C*(n - 1) + (A*b*(m + n + 1) + b*C*(m + n))* Csc[e + f*x] - a*C*n*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 0] (* && Not[IGtQ[m,0] && Not[IntegerQ[n]]] *)
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*n) + 1/(a*d*n)*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[a*B*n - A*b*(m + n + 1) + a*(A + A*n + C*n)*Csc[e + f*x] + A*b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_*(d_.*csc[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := A*Cot[ e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^ n/(a*f*n) + 1/(a*d*n)*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)* Simp[-A*b*(m + n + 1) + a*(A + A*n + C*n)*Csc[e + f*x] + A*b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2)/(Sqrt[ d_.*csc[e_. + f_.*x_]]*(a_ + b_.*csc[e_. + f_.*x_])), x_Symbol] := (A*b^2 - a*b*B + a^2*C)/(a^2*d^2)* Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] + 1/a^2* Int[(a*A - (A*b - a*B)*Csc[e + f*x])/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[(A_. + C_.*csc[e_. + f_.*x_]^2)/(Sqrt[ d_.*csc[e_. + f_.*x_]]*(a_ + b_.*csc[e_. + f_.*x_])), x_Symbol] := (A*b^2 + a^2*C)/(a^2*d^2)* Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] + 1/a^2*Int[(a*A - A*b*Csc[e + f*x])/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2)/(Sqrt[d_.*csc[e_. + f_.*x_]]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]), x_Symbol] := C/d^2*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] + Int[(A + B*Csc[e + f*x])/(Sqrt[d*Csc[e + f*x]]* Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[(A_. + C_.*csc[e_. + f_.*x_]^2)/(Sqrt[d_.*csc[e_. + f_.*x_]]* Sqrt[a_ + b_.*csc[e_. + f_.*x_]]), x_Symbol] := C/d^2*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] + A*Int[1/(Sqrt[d*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(d_.*csc[e_. + f_.*x_])^ n_.*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^ n*(A + B*Csc[e + f*x] + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B, C, m, n}, x]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(d_.*csc[e_. + f_.*x_])^ n_.*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^ n*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, C, m, n}, x]
Int[(a_ + b_.*sec[e_. + f_.*x_])^m_.*(d_.*cos[e_. + f_.*x_])^ n_*(A_. + B_.*sec[e_. + f_.*x_] + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := d^(m + 2)* Int[(b + a*Cos[e + f*x])^ m*(d*Cos[e + f*x])^(n - m - 2)*(C + B*Cos[e + f*x] + A*Cos[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(d_.*sin[e_. + f_.*x_])^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := d^(m + 2)* Int[(b + a*Sin[e + f*x])^ m*(d*Sin[e + f*x])^(n - m - 2)*(C + B*Sin[e + f*x] + A*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_ + b_.*sec[e_. + f_.*x_])^m_.*(d_.*cos[e_. + f_.*x_])^ n_*(A_. + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := d^(m + 2)* Int[(b + a*Cos[e + f*x])^ m*(d*Cos[e + f*x])^(n - m - 2)*(C + A*Cos[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(d_.*sin[e_. + f_.*x_])^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := d^(m + 2)* Int[(b + a*Sin[e + f*x])^ m*(d*Sin[e + f*x])^(n - m - 2)*(C + A*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[(a_ + b_.*sec[e_. + f_.*x_])^m_.*(c_.*(d_.*sec[e_. + f_.*x_])^p_)^ n_*(A_. + B_.*sec[e_. + f_.*x_] + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := c^IntPart[n]*(c*(d*Sec[e + f*x])^p)^ FracPart[n]/(d*Sec[e + f*x])^(p*FracPart[n])* Int[(a + b*Sec[e + f*x])^ m*(d*Sec[e + f*x])^(n*p)*(A + B*Sec[e + f*x] + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] && Not[IntegerQ[n]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_.*(d_.*csc[e_. + f_.*x_])^p_)^ n_*(A_. + B_.*csc[e_. + f_.*x_] + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := c^IntPart[n]*(c*(d*Csc[e + f*x])^p)^ FracPart[n]/(d*Csc[e + f*x])^(p*FracPart[n])* Int[(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n*p)*(A + B*Csc[e + f*x] + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] && Not[IntegerQ[n]]
Int[(a_ + b_.*sec[e_. + f_.*x_])^m_.*(c_.*(d_.*sec[e_. + f_.*x_])^p_)^ n_*(A_. + C_.*sec[e_. + f_.*x_]^2), x_Symbol] := c^IntPart[n]*(c*(d*Sec[e + f*x])^p)^ FracPart[n]/(d*Sec[e + f*x])^(p*FracPart[n])* Int[(a + b*Sec[e + f*x])^ m*(d*Sec[e + f*x])^(n*p)*(A + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n, p}, x] && Not[IntegerQ[n]]
Int[(a_ + b_.*csc[e_. + f_.*x_])^m_.*(c_.*(d_.*csc[e_. + f_.*x_])^p_)^ n_*(A_. + C_.*csc[e_. + f_.*x_]^2), x_Symbol] := c^IntPart[n]*(c*(d*Csc[e + f*x])^p)^ FracPart[n]/(d*Csc[e + f*x])^(p*FracPart[n])* Int[(a + b*Csc[e + f*x])^ m*(d*Csc[e + f*x])^(n*p)*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n, p}, x] && Not[IntegerQ[n]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.7 (d trig)^m (a+b (c sec)^n)^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.7 (d trig)^m (a+b (c sec)^n)^p *)
Int[u_.*(a_ + b_.*sec[e_. + f_.*x_]^2)^p_, x_Symbol] := b^p*Int[ActivateTrig[u*tan[e + f*x]^(2*p)], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0] && IntegerQ[p]
Int[u_.*(a_ + b_.*sec[e_. + f_.*x_]^2)^p_, x_Symbol] := Int[ActivateTrig[u*(b*tan[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0]
Int[(b_.*sec[e_. + f_.*x_]^2)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, b*ff/f* Subst[Int[(b + b*ff^2*x^2)^(p - 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{b, e, f, p}, x] && Not[IntegerQ[p]]
Int[(b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_, x_Symbol] := b^IntPart[p]*(b*(c*Sec[e + f*x])^n)^ FracPart[p]/(c*Sec[e + f*x])^(n*FracPart[p])* Int[(c*Sec[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] && Not[IntegerQ[p]]
Int[tan[e_. + f_.*x_]^m_.*(b_.*sec[e_. + f_.*x_]^2)^p_., x_Symbol] := b/(2*f)* Subst[Int[(-1 + x)^((m - 1)/2)*(b*x)^(p - 1), x], x, Sec[e + f*x]^2] /; FreeQ[{b, e, f, p}, x] && Not[IntegerQ[p]] && IntegerQ[(m - 1)/2]
Int[u_.*(b_.*sec[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, (b*ff^n)^ IntPart[p]*(b*Sec[e + f*x]^n)^ FracPart[p]/(Sec[e + f*x]/ff)^(n*FracPart[p])* Int[ActivateTrig[u]*(Sec[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] && Not[IntegerQ[p]] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[u_.*(b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_, x_Symbol] := b^IntPart[p]*(b*(c*Sec[e + f*x])^n)^ FracPart[p]/(c*Sec[e + f*x])^(n*FracPart[p])* Int[ActivateTrig[u]*(c*Sec[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] && Not[IntegerQ[p]] && Not[IntegerQ[n]] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[1/(a_ + b_.*sec[e_. + f_.*x_]^2), x_Symbol] := x/a - b/a*Int[1/(b + a*Cos[e + f*x]^2), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0]
Int[(a_ + b_.*sec[e_. + f_.*x_]^2)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + b + b*ff^2*x^2)^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && NeQ[a + b, 0] && NeQ[p, -1]
Int[(a_ + b_.*sec[e_. + f_.*x_]^4)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + b + 2*b*ff^2*x^2 + b*ff^4*x^4)^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[2*p]
Int[(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + b*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[n/2] && IGtQ[p, -2]
Int[(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_, x_Symbol] := Unintegrable[(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*ExpandToSum[a + b*(1 + ff^2*x^2)^(n/2), x]^ p/(1 + ff^2*x^2)^(m/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(b + a*(ff*x)^n)^ p/(ff*x)^(n*p), x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, 1/(f*ff^m)* Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*(a + b*(c*ff*x)^n)^p/ x^(m + 1), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (GtQ[m, 0] || EqQ[n, 2] || EqQ[n, 4])
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_ + b_.*sec[e_. + f_.*x_]^n_.)^p_., x_Symbol] := d^(n*p)* Int[(d*Cos[e + f*x])^(m - n*p)*(b + a*Cos[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && IntegersQ[n, p]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/d)^FracPart[m]* Int[(Sec[e + f*x]/d)^(-m)*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_., x_Symbol] := Module[{ff = FreeFactors[Cos[e + f*x], x]}, -1/(f*ff^(m + n*p - 1))* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(b + a*(ff*x)^n)^p/ x^(m + n*p), x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, 1/f* Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*(a + b*(c*ff*x)^n)^p/x, x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (GtQ[m, 0] || EqQ[n, 2] || EqQ[n, 4] || IGtQ[p, 0] || IntegersQ[2*n, p])
Int[(d_.*tan[e_. + f_.*x_])^m_*(b_.*sec[e_. + f_.*x_]^2)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, b*ff/f* Subst[Int[(d*ff*x)^m*(b + b*ff^2*x^2)^(p - 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{b, d, e, f, m, p}, x]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_., x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^ m*(a + b*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && IntegerQ[n/2] && (IntegerQ[m/2] || EqQ[n, 2])
Int[(d_.*tan[e_. + f_.*x_])^m_*(b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_., x_Symbol] := d*(d*Tan[e + f*x])^(m - 1)*(b*(c*Sec[e + f*x])^n)^ p/(f*(p*n + m - 1)) - d^2*(m - 1)/(p*n + m - 1)* Int[(d*Tan[e + f*x])^(m - 2)*(b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{b, c, d, e, f, p, n}, x] && GtQ[m, 1] && NeQ[p*n + m - 1, 0] && IntegersQ[2*p*n, 2*m]
Int[(d_.*tan[e_. + f_.*x_])^m_*(b_.*(c_.*sec[e_. + f_.*x_])^n_)^p_., x_Symbol] := (d*Tan[e + f*x])^(m + 1)*(b*(c*Sec[e + f*x])^n)^p/(d*f*(m + 1)) - (p*n + m + 1)/(d^2*(m + 1))* Int[(d*Tan[e + f*x])^(m + 2)*(b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{b, c, d, e, f, p, n}, x] && LtQ[m, -1] && NeQ[p*n + m + 1, 0] && IntegersQ[2*p*n, 2*m]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*cot[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^FracPart[m]* Int[(Tan[e + f*x]/d)^(-m)*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[sec[e_. + f_.*x_]^m_*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(1 + ff^2*x^2)^(m/2 - 1)* ExpandToSum[a + b*(1 + ff^2*x^2)^(n/2), x]^p, x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sec[e_. + f_.*x_]^m_.*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[ ExpandToSum[b + a*(1 - ff^2*x^2)^(n/2), x]^ p/(1 - ff^2*x^2)^((m + n*p + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sec[e_. + f_.*x_]^m_.*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_, x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(a + b/(1 - ff^2*x^2)^(n/2))^ p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && Not[IntegerQ[p]]
Int[sec[e_. + f_.*x_]^m_.*(a_ + b_.*sec[e_. + f_.*x_]^n_)^p_, x_Symbol] := Int[ExpandTrig[sec[e + f*x]^m*(a + b*sec[e + f*x]^n)^p, x], x] /; FreeQ[{a, b, e, f}, x] && IntegersQ[m, n, p]
Int[(d_.*sec[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^ p_., x_Symbol] := Unintegrable[(d*Sec[e + f*x])^m*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sec[e_. + f_.*x_])^n_)^ p_, x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]* Int[(Sin[e + f*x]/d)^(-m)*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.5 Secant/4.5.9 trig^m (a+b sec^n+c sec^(2 n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.5.9 trig^m (a+b sec^n+c sec^(2 n))^p *)
Int[(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := 1/(4^p*c^p)*Int[(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Sec[d + e*x]^n + c*Sec[d + e*x]^(2*n))^ p/(b + 2*c*Sec[d + e*x]^n)^(2*p)* Int[u*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Csc[d + e*x]^n + c*Csc[d + e*x]^(2*n))^ p/(b + 2*c*Csc[d + e*x]^n)^(2*p)* Int[u*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[1/(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Sec[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Sec[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Csc[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Csc[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cos[d + e*x], x]}, -f/e* Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*(b + a*(f*x)^n)^p/(f*x)^(n*p), x], x, Cos[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegersQ[n, p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Sin[d + e*x], x]}, f/e* Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*(b + a*(f*x)^n)^p/(f*x)^(n*p), x], x, Sin[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegersQ[n, p]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*sec[d_. + e_.*x_]^n_ + c_.*sec[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*csc[d_. + e_.*x_]^n_ + c_.*csc[d_. + e_.*x_]^n2_)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sec[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Sec[d + e*x]^m*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[csc[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := 1/(4^p*c^p)*Int[Csc[d + e*x]^m*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sec[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Sec[d + e*x]^n + c*Sec[d + e*x]^(2*n))^ p/(b + 2*c*Sec[d + e*x]^n)^(2*p)* Int[Sec[d + e*x]^m*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[csc[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := (a + b*Csc[d + e*x]^n + c*Csc[d + e*x]^(2*n))^ p/(b + 2*c*Csc[d + e*x]^n)^(2*p)* Int[Csc[d + e*x]^m*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[sec[d_. + e_.*x_]^ m_.*(a_. + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := Int[ExpandTrig[ sec[d + e*x]^m*(a + b*sec[d + e*x]^n + c*sec[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegersQ[m, n, p]
Int[csc[d_. + e_.*x_]^ m_.*(a_. + b_.*csc[d_. + e_.*x_]^n_. + c_.*csc[d_. + e_.*x_]^n2_.)^p_, x_Symbol] := Int[ExpandTrig[ csc[d + e*x]^m*(a + b*csc[d + e*x]^n + c*csc[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegersQ[m, n, p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*sec[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Cos[d + e*x], x]}, -1/(e*f^(m + n*p - 1))* Subst[Int[(1 - f^2*x^2)^((m - 1)/ 2)*(c + b*(f*x)^n + c*(f*x)^(2*n))^p/x^(m + 2*n*p), x], x, Cos[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*csc[d_. + e_.*x_]^n_. + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Sin[d + e*x], x]}, 1/(e*f^(m + n*p - 1))* Subst[Int[(1 - f^2*x^2)^((m - 1)/ 2)*(c + b*(f*x)^n + c*(f*x)^(2*n))^p/x^(m + 2*n*p), x], x, Sin[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_ + b_.*sec[d_. + e_.*x_]^n_ + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[cot[d_. + e_.*x_]^ m_.*(a_ + b_.*csc[d_. + e_.*x_]^n_ + c_.*sec[d_. + e_.*x_]^n2_.)^ p_., x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, -f^(m + 1)/e* Subst[Int[ x^m*ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[(A_ + B_.*sec[d_. + e_.*x_])*(a_ + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Sec[d + e*x])*(b + 2*c*Sec[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*csc[d_. + e_.*x_])*(a_ + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2)^n_, x_Symbol] := 1/(4^n*c^n)* Int[(A + B*Csc[d + e*x])*(b + 2*c*Csc[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*sec[d_. + e_.*x_])*(a_ + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Sec[d + e*x] + c*Sec[d + e*x]^2)^ n/(b + 2*c*Sec[d + e*x])^(2*n)* Int[(A + B*Sec[d + e*x])*(b + 2*c*Sec[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*csc[d_. + e_.*x_])*(a_ + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2)^n_, x_Symbol] := (a + b*Csc[d + e*x] + c*Csc[d + e*x]^2)^ n/(b + 2*c*Csc[d + e*x])^(2*n)* Int[(A + B*Csc[d + e*x])*(b + 2*c*Csc[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*sec[d_. + e_.*x_])/(a_. + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Sec[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Sec[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*csc[d_. + e_.*x_])/(a_. + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Csc[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Csc[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*sec[d_. + e_.*x_])*(a_. + b_.*sec[d_. + e_.*x_] + c_.*sec[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*sec[d + e*x])*(a + b*sec[d + e*x] + c*sec[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*csc[d_. + e_.*x_])*(a_. + b_.*csc[d_. + e_.*x_] + c_.*csc[d_. + e_.*x_]^2)^n_, x_Symbol] := Int[ExpandTrig[(A + B*csc[d + e*x])*(a + b*csc[d + e*x] + c*csc[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/(a sin(m x) + b cos(n x))^p.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcTan[x]]+b*Sin[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[n/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  -1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[m*ArcCot[x]]+b*Cos[n*ArcCot[x]]]]^p/(1+x^2),x],x,Cot[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[n/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcTan[x]]+b*Sin[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[m*ArcTan[x]]+b*Cos[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  -1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcCos[x]]+b*Sin[n*ArcCos[x]]]]^p/Sqrt[1-x^2],x],x,Cos[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[(p-1)/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[m*ArcSin[x]]+b*Cos[n*ArcSin[x]]]]^p/Sqrt[1-x^2],x],x,Sin[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[(p-1)/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  2/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[2*m*ArcTan[x]]+b*Sin[2*n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[1/2*(c+d*x)]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  -2/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[2*m*ArcCot[x]]+b*Cos[2*n*ArcCot[x]]]]^p/(1+x^2),x],x,Cot[1/2*(c+d*x)]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcTan[x]]+b*Cos[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[n/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcSin[x]]+b*Cos[n*ArcSin[x]]]]^p/Sqrt[1-x^2],x],x,Sin[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[(p-1)/2,0] && IntegerQ[m/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  2/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[2*m*ArcTan[x]]+b*Cos[2*n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[1/2*(c+d*x)]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m] && IntegerQ[n]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcTan[x]]+b*Sin[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[n/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  -1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[m*ArcCot[x]]+b*Cos[n*ArcCot[x]]]]^p/(1+x^2),x],x,Cot[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[n/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcTan[x]]+b*Sin[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[m*ArcTan[x]]+b*Cos[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  -1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcCos[x]]+b*Sin[n*ArcCos[x]]]]^p/Sqrt[1-x^2],x],x,Cos[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[(p-1)/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[m*ArcSin[x]]+b*Cos[n*ArcSin[x]]]]^p/Sqrt[1-x^2],x],x,Sin[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[(p-1)/2,0] && IntegerQ[(m-1)/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*sin[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  2/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[2*m*ArcTan[x]]+b*Sin[2*n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[1/2*(c+d*x)]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*cos[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  -2/d \[Star] Subst[Int[Simplify[TrigExpand[a*Cos[2*m*ArcCot[x]]+b*Cos[2*n*ArcCot[x]]]]^p/(1+x^2),x],x,Cot[1/2*(c+d*x)]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcTan[x]]+b*Cos[n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m/2] && IntegerQ[n/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  1/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[m*ArcSin[x]]+b*Cos[n*ArcSin[x]]]]^p/Sqrt[1-x^2],x],x,Sin[c+d*x]] /;
FreeQ[{a,b,c,d},x] && ILtQ[(p-1)/2,0] && IntegerQ[m/2] && IntegerQ[(n-1)/2]


(* ::Code:: *)
Int[(a_.*sin[m_.*(c_.+d_.*x_)]+b_.*cos[n_.*(c_.+d_.*x_)])^p_,x_Symbol] :=
  2/d \[Star] Subst[Int[Simplify[TrigExpand[a*Sin[2*m*ArcTan[x]]+b*Cos[2*n*ArcTan[x]]]]^p/(1+x^2),x],x,Tan[1/2*(c+d*x)]] /;
FreeQ[{a,b,c,d},x] && ILtQ[p,0] && IntegerQ[m] && IntegerQ[n]




(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.1 Sine normalization rules.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.1 Sine normalization rules *)
Int[u_*(c_.*tan[a_. + b_.*x_])^m_.*(d_.*sin[a_. + b_.*x_])^n_., x_Symbol] := (c*Tan[a + b*x])^m*(d*Cos[a + b*x])^m/(d*Sin[a + b*x])^m* Int[ActivateTrig[u]*(d*Sin[a + b*x])^(m + n)/(d*Cos[a + b*x])^m, x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_.*(d_.*cos[a_. + b_.*x_])^n_., x_Symbol] := (c*Tan[a + b*x])^m*(d*Cos[a + b*x])^m/(d*Sin[a + b*x])^m* Int[ActivateTrig[u]*(d*Sin[a + b*x])^m/(d*Cos[a + b*x])^(m - n), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_.*(d_.*sin[a_. + b_.*x_])^n_., x_Symbol] := (c*Cot[a + b*x])^m*(d*Sin[a + b*x])^m/(d*Cos[a + b*x])^m* Int[ActivateTrig[u]*(d*Cos[a + b*x])^m/(d*Sin[a + b*x])^(m - n), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_.*(d_.*cos[a_. + b_.*x_])^n_., x_Symbol] := (c*Cot[a + b*x])^m*(d*Sin[a + b*x])^m/(d*Cos[a + b*x])^m* Int[ActivateTrig[u]*(d*Cos[a + b*x])^(m + n)/(d*Sin[a + b*x])^m, x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*sec[a_. + b_.*x_])^m_.*(d_.*cos[a_. + b_.*x_])^n_., x_Symbol] := (c*Sec[a + b*x])^m*(d*Cos[a + b*x])^m* Int[ActivateTrig[u]*(d*Cos[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*sec[a_. + b_.*x_])^m_.*(d_.*cos[a_. + b_.*x_])^n_., x_Symbol] := (c*Csc[a + b*x])^m*(d*Sin[a + b*x])^m* Int[ActivateTrig[u]*(d*Sin[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_., x_Symbol] := (c*Tan[a + b*x])^m*(c*Cos[a + b*x])^m/(c*Sin[a + b*x])^m* Int[ActivateTrig[u]*(c*Sin[a + b*x])^m/(c*Cos[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_., x_Symbol] := (c*Cot[a + b*x])^m*(c*Sin[a + b*x])^m/(c*Cos[a + b*x])^m* Int[ActivateTrig[u]*(c*Cos[a + b*x])^m/(c*Sin[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*sec[a_. + b_.*x_])^m_., x_Symbol] := (c*Sec[a + b*x])^m*(c*Cos[a + b*x])^m* Int[ActivateTrig[u]/(c*Cos[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*csc[a_. + b_.*x_])^m_., x_Symbol] := (c*Csc[a + b*x])^m*(c*Sin[a + b*x])^m* Int[ActivateTrig[u]/(c*Sin[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*sin[a_. + b_.*x_])^n_.*(A_ + B_.*csc[a_. + b_.*x_]), x_Symbol] := c*Int[ ActivateTrig[u]*(c*Sin[a + b*x])^(n - 1)*(B + A*Sin[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(c_.*cos[a_. + b_.*x_])^n_.*(A_ + B_.*sec[a_. + b_.*x_]), x_Symbol] := c*Int[ ActivateTrig[u]*(c*Cos[a + b*x])^(n - 1)*(B + A*Cos[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_ + B_.*csc[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(B + A*Sin[a + b*x])/Sin[a + b*x], x] /; FreeQ[{a, b, A, B}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_ + B_.*sec[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(B + A*Cos[a + b*x])/Cos[a + b*x], x] /; FreeQ[{a, b, A, B}, x] && KnownSineIntegrandQ[u, x]
Int[u_.*(c_.*sin[a_. + b_.*x_])^ n_.*(A_. + B_.*csc[a_. + b_.*x_] + C_.*csc[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[ u]*(c*Sin[a + b*x])^(n - 2)*(C + B*Sin[a + b*x] + A*Sin[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_.*(c_.*cos[a_. + b_.*x_])^ n_.*(A_. + B_.*sec[a_. + b_.*x_] + C_.*sec[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[ u]*(c*Cos[a + b*x])^(n - 2)*(C + B*Cos[a + b*x] + A*Cos[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_.*(c_.*sin[a_. + b_.*x_])^n_.*(A_ + C_.*csc[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[u]*(c*Sin[a + b*x])^(n - 2)*(C + A*Sin[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_.*(c_.*cos[a_. + b_.*x_])^n_.*(A_ + C_.*sec[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[u]*(c*Cos[a + b*x])^(n - 2)*(C + A*Cos[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_. + B_.*csc[a_. + b_.*x_] + C_.*csc[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + B*Sin[a + b*x] + A*Sin[a + b*x]^2)/ Sin[a + b*x]^2, x] /; FreeQ[{a, b, A, B, C}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_. + B_.*sec[a_. + b_.*x_] + C_.*sec[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + B*Cos[a + b*x] + A*Cos[a + b*x]^2)/ Cos[a + b*x]^2, x] /; FreeQ[{a, b, A, B, C}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_ + C_.*csc[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + A*Sin[a + b*x]^2)/Sin[a + b*x]^2, x] /; FreeQ[{a, b, A, C}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_ + C_.*sec[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + A*Cos[a + b*x]^2)/Cos[a + b*x]^2, x] /; FreeQ[{a, b, A, C}, x] && KnownSineIntegrandQ[u, x]
Int[u_*(A_. + B_.*sin[a_. + b_.*x_] + C_.*csc[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(C + A*Sin[a + b*x] + B*Sin[a + b*x]^2)/ Sin[a + b*x], x] /; FreeQ[{a, b, A, B, C}, x]
Int[u_*(A_. + B_.*cos[a_. + b_.*x_] + C_.*sec[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(C + A*Cos[a + b*x] + B*Cos[a + b*x]^2)/ Cos[a + b*x], x] /; FreeQ[{a, b, A, B, C}, x]
Int[u_*(A_.*sin[a_. + b_.*x_]^n_. + B_.*sin[a_. + b_.*x_]^n1_ + C_.*sin[a_. + b_.*x_]^n2_), x_Symbol] := Int[ActivateTrig[u]* Sin[a + b*x]^n*(A + B*Sin[a + b*x] + C*Sin[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]
Int[u_*(A_.*cos[a_. + b_.*x_]^n_. + B_.*cos[a_. + b_.*x_]^n1_ + C_.*cos[a_. + b_.*x_]^n2_), x_Symbol] := Int[ActivateTrig[u]* Cos[a + b*x]^n*(A + B*Cos[a + b*x] + C*Cos[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.2 Tangent normalization rules.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.2 Tangent normalization rules *)
Int[u_*(c_.*cot[a_. + b_.*x_])^m_.*(d_.*tan[a_. + b_.*x_])^n_., x_Symbol] := (c*Cot[a + b*x])^m*(d*Tan[a + b*x])^m* Int[ActivateTrig[u]*(d*Tan[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownTangentIntegrandQ[u, x]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_.*(d_.*cos[a_. + b_.*x_])^n_., x_Symbol] := (c*Tan[a + b*x])^m*(d*Cos[a + b*x])^m/(d*Sin[a + b*x])^m* Int[ActivateTrig[u]*(d*Sin[a + b*x])^m/(d*Cos[a + b*x])^(m - n), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_., x_Symbol] := (c*Cot[a + b*x])^m*(c*Tan[a + b*x])^m* Int[ActivateTrig[u]/(c*Tan[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownTangentIntegrandQ[u, x]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_., x_Symbol] := (c*Cot[a + b*x])^m*(c*Tan[a + b*x])^m* Int[ActivateTrig[u]/(c*Cot[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownCotangentIntegrandQ[u, x]
Int[u_*(c_.*tan[a_. + b_.*x_])^n_.*(A_ + B_.*cot[a_. + b_.*x_]), x_Symbol] := c*Int[ ActivateTrig[u]*(c*Tan[a + b*x])^(n - 1)*(B + A*Tan[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownTangentIntegrandQ[u, x]
Int[u_*(c_.*cot[a_. + b_.*x_])^n_.*(A_ + B_.*tan[a_. + b_.*x_]), x_Symbol] := c*Int[ ActivateTrig[u]*(c*Cot[a + b*x])^(n - 1)*(B + A*Cot[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_*(A_ + B_.*cot[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(B + A*Tan[a + b*x])/Tan[a + b*x], x] /; FreeQ[{a, b, A, B}, x] && KnownTangentIntegrandQ[u, x]
Int[u_*(A_ + B_.*tan[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(B + A*Cot[a + b*x])/Cot[a + b*x], x] /; FreeQ[{a, b, A, B}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_.*(c_.*tan[a_. + b_.*x_])^ n_.*(A_. + B_.*cot[a_. + b_.*x_] + C_.*cot[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[ u]*(c*Tan[a + b*x])^(n - 2)*(C + B*Tan[a + b*x] + A*Tan[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownTangentIntegrandQ[u, x]
Int[u_.*(c_.*cot[a_. + b_.*x_])^ n_.*(A_. + B_.*tan[a_. + b_.*x_] + C_.*tan[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[ u]*(c*Cot[a + b*x])^(n - 2)*(C + B*Cot[a + b*x] + A*Cot[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_.*(c_.*tan[a_. + b_.*x_])^n_.*(A_ + C_.*cot[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[u]*(c*Tan[a + b*x])^(n - 2)*(C + A*Tan[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownTangentIntegrandQ[u, x]
Int[u_.*(c_.*cot[a_. + b_.*x_])^n_.*(A_ + C_.*tan[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[u]*(c*Cot[a + b*x])^(n - 2)*(C + A*Cot[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_*(A_. + B_.*cot[a_. + b_.*x_] + C_.*cot[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + B*Tan[a + b*x] + A*Tan[a + b*x]^2)/ Tan[a + b*x]^2, x] /; FreeQ[{a, b, A, B, C}, x] && KnownTangentIntegrandQ[u, x]
Int[u_*(A_. + B_.*tan[a_. + b_.*x_] + C_.*tan[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + B*Cot[a + b*x] + A*Cot[a + b*x]^2)/ Cot[a + b*x]^2, x] /; FreeQ[{a, b, A, B, C}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_*(A_ + C_.*cot[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + A*Tan[a + b*x]^2)/Tan[a + b*x]^2, x] /; FreeQ[{a, b, A, C}, x] && KnownTangentIntegrandQ[u, x]
Int[u_*(A_ + C_.*tan[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + A*Cot[a + b*x]^2)/Cot[a + b*x]^2, x] /; FreeQ[{a, b, A, C}, x] && KnownCotangentIntegrandQ[u, x]
Int[u_*(A_. + B_.*tan[a_. + b_.*x_] + C_.*cot[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(C + A*Tan[a + b*x] + B*Tan[a + b*x]^2)/ Tan[a + b*x], x] /; FreeQ[{a, b, A, B, C}, x]
Int[u_*(A_.*tan[a_. + b_.*x_]^n_. + B_.*tan[a_. + b_.*x_]^n1_ + C_.*tan[a_. + b_.*x_]^n2_), x_Symbol] := Int[ActivateTrig[u]* Tan[a + b*x]^n*(A + B*Tan[a + b*x] + C*Tan[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]
Int[u_*(A_.*cot[a_. + b_.*x_]^n_. + B_.*cot[a_. + b_.*x_]^n1_ + C_.*cot[a_. + b_.*x_]^n2_), x_Symbol] := Int[ActivateTrig[u]* Cot[a + b*x]^n*(A + B*Cot[a + b*x] + C*Cot[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.3 Secant normalization rules.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.3 Secant normalization rules *)
Int[u_*(c_.*sin[a_. + b_.*x_])^m_.*(d_.*csc[a_. + b_.*x_])^n_., x_Symbol] := (c*Sin[a + b*x])^m*(d*Csc[a + b*x])^m* Int[ActivateTrig[u]*(d*Csc[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*cos[a_. + b_.*x_])^m_.*(d_.*sec[a_. + b_.*x_])^n_., x_Symbol] := (c*Cos[a + b*x])^m*(d*Sec[a + b*x])^m* Int[ActivateTrig[u]*(d*Sec[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_.*(d_.*sec[a_. + b_.*x_])^n_., x_Symbol] := (c*Tan[a + b*x])^m*(d*Csc[a + b*x])^m/(d*Sec[a + b*x])^m* Int[ActivateTrig[u]*(d*Sec[a + b*x])^(m + n)/(d*Csc[a + b*x])^m, x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_.*(d_.*csc[a_. + b_.*x_])^n_., x_Symbol] := (c*Tan[a + b*x])^m*(d*Csc[a + b*x])^m/(d*Sec[a + b*x])^m* Int[ActivateTrig[u]*(d*Sec[a + b*x])^m/(d*Csc[a + b*x])^(m - n), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_.*(d_.*sec[a_. + b_.*x_])^n_., x_Symbol] := (c*Cot[a + b*x])^m*(d*Sec[a + b*x])^m/(d*Csc[a + b*x])^m* Int[ActivateTrig[u]*(d*Csc[a + b*x])^m/(d*Sec[a + b*x])^(m - n), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_.*(d_.*csc[a_. + b_.*x_])^n_., x_Symbol] := (c*Cot[a + b*x])^m*(d*Sec[a + b*x])^m/(d*Csc[a + b*x])^m* Int[ActivateTrig[u]*(d*Csc[a + b*x])^(m + n)/(d*Sec[a + b*x])^m, x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] && Not[IntegerQ[m]]
Int[u_*(c_.*sin[a_. + b_.*x_])^m_., x_Symbol] := (c*Csc[a + b*x])^m*(c*Sin[a + b*x])^m* Int[ActivateTrig[u]/(c*Csc[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*cos[a_. + b_.*x_])^m_., x_Symbol] := (c*Cos[a + b*x])^m*(c*Sec[a + b*x])^m* Int[ActivateTrig[u]/(c*Sec[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*tan[a_. + b_.*x_])^m_., x_Symbol] := (c*Tan[a + b*x])^m*(c*Csc[a + b*x])^m/(c*Sec[a + b*x])^m* Int[ActivateTrig[u]*(c*Sec[a + b*x])^m/(c*Csc[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*cot[a_. + b_.*x_])^m_., x_Symbol] := (c*Cot[a + b*x])^m*(c*Sec[a + b*x])^m/(c*Csc[a + b*x])^m* Int[ActivateTrig[u]*(c*Csc[a + b*x])^m/(c*Sec[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] && Not[IntegerQ[m]] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*sec[a_. + b_.*x_])^n_.*(A_ + B_.*cos[a_. + b_.*x_]), x_Symbol] := c*Int[ ActivateTrig[u]*(c*Sec[a + b*x])^(n - 1)*(B + A*Sec[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(c_.*csc[a_. + b_.*x_])^n_.*(A_ + B_.*sin[a_. + b_.*x_]), x_Symbol] := c*Int[ ActivateTrig[u]*(c*Csc[a + b*x])^(n - 1)*(B + A*Csc[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_ + B_.*cos[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(B + A*Sec[a + b*x])/Sec[a + b*x], x] /; FreeQ[{a, b, A, B}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_ + B_.*sin[a_. + b_.*x_]), x_Symbol] := Int[ActivateTrig[u]*(B + A*Csc[a + b*x])/Csc[a + b*x], x] /; FreeQ[{a, b, A, B}, x] && KnownSecantIntegrandQ[u, x]
Int[u_.*(c_.*sec[a_. + b_.*x_])^ n_.*(A_. + B_.*cos[a_. + b_.*x_] + C_.*cos[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[ u]*(c*Sec[a + b*x])^(n - 2)*(C + B*Sec[a + b*x] + A*Sec[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_.*(c_.*csc[a_. + b_.*x_])^ n_.*(A_. + B_.*sin[a_. + b_.*x_] + C_.*sin[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[ u]*(c*Csc[a + b*x])^(n - 2)*(C + B*Csc[a + b*x] + A*Csc[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_.*(c_.*sec[a_. + b_.*x_])^n_.*(A_ + C_.*cos[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[u]*(c*Sec[a + b*x])^(n - 2)*(C + A*Sec[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_.*(c_.*csc[a_. + b_.*x_])^n_.*(A_ + C_.*sin[a_. + b_.*x_]^2), x_Symbol] := c^2*Int[ ActivateTrig[u]*(c*Csc[a + b*x])^(n - 2)*(C + A*Csc[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_. + B_.*cos[a_. + b_.*x_] + C_.*cos[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + B*Sec[a + b*x] + A*Sec[a + b*x]^2)/ Sec[a + b*x]^2, x] /; FreeQ[{a, b, A, B, C}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_. + B_.*sin[a_. + b_.*x_] + C_.*sin[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + B*Csc[a + b*x] + A*Csc[a + b*x]^2)/ Csc[a + b*x]^2, x] /; FreeQ[{a, b, A, B, C}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_ + C_.*cos[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + A*Sec[a + b*x]^2)/Sec[a + b*x]^2, x] /; FreeQ[{a, b, A, C}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_ + C_.*sin[a_. + b_.*x_]^2), x_Symbol] := Int[ActivateTrig[u]*(C + A*Csc[a + b*x]^2)/Csc[a + b*x]^2, x] /; FreeQ[{a, b, A, C}, x] && KnownSecantIntegrandQ[u, x]
Int[u_*(A_.*sec[a_. + b_.*x_]^n_. + B_.*sec[a_. + b_.*x_]^n1_ + C_.*sec[a_. + b_.*x_]^n2_), x_Symbol] := Int[ActivateTrig[u]* Sec[a + b*x]^n*(A + B*Sec[a + b*x] + C*Sec[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]
Int[u_*(A_.*csc[a_. + b_.*x_]^n_. + B_.*csc[a_. + b_.*x_]^n1_ + C_.*csc[a_. + b_.*x_]^n2_), x_Symbol] := Int[ActivateTrig[u]* Csc[a + b*x]^n*(A + B*Csc[a + b*x] + C*Csc[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.4 (c trig)^m (d trig)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.4 (c trig)^m (d trig)^n *)
Int[sin[a_. + b_.*x_]*sin[c_. + d_.*x_], x_Symbol] := Sin[a - c + (b - d)*x]/(2*(b - d)) - Sin[a + c + (b + d)*x]/(2*(b + d)) /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[cos[a_. + b_.*x_]*cos[c_. + d_.*x_], x_Symbol] := Sin[a - c + (b - d)*x]/(2*(b - d)) + Sin[a + c + (b + d)*x]/(2*(b + d)) /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[sin[a_. + b_.*x_]*cos[c_. + d_.*x_], x_Symbol] := -Cos[a - c + (b - d)*x]/(2*(b - d)) - Cos[a + c + (b + d)*x]/(2*(b + d)) /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[cos[a_. + b_.*x_]^2*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := 1/2*Int[(g*Sin[c + d*x])^p, x] + 1/2*Int[Cos[c + d*x]*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IGtQ[p/2, 0]
Int[sin[a_. + b_.*x_]^2*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := 1/2*Int[(g*Sin[c + d*x])^p, x] - 1/2*Int[Cos[c + d*x]*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IGtQ[p/2, 0]
Int[(e_.*cos[a_. + b_.*x_])^m_.*sin[c_. + d_.*x_]^p_., x_Symbol] := 2^p/e^p*Int[(e*Cos[a + b*x])^(m + p)*Sin[a + b*x]^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IntegerQ[p]
Int[(f_.*sin[a_. + b_.*x_])^n_.*sin[c_. + d_.*x_]^p_., x_Symbol] := 2^p/f^p*Int[Cos[a + b*x]^p*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, f, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IntegerQ[p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 1)/(2*b* g*(p + 1)) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0]
Int[(e_.*sin[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e^2*(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 1)/(2*b* g*(p + 1)) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + p - 1, 0]
Int[(e_.*cos[a_. + b_.*x_])^m_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Cos[a + b*x])^m*(g*Sin[c + d*x])^(p + 1)/(b*g*m) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + 2*p + 2, 0]
Int[(e_.*sin[a_. + b_.*x_])^m_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (e*Sin[a + b*x])^m*(g*Sin[c + d*x])^(p + 1)/(b*g*m) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + 2*p + 2, 0]
Int[(e_.*cos[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 1)/(2*b* g*(p + 1)) + e^4*(m + p - 1)/(4*g^2*(p + 1))* Int[(e*Cos[a + b*x])^(m - 4)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 2] && LtQ[p, -1] && (GtQ[m, 3] || EqQ[p, -3/2]) && IntegersQ[2*m, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e^2*(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 1)/(2*b* g*(p + 1)) + e^4*(m + p - 1)/(4*g^2*(p + 1))* Int[(e*Sin[a + b*x])^(m - 4)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 2] && LtQ[p, -1] && (GtQ[m, 3] || EqQ[p, -3/2]) && IntegersQ[2*m, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (e*Cos[a + b*x])^m*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1)) + e^2*(m + 2*p + 2)/(4*g^2*(p + 1))* Int[(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + 2*p + 2, 0] && (LtQ[p, -2] || EqQ[m, 2]) && IntegersQ[2*m, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Sin[a + b*x])^m*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1)) + e^2*(m + 2*p + 2)/(4*g^2*(p + 1))* Int[(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + 2*p + 2, 0] && (LtQ[p, -2] || EqQ[m, 2]) && IntegersQ[2*m, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 1)/(2*b* g*(m + 2*p)) + e^2*(m + p - 1)/(m + 2*p)* Int[(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && NeQ[m + 2*p, 0] && IntegersQ[2*m, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e^2*(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 1)/(2*b* g*(m + 2*p)) + e^2*(m + p - 1)/(m + 2*p)* Int[(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && NeQ[m + 2*p, 0] && IntegersQ[2*m, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Cos[a + b*x])^ m*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(m + p + 1)) + (m + 2*p + 2)/(e^2*(m + p + 1))* Int[(e*Cos[a + b*x])^(m + 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && NeQ[m + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (e*Sin[a + b*x])^m*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(m + p + 1)) + (m + 2*p + 2)/(e^2*(m + p + 1))* Int[(e*Sin[a + b*x])^(m + 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && NeQ[m + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[cos[a_. + b_.*x_]*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := 2*Sin[a + b*x]*(g*Sin[c + d*x])^p/(d*(2*p + 1)) + 2*p*g/(2*p + 1)*Int[Sin[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[p, 0] && IntegerQ[2*p]
Int[sin[a_. + b_.*x_]*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -2*Cos[a + b*x]*(g*Sin[c + d*x])^p/(d*(2*p + 1)) + 2*p*g/(2*p + 1)*Int[Cos[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[p, 0] && IntegerQ[2*p]
Int[cos[a_. + b_.*x_]*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := Cos[a + b*x]*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1)) + (2*p + 3)/(2*g*(p + 1))* Int[Sin[a + b*x]*(g*Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[p, -1] && IntegerQ[2*p]
Int[sin[a_. + b_.*x_]*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -Sin[a + b*x]*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1)) + (2*p + 3)/(2*g*(p + 1))* Int[Cos[a + b*x]*(g*Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[p, -1] && IntegerQ[2*p]
Int[cos[a_. + b_.*x_]/Sqrt[sin[c_. + d_.*x_]], x_Symbol] := -ArcSin[Cos[a + b*x] - Sin[a + b*x]]/d + Log[Cos[a + b*x] + Sin[a + b*x] + Sqrt[Sin[c + d*x]]]/d /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2]
Int[sin[a_. + b_.*x_]/Sqrt[sin[c_. + d_.*x_]], x_Symbol] := -ArcSin[Cos[a + b*x] - Sin[a + b*x]]/d - Log[Cos[a + b*x] + Sin[a + b*x] + Sqrt[Sin[c + d*x]]]/d /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2]
Int[(g_.*sin[c_. + d_.*x_])^p_/cos[a_. + b_.*x_], x_Symbol] := 2*g*Int[Sin[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && IntegerQ[2*p]
Int[(g_.*sin[c_. + d_.*x_])^p_/sin[a_. + b_.*x_], x_Symbol] := 2*g*Int[Cos[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && IntegerQ[2*p]
(* Int[(e_.*cos[a_.+b_.*x_])^m_*(g_.*sin[c_.+d_.*x_])^p_,x_Symbol] := -(e*Cos[a+b*x])^(m+1)*Sin[a+b*x]*(g*Sin[c+d*x])^p/(b*e*(m+p+1)*(Sin[ a+b*x]^2)^((p+1)/2))* Hypergeometric2F1[-(p-1)/2,(m+p+1)/2,(m+p+3)/2,Cos[a+b*x]^2] /; FreeQ[{a,b,c,d,e,g,m,p},x] && EqQ[b*c-a*d,0] && EqQ[d/b,2] &&  Not[IntegerQ[p]] && Not[IntegerQ[m+p]] *)
(* Int[(f_.*sin[a_.+b_.*x_])^n_.*(g_.*sin[c_.+d_.*x_])^p_,x_Symbol] := -Cos[a+b*x]*(f*Sin[a+b*x])^(n+1)*(g*Sin[c+d*x])^p/(b*f*(p+1)*(Sin[a+ b*x]^2)^((n+p+1)/2))* Hypergeometric2F1[-(n+p-1)/2,(p+1)/2,(p+3)/2,Cos[a+b*x]^2] /; FreeQ[{a,b,c,d,f,g,n,p},x] && EqQ[b*c-a*d,0] && EqQ[d/b,2] &&  Not[IntegerQ[p]] && Not[IntegerQ[n+p]] *)
Int[(e_.*cos[a_. + b_.*x_])^m_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (g*Sin[c + d*x])^p/((e*Cos[a + b*x])^p*Sin[a + b*x]^p)* Int[(e*Cos[a + b*x])^(m + p)*Sin[a + b*x]^p, x] /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]]
Int[(f_.*sin[a_. + b_.*x_])^n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (g*Sin[c + d*x])^p/(Cos[a + b*x]^p*(f*Sin[a + b*x])^p)* Int[Cos[a + b*x]^p*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]]
Int[cos[a_. + b_.*x_]^2* sin[a_. + b_.*x_]^2*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := 1/4*Int[(g*Sin[c + d*x])^p, x] - 1/4*Int[Cos[c + d*x]^2*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IGtQ[p/2, 0]
Int[(e_.*cos[a_. + b_.*x_])^m_.*(f_.*sin[a_. + b_.*x_])^n_.* sin[c_. + d_.*x_]^p_., x_Symbol] := 2^p/(e^p*f^p)* Int[(e*Cos[a + b*x])^(m + p)*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IntegerQ[p]
Int[(e_.*cos[a_. + b_.*x_])^m_.*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e*(e*Cos[a + b*x])^(m - 1)*(f*Sin[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*f*(n + p + 1)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + p + 1, 0]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e*(e*Sin[a + b*x])^(m - 1)*(f*Cos[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*f*(n + p + 1)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + p + 1, 0]
Int[(e_.*cos[a_. + b_.*x_])^m_.*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*e*f*(m + p + 1)) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && EqQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0]
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^ n*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1)) + e^4*(m + p - 1)/(4*g^2*(n + p + 1))* Int[(e*Cos[a + b*x])^(m - 4)*(f*Sin[a + b*x])^ n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 3] && LtQ[p, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e^2*(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^ n*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1)) + e^4*(m + p - 1)/(4*g^2*(n + p + 1))* Int[(e*Sin[a + b*x])^(m - 4)*(f*Cos[a + b*x])^ n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 3] && LtQ[p, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (e*Cos[a + b*x])^m*(f*Sin[a + b*x])^ n*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1)) + e^2*(m + n + 2*p + 2)/(4*g^2*(n + p + 1))* Int[(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^ n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p] && (LtQ[p, -2] || EqQ[m, 2] || EqQ[m, 3])
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Sin[a + b*x])^m*(f*Cos[a + b*x])^ n*(g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1)) + e^2*(m + n + 2*p + 2)/(4*g^2*(n + p + 1))* Int[(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^ n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p] && (LtQ[p, -2] || EqQ[m, 2] || EqQ[m, 3])
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e*(e*Cos[a + b*x])^(m - 1)*(f*Sin[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*f*(n + p + 1)) + e^2*(m + p - 1)/(f^2*(n + p + 1))* Int[(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^(n + 2)*(g* Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && LtQ[n, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e*(e*Sin[a + b*x])^(m - 1)*(f*Cos[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*f*(n + p + 1)) + e^2*(m + p - 1)/(f^2*(n + p + 1))* Int[(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^(n + 2)*(g* Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && LtQ[n, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := e*(e*Cos[a + b*x])^(m - 1)*(f*Sin[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*f*(m + n + 2*p)) + e^2*(m + p - 1)/(m + n + 2*p)* Int[(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^n*(g*Sin[c + d*x])^ p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -e*(e*Sin[a + b*x])^(m - 1)*(f*Cos[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*f*(m + n + 2*p)) + e^2*(m + p - 1)/(m + n + 2*p)* Int[(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^n*(g*Sin[c + d*x])^ p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && GtQ[m, 1] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -f*(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n - 1)*(g*Sin[c + d*x])^p/(b*e*(m + n + 2*p)) + 2*f*g*(n + p - 1)/(e*(m + n + 2*p))* Int[(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n - 1)*(g* Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && GtQ[n, 0] && GtQ[p, 0] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := f*(e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n - 1)*(g*Sin[c + d*x])^p/(b*e*(m + n + 2*p)) + 2*f*g*(n + p - 1)/(e*(m + n + 2*p))* Int[(e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n - 1)*(g* Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && GtQ[n, 0] && GtQ[p, 0] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*e*f*(m + p + 1)) + f*(m + n + 2*p + 2)/(2*e*g*(m + p + 1))* Int[(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n - 1)*(g* Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && GtQ[n, 0] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n + 1)*(g*Sin[c + d*x])^ p/(b*e*f*(m + p + 1)) + f*(m + n + 2*p + 2)/(2*e*g*(m + p + 1))* Int[(e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n - 1)*(g* Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && GtQ[n, 0] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*cos[a_. + b_.*x_])^m_*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := -(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n + 1)*(g*Sin[c + d*x])^p/(b*e*f*(m + p + 1)) + (m + n + 2*p + 2)/(e^2*(m + p + 1))* Int[(e*Cos[a + b*x])^(m + 2)*(f*Sin[a + b*x])^n*(g*Sin[c + d*x])^ p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[(e_.*sin[a_. + b_.*x_])^m_*(f_.*cos[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n + 1)*(g*Sin[c + d*x])^ p/(b*e*f*(m + p + 1)) + (m + n + 2*p + 2)/(e^2*(m + p + 1))* Int[(e*Sin[a + b*x])^(m + 2)*(f*Cos[a + b*x])^n*(g*Sin[c + d*x])^ p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]] && LtQ[m, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
(* Int[(e_.*cos[a_.+b_.*x_])^m_*(f_.*sin[a_.+b_.*x_])^n_.*(g_.*sin[c_. +d_.*x_])^p_,x_Symbol] := -(e*Cos[a+b*x])^(m+1)*(f*Sin[a+b*x])^(n+1)*(g*Sin[c+d*x])^p/(b*e*f*( m+p+1)*(Sin[a+b*x]^2)^((n+p+1)/2))* Hypergeometric2F1[-(n+p-1)/2,(m+p+1)/2,(m+p+3)/2,Cos[a+b*x]^2] /; FreeQ[{a,b,c,d,e,f,g,m,n,p},x] && EqQ[b*c-a*d,0] && EqQ[d/b,2] &&  Not[IntegerQ[p]] && Not[IntegerQ[m+p]] && Not[IntegerQ[n+p]] *)
Int[(e_.*cos[a_. + b_.*x_])^m_.*(f_.*sin[a_. + b_.*x_])^ n_.*(g_.*sin[c_. + d_.*x_])^p_, x_Symbol] := (g*Sin[c + d*x])^p/((e*Cos[a + b*x])^p*(f*Sin[a + b*x])^p)* Int[(e*Cos[a + b*x])^(m + p)*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && Not[IntegerQ[p]]
Int[(e_.*cos[a_. + b_.*x_])^m_.*sin[c_. + d_.*x_], x_Symbol] := -(m + 2)*(e*Cos[a + b*x])^(m + 1)* Cos[(m + 1)*(a + b*x)]/(d*e*(m + 1)) /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, Abs[m + 2]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.5 Inert trig functions.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.5 Inert trig functions *)
Int[(a_.*F_[c_. + d_.*x_]^p_)^n_, x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*(v/NonfreeFactors[v, x])^(p*IntPart[n])*(a*v^p)^ FracPart[n]/NonfreeFactors[v, x]^(p*FracPart[n])* Int[NonfreeFactors[v, x]^(n*p), x]] /; FreeQ[{a, c, d, n, p}, x] && InertTrigQ[F] && Not[IntegerQ[n]] && IntegerQ[p]
Int[(a_.*(b_.*F_[c_. + d_.*x_])^p_)^n_., x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*(a*(b*v)^p)^FracPart[n]/(b*v)^(p*FracPart[n])* Int[(b*v)^(n*p), x]] /; FreeQ[{a, b, c, d, n, p}, x] && InertTrigQ[F] && Not[IntegerQ[n]] && Not[IntegerQ[p]]
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cos] || EqQ[F, cos])
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[SubstFor[1, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Sin] || EqQ[F, sin])
Int[u_*Cosh[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[u_*Sinh[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, 1/(b*c)* Subst[Int[SubstFor[1/x, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cot] || EqQ[F, cot])
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -1/(b*c)* Subst[Int[SubstFor[1/x, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Tan] || EqQ[F, tan])
Int[u_*Coth[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, 1/(b*c)* Subst[Int[SubstFor[1/x, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[u_*Tanh[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, 1/(b*c)* Subst[Int[SubstFor[1/x, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[u_*F_[c_.*(a_. + b_.*x_)]^2, x_Symbol] := With[{d = FreeFactors[Tan[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Tan[c*(a + b*x)]/d, u, x], x], x, Tan[c*(a + b*x)]/d] /; FunctionOfQ[Tan[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u] && (EqQ[F, Sec] || EqQ[F, sec])
Int[u_/cos[c_.*(a_. + b_.*x_)]^2, x_Symbol] := With[{d = FreeFactors[Tan[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Tan[c*(a + b*x)]/d, u, x], x], x, Tan[c*(a + b*x)]/d] /; FunctionOfQ[Tan[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[u_*F_[c_.*(a_. + b_.*x_)]^2, x_Symbol] := With[{d = FreeFactors[Cot[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[SubstFor[1, Cot[c*(a + b*x)]/d, u, x], x], x, Cot[c*(a + b*x)]/d] /; FunctionOfQ[Cot[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u] && (EqQ[F, Csc] || EqQ[F, csc])
Int[u_/sin[c_.*(a_. + b_.*x_)]^2, x_Symbol] := With[{d = FreeFactors[Cot[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[SubstFor[1, Cot[c*(a + b*x)]/d, u, x], x], x, Cot[c*(a + b*x)]/d] /; FunctionOfQ[Cot[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[u_*Sech[c_.*(a_. + b_.*x_)]^2, x_Symbol] := With[{d = FreeFactors[Tanh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Tanh[c*(a + b*x)]/d, u, x], x], x, Tanh[c*(a + b*x)]/d] /; FunctionOfQ[Tanh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[u_*Csch[c_.*(a_. + b_.*x_)]^2, x_Symbol] := With[{d = FreeFactors[Coth[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[SubstFor[1, Coth[c*(a + b*x)]/d, u, x], x], x, Coth[c*(a + b*x)]/d] /; FunctionOfQ[Coth[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_., x_Symbol] := With[{d = FreeFactors[Tan[c*(a + b*x)], x]}, 1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[1/(x^n*(1 + d^2*x^2)), Tan[c*(a + b*x)]/d, u, x], x], x, Tan[c*(a + b*x)]/d] /; FunctionOfQ[Tan[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Cot[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && (EqQ[F, Cot] || EqQ[F, cot])
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_., x_Symbol] := With[{d = FreeFactors[Cot[c*(a + b*x)], x]}, -1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[1/(x^n*(1 + d^2*x^2)), Cot[c*(a + b*x)]/d, u, x], x], x, Cot[c*(a + b*x)]/d] /; FunctionOfQ[Cot[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Tan[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && (EqQ[F, Tan] || EqQ[F, tan])
Int[u_*Coth[c_.*(a_. + b_.*x_)]^n_., x_Symbol] := With[{d = FreeFactors[Tanh[c*(a + b*x)], x]}, 1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[1/(x^n*(1 - d^2*x^2)), Tanh[c*(a + b*x)]/d, u, x], x], x, Tanh[c*(a + b*x)]/d] /; FunctionOfQ[Tanh[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Coth[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n]
Int[u_*Tanh[c_.*(a_. + b_.*x_)]^n_., x_Symbol] := With[{d = FreeFactors[Coth[c*(a + b*x)], x]}, 1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[1/(x^n*(1 - d^2*x^2)), Coth[c*(a + b*x)]/d, u, x], x], x, Coth[c*(a + b*x)]/d] /; FunctionOfQ[Coth[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Tanh[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Cot[a+b*x]],x]", "-1/b*Subst[Int[F[x]/(1+x^2),x],x,Cot[a+b*x]]", Hold[ With[{d = FreeFactors[Cot[v], x]}, Dist[-d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Cot[v]/d, u, x], x], x, Cot[v]/d], x]]]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Cot[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Cot[v], x]}, Dist[-d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Cot[v]/d, u, x], x], x, Cot[v]/d], x]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Cot[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Tan[a+b*x]],x]", "1/b*Subst[Int[F[x]/(1+x^2),x],x,Tan[a+b*x]]", Hold[ With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]]]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]]]
Int[F_[a_. + b_.*x_]^p_.*G_[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[ActivateTrig[F[a + b*x]^p*G[c + d*x]^q], x], x] /; FreeQ[{a, b, c, d}, x] && (EqQ[F, sin] || EqQ[F, cos]) && (EqQ[G, sin] || EqQ[G, cos]) && IGtQ[p, 0] && IGtQ[q, 0]
Int[F_[a_. + b_.*x_]^p_.*G_[c_. + d_.*x_]^q_.*H_[e_. + f_.*x_]^r_., x_Symbol] := Int[ExpandTrigReduce[ ActivateTrig[F[a + b*x]^p*G[c + d*x]^q*H[e + f*x]^r], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && (EqQ[F, sin] || EqQ[F, cos]) && (EqQ[G, sin] || EqQ[G, cos]) && (EqQ[H, sin] || EqQ[H, cos]) && IGtQ[p, 0] && IGtQ[q, 0] && IGtQ[r, 0]
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cos] || EqQ[F, cos])
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[SubstFor[1, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Sin] || EqQ[F, sin])
Int[u_*Cosh[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[u_*Sinh[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[SubstFor[1, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, 1/(b*c)* Subst[Int[SubstFor[1/x, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cot] || EqQ[F, cot])
Int[u_*F_[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -1/(b*c)* Subst[Int[SubstFor[1/x, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Tan] || EqQ[F, tan])
Int[u_*Coth[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, 1/(b*c)* Subst[Int[SubstFor[1/x, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[u_*Tanh[c_.*(a_. + b_.*x_)], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, 1/(b*c)* Subst[Int[SubstFor[1/x, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[ SubstFor[(1 - d^2*x^2)^((n - 1)/2), Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Cos] || EqQ[F, cos])
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[ SubstFor[(1 - d^2*x^2)^((-n - 1)/2), Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Sec] || EqQ[F, sec])
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[ SubstFor[(1 - d^2*x^2)^((n - 1)/2), Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Sin] || EqQ[F, sin])
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -d/(b*c)* Subst[Int[ SubstFor[(1 - d^2*x^2)^((-n - 1)/2), Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Csc] || EqQ[F, csc])
Int[u_*Cosh[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[ SubstFor[(1 + d^2*x^2)^((n - 1)/2), Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[u_*Sech[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[ SubstFor[(1 + d^2*x^2)^((-n - 1)/2), Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[u_*Sinh[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[ SubstFor[(-1 + d^2*x^2)^((n - 1)/2), Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[u_*Csch[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, d/(b*c)* Subst[Int[ SubstFor[(-1 + d^2*x^2)^((-n - 1)/2), Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, 1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[(1 - d^2*x^2)^((n - 1)/2)/x^n, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Cot] || EqQ[F, cot])
Int[u_*F_[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, -1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[(1 - d^2*x^2)^((n - 1)/2)/x^n, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Tan] || EqQ[F, tan])
Int[u_*Coth[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, 1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[(1 + d^2*x^2)^((n - 1)/2)/x^n, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[u_*Tanh[c_.*(a_. + b_.*x_)]^n_, x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, 1/(b*c*d^(n - 1))* Subst[Int[ SubstFor[(-1 + d^2*x^2)^((n - 1)/2)/x^n, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[u_*(v_ + d_.*F_[c_.*(a_. + b_.*x_)]^n_.), x_Symbol] := With[{e = FreeFactors[Sin[c*(a + b*x)], x]}, Int[ActivateTrig[u*v], x] + d*Int[ActivateTrig[u]*Cos[c*(a + b*x)]^n, x] /; FunctionOfQ[Sin[c*(a + b*x)]/e, u, x]] /; FreeQ[{a, b, c, d}, x] && Not[FreeQ[v, x]] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Cos] || EqQ[F, cos])
Int[u_*(v_ + d_.*F_[c_.*(a_. + b_.*x_)]^n_.), x_Symbol] := With[{e = FreeFactors[Cos[c*(a + b*x)], x]}, Int[ActivateTrig[u*v], x] + d*Int[ActivateTrig[u]*Sin[c*(a + b*x)]^n, x] /; FunctionOfQ[Cos[c*(a + b*x)]/e, u, x]] /; FreeQ[{a, b, c, d}, x] && Not[FreeQ[v, x]] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Sin] || EqQ[F, sin])
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Sin[a+b*x]]*Cos[a+b*x],x]", "Subst[Int[F[x],x],x,Sin[a+b*x]]/b", Hold[ With[{d = FreeFactors[Sin[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1, Sin[v]/d, u/Cos[v], x], x], x, Sin[v]/d], x]]]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Sin[v], x], u/Cos[v], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Sin[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1, Sin[v]/d, u/Cos[v], x], x], x, Sin[v]/d], x]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Sin[v], x], u/Cos[v], x]]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Cos[a+b*x]]*Sin[a+b*x],x]", "-Subst[Int[F[x],x],x,Cos[a+b*x]]/b", Hold[ With[{d = FreeFactors[Cos[v], x]}, Dist[-d/Coefficient[v, x, 1], Subst[Int[SubstFor[1, Cos[v]/d, u/Sin[v], x], x], x, Cos[v]/d], x]]]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Cos[v], x], u/Sin[v], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Cos[v], x]}, Dist[-d/Coefficient[v, x, 1], Subst[Int[SubstFor[1, Cos[v]/d, u/Sin[v], x], x], x, Cos[v]/d], x]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Cos[v], x], u/Sin[v], x]]]
Int[u_.*(a_. + b_.*cos[d_. + e_.*x_]^2 + c_.*sin[d_. + e_.*x_]^2)^p_., x_Symbol] := (a + c)^p*Int[ActivateTrig[u], x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b - c, 0]
Int[u_.*(a_. + b_.*tan[d_. + e_.*x_]^2 + c_.*sec[d_. + e_.*x_]^2)^p_., x_Symbol] := (a + c)^p*Int[ActivateTrig[u], x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b + c, 0]
Int[u_.*(a_. + b_.*cot[d_. + e_.*x_]^2 + c_.*csc[d_. + e_.*x_]^2)^p_., x_Symbol] := (a + c)^p*Int[ActivateTrig[u], x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b + c, 0]
Int[u_/y_, x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y], ActivateTrig[u], x]}, q*Log[RemoveContent[ActivateTrig[y], x]] /; Not[FalseQ[q]]] /; Not[InertTrigFreeQ[u]]
Int[u_/(y_*w_), x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y*w], ActivateTrig[u], x]}, q*Log[RemoveContent[ActivateTrig[y*w], x]] /; Not[FalseQ[q]]] /; Not[InertTrigFreeQ[u]]
Int[u_*y_^m_., x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y], ActivateTrig[u], x]}, q*ActivateTrig[y^(m + 1)]/(m + 1) /; Not[FalseQ[q]]] /; FreeQ[m, x] && NeQ[m, -1] && Not[InertTrigFreeQ[u]]
Int[u_*y_^m_.*z_^n_., x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y*z], ActivateTrig[u*z^(n - m)], x]}, q*ActivateTrig[y^(m + 1)*z^(m + 1)]/(m + 1) /; Not[FalseQ[q]]] /; FreeQ[{m, n}, x] && NeQ[m, -1] && Not[InertTrigFreeQ[u]]
Int[u_.*(a_.*F_[c_. + d_.*x_]^p_)^n_, x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*(v/NonfreeFactors[v, x])^(p*IntPart[n])*(a*v^p)^ FracPart[n]/NonfreeFactors[v, x]^(p*FracPart[n])* Int[ActivateTrig[u]*NonfreeFactors[v, x]^(n*p), x]] /; FreeQ[{a, c, d, n, p}, x] && InertTrigQ[F] && Not[IntegerQ[n]] && IntegerQ[p]
Int[u_.*(a_.*(b_.*F_[c_. + d_.*x_])^p_)^n_., x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*(a*(b*v)^p)^FracPart[n]/(b*v)^(p*FracPart[n])* Int[ActivateTrig[u]*(b*v)^(n*p), x]] /; FreeQ[{a, b, c, d, n, p}, x] && InertTrigQ[F] && Not[IntegerQ[n]] && Not[IntegerQ[p]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Tan[a+b*x]],x]", "1/b*Subst[Int[F[x]/(1+x^2),x],x,Tan[a+b*x]]", Hold[ With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]]]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x]] /; SimplifyFlag && InverseFunctionFreeQ[u, x] && Not[ MatchQ[u, v_.*(c_.*tan[w_]^n_.*tan[z_]^n_.)^p_. /; FreeQ[{c, p}, x] && IntegerQ[n] && LinearQ[w, x] && EqQ[z, 2*w]]], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]] /; Not[FalseQ[v]] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x]] /; InverseFunctionFreeQ[u, x] && Not[ MatchQ[u, v_.*(c_.*tan[w_]^n_.*tan[z_]^n_.)^p_. /; FreeQ[{c, p}, x] && IntegerQ[n] && LinearQ[w, x] && EqQ[z, 2*w]]]]
Int[u_*(c_.*sin[v_])^m_, x_Symbol] := With[{w = FunctionOfTrig[u*Sin[v/2]^(2*m)/(c*Tan[v/2])^m, x]}, (c*Sin[v])^m*(c*Tan[v/2])^m/Sin[v/2]^(2*m)* Int[u*Sin[v/2]^(2*m)/(c*Tan[v/2])^m, x] /; Not[FalseQ[w]] && FunctionOfQ[NonfreeFactors[Tan[w], x], u*Sin[v/2]^(2*m)/(c*Tan[v/2])^m, x]] /; FreeQ[c, x] && LinearQ[v, x] && IntegerQ[m + 1/2] && Not[SumQ[u]] && InverseFunctionFreeQ[u, x]
Int[u_.*(a_.*tan[c_. + d_.*x_]^n_. + b_.*sec[c_. + d_.*x_]^n_.)^p_, x_Symbol] := Int[ActivateTrig[u]*Sec[c + d*x]^(n*p)*(b + a*Sin[c + d*x]^n)^p, x] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p]
Int[u_.*(a_.*cot[c_. + d_.*x_]^n_. + b_.*csc[c_. + d_.*x_]^n_.)^p_, x_Symbol] := Int[ActivateTrig[u]*Csc[c + d*x]^(n*p)*(b + a*Cos[c + d*x]^n)^p, x] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p]
Int[u_*(a_*F_[c_. + d_.*x_]^p_. + b_.*F_[c_. + d_.*x_]^q_.)^n_., x_Symbol] := Int[ActivateTrig[u*F[c + d*x]^(n*p)*(a + b*F[c + d*x]^(q - p))^n], x] /; FreeQ[{a, b, c, d, p, q}, x] && InertTrigQ[F] && IntegerQ[n] && PosQ[q - p]
Int[u_*(a_*F_[d_. + e_.*x_]^p_. + b_.*F_[d_. + e_.*x_]^q_. + c_.*F_[d_. + e_.*x_]^r_.)^n_., x_Symbol] := Int[ActivateTrig[ u*F[d + e*x]^(n*p)*(a + b*F[d + e*x]^(q - p) + c*F[d + e*x]^(r - p))^n], x] /; FreeQ[{a, b, c, d, e, p, q, r}, x] && InertTrigQ[F] && IntegerQ[n] && PosQ[q - p] && PosQ[r - p]
Int[u_*(a_ + b_.*F_[d_. + e_.*x_]^p_. + c_.*F_[d_. + e_.*x_]^q_.)^n_., x_Symbol] := Int[ActivateTrig[ u*F[d + e*x]^(n*p)*(b + a*F[d + e*x]^(-p) + c*F[d + e*x]^(q - p))^ n], x] /; FreeQ[{a, b, c, d, e, p, q}, x] && InertTrigQ[F] && IntegerQ[n] && NegQ[p]
Int[u_.*(a_.*cos[c_. + d_.*x_] + b_.*sin[c_. + d_.*x_])^n_., x_Symbol] := Int[ActivateTrig[u]*(a*E^(-a/b*(c + d*x)))^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 + b^2, 0]
Int[u_, x_Symbol] := Int[TrigSimplify[u], x] /; TrigSimplifyQ[u]
Int[u_.*(a_*v_)^p_, x_Symbol] := With[{uu = ActivateTrig[u], vv = ActivateTrig[v]}, a^IntPart[p]*(a*vv)^FracPart[p]/(vv^FracPart[p])* Int[uu*vv^p, x]] /; FreeQ[{a, p}, x] && Not[IntegerQ[p]] && Not[InertTrigFreeQ[v]]
Int[u_.*(v_^m_)^p_, x_Symbol] := With[{uu = ActivateTrig[u], vv = ActivateTrig[v]}, (vv^m)^FracPart[p]/(vv^(m*FracPart[p]))*Int[uu*vv^(m*p), x]] /; FreeQ[{m, p}, x] && Not[IntegerQ[p]] && Not[InertTrigFreeQ[v]]
Int[u_.*(v_^m_.*w_^n_.)^p_, x_Symbol] := With[{uu = ActivateTrig[u], vv = ActivateTrig[v], ww = ActivateTrig[w]}, (vv^m*ww^n)^FracPart[p]/(vv^(m*FracPart[p])*ww^(n*FracPart[p]))* Int[uu*vv^(m*p)*ww^(n*p), x]] /; FreeQ[{m, n, p}, x] && Not[IntegerQ[p]] && (Not[InertTrigFreeQ[v]] || Not[InertTrigFreeQ[w]])
Int[u_, x_Symbol] := With[{v = ExpandTrig[u, x]}, Int[v, x] /; SumQ[v]] /; Not[InertTrigFreeQ[u]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{w = Block[{$ShowSteps = False, $StepCounter = Null}, Int[SubstFor[ 1/(1 + FreeFactors[Tan[FunctionOfTrig[u, x]/2], x]^2*x^2), Tan[FunctionOfTrig[u, x]/2]/ FreeFactors[Tan[FunctionOfTrig[u, x]/2], x], u, x], x]]}, ShowStep["", "Int[F[Sin[a+b*x],Cos[a+b*x]],x]", "2/b*Subst[Int[1/(1+x^2)*F[2*x/(1+x^2),(1-x^2)/(1+x^2)],x],x, Tan[(a+b*x)/2]]", Hold[ Module[{v = FunctionOfTrig[u, x], d}, d = FreeFactors[Tan[v/2], x]; Dist[2*d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v/2]/d, u, x], x], x, Tan[v/2]/d], x]]]] /; CalculusFreeQ[w, x]] /; SimplifyFlag && InverseFunctionFreeQ[u, x] && Not[FalseQ[FunctionOfTrig[u, x]]], Int[u_, x_Symbol] := With[{w = Block[{$ShowSteps = False, $StepCounter = Null}, Int[SubstFor[ 1/(1 + FreeFactors[Tan[FunctionOfTrig[u, x]/2], x]^2*x^2), Tan[FunctionOfTrig[u, x]/2]/ FreeFactors[Tan[FunctionOfTrig[u, x]/2], x], u, x], x]]}, Module[{v = FunctionOfTrig[u, x], d}, d = FreeFactors[Tan[v/2], x]; Dist[2*d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v/2]/d, u, x], x], x, Tan[v/2]/d], x]] /; CalculusFreeQ[w, x]] /; InverseFunctionFreeQ[u, x] && Not[FalseQ[FunctionOfTrig[u, x]]]]
(* If[TrueQ[$LoadShowSteps], Int[u_,x_Symbol] := With[{v=FunctionOfTrig[u,x]}, ShowStep["","Int[F[Sin[a+b*x],Cos[a+b*x]],x]","2/b*Subst[Int[1/(1+x^ 2)*F[2*x/(1+x^2),(1-x^2)/(1+x^2)],x],x,Tan[(a+b*x)/2]]",Hold[ With[{d=FreeFactors[Tan[v/2],x]}, Dist[2*d/Coefficient[v,x,1],Subst[Int[SubstFor[1/(1+d^2*x^2),Tan[v/ 2]/d,u,x],x],x,Tan[v/2]/d],x]]]] /; Not[FalseQ[v]]] /; SimplifyFlag && InverseFunctionFreeQ[u,x], Int[u_,x_Symbol] := With[{v=FunctionOfTrig[u,x]}, With[{d=FreeFactors[Tan[v/2],x]}, Dist[2*d/Coefficient[v,x,1],Subst[Int[SubstFor[1/(1+d^2*x^2),Tan[v/ 2]/d,u,x],x],x,Tan[v/2]/d],x]] /; Not[FalseQ[v]]] /; InverseFunctionFreeQ[u,x]] *)
Int[u_, x_Symbol] := With[{v = ActivateTrig[u]}, CannotIntegrate[v, x]] /; Not[InertTrigFreeQ[u]]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.6 (c+d x)^m trig(a+b x)^n trig(a+b x)^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.6 (c+d x)^m trig(a+b x)^n trig(a+b x)^p *)
Int[(c_. + d_.*x_)^m_.*Sin[a_. + b_.*x_]^n_.*Cos[a_. + b_.*x_], x_Symbol] := (c + d*x)^m*Sin[a + b*x]^(n + 1)/(b*(n + 1)) - d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Sin[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Sin[a_. + b_.*x_]*Cos[a_. + b_.*x_]^n_., x_Symbol] := -(c + d*x)^m*Cos[a + b*x]^(n + 1)/(b*(n + 1)) + d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Cos[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Sin[a_. + b_.*x_]^n_.*Cos[a_. + b_.*x_]^p_., x_Symbol] := Int[ExpandTrigReduce[(c + d*x)^m, Sin[a + b*x]^n*Cos[a + b*x]^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_.*Sin[a_. + b_.*x_]^n_.*Tan[a_. + b_.*x_]^p_., x_Symbol] := -Int[(c + d*x)^m*Sin[a + b*x]^n*Tan[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Sin[a + b*x]^(n - 2)*Tan[a + b*x]^p, x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_.*Cos[a_. + b_.*x_]^n_.*Cot[a_. + b_.*x_]^p_., x_Symbol] := -Int[(c + d*x)^m*Cos[a + b*x]^n*Cot[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Cos[a + b*x]^(n - 2)*Cot[a + b*x]^p, x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_.*Sec[a_. + b_.*x_]^n_.*Tan[a_. + b_.*x_]^p_., x_Symbol] := (c + d*x)^m*Sec[a + b*x]^n/(b*n) - d*m/(b*n)*Int[(c + d*x)^(m - 1)*Sec[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]^n_.*Cot[a_. + b_.*x_]^p_., x_Symbol] := -(c + d*x)^m*Csc[a + b*x]^n/(b*n) + d*m/(b*n)*Int[(c + d*x)^(m - 1)*Csc[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Sec[a_. + b_.*x_]^2*Tan[a_. + b_.*x_]^n_., x_Symbol] := (c + d*x)^m*Tan[a + b*x]^(n + 1)/(b*(n + 1)) - d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Tan[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]^2*Cot[a_. + b_.*x_]^n_., x_Symbol] := -(c + d*x)^m*Cot[a + b*x]^(n + 1)/(b*(n + 1)) + d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Cot[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Sec[a_. + b_.*x_]*Tan[a_. + b_.*x_]^p_, x_Symbol] := -Int[(c + d*x)^m*Sec[a + b*x]*Tan[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Sec[a + b*x]^3*Tan[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Sec[a_. + b_.*x_]^n_.*Tan[a_. + b_.*x_]^p_, x_Symbol] := -Int[(c + d*x)^m*Sec[a + b*x]^n*Tan[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Sec[a + b*x]^(n + 2)*Tan[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]*Cot[a_. + b_.*x_]^p_, x_Symbol] := -Int[(c + d*x)^m*Csc[a + b*x]*Cot[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Csc[a + b*x]^3*Cot[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]^n_.*Cot[a_. + b_.*x_]^p_, x_Symbol] := -Int[(c + d*x)^m*Csc[a + b*x]^n*Cot[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Csc[a + b*x]^(n + 2)*Cot[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Sec[a_. + b_.*x_]^n_.*Tan[a_. + b_.*x_]^p_., x_Symbol] := Module[{u = IntHide[Sec[a + b*x]^n*Tan[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d, n, p}, x] && IGtQ[m, 0] && (IntegerQ[n/2] || IntegerQ[(p - 1)/2])
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]^n_.*Cot[a_. + b_.*x_]^p_., x_Symbol] := Module[{u = IntHide[Csc[a + b*x]^n*Cot[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d, n, p}, x] && IGtQ[m, 0] && (IntegerQ[n/2] || IntegerQ[(p - 1)/2])
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]^n_.*Sec[a_. + b_.*x_]^n_., x_Symbol] := 2^n*Int[(c + d*x)^m*Csc[2*a + 2*b*x]^n, x] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[n] && RationalQ[m]
Int[(c_. + d_.*x_)^m_.*Csc[a_. + b_.*x_]^n_.*Sec[a_. + b_.*x_]^p_., x_Symbol] := Module[{u = IntHide[Csc[a + b*x]^n*Sec[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p] && GtQ[m, 0] && NeQ[n, p]
Int[u_^m_.*F_[v_]^n_.*G_[w_]^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*F[ExpandToSum[v, x]]^n* G[ExpandToSum[v, x]]^p, x] /; FreeQ[{m, n, p}, x] && TrigQ[F] && TrigQ[G] && EqQ[v, w] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]
Int[(e_. + f_.*x_)^m_.* Cos[c_. + d_.*x_]*(a_ + b_.*Sin[c_. + d_.*x_])^n_., x_Symbol] := (e + f*x)^m*(a + b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1)) - f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Sin[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.* Sin[c_. + d_.*x_]*(a_ + b_.*Cos[c_. + d_.*x_])^n_., x_Symbol] := -(e + f*x)^m*(a + b*Cos[c + d*x])^(n + 1)/(b*d*(n + 1)) + f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Cos[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.* Sec[c_. + d_.*x_]^2*(a_ + b_.*Tan[c_. + d_.*x_])^n_., x_Symbol] := (e + f*x)^m*(a + b*Tan[c + d*x])^(n + 1)/(b*d*(n + 1)) - f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Tan[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.* Csc[c_. + d_.*x_]^2*(a_ + b_.*Cot[c_. + d_.*x_])^n_., x_Symbol] := -(e + f*x)^m*(a + b*Cot[c + d*x])^(n + 1)/(b*d*(n + 1)) + f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Cot[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.*Sec[c_. + d_.*x_]* Tan[c_. + d_.*x_]*(a_ + b_.*Sec[c_. + d_.*x_])^n_., x_Symbol] := (e + f*x)^m*(a + b*Sec[c + d*x])^(n + 1)/(b*d*(n + 1)) - f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Sec[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.*Csc[c_. + d_.*x_]* Cot[c_. + d_.*x_]*(a_ + b_.*Csc[c_. + d_.*x_])^n_., x_Symbol] := -(e + f*x)^m*(a + b*Csc[c + d*x])^(n + 1)/(b*d*(n + 1)) + f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Csc[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.*Sin[a_. + b_.*x_]^p_.*Sin[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Sin[a + b*x]^p*Sin[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*Cos[a_. + b_.*x_]^p_.*Cos[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Cos[a + b*x]^p*Cos[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*Sin[a_. + b_.*x_]^p_.*Cos[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Sin[a + b*x]^p*Cos[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IGtQ[q, 0]
Int[(e_. + f_.*x_)^m_.*F_[a_. + b_.*x_]^p_.*G_[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigExpand[(e + f*x)^m*G[c + d*x]^q, F, c + d*x, p, b/d, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && MemberQ[{Sin, Cos}, F] && MemberQ[{Sec, Csc}, G] && IGtQ[p, 0] && IGtQ[q, 0] && EqQ[b*c - a*d, 0] && IGtQ[b/d, 1]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.7 F^(c (a+b x)) trig(d+e x)^n.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.7 F^(c (a+b x)) trig(d+e x)^n *)
Int[F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_], x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Sin[d + e*x]/(e^2 + b^2*c^2*Log[F]^2) - e*F^(c*(a + b*x))*Cos[d + e*x]/(e^2 + b^2*c^2*Log[F]^2) /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2 + b^2*c^2*Log[F]^2, 0]
Int[F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_], x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Cos[d + e*x]/(e^2 + b^2*c^2*Log[F]^2) + e*F^(c*(a + b*x))*Sin[d + e*x]/(e^2 + b^2*c^2*Log[F]^2) /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2 + b^2*c^2*Log[F]^2, 0]
Int[F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Sin[d + e*x]^n/(e^2*n^2 + b^2*c^2*Log[F]^2) - e*n*F^(c*(a + b*x))*Cos[d + e*x]* Sin[d + e*x]^(n - 1)/(e^2*n^2 + b^2*c^2*Log[F]^2) + (n*(n - 1)*e^2)/(e^2*n^2 + b^2*c^2*Log[F]^2)* Int[F^(c*(a + b*x))*Sin[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && GtQ[n, 1]
Int[F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_]^m_, x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Cos[d + e*x]^m/(e^2*m^2 + b^2*c^2*Log[F]^2) + e*m*F^(c*(a + b*x))*Sin[d + e*x]* Cos[d + e*x]^(m - 1)/(e^2*m^2 + b^2*c^2*Log[F]^2) + (m*(m - 1)*e^2)/(e^2*m^2 + b^2*c^2*Log[F]^2)* Int[F^(c*(a + b*x))*Cos[d + e*x]^(m - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*m^2 + b^2*c^2*Log[F]^2, 0] && GtQ[m, 1]
Int[F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sin[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) + F^(c*(a + b*x))*Cos[d + e*x]*Sin[d + e*x]^(n + 1)/(e*(n + 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && NeQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Cos[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) - F^(c*(a + b*x))*Sin[d + e*x]*Cos[d + e*x]^(n + 1)/(e*(n + 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && NeQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sin[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) + F^(c*(a + b*x))*Cos[d + e*x]*Sin[d + e*x]^(n + 1)/(e*(n + 1)) + (e^2*(n + 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n + 1)*(n + 2))* Int[F^(c*(a + b*x))*Sin[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Cos[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) - F^(c*(a + b*x))*Sin[d + e*x]*Cos[d + e*x]^(n + 1)/(e*(n + 1)) + (e^2*(n + 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n + 1)*(n + 2))* Int[F^(c*(a + b*x))*Cos[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^n_, x_Symbol] := E^(I*n*(d + e*x))*Sin[d + e*x]^n/(-1 + E^(2*I*(d + e*x)))^n* Int[F^(c*(a + b*x))*(-1 + E^(2*I*(d + e*x)))^n/E^(I*n*(d + e*x)), x] /; FreeQ[{F, a, b, c, d, e, n}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_]^n_, x_Symbol] := E^(I*n*(d + e*x))*Cos[d + e*x]^n/(1 + E^(2*I*(d + e*x)))^n* Int[F^(c*(a + b*x))*(1 + E^(2*I*(d + e*x)))^n/E^(I*n*(d + e*x)), x] /; FreeQ[{F, a, b, c, d, e, n}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*Tan[d_. + e_.*x_]^n_., x_Symbol] := I^n*Int[ ExpandIntegrand[ F^(c*(a + b*x))*(1 - E^(2*I*(d + e*x)))^ n/(1 + E^(2*I*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Cot[d_. + e_.*x_]^n_., x_Symbol] := (-I)^n* Int[ExpandIntegrand[ F^(c*(a + b*x))*(1 + E^(2*I*(d + e*x)))^ n/(1 - E^(2*I*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Sec[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]* F^(c*(a + b*x))*(Sec[d + e x]^n/(e^2*n^2 + b^2*c^2*Log[F]^2)) - e*n*F^(c*(a + b*x))* Sec[d + e x]^(n + 1)*(Sin[d + e x]/(e^2*n^2 + b^2*c^2*Log[F]^2)) + e^2*n*((n + 1)/(e^2*n^2 + b^2*c^2*Log[F]^2))* Int[F^(c*(a + b*x))*Sec[d + e x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1]
Int[F_^(c_.*(a_. + b_.*x_))*Csc[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]* F^(c*(a + b*x))*(Csc[d + e x]^n/(e^2*n^2 + b^2*c^2*Log[F]^2)) + e*n*F^(c*(a + b*x))* Csc[d + e x]^(n + 1)*(Cos[d + e x]/(e^2*n^2 + b^2*c^2*Log[F]^2)) + e^2*n*((n + 1)/(e^2*n^2 + b^2*c^2*Log[F]^2))* Int[F^(c*(a + b*x))*Csc[d + e x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1]
Int[F_^(c_.*(a_. + b_.*x_))*Sec[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sec[d + e x]^(n - 2)/(e^2*(n - 1)*(n - 2)) + F^(c*(a + b*x))*Sec[d + e x]^(n - 1)*Sin[d + e x]/(e*(n - 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && NeQ[n, 1] && NeQ[n, 2]
Int[F_^(c_.*(a_. + b_.*x_))*Csc[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Csc[d + e x]^(n - 2)/(e^2*(n - 1)*(n - 2)) + F^(c*(a + b*x))*Csc[d + e x]^(n - 1)*Cos[d + e x]/(e*(n - 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && NeQ[n, 1] && NeQ[n, 2]
Int[F_^(c_.*(a_. + b_.*x_))*Sec[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sec[d + e x]^(n - 2)/(e^2*(n - 1)*(n - 2)) + F^(c*(a + b*x))*Sec[d + e x]^(n - 1)*Sin[d + e x]/(e*(n - 1)) + (e^2*(n - 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n - 1)*(n - 2))* Int[F^(c*(a + b*x))*Sec[d + e x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && GtQ[n, 1] && NeQ[n, 2]
Int[F_^(c_.*(a_. + b_.*x_))*Csc[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Csc[d + e x]^(n - 2)/(e^2*(n - 1)*(n - 2)) - F^(c*(a + b*x))*Csc[d + e x]^(n - 1)*Cos[d + e x]/(e*(n - 1)) + (e^2*(n - 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n - 1)*(n - 2))* Int[F^(c*(a + b*x))*Csc[d + e x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && GtQ[n, 1] && NeQ[n, 2]
(* Int[F_^(c_.*(a_.+b_.*x_))*Sec[d_.+e_.*x_]^n_.,x_Symbol] := 2^n*Int[SimplifyIntegrand[F^(c*(a+b*x))*E^(I*n*(d+e*x))/(1+E^(2*I*( d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e},x] && IntegerQ[n] *)
(* Int[F_^(c_.*(a_.+b_.*x_))*Csc[d_.+e_.*x_]^n_.,x_Symbol] := (2*I)^n*Int[SimplifyIntegrand[F^(c*(a+b*x))*E^(-I*n*(d+e*x))/(1-E^(- 2*I*(d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e},x] && IntegerQ[n] *)
Int[F_^(c_.*(a_. + b_.*x_))*Sec[d_. + k_.*Pi + e_.*x_]^n_., x_Symbol] := 2^n*E^(I*k*n*Pi)*E^(I*n*(d + e*x))* F^(c*(a + b*x))/(I*e*n + b*c*Log[F])* Hypergeometric2F1[n, n/2 - I*b*c*Log[F]/(2*e), 1 + n/2 - I*b*c*Log[F]/(2*e), -E^(2*I*k*Pi)*E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[4*k] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Sec[d_. + e_.*x_]^n_., x_Symbol] := 2^n*E^(I*n*(d + e*x))*F^(c*(a + b*x))/(I*e*n + b*c*Log[F])* Hypergeometric2F1[n, n/2 - I*b*c*Log[F]/(2*e), 1 + n/2 - I*b*c*Log[F]/(2*e), -E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Csc[d_. + k_.*Pi + e_.*x_]^n_., x_Symbol] := (-2*I)^n*E^(I*k*n*Pi)* E^(I*n*(d + e*x))*(F^(c*(a + b*x))/(I*e*n + b*c*Log[F]))* Hypergeometric2F1[n, n/2 - I*b*c*Log[F]/(2*e), 1 + n/2 - I*b*c*Log[F]/(2*e), E^(2*I*k*Pi)*E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[4*k] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Csc[d_. + e_.*x_]^n_., x_Symbol] := (-2*I)^n*E^(I*n*(d + e*x))*(F^(c*(a + b*x))/(I*e*n + b*c*Log[F]))* Hypergeometric2F1[n, n/2 - I*b*c*Log[F]/(2*e), 1 + n/2 - I*b*c*Log[F]/(2*e), E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Sec[d_. + e_.*x_]^n_., x_Symbol] := (1 + E^(2*I*(d + e*x)))^n*Sec[d + e*x]^n/E^(I*n*(d + e*x))* Int[SimplifyIntegrand[ F^(c*(a + b*x))*E^(I*n*(d + e*x))/(1 + E^(2*I*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*Csc[d_. + e_.*x_]^n_., x_Symbol] := (1 - E^(-2*I*(d + e*x)))^n*Csc[d + e*x]^n/E^(-I*n*(d + e*x))* Int[SimplifyIntegrand[ F^(c*(a + b*x))*E^(-I*n*(d + e*x))/(1 - E^(-2*I*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Sin[d_. + e_.*x_])^n_., x_Symbol] := 2^n*f^n* Int[F^(c*(a + b*x))*Cos[d/2 - f*Pi/(4*g) + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f^2 - g^2, 0] && ILtQ[n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cos[d_. + e_.*x_])^n_., x_Symbol] := 2^n*f^n*Int[F^(c*(a + b*x))*Cos[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f - g, 0] && ILtQ[n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cos[d_. + e_.*x_])^n_., x_Symbol] := 2^n*f^n*Int[F^(c*(a + b*x))*Sin[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f + g, 0] && ILtQ[n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Sin[d_. + e_.*x_])^n_., x_Symbol] := (f + g*Sin[d + e*x])^n/Cos[d/2 - f*Pi/(4*g) + e*x/2]^(2*n)* Int[F^(c*(a + b*x))*Cos[d/2 - f*Pi/(4*g) + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && EqQ[f^2 - g^2, 0] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cos[d_. + e_.*x_])^n_., x_Symbol] := (f + g*Cos[d + e*x])^n/Cos[d/2 + e*x/2]^(2*n)* Int[F^(c*(a + b*x))*Cos[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && EqQ[f - g, 0] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cos[d_. + e_.*x_])^n_., x_Symbol] := (f + g*Cos[d + e*x])^n/Sin[d/2 + e*x/2]^(2*n)* Int[F^(c*(a + b*x))*Sin[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && EqQ[f + g, 0] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))* Cos[d_. + e_.*x_]^m_.*(f_ + g_.*Sin[d_. + e_.*x_])^n_., x_Symbol] := g^n*Int[F^(c*(a + b*x))*Tan[f*Pi/(4*g) - d/2 - e*x/2]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f^2 - g^2, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[F_^(c_.*(a_. + b_.*x_))* Sin[d_. + e_.*x_]^m_.*(f_ + g_.*Cos[d_. + e_.*x_])^n_., x_Symbol] := f^n*Int[F^(c*(a + b*x))*Tan[d/2 + e*x/2]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f - g, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[F_^(c_.*(a_. + b_.*x_))* Sin[d_. + e_.*x_]^m_.*(f_ + g_.*Cos[d_. + e_.*x_])^n_., x_Symbol] := f^n*Int[F^(c*(a + b*x))*Cot[d/2 + e*x/2]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f + g, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(h_ + i_.*Cos[d_. + e_.*x_])/(f_ + g_.*Sin[d_. + e_.*x_]), x_Symbol] := 2*i*Int[F^(c*(a + b*x))*(Cos[d + e*x]/(f + g*Sin[d + e*x])), x] + Int[F^(c*(a + b*x))*((h - i*Cos[d + e*x])/(f + g*Sin[d + e*x])), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i}, x] && EqQ[f^2 - g^2, 0] && EqQ[h^2 - i^2, 0] && EqQ[g*h - f*i, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(h_ + i_.*Sin[d_. + e_.*x_])/(f_ + g_.*Cos[d_. + e_.*x_]), x_Symbol] := 2*i*Int[F^(c*(a + b*x))*(Sin[d + e*x]/(f + g*Cos[d + e*x])), x] + Int[F^(c*(a + b*x))*((h - i*Sin[d + e*x])/(f + g*Cos[d + e*x])), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i}, x] && EqQ[f^2 - g^2, 0] && EqQ[h^2 - i^2, 0] && EqQ[g*h + f*i, 0]
Int[F_^(c_.*u_)*G_[v_]^n_., x_Symbol] := Int[F^(c*ExpandToSum[u, x])*G[ExpandToSum[v, x]]^n, x] /; FreeQ[{F, c, n}, x] && TrigQ[G] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[(f_.*x_)^m_.*F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^n_., x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Sin[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_.*F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_]^n_., x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Cos[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_*F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))*F^(c*(a + b*x))*Sin[d + e*x] - e/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Cos[d + e*x], x] - b*c*Log[F]/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Sin[d + e*x], x] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && (LtQ[m, -1] || SumSimplerQ[m, 1])
Int[(f_.*x_)^m_*F_^(c_.*(a_. + b_.*x_))*Cos[d_. + e_.*x_], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))*F^(c*(a + b*x))*Cos[d + e*x] + e/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Sin[d + e*x], x] - b*c*Log[F]/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Cos[d + e*x], x] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && (LtQ[m, -1] || SumSimplerQ[m, 1])
(* Int[(f_.*x_)^m_.*F_^(c_.*(a_.+b_.*x_))*Sin[d_.+e_.*x_]^n_.,x_ Symbol] := I^n/2^n*Int[ExpandIntegrand[(f*x)^m*F^(c*(a+b*x)),(E^(-I*(d+e*x))-E^ (I*(d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e,f},x] && IGtQ[n,0] *)
(* Int[(f_.*x_)^m_.*F_^(c_.*(a_.+b_.*x_))*Cos[d_.+e_.*x_]^n_.,x_ Symbol] := 1/2^n*Int[ExpandIntegrand[(f*x)^m*F^(c*(a+b*x)),(E^(-I*(d+e*x))+E^( I*(d+e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e,f},x] && IGtQ[n,0] *)
Int[F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^m_.* Cos[f_. + g_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[F^(c*(a + b*x)), Sin[d + e*x]^m*Cos[f + g*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[x_^p_.*F_^(c_.*(a_. + b_.*x_))*Sin[d_. + e_.*x_]^m_.* Cos[f_. + g_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[x^p*F^(c*(a + b*x)), Sin[d + e*x]^m*Cos[f + g*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[F_^(c_.*(a_. + b_.*x_))*G_[d_. + e_.*x_]^m_.*H_[d_. + e_.*x_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^(c*(a + b*x)), G[d + e*x]^m*H[d + e*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IGtQ[m, 0] && IGtQ[n, 0] && TrigQ[G] && TrigQ[H]
Int[F_^u_*Sin[v_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^u, Sin[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[n, 0]
Int[F_^u_*Cos[v_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^u, Cos[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[n, 0]
Int[F_^u_*Sin[v_]^m_.*Cos[v_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^u, Sin[v]^m*Cos[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[m, 0] && IGtQ[n, 0]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.8 u trig(a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.8 u trig(a+b log(c x^n))^p *)
Int[Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1) - b*d*n*x*Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1) /; FreeQ[{a, b, c, d, n}, x] && NeQ[b^2*d^2*n^2 + 1, 0]
Int[Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1) + b*d*n*x*Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1) /; FreeQ[{a, b, c, d, n}, x] && NeQ[b^2*d^2*n^2 + 1, 0]
Int[Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := x*Sin[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*n^2*p^2 + 1) - b*d*n*p*x*Cos[d*(a + b*Log[c*x^n])]* Sin[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*n^2*p^2 + 1) + b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 + 1)* Int[Sin[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + 1, 0]
Int[Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := x*Cos[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*n^2*p^2 + 1) + b*d*n*p*x*Cos[d*(a + b*Log[c*x^n])]^(p - 1)* Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2*p^2 + 1) + b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 + 1)* Int[Cos[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + 1, 0]
Int[Sin[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 1/(2^p*b^p*d^p*p^p)* Int[ExpandIntegrand[(E^(a*b*d^2*p)*x^(-1/p) - E^(-a*b*d^2*p)*x^(1/p))^p, x], x] /; FreeQ[{a, b, d}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + 1, 0]
Int[Cos[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 1/2^p* Int[ExpandIntegrand[(E^(a*b*d^2*p)*x^(-1/p) + E^(-a*b*d^2*p)*x^(1/p))^p, x], x] /; FreeQ[{a, b, d}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + 1, 0]
(* Int[Sin[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := 1/((-2*I)^p*E^(I*a*d*p))*Int[(1-E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d* p),x] /; FreeQ[{a,b,d},x] && IntegerQ[p] *)
(* Int[Cos[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := 1/(2^p*E^(I*a*d*p))*Int[(1+E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p),x]  /; FreeQ[{a,b,d},x] && IntegerQ[p] *)
Int[Sin[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Sin[d*(a + b*Log[x])]^p*x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p* Int[(1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p), x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Cos[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Cos[d*(a + b*Log[x])]^p*x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p* Int[(1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p), x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Sin[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Cos[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (m + 1)*(e*x)^(m + 1)* Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2) - b*d*n*(e*x)^(m + 1)* Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2) /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b^2*d^2*n^2 + (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (m + 1)*(e*x)^(m + 1)* Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2) + b*d*n*(e*x)^(m + 1)* Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2) /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b^2*d^2*n^2 + (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := (m + 1)*(e*x)^(m + 1)* Sin[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2) - b*d*n*p*(e*x)^(m + 1)*Cos[d*(a + b*Log[c*x^n])]* Sin[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2) + b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 + (m + 1)^2)* Int[(e*x)^m*Sin[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := (m + 1)*(e*x)^(m + 1)* Cos[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2) + b*d*n*p*(e*x)^(m + 1)*Sin[d*(a + b*Log[c*x^n])]* Cos[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2) + b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 + (m + 1)^2)* Int[(e*x)^m*Cos[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Sin[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := (m + 1)^p/(2^p*b^p*d^p*p^p)* Int[ ExpandIntegrand[(e*x)^ m*(E^(a*b*d^2*p/(m + 1))*x^(-(m + 1)/p) - E^(-a*b*d^2*p/(m + 1))*x^((m + 1)/p))^p, x], x] /; FreeQ[{a, b, d, e, m}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Cos[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 1/2^p* Int[ExpandIntegrand[(e*x)^ m*(E^(a*b*d^2*p/(m + 1))*x^(-(m + 1)/p) + E^(-a*b*d^2*p/(m + 1))*x^((m + 1)/p))^p, x], x] /; FreeQ[{a, b, d, e, m}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + (m + 1)^2, 0]
(* Int[(e_.*x_)^m_.*Sin[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := 1/((-2*I)^p*E^(I*a*d*p))*Int[(e*x)^m*(1-E^(2*I*a*d)*x^(2*I*b*d))^p/ x^(I*b*d*p),x] /; FreeQ[{a,b,d,e,m},x] && IntegerQ[p] *)
(* Int[(e_.*x_)^m_.*Cos[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := 1/(2^p*E^(I*a*d*p))*Int[(e*x)^m*(1+E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I* b*d*p),x] /; FreeQ[{a,b,d,e,m},x] && IntegerQ[p] *)
Int[(e_.*x_)^m_.*Sin[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Sin[d*(a + b*Log[x])]^p*x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p* Int[(e*x)^m*(1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p), x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Cos[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Cos[d*(a + b*Log[x])]^p*x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p* Int[(e*x)^m*(1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p), x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Sin[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Cos[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := I*E^(-I*a*d)*(c*x^n)^(-I*b*d)/(2*x^(-I*b*d*n))* Int[x^(-I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] - I*E^(I*a*d)*(c*x^n)^(I*b*d)/(2*x^(I*b*d*n))* Int[x^(I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, q}, x]
Int[(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := E^(-I*a*d)*(c*x^n)^(-I*b*d)/(2*x^(-I*b*d*n))* Int[x^(-I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] + E^(I*a*d)*(c*x^n)^(I*b*d)/(2*x^(I*b*d*n))* Int[x^(I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, q}, x]
Int[(i_.*x_)^r_.*(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := I*E^(-I*a*d)*(i*x)^r*(c*x^n)^(-I*b*d)/(2*x^(r - I*b*d*n))* Int[x^(r - I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] - I*E^(I*a*d)*(i*x)^r*(c*x^n)^(I*b*d)/(2*x^(r + I*b*d*n))* Int[x^(r + I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, q, r}, x]
Int[(i_.*x_)^r_.*(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := E^(-I*a*d)*(i*x)^r*(c*x^n)^(-I*b*d)/(2*x^(r - I*b*d*n))* Int[x^(r - I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] + E^(I*a*d)*(i*x)^r*(c*x^n)^(I*b*d)/(2*x^(r + I*b*d*n))* Int[x^(r + I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, q, r}, x]
Int[Tan[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[((I - I*E^(2*I*a*d)*x^(2*I*b*d))/(1 + E^(2*I*a*d)*x^(2*I*b*d)))^p, x] /; FreeQ[{a, b, d, p}, x]
Int[Cot[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[((-I - I*E^(2*I*a*d)*x^(2*I*b*d))/(1 - E^(2*I*a*d)*x^(2*I*b*d)))^p, x] /; FreeQ[{a, b, d, p}, x]
Int[Tan[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Tan[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Cot[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Cot[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Tan[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[(e*x)^ m*((I - I*E^(2*I*a*d)*x^(2*I*b*d))/(1 + E^(2*I*a*d)*x^(2*I*b*d)))^p, x] /; FreeQ[{a, b, d, e, m, p}, x]
Int[(e_.*x_)^m_.*Cot[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[(e*x)^ m*((-I - I*E^(2*I*a*d)*x^(2*I*b*d))/(1 - E^(2*I*a*d)*x^(2*I*b*d)))^p, x] /; FreeQ[{a, b, d, e, m, p}, x]
Int[(e_.*x_)^m_.*Tan[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Tan[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Cot[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Cot[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Sec[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 2^p*E^(I*a*d*p)* Int[x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d}, x] && IntegerQ[p]
Int[Csc[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := (-2*I)^p*E^(I*a*d*p)* Int[x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d}, x] && IntegerQ[p]
Int[Sec[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Sec[d*(a + b*Log[x])]^p*(1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p)* Int[x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Csc[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Csc[d*(a + b*Log[x])]^p*(1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p)* Int[x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Sec[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Sec[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Csc[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Csc[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Sec[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 2^p*E^(I*a*d*p)* Int[(e*x)^m*x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, e, m}, x] && IntegerQ[p]
Int[(e_.*x_)^m_.*Csc[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := (-2*I)^p*E^(I*a*d*p)* Int[(e*x)^m*x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, e, m}, x] && IntegerQ[p]
Int[(e_.*x_)^m_.*Sec[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Sec[d*(a + b*Log[x])]^p*(1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p)* Int[(e*x)^m*x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Csc[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Csc[d*(a + b*Log[x])]^p*(1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p)* Int[(e*x)^m*x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Sec[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Sec[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Csc[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Csc[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Sin[a_.*x_*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := -Cos[a*x*Log[b*x]]/a - Int[Sin[a*x*Log[b*x]], x] /; FreeQ[{a, b}, x]
Int[Cos[a_.*x_*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := Sin[a*x*Log[b*x]]/a - Int[Cos[a*x*Log[b*x]], x] /; FreeQ[{a, b}, x]
Int[x_^m_.*Sin[a_.*x_^n_.*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := -Cos[a*x^n*Log[b*x]]/(a*n) - 1/n*Int[x^m*Sin[a*x^n*Log[b*x]], x] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]
Int[x_^m_.*Cos[a_.*x_^n_.*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := Sin[a*x^n*Log[b*x]]/(a*n) - 1/n*Int[x^m*Cos[a*x^n*Log[b*x]], x] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]

(*FILE: 
Rubi/IntegrationRules/4 Trig functions/4.7 Miscellaneous/4.7.9 Active trig functions.m
*)

(* ::Subsection::Closed:: *)
(* 4.7.9 Active trig functions *)
Int[(e_. + f_.*x_)^m_.* Sin[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sin[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Sin[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Cos[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Cos[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Cos[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]/(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := -I*(e + f*x)^(m + 1)/(b*f*(m + 1)) + 2*Int[(e + f*x)^m*E^(I*(c + d*x))/(a - I*b*E^(I*(c + d*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]/(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := I*(e + f*x)^(m + 1)/(b*f*(m + 1)) - 2*I*Int[(e + f*x)^m*E^(I*(c + d*x))/(a + b*E^(I*(c + d*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]/(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := -I*(e + f*x)^(m + 1)/(b*f*(m + 1)) + Int[(e + f*x)^m* E^(I*(c + d*x))/(a - Rt[a^2 - b^2, 2] - I*b*E^(I*(c + d*x))), x] + Int[(e + f*x)^m* E^(I*(c + d*x))/(a + Rt[a^2 - b^2, 2] - I*b*E^(I*(c + d*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && PosQ[a^2 - b^2]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]/(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := I*(e + f*x)^(m + 1)/(b*f*(m + 1)) - I*Int[(e + f*x)^m* E^(I*(c + d*x))/(a - Rt[a^2 - b^2, 2] + b*E^(I*(c + d*x))), x] - I*Int[(e + f*x)^m* E^(I*(c + d*x))/(a + Rt[a^2 - b^2, 2] + b*E^(I*(c + d*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && PosQ[a^2 - b^2]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]/(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := -I*(e + f*x)^(m + 1)/(b*f*(m + 1)) + I*Int[(e + f*x)^m* E^(I*(c + d*x))/(I*a - Rt[-a^2 + b^2, 2] + b*E^(I*(c + d*x))), x] + I*Int[(e + f*x)^m* E^(I*(c + d*x))/(I*a + Rt[-a^2 + b^2, 2] + b*E^(I*(c + d*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NegQ[a^2 - b^2]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]/(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := I*(e + f*x)^(m + 1)/(b*f*(m + 1)) + Int[(e + f*x)^m* E^(I*(c + d*x))/(I*a - Rt[-a^2 + b^2, 2] + I*b*E^(I*(c + d*x))), x] + Int[(e + f*x)^m* E^(I*(c + d*x))/(I*a + Rt[-a^2 + b^2, 2] + I*b*E^(I*(c + d*x))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NegQ[a^2 - b^2]
Int[(e_. + f_.*x_)^m_.* Cos[c_. + d_.*x_]^n_/(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2), x] - 1/b*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 1] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Sin[c_. + d_.*x_]^n_/(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2), x] - 1/b*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 1] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Cos[c_. + d_.*x_]^n_/(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := a/b^2*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2), x] - 1/b*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2)*Sin[c + d*x], x] - (a^2 - b^2)/b^2* Int[(e + f*x)^m*Cos[c + d*x]^(n - 2)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 1] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.* Sin[c_. + d_.*x_]^n_/(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := a/b^2*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2), x] - 1/b*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2)*Cos[c + d*x], x] - (a^2 - b^2)/b^2* Int[(e + f*x)^m*Sin[c + d*x]^(n - 2)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 1] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.* Tan[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sec[c + d*x]*Tan[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Sec[c + d*x]* Tan[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Cot[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Csc[c + d*x]*Cot[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Csc[c + d*x]* Cot[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Cot[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Cot[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Cos[c + d*x]* Cot[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Tan[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Tan[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Sin[c + d*x]* Tan[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Sec[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sec[c + d*x]^(n + 2), x] - 1/b*Int[(e + f*x)^m*Sec[c + d*x]^(n + 1)*Tan[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Csc[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Csc[c + d*x]^(n + 2), x] - 1/b*Int[(e + f*x)^m*Csc[c + d*x]^(n + 1)*Cot[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Sec[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := -b^2/(a^2 - b^2)* Int[(e + f*x)^m*Sec[c + d*x]^(n - 2)/(a + b*Sin[c + d*x]), x] + 1/(a^2 - b^2)* Int[(e + f*x)^m*Sec[c + d*x]^n*(a - b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Csc[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := -b^2/(a^2 - b^2)* Int[(e + f*x)^m*Csc[c + d*x]^(n - 2)/(a + b*Cos[c + d*x]), x] + 1/(a^2 - b^2)* Int[(e + f*x)^m*Csc[c + d*x]^n*(a - b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Csc[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Csc[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Csc[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Sec[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sec[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Sec[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*F[c + d*x]^n/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && TrigQ[F]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*F[c + d*x]^n/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && TrigQ[F]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]^p_.* Sin[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Cos[c + d*x]^p*Sin[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Cos[c + d*x]^p* Sin[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]^p_.* Cos[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sin[c + d*x]^p*Cos[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Sin[c + d*x]^p* Cos[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]^p_.* Tan[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Cos[c + d*x]^(p - 1)*Tan[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Cos[c + d*x]^(p - 1)* Tan[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]^p_.* Cot[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sin[c + d*x]^(p - 1)*Cot[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Sin[c + d*x]^(p - 1)* Cot[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]^p_.* Cot[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Cos[c + d*x]^p*Cot[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Cos[c + d*x]^(p + 1)* Cot[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]^p_.* Tan[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sin[c + d*x]^p*Tan[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Sin[c + d*x]^(p + 1)* Tan[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]^p_.* Csc[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Cos[c + d*x]^p*Csc[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Cos[c + d*x]^p* Csc[c + d*x]^(n - 1)/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]^p_.* Sec[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sin[c + d*x]^p*Sec[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Sin[c + d*x]^p* Sec[c + d*x]^(n - 1)/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Cos[c_. + d_.*x_]^p_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Sin[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*Cos[c + d*x]^p* F[c + d*x]^n/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && TrigQ[F]
Int[(e_. + f_.*x_)^m_.*Sin[c_. + d_.*x_]^p_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Cos[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*Sin[c + d*x]^p* F[c + d*x]^n/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && TrigQ[F]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Sec[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Cos[c + d*x]*F[c + d*x]^n/(b + a*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && IntegersQ[m, n]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Csc[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Sin[c + d*x]*F[c + d*x]^n/(b + a*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && IntegersQ[m, n]
Int[(e_. + f_.*x_)^m_.*F_[c_. + d_.*x_]^n_.* G_[c_. + d_.*x_]^p_./(a_ + b_.*Sec[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Cos[c + d*x]*F[c + d*x]^n* G[c + d*x]^p/(b + a*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && TrigQ[G] && IntegersQ[m, n, p]
Int[(e_. + f_.*x_)^m_.*F_[c_. + d_.*x_]^n_.* G_[c_. + d_.*x_]^p_./(a_ + b_.*Csc[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Sin[c + d*x]*F[c + d*x]^n* G[c + d*x]^p/(b + a*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && TrigQ[G] && IntegersQ[m, n, p]
Int[Sin[a_. + b_.*x_]^p_.*Sin[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(I/E^(I*(c + d*x)) - I*E^(I*(c + d*x)))^ q, (I/E^(I*(a + b*x)) - I*E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Cos[a_. + b_.*x_]^p_.*Cos[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(E^(-I*(c + d*x)) + E^(I*(c + d*x)))^ q, (E^(-I*(a + b*x)) + E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Sin[a_. + b_.*x_]^p_.*Cos[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(E^(-I*(c + d*x)) + E^(I*(c + d*x)))^ q, (I/E^(I*(a + b*x)) - I*E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Cos[a_. + b_.*x_]^p_.*Sin[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(I/E^(I*(c + d*x)) - I*E^(I*(c + d*x)))^ q, (E^(-I*(a + b*x)) + E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Sin[a_. + b_.*x_]*Tan[c_. + d_.*x_], x_Symbol] := Int[E^(-I*(a + b*x))/2 - E^(I*(a + b*x))/2 - E^(-I*(a + b*x))/(1 + E^(2*I*(c + d*x))) + E^(I*(a + b*x))/(1 + E^(2*I*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Cos[a_. + b_.*x_]*Cot[c_. + d_.*x_], x_Symbol] := Int[I*E^(-I*(a + b*x))/2 + I*E^(I*(a + b*x))/2 - I*E^(-I*(a + b*x))/(1 - E^(2*I*(c + d*x))) - I*E^(I*(a + b*x))/(1 - E^(2*I*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Sin[a_. + b_.*x_]*Cot[c_. + d_.*x_], x_Symbol] := Int[-E^(-I*(a + b*x))/2 + E^(I*(a + b*x))/2 + E^(-I*(a + b*x))/(1 - E^(2*I*(c + d*x))) - E^(I*(a + b*x))/(1 - E^(2*I*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Cos[a_. + b_.*x_]*Tan[c_. + d_.*x_], x_Symbol] := Int[-I*E^(-I*(a + b*x))/2 - I*E^(I*(a + b*x))/2 + I*E^(-I*(a + b*x))/(1 + E^(2*I*(c + d*x))) + I*E^(I*(a + b*x))/(1 + E^(2*I*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Sin[a_./(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Sin[a*x]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, c, d}, x] && IGtQ[n, 0]
Int[Cos[a_./(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Cos[a*x]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, c, d}, x] && IGtQ[n, 0]
Int[Sin[e_.*(a_. + b_.*x_)/(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Sin[b*e/d - e*(b*c - a*d)*x/d]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && NeQ[b*c - a*d, 0]
Int[Cos[e_.*(a_. + b_.*x_)/(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Cos[b*e/d - e*(b*c - a*d)*x/d]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && NeQ[b*c - a*d, 0]
Int[Sin[u_]^n_., x_Symbol] := Module[{lst = QuotientOfLinearsParts[u, x]}, Int[Sin[(lst[[1]] + lst[[2]]*x)/(lst[[3]] + lst[[4]]*x)]^n, x]] /; IGtQ[n, 0] && QuotientOfLinearsQ[u, x]
Int[Cos[u_]^n_., x_Symbol] := Module[{lst = QuotientOfLinearsParts[u, x]}, Int[Cos[(lst[[1]] + lst[[2]]*x)/(lst[[3]] + lst[[4]]*x)]^n, x]] /; IGtQ[n, 0] && QuotientOfLinearsQ[u, x]
Int[u_.*Sin[v_]^p_.*Sin[w_]^q_., x_Symbol] := Int[u*Sin[v]^(p + q), x] /; EqQ[w, v]
Int[u_.*Cos[v_]^p_.*Cos[w_]^q_., x_Symbol] := Int[u*Cos[v]^(p + q), x] /; EqQ[w, v]
Int[Sin[v_]^p_.*Sin[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[Sin[v]^p*Sin[w]^q, x], x] /; (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x]) && IGtQ[p, 0] && IGtQ[q, 0]
Int[Cos[v_]^p_.*Cos[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[Cos[v]^p*Cos[w]^q, x], x] /; (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x]) && IGtQ[p, 0] && IGtQ[q, 0]
Int[x_^m_.*Sin[v_]^p_.*Sin[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[x^m, Sin[v]^p*Sin[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[x_^m_.*Cos[v_]^p_.*Cos[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[x^m, Cos[v]^p*Cos[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[u_.*Sin[v_]^p_.*Cos[w_]^p_., x_Symbol] := 1/2^p*Int[u*Sin[2*v]^p, x] /; EqQ[w, v] && IntegerQ[p]
Int[Sin[v_]^p_.*Cos[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[Sin[v]^p*Cos[w]^q, x], x] /; IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[x_^m_.*Sin[v_]^p_.*Cos[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[x^m, Sin[v]^p*Cos[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[Sin[v_]*Tan[w_]^n_., x_Symbol] := -Int[Cos[v]*Tan[w]^(n - 1), x] + Cos[v - w]*Int[Sec[w]*Tan[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Cot[w_]^n_., x_Symbol] := -Int[Sin[v]*Cot[w]^(n - 1), x] + Cos[v - w]*Int[Csc[w]*Cot[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Sin[v_]*Cot[w_]^n_., x_Symbol] := Int[Cos[v]*Cot[w]^(n - 1), x] + Sin[v - w]*Int[Csc[w]*Cot[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Tan[w_]^n_., x_Symbol] := Int[Sin[v]*Tan[w]^(n - 1), x] - Sin[v - w]*Int[Sec[w]*Tan[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Sin[v_]*Sec[w_]^n_., x_Symbol] := Cos[v - w]*Int[Tan[w]*Sec[w]^(n - 1), x] + Sin[v - w]*Int[Sec[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Csc[w_]^n_., x_Symbol] := Cos[v - w]*Int[Cot[w]*Csc[w]^(n - 1), x] - Sin[v - w]*Int[Csc[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Sin[v_]*Csc[w_]^n_., x_Symbol] := Sin[v - w]*Int[Cot[w]*Csc[w]^(n - 1), x] + Cos[v - w]*Int[Csc[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Sec[w_]^n_., x_Symbol] := -Sin[v - w]*Int[Tan[w]*Sec[w]^(n - 1), x] + Cos[v - w]*Int[Sec[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[(e_. + f_.*x_)^m_.*(a_ + b_.*Sin[c_. + d_.*x_]*Cos[c_. + d_.*x_])^ n_., x_Symbol] := Int[(e + f*x)^m*(a + b*Sin[2*c + 2*d*x]/2)^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[x_^m_.*(a_ + b_.*Sin[c_. + d_.*x_]^2)^n_, x_Symbol] := 1/2^n*Int[x^m*(2*a + b - b*Cos[2*c + 2*d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a + b, 0] && IGtQ[m, 0] && ILtQ[n, 0] && (EqQ[n, -1] || EqQ[m, 1] && EqQ[n, -2])
Int[x_^m_.*(a_ + b_.*Cos[c_. + d_.*x_]^2)^n_, x_Symbol] := 1/2^n*Int[x^m*(2*a + b + b*Cos[2*c + 2*d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a + b, 0] && IGtQ[m, 0] && ILtQ[n, 0] && (EqQ[n, -1] || EqQ[m, 1] && EqQ[n, -2])
Int[(f_. + g_.*x_)^ m_./(a_. + b_.*Cos[d_. + e_.*x_]^2 + c_.*Sin[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[(f_. + g_.*x_)^m_.* Sec[d_. + e_.*x_]^2/(b_ + c_.*Tan[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{b, c, d, e, f, g}, x] && IGtQ[m, 0]
Int[(f_. + g_.*x_)^m_.* Sec[d_. + e_.*x_]^2/(b_. + a_.*Sec[d_. + e_.*x_]^2 + c_.*Tan[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[(f_. + g_.*x_)^m_.* Csc[d_. + e_.*x_]^2/(c_ + b_.*Cot[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{b, c, d, e, f, g}, x] && IGtQ[m, 0]
Int[(f_. + g_.*x_)^m_.* Csc[d_. + e_.*x_]^2/(c_. + b_.*Cot[d_. + e_.*x_]^2 + a_.*Csc[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[(e_. + f_.*x_)*(A_ + B_.*Sin[c_. + d_.*x_])/(a_ + b_.*Sin[c_. + d_.*x_])^2, x_Symbol] := -B*(e + f*x)*Cos[c + d*x]/(a*d*(a + b*Sin[c + d*x])) + B*f/(a*d)*Int[Cos[c + d*x]/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[a*A - b*B, 0]
Int[(e_. + f_.*x_)*(A_ + B_.*Cos[c_. + d_.*x_])/(a_ + b_.*Cos[c_. + d_.*x_])^2, x_Symbol] := B*(e + f*x)*Sin[c + d*x]/(a*d*(a + b*Cos[c + d*x])) - B*f/(a*d)*Int[Sin[c + d*x]/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[a*A - b*B, 0]
Int[x_^2/(c_.*Sin[a_.*x_] + d_.*x_*Cos[a_.*x_])^2, x_Symbol] := x/(a*d*Sin[a*x]*(c*Sin[a*x] + d*x*Cos[a*x])) + 1/d^2*Int[1/Sin[a*x]^2, x] /; FreeQ[{a, c, d}, x] && EqQ[a*c + d, 0]
Int[x_^2/(c_.*Cos[a_.*x_] + d_.*x_*Sin[a_.*x_])^2, x_Symbol] := -x/(a*d*Cos[a*x]*(c*Cos[a*x] + d*x*Sin[a*x])) + 1/d^2*Int[1/Cos[a*x]^2, x] /; FreeQ[{a, c, d}, x] && EqQ[a*c - d, 0]
Int[Sin[a_.*x_]^2/(c_.*Sin[a_.*x_] + d_.*x_*Cos[a_.*x_])^2, x_Symbol] := 1/(d^2*x) + Sin[a*x]/(a*d*x*(d*x*Cos[a*x] + c*Sin[a*x])) /; FreeQ[{a, c, d}, x] && EqQ[a*c + d, 0]
Int[Cos[a_.*x_]^2/(c_.*Cos[a_.*x_] + d_.*x_*Sin[a_.*x_])^2, x_Symbol] := 1/(d^2*x) - Cos[a*x]/(a*d*x*(d*x*Sin[a*x] + c*Cos[a*x])) /; FreeQ[{a, c, d}, x] && EqQ[a*c - d, 0]
Int[(b_.*x_)^m_* Sin[a_.*x_]^n_/(c_.*Sin[a_.*x_] + d_.*x_*Cos[a_.*x_])^2, x_Symbol] := b*(b*x)^(m - 1)* Sin[a*x]^(n - 1)/(a*d*(c*Sin[a*x] + d*x*Cos[a*x])) - b^2*(n - 1)/d^2*Int[(b*x)^(m - 2)*Sin[a*x]^(n - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c + d, 0] && EqQ[m, 2 - n]
Int[(b_.*x_)^m_* Cos[a_.*x_]^n_/(c_.*Cos[a_.*x_] + d_.*x_*Sin[a_.*x_])^2, x_Symbol] := -b*(b*x)^(m - 1)* Cos[a*x]^(n - 1)/(a*d*(c*Cos[a*x] + d*x*Sin[a*x])) - b^2*(n - 1)/d^2*Int[(b*x)^(m - 2)*Cos[a*x]^(n - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c - d, 0] && EqQ[m, 2 - n]
Int[(b_.*x_)^m_.* Csc[a_.*x_]^n_./(c_.*Sin[a_.*x_] + d_.*x_*Cos[a_.*x_])^2, x_Symbol] := b*(b*x)^(m - 1)* Csc[a*x]^(n + 1)/(a*d*(c*Sin[a*x] + d*x*Cos[a*x])) + b^2*(n + 1)/d^2*Int[(b*x)^(m - 2)*Csc[a*x]^(n + 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c + d, 0] && EqQ[m, n + 2]
Int[(b_.*x_)^m_.* Sec[a_.*x_]^n_./(c_.*Cos[a_.*x_] + d_.*x_*Sin[a_.*x_])^2, x_Symbol] := -b*(b*x)^(m - 1)* Sec[a*x]^(n + 1)/(a*d*(c*Cos[a*x] + d*x*Sin[a*x])) + b^2*(n + 1)/d^2*Int[(b*x)^(m - 2)*Sec[a*x]^(n + 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c - d, 0] && EqQ[m, n + 2]
Int[(g_. + h_.*x_)^p_.*(a_ + b_.*Sin[e_. + f_.*x_])^ m_.*(c_ + d_.*Sin[e_. + f_.*x_])^n_., x_Symbol] := a^m*c^m* Int[(g + h*x)^p*Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && IGtQ[n - m, 0]
Int[(g_. + h_.*x_)^p_.*(a_ + b_.*Cos[e_. + f_.*x_])^ m_.*(c_ + d_.*Cos[e_. + f_.*x_])^n_., x_Symbol] := a^m*c^m* Int[(g + h*x)^p*Sin[e + f*x]^(2*m)*(c + d*Cos[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && IGtQ[n - m, 0]
Int[(g_. + h_.*x_)^p_.*(a_ + b_.*Sin[e_. + f_.*x_])^ m_*(c_ + d_.*Sin[e_. + f_.*x_])^n_, x_Symbol] := a^IntPart[m]* c^IntPart[m]*(a + b*Sin[e + f*x])^ FracPart[m]*(c + d*Sin[e + f*x])^FracPart[m]/ Cos[e + f*x]^(2*FracPart[m])* Int[(g + h*x)^p* Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[p] && IntegerQ[2*m] && IGeQ[n - m, 0]
Int[(g_. + h_.*x_)^p_.*(a_ + b_.*Cos[e_. + f_.*x_])^ m_*(c_ + d_.*Cos[e_. + f_.*x_])^n_, x_Symbol] := a^IntPart[m]* c^IntPart[m]*(a + b*Cos[e + f*x])^ FracPart[m]*(c + d*Cos[e + f*x])^FracPart[m]/ Sin[e + f*x]^(2*FracPart[m])* Int[(g + h*x)^p* Sin[e + f*x]^(2*m)*(c + d*Cos[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[p] && IntegerQ[2*m] && IGeQ[n - m, 0]
Int[Sec[v_]^m_.*(a_ + b_.*Tan[v_])^n_., x_Symbol] := Int[(a*Cos[v] + b*Sin[v])^n, x] /; FreeQ[{a, b}, x] && IntegerQ[(m - 1)/2] && EqQ[m + n, 0]
Int[Csc[v_]^m_.*(a_ + b_.*Cot[v_])^n_., x_Symbol] := Int[(b*Cos[v] + a*Sin[v])^n, x] /; FreeQ[{a, b}, x] && IntegerQ[(m - 1)/2] && EqQ[m + n, 0]
Int[u_.*Sin[a_. + b_.*x_]^m_.*Sin[c_. + d_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[u, Sin[a + b*x]^m*Sin[c + d*x]^n, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[u_.*Cos[a_. + b_.*x_]^m_.*Cos[c_. + d_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[u, Cos[a + b*x]^m*Cos[c + d*x]^n, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[Sec[a_. + b_.*x_]*Sec[c_ + d_.*x_], x_Symbol] := -Csc[(b*c - a*d)/d]*Int[Tan[a + b*x], x] + Csc[(b*c - a*d)/b]*Int[Tan[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Csc[a_. + b_.*x_]*Csc[c_ + d_.*x_], x_Symbol] := Csc[(b*c - a*d)/b]*Int[Cot[a + b*x], x] - Csc[(b*c - a*d)/d]*Int[Cot[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Tan[a_. + b_.*x_]*Tan[c_ + d_.*x_], x_Symbol] := -b*x/d + b/d*Cos[(b*c - a*d)/d]*Int[Sec[a + b*x]*Sec[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Cot[a_. + b_.*x_]*Cot[c_ + d_.*x_], x_Symbol] := -b*x/d + Cos[(b*c - a*d)/d]*Int[Csc[a + b*x]*Csc[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[u_.*(a_.*Cos[v_] + b_.*Sin[v_])^n_., x_Symbol] := Int[u*(a*E^(-a/b*v))^n, x] /; FreeQ[{a, b, n}, x] && EqQ[a^2 + b^2, 0]
Int[Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := I/2*Int[E^(-I*d*(a + b*Log[c*x^n])^2), x] - I/2*Int[E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, n}, x]
Int[Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := 1/2*Int[E^(-I*d*(a + b*Log[c*x^n])^2), x] + 1/2*Int[E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, n}, x]
Int[(e_.*x_)^m_.*Sin[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := I/2*Int[(e*x)^m*E^(-I*d*(a + b*Log[c*x^n])^2), x] - I/2*Int[(e*x)^m*E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*Cos[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := 1/2*Int[(e*x)^m*E^(-I*d*(a + b*Log[c*x^n])^2), x] + 1/2*Int[(e*x)^m*E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.1 Inverse sine/5.1.1 (a+b arcsin(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 5.1.1 (a+b arcsin(c x))^n *)
Int[(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := x*(a + b*ArcSin[c*x])^n - b*c*n*Int[x*(a + b*ArcSin[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && GtQ[n, 0]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := x*(a + b*ArcCos[c*x])^n + b*c*n*Int[x*(a + b*ArcCos[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && GtQ[n, 0]
Int[(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := Sqrt[1 - c^2*x^2]*(a + b*ArcSin[c*x])^(n + 1)/(b*c*(n + 1)) + c/(b*(n + 1))* Int[x*(a + b*ArcSin[c*x])^(n + 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && LtQ[n, -1]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -Sqrt[1 - c^2*x^2]*(a + b*ArcCos[c*x])^(n + 1)/(b*c*(n + 1)) - c/(b*(n + 1))* Int[x*(a + b*ArcCos[c*x])^(n + 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && LtQ[n, -1]
Int[(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := 1/(b*c)*Subst[Int[x^n*Cos[-a/b + x/b], x], x, a + b*ArcSin[c*x]] /; FreeQ[{a, b, c, n}, x]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -1/(b*c)*Subst[Int[x^n*Sin[-a/b + x/b], x], x, a + b*ArcCos[c*x]] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.1 Inverse sine/5.1.2 (d x)^m (a+b arcsin(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 5.1.2 (d x)^m (a+b arcsin(c x))^n *)
(* Int[(a_.+b_.*ArcSin[c_.*x_])^n_./x_,x_Symbol] := 1/b*Subst[Int[x^n*Cot[-a/b+x/b],x],x,a+b*ArcSin[c*x]] /; FreeQ[{a,b,c},x] && IGtQ[n,0] *)
(* Int[(a_.+b_.*ArcCos[c_.*x_])^n_./x_,x_Symbol] := -1/b*Subst[Int[x^n*Tan[-a/b+x/b],x],x,a+b*ArcCos[c*x]] /; FreeQ[{a,b,c},x] && IGtQ[n,0] *)
Int[(a_. + b_.*ArcSin[c_.*x_])^n_./x_, x_Symbol] := Subst[Int[(a + b*x)^n*Cot[x], x], x, ArcSin[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_./x_, x_Symbol] := -Subst[Int[(a + b*x)^n*Tan[x], x], x, ArcCos[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[n, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (d*x)^(m + 1)*(a + b*ArcSin[c*x])^n/(d*(m + 1)) - b*c*n/(d*(m + 1))* Int[(d*x)^(m + 1)*(a + b*ArcSin[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCos[c*x])^n/(d*(m + 1)) + b*c*n/(d*(m + 1))* Int[(d*x)^(m + 1)*(a + b*ArcCos[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := x^(m + 1)*(a + b*ArcSin[c*x])^n/(m + 1) - b*c*n/(m + 1)* Int[x^(m + 1)*(a + b*ArcSin[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := x^(m + 1)*(a + b*ArcCos[c*x])^n/(m + 1) + b*c*n/(m + 1)* Int[x^(m + 1)*(a + b*ArcCos[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := x^m*Sqrt[1 - c^2*x^2]*(a + b*ArcSin[c*x])^(n + 1)/(b*c*(n + 1)) - 1/(b^2*c^(m + 1)*(n + 1))* Subst[Int[ ExpandTrigReduce[x^(n + 1), Sin[-a/b + x/b]^(m - 1)*(m - (m + 1)*Sin[-a/b + x/b]^2), x], x], x, a + b*ArcSin[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GeQ[n, -2] && LtQ[n, -1]
Int[x_^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -x^m*Sqrt[ 1 - c^2*x^2]*(a + b*ArcCos[c*x])^(n + 1)/(b*c*(n + 1)) - 1/(b^2*c^(m + 1)*(n + 1))* Subst[Int[ ExpandTrigReduce[x^(n + 1), Cos[-a/b + x/b]^(m - 1)*(m - (m + 1)*Cos[-a/b + x/b]^2), x], x], x, a + b*ArcCos[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GeQ[n, -2] && LtQ[n, -1]
Int[x_^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := x^m*Sqrt[1 - c^2*x^2]*(a + b*ArcSin[c*x])^(n + 1)/(b*c*(n + 1)) - m/(b*c*(n + 1))* Int[x^(m - 1)*(a + b*ArcSin[c*x])^(n + 1)/Sqrt[1 - c^2*x^2], x] + c*(m + 1)/(b*(n + 1))* Int[x^(m + 1)*(a + b*ArcSin[c*x])^(n + 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && LtQ[n, -2]
Int[x_^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -x^m*Sqrt[ 1 - c^2*x^2]*(a + b*ArcCos[c*x])^(n + 1)/(b*c*(n + 1)) + m/(b*c*(n + 1))* Int[x^(m - 1)*(a + b*ArcCos[c*x])^(n + 1)/Sqrt[1 - c^2*x^2], x] - c*(m + 1)/(b*(n + 1))* Int[x^(m + 1)*(a + b*ArcCos[c*x])^(n + 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && LtQ[n, -2]
Int[x_^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := 1/(b*c^(m + 1))* Subst[Int[x^n*Sin[-a/b + x/b]^m*Cos[-a/b + x/b], x], x, a + b*ArcSin[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[m, 0]
Int[x_^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -1/(b*c^(m + 1))* Subst[Int[x^n*Cos[-a/b + x/b]^m*Sin[-a/b + x/b], x], x, a + b*ArcCos[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[m, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.1 Inverse sine/5.1.3 (d+e x^2)^p (a+b arcsin(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 5.1.3 (d+e x^2)^p (a+b arcsin(c x))^n *)
(* Int[(a_.+b_.*ArcSin[c_.*x_])^n_./Sqrt[d_+e_.*x_^2],x_Symbol] := 1/c*Simp[Sqrt[1-c^2*x^2]/Sqrt[d+e*x^2]]*Subst[Int[(a+b*x)^n,x],x, ArcSin[c*x]] /; FreeQ[{a,b,c,d,e,n},x] && EqQ[c^2*d+e,0] *)
(* Int[(a_.+b_.*ArcCos[c_.*x_])^n_./Sqrt[d_+e_.*x_^2],x_Symbol] := -1/c*Simp[Sqrt[1-c^2*x^2]/Sqrt[d+e*x^2]]*Subst[Int[(a+b*x)^n,x],x, ArcCos[c*x]] /; FreeQ[{a,b,c,d,e,n},x] && EqQ[c^2*d+e,0] *)
Int[1/(Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSin[c_.*x_])), x_Symbol] := 1/(b*c)*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Log[a + b*ArcSin[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[1/(Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCos[c_.*x_])), x_Symbol] := -1/(b*c)*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Log[a + b*ArcCos[c*x]]/(b*c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcSin[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(b*c*(n + 1))* Simp[Sqrt[1 - c^2*x^2]/ Sqrt[d + e*x^2]]*(a + b*ArcSin[c*x])^(n + 1) /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && NeQ[n, -1]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -1/(b*c*(n + 1))* Simp[Sqrt[1 - c^2*x^2]/ Sqrt[d + e*x^2]]*(a + b*ArcCos[c*x])^(n + 1) /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && NeQ[n, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := x*Sqrt[d + e*x^2]*(a + b*ArcSin[c*x])^n/2 - b*c*n/2*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[x*(a + b*ArcSin[c*x])^(n - 1), x] + 1/2*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(a + b*ArcSin[c*x])^n/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0]
Int[Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := x*Sqrt[d + e*x^2]*(a + b*ArcCos[c*x])^n/2 + b*c*n/2*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[x*(a + b*ArcCos[c*x])^(n - 1), x] + 1/2*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(a + b*ArcCos[c*x])^n/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := x*(d + e*x^2)^p*(a + b*ArcSin[c*x])^n/(2*p + 1) + 2*d*p/(2*p + 1)* Int[(d + e*x^2)^(p - 1)*(a + b*ArcSin[c*x])^n, x] - b*c*n/(2*p + 1)*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[x*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := x*(d + e*x^2)^p*(a + b*ArcCos[c*x])^n/(2*p + 1) + 2*d*p/(2*p + 1)* Int[(d + e*x^2)^(p - 1)*(a + b*ArcCos[c*x])^n, x] + b*c*n/(2*p + 1)*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[x*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcSin[c_.*x_])^n_./(d_ + e_.*x_^2)^(3/2), x_Symbol] := x*(a + b*ArcSin[c*x])^n/(d*Sqrt[d + e*x^2]) - b*c*n/d*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Int[x*(a + b*ArcSin[c*x])^(n - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_./(d_ + e_.*x_^2)^(3/2), x_Symbol] := x*(a + b*ArcCos[c*x])^n/(d*Sqrt[d + e*x^2]) + b*c*n/d*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Int[x*(a + b*ArcCos[c*x])^(n - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := -x*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^n/(2*d*(p + 1)) + (2*p + 3)/(2*d*(p + 1))* Int[(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^n, x] + b*c*n/(2*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[x*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := -x*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^n/(2*d*(p + 1)) + (2*p + 3)/(2*d*(p + 1))* Int[(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^n, x] - b*c*n/(2*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[x*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(a_. + b_.*ArcSin[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := 1/(c*d)*Subst[Int[(a + b*x)^n*Sec[x], x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := -1/(c*d)*Subst[Int[(a + b*x)^n*Csc[x], x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
(* Int[(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcSin[c_.*x_])^n_,x_Symbol] := d^p*(1-c^2*x^2)^(p+1/2)*(a+b*ArcSin[c*x])^(n+1)/(b*c*(n+1)) + c*d^p*(2*p+1)/(b*(n+1))*Int[x*(1-c^2*x^2)^(p-1/2)*(a+b*ArcSin[c*x])^ (n+1),x] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[c^2*d+e,0] && LtQ[n,-1] && (IntegerQ[p]  || GtQ[d,0]) *)
(* Int[(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcCos[c_.*x_])^n_,x_Symbol] := -d^p*(1-c^2*x^2)^(p+1/2)*(a+b*ArcCos[c*x])^(n+1)/(b*c*(n+1)) - c*d^p*(2*p+1)/(b*(n+1))*Int[x*(1-c^2*x^2)^(p-1/2)*(a+b*ArcCos[c*x])^ (n+1),x] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[c^2*d+e,0] && LtQ[n,-1] && (IntegerQ[p]  || GtQ[d,0]) *)
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := Sqrt[1 - c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcSin[c*x])^(n + 1)/(b*c*(n + 1)) + c*(2*p + 1)/(b*(n + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[x*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -Sqrt[1 - c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcCos[c*x])^(n + 1)/(b*c*(n + 1)) - c*(2*p + 1)/(b*(n + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[x*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := 1/(b*c)*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Subst[Int[x^n*Cos[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcSin[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[2*p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := -1/(b*c)*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Subst[Int[x^n*Sin[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcCos[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[2*p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d + e, 0] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d + e, 0] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSin[c*x])^n, (d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && NeQ[c^2*d + e, 0] && IntegerQ[p] && (GtQ[p, 0] || IGtQ[n, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCos[c*x])^n, (d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && NeQ[c^2*d + e, 0] && IntegerQ[p] && (GtQ[p, 0] || IGtQ[n, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Unintegrable[(d + e*x^2)^p*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, n, p}, x]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Unintegrable[(d + e*x^2)^p*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, n, p}, x]
Int[(d_ + e_.*x_)^p_*(f_ + g_.*x_)^q_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^q* Int[(d + e*x)^(p - q)*(1 - c^2*x^2)^q*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0] && GtQ[d, 0] && LtQ[g/e, 0]
Int[(d_ + e_.*x_)^p_*(f_ + g_.*x_)^q_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^q* Int[(d + e*x)^(p - q)*(1 - c^2*x^2)^q*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0] && GtQ[d, 0] && LtQ[g/e, 0]
Int[(d_ + e_.*x_)^p_*(f_ + g_.*x_)^q_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (d + e*x)^q*(f + g*x)^q/(1 - c^2*x^2)^q* Int[(d + e*x)^(p - q)*(1 - c^2*x^2)^q*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0]
Int[(d_ + e_.*x_)^p_*(f_ + g_.*x_)^q_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (d + e*x)^q*(f + g*x)^q/(1 - c^2*x^2)^q* Int[(d + e*x)^(p - q)*(1 - c^2*x^2)^q*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.1 Inverse sine/5.1.4 (f x)^m (d+e x^2)^p (a+b arcsin(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 5.1.4 (f x)^m (d+e x^2)^p (a+b arcsin(c x))^n *)
Int[x_*(a_. + b_.*ArcSin[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := -1/e*Subst[Int[(a + b*x)^n*Tan[x], x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[x_*(a_. + b_.*ArcCos[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := 1/e*Subst[Int[(a + b*x)^n*Cot[x], x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^n/(2*e*(p + 1)) + b*n/(2*c*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && NeQ[p, -1]
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^n/(2*e*(p + 1)) - b*n/(2*c*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcSin[c_.*x_])^n_./(x_*(d_ + e_.*x_^2)), x_Symbol] := 1/d*Subst[Int[(a + b*x)^n/(Cos[x]*Sin[x]), x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_./(x_*(d_ + e_.*x_^2)), x_Symbol] := -1/d*Subst[Int[(a + b*x)^n/(Cos[x]*Sin[x]), x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^ n/(d*f*(m + 1)) - b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && EqQ[m + 2*p + 3, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^ n/(d*f*(m + 1)) + b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && EqQ[m + 2*p + 3, 0] && NeQ[m, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])/x_, x_Symbol] := (d + e*x^2)^p*(a + b*ArcSin[c*x])/(2*p) - b*c*d^p/(2*p)*Int[(1 - c^2*x^2)^(p - 1/2), x] + d*Int[(d + e*x^2)^(p - 1)*(a + b*ArcSin[c*x])/x, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])/x_, x_Symbol] := (d + e*x^2)^p*(a + b*ArcCos[c*x])/(2*p) + b*c*d^p/(2*p)*Int[(1 - c^2*x^2)^(p - 1/2), x] + d*Int[(d + e*x^2)^(p - 1)*(a + b*ArcCos[c*x])/x, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcSin[c*x])/(f*(m + 1)) - b*c*d^p/(f*(m + 1))* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2), x] - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcSin[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && ILtQ[(m + 1)/2, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcCos[c*x])/(f*(m + 1)) + b*c*d^p/(f*(m + 1))* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2), x] - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcCos[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && ILtQ[(m + 1)/2, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[x_^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[SimplifyIntegrand[u/Sqrt[d + e*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2] && NeQ[p, -1/2] && (IGtQ[(m + 1)/2, 0] || ILtQ[(m + 2*p + 3)/2, 0])
Int[x_^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[SimplifyIntegrand[u/Sqrt[d + e*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2] && NeQ[p, -1/2] && (IGtQ[(m + 1)/2, 0] || ILtQ[(m + 2*p + 3)/2, 0])
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcSin[c*x])^n/(f*(m + 1)) - b*c*n/(f*(m + 1))*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^(m + 1)*(a + b*ArcSin[c*x])^(n - 1), x] + c^2/(f^2*(m + 1))*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^(m + 2)*(a + b*ArcSin[c*x])^n/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcCos[c*x])^n/(f*(m + 1)) + b*c*n/(f*(m + 1))*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^(m + 1)*(a + b*ArcCos[c*x])^(n - 1), x] + c^2/(f^2*(m + 1))*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^(m + 2)*(a + b*ArcCos[c*x])^n/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcSin[c*x])^n/(f*(m + 2)) - b*c*n/(f*(m + 2))*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^(m + 1)*(a + b*ArcSin[c*x])^(n - 1), x] + 1/(m + 2)*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^m*(a + b*ArcSin[c*x])^n/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && (IGtQ[m, -2] || EqQ[n, 1])
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcCos[c*x])^n/(f*(m + 2)) + b*c*n/(f*(m + 2))*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^(m + 1)*(a + b*ArcCos[c*x])^(n - 1), x] + 1/(m + 2)*Simp[Sqrt[d + e*x^2]/Sqrt[1 - c^2*x^2]]* Int[(f*x)^m*(a + b*ArcCos[c*x])^n/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && (IGtQ[m, -2] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcSin[c*x])^n/(f*(m + 1)) - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcSin[c*x])^n, x] - b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcCos[c*x])^n/(f*(m + 1)) - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcCos[c*x])^n, x] + b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^ p*(a + b*ArcSin[c*x])^n/(f*(m + 2*p + 1)) + 2*d*p/(m + 2*p + 1)* Int[(f*x)^m*(d + e*x^2)^(p - 1)*(a + b*ArcSin[c*x])^n, x] - b*c*n/(f*(m + 2*p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0] && Not[LtQ[m, -1]]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^ p*(a + b*ArcCos[c*x])^n/(f*(m + 2*p + 1)) + 2*d*p/(m + 2*p + 1)* Int[(f*x)^m*(d + e*x^2)^(p - 1)*(a + b*ArcCos[c*x])^n, x] + b*c*n/(f*(m + 2*p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0] && Not[LtQ[m, -1]]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^ n/(d*f*(m + 1)) + c^2*(m + 2*p + 3)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^p*(a + b*ArcSin[c*x])^n, x] - b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && ILtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^ n/(d*f*(m + 1)) + c^2*(m + 2*p + 3)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^p*(a + b*ArcCos[c*x])^n, x] + b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && ILtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^ n/(2*e*(p + 1)) - f^2*(m - 1)/(2*e*(p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^n, x] + b*f*n/(2*c*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && IGtQ[m, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^ n/(2*e*(p + 1)) - f^2*(m - 1)/(2*e*(p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^n, x] - b*f*n/(2*c*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && IGtQ[m, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := -(f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^ n/(2*d*f*(p + 1)) + (m + 2*p + 3)/(2*d*(p + 1))* Int[(f*x)^m*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^n, x] + b*c*n/(2*f*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && Not[GtQ[m, 1]] && (IntegerQ[m] || IntegerQ[p] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := -(f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^ n/(2*d*f*(p + 1)) + (m + 2*p + 3)/(2*d*(p + 1))* Int[(f*x)^m*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^n, x] - b*c*n/(2*f*(p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && Not[GtQ[m, 1]] && (IntegerQ[m] || IntegerQ[p] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])^ n/(e*(m + 2*p + 1)) + f^2*(m - 1)/(c^2*(m + 2*p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^p*(a + b*ArcSin[c*x])^n, x] + b*f*n/(c*(m + 2*p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && IGtQ[m, 1] && NeQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])^ n/(e*(m + 2*p + 1)) + f^2*(m - 1)/(c^2*(m + 2*p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^p*(a + b*ArcCos[c*x])^n, x] - b*f*n/(c*(m + 2*p + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && IGtQ[m, 1] && NeQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := (f*x)^m* Sqrt[1 - c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcSin[c*x])^(n + 1)/(b*c*(n + 1)) - f*m/(b*c*(n + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && EqQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -(f*x)^m* Sqrt[1 - c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcCos[c*x])^(n + 1)/(b*c*(n + 1)) + f*m/(b*c*(n + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && EqQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := (f*x)^m* Sqrt[1 - c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcSin[c*x])^(n + 1)/(b*c*(n + 1)) - f*m/(b*c*(n + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n + 1), x] + c*(m + 2*p + 1)/(b*f*(n + 1))* Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcSin[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && IGtQ[2*p, 0] && NeQ[m + 2*p + 1, 0] && IGtQ[m, -3]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -(f*x)^m* Sqrt[1 - c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcCos[c*x])^(n + 1)/(b*c*(n + 1)) + f*m/(b*c*(n + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n + 1), x] - c*(m + 2*p + 1)/(b*f*(n + 1))* Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 - c^2*x^2)^(p - 1/2)*(a + b*ArcCos[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && IGtQ[2*p, 0] && NeQ[m + 2*p + 1, 0] && IGtQ[m, -3]
(* Int[(f_.*x_)^m_.*(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcSin[c_.*x_])^n_,x_ Symbol] := (f*x)^m*Sqrt[1-c^2*x^2]*(d+e*x^2)^p*(a+b*ArcSin[c*x])^(n+1)/(b*c*(n+ 1)) - f*m/(b*c*(n+1))*Simp[(d+e*x^2)^p/(1-c^2*x^2)^p]*Int[(f*x)^(m-1)*(1- c^2*x^2)^(p+1/2)*(a+b*ArcSin[c*x])^(n+1),x] + c*(2*p+1)/(b*f*(n+1))*Simp[(d+e*x^2)^p/(1-c^2*x^2)^p]*Int[(f*x)^(m+ 1)*(1-c^2*x^2)^(p-1/2)*(a+b*ArcSin[c*x])^(n+1),x] /; FreeQ[{a,b,c,d,e,f},x] && EqQ[c^2*d+e,0] && LtQ[n,-1] &&  IntegerQ[2*p] && NeQ[p,-1/2] && IGtQ[m,-3] *)
(* Int[(f_.*x_)^m_.*(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcCos[c_.*x_])^n_,x_ Symbol] := -(f*x)^m*Sqrt[1-c^2*x^2]*(d+e*x^2)^p*(a+b*ArcCos[c*x])^(n+1)/(b*c*( n+1)) + f*m/(b*c*(n+1))*Simp[(d+e*x^2)^p/(1-c^2*x^2)^p]*Int[(f*x)^(m-1)*(1- c^2*x^2)^(p+1/2)*(a+b*ArcCos[c*x])^(n+1),x] - c*(2*p+1)/(b*f*(n+1))*Simp[(d+e*x^2)^p/(1-c^2*x^2)^p]*Int[(f*x)^(m+ 1)*(1-c^2*x^2)^(p-1/2)*(a+b*ArcCos[c*x])^(n+1),x] /; FreeQ[{a,b,c,d,e,f},x] && EqQ[c^2*d+e,0] && LtQ[n,-1] &&  IntegerQ[2*p] && NeQ[p,-1/2] && IGtQ[m,-3] *)
Int[(f_.*x_)^m_*(a_. + b_.*ArcSin[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcSin[c*x])^n/(e*m) + b*f*n/(c*m)*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcSin[c*x])^(n - 1), x] + f^2*(m - 1)/(c^2*m)* Int[((f*x)^(m - 2)*(a + b*ArcSin[c*x])^n)/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && IGtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCos[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcCos[c*x])^n/(e*m) - b*f*n/(c*m)*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcCos[c*x])^(n - 1), x] + f^2*(m - 1)/(c^2*m)* Int[((f*x)^(m - 2)*(a + b*ArcCos[c*x])^n)/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && IGtQ[m, 1]
Int[x_^m_*(a_. + b_.*ArcSin[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/c^(m + 1)*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Subst[Int[(a + b*x)^n*Sin[x]^m, x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_*(a_. + b_.*ArcCos[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -1/c^(m + 1)*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Subst[Int[(a + b*x)^n*Cos[x]^m, x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_.*x_)^m_*(a_. + b_.*ArcSin[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))* Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]*(a + b*ArcSin[c*x])* Hypergeometric2F1[1/2, (1 + m)/2, (3 + m)/2, c^2*x^2] - b*c*(f*x)^(m + 2)/(f^2*(m + 1)*(m + 2))* Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* HypergeometricPFQ[{1, 1 + m/2, 1 + m/2}, {3/2 + m/2, 2 + m/2}, c^2*x^2] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCos[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))*(a + b*ArcCos[c*x])* Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Hypergeometric2F1[1/2, (1 + m)/2, (3 + m)/2, c^2*x^2] + b*c*(f*x)^(m + 2)/(f^2*(m + 1)*(m + 2))* Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* HypergeometricPFQ[{1, 1 + m/2, 1 + m/2}, {3/2 + m/2, 2 + m/2}, c^2*x^2] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^m/(b*c*(n + 1))* Simp[Sqrt[1 - c^2*x^2]/ Sqrt[d + e*x^2]]*(a + b*ArcSin[c*x])^(n + 1) - f*m/(b*c*(n + 1))*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcSin[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_/Sqrt[d_ + e_.*x_^2], x_Symbol] := -(f*x)^m/(b*c*(n + 1))* Simp[Sqrt[1 - c^2*x^2]/ Sqrt[d + e*x^2]]*(a + b*ArcCos[c*x])^(n + 1) + f*m/(b*c*(n + 1))*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcCos[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1]
Int[x_^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := 1/(b*c^(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Subst[Int[x^n*Sin[-a/b + x/b]^m*Cos[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcSin[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[2*p + 2, 0] && IGtQ[m, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := -1/(b*c^(m + 1))*Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Subst[Int[x^n*Cos[-a/b + x/b]^m*Sin[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcCos[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[2*p + 2, 0] && IGtQ[m, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSin[c*x])^n/ Sqrt[d + e*x^2], (f*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[p + 1/2, 0] && Not[IGtQ[(m + 1)/2, 0]] && (EqQ[m, -1] || EqQ[m, -2])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCos[c*x])^n/ Sqrt[d + e*x^2], (f*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[p + 1/2, 0] && Not[IGtQ[(m + 1)/2, 0]] && (EqQ[m, -1] || EqQ[m, -2])
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcSin[c*x])/(2*e*(p + 1)) - b*c/(2*e*(p + 1))*Int[(d + e*x^2)^(p + 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[c^2*d + e, 0] && NeQ[p, -1]
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcCos[c*x])/(2*e*(p + 1)) + b*c/(2*e*(p + 1))*Int[(d + e*x^2)^(p + 1)/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[c^2*d + e, 0] && NeQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[c^2*d + e, 0] && IntegerQ[p] && (GtQ[p, 0] || IGtQ[(m - 1)/2, 0] && LeQ[m + p, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[c^2*d + e, 0] && IntegerQ[p] && (GtQ[p, 0] || IGtQ[(m - 1)/2, 0] && LeQ[m + p, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSin[c*x])^n, (f*x)^m*(d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[c^2*d + e, 0] && IGtQ[n, 0] && IntegerQ[p] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCos[c*x])^n, (f*x)^m*(d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[c^2*d + e, 0] && IGtQ[n, 0] && IntegerQ[p] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^2)^p*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^2)^p*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(h_.*x_)^m_.*(d_ + e_.*x_)^p_*(f_ + g_.*x_)^ q_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^q* Int[(h*x)^m*(d + e*x)^(p - q)*(1 - c^2*x^2)^q*(a + b*ArcSin[c*x])^ n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0] && GtQ[d, 0] && LtQ[g/e, 0]
Int[(h_.*x_)^m_.*(d_ + e_.*x_)^p_*(f_ + g_.*x_)^ q_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^q* Int[(h*x)^m*(d + e*x)^(p - q)*(1 - c^2*x^2)^q*(a + b*ArcCos[c*x])^ n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0] && GtQ[d, 0] && LtQ[g/e, 0]
Int[(h_.*x_)^m_.*(d_ + e_.*x_)^p_*(f_ + g_.*x_)^ q_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^IntPart[q]*(d + e*x)^ FracPart[q]*(f + g*x)^FracPart[q]/(1 - c^2*x^2)^FracPart[q]* Int[(h*x)^m*(d + e*x)^(p - q)*(1 - c^2*x^2)^ q*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0]
Int[(h_.*x_)^m_.*(d_ + e_.*x_)^p_*(f_ + g_.*x_)^ q_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^IntPart[q]*(d + e*x)^ FracPart[q]*(f + g*x)^FracPart[q]/(1 - c^2*x^2)^FracPart[q]* Int[(h*x)^m*(d + e*x)^(p - q)*(1 - c^2*x^2)^ q*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 - e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.1 Inverse sine/5.1.5 u (a+b arcsin(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 5.1.5 u (a+b arcsin(c x))^n *)
Int[(a_. + b_.*ArcSin[c_.*x_])^n_./(d_ + e_.*x_), x_Symbol] := Subst[Int[(a + b*x)^n*Cos[x]/(c*d + e*Sin[x]), x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCos[c_.*x_])^n_./(d_ + e_.*x_), x_Symbol] := -Subst[Int[(a + b*x)^n*Sin[x]/(c*d + e*Cos[x]), x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[n, 0]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcSin[c*x])^n/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[(d + e*x)^(m + 1)*(a + b*ArcSin[c*x])^(n - 1)/ Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCos[c*x])^n/(e*(m + 1)) + b*c*n/(e*(m + 1))* Int[(d + e*x)^(m + 1)*(a + b*ArcCos[c*x])^(n - 1)/ Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + b*ArcSin[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[m, 0] && LtQ[n, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + b*ArcCos[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[m, 0] && LtQ[n, -1]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := 1/c^(m + 1)* Subst[Int[(a + b*x)^n*Cos[x]*(c*d + e*Sin[x])^m, x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := -1/c^(m + 1)* Subst[Int[(a + b*x)^n*Sin[x]*(c*d + e*Cos[x])^m, x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[m, 0]
Int[Px_*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[ExpandExpression[Px, x], x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c}, x] && PolynomialQ[Px, x]
Int[Px_*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[ExpandExpression[Px, x], x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c}, x] && PolynomialQ[Px, x]
(* Int[Px_*(a_.+b_.*ArcSin[c_.*x_])^n_.,x_Symbol] := With[{u=IntHide[Px,x]}, Dist[(a+b*ArcSin[c*x])^n,u,x] -  b*c*n*Int[SimplifyIntegrand[u*(a+b*ArcSin[c*x])^(n-1)/Sqrt[1-c^2*x^2], x],x]] /; FreeQ[{a,b,c},x] && PolynomialQ[Px,x] && IGtQ[n,0] *)
(* Int[Px_*(a_.+b_.*ArcCos[c_.*x_])^n_.,x_Symbol] := With[{u=IntHide[Px,x]}, Dist[(a+b*ArcCos[c*x])^n,u,x] +  b*c*n*Int[SimplifyIntegrand[u*(a+b*ArcCos[c*x])^(n-1)/Sqrt[1-c^2*x^2], x],x]] /; FreeQ[{a,b,c},x] && PolynomialQ[Px,x] && IGtQ[n,0] *)
Int[Px_*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[Px*(a + b*ArcSin[c*x])^n, x], x] /; FreeQ[{a, b, c, n}, x] && PolynomialQ[Px, x]
Int[Px_*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[Px*(a + b*ArcCos[c*x])^n, x], x] /; FreeQ[{a, b, c, n}, x] && PolynomialQ[Px, x]
Int[Px_*(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[Px*(d + e*x)^m, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, m}, x] && PolynomialQ[Px, x]
Int[Px_*(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[Px*(d + e*x)^m, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, m}, x] && PolynomialQ[Px, x]
Int[(f_. + g_.*x_)^p_.*(d_ + e_.*x_)^m_*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := With[{u = IntHide[(f + g*x)^p*(d + e*x)^m, x]}, Dist[(a + b*ArcSin[c*x])^n, u, x] - b*c*n*Int[ SimplifyIntegrand[ u*(a + b*ArcSin[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[m, 0] && LtQ[m + p + 1, 0]
Int[(f_. + g_.*x_)^p_.*(d_ + e_.*x_)^m_*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := With[{u = IntHide[(f + g*x)^p*(d + e*x)^m, x]}, Dist[(a + b*ArcCos[c*x])^n, u, x] + b*c*n*Int[ SimplifyIntegrand[ u*(a + b*ArcCos[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[m, 0] && LtQ[m + p + 1, 0]
Int[(f_. + g_.*x_ + h_.*x_^2)^ p_.*(a_. + b_.*ArcSin[c_.*x_])^n_/(d_ + e_.*x_)^2, x_Symbol] := With[{u = IntHide[(f + g*x + h*x^2)^p/(d + e*x)^2, x]}, Dist[(a + b*ArcSin[c*x])^n, u, x] - b*c*n*Int[ SimplifyIntegrand[ u*(a + b*ArcSin[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[n, 0] && IGtQ[p, 0] && EqQ[e*g - 2*d*h, 0]
Int[(f_. + g_.*x_ + h_.*x_^2)^ p_.*(a_. + b_.*ArcCos[c_.*x_])^n_/(d_ + e_.*x_)^2, x_Symbol] := With[{u = IntHide[(f + g*x + h*x^2)^p/(d + e*x)^2, x]}, Dist[(a + b*ArcCos[c*x])^n, u, x] + b*c*n*Int[ SimplifyIntegrand[ u*(a + b*ArcCos[c*x])^(n - 1)/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[n, 0] && IGtQ[p, 0] && EqQ[e*g - 2*d*h, 0]
Int[Px_*(d_ + e_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[Px*(d + e*x)^m*(a + b*ArcSin[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && PolynomialQ[Px, x] && IGtQ[n, 0] && IntegerQ[m]
Int[Px_*(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[Px*(d + e*x)^m*(a + b*ArcCos[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && PolynomialQ[Px, x] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[(f + g*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[Dist[1/Sqrt[1 - c^2*x^2], u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[p + 1/2, 0] && GtQ[d, 0] && (LtQ[m, -2*p - 1] || GtQ[m, 3])
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[(f + g*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[Dist[1/Sqrt[1 - c^2*x^2], u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[p + 1/2, 0] && GtQ[d, 0] && (LtQ[m, -2*p - 1] || GtQ[m, 3])
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^p*(a + b*ArcSin[c*x])^n, (f + g*x)^ m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && IntegerQ[p + 1/2] && GtQ[d, 0] && IGtQ[n, 0] && (m == 1 || p > 0 || n == 1 && p > -1 || m == 2 && p < -2)
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^p*(a + b*ArcCos[c*x])^n, (f + g*x)^ m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && IntegerQ[p + 1/2] && GtQ[d, 0] && IGtQ[n, 0] && (m == 1 || p > 0 || n == 1 && p > -1 || m == 2 && p < -2)
Int[(f_ + g_.*x_)^m_* Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := (f + g*x)^ m*(d + e*x^2)*(a + b*ArcSin[c*x])^(n + 1)/(b*c*Sqrt[d]*(n + 1)) - 1/(b*c*Sqrt[d]*(n + 1))* Int[(d*g*m + 2*e*f*x + e*g*(m + 2)*x^2)*(f + g*x)^(m - 1)*(a + b*ArcSin[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && ILtQ[m, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_* Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := -(f + g*x)^m*(d + e*x^2)*(a + b*ArcCos[c*x])^(n + 1)/(b*c*Sqrt[d]*(n + 1)) + 1/(b*c*Sqrt[d]*(n + 1))* Int[(d*g*m + 2*e*f*x + e*g*(m + 2)*x^2)*(f + g*x)^(m - 1)*(a + b*ArcCos[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && ILtQ[m, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[ Sqrt[d + e*x^2]*(a + b*ArcSin[c*x])^n, (f + g*x)^ m*(d + e*x^2)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IGtQ[p + 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[ Sqrt[d + e*x^2]*(a + b*ArcCos[c*x])^n, (f + g*x)^ m*(d + e*x^2)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IGtQ[p + 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := (f + g*x)^ m*(d + e*x^2)^(p + 1/2)*(a + b*ArcSin[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) - 1/(b*c*Sqrt[d]*(n + 1))* Int[ ExpandIntegrand[(f + g*x)^(m - 1)*(a + b*ArcSin[c*x])^(n + 1), (d*g*m + e*f*(2*p + 1)*x + e*g*(m + 2*p + 1)*x^2)*(d + e*x^2)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && ILtQ[m, 0] && IGtQ[p - 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := -(f + g*x)^ m*(d + e*x^2)^(p + 1/2)*(a + b*ArcCos[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) + 1/(b*c*Sqrt[d]*(n + 1))* Int[ ExpandIntegrand[(f + g*x)^(m - 1)*(a + b*ArcCos[c*x])^(n + 1), (d*g*m + e*f*(2*p + 1)*x + e*g*(m + 2*p + 1)*x^2)*(d + e*x^2)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && ILtQ[m, 0] && IGtQ[p - 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_/ Sqrt[d_ + e_.*x_^2], x_Symbol] := (f + g*x)^m*(a + b*ArcSin[c*x])^(n + 1)/(b*c*Sqrt[d]*(n + 1)) - g*m/(b*c*Sqrt[d]*(n + 1))* Int[(f + g*x)^(m - 1)*(a + b*ArcSin[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && GtQ[d, 0] && LtQ[n, -1]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_/ Sqrt[d_ + e_.*x_^2], x_Symbol] := -(f + g*x)^m*(a + b*ArcCos[c*x])^(n + 1)/(b*c*Sqrt[d]*(n + 1)) + g*m/(b*c*Sqrt[d]*(n + 1))* Int[(f + g*x)^(m - 1)*(a + b*ArcCos[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && GtQ[d, 0] && LtQ[n, -1]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^n_./ Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(c^(m + 1)*Sqrt[d])* Subst[Int[(a + b*x)^n*(c*f + g*Sin[x])^m, x], x, ArcSin[c*x]] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && GtQ[d, 0] && (GtQ[m, 0] || IGtQ[n, 0])
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^n_./ Sqrt[d_ + e_.*x_^2], x_Symbol] := -1/(c^(m + 1)*Sqrt[d])* Subst[Int[(a + b*x)^n*(c*f + g*Cos[x])^m, x], x, ArcCos[c*x]] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && GtQ[d, 0] && (GtQ[m, 0] || IGtQ[n, 0])
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSin[c*x])^n/ Sqrt[d + e*x^2], (f + g*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && ILtQ[p + 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCos[c*x])^n/ Sqrt[d + e*x^2], (f + g*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && ILtQ[p + 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f + g*x)^m*(1 - c^2*x^2)^p*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p - 1/2] && Not[GtQ[d, 0]]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[(f + g*x)^m*(1 - c^2*x^2)^p*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p - 1/2] && Not[GtQ[d, 0]]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(a_. + b_.*ArcSin[c_.*x_])^n_./ Sqrt[d_ + e_.*x_^2], x_Symbol] := Log[h*(f + g*x)^m]*(a + b*ArcSin[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) - g*m/(b*c*Sqrt[d]*(n + 1))* Int[(a + b*ArcSin[c*x])^(n + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(a_. + b_.*ArcCos[c_.*x_])^n_./ Sqrt[d_ + e_.*x_^2], x_Symbol] := -Log[h*(f + g*x)^m]*(a + b*ArcCos[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) + g*m/(b*c*Sqrt[d]*(n + 1))* Int[(a + b*ArcCos[c*x])^(n + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(d_ + e_.*x_^2)^ p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[Log[h*(f + g*x)^m]*(1 - c^2*x^2)^p*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2] && Not[GtQ[d, 0]]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(d_ + e_.*x_^2)^ p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Simp[(d + e*x^2)^p/(1 - c^2*x^2)^p]* Int[Log[h*(f + g*x)^m]*(1 - c^2*x^2)^p*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2] && Not[GtQ[d, 0]]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^m_*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x)^m*(f + g*x)^m, x]}, Dist[a + b*ArcSin[c*x], u, x] - b*c*Int[Dist[1/Sqrt[1 - c^2*x^2], u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m + 1/2, 0]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^m_*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x)^m*(f + g*x)^m, x]}, Dist[a + b*ArcCos[c*x], u, x] + b*c*Int[Dist[1/Sqrt[1 - c^2*x^2], u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m + 1/2, 0]
Int[(d_ + e_.*x_)^m_.*(f_ + g_.*x_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^m*(a + b*ArcSin[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && IntegerQ[m]
Int[(d_ + e_.*x_)^m_.*(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(f + g*x)^m*(a + b*ArcCos[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && IntegerQ[m]
Int[u_*(a_. + b_.*ArcSin[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[a + b*ArcSin[c*x], v, x] - b*c*Int[SimplifyIntegrand[v/Sqrt[1 - c^2*x^2], x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[u_*(a_. + b_.*ArcCos[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[a + b*ArcCos[c*x], v, x] + b*c*Int[SimplifyIntegrand[v/Sqrt[1 - c^2*x^2], x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[Px_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := With[{u = ExpandIntegrand[Px*(d + e*x^2)^p*(a + b*ArcSin[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, n}, x] && PolynomialQ[Px, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[Px_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := With[{u = ExpandIntegrand[Px*(d + e*x^2)^p*(a + b*ArcCos[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, n}, x] && PolynomialQ[Px, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[Px_.*(f_ + g_.*(d_ + e_.*x_^2)^p_)^m_.*(a_. + b_.*ArcSin[c_.*x_])^ n_., x_Symbol] := With[{u = ExpandIntegrand[Px*(f + g*(d + e*x^2)^p)^m*(a + b*ArcSin[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, g}, x] && PolynomialQ[Px, x] && EqQ[c^2*d + e, 0] && IGtQ[p + 1/2, 0] && IntegersQ[m, n]
Int[Px_.*(f_ + g_.*(d_ + e_.*x_^2)^p_)^m_.*(a_. + b_.*ArcCos[c_.*x_])^ n_., x_Symbol] := With[{u = ExpandIntegrand[Px*(f + g*(d + e*x^2)^p)^m*(a + b*ArcCos[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, g}, x] && PolynomialQ[Px, x] && EqQ[c^2*d + e, 0] && IGtQ[p + 1/2, 0] && IntegersQ[m, n]
Int[RFx_*ArcSin[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[ArcSin[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[c, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*ArcCos[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[ArcCos[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[c, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(a_ + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[RFx*(a + b*ArcSin[c*x])^n, x], x] /; FreeQ[{a, b, c}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(a_ + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[RFx*(a + b*ArcCos[c*x])^n, x], x] /; FreeQ[{a, b, c}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(d_ + e_.*x_^2)^p_*ArcSin[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[(d + e*x^2)^p*ArcSin[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{c, d, e}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[RFx_*(d_ + e_.*x_^2)^p_*ArcCos[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[(d + e*x^2)^p*ArcCos[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{c, d, e}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[RFx_*(d_ + e_.*x_^2)^p_*(a_ + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^p, RFx*(a + b*ArcSin[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[RFx_*(d_ + e_.*x_^2)^p_*(a_ + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^p, RFx*(a + b*ArcCos[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[u_.*(a_. + b_.*ArcSin[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcSin[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]
Int[u_.*(a_. + b_.*ArcCos[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcCos[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.1 Inverse sine/5.1.6 Miscellaneous inverse sine.m
*)

(* ::Subsection::Closed:: *)
(* 5.1.6 Miscellaneous inverse sine *)
Int[(a_. + b_.*ArcSin[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcSin[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, n}, x]
Int[(a_. + b_.*ArcCos[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCos[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, n}, x]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSin[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcSin[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCos[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCos[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(A_. + B_.*x_ + C_.*x_^2)^p_.*(a_. + b_.*ArcSin[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[(-C/d^2 + C/d^2*x^2)^p*(a + b*ArcSin[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, n, p}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)^p_.*(a_. + b_.*ArcCos[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[(-C/d^2 + C/d^2*x^2)^p*(a + b*ArcCos[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, n, p}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ p_.*(a_. + b_.*ArcSin[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ p*(a + b*ArcSin[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ p_.*(a_. + b_.*ArcCos[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ p*(a + b*ArcCos[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[Sqrt[a_. + b_.*ArcSin[c_ + d_.*x_^2]], x_Symbol] := x*Sqrt[a + b*ArcSin[c + d*x^2]] - Sqrt[Pi]*x*(Cos[a/(2*b)] + c*Sin[a/(2*b)])* FresnelC[Sqrt[c/(Pi*b)]*Sqrt[a + b*ArcSin[c + d*x^2]]]/ (Sqrt[ c/b]*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) + Sqrt[Pi]*x*(Cos[a/(2*b)] - c*Sin[a/(2*b)])* FresnelS[Sqrt[c/(Pi*b)]*Sqrt[a + b*ArcSin[c + d*x^2]]]/ (Sqrt[ c/b]*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1]
Int[Sqrt[a_. + b_.*ArcCos[1 + d_.*x_^2]], x_Symbol] := -2*Sqrt[a + b*ArcCos[1 + d*x^2]]*Sin[ArcCos[1 + d*x^2]/2]^2/(d*x) - 2*Sqrt[Pi]*Sin[a/(2*b)]*Sin[ArcCos[1 + d*x^2]/2]* FresnelC[ Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[1 + d*x^2]]]/(Sqrt[1/b]*d* x) + 2*Sqrt[Pi]*Cos[a/(2*b)]*Sin[ArcCos[1 + d*x^2]/2]* FresnelS[ Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[1 + d*x^2]]]/(Sqrt[1/b]*d*x) /; FreeQ[{a, b, d}, x]
Int[Sqrt[a_. + b_.*ArcCos[-1 + d_.*x_^2]], x_Symbol] := 2*Sqrt[a + b*ArcCos[-1 + d*x^2]]* Cos[(1/2)*ArcCos[-1 + d*x^2]]^2/(d*x) - 2*Sqrt[Pi]*Cos[a/(2*b)]*Cos[ArcCos[-1 + d*x^2]/2]* FresnelC[ Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[-1 + d*x^2]]]/(Sqrt[1/b]*d*x) - 2*Sqrt[Pi]*Sin[a/(2*b)]*Cos[ArcCos[-1 + d*x^2]/2]* FresnelS[ Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[-1 + d*x^2]]]/(Sqrt[1/b]*d*x) /; FreeQ[{a, b, d}, x]
Int[(a_. + b_.*ArcSin[c_ + d_.*x_^2])^n_, x_Symbol] := x*(a + b*ArcSin[c + d*x^2])^n + 2*b*n* Sqrt[-2*c*d*x^2 - d^2*x^4]*(a + b*ArcSin[c + d*x^2])^(n - 1)/(d*x) - 4*b^2*n*(n - 1)*Int[(a + b*ArcSin[c + d*x^2])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1] && GtQ[n, 1]
Int[(a_. + b_.*ArcCos[c_ + d_.*x_^2])^n_, x_Symbol] := x*(a + b*ArcCos[c + d*x^2])^n - 2*b*n* Sqrt[-2*c*d*x^2 - d^2*x^4]*(a + b*ArcCos[c + d*x^2])^(n - 1)/(d*x) - 4*b^2*n*(n - 1)*Int[(a + b*ArcCos[c + d*x^2])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1] && GtQ[n, 1]
Int[1/(a_. + b_.*ArcSin[c_ + d_.*x_^2]), x_Symbol] := -x*(c*Cos[a/(2*b)] - Sin[a/(2*b)])* CosIntegral[(c/(2*b))*(a + b*ArcSin[c + d*x^2])]/ (2* b*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) - x*(c*Cos[a/(2*b)] + Sin[a/(2*b)])* SinIntegral[(c/(2*b))*(a + b*ArcSin[c + d*x^2])]/ (2* b*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1]
Int[1/(a_. + b_.*ArcCos[1 + d_.*x_^2]), x_Symbol] := x*Cos[a/(2*b)]* CosIntegral[(a + b*ArcCos[1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[-d*x^2]) + x*Sin[a/(2*b)]* SinIntegral[(a + b*ArcCos[1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[-d*x^2]) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCos[-1 + d_.*x_^2]), x_Symbol] := x*Sin[a/(2*b)]* CosIntegral[(a + b*ArcCos[-1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[d*x^2]) - x*Cos[a/(2*b)]* SinIntegral[(a + b*ArcCos[-1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[d*x^2]) /; FreeQ[{a, b, d}, x]
Int[1/Sqrt[a_. + b_.*ArcSin[c_ + d_.*x_^2]], x_Symbol] := -Sqrt[Pi]*x*(Cos[a/(2*b)] - c*Sin[a/(2*b)])* FresnelC[1/(Sqrt[b*c]*Sqrt[Pi])*Sqrt[a + b*ArcSin[c + d*x^2]]]/ (Sqrt[ b*c]*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) - Sqrt[Pi]*x*(Cos[a/(2*b)] + c*Sin[a/(2*b)])* FresnelS[(1/(Sqrt[b*c]*Sqrt[Pi]))*Sqrt[a + b*ArcSin[c + d*x^2]]]/ (Sqrt[ b*c]*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1]
Int[1/Sqrt[a_. + b_.*ArcCos[1 + d_.*x_^2]], x_Symbol] := -2*Sqrt[Pi/b]*Cos[a/(2*b)]*Sin[ArcCos[1 + d*x^2]/2]* FresnelC[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[1 + d*x^2]]]/(d*x) - 2*Sqrt[Pi/b]*Sin[a/(2*b)]*Sin[ArcCos[1 + d*x^2]/2]* FresnelS[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[1 + d*x^2]]]/(d*x) /; FreeQ[{a, b, d}, x]
Int[1/Sqrt[a_. + b_.*ArcCos[-1 + d_.*x_^2]], x_Symbol] := 2*Sqrt[Pi/b]*Sin[a/(2*b)]*Cos[ArcCos[-1 + d*x^2]/2]* FresnelC[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[-1 + d*x^2]]]/(d*x) - 2*Sqrt[Pi/b]*Cos[a/(2*b)]*Cos[ArcCos[-1 + d*x^2]/2]* FresnelS[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[-1 + d*x^2]]]/(d*x) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcSin[c_ + d_.*x_^2])^(3/2), x_Symbol] := -Sqrt[-2*c*d*x^2 - d^2*x^4]/(b*d*x*Sqrt[a + b*ArcSin[c + d*x^2]]) - (c/b)^(3/2)*Sqrt[Pi]*x*(Cos[a/(2*b)] + c*Sin[a/(2*b)])* FresnelC[Sqrt[c/(Pi*b)]*Sqrt[a + b*ArcSin[c + d*x^2]]]/ (Cos[(1/2)*ArcSin[c + d*x^2]] - c*Sin[ArcSin[c + d*x^2]/2]) + (c/b)^(3/2)*Sqrt[Pi]*x*(Cos[a/(2*b)] - c*Sin[a/(2*b)])* FresnelS[Sqrt[c/(Pi*b)]*Sqrt[a + b*ArcSin[c + d*x^2]]]/ (Cos[(1/2)*ArcSin[c + d*x^2]] - c*Sin[ArcSin[c + d*x^2]/2]) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1]
Int[1/(a_. + b_.*ArcCos[1 + d_.*x_^2])^(3/2), x_Symbol] := Sqrt[-2*d*x^2 - d^2*x^4]/(b*d*x*Sqrt[a + b*ArcCos[1 + d*x^2]]) - 2*(1/b)^(3/2)*Sqrt[Pi]*Sin[a/(2*b)]*Sin[ArcCos[1 + d*x^2]/2]* FresnelC[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[1 + d*x^2]]]/(d*x) + 2*(1/b)^(3/2)*Sqrt[Pi]*Cos[a/(2*b)]*Sin[ArcCos[1 + d*x^2]/2]* FresnelS[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[1 + d*x^2]]]/(d*x) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCos[-1 + d_.*x_^2])^(3/2), x_Symbol] := Sqrt[2*d*x^2 - d^2*x^4]/(b*d*x*Sqrt[a + b*ArcCos[-1 + d*x^2]]) - 2*(1/b)^(3/2)*Sqrt[Pi]*Cos[a/(2*b)]*Cos[ArcCos[-1 + d*x^2]/2]* FresnelC[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[-1 + d*x^2]]]/(d*x) - 2*(1/b)^(3/2)*Sqrt[Pi]*Sin[a/(2*b)]*Cos[ArcCos[-1 + d*x^2]/2]* FresnelS[Sqrt[1/(Pi*b)]*Sqrt[a + b*ArcCos[-1 + d*x^2]]]/(d*x) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcSin[c_ + d_.*x_^2])^2, x_Symbol] := -Sqrt[-2*c*d*x^2 - d^2*x^4]/(2*b*d*x*(a + b*ArcSin[c + d*x^2])) - x*(Cos[a/(2*b)] + c*Sin[a/(2*b)])* CosIntegral[(c/(2*b))*(a + b*ArcSin[c + d*x^2])]/ (4* b^2*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) + x*(Cos[a/(2*b)] - c*Sin[a/(2*b)])* SinIntegral[(c/(2*b))*(a + b*ArcSin[c + d*x^2])]/ (4* b^2*(Cos[ArcSin[c + d*x^2]/2] - c*Sin[ArcSin[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1]
Int[1/(a_. + b_.*ArcCos[1 + d_.*x_^2])^2, x_Symbol] := Sqrt[-2*d*x^2 - d^2*x^4]/(2*b*d*x*(a + b*ArcCos[1 + d*x^2])) + x*Sin[a/(2*b)]* CosIntegral[(a + b*ArcCos[1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[(-d)*x^2]) - x*Cos[a/(2*b)]* SinIntegral[(a + b*ArcCos[1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[(-d)*x^2]) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCos[-1 + d_.*x_^2])^2, x_Symbol] := Sqrt[2*d*x^2 - d^2*x^4]/(2*b*d*x*(a + b*ArcCos[-1 + d*x^2])) - x*Cos[a/(2*b)]* CosIntegral[(a + b*ArcCos[-1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[d*x^2]) - x*Sin[a/(2*b)]* SinIntegral[(a + b*ArcCos[-1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[d*x^2]) /; FreeQ[{a, b, d}, x]
Int[(a_. + b_.*ArcSin[c_ + d_.*x_^2])^n_, x_Symbol] := x*(a + b*ArcSin[c + d*x^2])^(n + 2)/(4*b^2*(n + 1)*(n + 2)) + Sqrt[-2*c*d*x^2 - d^2*x^4]*(a + b*ArcSin[c + d*x^2])^(n + 1)/(2*b*d*(n + 1)*x) - 1/(4*b^2*(n + 1)*(n + 2))* Int[(a + b*ArcSin[c + d*x^2])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1] && LtQ[n, -1] && NeQ[n, -2]
Int[(a_. + b_.*ArcCos[c_ + d_.*x_^2])^n_, x_Symbol] := x*(a + b*ArcCos[c + d*x^2])^(n + 2)/(4*b^2*(n + 1)*(n + 2)) - Sqrt[-2*c*d*x^2 - d^2*x^4]*(a + b*ArcCos[c + d*x^2])^(n + 1)/(2*b*d*(n + 1)*x) - 1/(4*b^2*(n + 1)*(n + 2))* Int[(a + b*ArcCos[c + d*x^2])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1] && LtQ[n, -1] && NeQ[n, -2]
Int[ArcSin[a_.*x_^p_]^n_./x_, x_Symbol] := 1/p*Subst[Int[x^n*Cot[x], x], x, ArcSin[a*x^p]] /; FreeQ[{a, p}, x] && IGtQ[n, 0]
Int[ArcCos[a_.*x_^p_]^n_./x_, x_Symbol] := -1/p*Subst[Int[x^n*Tan[x], x], x, ArcCos[a*x^p]] /; FreeQ[{a, p}, x] && IGtQ[n, 0]
Int[u_.*ArcSin[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCsc[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*ArcCos[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcSec[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[ArcSin[Sqrt[1 + b_.*x_^2]]^n_./Sqrt[1 + b_.*x_^2], x_Symbol] := Sqrt[-b*x^2]/(b*x)* Subst[Int[ArcSin[x]^n/Sqrt[1 - x^2], x], x, Sqrt[1 + b*x^2]] /; FreeQ[{b, n}, x]
Int[ArcCos[Sqrt[1 + b_.*x_^2]]^n_./Sqrt[1 + b_.*x_^2], x_Symbol] := Sqrt[-b*x^2]/(b*x)* Subst[Int[ArcCos[x]^n/Sqrt[1 - x^2], x], x, Sqrt[1 + b*x^2]] /; FreeQ[{b, n}, x]
Int[u_.*f_^(c_.*ArcSin[a_. + b_.*x_]^n_.), x_Symbol] := 1/b*Subst[ Int[ReplaceAll[u, x -> -a/b + Sin[x]/b]*f^(c*x^n)*Cos[x], x], x, ArcSin[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[n, 0]
Int[u_.*f_^(c_.*ArcCos[a_. + b_.*x_]^n_.), x_Symbol] := -1/b*Subst[ Int[ReplaceAll[u, x -> -a/b + Cos[x]/b]*f^(c*x^n)*Sin[x], x], x, ArcCos[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[n, 0]
Int[ArcSin[a_.*x_^2 + b_.*Sqrt[c_ + d_.*x_^2]], x_Symbol] := x*ArcSin[a*x^2 + b*Sqrt[c + d*x^2]] - x*Sqrt[b^2*d + a^2*x^2 + 2*a*b*Sqrt[c + d*x^2]]/ Sqrt[(-x^2)*(b^2*d + a^2*x^2 + 2*a*b*Sqrt[c + d*x^2])]* Int[ x*(b*d + 2*a*Sqrt[c + d*x^2])/(Sqrt[c + d*x^2]* Sqrt[b^2*d + a^2*x^2 + 2*a*b*Sqrt[c + d*x^2]]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2*c, 1]
Int[ArcCos[a_.*x_^2 + b_.*Sqrt[c_ + d_.*x_^2]], x_Symbol] := x*ArcCos[a*x^2 + b*Sqrt[c + d*x^2]] + x*Sqrt[b^2*d + a^2*x^2 + 2*a*b*Sqrt[c + d*x^2]]/ Sqrt[(-x^2)*(b^2*d + a^2*x^2 + 2*a*b*Sqrt[c + d*x^2])]* Int[ x*(b*d + 2*a*Sqrt[c + d*x^2])/(Sqrt[c + d*x^2]* Sqrt[b^2*d + a^2*x^2 + 2*a*b*Sqrt[c + d*x^2]]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2*c, 1]
Int[ArcSin[u_], x_Symbol] := x*ArcSin[u] - Int[SimplifyIntegrand[x*D[u, x]/Sqrt[1 - u^2], x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[ArcCos[u_], x_Symbol] := x*ArcCos[u] + Int[SimplifyIntegrand[x*D[u, x]/Sqrt[1 - u^2], x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcSin[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcSin[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/Sqrt[1 - u^2], x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCos[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCos[u])/(d*(m + 1)) + b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/Sqrt[1 - u^2], x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[v_*(a_. + b_.*ArcSin[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcSin[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/Sqrt[1 - u^2], x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]
Int[v_*(a_. + b_.*ArcCos[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCos[u]), w, x] + b*Int[SimplifyIntegrand[w*D[u, x]/Sqrt[1 - u^2], x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.1 (a+b arctan(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.1 (a+b arctan(c x^n))^p *)
Int[(a_. + b_.*ArcTan[c_.*x_^n_.])^p_., x_Symbol] := x*(a + b*ArcTan[c*x^n])^p - b*c*n*p* Int[x^n*(a + b*ArcTan[c*x^n])^(p - 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0] && (EqQ[n, 1] || EqQ[p, 1])
Int[(a_. + b_.*ArcCot[c_.*x_^n_.])^p_., x_Symbol] := x*(a + b*ArcCot[c*x^n])^p + b*c*n*p* Int[x^n*(a + b*ArcCot[c*x^n])^(p - 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0] && (EqQ[n, 1] || EqQ[p, 1])
Int[(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + (I*b*Log[1 - I*c*x^n])/ 2 - (I*b*Log[1 + I*c*x^n])/2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + (I*b*Log[1 - I*x^(-n)/c])/ 2 - (I*b*Log[1 + I*x^(-n)/c])/2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := Int[(a + b*ArcCot[x^(-n)/c])^p, x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := Int[(a + b*ArcTan[x^(-n)/c])^p, x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcTan[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && FractionQ[n]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcCot[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && FractionQ[n]
Int[(a_. + b_.*ArcTan[c_.*x_^n_.])^p_, x_Symbol] := Unintegrable[(a + b*ArcTan[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x]
Int[(a_. + b_.*ArcCot[c_.*x_^n_.])^p_, x_Symbol] := Unintegrable[(a + b*ArcCot[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.2 (d x)^m (a+b arctan(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.2 (d x)^m (a+b arctan(c x^n))^p *)
Int[(a_. + b_.*ArcTan[c_.*x_])/x_, x_Symbol] := a*Log[x] + I*b/2*Int[Log[1 - I*c*x]/x, x] - I*b/2*Int[Log[1 + I*c*x]/x, x] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcCot[c_.*x_])/x_, x_Symbol] := a*Log[x] + I*b/2*Int[Log[1 - I/(c*x)]/x, x] - I*b/2*Int[Log[1 + I/(c*x)]/x, x] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_/x_, x_Symbol] := 2*(a + b*ArcTan[c*x])^p*ArcTanh[1 - 2/(1 + I*c*x)] - 2*b*c*p* Int[(a + b*ArcTan[c*x])^(p - 1)* ArcTanh[1 - 2/(1 + I*c*x)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_/x_, x_Symbol] := 2*(a + b*ArcCot[c*x])^p*ArcCoth[1 - 2/(1 + I*c*x)] + 2*b*c*p* Int[(a + b*ArcCot[c*x])^(p - 1)* ArcCoth[1 - 2/(1 + I*c*x)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])^p_./x_, x_Symbol] := 1/n*Subst[Int[(a + b*ArcTan[c*x])^p/x, x], x, x^n] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])^p_./x_, x_Symbol] := 1/n*Subst[Int[(a + b*ArcCot[c*x])^p/x, x], x, x^n] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_^n_.])^p_., x_Symbol] := x^(m + 1)*(a + b*ArcTan[c*x^n])^p/(m + 1) - b*c*n*p/(m + 1)* Int[x^(m + n)*(a + b*ArcTan[c*x^n])^(p - 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || EqQ[n, 1] && IntegerQ[m]) && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_^n_.])^p_., x_Symbol] := x^(m + 1)*(a + b*ArcCot[c*x^n])^p/(m + 1) + b*c*n*p/(m + 1)* Int[x^(m + n)*(a + b*ArcCot[c*x^n])^(p - 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || EqQ[n, 1] && IntegerQ[m]) && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*ArcTan[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 1] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*ArcCot[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 1] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[ x^m*(a + (I*b*Log[1 - I*c*x^n])/2 - (I*b*Log[1 + I*c*x^n])/2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[ x^m*(a + (I*b*Log[1 - I*x^(-n)/c])/2 - (I*b*Log[1 + I*x^(-n)/c])/ 2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[m]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcTan[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && FractionQ[m]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[m]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcCot[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && FractionQ[m]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := Int[x^m*(a + b*ArcCot[x^(-n)/c])^p, x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := Int[x^m*(a + b*ArcTan[x^(-n)/c])^p, x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcTan[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && FractionQ[n]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcCot[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && FractionQ[n]
Int[(d_*x_)^m_*(a_. + b_.*ArcTan[c_.*x_^n_.]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcTan[c*x^n])/(d*(m + 1)) - b*c*n/(d^n*(m + 1))*Int[(d*x)^(m + n)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[n] && NeQ[m, -1]
Int[(d_*x_)^m_*(a_. + b_.*ArcCot[c_.*x_^n_.]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCot[c*x^n])/(d*(m + 1)) + b*c*n/(d^n*(m + 1))*Int[(d*x)^(m + n)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[n] && NeQ[m, -1]
Int[(d_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_^n_])^p_., x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || RationalQ[m, n])
Int[(d_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_^n_])^p_., x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*ArcCot[c*x])^p, x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || RationalQ[m, n])
Int[(d_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcTan[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcCot[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.3 (d+e x)^m (a+b arctan(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.3 (d+e x)^m (a+b arctan(c x^n))^p *)
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])^p*Log[2/(1 + e*x/d)]/e + b*c*p/e* Int[(a + b*ArcTan[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])^p*Log[2/(1 + e*x/d)]/e - b*c*p/e* Int[(a + b*ArcCot[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])*Log[2/(1 - I*c*x)]/e + b*c/e*Int[Log[2/(1 - I*c*x)]/(1 + c^2*x^2), x] + (a + b*ArcTan[c*x])* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e - b*c/e* Int[Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])*Log[2/(1 - I*c*x)]/e - b*c/e*Int[Log[2/(1 - I*c*x)]/(1 + c^2*x^2), x] + (a + b*ArcCot[c*x])* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + b*c/e* Int[Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])^2*Log[2/(1 - I*c*x)]/e + I*b*(a + b*ArcTan[c*x])*PolyLog[2, 1 - 2/(1 - I*c*x)]/e - b^2*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) + (a + b*ArcTan[c*x])^2* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e - I*b*(a + b*ArcTan[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + b^2* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])^2*Log[2/(1 - I*c*x)]/e - I*b*(a + b*ArcCot[c*x])*PolyLog[2, 1 - 2/(1 - I*c*x)]/e - b^2*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) + (a + b*ArcCot[c*x])^2* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + I*b*(a + b*ArcCot[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + b^2* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTan[c*x])^3*Log[2/(1 - I*c*x)]/e + 3*I*b*(a + b*ArcTan[c*x])^2*PolyLog[2, 1 - 2/(1 - I*c*x)]/(2*e) - 3*b^2*(a + b*ArcTan[c*x])*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) - 3*I*b^3*PolyLog[4, 1 - 2/(1 - I*c*x)]/(4*e) + (a + b*ArcTan[c*x])^3* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e - 3*I*b*(a + b*ArcTan[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) + 3*b^2*(a + b*ArcTan[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) + 3*I*b^3* PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCot[c*x])^3*Log[2/(1 - I*c*x)]/e - 3*I*b*(a + b*ArcCot[c*x])^2*PolyLog[2, 1 - 2/(1 - I*c*x)]/(2*e) - 3*b^2*(a + b*ArcCot[c*x])*PolyLog[3, 1 - 2/(1 - I*c*x)]/(2*e) + 3*I*b^3*PolyLog[4, 1 - 2/(1 - I*c*x)]/(4*e) + (a + b*ArcCot[c*x])^3* Log[2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/e + 3*I*b*(a + b*ArcCot[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) + 3*b^2*(a + b*ArcCot[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(2*e) - 3*I*b^3* PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + I*e)*(1 - I*c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 + e^2, 0]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTan[c*x])/(e*(q + 1)) - b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCot[c*x])/(e*(q + 1)) + b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTan[c*x])^p/(e*(q + 1)) - b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcTan[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 + c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCot[c*x])^p/(e*(q + 1)) + b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcCot[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 + c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*ArcTan[c*x^n])/e - b*c*n/e*Int[x^(n - 1)*Log[d + e*x]/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[n]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*ArcCot[c*x^n])/e + b*c*n/e*Int[x^(n - 1)*Log[d + e*x]/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[n]
Int[(a_. + b_.*ArcTan[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcTan[c*x^(k*n)])/(d + e*x^k), x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[n]
Int[(a_. + b_.*ArcCot[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcCot[c*x^(k*n)])/(d + e*x^k), x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[n]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcTan[c*x^n])/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[x^(n - 1)*(d + e*x)^(m + 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCot[c*x^n])/(e*(m + 1)) + b*c*n/(e*(m + 1))* Int[x^(n - 1)*(d + e*x)^(m + 1)/(1 + c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTan[c*x^n])^p, (d + e*x)^m, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 1] && IGtQ[m, 0]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCot[c*x^n])^p, (d + e*x)^m, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 1] && IGtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[(d + e*x)^m*(a + b*ArcTan[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[(d + e*x)^m*(a + b*ArcCot[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.4 u (a+b arctan(c x))^p.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.4 u (a+b arctan(c x))^p *)
Int[(f_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := f/e*Int[(f*x)^(m - 1)*(a + b*ArcTan[c*x])^p, x] - d*f/e*Int[(f*x)^(m - 1)*(a + b*ArcTan[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := f/e*Int[(f*x)^(m - 1)*(a + b*ArcCot[c*x])^p, x] - d*f/e*Int[(f*x)^(m - 1)*(a + b*ArcCot[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0] && GtQ[m, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := (a + b*ArcTan[c*x])^p*Log[2 - 2/(1 + e*x/d)]/d - b*c*p/d* Int[(a + b*ArcTan[c*x])^(p - 1)* Log[2 - 2/(1 + e*x/d)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := (a + b*ArcCot[c*x])^p*Log[2 - 2/(1 + e*x/d)]/d + b*c*p/d* Int[(a + b*ArcCot[c*x])^(p - 1)* Log[2 - 2/(1 + e*x/d)]/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcTan[c*x])^p, x] - e/(d*f)*Int[(f*x)^(m + 1)*(a + b*ArcTan[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcCot[c*x])^p, x] - e/(d*f)*Int[(f*x)^(m + 1)*(a + b*ArcCot[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 + e^2, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcTan[c*x]), u] - b*c*Int[SimplifyIntegrand[u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[q, -1] && IntegerQ[ 2*m] && (IGtQ[m, 0] && IGtQ[q, 0] || ILtQ[m + q + 1, 0] && LtQ[m*q, 0])
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcCot[c*x]), u] + b*c*Int[SimplifyIntegrand[u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[q, -1] && IntegerQ[ 2*m] && (IGtQ[m, 0] && IGtQ[q, 0] || ILtQ[m + q + 1, 0] && LtQ[m*q, 0])
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcTan[c*x])^p, u] - b*c*p*Int[ ExpandIntegrand[(a + b*ArcTan[c*x])^(p - 1), u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && IGtQ[p, 1] && EqQ[c^2*d^2 + e^2, 0] && IntegersQ[m, q] && NeQ[m, -1] && NeQ[q, -1] && ILtQ[m + q + 1, 0] && LtQ[m*q, 0]
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcCot[c*x])^p, u] + b*c*p*Int[ ExpandIntegrand[(a + b*ArcCot[c*x])^(p - 1), u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && IGtQ[p, 1] && EqQ[c^2*d^2 + e^2, 0] && IntegersQ[m, q] && NeQ[m, -1] && NeQ[q, -1] && ILtQ[m + q + 1, 0] && LtQ[m*q, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTan[c*x])^p, (f*x)^m*(d + e*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || NeQ[a, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCot[c*x])^p, (f*x)^m*(d + e*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || NeQ[a, 0] || IntegerQ[m])
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^q/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcTan[c*x])/(2*q + 1) + 2*d*q/(2*q + 1)*Int[(d + e*x^2)^(q - 1)*(a + b*ArcTan[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := b*(d + e*x^2)^q/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcCot[c*x])/(2*q + 1) + 2*d*q/(2*q + 1)*Int[(d + e*x^2)^(q - 1)*(a + b*ArcCot[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := -b*p*(d + e*x^2)^ q*(a + b*ArcTan[c*x])^(p - 1)/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcTan[c*x])^p/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTan[c*x])^p, x] + b^2*d*p*(p - 1)/(2*q*(2*q + 1))* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTan[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[q, 0] && GtQ[p, 1]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := b*p*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p - 1)/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcCot[c*x])^p/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCot[c*x])^p, x] + b^2*d*p*(p - 1)/(2*q*(2*q + 1))* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCot[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[q, 0] && GtQ[p, 1]
(* Int[(a_.+b_.*ArcTan[c_.*x_])^p_./(d_+e_.*x_^2),x_Symbol] := 1/(c*d)*Subst[Int[(a+b*x)^p,x],x,ArcTan[c*x]] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[e,c^2*d] *)
(* Int[(a_.+b_.*ArcCot[c_.*x_])^p_./(d_+e_.*x_^2),x_Symbol] := -1/(c*d)*Subst[Int[(a+b*x)^p,x],x,ArcCot[c*x]] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[e,c^2*d] *)
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcTan[c_.*x_])), x_Symbol] := Log[RemoveContent[a + b*ArcTan[c*x], x]]/(b*c*d) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d]
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcCot[c_.*x_])), x_Symbol] := -Log[RemoveContent[a + b*ArcCot[c*x], x]]/(b*c*d) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTan[c*x])^(p + 1)/(b*c*d*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && NeQ[p, -1]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcCot[c*x])^(p + 1)/(b*c*d*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && NeQ[p, -1]
Int[(a_. + b_.*ArcTan[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := -2*I*(a + b*ArcTan[c*x])* ArcTan[Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]]/(c*Sqrt[d]) + I*b* PolyLog[2, -I*Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]]/(c*Sqrt[d]) - I*b*PolyLog[2, I*Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]]/(c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[d, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := -2*I*(a + b*ArcCot[c*x])* ArcTan[Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]]/(c*Sqrt[d]) - I*b* PolyLog[2, -I*Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]]/(c*Sqrt[d]) + I*b*PolyLog[2, I*Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]]/(c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[d, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(c*Sqrt[d])*Subst[Int[(a + b*x)^p*Sec[x], x], x, ArcTan[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -x*Sqrt[1 + 1/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p*Csc[x], x], x, ArcCot[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcTan[c*x])^p/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcCot[c*x])^p/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcTan[c*x])^p/(2*d*(d + e*x^2)) + (a + b*ArcTan[c*x])^(p + 1)/(2*b*c*d^2*(p + 1)) - b*c*p/2*Int[x*(a + b*ArcTan[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcCot[c*x])^p/(2*d*(d + e*x^2)) - (a + b*ArcCot[c*x])^(p + 1)/(2*b*c*d^2*(p + 1)) + b*c*p/2*Int[x*(a + b*ArcCot[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := b/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcTan[c*x])/(d*Sqrt[d + e*x^2]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d]
Int[(a_. + b_.*ArcCot[c_.*x_])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcCot[c*x])/(d*Sqrt[d + e*x^2]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := b*(d + e*x^2)^(q + 1)/(4*c*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && NeQ[q, -3/2]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_/(d_ + e_.*x_^2)^(3/2), x_Symbol] := b*p*(a + b*ArcTan[c*x])^(p - 1)/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcTan[c*x])^p/(d*Sqrt[d + e*x^2]) - b^2*p*(p - 1)* Int[(a + b*ArcTan[c*x])^(p - 2)/(d + e*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 1]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b*p*(a + b*ArcCot[c*x])^(p - 1)/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcCot[c*x])^p/(d*Sqrt[d + e*x^2]) - b^2*p*(p - 1)* Int[(a + b*ArcCot[c*x])^(p - 2)/(d + e*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := b*p*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^(p - 1)/(4*c* d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^p/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^p, x] - b^2*p*(p - 1)/(4*(q + 1)^2)* Int[(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && GtQ[p, 1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := -b*p*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^(p - 1)/(4*c* d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^p/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^p, x] - b^2*p*(p - 1)/(4*(q + 1)^2)* Int[(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && GtQ[p, 1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^(p + 1)/(b*c*d*(p + 1)) - 2*c*(q + 1)/(b*(p + 1))* Int[x*(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := -(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^(p + 1)/(b*c* d*(p + 1)) + 2*c*(q + 1)/(b*(p + 1))* Int[x*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := d^q/c* Subst[Int[(a + b*x)^p/Cos[x]^(2*(q + 1)), x], x, ArcTan[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && ILtQ[2*(q + 1), 0] && (IntegerQ[q] || GtQ[d, 0])
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := d^(q + 1/2)*Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]* Int[(1 + c^2*x^2)^q*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && ILtQ[2*(q + 1), 0] && Not[IntegerQ[q] || GtQ[d, 0]]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := -d^q/c* Subst[Int[(a + b*x)^p/Sin[x]^(2*(q + 1)), x], x, ArcCot[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && ILtQ[2*(q + 1), 0] && IntegerQ[q]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := -d^(q + 1/2)*x*Sqrt[(1 + c^2*x^2)/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p/Sin[x]^(2*(q + 1)), x], x, ArcCot[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && ILtQ[2*(q + 1), 0] && Not[IntegerQ[q]]
Int[ArcTan[c_.*x_]/(d_. + e_.*x_^2), x_Symbol] := I/2*Int[Log[1 - I*c*x]/(d + e*x^2), x] - I/2*Int[Log[1 + I*c*x]/(d + e*x^2), x] /; FreeQ[{c, d, e}, x]
Int[ArcCot[c_.*x_]/(d_. + e_.*x_^2), x_Symbol] := I/2*Int[Log[1 - I/(c*x)]/(d + e*x^2), x] - I/2*Int[Log[1 + I/(c*x)]/(d + e*x^2), x] /; FreeQ[{c, d, e}, x]
Int[(a_ + b_.*ArcTan[c_.*x_])/(d_. + e_.*x_^2), x_Symbol] := a*Int[1/(d + e*x^2), x] + b*Int[ArcTan[c*x]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(a_ + b_.*ArcCot[c_.*x_])/(d_. + e_.*x_^2), x_Symbol] := a*Int[1/(d + e*x^2), x] + b*Int[ArcCot[c*x]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^q, x]}, Dist[a + b*ArcTan[c*x], u, x] - b*c*Int[u/(1 + c^2*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && (IntegerQ[q] || ILtQ[q + 1/2, 0])
Int[(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^q, x]}, Dist[a + b*ArcCot[c*x], u, x] + b*c*Int[u/(1 + c^2*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && (IntegerQ[q] || ILtQ[q + 1/2, 0])
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTan[c*x])^p, (d + e*x^2)^q, x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[q] && IGtQ[p, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCot[c*x])^p, (d + e*x^2)^q, x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[q] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcTan[c*x])^p, x] - d*f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcTan[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcCot[c*x])^p, x] - d*f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcCot[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcTan[c*x])^p, x] - e/(d*f^2)* Int[(f*x)^(m + 2)*(a + b*ArcTan[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcCot[c*x])^p, x] - e/(d*f^2)* Int[(f*x)^(m + 2)*(a + b*ArcCot[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1]
Int[x_*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := -I*(a + b*ArcTan[c*x])^(p + 1)/(b*e*(p + 1)) - 1/(c*d)*Int[(a + b*ArcTan[c*x])^p/(I - c*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := I*(a + b*ArcCot[c*x])^(p + 1)/(b*e*(p + 1)) - 1/(c*d)*Int[(a + b*ArcCot[c*x])^p/(I - c*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcTan[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := x*(a + b*ArcTan[c*x])^(p + 1)/(b*c*d*(p + 1)) - 1/(b*c*d*(p + 1))*Int[(a + b*ArcTan[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && Not[IGtQ[p, 0]] && NeQ[p, -1]
Int[x_*(a_. + b_.*ArcCot[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := -x*(a + b*ArcCot[c*x])^(p + 1)/(b*c*d*(p + 1)) + 1/(b*c*d*(p + 1))*Int[(a + b*ArcCot[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && Not[IGtQ[p, 0]] && NeQ[p, -1]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(x_*(d_ + e_.*x_^2)), x_Symbol] := -I*(a + b*ArcTan[c*x])^(p + 1)/(b*d*(p + 1)) + I/d*Int[(a + b*ArcTan[c*x])^p/(x*(I + c*x)), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(x_*(d_ + e_.*x_^2)), x_Symbol] := I*(a + b*ArcCot[c*x])^(p + 1)/(b*d*(p + 1)) + I/d*Int[(a + b*ArcCot[c*x])^p/(x*(I + c*x)), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := (f*x)^m*(a + b*ArcTan[c*x])^(p + 1)/(b*c*d*(p + 1)) - f*m/(b*c*d*(p + 1))* Int[(f*x)^(m - 1)*(a + b*ArcTan[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && LtQ[p, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := -(f*x)^m*(a + b*ArcCot[c*x])^(p + 1)/(b*c*d*(p + 1)) + f*m/(b*c*d*(p + 1))* Int[(f*x)^(m - 1)*(a + b*ArcCot[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && LtQ[p, -1]
Int[x_^m_.*(a_. + b_.*ArcTan[c_.*x_])/(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTan[c*x]), x^m/(d + e*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m] && Not[EqQ[m, 1] && NeQ[a, 0]]
Int[x_^m_.*(a_. + b_.*ArcCot[c_.*x_])/(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCot[c*x]), x^m/(d + e*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m] && Not[EqQ[m, 1] && NeQ[a, 0]]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^p/(2*e*(q + 1)) - b*p/(2*c*(q + 1))* Int[(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, q}, x] && EqQ[e, c^2*d] && GtQ[p, 0] && NeQ[q, -1]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^p/(2*e*(q + 1)) + b*p/(2*c*(q + 1))* Int[(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, q}, x] && EqQ[e, c^2*d] && GtQ[p, 0] && NeQ[q, -1]
Int[x_*(a_. + b_.*ArcTan[c_.*x_])^p_/(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcTan[c*x])^(p + 1)/(b*c*d*(p + 1)*(d + e*x^2)) - (1 - c^2*x^2)*(a + b*ArcTan[c*x])^(p + 2)/(b^2* e*(p + 1)*(p + 2)*(d + e*x^2)) - 4/(b^2*(p + 1)*(p + 2))* Int[x*(a + b*ArcTan[c*x])^(p + 2)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[p, -1] && NeQ[p, -2]
Int[x_*(a_. + b_.*ArcCot[c_.*x_])^p_/(d_ + e_.*x_^2)^2, x_Symbol] := -x*(a + b*ArcCot[c*x])^(p + 1)/(b*c*d*(p + 1)*(d + e*x^2)) - (1 - c^2*x^2)*(a + b*ArcCot[c*x])^(p + 2)/(b^2* e*(p + 1)*(p + 2)*(d + e*x^2)) - 4/(b^2*(p + 1)*(p + 2))* Int[x*(a + b*ArcCot[c*x])^(p + 2)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^2*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c^3*d*(q + 1)^2) + x*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])/(2*c^2*d*(q + 1)) - 1/(2*c^2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && NeQ[q, -5/2]
Int[x_^2*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := b*(d + e*x^2)^(q + 1)/(4*c^3*d*(q + 1)^2) + x*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])/(2*c^2*d*(q + 1)) - 1/(2*c^2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && LtQ[q, -1] && NeQ[q, -5/2]
Int[x_^2*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := (a + b*ArcTan[c*x])^(p + 1)/(2*b*c^3*d^2*(p + 1)) - x*(a + b*ArcTan[c*x])^p/(2*c^2*d*(d + e*x^2)) + b*p/(2*c)*Int[x*(a + b*ArcTan[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[x_^2*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := -(a + b*ArcCot[c*x])^(p + 1)/(2*b*c^3*d^2*(p + 1)) - x*(a + b*ArcCot[c*x])^p/(2*c^2*d*(d + e*x^2)) - b*p/(2*c)*Int[x*(a + b*ArcCot[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := b*(f*x)^m*(d + e*x^2)^(q + 1)/(c*d*m^2) - f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])/(c^2*d* m) + f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := -b*(f*x)^m*(d + e*x^2)^(q + 1)/(c*d*m^2) - f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])/(c^2*d* m) + f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := b*p*(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^(p - 1)/(c*d*m^2) - f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^ p/(c^2*d*m) - b^2*p*(p - 1)/m^2* Int[(f*x)^m*(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p - 2), x] + f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1] && GtQ[p, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := -b*p*(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^(p - 1)/(c*d*m^2) - f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^ p/(c^2*d*m) - b^2*p*(p - 1)/m^2* Int[(f*x)^m*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p - 2), x] + f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1] && GtQ[p, 1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_, x_Symbol] := (f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^(p + 1)/(b*c* d*(p + 1)) - f*m/(b*c*(p + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 2, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_, x_Symbol] := -(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^(p + 1)/(b*c* d*(p + 1)) + f*m/(b*c*(p + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 2, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^ p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 3, 0] && GtQ[p, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^ p/(d*f*(m + 1)) + b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[e, c^2*d] && EqQ[m + 2*q + 3, 0] && GtQ[p, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcTan[c*x])/(f*(m + 2)) - b*c*d/(f*(m + 2))*Int[(f*x)^(m + 1)/Sqrt[d + e*x^2], x] + d/(m + 2)*Int[(f*x)^m*(a + b*ArcTan[c*x])/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && NeQ[m, -2]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcCot[c*x])/(f*(m + 2)) + b*c*d/(f*(m + 2))*Int[(f*x)^(m + 1)/Sqrt[d + e*x^2], x] + d/(m + 2)*Int[(f*x)^m*(a + b*ArcCot[c*x])/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && NeQ[m, -2]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*ArcTan[c*x])^p, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && IGtQ[q, 1] && (EqQ[p, 1] || IntegerQ[m])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*ArcCot[c*x])^p, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && IGtQ[q, 1] && (EqQ[p, 1] || IntegerQ[m])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := d*Int[(f*x)^m*(d + e*x^2)^(q - 1)*(a + b*ArcTan[c*x])^p, x] + c^2*d/f^2* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && GtQ[q, 0] && IGtQ[p, 0] && (RationalQ[m] || EqQ[p, 1] && IntegerQ[q])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := d*Int[(f*x)^m*(d + e*x^2)^(q - 1)*(a + b*ArcCot[c*x])^p, x] + c^2*d/f^2* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)*(a + b*ArcCot[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && GtQ[q, 0] && IGtQ[p, 0] && (RationalQ[m] || EqQ[p, 1] && IntegerQ[q])
Int[(f_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcTan[c*x])^p/(c^2*d*m) - b*f*p/(c*m)* Int[(f*x)^(m - 1)*(a + b*ArcTan[c*x])^(p - 1)/Sqrt[d + e*x^2], x] - f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcTan[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcCot[c*x])^p/(c^2*d*m) + b*f*p/(c*m)* Int[(f*x)^(m - 1)*(a + b*ArcCot[c*x])^(p - 1)/Sqrt[d + e*x^2], x] - f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcCot[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[p, 0] && GtQ[m, 1]
Int[(a_. + b_.*ArcTan[c_.*x_])/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -2/Sqrt[d]*(a + b*ArcTan[c*x])* ArcTanh[Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]] + I*b/Sqrt[d]*PolyLog[2, -Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]] - I*b/Sqrt[d]*PolyLog[2, Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[d, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -2/Sqrt[d]*(a + b*ArcCot[c*x])* ArcTanh[Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]] - I*b/Sqrt[d]*PolyLog[2, -Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]] + I*b/Sqrt[d]*PolyLog[2, Sqrt[1 + I*c*x]/Sqrt[1 - I*c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[d, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := 1/Sqrt[d]*Subst[Int[(a + b*x)^p*Csc[x], x], x, ArcTan[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -c*x*Sqrt[1 + 1/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p*Sec[x], x], x, ArcCot[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcTan[c*x])^p/(x*Sqrt[1 + c^2*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcCot[c*x])^p/(x*Sqrt[1 + c^2*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_./(x_^2*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -Sqrt[d + e*x^2]*(a + b*ArcTan[c*x])^p/(d*x) + b*c*p*Int[(a + b*ArcTan[c*x])^(p - 1)/(x*Sqrt[d + e*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_./(x_^2*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -Sqrt[d + e*x^2]*(a + b*ArcCot[c*x])^p/(d*x) - b*c*p*Int[(a + b*ArcCot[c*x])^(p - 1)/(x*Sqrt[d + e*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTan[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcTan[c*x])^p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(a + b*ArcTan[c*x])^(p - 1)/Sqrt[d + e*x^2], x] - c^2*(m + 2)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*ArcTan[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCot[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcCot[c*x])^p/(d*f*(m + 1)) + b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(a + b*ArcCot[c*x])^(p - 1)/Sqrt[d + e*x^2], x] - c^2*(m + 2)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*ArcCot[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := 1/e*Int[x^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^p, x] - d/e*Int[x^(m - 2)*(d + e*x^2)^q*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IntegersQ[p, 2*q] && LtQ[q, -1] && IGtQ[m, 1] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := 1/e*Int[x^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^p, x] - d/e*Int[x^(m - 2)*(d + e*x^2)^q*(a + b*ArcCot[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IntegersQ[p, 2*q] && LtQ[q, -1] && IGtQ[m, 1] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := 1/d*Int[x^m*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^p, x] - e/d*Int[x^(m + 2)*(d + e*x^2)^q*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IntegersQ[p, 2*q] && LtQ[q, -1] && ILtQ[m, 0] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := 1/d*Int[x^m*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^p, x] - e/d*Int[x^(m + 2)*(d + e*x^2)^q*(a + b*ArcCot[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IntegersQ[p, 2*q] && LtQ[q, -1] && ILtQ[m, 0] && NeQ[p, -1]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := x^m*(d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])^(p + 1)/(b*c* d*(p + 1)) - m/(b*c*(p + 1))* Int[x^(m - 1)*(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p + 1), x] - c*(m + 2*q + 2)/(b*(p + 1))* Int[x^(m + 1)*(d + e*x^2)^q*(a + b*ArcTan[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[e, c^2*d] && IntegerQ[m] && LtQ[q, -1] && LtQ[p, -1] && NeQ[m + 2*q + 2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := -x^m*(d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])^(p + 1)/(b*c* d*(p + 1)) + m/(b*c*(p + 1))* Int[x^(m - 1)*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p + 1), x] + c*(m + 2*q + 2)/(b*(p + 1))* Int[x^(m + 1)*(d + e*x^2)^q*(a + b*ArcCot[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[e, c^2*d] && IntegerQ[m] && LtQ[q, -1] && LtQ[p, -1] && NeQ[m + 2*q + 2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := d^q/c^(m + 1)* Subst[Int[(a + b*x)^p*Sin[x]^m/Cos[x]^(m + 2*(q + 1)), x], x, ArcTan[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && (IntegerQ[q] || GtQ[d, 0])
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := d^(q + 1/2)*Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]* Int[x^m*(1 + c^2*x^2)^q*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && Not[IntegerQ[q] || GtQ[d, 0]]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := -d^q/c^(m + 1)* Subst[Int[(a + b*x)^p*Cos[x]^m/Sin[x]^(m + 2*(q + 1)), x], x, ArcCot[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && IntegerQ[q]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := -d^(q + 1/2)*x*Sqrt[(1 + c^2*x^2)/(c^2*x^2)]/(c^m*Sqrt[d + e*x^2])* Subst[Int[(a + b*x)^p*Cos[x]^m/Sin[x]^(m + 2*(q + 1)), x], x, ArcCot[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && Not[IntegerQ[q]]
Int[x_*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTan[c*x])/(2*e*(q + 1)) - b*c/(2*e*(q + 1))*Int[(d + e*x^2)^(q + 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[x_*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCot[c*x])/(2*e*(q + 1)) + b*c/(2*e*(q + 1))*Int[(d + e*x^2)^(q + 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^q, x]}, Dist[a + b*ArcTan[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && ( IGtQ[q, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*q + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[q, 0] && GtQ[m + 2*q + 3, 0]] || ILtQ[(m + 2*q + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^q, x]}, Dist[a + b*ArcCot[c*x], u, x] + b*c*Int[SimplifyIntegrand[u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && ( IGtQ[q, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*q + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[q, 0] && GtQ[m + 2*q + 3, 0]] || ILtQ[(m + 2*q + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[x_*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcTan[c*x])^p/(1 - Rt[-e/d, 2]*x)^2, x] - 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcTan[c*x])^p/(1 + Rt[-e/d, 2]*x)^2, x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcCot[c*x])^p/(1 - Rt[-e/d, 2]*x)^2, x] - 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcCot[c*x])^p/(1 + Rt[-e/d, 2]*x)^2, x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*ArcTan[c*x])^p, (f*x)^m*(d + e*x^2)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[q] && IGtQ[p, 0] && (EqQ[p, 1] && GtQ[q, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*ArcCot[c*x])^p, (f*x)^m*(d + e*x^2)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[q] && IGtQ[p, 0] && (EqQ[p, 1] && GtQ[q, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*ArcTan[c_.*x_]), x_Symbol] := a*Int[(f*x)^m*(d + e*x^2)^q, x] + b*Int[(f*x)^m*(d + e*x^2)^q*ArcTan[c*x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*ArcCot[c_.*x_]), x_Symbol] := a*Int[(f*x)^m*(d + e*x^2)^q, x] + b*Int[(f*x)^m*(d + e*x^2)^q*ArcCot[c*x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTan[c*x])^p/(d + e*x^2), (f + g*x)^m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && IGtQ[m, 0]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCot[c*x])^p/(d + e*x^2), (f + g*x)^m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && IGtQ[m, 0]
Int[ArcTanh[u_]*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + u]*(a + b*ArcTan[c*x])^p/(d + e*x^2), x] - 1/2*Int[Log[1 - u]*(a + b*ArcTan[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I + c*x))^2, 0]
Int[ArcCoth[u_]*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[ Log[SimplifyIntegrand[1 + 1/u, x]]*(a + b*ArcCot[c*x])^ p/(d + e*x^2), x] - 1/2* Int[Log[SimplifyIntegrand[1 - 1/u, x]]*(a + b*ArcCot[c*x])^ p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I + c*x))^2, 0]
Int[ArcTanh[u_]*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + u]*(a + b*ArcTan[c*x])^p/(d + e*x^2), x] - 1/2*Int[Log[1 - u]*(a + b*ArcTan[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I - c*x))^2, 0]
Int[ArcCoth[u_]*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[ Log[SimplifyIntegrand[1 + 1/u, x]]*(a + b*ArcCot[c*x])^ p/(d + e*x^2), x] - 1/2* Int[Log[SimplifyIntegrand[1 - 1/u, x]]*(a + b*ArcCot[c*x])^ p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I - c*x))^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_.*Log[f_ + g_.*x_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTan[c*x])^(p + 1)*Log[f + g*x]/(b*c*d*(p + 1)) - g/(b*c*d*(p + 1))*Int[(a + b*ArcTan[c*x])^(p + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[c^2*f^2 + g^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_.*Log[f_ + g_.*x_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCot[c*x])^(p + 1)*Log[f + g*x]/(b*c*d*(p + 1)) - g/(b*c*d*(p + 1))*Int[(a + b*ArcCot[c*x])^(p + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[c^2*f^2 + g^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := I*(a + b*ArcTan[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) - b*p*I/2* Int[(a + b*ArcTan[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[(1 - u)^2 - (1 - 2*I/(I + c*x))^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := I*(a + b*ArcCot[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) + b*p*I/2* Int[(a + b*ArcCot[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[(1 - u)^2 - (1 - 2*I/(I + c*x))^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := -I*(a + b*ArcTan[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) + b*p*I/2* Int[(a + b*ArcTan[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[(1 - u)^2 - (1 - 2*I/(I - c*x))^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := -I*(a + b*ArcCot[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) - b*p*I/2* Int[(a + b*ArcCot[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[(1 - u)^2 - (1 - 2*I/(I - c*x))^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := -I*(a + b*ArcTan[c*x])^p*PolyLog[k + 1, u]/(2*c*d) + b*p*I/2* Int[(a + b*ArcTan[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I + c*x))^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := -I*(a + b*ArcCot[c*x])^p*PolyLog[k + 1, u]/(2*c*d) - b*p*I/2* Int[(a + b*ArcCot[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I + c*x))^2, 0]
Int[(a_. + b_.*ArcTan[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := I*(a + b*ArcTan[c*x])^p*PolyLog[k + 1, u]/(2*c*d) - b*p*I/2* Int[(a + b*ArcTan[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I - c*x))^2, 0]
Int[(a_. + b_.*ArcCot[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := I*(a + b*ArcCot[c*x])^p*PolyLog[k + 1, u]/(2*c*d) + b*p*I/2* Int[(a + b*ArcCot[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[e, c^2*d] && EqQ[u^2 - (1 - 2*I/(I - c*x))^2, 0]
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcCot[c_.*x_])*(a_. + b_.*ArcTan[c_.*x_])), x_Symbol] := (-Log[a + b*ArcCot[c*x]] + Log[a + b*ArcTan[c*x]])/(b*c* d*(2*a + b*ArcCot[c*x] + b*ArcTan[c*x])) /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d]
Int[(a_. + b_.*ArcCot[c_.*x_])^ q_.*(a_. + b_.*ArcTan[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcCot[c*x])^(q + 1)*(a + b*ArcTan[c*x])^p/(b*c*d*(q + 1)) + p/(q + 1)* Int[(a + b*ArcCot[c*x])^(q + 1)*(a + b*ArcTan[c*x])^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && IGeQ[q, p]
Int[(a_. + b_.*ArcTan[c_.*x_])^ q_.*(a_. + b_.*ArcCot[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTan[c*x])^(q + 1)*(a + b*ArcCot[c*x])^ p/(b*c*d*(q + 1)) + p/(q + 1)* Int[(a + b*ArcTan[c*x])^(q + 1)*(a + b*ArcCot[c*x])^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && IGeQ[q, p]
Int[ArcTan[a_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := I/2*Int[Log[1 - I*a*x]/(c + d*x^n), x] - I/2*Int[Log[1 + I*a*x]/(c + d*x^n), x] /; FreeQ[{a, c, d}, x] && IntegerQ[n] && Not[EqQ[n, 2] && EqQ[d, a^2*c]]
Int[ArcCot[a_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := I/2*Int[Log[1 - I/(a*x)]/(c + d*x^n), x] - I/2*Int[Log[1 + I/(a*x)]/(c + d*x^n), x] /; FreeQ[{a, c, d}, x] && IntegerQ[n] && Not[EqQ[n, 2] && EqQ[d, a^2*c]]
Int[Log[d_.*x_^m_.]*ArcTan[c_.*x_^n_.]/x_, x_Symbol] := I/2*Int[Log[d*x^m]*Log[1 - I*c*x^n]/x, x] - I/2*Int[Log[d*x^m]*Log[1 + I*c*x^n]/x, x] /; FreeQ[{c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*ArcCot[c_.*x_^n_.]/x_, x_Symbol] := I/2*Int[Log[d*x^m]*Log[1 - I/(c*x^n)]/x, x] - I/2*Int[Log[d*x^m]*Log[1 + I/(c*x^n)]/x, x] /; FreeQ[{c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*(a_ + b_.*ArcTan[c_.*x_^n_.])/x_, x_Symbol] := a*Int[Log[d*x^m]/x, x] + b*Int[(Log[d*x^m]*ArcTan[c*x^n])/x, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*(a_ + b_.*ArcCot[c_.*x_^n_.])/x_, x_Symbol] := a*Int[Log[d*x^m]/x, x] + b*Int[(Log[d*x^m]*ArcCot[c*x^n])/x, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := x*(d + e*Log[f + g*x^2])*(a + b*ArcTan[c*x]) - 2*e*g*Int[x^2*(a + b*ArcTan[c*x])/(f + g*x^2), x] - b*c*Int[x*(d + e*Log[f + g*x^2])/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := x*(d + e*Log[f + g*x^2])*(a + b*ArcCot[c*x]) - 2*e*g*Int[x^2*(a + b*ArcCot[c*x])/(f + g*x^2), x] + b*c*Int[x*(d + e*Log[f + g*x^2])/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[Log[f_. + g_.*x_^2]*ArcTan[c_.*x_]/x_, x_Symbol] := (Log[f + g*x^2] - Log[1 - I*c*x] - Log[1 + I*c*x])* Int[ArcTan[c*x]/x, x] + I/2*Int[Log[1 - I*c*x]^2/x, x] - I/2*Int[Log[1 + I*c*x]^2/x, x] /; FreeQ[{c, f, g}, x] && EqQ[g, c^2*f]
Int[Log[f_. + g_.*x_^2]*ArcCot[c_.*x_]/x_, x_Symbol] := (Log[f + g*x^2] - Log[c^2*x^2] - Log[1 - I/(c*x)] - Log[1 + I/(c*x)])*Int[ArcCot[c*x]/x, x] + Int[Log[c^2*x^2]*ArcCot[c*x]/x, x] + I/2*Int[Log[1 - I/(c*x)]^2/x, x] - I/2*Int[Log[1 + I/(c*x)]^2/x, x] /; FreeQ[{c, f, g}, x] && EqQ[g, c^2*f]
Int[Log[f_. + g_.*x_^2]*(a_ + b_.*ArcTan[c_.*x_])/x_, x_Symbol] := a*Int[Log[f + g*x^2]/x, x] + b*Int[Log[f + g*x^2]*ArcTan[c*x]/x, x] /; FreeQ[{a, b, c, f, g}, x]
Int[Log[f_. + g_.*x_^2]*(a_ + b_.*ArcCot[c_.*x_])/x_, x_Symbol] := a*Int[Log[f + g*x^2]/x, x] + b*Int[Log[f + g*x^2]*ArcCot[c*x]/x, x] /; FreeQ[{a, b, c, f, g}, x]
Int[(d_ + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTan[c_.*x_])/x_, x_Symbol] := d*Int[(a + b*ArcTan[c*x])/x, x] + e*Int[Log[f + g*x^2]*(a + b*ArcTan[c*x])/x, x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[(d_ + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCot[c_.*x_])/x_, x_Symbol] := d*Int[(a + b*ArcCot[c*x])/x, x] + e*Int[Log[f + g*x^2]*(a + b*ArcCot[c*x])/x, x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := x^(m + 1)*(d + e*Log[f + g*x^2])*(a + b*ArcTan[c*x])/(m + 1) - 2*e*g/(m + 1)*Int[x^(m + 2)*(a + b*ArcTan[c*x])/(f + g*x^2), x] - b*c/(m + 1)* Int[x^(m + 1)*(d + e*Log[f + g*x^2])/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := x^(m + 1)*(d + e*Log[f + g*x^2])*(a + b*ArcCot[c*x])/(m + 1) - 2*e*g/(m + 1)*Int[x^(m + 2)*(a + b*ArcCot[c*x])/(f + g*x^2), x] + b*c/(m + 1)* Int[x^(m + 1)*(d + e*Log[f + g*x^2])/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*Log[f + g*x^2]), x]}, Dist[a + b*ArcTan[c*x], u, x] - b*c*Int[ExpandIntegrand[u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[(m + 1)/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*Log[f + g*x^2]), x]}, Dist[a + b*ArcCot[c*x], u, x] + b*c*Int[ExpandIntegrand[u/(1 + c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[(m + 1)/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTan[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(a + b*ArcTan[c*x]), x]}, Dist[d + e*Log[f + g*x^2], u, x] - 2*e*g*Int[ExpandIntegrand[x*u/(f + g*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCot[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(a + b*ArcCot[c*x]), x]}, Dist[d + e*Log[f + g*x^2], u, x] - 2*e*g*Int[ExpandIntegrand[x*u/(f + g*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_*(d_. + e_.*Log[f_ + g_.*x_^2])*(a_. + b_.*ArcTan[c_.*x_])^2, x_Symbol] := (f + g*x^2)*(d + e*Log[f + g*x^2])*(a + b*ArcTan[c*x])^2/(2*g) - e*x^2*(a + b*ArcTan[c*x])^2/2 - b/c*Int[(d + e*Log[f + g*x^2])*(a + b*ArcTan[c*x]), x] + b*c*e*Int[x^2*(a + b*ArcTan[c*x])/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[g, c^2*f]
Int[x_*(d_. + e_.*Log[f_ + g_.*x_^2])*(a_. + b_.*ArcCot[c_.*x_])^2, x_Symbol] := (f + g*x^2)*(d + e*Log[f + g*x^2])*(a + b*ArcCot[c*x])^2/(2*g) - e*x^2*(a + b*ArcCot[c*x])^2/2 + b/c*Int[(d + e*Log[f + g*x^2])*(a + b*ArcCot[c*x]), x] - b*c*e*Int[x^2*(a + b*ArcCot[c*x])/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[g, c^2*f]
Int[u_.*(a_. + b_.*ArcTan[c_.*x_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcTan[c*x])^p, x] /; FreeQ[{a, b, c, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_. + e_.*x)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x)^q_. /; FreeQ[{d, e, f, m, q}, x]] || MatchQ[u, (d_. + e_.*x^2)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x^2)^q_. /; FreeQ[{d, e, f, m, q}, x]])
Int[u_.*(a_. + b_.*ArcCot[c_.*x_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcCot[c*x])^p, x] /; FreeQ[{a, b, c, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_. + e_.*x)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x)^q_. /; FreeQ[{d, e, f, m, q}, x]] || MatchQ[u, (d_. + e_.*x^2)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x^2)^q_. /; FreeQ[{d, e, f, m, q}, x]])

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.5 u (a+b arctan(c+d x))^p.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.5 u (a+b arctan(c+d x))^p *)
Int[(a_. + b_.*ArcTan[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcTan[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCot[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCot[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcTan[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcTan[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(a_. + b_.*ArcCot[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcCot[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTan[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcTan[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCot[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcCot[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_*(a_. + b_.*ArcTan[c_ + d_.*x_])^p_., x_Symbol] := (e + f*x)^(m + 1)*(a + b*ArcTan[c + d*x])^p/(f*(m + 1)) - b*d*p/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(a + b*ArcTan[c + d*x])^(p - 1)/(1 + (c + d*x)^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_*(a_. + b_.*ArcCot[c_ + d_.*x_])^p_., x_Symbol] := (e + f*x)^(m + 1)*(a + b*ArcCot[c + d*x])^p/(f*(m + 1)) + b*d*p/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(a + b*ArcCot[c + d*x])^(p - 1)/(1 + (c + d*x)^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTan[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcTan[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCot[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCot[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTan[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcTan[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCot[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcCot[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[ArcTan[a_ + b_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := I/2*Int[Log[1 - I*a - I*b*x]/(c + d*x^n), x] - I/2*Int[Log[1 + I*a + I*b*x]/(c + d*x^n), x] /; FreeQ[{a, b, c, d}, x] && RationalQ[n]
Int[ArcCot[a_ + b_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := I/2*Int[Log[(-I + a + b*x)/(a + b*x)]/(c + d*x^n), x] - I/2*Int[Log[(I + a + b*x)/(a + b*x)]/(c + d*x^n), x] /; FreeQ[{a, b, c, d}, x] && RationalQ[n]
Int[ArcTan[a_ + b_.*x_]/(c_ + d_.*x_^n_), x_Symbol] := Unintegrable[ArcTan[a + b*x]/(c + d*x^n), x] /; FreeQ[{a, b, c, d, n}, x] && Not[RationalQ[n]]
Int[ArcCot[a_ + b_.*x_]/(c_ + d_.*x_^n_), x_Symbol] := Unintegrable[ArcCot[a + b*x]/(c + d*x^n), x] /; FreeQ[{a, b, c, d, n}, x] && Not[RationalQ[n]]
Int[(A_. + B_.*x_ + C_.*x_^2)^q_.*(a_. + b_.*ArcTan[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(C/d^2 + C/d^2*x^2)^q*(a + b*ArcTan[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, p, q}, x] && EqQ[B*(1 + c^2) - 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)^q_.*(a_. + b_.*ArcCot[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(C/d^2 + C/d^2*x^2)^q*(a + b*ArcCot[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, p, q}, x] && EqQ[B*(1 + c^2) - 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ q_.*(a_. + b_.*ArcTan[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(C/d^2 + C/d^2*x^2)^ q*(a + b*ArcTan[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, p, q}, x] && EqQ[B*(1 + c^2) - 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ q_.*(a_. + b_.*ArcCot[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(C/d^2 + C/d^2*x^2)^ q*(a + b*ArcCot[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, p, q}, x] && EqQ[B*(1 + c^2) - 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.6 Exponentials of inverse tangent.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.6 Exponentials of inverse tangent *)
Int[E^(n_*ArcTan[a_.*x_]), x_Symbol] := Int[((1 - I*a*x)^((I*n + 1)/2)/((1 + I*a*x)^((I*n - 1)/2)* Sqrt[1 + a^2*x^2])), x] /; FreeQ[a, x] && IntegerQ[(I*n - 1)/2]
Int[x_^m_.*E^(n_*ArcTan[a_.*x_]), x_Symbol] := Int[x^ m*((1 - I*a*x)^((I*n + 1)/2)/((1 + I*a*x)^((I*n - 1)/2)* Sqrt[1 + a^2*x^2])), x] /; FreeQ[{a, m}, x] && IntegerQ[(I*n - 1)/2]
Int[E^(n_.*ArcTan[a_.*x_]), x_Symbol] := Int[(1 - I*a*x)^(I*n/2)/(1 + I*a*x)^(I*n/2), x] /; FreeQ[{a, n}, x] && Not[IntegerQ[(I*n - 1)/2]]
Int[x_^m_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := Int[x^m*(1 - I*a*x)^(I*n/2)/(1 + I*a*x)^(I*n/2), x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[(I*n - 1)/2]]
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[u*(1 + d*x/c)^p*(1 - I*a*x)^(I*n/2)/(1 + I*a*x)^(I*n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 + d^2, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := Int[u*(c + d*x)^p*(1 - I*a*x)^(I*n/2)/(1 + I*a*x)^(I*n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 + d^2, 0] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_.*(c_ + d_./x_)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := d^p*Int[u/x^p*(1 + c*x/d)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[c^2 + a^2*d^2, 0] && IntegerQ[p]
Int[u_.*(c_ + d_./x_)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (-1)^(n/2)*c^p* Int[u*(1 + d/(c*x))^ p*(1 - 1/(I*a*x))^(I*n/2)/(1 + 1/(I*a*x))^(I*n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[p]] && IntegerQ[I*n/2] && GtQ[c, 0]
Int[u_.*(c_ + d_./x_)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := Int[u*(c + d/x)^p*(1 - I*a*x)^(I*n/2)/(1 + I*a*x)^(I*n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[p]] && IntegerQ[I*n/2] && Not[GtQ[c, 0]]
Int[u_.*(c_ + d_./x_)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := x^p*(c + d/x)^p/(1 + c*x/d)^p* Int[u/x^p*(1 + c*x/d)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[p]]
Int[E^(n_.*ArcTan[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (n + a*x)*E^(n*ArcTan[a*x])/(a*c*(n^2 + 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && Not[IntegerQ[I*n]]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := (n - 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTan[a*x])/(a*c*(n^2 + 4*(p + 1)^2)) + 2*(p + 1)*(2*p + 3)/(c*(n^2 + 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && LtQ[p, -1] && Not[IntegerQ[I*n]] && NeQ[n^2 + 4*(p + 1)^2, 0] && IntegerQ[2*p]
Int[E^(n_.*ArcTan[a_.*x_])/(c_ + d_.*x_^2), x_Symbol] := E^(n*ArcTan[a*x])/(a*c*n) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c]
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[(1 + a^2*x^2)^(p - I*n/2)*(1 - I*a*x)^(I*n), x] /; FreeQ[{a, c, d, p}, x] && EqQ[d, a^2*c] && IntegerQ[p] && IntegerQ[(I*n + 1)/2] && Not[IntegerQ[p - I*n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[(1 - I*a*x)^(p + I*n/2)*(1 + I*a*x)^(p - I*n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[d, a^2*c] && (IntegerQ[p] || GtQ[c, 0])
Int[(c_ + d_.*x_^2)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := c^(I*n/2)*Int[(c + d*x^2)^(p - I*n/2)*(1 - I*a*x)^(I*n), x] /; FreeQ[{a, c, d, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]] && IGtQ[I*n/2, 0]
Int[(c_ + d_.*x_^2)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := 1/c^(I*n/2)*Int[(c + d*x^2)^(p + I*n/2)/(1 + I*a*x)^(I*n), x] /; FreeQ[{a, c, d, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]] && ILtQ[I*n/2, 0]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 + a^2*x^2)^FracPart[p]* Int[(1 + a^2*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[x_*E^(n_.*ArcTan[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := -(1 - a*n*x)*E^(n*ArcTan[a*x])/(d*(n^2 + 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && Not[IntegerQ[I*n]]
Int[x_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := (c + d*x^2)^(p + 1)*E^(n*ArcTan[a*x])/(2*d*(p + 1)) - a*c*n/(2*d*(p + 1))*Int[(c + d*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && LtQ[p, -1] && Not[IntegerQ[I*n]] && IntegerQ[2*p]
(* Int[x_*(c_+d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]),x_Symbol] := (2*(p+1)+a*n*x)*(c+d*x^2)^(p+1)*E^(n*ArcTan[a*x])/(a^2*c*(n^2+4*(p+ 1)^2)) - n*(2*p+3)/(a*c*(n^2+4*(p+1)^2))*Int[(c+d*x^2)^(p+1)*E^(n*ArcTan[a*x] ),x] /; FreeQ[{a,c,d,n},x] && EqQ[d,a^2*c] && LtQ[p,-1] &&  NeQ[n^2+4*(p+1)^2,0] && Not[IntegerQ[I*n]] *)
Int[x_^2*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := -(1 - a*n*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTan[a*x])/(a*d*n*(n^2 + 1)) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && EqQ[n^2 - 2*(p + 1), 0] && Not[IntegerQ[I*n]]
Int[x_^2*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := -(n - 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTan[a*x])/(a*d*(n^2 + 4*(p + 1)^2)) + (n^2 - 2*(p + 1))/(d*(n^2 + 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && LtQ[p, -1] && Not[IntegerQ[I*n]] && NeQ[n^2 + 4*(p + 1)^2, 0] && IntegerQ[2*p]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 + a^2*x^2)^(p - I*n/2)*(1 - I*a*x)^(I*n), x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[d, a^2*c] && (IntegerQ[p] || GtQ[c, 0]) && IntegerQ[(I*n + 1)/2] && Not[IntegerQ[p - I*n/2]]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - I*a*x)^(p + I*n/2)*(1 + I*a*x)^(p - I*n/2), x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[d, a^2*c] && (IntegerQ[p] || GtQ[c, 0])
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := c^(I*n/2)*Int[x^m*(c + d*x^2)^(p - I*n/2)*(1 - I*a*x)^(I*n), x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]] && IGtQ[I*n/2, 0]
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := 1/c^(I*n/2)*Int[x^m*(c + d*x^2)^(p + I*n/2)/(1 + I*a*x)^(I*n), x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]] && ILtQ[I*n/2, 0]
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 + a^2*x^2)^FracPart[p]* Int[x^m*(1 + a^2*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[u*(1 - I*a*x)^(p + I*n/2)*(1 + I*a*x)^(p - I*n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[d, a^2*c] && (IntegerQ[p] || GtQ[c, 0])
Int[u_*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTan[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^ FracPart[p]/((1 - I*a*x)^FracPart[p]*(1 + I*a*x)^FracPart[p])* Int[u*(1 - I*a*x)^(p + I*n/2)*(1 + I*a*x)^(p - I*n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[d, a^2*c] && (IntegerQ[p] || GtQ[c, 0]) && IntegerQ[I*n/2]
Int[u_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 + a^2*x^2)^FracPart[p]* Int[u*(1 + a^2*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[p] || GtQ[c, 0]] && Not[IntegerQ[I*n/2]]
Int[u_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := d^p*Int[u/x^(2*p)*(1 + a^2*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[c - a^2*d, 0] && IntegerQ[p]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := c^p*Int[u*(1 - I/(a*x))^p*(1 + I/(a*x))^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c - a^2*d, 0] && Not[IntegerQ[p]] && IntegerQ[I*n/2] && GtQ[c, 0]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_*ArcTan[a_.*x_]), x_Symbol] := x^(2*p)*(c + d/x^2)^p/((1 - I*a*x)^p*(1 + I*a*x)^p)* Int[u/x^(2*p)*(1 - I*a*x)^p*(1 + I*a*x)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c - a^2*d, 0] && Not[IntegerQ[p]] && IntegerQ[I*n/2] && Not[GtQ[c, 0]]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_.*ArcTan[a_.*x_]), x_Symbol] := x^(2*p)*(c + d/x^2)^p/(1 + a^2*x^2)^p* Int[u/x^(2*p)*(1 + a^2*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c - a^2*d, 0] && Not[IntegerQ[p]] && Not[IntegerQ[I*n/2]]
Int[E^(n_.*ArcTan[c_.*(a_ + b_.*x_)]), x_Symbol] := Int[(1 - I*a*c - I*b*c*x)^(I*n/2)/(1 + I*a*c + I*b*c*x)^(I*n/2), x] /; FreeQ[{a, b, c, n}, x]
Int[x_^m_*E^(n_*ArcTan[c_.*(a_ + b_.*x_)]), x_Symbol] := 4/(I^m*n*b^(m + 1)*c^(m + 1))* Subst[ Int[x^(2/(I*n))*(1 - I*a*c - (1 + I*a*c)*x^(2/(I*n)))^ m/(1 + x^(2/(I*n)))^(m + 2), x], x, (1 - I*c*(a + b*x))^(I*n/2)/(1 + I*c*(a + b*x))^(I*n/2)] /; FreeQ[{a, b, c}, x] && ILtQ[m, 0] && LtQ[-1, I*n, 1]
Int[(d_. + e_.*x_)^m_.*E^(n_.*ArcTan[c_.*(a_ + b_.*x_)]), x_Symbol] := Int[(d + e*x)^ m*(1 - I*a*c - I*b*c*x)^(I*n/2)/(1 + I*a*c + I*b*c*x)^(I*n/2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcTan[a_ + b_.*x_]), x_Symbol] := (c/(1 + a^2))^p* Int[u*(1 - I*a - I*b*x)^(p + I*n/2)*(1 + I*a + I*b*x)^(p - I*n/2), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d, 2*a*e] && EqQ[b^2*c - e (1 + a^2), 0] && (IntegerQ[p] || GtQ[c/(1 + a^2), 0])
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcTan[a_ + b_.*x_]), x_Symbol] := (c + d*x + e*x^2)^p/(1 + a^2 + 2*a*b*x + b^2*x^2)^p* Int[u*(1 + a^2 + 2*a*b*x + b^2*x^2)^p*E^(n*ArcTan[a*x]), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d, 2*a*e] && EqQ[b^2*c - e (1 + a^2), 0] && Not[IntegerQ[p] || GtQ[c/(1 + a^2), 0]]
Int[u_.*E^(n_.*ArcTan[c_./(a_. + b_.*x_)]), x_Symbol] := Int[u*E^(n*ArcCot[a/c + b*x/c]), x] /; FreeQ[{a, b, c, n}, x]
Int[u_.*E^(n_*ArcCot[a_.*x_]), x_Symbol] := (-1)^(I*n/2)*Int[u*E^(-n*ArcTan[a*x]), x] /; FreeQ[a, x] && IntegerQ[I*n/2]
Int[E^(n_*ArcCot[a_.*x_]), x_Symbol] := -Subst[ Int[(1 - I*x/a)^((I*n + 1)/2)/(x^2*(1 + I*x/a)^((I*n - 1)/2)* Sqrt[1 + x^2/a^2]), x], x, 1/x] /; FreeQ[a, x] && IntegerQ[(I*n - 1)/2]
Int[x_^m_.*E^(n_*ArcCot[a_.*x_]), x_Symbol] := -Subst[ Int[(1 - I*x/a)^((I*n + 1)/ 2)/(x^(m + 2)*(1 + I*x/a)^((I*n - 1)/2)*Sqrt[1 + x^2/a^2]), x], x, 1/x] /; FreeQ[a, x] && IntegerQ[(I*n - 1)/2] && IntegerQ[m]
Int[E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -Subst[Int[(1 - I*x/a)^(I*n/2)/(x^2*(1 + I*x/a)^(I*n/2)), x], x, 1/x] /; FreeQ[{a, n}, x] && Not[IntegerQ[I*n]]
Int[x_^m_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -Subst[Int[(1 - I*x/a)^(n/2)/(x^(m + 2)*(1 + I*x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, n}, x] && Not[IntegerQ[I*n]] && IntegerQ[m]
Int[x_^m_*E^(n_*ArcCot[a_.*x_]), x_Symbol] := -x^m*(1/x)^m* Subst[Int[(1 - I*x/a)^((I*n + 1)/ 2)/(x^(m + 2)*(1 + I*x/a)^((I*n - 1)/2)*Sqrt[1 + x^2/a^2]), x], x, 1/x] /; FreeQ[{a, m}, x] && IntegerQ[(I*n - 1)/2] && Not[IntegerQ[m]]
Int[x_^m_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -Subst[Int[(1 - I*x/a)^(n/2)/(x^(m + 2)*(1 + I*x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[I*n/2]] && Not[IntegerQ[m]]
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := d^p*Int[u*x^p*(1 + c/(d*x))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c^2 + d^2, 0] && Not[IntegerQ[I*n/2]] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (c + d*x)^p/(x^p*(1 + c/(d*x))^p)* Int[u*x^p*(1 + c/(d*x))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 + d^2, 0] && Not[IntegerQ[I*n/2]] && Not[IntegerQ[p]]
Int[(c_ + d_./x_)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 + d*x/c)^p*(1 - I*x/a)^(I*n/2)/(x^2*(1 + I*x/a)^(I*n/2)), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0])
Int[x_^m_.*(c_ + d_./x_)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 + d*x/c)^ p*(1 - I*x/a)^(I*n/2)/(x^(m + 2)*(1 + I*x/a)^(I*n/2)), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0]) && IntegerQ[m]
Int[(c_ + d_./x_)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (c + d/x)^p/(1 + d/(c*x))^p* Int[(1 + d/(c*x))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[I*n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[x_^m_*(c_ + d_./x_)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p*x^m*(1/x)^m* Subst[Int[(1 + d*x/c)^ p*(1 - I*x/a)^(I*n/2)/(x^(m + 2)*(1 + I*x/a)^(I*n/2)), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegerQ[m]]
Int[u_.*(c_ + d_./x_)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (c + d/x)^p/(1 + d/(c*x))^p* Int[u*(1 + d/(c*x))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 + a^2*d^2, 0] && Not[IntegerQ[I*n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[E^(n_.*ArcCot[a_.*x_])/(c_ + d_.*x_^2), x_Symbol] := -E^(n*ArcCot[a*x])/(a*c*n) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c]
Int[E^(n_.*ArcCot[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := -(n - a*x)*E^(n*ArcCot[a*x])/(a*c*(n^2 + 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && Not[IntegerQ[(I*n - 1)/2]]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -(n + 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCot[a*x])/(a*c*(n^2 + 4*(p + 1)^2)) + 2*(p + 1)*(2*p + 3)/(c*(n^2 + 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && LtQ[p, -1] && NeQ[p, -3/2] && NeQ[n^2 + 4*(p + 1)^2, 0] && Not[IntegerQ[p] && IntegerQ[I*n/2]] && Not[Not[IntegerQ[p]] && IntegerQ[(I*n - 1)/2]]
Int[x_*E^(n_.*ArcCot[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := -(1 + a*n*x)*E^(n*ArcCot[a*x])/(a^2*c*(n^2 + 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && Not[IntegerQ[(I*n - 1)/2]]
Int[x_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (2*(p + 1) - a*n*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCot[a*x])/(a^2*c*(n^2 + 4*(p + 1)^2)) + n*(2*p + 3)/(a*c*(n^2 + 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && LeQ[p, -1] && NeQ[p, -3/2] && NeQ[n^2 + 4*(p + 1)^2, 0] && Not[IntegerQ[p] && IntegerQ[I*n/2]] && Not[Not[IntegerQ[p]] && IntegerQ[(I*n - 1)/2]]
Int[x_^2*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCot[a*x])/(a^3*c*n^2*(n^2 + 1)) /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && EqQ[n^2 - 2*(p + 1), 0] && NeQ[n^2 + 1, 0]
Int[x_^2*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCot[a*x])/(a^3*c*(n^2 + 4*(p + 1)^2)) + (n^2 - 2*(p + 1))/(a^2*c*(n^2 + 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && LeQ[p, -1] && NeQ[n^2 - 2*(p + 1), 0] && NeQ[n^2 + 4*(p + 1)^2, 0] && Not[IntegerQ[p] && IntegerQ[I*n/2]] && Not[Not[IntegerQ[p]] && IntegerQ[(I*n - 1)/2]]
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p/a^(m + 1)* Subst[Int[E^(n*x)*Cot[x]^(m + 2*(p + 1))/Cos[x]^(2*(p + 1)), x], x, ArcCot[a*x]] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && IntegerQ[m] && LeQ[3, m, -2 (p + 1)] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := d^p*Int[u*x^(2*p)*(1 + 1/(a^2*x^2))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[d, a^2*c] && Not[IntegerQ[I*n/2]] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (c + d*x^2)^p/(x^(2*p)*(1 + 1/(a^2*x^2))^p)* Int[u*x^(2*p)*(1 + 1/(a^2*x^2))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[d, a^2*c] && Not[IntegerQ[I*n/2]] && Not[IntegerQ[p]]
Int[u_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := c^p/(I*a)^(2*p)* Int[u/x^(2*p)*(-1 + I*a*x)^(p - I*n/2)*(1 + I*a*x)^(p + I*n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c, a^2*d] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0]) && IntegersQ[2*p, p + I*n/2]
Int[(c_ + d_./x_^2)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 - I*x/a)^(p + I*n/2)*(1 + I*x/a)^(p - I*n/2)/x^2, x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c, a^2*d] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegerQ[2*p] && IntegerQ[p + I*n/2]]
Int[x_^m_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 - I*x/a)^(p + I*n/2)*(1 + I*x/a)^(p - I*n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c, a^2*d] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegerQ[2*p] && IntegerQ[p + I*n/2]] && IntegerQ[m]
Int[x_^m_*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := -c^p*x^m*(1/x)^m* Subst[Int[(1 - I*x/a)^(p + I*n/2)*(1 + I*x/a)^(p - I*n/2)/ x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c, a^2*d] && Not[IntegerQ[I*n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegerQ[2*p] && IntegerQ[p + I*n/2]] && Not[IntegerQ[m]]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_.*ArcCot[a_.*x_]), x_Symbol] := (c + d/x^2)^p/(1 + 1/(a^2*x^2))^p* Int[u*(1 + 1/(a^2*x^2))^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c, a^2*d] && Not[IntegerQ[I*n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_.*E^(n_*ArcCot[c_.*(a_ + b_.*x_)]), x_Symbol] := (-1)^(I*n/2)*Int[u*E^(-n*ArcTan[c*(a + b*x)]), x] /; FreeQ[{a, b, c}, x] && IntegerQ[I*n/2]
Int[E^(n_.*ArcCot[c_.*(a_ + b_.*x_)]), x_Symbol] := (I*c*(a + b*x))^(I* n/2)*(1 + 1/(I*c*(a + b*x)))^(I*n/2)/(1 + I*a*c + I*b*c*x)^(I* n/2)* Int[(1 + I*a*c + I*b*c*x)^(I*n/2)/(-1 + I*a*c + I*b*c*x)^(I* n/2), x] /; FreeQ[{a, b, c, n}, x] && Not[IntegerQ[I*n/2]]
Int[x_^m_*E^(n_*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := 4/(I^m*n*b^(m + 1)*c^(m + 1))* Subst[ Int[x^(2/(I*n))*(1 + I*a*c + (1 - I*a*c)*x^(2/(I*n)))^ m/(-1 + x^(2/(I*n)))^(m + 2), x], x, (1 + 1/(I*c*(a + b*x)))^(I*n/2)/(1 - 1/(I*c*(a + b*x)))^(I* n/2)] /; FreeQ[{a, b, c}, x] && ILtQ[m, 0] && LtQ[-1, I*n, 1]
Int[(d_. + e_.*x_)^m_.*E^(n_.*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (I*c*(a + b*x))^(I* n/2)*(1 + 1/(I*c*(a + b*x)))^(I*n/2)/(1 + I*a*c + I*b*c*x)^(I* n/2)* Int[(d + e*x)^ m*(1 + I*a*c + I*b*c*x)^(I*n/2)/(-1 + I*a*c + I*b*c*x)^(I*n/2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && Not[IntegerQ[I*n/2]]
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcCot[a_ + b_.*x_]), x_Symbol] := (c/(1 + a^2))^ p*((I*a + I*b*x)/(1 + I*a + I*b*x))^(I* n/2)*((1 + I*a + I*b*x)/(I*a + I*b*x))^(I*n/2)* ((1 - I*a - I*b*x)^(I*n/2)/(-1 + I*a + I*b*x)^(I*n/2))* Int[ u*(1 - I*a - I*b*x)^(p - I*n/2)*(1 + I*a + I*b*x)^(p + I*n/2), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && Not[IntegerQ[I*n/2]] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c - e (1 + a^2), 0] && (IntegerQ[p] || GtQ[c/(1 + a^2), 0])
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcCot[a_ + b_.*x_]), x_Symbol] := (c + d*x + e*x^2)^p/(1 + a^2 + 2*a*b*x + b^2*x^2)^p* Int[u*(1 + a^2 + 2*a*b*x + b^2*x^2)^p*E^(n*ArcCot[a*x]), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && Not[IntegerQ[I*n/2]] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c - e (1 + a^2), 0] && Not[IntegerQ[p] || GtQ[c/(1 + a^2), 0]]
Int[u_.*E^(n_.*ArcCot[c_./(a_. + b_.*x_)]), x_Symbol] := Int[u*E^(n*ArcTan[a/c + b*x/c]), x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.3 Inverse tangent/5.3.7 Miscellaneous inverse tangent.m
*)

(* ::Subsection::Closed:: *)
(* 5.3.7 Miscellaneous inverse tangent *)
Int[ArcTan[a_ + b_.*x_^n_], x_Symbol] := x*ArcTan[a + b*x^n] - b*n*Int[x^n/(1 + a^2 + 2*a*b*x^n + b^2*x^(2*n)), x] /; FreeQ[{a, b, n}, x]
Int[ArcCot[a_ + b_.*x_^n_], x_Symbol] := x*ArcCot[a + b*x^n] + b*n*Int[x^n/(1 + a^2 + 2*a*b*x^n + b^2*x^(2*n)), x] /; FreeQ[{a, b, n}, x]
Int[ArcTan[a_. + b_.*x_^n_]/x_, x_Symbol] := I/2*Int[Log[1 - I*a - I*b*x^n]/x, x] - I/2*Int[Log[1 + I*a + I*b*x^n]/x, x] /; FreeQ[{a, b, n}, x]
Int[ArcCot[a_. + b_.*x_^n_]/x_, x_Symbol] := I/2*Int[Log[1 - I/(a + b*x^n)]/x, x] - I/2*Int[Log[1 + I/(a + b*x^n)]/x, x] /; FreeQ[{a, b, n}, x]
Int[x_^m_.*ArcTan[a_ + b_.*x_^n_], x_Symbol] := x^(m + 1)*ArcTan[a + b*x^n]/(m + 1) - b*n/(m + 1)* Int[x^(m + n)/(1 + a^2 + 2*a*b*x^n + b^2*x^(2*n)), x] /; FreeQ[{a, b}, x] && RationalQ[m, n] && m + 1 != 0 && m + 1 != n
Int[x_^m_.*ArcCot[a_ + b_.*x_^n_], x_Symbol] := x^(m + 1)*ArcCot[a + b*x^n]/(m + 1) + b*n/(m + 1)* Int[x^(m + n)/(1 + a^2 + 2*a*b*x^n + b^2*x^(2*n)), x] /; FreeQ[{a, b}, x] && RationalQ[m, n] && m + 1 != 0 && m + 1 != n
Int[ArcTan[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := I/2*Int[Log[1 - I*a - I*b*f^(c + d*x)], x] - I/2*Int[Log[1 + I*a + I*b*f^(c + d*x)], x] /; FreeQ[{a, b, c, d, f}, x]
Int[ArcCot[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := I/2*Int[Log[1 - I/(a + b*f^(c + d*x))], x] - I/2*Int[Log[1 + I/(a + b*f^(c + d*x))], x] /; FreeQ[{a, b, c, d, f}, x] 
Int[x_^m_.*ArcTan[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := I/2*Int[x^m*Log[1 - I*a - I*b*f^(c + d*x)], x] - I/2*Int[x^m*Log[1 + I*a + I*b*f^(c + d*x)], x] /; FreeQ[{a, b, c, d, f}, x] && IntegerQ[m] && m > 0
Int[x_^m_.*ArcCot[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := I/2*Int[x^m*Log[1 - I/(a + b*f^(c + d*x))], x] - I/2*Int[x^m*Log[1 + I/(a + b*f^(c + d*x))], x] /; FreeQ[{a, b, c, d, f}, x] && IntegerQ[m] && m > 0
Int[u_.*ArcTan[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCot[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*ArcCot[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcTan[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[ArcTan[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := x*ArcTan[(c*x)/Sqrt[a + b*x^2]] - c*Int[x/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b + c^2, 0]
Int[ArcCot[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := x*ArcCot[(c*x)/Sqrt[a + b*x^2]] + c*Int[x/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b + c^2, 0]
Int[ArcTan[c_.*x_/Sqrt[a_. + b_.*x_^2]]/x_, x_Symbol] := ArcTan[c*x/Sqrt[a + b*x^2]]*Log[x] - c*Int[Log[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b + c^2, 0]
Int[ArcCot[c_.*x_/Sqrt[a_. + b_.*x_^2]]/x_, x_Symbol] := ArcCot[c*x/Sqrt[a + b*x^2]]*Log[x] + c*Int[Log[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b + c^2, 0]
Int[(d_.*x_)^m_.*ArcTan[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := (d*x)^(m + 1)*ArcTan[(c*x)/Sqrt[a + b*x^2]]/(d*(m + 1)) - c/(d*(m + 1))*Int[(d*x)^(m + 1)/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b + c^2, 0] && NeQ[m, -1]
Int[(d_.*x_)^m_.*ArcCot[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := (d*x)^(m + 1)*ArcCot[(c*x)/Sqrt[a + b*x^2]]/(d*(m + 1)) + c/(d*(m + 1))*Int[(d*x)^(m + 1)/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b + c^2, 0] && NeQ[m, -1]
Int[1/(Sqrt[a_. + b_.*x_^2]*ArcTan[c_.*x_/Sqrt[a_. + b_.*x_^2]]), x_Symbol] := 1/c*Log[ArcTan[c*x/Sqrt[a + b*x^2]]] /; FreeQ[{a, b, c}, x] && EqQ[b + c^2, 0]
Int[1/(Sqrt[a_. + b_.*x_^2]*ArcCot[c_.*x_/Sqrt[a_. + b_.*x_^2]]), x_Symbol] := -1/c*Log[ArcCot[c*x/Sqrt[a + b*x^2]]] /; FreeQ[{a, b, c}, x] && EqQ[b + c^2, 0]
Int[ArcTan[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[a_. + b_.*x_^2], x_Symbol] := ArcTan[c*x/Sqrt[a + b*x^2]]^(m + 1)/(c*(m + 1)) /; FreeQ[{a, b, c, m}, x] && EqQ[b + c^2, 0] && NeQ[m, -1]
Int[ArcCot[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[a_. + b_.*x_^2], x_Symbol] := -ArcCot[c*x/Sqrt[a + b*x^2]]^(m + 1)/(c*(m + 1)) /; FreeQ[{a, b, c, m}, x] && EqQ[b + c^2, 0] && NeQ[m, -1]
Int[ArcTan[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[d_. + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[d + e*x^2]* Int[ArcTan[c*x/Sqrt[a + b*x^2]]^m/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b + c^2, 0] && EqQ[b*d - a*e, 0]
Int[ArcCot[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[d_. + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[d + e*x^2]* Int[ArcCot[c*x/Sqrt[a + b*x^2]]^m/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b + c^2, 0] && EqQ[b*d - a*e, 0]
Int[u_.*ArcTan[v_ + s_.*Sqrt[w_]], x_Symbol] := Pi*s/4*Int[u, x] + 1/2*Int[u*ArcTan[v], x] /; EqQ[s^2, 1] && EqQ[w, v^2 + 1]
Int[u_.*ArcCot[v_ + s_.*Sqrt[w_]], x_Symbol] := Pi*s/4*Int[u, x] - 1/2*Int[u*ArcTan[v], x] /; EqQ[s^2, 1] && EqQ[w, v^2 + 1]
If[TrueQ[$LoadShowSteps], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, ShowStep["", "Int[f[x,ArcTan[a+b*x]]/(1+(a+b*x)^2),x]", "Subst[Int[f[-a/b+Tan[x]/b,x],x],x,ArcTan[a+b*x]]/b", Hold[ (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[Int[ SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Sec[x]^(2*(n + 1)), x], x], x, tmp]]] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcTan] && EqQ[Discriminant[v, x]*tmp[[1]]^2 + D[v, x]^2, 0]] /; SimplifyFlag && QuadraticQ[v, x] && ILtQ[n, 0] && NegQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[ Int[SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Sec[x]^(2*(n + 1)), x], x], x, tmp] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcTan] && EqQ[Discriminant[v, x]*tmp[[1]]^2 + D[v, x]^2, 0]] /; QuadraticQ[v, x] && ILtQ[n, 0] && NegQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]]]
If[TrueQ[$LoadShowSteps], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, ShowStep["", "Int[f[x,ArcCot[a+b*x]]/(1+(a+b*x)^2),x]", "-Subst[Int[f[-a/b+Cot[x]/b,x],x],x,ArcCot[a+b*x]]/b", Hold[ -(-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[Int[ SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Csc[x]^(2*(n + 1)), x], x], x, tmp]]] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcCot] && EqQ[Discriminant[v, x]*tmp[[1]]^2 + D[v, x]^2, 0]] /; SimplifyFlag && QuadraticQ[v, x] && ILtQ[n, 0] && NegQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, -(-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[ Int[SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Csc[x]^(2*(n + 1)), x], x], x, tmp] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcCot] && EqQ[Discriminant[v, x]*tmp[[1]]^2 + D[v, x]^2, 0]] /; QuadraticQ[v, x] && ILtQ[n, 0] && NegQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]]]
Int[ArcTan[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Tan[a + b*x]] - I*b*Int[x/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c + I*d)^2, -1]
Int[ArcCot[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Tan[a + b*x]] + I*b*Int[x/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c + I*d)^2, -1]
Int[ArcTan[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Cot[a + b*x]] - I*b*Int[x/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - I*d)^2, -1]
Int[ArcCot[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Cot[a + b*x]] + I*b*Int[x/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - I*d)^2, -1]
Int[ArcTan[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Tan[a + b*x]] - b*(1 + I*c + d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + I*c - d + (1 + I*c + d)*E^(2*I*a + 2*I*b*x)), x] + b*(1 - I*c - d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - I*c + d + (1 - I*c - d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, -1]
Int[ArcCot[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Tan[a + b*x]] + b*(1 + I*c + d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + I*c - d + (1 + I*c + d)*E^(2*I*a + 2*I*b*x)), x] - b*(1 - I*c - d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - I*c + d + (1 - I*c - d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, -1]
Int[ArcTan[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Cot[a + b*x]] + b*(1 + I*c - d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + I*c + d - (1 + I*c - d)*E^(2*I*a + 2*I*b*x)), x] - b*(1 - I*c + d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - I*c - d - (1 - I*c + d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, -1]
Int[ArcCot[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Cot[a + b*x]] - b*(1 + I*c - d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + I*c + d - (1 + I*c - d)*E^(2*I*a + 2*I*b*x)), x] + b*(1 - I*c + d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - I*c - d - (1 - I*c + d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Tan[a + b*x]]/(f*(m + 1)) - I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c + I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c + I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Cot[a + b*x]]/(f*(m + 1)) - I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Cot[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Tan[a + b*x]]/(f*(m + 1)) - b*(1 + I*c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + I*c - d + (1 + I*c + d)*E^(2*I*a + 2*I*b*x)), x] + b*(1 - I*c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - I*c + d + (1 - I*c - d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c + I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Tan[a + b*x]]/(f*(m + 1)) + b*(1 + I*c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + I*c - d + (1 + I*c + d)*E^(2*I*a + 2*I*b*x)), x] - b*(1 - I*c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - I*c + d + (1 - I*c - d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c + I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Cot[a + b*x]]/(f*(m + 1)) + b*(1 + I*c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + I*c + d - (1 + I*c - d)*E^(2*I*a + 2*I*b*x)), x] - b*(1 - I*c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - I*c - d - (1 - I*c + d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - I*d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Cot[a + b*x]]/(f*(m + 1)) - b*(1 + I*c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + I*c + d - (1 + I*c - d)*E^(2*I*a + 2*I*b*x)), x] + b*(1 - I*c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - I*c - d - (1 - I*c + d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - I*d)^2, -1]
Int[ArcTan[Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTan[Tanh[a + b*x]] - b*Int[x*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcCot[Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCot[Tanh[a + b*x]] + b*Int[x*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcTan[Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTan[Coth[a + b*x]] + b*Int[x*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcCot[Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCot[Coth[a + b*x]] - b*Int[x*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[(e_. + f_.*x_)^m_.*ArcTan[Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[Tanh[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcCot[Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[Tanh[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcTan[Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[Coth[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcCot[Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[Coth[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sech[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[ArcTan[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Tanh[a + b*x]] - b*Int[x/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, -1]
Int[ArcCot[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Tanh[a + b*x]] + b*Int[x/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, -1]
Int[ArcTan[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Coth[a + b*x]] - b*Int[x/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, -1]
Int[ArcCot[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Coth[a + b*x]] + b*Int[x/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, -1]
Int[ArcTan[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Tanh[a + b*x]] + I*b*(I - c - d)* Int[x*E^(2*a + 2*b*x)/(I - c + d + (I - c - d)*E^(2*a + 2*b*x)), x] - I*b*(I + c + d)* Int[x*E^(2*a + 2*b*x)/(I + c - d + (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, -1]
Int[ArcCot[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Tanh[a + b*x]] - I*b*(I - c - d)* Int[x*E^(2*a + 2*b*x)/(I - c + d + (I - c - d)*E^(2*a + 2*b*x)), x] + I*b*(I + c + d)* Int[x*E^(2*a + 2*b*x)/(I + c - d + (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, -1]
Int[ArcTan[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTan[c + d*Coth[a + b*x]] - I*b*(I - c - d)* Int[x*E^(2*a + 2*b*x)/(I - c + d - (I - c - d)*E^(2*a + 2*b*x)), x] + I*b*(I + c + d)* Int[x*E^(2*a + 2*b*x)/(I + c - d - (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, -1]
Int[ArcCot[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCot[c + d*Coth[a + b*x]] + I*b*(I - c - d)* Int[x*E^(2*a + 2*b*x)/(I - c + d - (I - c - d)*E^(2*a + 2*b*x)), x] - I*b*(I + c + d)* Int[x*E^(2*a + 2*b*x)/(I + c - d - (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Tanh[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Coth[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Coth[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Tanh[a + b*x]]/(f*(m + 1)) + I*b*(I - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I - c + d + (I - c - d)*E^(2*a + 2*b*x)), x] - I*b*(I + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I + c - d + (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Tanh[a + b*x]]/(f*(m + 1)) - I*b*(I - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I - c + d + (I - c - d)*E^(2*a + 2*b*x)), x] + I*b*(I + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I + c - d + (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcTan[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTan[c + d*Coth[a + b*x]]/(f*(m + 1)) - I*b*(I - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I - c + d - (I - c - d)*E^(2*a + 2*b*x)), x] + I*b*(I + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I + c - d - (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, -1]
Int[(e_. + f_.*x_)^m_.*ArcCot[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCot[c + d*Coth[a + b*x]]/(f*(m + 1)) + I*b*(I - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I - c + d - (I - c - d)*E^(2*a + 2*b*x)), x] - I*b*(I + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(I + c - d - (I + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, -1]
Int[ArcTan[u_], x_Symbol] := x*ArcTan[u] - Int[SimplifyIntegrand[x*D[u, x]/(1 + u^2), x], x] /; InverseFunctionFreeQ[u, x]
Int[ArcCot[u_], x_Symbol] := x*ArcCot[u] + Int[SimplifyIntegrand[x*D[u, x]/(1 + u^2), x], x] /; InverseFunctionFreeQ[u, x]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcTan[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcTan[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(1 + u^2), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && FalseQ[PowerVariableExpn[u, m + 1, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCot[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCot[u])/(d*(m + 1)) + b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(1 + u^2), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && FalseQ[PowerVariableExpn[u, m + 1, x]]
Int[v_*(a_. + b_.*ArcTan[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcTan[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/(1 + u^2), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]] && FalseQ[FunctionOfLinear[v*(a + b*ArcTan[u]), x]]
Int[v_*(a_. + b_.*ArcCot[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCot[u]), w, x] + b*Int[SimplifyIntegrand[w*D[u, x]/(1 + u^2), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]] && FalseQ[FunctionOfLinear[v*(a + b*ArcCot[u]), x]]
Int[ArcTan[v_]*Log[w_]/(a_. + b_.*x_), x_Symbol] := I/2*Int[Log[1 - I*v]*Log[w]/(a + b*x), x] - I/2*Int[Log[1 + I*v]*Log[w]/(a + b*x), x] /; FreeQ[{a, b}, x] && LinearQ[v, x] && LinearQ[w, x] && EqQ[Simplify[D[v/(a + b*x), x]], 0] && EqQ[Simplify[D[w/(a + b*x), x]], 0]
Int[ArcTan[v_]*Log[w_], x_Symbol] := x*ArcTan[v]*Log[w] - Int[SimplifyIntegrand[x*Log[w]*D[v, x]/(1 + v^2), x], x] - Int[SimplifyIntegrand[x*ArcTan[v]*D[w, x]/w, x], x] /; InverseFunctionFreeQ[v, x] && InverseFunctionFreeQ[w, x]
Int[ArcCot[v_]*Log[w_], x_Symbol] := x*ArcCot[v]*Log[w] + Int[SimplifyIntegrand[x*Log[w]*D[v, x]/(1 + v^2), x], x] - Int[SimplifyIntegrand[x*ArcCot[v]*D[w, x]/w, x], x] /; InverseFunctionFreeQ[v, x] && InverseFunctionFreeQ[w, x]
Int[u_*ArcTan[v_]*Log[w_], x_Symbol] := With[{z = IntHide[u, x]}, Dist[ArcTan[v]*Log[w], z, x] - Int[SimplifyIntegrand[z*Log[w]*D[v, x]/(1 + v^2), x], x] - Int[SimplifyIntegrand[z*ArcTan[v]*D[w, x]/w, x], x] /; InverseFunctionFreeQ[z, x]] /; InverseFunctionFreeQ[v, x] && InverseFunctionFreeQ[w, x]
Int[u_*ArcCot[v_]*Log[w_], x_Symbol] := With[{z = IntHide[u, x]}, Dist[ArcCot[v]*Log[w], z, x] + Int[SimplifyIntegrand[z*Log[w]*D[v, x]/(1 + v^2), x], x] - Int[SimplifyIntegrand[z*ArcCot[v]*D[w, x]/w, x], x] /; InverseFunctionFreeQ[z, x]] /; InverseFunctionFreeQ[v, x] && InverseFunctionFreeQ[w, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.5 Inverse secant/5.5.1 u (a+b arcsec(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 5.5.1 u (a+b arcsec(c x))^n *)
Int[ArcSec[c_.*x_], x_Symbol] := x*ArcSec[c*x] - 1/c*Int[1/(x*Sqrt[1 - 1/(c^2*x^2)]), x] /; FreeQ[c, x]
Int[ArcCsc[c_.*x_], x_Symbol] := x*ArcCsc[c*x] + 1/c*Int[1/(x*Sqrt[1 - 1/(c^2*x^2)]), x] /; FreeQ[c, x]
Int[(a_. + b_.*ArcSec[c_.*x_])^n_, x_Symbol] := 1/c*Subst[Int[(a + b*x)^n*Sec[x]*Tan[x], x], x, ArcSec[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCsc[c_.*x_])^n_, x_Symbol] := -1/c*Subst[Int[(a + b*x)^n*Csc[x]*Cot[x], x], x, ArcCsc[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[n, 0]
Int[(a_. + b_.*ArcSec[c_.*x_])/x_, x_Symbol] := -Subst[Int[(a + b*ArcCos[x/c])/x, x], x, 1/x] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcCsc[c_.*x_])/x_, x_Symbol] := -Subst[Int[(a + b*ArcSin[x/c])/x, x], x, 1/x] /; FreeQ[{a, b, c}, x]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcSec[c_.*x_]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcSec[c*x])/(d*(m + 1)) - b*d/(c*(m + 1))*Int[(d*x)^(m - 1)/Sqrt[1 - 1/(c^2*x^2)], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCsc[c_.*x_]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCsc[c*x])/(d*(m + 1)) + b*d/(c*(m + 1))*Int[(d*x)^(m - 1)/Sqrt[1 - 1/(c^2*x^2)], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcSec[c_.*x_])^n_, x_Symbol] := 1/c^(m + 1)* Subst[Int[(a + b*x)^n*Sec[x]^(m + 1)*Tan[x], x], x, ArcSec[c*x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && IntegerQ[m] && (GtQ[n, 0] || LtQ[m, -1])
Int[x_^m_.*(a_. + b_.*ArcCsc[c_.*x_])^n_, x_Symbol] := -1/c^(m + 1)* Subst[Int[(a + b*x)^n*Csc[x]^(m + 1)*Cot[x], x], x, ArcCsc[c*x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && IntegerQ[m] && (GtQ[n, 0] || LtQ[m, -1])
Int[(a_. + b_.*ArcSec[c_.*x_])/(d_. + e_.*x_), x_Symbol] := (a + b*ArcSec[c*x])* Log[1 + (e - Sqrt[-c^2*d^2 + e^2])*E^(I*ArcSec[c*x])/(c*d)]/e + (a + b*ArcSec[c*x])* Log[1 + (e + Sqrt[-c^2*d^2 + e^2])*E^(I*ArcSec[c*x])/(c*d)]/e - (a + b*ArcSec[c*x])*Log[1 + E^(2*I*ArcSec[c*x])]/e - b/(c*e)* Int[Log[1 + (e - Sqrt[-c^2*d^2 + e^2])* E^(I*ArcSec[c*x])/(c*d)]/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x] - b/(c*e)* Int[Log[1 + (e + Sqrt[-c^2*d^2 + e^2])* E^(I*ArcSec[c*x])/(c*d)]/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x] + b/(c*e)* Int[Log[1 + E^(2*I*ArcSec[c*x])]/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(a_. + b_.*ArcCsc[c_.*x_])/(d_. + e_.*x_), x_Symbol] := (a + b*ArcCsc[c*x])* Log[1 - I*(e - Sqrt[-c^2*d^2 + e^2])*E^(I*ArcCsc[c*x])/(c*d)]/ e + (a + b*ArcCsc[c*x])* Log[1 - I*(e + Sqrt[-c^2*d^2 + e^2])*E^(I*ArcCsc[c*x])/(c*d)]/ e - (a + b*ArcCsc[c*x])*Log[1 - E^(2*I*ArcCsc[c*x])]/e + b/(c*e)* Int[Log[1 - I*(e - Sqrt[-c^2*d^2 + e^2])*E^(I*ArcCsc[c*x])/(c*d)]/(x^2* Sqrt[1 - 1/(c^2*x^2)]), x] + b/(c*e)* Int[Log[1 - I*(e + Sqrt[-c^2*d^2 + e^2])*E^(I*ArcCsc[c*x])/(c*d)]/(x^2* Sqrt[1 - 1/(c^2*x^2)]), x] - b/(c*e)* Int[Log[1 - E^(2*I*ArcCsc[c*x])]/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSec[c_.*x_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcSec[c*x])/(e*(m + 1)) - b/(c*e*(m + 1))* Int[(d + e*x)^(m + 1)/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[m, -1]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCsc[c_.*x_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCsc[c*x])/(e*(m + 1)) + b/(c*e*(m + 1))* Int[(d + e*x)^(m + 1)/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[m, -1]
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSec[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[(a + b*ArcSec[c*x]), u, x] - b*c*x/Sqrt[c^2*x^2]* Int[SimplifyIntegrand[u/(x*Sqrt[c^2*x^2 - 1]), x], x]] /; FreeQ[{a, b, c, d, e}, x] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsc[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[(a + b*ArcCsc[c*x]), u, x] + b*c*x/Sqrt[c^2*x^2]* Int[SimplifyIntegrand[u/(x*Sqrt[c^2*x^2 - 1]), x], x]] /; FreeQ[{a, b, c, d, e}, x] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := -Subst[Int[(e + d*x^2)^p*(a + b*ArcCos[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegerQ[p]
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := -Subst[Int[(e + d*x^2)^p*(a + b*ArcSin[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegerQ[p]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcCos[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcSin[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcCos[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcSin[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[x_*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSec[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcSec[c*x])/(2*e*(p + 1)) - b*c*x/(2*e*(p + 1)*Sqrt[c^2*x^2])* Int[(d + e*x^2)^(p + 1)/(x*Sqrt[c^2*x^2 - 1]), x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[p, -1]
Int[x_*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsc[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcCsc[c*x])/(2*e*(p + 1)) + b*c*x/(2*e*(p + 1)*Sqrt[c^2*x^2])* Int[(d + e*x^2)^(p + 1)/(x*Sqrt[c^2*x^2 - 1]), x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[p, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSec[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[(a + b*ArcSec[c*x]), u, x] - b*c*x/Sqrt[c^2*x^2]* Int[SimplifyIntegrand[u/(x*Sqrt[c^2*x^2 - 1]), x], x]] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && ( IGtQ[p, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*p + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[p, 0] && GtQ[m + 2*p + 3, 0]] || ILtQ[(m + 2*p + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]])
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsc[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[(a + b*ArcCsc[c*x]), u, x] + b*c*x/Sqrt[c^2*x^2]* Int[SimplifyIntegrand[u/(x*Sqrt[c^2*x^2 - 1]), x], x]] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && ( IGtQ[p, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*p + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[p, 0] && GtQ[m + 2*p + 3, 0]] || ILtQ[(m + 2*p + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]])
Int[x_^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := -Subst[ Int[(e + d*x^2)^p*(a + b*ArcCos[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegerQ[m] && IntegerQ[p]
Int[x_^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := -Subst[ Int[(e + d*x^2)^p*(a + b*ArcSin[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegerQ[m] && IntegerQ[p]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcCos[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcSin[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcCos[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcSin[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[u_*(a_. + b_.*ArcSec[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[(a + b*ArcSec[c*x]), v, x] - b/c* Int[SimplifyIntegrand[v/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[u_*(a_. + b_.*ArcCsc[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[(a + b*ArcCsc[c*x]), v, x] + b/c* Int[SimplifyIntegrand[v/(x^2*Sqrt[1 - 1/(c^2*x^2)]), x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[u_.*(a_. + b_.*ArcSec[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcSec[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]
Int[u_.*(a_. + b_.*ArcCsc[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcCsc[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/5 Inverse trig functions/5.5 Inverse secant/5.5.2 Miscellaneous inverse secant.m
*)

(* ::Subsection::Closed:: *)
(* 5.5.2 Miscellaneous inverse secant *)
Int[ArcSec[c_ + d_.*x_], x_Symbol] := (c + d*x)*ArcSec[c + d*x]/d - Int[1/((c + d*x)*Sqrt[1 - 1/(c + d*x)^2]), x] /; FreeQ[{c, d}, x]
Int[ArcCsc[c_ + d_.*x_], x_Symbol] := (c + d*x)*ArcCsc[c + d*x]/d + Int[1/((c + d*x)*Sqrt[1 - 1/(c + d*x)^2]), x] /; FreeQ[{c, d}, x]
Int[(a_. + b_.*ArcSec[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcSec[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCsc[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCsc[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcSec[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcSec[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(a_. + b_.*ArcCsc[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcCsc[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSec[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcSec[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsc[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcCsc[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSec[c_ + d_.*x_])^p_., x_Symbol] := 1/d^(m + 1)* Subst[Int[(a + b*x)^p*Sec[x]*Tan[x]*(d*e - c*f + f*Sec[x])^m, x], x, ArcSec[c + d*x]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsc[c_ + d_.*x_])^p_., x_Symbol] := -1/d^(m + 1)* Subst[Int[(a + b*x)^p*Csc[x]*Cot[x]*(d*e - c*f + f*Csc[x])^m, x], x, ArcCsc[c + d*x]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSec[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcSec[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsc[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCsc[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSec[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcSec[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsc[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcCsc[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[u_.*ArcSec[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCos[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*ArcCsc[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcSin[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*f_^(c_.*ArcSec[a_. + b_.*x_]^n_.), x_Symbol] := 1/b*Subst[ Int[ReplaceAll[u, x -> -a/b + Sec[x]/b]*f^(c*x^n)*Sec[x]*Tan[x], x], x, ArcSec[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[n, 0]
Int[u_.*f_^(c_.*ArcCsc[a_. + b_.*x_]^n_.), x_Symbol] := -1/b*Subst[ Int[ReplaceAll[u, x -> -a/b + Csc[x]/b]*f^(c*x^n)*Csc[x]*Cot[x], x], x, ArcCsc[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[n, 0]
Int[ArcSec[u_], x_Symbol] := x*ArcSec[u] - u/Sqrt[u^2]* Int[SimplifyIntegrand[x*D[u, x]/(u*Sqrt[u^2 - 1]), x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[ArcCsc[u_], x_Symbol] := x*ArcCsc[u] + u/Sqrt[u^2]* Int[SimplifyIntegrand[x*D[u, x]/(u*Sqrt[u^2 - 1]), x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcSec[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcSec[u])/(d*(m + 1)) - b*u/(d*(m + 1)*Sqrt[u^2])* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(u*Sqrt[u^2 - 1]), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCsc[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCsc[u])/(d*(m + 1)) + b*u/(d*(m + 1)*Sqrt[u^2])* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(u*Sqrt[u^2 - 1]), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[v_*(a_. + b_.*ArcSec[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcSec[u]), w, x] - b*u/Sqrt[u^2]* Int[SimplifyIntegrand[w*D[u, x]/(u*Sqrt[u^2 - 1]), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]
Int[v_*(a_. + b_.*ArcCsc[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCsc[u]), w, x] + b*u/Sqrt[u^2]* Int[SimplifyIntegrand[w*D[u, x]/(u*Sqrt[u^2 - 1]), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.1 Hyperbolic sine/6.1.10 (c+d x)^m (a+b sinh)^n.m
*)

(* ::Subsection::Closed:: *)
(* 6.1.10 (c+d x)^m (a+b sinh)^n *)
Int[u_^m_.*(a_. + b_.*Sinh[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Sinh[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*(a_. + b_.*Cosh[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Cosh[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.1 Hyperbolic sine/6.1.11 (e x)^m (a+b x^n)^p sinh.m
*)

(* ::Subsection::Closed:: *)
(* 6.1.11 (e x)^m (a+b x^n)^p sinh *)
Int[(a_ + b_.*x_^n_)^p_.*Sinh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sinh[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_.*Cosh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cosh[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := x^(-n + 1)*(a + b*x^n)^(p + 1)*Sinh[c + d*x]/(b*n*(p + 1)) - (-n + 1)/(b*n*(p + 1))* Int[x^(-n)*(a + b*x^n)^(p + 1)*Sinh[c + d*x], x] - d/(b*n*(p + 1))* Int[x^(-n + 1)*(a + b*x^n)^(p + 1)*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[p] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[n, 2]
Int[(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := x^(-n + 1)*(a + b*x^n)^(p + 1)*Cosh[c + d*x]/(b*n*(p + 1)) - (-n + 1)/(b*n*(p + 1))* Int[x^(-n)*(a + b*x^n)^(p + 1)*Cosh[c + d*x], x] - d/(b*n*(p + 1))* Int[x^(-n + 1)*(a + b*x^n)^(p + 1)*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[p] && IGtQ[n, 0] && LtQ[p, -1] && GtQ[n, 2]
Int[(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sinh[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cosh[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := Int[x^(n*p)*(b + a*x^(-n))^p*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := Int[x^(n*p)*(b + a*x^(-n))^p*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := Unintegrable[(a + b*x^n)^p*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := Unintegrable[(a + b*x^n)^p*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Sinh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sinh[c + d*x], (e*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Cosh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cosh[c + d*x], (e*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := e^m*(a + b*x^n)^(p + 1)*Sinh[c + d*x]/(b*n*(p + 1)) - d*e^m/(b*n*(p + 1))*Int[(a + b*x^n)^(p + 1)*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && EqQ[m - n + 1, 0] && LtQ[p, -1] && (IntegerQ[n] || GtQ[e, 0])
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := e^m*(a + b*x^n)^(p + 1)*Cosh[c + d*x]/(b*n*(p + 1)) - d*e^m/(b*n*(p + 1))*Int[(a + b*x^n)^(p + 1)*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && EqQ[m - n + 1, 0] && LtQ[p, -1] && (IntegerQ[n] || GtQ[e, 0])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := x^(m - n + 1)*(a + b*x^n)^(p + 1)*Sinh[c + d*x]/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*(a + b*x^n)^(p + 1)*Sinh[c + d*x], x] - d/(b*n*(p + 1))* Int[x^(m - n + 1)*(a + b*x^n)^(p + 1)*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, -1] && IGtQ[n, 0] && RationalQ[m] && (GtQ[m - n + 1, 0] || GtQ[n, 2])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := x^(m - n + 1)*(a + b*x^n)^(p + 1)*Cosh[c + d*x]/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*(a + b*x^n)^(p + 1)*Cosh[c + d*x], x] - d/(b*n*(p + 1))* Int[x^(m - n + 1)*(a + b*x^n)^(p + 1)*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, -1] && IGtQ[n, 0] && RationalQ[m] && (GtQ[m - n + 1, 0] || GtQ[n, 2])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Sinh[c + d*x], x^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IntegerQ[m] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := Int[ExpandIntegrand[Cosh[c + d*x], x^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IntegerQ[m] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Sinh[c_. + d_.*x_], x_Symbol] := Int[x^(m + n*p)*(b + a*x^(-n))^p*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[x_^m_.*(a_ + b_.*x_^n_)^p_*Cosh[c_. + d_.*x_], x_Symbol] := Int[x^(m + n*p)*(b + a*x^(-n))^p*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Sinh[c_. + d_.*x_], x_Symbol] := Unintegrable[(e*x)^m*(a + b*x^n)^p*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_.*x_)^m_.*(a_ + b_.*x_^n_)^p_.*Cosh[c_. + d_.*x_], x_Symbol] := Unintegrable[(e*x)^m*(a + b*x^n)^p*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.1 Hyperbolic sine/6.1.12 (e x)^m (a+b sinh(c+d x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 6.1.12 (e x)^m (a+b sinh(c+d x^n))^p *)
Int[Sinh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[E^(c + d*x^n), x] - 1/2*Int[E^(-c - d*x^n), x] /; FreeQ[{c, d}, x] && IGtQ[n, 1]
Int[Cosh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[E^(c + d*x^n), x] + 1/2*Int[E^(-c - d*x^n), x] /; FreeQ[{c, d}, x] && IGtQ[n, 1]
Int[(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Sinh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 1] && IGtQ[p, 1]
Int[(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Cosh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 1] && IGtQ[p, 1]
Int[(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(a + b*Sinh[c + d*x^(-n)])^p/x^2, x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && ILtQ[n, 0] && IntegerQ[p]
Int[(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(a + b*Cosh[c + d*x^(-n)])^p/x^2, x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && ILtQ[n, 0] && IntegerQ[p]
Int[(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*Sinh[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d}, x] && FractionQ[n] && IntegerQ[p]
Int[(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*Cosh[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d}, x] && FractionQ[n] && IntegerQ[p]
Int[Sinh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[E^(c + d*x^n), x] - 1/2*Int[E^(-c - d*x^n), x] /; FreeQ[{c, d, n}, x]
Int[Cosh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[E^(c + d*x^n), x] + 1/2*Int[E^(-c - d*x^n), x] /; FreeQ[{c, d, n}, x]
Int[(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Sinh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(a + b*Cosh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*Sinh[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Sinh[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n}, x] && IntegerQ[p] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Cosh[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Cosh[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n}, x] && IntegerQ[p] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Sinh[c_. + d_.*u_^n_])^p_, x_Symbol] := Unintegrable[(a + b*Sinh[c + d*u^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x]
Int[(a_. + b_.*Cosh[c_. + d_.*u_^n_])^p_, x_Symbol] := Unintegrable[(a + b*Cosh[c + d*u^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x]
Int[(a_. + b_.*Sinh[u_])^p_., x_Symbol] := Int[(a + b*Sinh[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(a_. + b_.*Cosh[u_])^p_., x_Symbol] := Int[(a + b*Cosh[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[Sinh[d_.*x_^n_]/x_, x_Symbol] := SinhIntegral[d*x^n]/n /; FreeQ[{d, n}, x]
Int[Cosh[d_.*x_^n_]/x_, x_Symbol] := CoshIntegral[d*x^n]/n /; FreeQ[{d, n}, x]
Int[Sinh[c_ + d_.*x_^n_]/x_, x_Symbol] := Sinh[c]*Int[Cosh[d*x^n]/x, x] + Cosh[c]*Int[Sinh[d*x^n]/x, x] /; FreeQ[{c, d, n}, x]
Int[Cosh[c_ + d_.*x_^n_]/x_, x_Symbol] := Cosh[c]*Int[Cosh[d*x^n]/x, x] + Sinh[c]*Int[Sinh[d*x^n]/x, x] /; FreeQ[{c, d, n}, x]
Int[x_^m_.*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Sinh[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IntegerQ[ Simplify[(m + 1)/n]] && (EqQ[p, 1] || EqQ[m, n - 1] || IntegerQ[p] && GtQ[Simplify[(m + 1)/n], 0])
Int[x_^m_.*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Cosh[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IntegerQ[ Simplify[(m + 1)/n]] && (EqQ[p, 1] || EqQ[m, n - 1] || IntegerQ[p] && GtQ[Simplify[(m + 1)/n], 0])
Int[(e_*x_)^m_*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sinh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(e_*x_)^m_*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cosh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(e_.*x_)^m_.*Sinh[c_. + d_.*x_^n_], x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*Cosh[c + d*x^n]/(d*n) - e^n*(m - n + 1)/(d*n)*Int[(e*x)^(m - n)*Cosh[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[0, n, m + 1]
Int[(e_.*x_)^m_.*Cosh[c_. + d_.*x_^n_], x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*Sinh[c + d*x^n]/(d*n) - e^n*(m - n + 1)/(d*n)*Int[(e*x)^(m - n)*Sinh[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[0, n, m + 1]
Int[(e_.*x_)^m_*Sinh[c_. + d_.*x_^n_], x_Symbol] := (e*x)^(m + 1)*Sinh[c + d*x^n]/(e*(m + 1)) - d*n/(e^n*(m + 1))*Int[(e*x)^(m + n)*Cosh[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[(e_.*x_)^m_*Cosh[c_. + d_.*x_^n_], x_Symbol] := (e*x)^(m + 1)*Cosh[c + d*x^n]/(e*(m + 1)) - d*n/(e^n*(m + 1))*Int[(e*x)^(m + n)*Sinh[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[(e_.*x_)^m_.*Sinh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[(e*x)^m*E^(c + d*x^n), x] - 1/2*Int[(e*x)^m*E^(-c - d*x^n), x] /; FreeQ[{c, d, e, m}, x] && IGtQ[n, 0]
Int[(e_.*x_)^m_.*Cosh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[(e*x)^m*E^(c + d*x^n), x] + 1/2*Int[(e*x)^m*E^(-c - d*x^n), x] /; FreeQ[{c, d, e, m}, x] && IGtQ[n, 0]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_, x_Symbol] := -Sinh[a + b*x^n]^p/((n - 1)*x^(n - 1)) + b*n*p/(n - 1)*Int[Sinh[a + b*x^n]^(p - 1)*Cosh[a + b*x^n], x] /; FreeQ[{a, b}, x] && IntegersQ[n, p] && EqQ[m + n, 0] && GtQ[p, 1] && NeQ[n, 1]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_, x_Symbol] := -Cosh[a + b*x^n]^p/((n - 1)*x^(n - 1)) + b*n*p/(n - 1)*Int[Cosh[a + b*x^n]^(p - 1)*Sinh[a + b*x^n], x] /; FreeQ[{a, b}, x] && IntegersQ[n, p] && EqQ[m + n, 0] && GtQ[p, 1] && NeQ[n, 1]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_, x_Symbol] := -n*Sinh[a + b*x^n]^p/(b^2*n^2*p^2) + x^n*Cosh[a + b*x^n]*Sinh[a + b*x^n]^(p - 1)/(b*n*p) - (p - 1)/p*Int[x^m*Sinh[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1] && GtQ[p, 1]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_, x_Symbol] := -n*Cosh[a + b*x^n]^p/(b^2*n^2*p^2) + x^n*Sinh[a + b*x^n]*Cosh[a + b*x^n]^(p - 1)/(b*n*p) + (p - 1)/p*Int[x^m*Cosh[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1] && GtQ[p, 1]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_, x_Symbol] := -(m - n + 1)*x^(m - 2*n + 1)*Sinh[a + b*x^n]^p/(b^2*n^2*p^2) + x^(m - n + 1)*Cosh[a + b*x^n]*Sinh[a + b*x^n]^(p - 1)/(b*n*p) - (p - 1)/p*Int[x^m*Sinh[a + b*x^n]^(p - 2), x] + (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*p^2)* Int[x^(m - 2*n)*Sinh[a + b*x^n]^p, x] /; FreeQ[{a, b}, x] && IntegersQ[m, n] && GtQ[p, 1] && LtQ[0, 2*n, m + 1]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_, x_Symbol] := -(m - n + 1)*x^(m - 2*n + 1)*Cosh[a + b*x^n]^p/(b^2*n^2*p^2) + x^(m - n + 1)*Sinh[a + b*x^n]*Cosh[a + b*x^n]^(p - 1)/(b*n*p) + (p - 1)/p*Int[x^m*Cosh[a + b*x^n]^(p - 2), x] + (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*p^2)* Int[x^(m - 2*n)*Cosh[a + b*x^n]^p, x] /; FreeQ[{a, b}, x] && IntegersQ[m, n] && GtQ[p, 1] && LtQ[0, 2*n, m + 1]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m + 1)*Sinh[a + b*x^n]^p/(m + 1) - b*n*p*x^(m + n + 1)*Cosh[a + b*x^n]* Sinh[a + b*x^n]^(p - 1)/((m + 1)*(m + n + 1)) + b^2*n^2*p^2/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Sinh[a + b*x^n]^p, x] + b^2*n^2*p*(p - 1)/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Sinh[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b}, x] && IntegersQ[m, n] && GtQ[p, 1] && LtQ[0, 2*n, 1 - m] && NeQ[m + n + 1, 0]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m + 1)*Cosh[a + b*x^n]^p/(m + 1) - b*n*p*x^(m + n + 1)*Sinh[a + b*x^n]* Cosh[a + b*x^n]^(p - 1)/((m + 1)*(m + n + 1)) + b^2*n^2*p^2/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Cosh[a + b*x^n]^p, x] - b^2*n^2*p*(p - 1)/((m + 1)*(m + n + 1))* Int[x^(m + 2*n)*Cosh[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b}, x] && IntegersQ[m, n] && GtQ[p, 1] && LtQ[0, 2*n, 1 - m] && NeQ[m + n + 1, 0]
Int[(e_.*x_)^m_*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, k/e* Subst[Int[x^(k*(m + 1) - 1)*(a + b*Sinh[c + d*x^(k*n)/e^n])^p, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && IGtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, k/e* Subst[Int[x^(k*(m + 1) - 1)*(a + b*Cosh[c + d*x^(k*n)/e^n])^p, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && IGtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_.*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Sinh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(e_.*x_)^m_.*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Cosh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_, x_Symbol] := x^n*Cosh[a + b*x^n]*Sinh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - n*Sinh[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) - (p + 2)/(p + 1)*Int[x^m*Sinh[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_, x_Symbol] := -x^n*Sinh[a + b*x^n]*Cosh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) + n*Cosh[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) + (p + 2)/(p + 1)*Int[x^m*Cosh[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_, x_Symbol] := x^(m - n + 1)*Cosh[a + b*x^n]* Sinh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - (m - n + 1)*x^(m - 2*n + 1)* Sinh[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) - (p + 2)/(p + 1)*Int[x^m*Sinh[a + b*x^n]^(p + 2), x] + (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*(p + 1)*(p + 2))* Int[x^(m - 2*n)*Sinh[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b}, x] && IntegersQ[m, n] && LtQ[p, -1] && NeQ[p, -2] && LtQ[0, 2*n, m + 1]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_, x_Symbol] := -x^(m - n + 1)*Sinh[a + b*x^n]* Cosh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) + (m - n + 1)*x^(m - 2*n + 1)* Cosh[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2)) + (p + 2)/(p + 1)*Int[x^m*Cosh[a + b*x^n]^(p + 2), x] - (m - n + 1)*(m - 2*n + 1)/(b^2*n^2*(p + 1)*(p + 2))* Int[x^(m - 2*n)*Cosh[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b}, x] && IntegersQ[m, n] && LtQ[p, -1] && NeQ[p, -2] && LtQ[0, 2*n, m + 1]
Int[x_^m_.*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(a + b*Sinh[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[p] && ILtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(a + b*Cosh[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[p] && ILtQ[n, 0] && IntegerQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, -k/e* Subst[Int[(a + b*Sinh[c + d/(e^n*x^(k*n))])^p/x^(k*(m + 1) + 1), x], x, 1/(e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && ILtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := With[{k = Denominator[m]}, -k/e* Subst[Int[(a + b*Cosh[c + d/(e^n*x^(k*n))])^p/x^(k*(m + 1) + 1), x], x, 1/(e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && ILtQ[n, 0] && FractionQ[m]
Int[(e_.*x_)^m_*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := -(e*x)^m*(x^(-1))^m* Subst[Int[(a + b*Sinh[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[(e_.*x_)^m_*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := -(e*x)^m*(x^(-1))^m* Subst[Int[(a + b*Cosh[c + d*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && ILtQ[n, 0] && Not[RationalQ[m]]
Int[x_^m_.*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Sinh[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[p] && FractionQ[n]
Int[x_^m_.*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Cosh[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[p] && FractionQ[n]
Int[(e_*x_)^m_*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sinh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && FractionQ[n]
Int[(e_*x_)^m_*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cosh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && FractionQ[n]
Int[x_^m_.*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*Sinh[c + d*x^Simplify[n/(m + 1)]])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[x_^m_.*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/(m + 1)* Subst[Int[(a + b*Cosh[c + d*x^Simplify[n/(m + 1)]])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[(e_*x_)^m_*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sinh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[(e_*x_)^m_*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Cosh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] && Not[IntegerQ[n]]
Int[(e_.*x_)^m_.*Sinh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[(e*x)^m*E^(c + d*x^n), x] - 1/2*Int[(e*x)^m*E^(-c - d*x^n), x] /; FreeQ[{c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*Cosh[c_. + d_.*x_^n_], x_Symbol] := 1/2*Int[(e*x)^m*E^(c + d*x^n), x] + 1/2*Int[(e*x)^m*E^(-c - d*x^n), x] /; FreeQ[{c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*(a_. + b_.*Sinh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Sinh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[(e_.*x_)^m_.*(a_. + b_.*Cosh[c_. + d_.*x_^n_])^p_, x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Cosh[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[x_^m_.*(a_. + b_.*Sinh[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]^(m + 1)* Subst[Int[(x - Coefficient[u, x, 0])^m*(a + b*Sinh[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x] && IntegerQ[m]
Int[x_^m_.*(a_. + b_.*Cosh[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]^(m + 1)* Subst[Int[(x - Coefficient[u, x, 0])^m*(a + b*Cosh[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x] && IntegerQ[m]
Int[(e_.*x_)^m_.*(a_. + b_.*Sinh[c_. + d_.*u_^n_])^p_., x_Symbol] := Unintegrable[(e*x)^m*(a + b*Sinh[c + d*u^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && LinearQ[u, x]
Int[(e_.*x_)^m_.*(a_. + b_.*Cosh[c_. + d_.*u_^n_])^p_., x_Symbol] := Unintegrable[(e*x)^m*(a + b*Cosh[c + d*u^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && LinearQ[u, x]
Int[(e_*x_)^m_.*(a_. + b_.*Sinh[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Sinh[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(e_*x_)^m_.*(a_. + b_.*Cosh[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Cosh[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_]^p_.*Cosh[a_. + b_.*x_^n_.], x_Symbol] := Sinh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_]^p_.*Sinh[a_. + b_.*x_^n_.], x_Symbol] := Cosh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[x_^m_.*Sinh[a_. + b_.*x_^n_.]^p_.*Cosh[a_. + b_.*x_^n_.], x_Symbol] := x^(m - n + 1)*Sinh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*Sinh[a + b*x^n]^(p + 1), x] /; FreeQ[{a, b, p}, x] && LtQ[0, n, m + 1] && NeQ[p, -1]
Int[x_^m_.*Cosh[a_. + b_.*x_^n_.]^p_.*Sinh[a_. + b_.*x_^n_.], x_Symbol] := x^(m - n + 1)*Cosh[a + b*x^n]^(p + 1)/(b*n*(p + 1)) - (m - n + 1)/(b*n*(p + 1))* Int[x^(m - n)*Cosh[a + b*x^n]^(p + 1), x] /; FreeQ[{a, b, p}, x] && LtQ[0, n, m + 1] && NeQ[p, -1]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.1 Hyperbolic sine/6.1.13 (d+e x)^m sinh(a+b x+c x^2)^n.m
*)

(* ::Subsection::Closed:: *)
(* 6.1.13 (d+e x)^m sinh(a+b x+c x^2)^n *)
Int[Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := 1/2*Int[E^(a + b*x + c*x^2), x] - 1/2*Int[E^(-a - b*x - c*x^2), x] /; FreeQ[{a, b, c}, x]
Int[Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := 1/2*Int[E^(a + b*x + c*x^2), x] + 1/2*Int[E^(-a - b*x - c*x^2), x] /; FreeQ[{a, b, c}, x]
Int[Sinh[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[Sinh[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 1]
Int[Cosh[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[Cosh[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 1]
Int[Sinh[v_]^n_., x_Symbol] := Int[Sinh[ExpandToSum[v, x]]^n, x] /; IGtQ[n, 0] && QuadraticQ[v, x] && Not[QuadraticMatchQ[v, x]]
Int[Cosh[v_]^n_., x_Symbol] := Int[Cosh[ExpandToSum[v, x]]^n, x] /; IGtQ[n, 0] && QuadraticQ[v, x] && Not[QuadraticMatchQ[v, x]]
Int[(d_. + e_.*x_)*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Cosh[a + b*x + c*x^2]/(2*c) /; FreeQ[{a, b, c, d, e}, x] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Sinh[a + b*x + c*x^2]/(2*c) /; FreeQ[{a, b, c, d, e}, x] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Cosh[a + b*x + c*x^2]/(2*c) - (b*e - 2*c*d)/(2*c)*Int[Sinh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Sinh[a + b*x + c*x^2]/(2*c) - (b*e - 2*c*d)/(2*c)*Int[Cosh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m - 1)*Cosh[a + b*x + c*x^2]/(2*c) - e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Cosh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[m, 1] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m - 1)*Sinh[a + b*x + c*x^2]/(2*c) - e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Sinh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[m, 1] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m - 1)*Cosh[a + b*x + c*x^2]/(2*c) - (b*e - 2*c*d)/(2*c)* Int[(d + e*x)^(m - 1)*Sinh[a + b*x + c*x^2], x] - e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Cosh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[m, 1] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*(d + e*x)^(m - 1)*Sinh[a + b*x + c*x^2]/(2*c) - (b*e - 2*c*d)/(2*c)* Int[(d + e*x)^(m - 1)*Cosh[a + b*x + c*x^2], x] - e^2*(m - 1)/(2*c)* Int[(d + e*x)^(m - 2)*Sinh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[m, 1] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Sinh[a + b*x + c*x^2]/(e*(m + 1)) - 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Cosh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && LtQ[m, -1] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Cosh[a + b*x + c*x^2]/(e*(m + 1)) - 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Sinh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && LtQ[m, -1] && EqQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Sinh[a + b*x + c*x^2]/(e*(m + 1)) - (b*e - 2*c*d)/(e^2*(m + 1))* Int[(d + e*x)^(m + 1)*Cosh[a + b*x + c*x^2], x] - 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Cosh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && LtQ[m, -1] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := (d + e*x)^(m + 1)*Cosh[a + b*x + c*x^2]/(e*(m + 1)) - (b*e - 2*c*d)/(e^2*(m + 1))* Int[(d + e*x)^(m + 1)*Sinh[a + b*x + c*x^2], x] - 2*c/(e^2*(m + 1))* Int[(d + e*x)^(m + 2)*Sinh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && LtQ[m, -1] && NeQ[b*e - 2*c*d, 0]
Int[(d_. + e_.*x_)^m_.*Sinh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Unintegrable[(d + e*x)^m*Sinh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x]
Int[(d_. + e_.*x_)^m_.*Cosh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := Unintegrable[(d + e*x)^m*Cosh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x]
Int[(d_. + e_.*x_)^m_.*Sinh[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[(d + e*x)^m, Sinh[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 1]
Int[(d_. + e_.*x_)^m_.*Cosh[a_. + b_.*x_ + c_.*x_^2]^n_, x_Symbol] := Int[ExpandTrigReduce[(d + e*x)^m, Cosh[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 1]
Int[u_^m_.*Sinh[v_]^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*Sinh[ExpandToSum[v, x]]^n, x] /; FreeQ[m, x] && IGtQ[n, 0] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]
Int[u_^m_.*Cosh[v_]^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*Cosh[ExpandToSum[v, x]]^n, x] /; FreeQ[m, x] && IGtQ[n, 0] && LinearQ[u, x] && QuadraticQ[v, x] && Not[LinearMatchQ[u, x] && QuadraticMatchQ[v, x]]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.3 Hyperbolic tangent/6.3.10 (c+d x)^m (a+b tanh)^n.m
*)

(* ::Subsection::Closed:: *)
(* 6.3.10 (c+d x)^m (a+b tanh)^n *)
Int[u_^m_.*(a_. + b_.*Tanh[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Tanh[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*(a_. + b_.*Coth[v_])^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Coth[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.3 Hyperbolic tangent/6.3.11 (e x)^m (a+b tanh(c+d x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 6.3.11 (e x)^m (a+b tanh(c+d x^n))^p *)
Int[(a_. + b_.*Tanh[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Tanh[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Coth[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Coth[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Tanh[c_. + d_.*x_^n_])^p_., x_Symbol] := Integral[(a + b*Tanh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Coth[c_. + d_.*x_^n_])^p_., x_Symbol] := Integral[(a + b*Coth[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Tanh[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Tanh[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Coth[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Coth[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Tanh[u_])^p_., x_Symbol] := Int[(a + b*Tanh[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(a_. + b_.*Coth[u_])^p_., x_Symbol] := Int[(a + b*Coth[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*(a_. + b_.*Tanh[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Tanh[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*(a_. + b_.*Coth[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Coth[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*Tanh[c_. + d_.*x_^n_]^2, x_Symbol] := -x^(m - n + 1)*Tanh[c + d*x^n]/(d*n) + Int[x^m, x] + (m - n + 1)/(d*n)*Int[x^(m - n)*Tanh[c + d*x^n], x] /; FreeQ[{c, d, m, n}, x]
Int[x_^m_.*Coth[c_. + d_.*x_^n_]^2, x_Symbol] := -x^(m - n + 1)*Coth[c + d*x^n]/(d*n) + Int[x^m, x] + (m - n + 1)/(d*n)*Int[x^(m - n)*Coth[c + d*x^n], x] /; FreeQ[{c, d, m, n}, x]
Int[x_^m_.*(a_. + b_.*Tanh[c_. + d_.*x_^n_])^p_., x_Symbol] := Integral[x^m*(a + b*Tanh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[x_^m_.*(a_. + b_.*Coth[c_. + d_.*x_^n_])^p_., x_Symbol] := Integral[x^m*(a + b*Coth[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Tanh[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Tanh[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Coth[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Coth[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Tanh[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Tanh[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(e_*x_)^m_.*(a_. + b_.*Coth[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Coth[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*Sech[a_. + b_.*x_^n_.]^p_.*Tanh[a_. + b_.*x_^n_.]^q_., x_Symbol] := -x^(m - n + 1)*Sech[a + b*x^n]^p/(b*n*p) + (m - n + 1)/(b*n*p)*Int[x^(m - n)*Sech[a + b*x^n]^p, x] /; FreeQ[{a, b, p}, x] && RationalQ[m] && IntegerQ[n] && GeQ[m - n, 0] && EqQ[q, 1]
Int[x_^m_.*Csch[a_. + b_.*x_^n_.]^p_.*Coth[a_. + b_.*x_^n_.]^q_., x_Symbol] := -x^(m - n + 1)*Csch[a + b*x^n]^p/(b*n*p) + (m - n + 1)/(b*n*p)*Int[x^(m - n)*Csch[a + b*x^n]^p, x] /; FreeQ[{a, b, p}, x] && RationalQ[m] && IntegerQ[n] && GeQ[m - n, 0] && EqQ[q, 1]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.3 Hyperbolic tangent/6.3.12 (d+e x)^m tanh(a+b x+c x^2)^n.m
*)

(* ::Subsection::Closed:: *)
(* 6.3.12 (d+e x)^m tanh(a+b x+c x^2)^n *)
Int[Tanh[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Integral[Tanh[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Coth[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Integral[Coth[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[(d_. + e_.*x_)*Tanh[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Log[Cosh[a + b*x + c*x^2]]/(2*c) + (2*c*d - b*e)/(2*c)*Int[Tanh[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_)*Coth[a_. + b_.*x_ + c_.*x_^2], x_Symbol] := e*Log[Sinh[a + b*x + c*x^2]]/(2*c) + (2*c*d - b*e)/(2*c)*Int[Coth[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x]
(* Int[x_^m_*Tanh[a_.+b_.*x_+c_.*x_^2],x_Symbol] := x^(m-1)*Log[Cosh[a+b*x+c*x^2]]/(2*c) - b/(2*c)*Int[x^(m-1)*Tanh[a+b*x+c*x^2],x] - (m-1)/(2*c)*Int[x^(m-2)*Log[Cosh[a+b*x+c*x^2]],x] /; FreeQ[{a,b,c},x] && GtQ[m,1] *)
(* Int[x_^m_*Coth[a_.+b_.*x_+c_.*x_^2],x_Symbol] := x^(m-1)*Log[Sinh[a+b*x+c*x^2]]/(2*c) - b/(2*c)*Int[x^(m-1)*Coth[a+b*x+c*x^2],x] - (m-1)/(2*c)*Int[x^(m-2)*Log[Sinh[a+b*x+c*x^2]],x] /; FreeQ[{a,b,c},x] && GtQ[m,1] *)
Int[(d_. + e_.*x_)^m_.*Tanh[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Integral[(d + e*x)^m*Tanh[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(d_. + e_.*x_)^m_.*Coth[a_. + b_.*x_ + c_.*x_^2]^n_., x_Symbol] := Integral[(d + e*x)^m*Coth[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.5 Hyperbolic secant/6.5.10 (c+d x)^m (a+b sech)^n.m
*)

(* ::Subsection::Closed:: *)
(* 6.5.10 (c+d x)^m (a+b sech)^n *)
Int[u_^m_.*Sech[v_]^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*Sech[ExpandToSum[v, x]]^n, x] /; FreeQ[{m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[u_^m_.*Csch[v_]^n_., x_Symbol] := Int[ExpandToSum[u, x]^m*Csch[ExpandToSum[v, x]]^n, x] /; FreeQ[{m, n}, x] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.5 Hyperbolic secant/6.5.11 (e x)^m (a+b sech(c+d x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 6.5.11 (e x)^m (a+b sech(c+d x^n))^p *)
Int[(a_. + b_.*Sech[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Sech[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Csch[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[Int[x^(1/n - 1)*(a + b*Csch[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[(a_. + b_.*Sech[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(a + b*Sech[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Csch[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[(a + b*Csch[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(a_. + b_.*Sech[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Sech[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Csch[c_. + d_.*u_^n_])^p_., x_Symbol] := 1/Coefficient[u, x, 1]* Subst[Int[(a + b*Csch[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[(a_. + b_.*Sech[u_])^p_., x_Symbol] := Int[(a + b*Sech[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(a_. + b_.*Csch[u_])^p_., x_Symbol] := Int[(a + b*Csch[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*(a_. + b_.*Sech[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Sech[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*(a_. + b_.*Csch[c_. + d_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Csch[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[x_^m_.*(a_. + b_.*Sech[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[x^m*(a + b*Sech[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[x_^m_.*(a_. + b_.*Csch[c_. + d_.*x_^n_])^p_., x_Symbol] := Unintegrable[x^m*(a + b*Csch[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Sech[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Sech[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Csch[c_. + d_.*x_^n_])^p_., x_Symbol] := e^IntPart[m]*(e*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*Csch[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(e_*x_)^m_.*(a_. + b_.*Sech[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Sech[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[(e_*x_)^m_.*(a_. + b_.*Csch[u_])^p_., x_Symbol] := Int[(e*x)^m*(a + b*Csch[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] && Not[BinomialMatchQ[u, x]]
Int[x_^m_.*Sech[a_. + b_.*x_^n_.]^p_*Sinh[a_. + b_.*x_^n_.], x_Symbol] := -x^(m - n + 1)*Sech[a + b*x^n]^(p - 1)/(b*n*(p - 1)) + (m - n + 1)/(b*n*(p - 1))* Int[x^(m - n)*Sech[a + b*x^n]^(p - 1), x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m - n, 0] && NeQ[p, 1]
Int[x_^m_.*Csch[a_. + b_.*x_^n_.]^p_*Cosh[a_. + b_.*x_^n_.], x_Symbol] := -x^(m - n + 1)*Csch[a + b*x^n]^(p - 1)/(b*n*(p - 1)) + (m - n + 1)/(b*n*(p - 1))* Int[x^(m - n)*Csch[a + b*x^n]^(p - 1), x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m - n, 0] && NeQ[p, 1]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.7 Miscellaneous/6.7.6 (c+d x)^m hyper(a+b x)^n hyper(a+b x)^p.m
*)

(* ::Subsection::Closed:: *)
(* 6.7.6 (c+d x)^m hyper(a+b x)^n hyper(a+b x)^p *)
Int[(c_. + d_.*x_)^m_.*Sinh[a_. + b_.*x_]^n_.*Cosh[a_. + b_.*x_], x_Symbol] := (c + d*x)^m*Sinh[a + b*x]^(n + 1)/(b*(n + 1)) - d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Sinh[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Sinh[a_. + b_.*x_]*Cosh[a_. + b_.*x_]^n_., x_Symbol] := (c + d*x)^m*Cosh[a + b*x]^(n + 1)/(b*(n + 1)) - d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Cosh[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Sinh[a_. + b_.*x_]^n_.*Cosh[a_. + b_.*x_]^p_., x_Symbol] := Int[ExpandTrigReduce[(c + d*x)^m, Sinh[a + b*x]^n*Cosh[a + b*x]^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_.*Sinh[a_. + b_.*x_]^n_.*Tanh[a_. + b_.*x_]^p_., x_Symbol] := Int[(c + d*x)^m*Sinh[a + b*x]^n*Tanh[a + b*x]^(p - 2), x] - Int[(c + d*x)^m*Sinh[a + b*x]^(n - 2)*Tanh[a + b*x]^p, x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_.*Cosh[a_. + b_.*x_]^n_.*Coth[a_. + b_.*x_]^p_., x_Symbol] := Int[(c + d*x)^m*Cosh[a + b*x]^n*Coth[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Cosh[a + b*x]^(n - 2)*Coth[a + b*x]^p, x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(c_. + d_.*x_)^m_.*Sech[a_. + b_.*x_]^n_.*Tanh[a_. + b_.*x_]^p_., x_Symbol] := -(c + d*x)^m*Sech[a + b*x]^n/(b*n) + d*m/(b*n)*Int[(c + d*x)^(m - 1)*Sech[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]^n_.*Coth[a_. + b_.*x_]^p_., x_Symbol] := -(c + d*x)^m*Csch[a + b*x]^n/(b*n) + d*m/(b*n)*Int[(c + d*x)^(m - 1)*Csch[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 1] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Sech[a_. + b_.*x_]^2*Tanh[a_. + b_.*x_]^n_., x_Symbol] := (c + d*x)^m*Tanh[a + b*x]^(n + 1)/(b*(n + 1)) - d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Tanh[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]^2*Coth[a_. + b_.*x_]^n_., x_Symbol] := -(c + d*x)^m*Coth[a + b*x]^(n + 1)/(b*(n + 1)) + d*m/(b*(n + 1))*Int[(c + d*x)^(m - 1)*Coth[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(c_. + d_.*x_)^m_.*Sech[a_. + b_.*x_]*Tanh[a_. + b_.*x_]^p_, x_Symbol] := Int[(c + d*x)^m*Sech[a + b*x]*Tanh[a + b*x]^(p - 2), x] - Int[(c + d*x)^m*Sech[a + b*x]^3*Tanh[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Sech[a_. + b_.*x_]^n_.*Tanh[a_. + b_.*x_]^p_, x_Symbol] := Int[(c + d*x)^m*Sech[a + b*x]^n*Tanh[a + b*x]^(p - 2), x] - Int[(c + d*x)^m*Sech[a + b*x]^(n + 2)*Tanh[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]*Coth[a_. + b_.*x_]^p_, x_Symbol] := Int[(c + d*x)^m*Csch[a + b*x]*Coth[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Csch[a + b*x]^3*Coth[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]^n_.*Coth[a_. + b_.*x_]^p_, x_Symbol] := Int[(c + d*x)^m*Csch[a + b*x]^n*Coth[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Csch[a + b*x]^(n + 2)*Coth[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p/2, 0]
Int[(c_. + d_.*x_)^m_.*Sech[a_. + b_.*x_]^n_.*Tanh[a_. + b_.*x_]^p_., x_Symbol] := With[{u = IntHide[Sech[a + b*x]^n*Tanh[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d, n, p}, x] && IGtQ[m, 0] && (IntegerQ[n/2] || IntegerQ[(p - 1)/2])
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]^n_.*Coth[a_. + b_.*x_]^p_., x_Symbol] := With[{u = IntHide[Csch[a + b*x]^n*Coth[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d, n, p}, x] && IGtQ[m, 0] && (IntegerQ[n/2] || IntegerQ[(p - 1)/2])
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]^n_.*Sech[a_. + b_.*x_]^n_., x_Symbol] := 2^n*Int[(c + d*x)^m*Csch[2*a + 2*b*x]^n, x] /; FreeQ[{a, b, c, d}, x] && RationalQ[m] && IntegerQ[n]
Int[(c_. + d_.*x_)^m_.*Csch[a_. + b_.*x_]^n_.*Sech[a_. + b_.*x_]^p_., x_Symbol] := With[{u = IntHide[Csch[a + b*x]^n*Sech[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p] && GtQ[m, 0] && NeQ[n, p]
Int[u_^m_.*F_[v_]^n_.*G_[w_]^p_., x_Symbol] := Int[ExpandToSum[u, x]^m*F[ExpandToSum[v, x]]^n* G[ExpandToSum[v, x]]^p, x] /; FreeQ[{m, n, p}, x] && HyperbolicQ[F] && HyperbolicQ[G] && EqQ[v, w] && LinearQ[{u, v, w}, x] && Not[LinearMatchQ[{u, v, w}, x]]
Int[(e_. + f_.*x_)^m_.* Cosh[c_. + d_.*x_]*(a_ + b_.*Sinh[c_. + d_.*x_])^n_., x_Symbol] := (e + f*x)^m*(a + b*Sinh[c + d*x])^(n + 1)/(b*d*(n + 1)) - f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Sinh[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.* Sinh[c_. + d_.*x_]*(a_ + b_.*Cosh[c_. + d_.*x_])^n_., x_Symbol] := (e + f*x)^m*(a + b*Cosh[c + d*x])^(n + 1)/(b*d*(n + 1)) - f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Cosh[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.* Sech[c_. + d_.*x_]^2*(a_ + b_.*Tanh[c_. + d_.*x_])^n_., x_Symbol] := (e + f*x)^m*(a + b*Tanh[c + d*x])^(n + 1)/(b*d*(n + 1)) - f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Tanh[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.* Csch[c_. + d_.*x_]^2*(a_ + b_.*Coth[c_. + d_.*x_])^n_., x_Symbol] := -(e + f*x)^m*(a + b*Coth[c + d*x])^(n + 1)/(b*d*(n + 1)) + f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Coth[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.*Sech[c_. + d_.*x_]* Tanh[c_. + d_.*x_]*(a_ + b_.*Sech[c_. + d_.*x_])^n_., x_Symbol] := -(e + f*x)^m*(a + b*Sech[c + d*x])^(n + 1)/(b*d*(n + 1)) + f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Sech[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.*Csch[c_. + d_.*x_]* Coth[c_. + d_.*x_]*(a_ + b_.*Csch[c_. + d_.*x_])^n_., x_Symbol] := -(e + f*x)^m*(a + b*Csch[c + d*x])^(n + 1)/(b*d*(n + 1)) + f*m/(b*d*(n + 1))* Int[(e + f*x)^(m - 1)*(a + b*Csch[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[(e_. + f_.*x_)^m_.*Sinh[a_. + b_.*x_]^p_.*Sinh[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Sinh[a + b*x]^p*Sinh[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*Cosh[a_. + b_.*x_]^p_.*Cosh[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Cosh[a + b*x]^p*Cosh[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*Sinh[a_. + b_.*x_]^p_.*Cosh[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Sinh[a + b*x]^p*Cosh[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IGtQ[q, 0]
Int[(e_. + f_.*x_)^m_.*F_[a_. + b_.*x_]^p_.*G_[c_. + d_.*x_]^q_., x_Symbol] := Int[ExpandTrigExpand[(e + f*x)^m*G[c + d*x]^q, F, c + d*x, p, b/d, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && MemberQ[{Sinh, Cosh}, F] && MemberQ[{Sech, Csch}, G] && IGtQ[p, 0] && IGtQ[q, 0] && EqQ[b*c - a*d, 0] && IGtQ[b/d, 1]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.7 Miscellaneous/6.7.7 F^(c (a+b x)) hyper(d+e x)^n.m
*)

(* ::Subsection::Closed:: *)
(* 6.7.7 F^(c (a+b x)) hyper(d+e x)^n *)
Int[F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_], x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sinh[d + e*x]/(e^2 - b^2*c^2*Log[F]^2) + e*F^(c*(a + b*x))*Cosh[d + e*x]/(e^2 - b^2*c^2*Log[F]^2) /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2 - b^2*c^2*Log[F]^2, 0]
Int[F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_], x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Cosh[d + e*x]/(e^2 - b^2*c^2*Log[F]^2) + e*F^(c*(a + b*x))*Sinh[d + e*x]/(e^2 - b^2*c^2*Log[F]^2) /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2 - b^2*c^2*Log[F]^2, 0]
Int[F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sinh[d + e*x]^n/(e^2*n^2 - b^2*c^2*Log[F]^2) + e*n*F^(c*(a + b*x))*Cosh[d + e*x]* Sinh[d + e*x]^(n - 1)/(e^2*n^2 - b^2*c^2*Log[F]^2) - n*(n - 1)*e^2/(e^2*n^2 - b^2*c^2*Log[F]^2)* Int[F^(c*(a + b*x))*Sinh[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 - b^2*c^2*Log[F]^2, 0] && GtQ[n, 1]
Int[F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Cosh[d + e*x]^n/(e^2*n^2 - b^2*c^2*Log[F]^2) + e*n*F^(c*(a + b*x))*Sinh[d + e*x]* Cosh[d + e*x]^(n - 1)/(e^2*n^2 - b^2*c^2*Log[F]^2) + n*(n - 1)*e^2/(e^2*n^2 - b^2*c^2*Log[F]^2)* Int[F^(c*(a + b*x))*Cosh[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 - b^2*c^2*Log[F]^2, 0] && GtQ[n, 1]
Int[F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sinh[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) + F^(c*(a + b*x))*Cosh[d + e*x]*Sinh[d + e*x]^(n + 1)/(e*(n + 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n + 2)^2 - b^2*c^2*Log[F]^2, 0] && NeQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Cosh[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) - F^(c*(a + b*x))*Sinh[d + e*x]*Cosh[d + e*x]^(n + 1)/(e*(n + 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n + 2)^2 - b^2*c^2*Log[F]^2, 0] && NeQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Sinh[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) + F^(c*(a + b*x))*Cosh[d + e*x]*Sinh[d + e*x]^(n + 1)/(e*(n + 1)) - (e^2*(n + 2)^2 - b^2*c^2*Log[F]^2)/(e^2*(n + 1)*(n + 2))* Int[F^(c*(a + b*x))*Sinh[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n + 2)^2 - b^2*c^2*Log[F]^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Cosh[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2)) - F^(c*(a + b*x))*Sinh[d + e*x]*Cosh[d + e*x]^(n + 1)/(e*(n + 1)) + (e^2*(n + 2)^2 - b^2*c^2*Log[F]^2)/(e^2*(n + 1)*(n + 2))* Int[F^(c*(a + b*x))*Cosh[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n + 2)^2 - b^2*c^2*Log[F]^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^n_, x_Symbol] := E^(n*(d + e*x))*Sinh[d + e*x]^n/(-1 + E^(2*(d + e*x)))^n* Int[F^(c*(a + b*x))*(-1 + E^(2*(d + e*x)))^n/E^(n*(d + e*x)), x] /; FreeQ[{F, a, b, c, d, e, n}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_]^n_, x_Symbol] := E^(n*(d + e*x))*Cosh[d + e*x]^n/(1 + E^(2*(d + e*x)))^n* Int[F^(c*(a + b*x))*(1 + E^(2*(d + e*x)))^n/E^(n*(d + e*x)), x] /; FreeQ[{F, a, b, c, d, e, n}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*Tanh[d_. + e_.*x_]^n_., x_Symbol] := Int[ExpandIntegrand[ F^(c*(a + b*x))*(-1 + E^(2*(d + e*x)))^n/(1 + E^(2*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Coth[d_. + e_.*x_]^n_., x_Symbol] := Int[ExpandIntegrand[ F^(c*(a + b*x))*(1 + E^(2*(d + e*x)))^n/(-1 + E^(2*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Sech[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]* F^(c*(a + b*x))*(Sech[d + e*x]^n/(e^2*n^2 - b^2*c^2*Log[F]^2)) - e*n*F^(c*(a + b*x))* Sech[d + e*x]^(n + 1)*(Sinh[ d + e*x]/(e^2*n^2 - b^2*c^2*Log[F]^2)) + e^2*n*((n + 1)/(e^2*n^2 - b^2*c^2*Log[F]^2))* Int[F^(c*(a + b*x))*Sech[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1]
Int[F_^(c_.*(a_. + b_.*x_))*Csch[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]* F^(c*(a + b*x))*(Csch[d + e*x]^n/(e^2*n^2 - b^2*c^2*Log[F]^2)) - e*n*F^(c*(a + b*x))* Csch[d + e*x]^(n + 1)*(Cosh[ d + e*x]/(e^2*n^2 - b^2*c^2*Log[F]^2)) - e^2*n*((n + 1)/(e^2*n^2 - b^2*c^2*Log[F]^2))* Int[F^(c*(a + b*x))*Csch[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1]
Int[F_^(c_.*(a_. + b_.*x_))*Sech[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Sech[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2)) + F^(c*(a + b*x))*Sech[d + e*x]^(n - 1)*Sinh[d + e*x]/(e*(n - 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n - 2)^2 - b^2*c^2*Log[F]^2, 0] && NeQ[n, 1] && NeQ[n, 2]
Int[F_^(c_.*(a_. + b_.*x_))*Csch[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Csch[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2)) - F^(c*(a + b*x))*Csch[d + e*x]^(n - 1)*Cosh[d + e*x]/(e*(n - 1)) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n - 2)^2 - b^2*c^2*Log[F]^2, 0] && NeQ[n, 1] && NeQ[n, 2]
Int[F_^(c_.*(a_. + b_.*x_))*Sech[d_. + e_.*x_]^n_, x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))* Sech[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2)) + F^(c*(a + b*x))*Sech[d + e*x]^(n - 1)* Sinh[d + e*x]/(e*(n - 1)) + (e^2*(n - 2)^2 - b^2*c^2*Log[F]^2)/(e^2*(n - 1)*(n - 2))* Int[F^(c*(a + b*x))*Sech[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n - 2)^2 - b^2*c^2*Log[F]^2, 0] && GtQ[n, 1] && NeQ[n, 2]
Int[F_^(c_.*(a_. + b_.*x_))*Csch[d_. + e_.*x_]^n_, x_Symbol] := -b*c*Log[F]*F^(c*(a + b*x))* Csch[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2)) - F^(c*(a + b*x))*Csch[d + e*x]^(n - 1)* Cosh[d + e*x]/(e*(n - 1)) - (e^2*(n - 2)^2 - b^2*c^2*Log[F]^2)/(e^2*(n - 1)*(n - 2))* Int[F^(c*(a + b*x))*Csch[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n - 2)^2 - b^2*c^2*Log[F]^2, 0] && GtQ[n, 1] && NeQ[n, 2]
(* Int[F_^(c_.*(a_.+b_.*x_))*Sech[d_.+e_.*x_]^n_.,x_Symbol] := 2^n*Int[SimplifyIntegrand[F^(c*(a+b*x))*E^(n*(d+e*x))/(1+E^(2*(d+e* x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e},x] && IntegerQ[n] *)
(* Int[F_^(c_.*(a_.+b_.*x_))*Csch[d_.+e_.*x_]^n_.,x_Symbol] := 2^n*Int[SimplifyIntegrand[F^(c*(a+b*x))*E^(-n*(d+e*x))/(1-E^(-2*(d+ e*x)))^n,x],x] /; FreeQ[{F,a,b,c,d,e},x] && IntegerQ[n] *)
Int[F_^(c_.*(a_. + b_.*x_))*Sech[d_. + e_.*x_]^n_., x_Symbol] := 2^n*E^(n*(d + e*x))*F^(c*(a + b*x))/(e*n + b*c*Log[F])* Hypergeometric2F1[n, n/2 + b*c*Log[F]/(2*e), 1 + n/2 + b*c*Log[F]/(2*e), -E^(2*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Csch[d_. + e_.*x_]^n_., x_Symbol] := (-2)^n*E^(n*(d + e*x))*F^(c*(a + b*x))/(e*n + b*c*Log[F])* Hypergeometric2F1[n, n/2 + b*c*Log[F]/(2*e), 1 + n/2 + b*c*Log[F]/(2*e), E^(2*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[F_^(c_.*(a_. + b_.*x_))*Sech[d_. + e_.*x_]^n_., x_Symbol] := (1 + E^(2*(d + e*x)))^n*Sech[d + e*x]^n/E^(n*(d + e*x))* Int[SimplifyIntegrand[ F^(c*(a + b*x))*E^(n*(d + e*x))/(1 + E^(2*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*Csch[d_. + e_.*x_]^n_., x_Symbol] := (1 - E^(-2*(d + e*x)))^n*Csch[d + e*x]^n/E^(-n*(d + e*x))* Int[SimplifyIntegrand[ F^(c*(a + b*x))*E^(-n*(d + e*x))/(1 - E^(-2*(d + e*x)))^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Sinh[d_. + e_.*x_])^n_., x_Symbol] := 2^n*f^n* Int[F^(c*(a + b*x))*Cosh[d/2 - f*Pi/(4*g) + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f^2 + g^2, 0] && ILtQ[n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cosh[d_. + e_.*x_])^n_., x_Symbol] := 2^n*g^n*Int[F^(c*(a + b*x))*Cosh[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f - g, 0] && ILtQ[n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cosh[d_. + e_.*x_])^n_., x_Symbol] := 2^n*g^n*Int[F^(c*(a + b*x))*Sinh[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f + g, 0] && ILtQ[n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Sinh[d_. + e_.*x_])^n_., x_Symbol] := (f + g*Sinh[d + e*x])^n/Cosh[d/2 - f*Pi/(4*g) + e*x/2]^(2*n)* Int[F^(c*(a + b*x))*Cosh[d/2 - f*Pi/(4*g) + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && EqQ[f^2 + g^2, 0] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cosh[d_. + e_.*x_])^n_., x_Symbol] := (f + g*Cosh[d + e*x])^n/Cosh[d/2 + e*x/2]^(2*n)* Int[F^(c*(a + b*x))*Cosh[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && EqQ[f - g, 0] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))*(f_ + g_.*Cosh[d_. + e_.*x_])^n_., x_Symbol] := (f + g*Cosh[d + e*x])^n/Sinh[d/2 + e*x/2]^(2*n)* Int[F^(c*(a + b*x))*Sinh[d/2 + e*x/2]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g, n}, x] && EqQ[f + g, 0] && Not[IntegerQ[n]]
Int[F_^(c_.*(a_. + b_.*x_))* Cosh[d_. + e_.*x_]^m_.*(f_ + g_.*Sinh[d_. + e_.*x_])^n_., x_Symbol] := g^n*Int[F^(c*(a + b*x))*Tanh[d/2 + e*x/2 - f*Pi/(4*g)]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f^2 + g^2, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[F_^(c_.*(a_. + b_.*x_))* Sinh[d_. + e_.*x_]^m_.*(f_ + g_.*Cosh[d_. + e_.*x_])^n_., x_Symbol] := g^n*Int[F^(c*(a + b*x))*Tanh[d/2 + e*x/2]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f - g, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[F_^(c_.*(a_. + b_.*x_))* Sinh[d_. + e_.*x_]^m_.*(f_ + g_.*Cosh[d_. + e_.*x_])^n_., x_Symbol] := g^n*Int[F^(c*(a + b*x))*Coth[d/2 + e*x/2]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f + g, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(h_ + i_.*Cosh[d_. + e_.*x_])/(f_ + g_.*Sinh[d_. + e_.*x_]), x_Symbol] := 2*i*Int[F^(c*(a + b*x))*(Cosh[d + e*x]/(f + g*Sinh[d + e*x])), x] + Int[ F^(c*(a + b*x))*((h - i*Cosh[d + e*x])/(f + g*Sinh[d + e*x])), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i}, x] && EqQ[f^2 + g^2, 0] && EqQ[h^2 - i^2, 0] && EqQ[g*h - f*i, 0]
Int[F_^(c_.*(a_. + b_.*x_))*(h_ + i_.*Sinh[d_. + e_.*x_])/(f_ + g_.*Cosh[d_. + e_.*x_]), x_Symbol] := 2*i*Int[F^(c*(a + b*x))*(Sinh[d + e*x]/(f + g*Cosh[d + e*x])), x] + Int[ F^(c*(a + b*x))*((h - i*Sinh[d + e*x])/(f + g*Cosh[d + e*x])), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i}, x] && EqQ[f^2 - g^2, 0] && EqQ[h^2 + i^2, 0] && EqQ[g*h + f*i, 0]
Int[F_^(c_.*u_)*G_[v_]^n_., x_Symbol] := Int[F^(c*ExpandToSum[u, x])*G[ExpandToSum[v, x]]^n, x] /; FreeQ[{F, c, n}, x] && HyperbolicQ[G] && LinearQ[{u, v}, x] && Not[LinearMatchQ[{u, v}, x]]
Int[(f_.*x_)^m_.*F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^n_., x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Sinh[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_.*F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_]^n_., x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Cosh[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_*F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))*F^(c*(a + b*x))*Sinh[d + e*x] - e/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Cosh[d + e*x], x] - b*c*Log[F]/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Sinh[d + e*x], x] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && (LtQ[m, -1] || SumSimplerQ[m, 1])
Int[(f_.*x_)^m_*F_^(c_.*(a_. + b_.*x_))*Cosh[d_. + e_.*x_], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))*F^(c*(a + b*x))*Cosh[d + e*x] - e/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Sinh[d + e*x], x] - b*c*Log[F]/(f*(m + 1))* Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Cosh[d + e*x], x] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && (LtQ[m, -1] || SumSimplerQ[m, 1])
(* Int[(f_.*x_)^m_.*F_^(c_.*(a_.+b_.*x_))*Sinh[d_.+e_.*x_]^n_.,x_ Symbol] := (-1)^n/2^n*Int[ExpandIntegrand[(f*x)^m*F^(c*(a+b*x)),(E^(-(d+e*x))- E^(d+e*x))^n,x],x] /; FreeQ[{F,a,b,c,d,e,f},x] && IGtQ[n,0] *)
(* Int[(f_.*x_)^m_.*F_^(c_.*(a_.+b_.*x_))*Cosh[d_.+e_.*x_]^n_.,x_ Symbol] := 1/2^n*Int[ExpandIntegrand[(f*x)^m*F^(c*(a+b*x)),(E^(-(d+e*x))+E^(d+ e*x))^n,x],x] /; FreeQ[{F,a,b,c,d,e,f},x] && IGtQ[n,0] *)
Int[F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^m_.* Cosh[f_. + g_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[F^(c*(a + b*x)), Sinh[d + e*x]^m*Cosh[f + g*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[x_^p_.*F_^(c_.*(a_. + b_.*x_))*Sinh[d_. + e_.*x_]^m_.* Cosh[f_. + g_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[x^p*F^(c*(a + b*x)), Sinh[d + e*x]^m*Cosh[f + g*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[F_^(c_.*(a_. + b_.*x_))*G_[d_. + e_.*x_]^m_.*H_[d_. + e_.*x_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^(c*(a + b*x)), G[d + e*x]^m*H[d + e*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IGtQ[m, 0] && IGtQ[n, 0] && HyperbolicQ[G] && HyperbolicQ[H]
Int[F_^u_*Sinh[v_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^u, Sinh[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[n, 0]
Int[F_^u_*Cosh[v_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^u, Cosh[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[n, 0]
Int[F_^u_*Sinh[v_]^m_.*Cosh[v_]^n_., x_Symbol] := Int[ExpandTrigToExp[F^u, Sinh[v]^m*Cosh[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[m, 0] && IGtQ[n, 0]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.7 Miscellaneous/6.7.8 u hyper(a+b log(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 6.7.8 u hyper(a+b log(c x^n))^p *)
Int[Sinh[b_.*Log[c_.*x_^n_.]]^p_., x_Symbol] := Int[((c*x^n)^b/2 - 1/(2*(c*x^n)^b))^p, x] /; FreeQ[c, x] && RationalQ[b, n, p]
Int[Cosh[b_.*Log[c_.*x_^n_.]]^p_., x_Symbol] := Int[((c*x^n)^b/2 + 1/(2*(c*x^n)^b))^p, x] /; FreeQ[c, x] && RationalQ[b, n, p]
Int[Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := -x*Sinh[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 - 1) + b*d*n*x*Cosh[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 - 1) /; FreeQ[{a, b, c, d, n}, x] && NeQ[b^2*d^2*n^2 - 1, 0]
Int[Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := -x*Cosh[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 - 1) + b*d*n*x*Sinh[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 - 1) /; FreeQ[{a, b, c, d, n}, x] && NeQ[b^2*d^2*n^2 - 1, 0]
Int[Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := -x*Sinh[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*n^2*p^2 - 1) + b*d*n*p*x*Cosh[d*(a + b*Log[c*x^n])]* Sinh[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*n^2*p^2 - 1) - b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 - 1)* Int[Sinh[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 - 1, 0]
Int[Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := -x*Cosh[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*n^2*p^2 - 1) + b*d*n*p*x*Cosh[d*(a + b*Log[c*x^n])]^(p - 1)* Sinh[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2*p^2 - 1) + b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 - 1)* Int[Cosh[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 - 1, 0]
Int[Sinh[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 1/(2^p*b^p*d^p*p^p)* Int[ExpandIntegrand[(-E^(-a*b*d^2*p)*x^(-1/p) + E^(a*b*d^2*p)*x^(1/p))^p, x], x] /; FreeQ[{a, b, d}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 - 1, 0]
Int[Cosh[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 1/2^p* Int[ExpandIntegrand[(E^(-a*b*d^2*p)*x^(-1/p) + E^(a*b*d^2*p)*x^(1/p))^p, x], x] /; FreeQ[{a, b, d}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 - 1, 0]
(* Int[Sinh[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := E^(a*d*p)/2^p*Int[x^(b*d*p)*(1-1/(E^(2*a*d)*x^(2*b*d)))^p,x] /; FreeQ[{a,b,d},x] && IntegerQ[p] *)
(* Int[Cosh[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := E^(a*d*p)/2^p*Int[x^(b*d*p)*(1+1/(E^(2*a*d)*x^(2*b*d)))^p,x] /; FreeQ[{a,b,d},x] && IntegerQ[p] *)
Int[Sinh[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Sinh[d*(a + b*Log[x])]^ p/(x^(b*d*p)*(1 - 1/(E^(2*a*d)*x^(2*b*d)))^p)* Int[x^(b*d*p)*(1 - 1/(E^(2*a*d)*x^(2*b*d)))^p, x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Cosh[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Cosh[d*(a + b*Log[x])]^ p/(x^(b*d*p)*(1 + 1/(E^(2*a*d)*x^(2*b*d)))^p)* Int[x^(b*d*p)*(1 + 1/(E^(2*a*d)*x^(2*b*d)))^p, x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Sinh[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Cosh[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := -(m + 1)*(e*x)^(m + 1)* Sinh[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 - e*(m + 1)^2) + b*d*n*(e*x)^(m + 1)* Cosh[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 - e*(m + 1)^2) /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b^2*d^2*n^2 - (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := -(m + 1)*(e*x)^(m + 1)* Cosh[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 - e*(m + 1)^2) + b*d*n*(e*x)^(m + 1)* Sinh[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 - e*(m + 1)^2) /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b^2*d^2*n^2 - (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := -(m + 1)*(e*x)^(m + 1)* Sinh[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*e*n^2*p^2 - e*(m + 1)^2) + b*d*n*p*(e*x)^(m + 1)*Cosh[d*(a + b*Log[c*x^n])]* Sinh[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*e*n^2*p^2 - e*(m + 1)^2) - b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 - (m + 1)^2)* Int[(e*x)^m*Sinh[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 - (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_, x_Symbol] := -(m + 1)*(e*x)^(m + 1)* Cosh[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*e*n^2*p^2 - e*(m + 1)^2) + b*d*n*p*(e*x)^(m + 1)*Sinh[d*(a + b*Log[c*x^n])]* Cosh[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*e*n^2*p^2 - e*(m + 1)^2) + b^2*d^2*n^2*p*(p - 1)/(b^2*d^2*n^2*p^2 - (m + 1)^2)* Int[(e*x)^m*Cosh[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 - (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Sinh[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := (m + 1)^p/(2^p*b^p*d^p*p^p)* Int[ ExpandIntegrand[(e*x)^ m*(-E^(-a*b*d^2*p/(m + 1))*x^(-(m + 1)/p) + E^(a*b*d^2*p/(m + 1))*x^((m + 1)/p))^p, x], x] /; FreeQ[{a, b, d, e, m}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 - (m + 1)^2, 0]
Int[(e_.*x_)^m_.*Cosh[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 1/2^p* Int[ExpandIntegrand[(e*x)^ m*(E^(-a*b*d^2*p/(m + 1))*x^(-(m + 1)/p) + E^(a*b*d^2*p/(m + 1))*x^((m + 1)/p))^p, x], x] /; FreeQ[{a, b, d, e, m}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 - (m + 1)^2, 0]
(* Int[(e_.*x_)^m_.*Sinh[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := E^(a*d*p)/2^p*Int[(e*x)^m*x^(b*d*p)*(1-1/(E^(2*a*d)*x^(2*b*d)))^p,x]  /; FreeQ[{a,b,d,e,m},x] && IntegerQ[p] *)
(* Int[(e_.*x_)^m_.*Cosh[d_.*(a_.+b_.*Log[x_])]^p_.,x_Symbol] := E^(a*d*p)/2^p*Int[(e*x)^m*x^(b*d*p)*(1+1/(E^(2*a*d)*x^(2*b*d)))^p,x]  /; FreeQ[{a,b,d,e,m},x] && IntegerQ[p] *)
Int[(e_.*x_)^m_.*Sinh[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Sinh[d*(a + b*Log[x])]^ p/(x^(b*d*p)*(1 - 1/(E^(2*a*d)*x^(2*b*d)))^p)* Int[(e*x)^m*x^(b*d*p)*(1 - 1/(E^(2*a*d)*x^(2*b*d)))^p, x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Cosh[d_.*(a_. + b_.*Log[x_])]^p_, x_Symbol] := Cosh[d*(a + b*Log[x])]^ p/(x^(b*d*p)*(1 + 1/(E^(2*a*d)*x^(2*b*d)))^p)* Int[(e*x)^m*x^(b*d*p)*(1 + 1/(E^(2*a*d)*x^(2*b*d)))^p, x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Sinh[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Cosh[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := -E^(-a*d)*(c*x^n)^(-b*d)/(2*x^(-b*d*n))* Int[x^(-b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] + E^(a*d)*(c*x^n)^(b*d)/(2*x^(b*d*n))* Int[x^(b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, q}, x]
Int[(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := E^(-a*d)*(c*x^n)^(-b*d)/(2*x^(-b*d*n))* Int[x^(-b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] + E^(a*d)*(c*x^n)^(b*d)/(2*x^(b*d*n))* Int[x^(b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, q}, x]
Int[(i_.*x_)^r_.*(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := -E^(-a*d)*(i*x)^r*(c*x^n)^(-b*d)/(2*x^(r - b*d*n))* Int[x^(r - b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] + E^(a*d)*(i*x)^r*(c*x^n)^(b*d)/(2*x^(r + b*d*n))* Int[x^(r + b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, q, r}, x]
Int[(i_.*x_)^r_.*(h_.*(e_. + f_.*Log[g_.*x_^m_.]))^q_.* Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := E^(-a*d)*(i*x)^r*(c*x^n)^(-b*d)/(2*x^(r - b*d*n))* Int[x^(r - b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] + E^(a*d)*(i*x)^r*(c*x^n)^(b*d)/(2*x^(r + b*d*n))* Int[x^(r + b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, q, r}, x]
Int[Tanh[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[(-1 + E^(2*a*d)*x^(2*b*d))^p/(1 + E^(2*a*d)*x^(2*b*d))^p, x] /; FreeQ[{a, b, d, p}, x]
Int[Coth[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[(-1 - E^(2*a*d)*x^(2*b*d))^p/(1 - E^(2*a*d)*x^(2*b*d))^p, x] /; FreeQ[{a, b, d, p}, x]
Int[Tanh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Tanh[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Coth[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Coth[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Tanh[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[(e*x)^ m*(-1 + E^(2*a*d)*x^(2*b*d))^p/(1 + E^(2*a*d)*x^(2*b*d))^p, x] /; FreeQ[{a, b, d, e, m, p}, x]
Int[(e_.*x_)^m_.*Coth[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Int[(e*x)^ m*(-1 - E^(2*a*d)*x^(2*b*d))^p/(1 - E^(2*a*d)*x^(2*b*d))^p, x] /; FreeQ[{a, b, d, e, m, p}, x]
Int[(e_.*x_)^m_.*Tanh[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Tanh[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Coth[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Coth[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Sech[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 2^p*E^(-a*d*p)*Int[x^(-b*d*p)/(1 + E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d}, x] && IntegerQ[p]
Int[Csch[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 2^p*E^(-a*d*p)*Int[x^(-b*d*p)/(1 - E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d}, x] && IntegerQ[p]
Int[Sech[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Sech[d*(a + b*Log[x])]^p*(1 + E^(-2*a*d)*x^(-2*b*d))^p/x^(-b*d*p)* Int[x^(-b*d*p)/(1 + E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Csch[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Csch[d*(a + b*Log[x])]^p*(1 - E^(-2*a*d)*x^(-2*b*d))^p/x^(-b*d*p)* Int[x^(-b*d*p)/(1 - E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d, p}, x] && Not[IntegerQ[p]]
Int[Sech[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Sech[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Csch[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := x/(n*(c*x^n)^(1/n))* Subst[Int[x^(1/n - 1)*Csch[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Sech[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 2^p*E^(-a*d*p)* Int[(e*x)^m*x^(-b*d*p)/(1 + E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d, e, m}, x] && IntegerQ[p]
Int[(e_.*x_)^m_.*Csch[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := 2^p*E^(-a*d*p)* Int[(e*x)^m*x^(-b*d*p)/(1 - E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d, e, m}, x] && IntegerQ[p]
Int[(e_.*x_)^m_.*Sech[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Sech[d*(a + b*Log[x])]^p*(1 + E^(-2*a*d)*x^(-2*b*d))^p/x^(-b*d*p)* Int[(e*x)^m*x^(-b*d*p)/(1 + E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Csch[d_.*(a_. + b_.*Log[x_])]^p_., x_Symbol] := Csch[d*(a + b*Log[x])]^p*(1 - E^(-2*a*d)*x^(-2*b*d))^p/x^(-b*d*p)* Int[(e*x)^m*x^(-b*d*p)/(1 - E^(-2*a*d)*x^(-2*b*d))^p, x] /; FreeQ[{a, b, d, e, m, p}, x] && Not[IntegerQ[p]]
Int[(e_.*x_)^m_.*Sech[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Sech[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[(e_.*x_)^m_.*Csch[d_.*(a_. + b_.*Log[c_.*x_^n_.])]^p_., x_Symbol] := (e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n))* Subst[Int[x^((m + 1)/n - 1)*Csch[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Sinh[a_.*x_*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := Cosh[a*x*Log[b*x]]/a - Int[Sinh[a*x*Log[b*x]], x] /; FreeQ[{a, b}, x]
Int[Cosh[a_.*x_*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := Sinh[a*x*Log[b*x]]/a - Int[Cosh[a*x*Log[b*x]], x] /; FreeQ[{a, b}, x]
Int[x_^m_.*Sinh[a_.*x_^n_.*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := Cosh[a*x^n*Log[b*x]]/(a*n) - 1/n*Int[x^m*Sinh[a*x^n*Log[b*x]], x] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]
Int[x_^m_.*Cosh[a_.*x_^n_.*Log[b_.*x_]]*Log[b_.*x_], x_Symbol] := Sinh[a*x^n*Log[b*x]]/(a*n) - 1/n*Int[x^m*Cosh[a*x^n*Log[b*x]], x] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]

(*FILE: 
Rubi/IntegrationRules/6 Hyperbolic functions/6.7 Miscellaneous/6.7.9 Active hyperbolic functions.m
*)

(* ::Subsection::Closed:: *)
(* 6.7.9 Active hyperbolic functions *)
Int[(e_. + f_.*x_)^m_.* Sinh[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sinh[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Sinh[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Cosh[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Cosh[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Cosh[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Cosh[c_. + d_.*x_]/(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := -(e + f*x)^(m + 1)/(b*f*(m + 1)) + 2*Int[(e + f*x)^m*E^(c + d*x)/(a + b*E^(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[a^2 + b^2, 0]
Int[(e_. + f_.*x_)^m_.* Sinh[c_. + d_.*x_]/(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := -(e + f*x)^(m + 1)/(b*f*(m + 1)) + 2*Int[(e + f*x)^m*E^(c + d*x)/(a + b*E^(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Cosh[c_. + d_.*x_]/(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := -(e + f*x)^(m + 1)/(b*f*(m + 1)) + Int[(e + f*x)^m* E^(c + d*x)/(a - Rt[a^2 + b^2, 2] + b*E^(c + d*x)), x] + Int[(e + f*x)^m* E^(c + d*x)/(a + Rt[a^2 + b^2, 2] + b*E^(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 + b^2, 0]
Int[(e_. + f_.*x_)^m_.* Sinh[c_. + d_.*x_]/(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := -(e + f*x)^(m + 1)/(b*f*(m + 1)) + Int[(e + f*x)^m* E^(c + d*x)/(a - Rt[a^2 - b^2, 2] + b*E^(c + d*x)), x] + Int[(e + f*x)^m* E^(c + d*x)/(a + Rt[a^2 - b^2, 2] + b*E^(c + d*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Cosh[c_. + d_.*x_]^n_/(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Cosh[c + d*x]^(n - 2), x] + 1/b*Int[(e + f*x)^m*Cosh[c + d*x]^(n - 2)*Sinh[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 1] && EqQ[a^2 + b^2, 0]
Int[(e_. + f_.*x_)^m_.* Sinh[c_. + d_.*x_]^n_/(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := -1/a*Int[(e + f*x)^m*Sinh[c + d*x]^(n - 2), x] + 1/b*Int[(e + f*x)^m*Sinh[c + d*x]^(n - 2)*Cosh[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 1] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Cosh[c_. + d_.*x_]^n_/(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := -a/b^2*Int[(e + f*x)^m*Cosh[c + d*x]^(n - 2), x] + 1/b*Int[(e + f*x)^m*Cosh[c + d*x]^(n - 2)*Sinh[c + d*x], x] + (a^2 + b^2)/b^2* Int[(e + f*x)^m*Cosh[c + d*x]^(n - 2)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 1] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.* Sinh[c_. + d_.*x_]^n_/(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := -a/b^2*Int[(e + f*x)^m*Sinh[c + d*x]^(n - 2), x] + 1/b*Int[(e + f*x)^m*Sinh[c + d*x]^(n - 2)*Cosh[c + d*x], x] + (a^2 - b^2)/b^2* Int[(e + f*x)^m*Sinh[c + d*x]^(n - 2)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 1] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.* Tanh[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sech[c + d*x]*Tanh[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Sech[c + d*x]* Tanh[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Coth[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Csch[c + d*x]*Coth[c + d*x]^(n - 1), x] - a/b*Int[(e + f*x)^m*Csch[c + d*x]* Coth[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Coth[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Coth[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Cosh[c + d*x]* Coth[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Tanh[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Tanh[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Sinh[c + d*x]* Tanh[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Sech[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sech[c + d*x]^(n + 2), x] + 1/b*Int[(e + f*x)^m*Sech[c + d*x]^(n + 1)*Tanh[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && EqQ[a^2 + b^2, 0]
Int[(e_. + f_.*x_)^m_.* Csch[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := -1/a*Int[(e + f*x)^m*Csch[c + d*x]^(n + 2), x] + 1/b*Int[(e + f*x)^m*Csch[c + d*x]^(n + 1)*Coth[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[(e_. + f_.*x_)^m_.* Sech[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := b^2/(a^2 + b^2)* Int[(e + f*x)^m*Sech[c + d*x]^(n - 2)/(a + b*Sinh[c + d*x]), x] + 1/(a^2 + b^2)* Int[(e + f*x)^m*Sech[c + d*x]^n*(a - b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 + b^2, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Csch[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := b^2/(a^2 - b^2)* Int[(e + f*x)^m*Csch[c + d*x]^(n - 2)/(a + b*Cosh[c + d*x]), x] + 1/(a^2 - b^2)* Int[(e + f*x)^m*Csch[c + d*x]^n*(a - b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Csch[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Csch[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Csch[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* Sech[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sech[c + d*x]^n, x] - b/a*Int[(e + f*x)^m*Sech[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*F[c + d*x]^n/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && HyperbolicQ[F]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*F[c + d*x]^n/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && HyperbolicQ[F]
Int[(e_. + f_.*x_)^m_.*Cosh[c_. + d_.*x_]^p_.* Sinh[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Cosh[c + d*x]^p*Sinh[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Cosh[c + d*x]^p* Sinh[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sinh[c_. + d_.*x_]^p_.* Cosh[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sinh[c + d*x]^p*Cosh[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Sinh[c + d*x]^p* Cosh[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sinh[c_. + d_.*x_]^p_.* Tanh[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sinh[c + d*x]^(p - 1)*Tanh[c + d*x]^n, x] - a/b* Int[(e + f*x)^m*Sinh[c + d*x]^(p - 1)* Tanh[c + d*x]^n/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Cosh[c_. + d_.*x_]^p_.* Coth[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Cosh[c + d*x]^(p - 1)*Coth[c + d*x]^n, x] - a/b* Int[(e + f*x)^m*Cosh[c + d*x]^(p - 1)* Coth[c + d*x]^n/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sech[c_. + d_.*x_]^p_.* Tanh[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Sech[c + d*x]^(p + 1)*Tanh[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Sech[c + d*x]^(p + 1)* Tanh[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Csch[c_. + d_.*x_]^p_.* Coth[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/b*Int[(e + f*x)^m*Csch[c + d*x]^(p + 1)*Coth[c + d*x]^(n - 1), x] - a/b* Int[(e + f*x)^m*Csch[c + d*x]^(p + 1)* Coth[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Cosh[c_. + d_.*x_]^p_.* Coth[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Cosh[c + d*x]^p*Coth[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Cosh[c + d*x]^(p + 1)* Coth[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sinh[c_. + d_.*x_]^p_.* Tanh[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sinh[c + d*x]^p*Tanh[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Sinh[c + d*x]^(p + 1)* Tanh[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Csch[c_. + d_.*x_]^p_.* Coth[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Csch[c + d*x]^p*Coth[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Csch[c + d*x]^(p - 1)* Coth[c + d*x]^n/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sech[c_. + d_.*x_]^p_.* Tanh[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sech[c + d*x]^p*Tanh[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Sech[c + d*x]^(p - 1)* Tanh[c + d*x]^n/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Sech[c_. + d_.*x_]^p_.* Csch[c_. + d_.*x_]^n_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Sech[c + d*x]^p*Csch[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Sech[c + d*x]^p* Csch[c + d*x]^(n - 1)/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*Csch[c_. + d_.*x_]^p_.* Sech[c_. + d_.*x_]^n_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := 1/a*Int[(e + f*x)^m*Csch[c + d*x]^p*Sech[c + d*x]^n, x] - b/a* Int[(e + f*x)^m*Csch[c + d*x]^p* Sech[c + d*x]^(n - 1)/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*F_[c_. + d_.*x_]^n_.* G_[c_. + d_.*x_]^p_./(a_ + b_.*Sinh[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*F[c + d*x]^n* G[c + d*x]^p/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && HyperbolicQ[F] && HyperbolicQ[G]
Int[(e_. + f_.*x_)^m_.*F_[c_. + d_.*x_]^n_.* G_[c_. + d_.*x_]^p_./(a_ + b_.*Cosh[c_. + d_.*x_]), x_Symbol] := Unintegrable[(e + f*x)^m*F[c + d*x]^n* G[c + d*x]^p/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && HyperbolicQ[F] && HyperbolicQ[G]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Sech[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Cosh[c + d*x]*F[c + d*x]^n/(b + a*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && HyperbolicQ[F] && IntegersQ[m, n]
Int[(e_. + f_.*x_)^m_.* F_[c_. + d_.*x_]^n_./(a_ + b_.*Csch[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Sinh[c + d*x]*F[c + d*x]^n/(b + a*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && HyperbolicQ[F] && IntegersQ[m, n]
Int[(e_. + f_.*x_)^m_.*F_[c_. + d_.*x_]^n_.* G_[c_. + d_.*x_]^p_./(a_ + b_.*Sech[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Cosh[c + d*x]*F[c + d*x]^n* G[c + d*x]^p/(b + a*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && HyperbolicQ[F] && HyperbolicQ[G] && IntegersQ[m, n, p]
Int[(e_. + f_.*x_)^m_.*F_[c_. + d_.*x_]^n_.* G_[c_. + d_.*x_]^p_./(a_ + b_.*Csch[c_. + d_.*x_]), x_Symbol] := Int[(e + f*x)^m*Sinh[c + d*x]*F[c + d*x]^n* G[c + d*x]^p/(b + a*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && HyperbolicQ[F] && HyperbolicQ[G] && IntegersQ[m, n, p]
Int[Sinh[a_. + b_.*x_]^p_.*Sinh[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(-E^(-c - d*x) + E^(c + d*x))^ q, (-E^(-a - b*x) + E^(a + b*x))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Cosh[a_. + b_.*x_]^p_.*Cosh[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(E^(-c - d*x) + E^(c + d*x))^ q, (E^(-a - b*x) + E^(a + b*x))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Sinh[a_. + b_.*x_]^p_.*Cosh[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(E^(-c - d*x) + E^(c + d*x))^ q, (-E^(-a - b*x) + E^(a + b*x))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Cosh[a_. + b_.*x_]^p_.*Sinh[c_. + d_.*x_]^q_., x_Symbol] := 1/2^(p + q)* Int[ExpandIntegrand[(-E^(-c - d*x) + E^(c + d*x))^ q, (E^(-a - b*x) + E^(a + b*x))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] && Not[IntegerQ[q]]
Int[Sinh[a_. + b_.*x_]*Tanh[c_. + d_.*x_], x_Symbol] := Int[-E^(-(a + b*x))/2 + E^(a + b*x)/2 + E^(-(a + b*x))/(1 + E^(2*(c + d*x))) - E^(a + b*x)/(1 + E^(2*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Cosh[a_. + b_.*x_]*Coth[c_. + d_.*x_], x_Symbol] := Int[E^(-(a + b*x))/2 + E^(a + b*x)/2 - E^(-(a + b*x))/(1 - E^(2*(c + d*x))) - E^(a + b*x)/(1 - E^(2*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Sinh[a_. + b_.*x_]*Coth[c_. + d_.*x_], x_Symbol] := Int[-E^(-(a + b*x))/2 + E^(a + b*x)/2 + E^(-(a + b*x))/(1 - E^(2*(c + d*x))) - E^(a + b*x)/(1 - E^(2*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Cosh[a_. + b_.*x_]*Tanh[c_. + d_.*x_], x_Symbol] := Int[E^(-(a + b*x))/2 + E^(a + b*x)/2 - E^(-(a + b*x))/(1 + E^(2*(c + d*x))) - E^(a + b*x)/(1 + E^(2*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Sinh[a_./(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Sinh[a*x]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, c, d}, x] && IGtQ[n, 0]
Int[Cosh[a_./(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Cosh[a*x]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, c, d}, x] && IGtQ[n, 0]
Int[Sinh[e_.*(a_. + b_.*x_)/(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Sinh[b*e/d - e*(b*c - a*d)*x/d]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && NeQ[b*c - a*d, 0]
Int[Cosh[e_.*(a_. + b_.*x_)/(c_. + d_.*x_)]^n_., x_Symbol] := -1/d*Subst[Int[Cosh[b*e/d - e*(b*c - a*d)*x/d]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && NeQ[b*c - a*d, 0]
Int[Sinh[u_]^n_., x_Symbol] := With[{lst = QuotientOfLinearsParts[u, x]}, Int[Sinh[(lst[[1]] + lst[[2]]*x)/(lst[[3]] + lst[[4]]*x)]^n, x]] /; IGtQ[n, 0] && QuotientOfLinearsQ[u, x]
Int[Cosh[u_]^n_., x_Symbol] := With[{lst = QuotientOfLinearsParts[u, x]}, Int[Cosh[(lst[[1]] + lst[[2]]*x)/(lst[[3]] + lst[[4]]*x)]^n, x]] /; IGtQ[n, 0] && QuotientOfLinearsQ[u, x]
Int[u_.*Sinh[v_]^p_.*Sinh[w_]^q_., x_Symbol] := Int[u*Sinh[v]^(p + q), x] /; EqQ[w, v]
Int[u_.*Cosh[v_]^p_.*Cosh[w_]^q_., x_Symbol] := Int[u*Cosh[v]^(p + q), x] /; EqQ[w, v]
Int[Sinh[v_]^p_.*Sinh[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[Sinh[v]^p*Sinh[w]^q, x], x] /; IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[Cosh[v_]^p_.*Cosh[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[Cosh[v]^p*Cosh[w]^q, x], x] /; IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[x_^m_.*Sinh[v_]^p_.*Sinh[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[x^m, Sinh[v]^p*Sinh[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[x_^m_.*Cosh[v_]^p_.*Cosh[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[x^m, Cosh[v]^p*Cosh[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[u_.*Sinh[v_]^p_.*Cosh[w_]^p_., x_Symbol] := 1/2^p*Int[u*Sinh[2*v]^p, x] /; EqQ[w, v] && IntegerQ[p]
Int[Sinh[v_]^p_.*Cosh[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[Sinh[v]^p*Cosh[w]^q, x], x] /; IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[x_^m_.*Sinh[v_]^p_.*Cosh[w_]^q_., x_Symbol] := Int[ExpandTrigReduce[x^m, Sinh[v]^p*Cosh[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && (PolynomialQ[v, x] && PolynomialQ[w, x] || BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])
Int[Sinh[v_]*Tanh[w_]^n_., x_Symbol] := Int[Cosh[v]*Tanh[w]^(n - 1), x] - Cosh[v - w]*Int[Sech[w]*Tanh[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Cosh[v_]*Coth[w_]^n_., x_Symbol] := Int[Sinh[v]*Coth[w]^(n - 1), x] + Cosh[v - w]*Int[Csch[w]*Coth[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Sinh[v_]*Coth[w_]^n_., x_Symbol] := Int[Cosh[v]*Coth[w]^(n - 1), x] + Sinh[v - w]*Int[Csch[w]*Coth[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Cosh[v_]*Tanh[w_]^n_., x_Symbol] := Int[Sinh[v]*Tanh[w]^(n - 1), x] - Sinh[v - w]*Int[Sech[w]*Tanh[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Sinh[v_]*Sech[w_]^n_., x_Symbol] := Cosh[v - w]*Int[Tanh[w]*Sech[w]^(n - 1), x] + Sinh[v - w]*Int[Sech[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Cosh[v_]*Csch[w_]^n_., x_Symbol] := Cosh[v - w]*Int[Coth[w]*Csch[w]^(n - 1), x] + Sinh[v - w]*Int[Csch[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Sinh[v_]*Csch[w_]^n_., x_Symbol] := Sinh[v - w]*Int[Coth[w]*Csch[w]^(n - 1), x] + Cosh[v - w]*Int[Csch[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[Cosh[v_]*Sech[w_]^n_., x_Symbol] := Sinh[v - w]*Int[Tanh[w]*Sech[w]^(n - 1), x] + Cosh[v - w]*Int[Sech[w]^(n - 1), x] /; GtQ[n, 0] && NeQ[w, v] && FreeQ[v - w, x]
Int[(e_. + f_.*x_)^ m_.*(a_ + b_.*Sinh[c_. + d_.*x_]*Cosh[c_. + d_.*x_])^n_., x_Symbol] := Int[(e + f*x)^m*(a + b*Sinh[2*c + 2*d*x]/2)^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[x_^m_.*(a_ + b_.*Sinh[c_. + d_.*x_]^2)^n_, x_Symbol] := 1/2^n*Int[x^m*(2*a - b + b*Cosh[2*c + 2*d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a - b, 0] && IGtQ[m, 0] && ILtQ[n, 0] && (EqQ[n, -1] || EqQ[m, 1] && EqQ[n, -2])
Int[x_^m_.*(a_ + b_.*Cosh[c_. + d_.*x_]^2)^n_, x_Symbol] := 1/2^n*Int[x^m*(2*a + b + b*Cosh[2*c + 2*d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a - b, 0] && IGtQ[m, 0] && ILtQ[n, 0] && (EqQ[n, -1] || EqQ[m, 1] && EqQ[n, -2])
Int[(f_. + g_.*x_)^ m_./(a_. + b_.*Cosh[d_. + e_.*x_]^2 + c_.*Sinh[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b - c + (b + c)*Cosh[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[(f_. + g_.*x_)^m_.* Sech[d_. + e_.*x_]^2/(b_ + c_.*Tanh[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(b - c + (b + c)*Cosh[2*d + 2*e*x]), x] /; FreeQ[{b, c, d, e, f, g}, x] && IGtQ[m, 0]
Int[(f_. + g_.*x_)^m_.* Sech[d_. + e_.*x_]^2/(b_. + a_.*Sech[d_. + e_.*x_]^2 + c_.*Tanh[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b - c + (b + c)*Cosh[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[(f_. + g_.*x_)^m_.* Csch[d_. + e_.*x_]^2/(c_ + b_.*Coth[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(b - c + (b + c)*Cosh[2*d + 2*e*x]), x] /; FreeQ[{b, c, d, e, f, g}, x] && IGtQ[m, 0]
Int[(f_. + g_.*x_)^m_.* Csch[d_. + e_.*x_]^2/(c_. + b_.*Coth[d_. + e_.*x_]^2 + a_.*Csch[d_. + e_.*x_]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b - c + (b + c)*Cosh[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[(e_. + f_.*x_)*(A_ + B_.*Sinh[c_. + d_.*x_])/(a_ + b_.*Sinh[c_. + d_.*x_])^2, x_Symbol] := B*(e + f*x)*Cosh[c + d*x]/(a*d*(a + b*Sinh[c + d*x])) - B*f/(a*d)*Int[Cosh[c + d*x]/(a + b*Sinh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[a*A + b*B, 0]
Int[(e_. + f_.*x_)*(A_ + B_.*Cosh[c_. + d_.*x_])/(a_ + b_.*Cosh[c_. + d_.*x_])^2, x_Symbol] := B*(e + f*x)*Sinh[c + d*x]/(a*d*(a + b*Cosh[c + d*x])) - B*f/(a*d)*Int[Sinh[c + d*x]/(a + b*Cosh[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[a*A - b*B, 0]
Int[(e_. + f_.*x_)^m_.*Sinh[a_. + b_.*(c_ + d_.*x_)^n_]^p_., x_Symbol] := 1/d^(m + 1)* Subst[Int[(d*e - c*f + f*x)^m*Sinh[a + b*x^n]^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && RationalQ[p]
Int[(e_. + f_.*x_)^m_.*Cosh[a_. + b_.*(c_ + d_.*x_)^n_]^p_., x_Symbol] := 1/d^(m + 1)* Subst[Int[(d*e - c*f + f*x)^m*Cosh[a + b*x^n]^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && RationalQ[p]
Int[Sech[v_]^m_.*(a_ + b_.*Tanh[v_])^n_., x_Symbol] := Int[(a*Cosh[v] + b*Sinh[v])^n, x] /; FreeQ[{a, b}, x] && IntegerQ[(m - 1)/2] && EqQ[m + n, 0]
Int[Csch[v_]^m_.*(a_ + b_.*Coth[v_])^n_., x_Symbol] := Int[(b*Cosh[v] + a*Sinh[v])^n, x] /; FreeQ[{a, b}, x] && IntegerQ[(m - 1)/2] && EqQ[m + n, 0]
Int[u_.*Sinh[a_. + b_.*x_]^m_.*Sinh[c_. + d_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[u, Sinh[a + b*x]^m*Sinh[c + d*x]^n, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[u_.*Cosh[a_. + b_.*x_]^m_.*Cosh[c_. + d_.*x_]^n_., x_Symbol] := Int[ExpandTrigReduce[u, Cosh[a + b*x]^m*Cosh[c + d*x]^n, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[Sech[a_. + b_.*x_]*Sech[c_ + d_.*x_], x_Symbol] := -Csch[(b*c - a*d)/d]*Int[Tanh[a + b*x], x] + Csch[(b*c - a*d)/b]*Int[Tanh[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Csch[a_. + b_.*x_]*Csch[c_ + d_.*x_], x_Symbol] := Csch[(b*c - a*d)/b]*Int[Coth[a + b*x], x] - Csch[(b*c - a*d)/d]*Int[Coth[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Tanh[a_. + b_.*x_]*Tanh[c_ + d_.*x_], x_Symbol] := b*x/d - b/d*Cosh[(b*c - a*d)/d]*Int[Sech[a + b*x]*Sech[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Coth[a_. + b_.*x_]*Coth[c_ + d_.*x_], x_Symbol] := b*x/d + Cosh[(b*c - a*d)/d]*Int[Csch[a + b*x]*Csch[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[u_.*(a_.*Cosh[v_] + b_.*Sinh[v_])^n_., x_Symbol] := Int[u*(a*E^(a/b*v))^n, x] /; FreeQ[{a, b, n}, x] && EqQ[a^2 - b^2, 0]
Int[Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := -1/2*Int[E^(-d*(a + b*Log[c*x^n])^2), x] + 1/2*Int[E^(d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, n}, x]
Int[Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := 1/2*Int[E^(-d*(a + b*Log[c*x^n])^2), x] + 1/2*Int[E^(d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, n}, x]
Int[(e_.*x_)^m_.*Sinh[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := -1/2*Int[(e*x)^m*E^(-d*(a + b*Log[c*x^n])^2), x] + 1/2*Int[(e*x)^m*E^(d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*Cosh[d_.*(a_. + b_.*Log[c_.*x_^n_.])^2], x_Symbol] := 1/2*Int[(e*x)^m*E^(-d*(a + b*Log[c*x^n])^2), x] + 1/2*Int[(e*x)^m*E^(d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.1 Inverse hyperbolic sine/7.1.1 (a+b arcsinh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.1.1 (a+b arcsinh(c x))^n *)
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := x*(a + b*ArcSinh[c*x])^n - b*c*n*Int[x*(a + b*ArcSinh[c*x])^(n - 1)/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c}, x] && GtQ[n, 0]
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := Sqrt[1 + c^2*x^2]*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*(n + 1)) - c/(b*(n + 1))* Int[x*(a + b*ArcSinh[c*x])^(n + 1)/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c}, x] && LtQ[n, -1]
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := 1/(b*c)* Subst[Int[x^n*Cosh[-a/b + x/b], x], x, a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.1 Inverse hyperbolic sine/7.1.2 (d x)^m (a+b arcsinh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.1.2 (d x)^m (a+b arcsinh(c x))^n *)
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_./x_, x_Symbol] := 1/b*Subst[Int[x^n*Coth[-a/b + x/b], x], x, a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[n, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (d*x)^(m + 1)*(a + b*ArcSinh[c*x])^n/(d*(m + 1)) - b*c*n/(d*(m + 1))* Int[(d*x)^(m + 1)*(a + b*ArcSinh[c*x])^(n - 1)/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := x^(m + 1)*(a + b*ArcSinh[c*x])^n/(m + 1) - b*c*n/(m + 1)* Int[x^(m + 1)*(a + b*ArcSinh[c*x])^(n - 1)/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := x^m*Sqrt[ 1 + c^2*x^2]*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*(n + 1)) - 1/(b^2*c^(m + 1)*(n + 1))* Subst[ Int[ExpandTrigReduce[x^(n + 1), Sinh[-a/b + x/b]^(m - 1)*(m + (m + 1)*Sinh[-a/b + x/b]^2), x], x], x, a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GeQ[n, -2] && LtQ[n, -1]
Int[x_^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := x^m*Sqrt[ 1 + c^2*x^2]*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*(n + 1)) - m/(b*c*(n + 1))* Int[x^(m - 1)*(a + b*ArcSinh[c*x])^(n + 1)/Sqrt[1 + c^2*x^2], x] - c*(m + 1)/(b*(n + 1))* Int[x^(m + 1)*(a + b*ArcSinh[c*x])^(n + 1)/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && LtQ[n, -2]
Int[x_^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := 1/(b*c^(m + 1))* Subst[Int[x^n*Sinh[-a/b + x/b]^m*Cosh[-a/b + x/b], x], x, a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[m, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.1 Inverse hyperbolic sine/7.1.3 (d+e x^2)^p (a+b arcsinh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.1.3 (d+e x^2)^p (a+b arcsinh(c x))^n *)
(* Int[(a_.+b_.*ArcSinh[c_.*x_])^n_./Sqrt[d_+e_.*x_^2],x_Symbol] := 1/c*Simp[Sqrt[1+c^2*x^2]/Sqrt[d+e*x^2]]*Subst[Int[(a+b*x)^n,x],x, ArcSinh[c*x]] /; FreeQ[{a,b,c,d,e,n},x] && EqQ[e,c^2*d] *)
Int[1/(Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSinh[c_.*x_])), x_Symbol] := 1/(b*c)*Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]* Log[a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d]
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(b*c*(n + 1))* Simp[Sqrt[1 + c^2*x^2]/ Sqrt[d + e*x^2]]*(a + b*ArcSinh[c*x])^(n + 1) /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[e, c^2*d] && NeQ[n, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0]
Int[Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := x*Sqrt[d + e*x^2]*(a + b*ArcSinh[c*x])^n/2 - b*c*n/2*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[x*(a + b*ArcSinh[c*x])^(n - 1), x] + 1/2*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[(a + b*ArcSinh[c*x])^n/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := x*(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n/(2*p + 1) + 2*d*p/(2*p + 1)* Int[(d + e*x^2)^(p - 1)*(a + b*ArcSinh[c*x])^n, x] - b*c*n/(2*p + 1)*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[x*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_./(d_ + e_.*x_^2)^(3/2), x_Symbol] := x*(a + b*ArcSinh[c*x])^n/(d*Sqrt[d + e*x^2]) - b*c*n/d*Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]* Int[x*(a + b*ArcSinh[c*x])^(n - 1)/(1 + c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := -x*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^n/(2*d*(p + 1)) + (2*p + 3)/(2*d*(p + 1))* Int[(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^n, x] + b*c*n/(2*(p + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[x*(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := 1/(c*d)*Subst[Int[(a + b*x)^n*Sech[x], x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[n, 0]
(* Int[(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcSinh[c_.*x_])^n_,x_Symbol] := d^p*(1+c^2*x^2)^(p+1/2)*(a+b*ArcSinh[c*x])^(n+1)/(b*c*(n+1)) - c*d^p*(2*p+1)/(b*(n+1))*Int[x*(1+c^2*x^2)^(p-1/2)*(a+b*ArcSinh[c*x]) ^(n+1),x] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[e,c^2*d] && LtQ[n,-1] && (IntegerQ[p] ||  GtQ[d,0]) *)
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := Simp[Sqrt[1 + c^2*x^2]*(d + e*x^2)^ p]*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*(n + 1)) - c*(2*p + 1)/(b*(n + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[x*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && LtQ[n, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := 1/(b*c)*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Subst[Int[x^n*Cosh[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[e, c^2*d] && IGtQ[2*p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[e, c^2*d] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSinh[c*x])^n, (d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && NeQ[e, c^2*d] && IntegerQ[p] && (p > 0 || IGtQ[n, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Unintegrable[(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, n, p}, x]
Int[(d_ + e_.*x_)^p_*(f_ + g_.*x_)^q_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^q* Int[(d + e*x)^(p - q)*(1 + c^2*x^2)^q*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 + e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0] && GtQ[d, 0] && LtQ[g/e, 0]
Int[(d_ + e_.*x_)^p_*(f_ + g_.*x_)^q_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (d + e*x)^q*(f + g*x)^q/(1 + c^2*x^2)^q* Int[(d + e*x)^(p - q)*(1 + c^2*x^2)^q*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 + e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.1 Inverse hyperbolic sine/7.1.4 (f x)^m (d+e x^2)^p (a+b arcsinh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.1.4 (f x)^m (d+e x^2)^p (a+b arcsinh(c x))^n *)
Int[x_*(a_. + b_.*ArcSinh[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := 1/e*Subst[Int[(a + b*x)^n*Tanh[x], x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[n, 0]
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^n/(2*e*(p + 1)) - b*n/(2*c*(p + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_./(x_*(d_ + e_.*x_^2)), x_Symbol] := 1/d*Subst[Int[(a + b*x)^n/(Cosh[x]*Sinh[x]), x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[n, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^ n/(d*f*(m + 1)) - b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && EqQ[m + 2*p + 3, 0] && NeQ[m, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])/x_, x_Symbol] := (d + e*x^2)^p*(a + b*ArcSinh[c*x])/(2*p) - b*c*d^p/(2*p)*Int[(1 + c^2*x^2)^(p - 1/2), x] + d*Int[(d + e*x^2)^(p - 1)*(a + b*ArcSinh[c*x])/x, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcSinh[c*x])/(f*(m + 1)) - b*c*d^p/(f*(m + 1))* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p - 1/2), x] - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcSinh[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && IGtQ[p, 0] && ILtQ[(m + 1)/2, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && IGtQ[p, 0]
Int[x_^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSinh[c*x], u] - b*c*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[SimplifyIntegrand[u/Sqrt[d + e*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IntegerQ[p - 1/2] && NeQ[p, -1/2] && (IGtQ[(m + 1)/2, 0] || ILtQ[(m + 2*p + 3)/2, 0])
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcSinh[c*x])^n/(f*(m + 1)) - b*c*n/(f*(m + 1))*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[(f*x)^(m + 1)*(a + b*ArcSinh[c*x])^(n - 1), x] - c^2/(f^2*(m + 1))*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[(f*x)^(m + 2)*(a + b*ArcSinh[c*x])^n/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcSinh[c*x])^n/(f*(m + 2)) - b*c*n/(f*(m + 2))*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[(f*x)^(m + 1)*(a + b*ArcSinh[c*x])^(n - 1), x] + 1/(m + 2)*Simp[Sqrt[d + e*x^2]/Sqrt[1 + c^2*x^2]]* Int[(f*x)^m*(a + b*ArcSinh[c*x])^n/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && IGtQ[n, 0] && (IGtQ[m, -2] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n/(f*(m + 1)) - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcSinh[c*x])^n, x] - b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^ p*(a + b*ArcSinh[c*x])^n/(f*(m + 2*p + 1)) + 2*d*p/(m + 2*p + 1)* Int[(f*x)^m*(d + e*x^2)^(p - 1)*(a + b*ArcSinh[c*x])^n, x] - b*c*n/(f*(m + 2*p + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && GtQ[p, 0] && Not[LtQ[m, -1]]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^ n/(d*f*(m + 1)) - c^2*(m + 2*p + 3)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n, x] - b*c*n/(f*(m + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && ILtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^ n/(2*e*(p + 1)) - f^2*(m - 1)/(2*e*(p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^n, x] - b*f*n/(2*c*(p + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && LtQ[p, -1] && IGtQ[m, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := -(f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^ n/(2*d*f*(p + 1)) + (m + 2*p + 3)/(2*d*(p + 1))* Int[(f*x)^m*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^n, x] + b*c*n/(2*f*(p + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && LtQ[p, -1] && Not[GtQ[m, 1]] && (IntegerQ[m] || IntegerQ[p] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])^ n/(e*(m + 2*p + 1)) - f^2*(m - 1)/(c^2*(m + 2*p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n, x] - b*f*n/(c*(m + 2*p + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 + c^2*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && IGtQ[m, 1] && NeQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := (f*x)^m* Sqrt[1 + c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*(n + 1)) - f*m/(b*c*(n + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[e, c^2*d] && LtQ[n, -1] && EqQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := (f*x)^m* Sqrt[1 + c^2*x^2]*(d + e*x^2)^ p*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*(n + 1)) - f*m/(b*c*(n + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m - 1)*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n + 1), x] - c*(m + 2*p + 1)/(b*f*(n + 1))* Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f*x)^(m + 1)*(1 + c^2*x^2)^(p - 1/2)*(a + b*ArcSinh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && LtQ[n, -1] && IGtQ[2*p, 0] && NeQ[m + 2*p + 1, 0] && IGtQ[m, -3]
(* Int[(f_.*x_)^m_.*(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcSinh[c_.*x_])^n_,x_ Symbol] := (f*x)^m*Simp[Sqrt[1+c^2*x^2]*(d+e*x^2)^p]*(a+b*ArcSinh[c*x])^(n+1)/( b*c*(n+1)) - f*m/(b*c*(n+1))*Simp[(d+e*x^2)^p/(1+c^2*x^2)^p]*Int[(f*x)^(m-1)*(1+ c^2*x^2)^(p+1/2)*(a+b*ArcSinh[c*x])^(n+1),x] - c*(2*p+1)/(b*f*(n+1))*Simp[(d+e*x^2)^p/(1+c^2*x^2)^p]*Int[(f*x)^(m+ 1)*(1+c^2*x^2)^(p-1/2)*(a+b*ArcSinh[c*x])^(n+1),x] /; FreeQ[{a,b,c,d,e,f,m,p},x] && EqQ[e,c^2*d] && LtQ[n,-1] &&  IntegerQ[2*p] && NeQ[p,-1/2] && IGtQ[m,-3] *)
Int[(f_.*x_)^m_*(a_. + b_.*ArcSinh[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcSinh[c*x])^n/(e*m) - b*f*n/(c*m)*Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcSinh[c*x])^(n - 1), x] - f^2*(m - 1)/(c^2*m)* Int[((f*x)^(m - 2)*(a + b*ArcSinh[c*x])^n)/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[e, c^2*d] && GtQ[n, 0] && IGtQ[m, 1]
Int[x_^m_*(a_. + b_.*ArcSinh[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/c^(m + 1)*Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]* Subst[Int[(a + b*x)^n*Sinh[x]^m, x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[e, c^2*d] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_.*x_)^m_*(a_. + b_.*ArcSinh[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))* Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]*(a + b*ArcSinh[c*x])* Hypergeometric2F1[1/2, (1 + m)/2, (3 + m)/2, -c^2*x^2] - b*c*(f*x)^(m + 2)/(f^2*(m + 1)*(m + 2))* Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]* HypergeometricPFQ[{1, 1 + m/2, 1 + m/2}, {3/2 + m/2, 2 + m/2}, -c^2*x^2] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^m/(b*c*(n + 1))* Simp[Sqrt[1 + c^2*x^2]/ Sqrt[d + e*x^2]]*(a + b*ArcSinh[c*x])^(n + 1) - f*m/(b*c*(n + 1))*Simp[Sqrt[1 + c^2*x^2]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcSinh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[e, c^2*d] && LtQ[n, -1]
Int[x_^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := 1/(b*c^(m + 1))*Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Subst[ Int[x^n*Sinh[-a/b + x/b]^m*Cosh[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[e, c^2*d] && IGtQ[2*p + 2, 0] && IGtQ[m, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSinh[c*x])^n/ Sqrt[d + e*x^2], (f*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[e, c^2*d] && IGtQ[p + 1/2, 0] && Not[IGtQ[(m + 1)/2, 0]] && (EqQ[m, -1] || EqQ[m, -2])
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcSinh[c*x])/(2*e*(p + 1)) - b*c/(2*e*(p + 1))*Int[(d + e*x^2)^(p + 1)/Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[e, c^2*d] && NeQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[e, c^2*d] && IntegerQ[p] && (GtQ[p, 0] || IGtQ[(m - 1)/2, 0] && LeQ[m + p, 0])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSinh[c*x])^n, (f*x)^m*(d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[e, c^2*d] && IGtQ[n, 0] && IntegerQ[p] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(h_.*x_)^m_.*(d_ + e_.*x_)^p_*(f_ + g_.*x_)^ q_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^q* Int[(h*x)^m*(d + e*x)^(p - q)*(1 + c^2*x^2)^q*(a + b*ArcSinh[c*x])^ n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 + e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0] && GtQ[d, 0] && LtQ[g/e, 0]
Int[(h_.*x_)^m_.*(d_ + e_.*x_)^p_*(f_ + g_.*x_)^ q_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (-d^2*g/e)^IntPart[q]*(d + e*x)^ FracPart[q]*(f + g*x)^FracPart[q]/(1 + c^2*x^2)^FracPart[q]* Int[(h*x)^m*(d + e*x)^(p - q)*(1 + c^2*x^2)^ q*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e*f + d*g, 0] && EqQ[c^2*d^2 + e^2, 0] && HalfIntegerQ[p, q] && GeQ[p - q, 0]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.1 Inverse hyperbolic sine/7.1.5 u (a+b arcsinh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.1.5 u (a+b arcsinh(c x))^n *)
Int[(a_. + b_.*ArcSinh[c_.*x_])^n_./(d_. + e_.*x_), x_Symbol] := Subst[Int[(a + b*x)^n*Cosh[x]/(c*d + e*Sinh[x]), x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[n, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcSinh[c*x])^n/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[(d + e*x)^(m + 1)*(a + b*ArcSinh[c*x])^(n - 1)/ Sqrt[1 + c^2*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + b*ArcSinh[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[m, 0] && LtQ[n, -1]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := 1/c^(m + 1)* Subst[Int[(a + b*x)^n*Cosh[x]*(c*d + e*Sinh[x])^m, x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[m, 0]
Int[Px_*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[ExpandExpression[Px, x], x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c}, x] && PolynomialQ[Px, x]
(* Int[Px_*(a_.+b_.*ArcSinh[c_.*x_])^n_.,x_Symbol] := With[{u=IntHide[Px,x]}, Dist[(a+b*ArcSinh[c*x])^n,u,x] -  b*c*n*Int[SimplifyIntegrand[u*(a+b*ArcSinh[c*x])^(n-1)/Sqrt[1+c^2*x^2] ,x],x]] /; FreeQ[{a,b,c},x] && PolynomialQ[Px,x] && IGtQ[n,0] *)
Int[Px_*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[Px*(a + b*ArcSinh[c*x])^n, x], x] /; FreeQ[{a, b, c, n}, x] && PolynomialQ[Px, x]
Int[Px_*(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[Px*(d + e*x)^m, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, m}, x] && PolynomialQ[Px, x]
Int[(f_. + g_.*x_)^p_.*(d_ + e_.*x_)^m_*(a_. + b_.*ArcSinh[c_.*x_])^ n_, x_Symbol] := With[{u = IntHide[(f + g*x)^p*(d + e*x)^m, x]}, Dist[(a + b*ArcSinh[c*x])^n, u, x] - b*c*n*Int[ SimplifyIntegrand[ u*(a + b*ArcSinh[c*x])^(n - 1)/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[m, 0] && LtQ[m + p + 1, 0]
Int[(f_. + g_.*x_ + h_.*x_^2)^ p_.*(a_. + b_.*ArcSinh[c_.*x_])^n_/(d_ + e_.*x_)^2, x_Symbol] := With[{u = IntHide[(f + g*x + h*x^2)^p/(d + e*x)^2, x]}, Dist[(a + b*ArcSinh[c*x])^n, u, x] - b*c*n*Int[ SimplifyIntegrand[ u*(a + b*ArcSinh[c*x])^(n - 1)/Sqrt[1 + c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[n, 0] && IGtQ[p, 0] && EqQ[e*g - 2*d*h, 0]
Int[Px_*(d_ + e_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[Px*(d + e*x)^m*(a + b*ArcSinh[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && PolynomialQ[Px, x] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f + g*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[Dist[1/Sqrt[1 + c^2*x^2], u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && ILtQ[p + 1/2, 0] && GtQ[d, 0] && (LtQ[m, -2*p - 1] || GtQ[m, 3])
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^p*(a + b*ArcSinh[c*x])^ n, (f + g*x)^m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && IntegerQ[p + 1/2] && GtQ[d, 0] && IGtQ[n, 0] && (EqQ[n, 1] && GtQ[p, -1] || GtQ[p, 0] || EqQ[m, 1] || EqQ[m, 2] && LtQ[p, -2])
Int[(f_. + g_.*x_)^m_* Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := (f + g*x)^ m*(d + e*x^2)*(a + b*ArcSinh[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) - 1/(b*c*Sqrt[d]*(n + 1))* Int[(d*g*m + 2*e*f*x + e*g*(m + 2)*x^2)*(f + g*x)^(m - 1)*(a + b*ArcSinh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && ILtQ[m, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[ Sqrt[d + e*x^2]*(a + b*ArcSinh[c*x])^n, (f + g*x)^ m*(d + e*x^2)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && IntegerQ[m] && IGtQ[p + 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^ n_., x_Symbol] := (f + g*x)^ m*(d + e*x^2)^(p + 1/2)*(a + b*ArcSinh[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) - 1/(b*c*Sqrt[d]*(n + 1))* Int[ ExpandIntegrand[(f + g*x)^(m - 1)*(a + b*ArcSinh[c*x])^(n + 1), (d*g*m + e*f*(2*p + 1)*x + e*g*(m + 2*p + 1)*x^2)*(d + e*x^2)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && ILtQ[m, 0] && IGtQ[p - 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_/ Sqrt[d_ + e_.*x_^2], x_Symbol] := (f + g*x)^m*(a + b*ArcSinh[c*x])^(n + 1)/(b*c*Sqrt[d]*(n + 1)) - g*m/(b*c*Sqrt[d]*(n + 1))* Int[(f + g*x)^(m - 1)*(a + b*ArcSinh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && IGtQ[m, 0] && GtQ[d, 0] && LtQ[n, -1]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_./ Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(c^(m + 1)*Sqrt[d])* Subst[Int[(a + b*x)^n*(c*f + g*Sinh[x])^m, x], x, ArcSinh[c*x]] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e, c^2*d] && IntegerQ[m] && GtQ[d, 0] && (GtQ[m, 0] || IGtQ[n, 0])
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSinh[c*x])^n/ Sqrt[d + e*x^2], (f + g*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[e, c^2*d] && IntegerQ[m] && ILtQ[p + 1/2, 0] && GtQ[d, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^ n_., x_Symbol] := Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[(f + g*x)^m*(1 + c^2*x^2)^p*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[e, c^2*d] && IntegerQ[m] && IntegerQ[p - 1/2] && Not[GtQ[d, 0]]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(a_. + b_.*ArcSinh[c_.*x_])^n_./ Sqrt[d_ + e_.*x_^2], x_Symbol] := Log[h*(f + g*x)^m]*(a + b*ArcSinh[c*x])^(n + 1)/(b*c* Sqrt[d]*(n + 1)) - g*m/(b*c*Sqrt[d]*(n + 1))* Int[(a + b*ArcSinh[c*x])^(n + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && EqQ[e, c^2*d] && GtQ[d, 0] && IGtQ[n, 0]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(d_ + e_.*x_^2)^ p_*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Simp[(d + e*x^2)^p/(1 + c^2*x^2)^p]* Int[Log[h*(f + g*x)^m]*(1 + c^2*x^2)^p*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[e, c^2*d] && IntegerQ[p - 1/2] && Not[GtQ[d, 0]]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^m_*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x)^m*(f + g*x)^m, x]}, Dist[a + b*ArcSinh[c*x], u, x] - b*c*Int[Dist[1/Sqrt[1 + c^2*x^2], u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m + 1/2, 0]
Int[(d_ + e_.*x_)^m_.*(f_ + g_.*x_)^m_.*(a_. + b_.*ArcSinh[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcSinh[c*x])^ n, (d + e*x)^m*(f + g*x)^m, x], x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && IntegerQ[m]
Int[u_*(a_. + b_.*ArcSinh[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[a + b*ArcSinh[c*x], v, x] - b*c*Int[SimplifyIntegrand[v/Sqrt[1 + c^2*x^2], x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[Px_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcSinh[c_.*x_])^n_, x_Symbol] := With[{u = ExpandIntegrand[Px*(d + e*x^2)^p*(a + b*ArcSinh[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, n}, x] && PolynomialQ[Px, x] && EqQ[e, c^2*d] && IntegerQ[p - 1/2]
Int[Px_.*(f_ + g_.*(d_ + e_.*x_^2)^p_)^ m_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := With[{u = ExpandIntegrand[ Px*(f + g*(d + e*x^2)^p)^m*(a + b*ArcSinh[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, g}, x] && PolynomialQ[Px, x] && EqQ[e, c^2*d] && IGtQ[p + 1/2, 0] && IntegersQ[m, n]
Int[RFx_*ArcSinh[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[ArcSinh[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[c, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(a_ + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[RFx*(a + b*ArcSinh[c*x])^n, x], x] /; FreeQ[{a, b, c}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(d_ + e_.*x_^2)^p_*ArcSinh[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[(d + e*x^2)^p*ArcSinh[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{c, d, e}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[e, c^2*d] && IntegerQ[p - 1/2]
Int[RFx_*(d_ + e_.*x_^2)^p_*(a_ + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(d + e*x^2)^p, RFx*(a + b*ArcSinh[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[e, c^2*d] && IntegerQ[p - 1/2]
Int[u_.*(a_. + b_.*ArcSinh[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcSinh[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.1 Inverse hyperbolic sine/7.1.6 Miscellaneous inverse hyperbolic sine.m
*)

(* ::Subsection::Closed:: *)
(* 7.1.6 Miscellaneous inverse hyperbolic sine *)
Int[(a_. + b_.*ArcSinh[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcSinh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, n}, x]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSinh[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcSinh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(A_. + B_.*x_ + C_.*x_^2)^p_.*(a_. + b_.*ArcSinh[c_ + d_.*x_])^ n_., x_Symbol] := 1/d*Subst[Int[(C/d^2 + C/d^2*x^2)^p*(a + b*ArcSinh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, n, p}, x] && EqQ[B*(1 + c^2) - 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ p_.*(a_. + b_.*ArcSinh[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(C/d^2 + C/d^2*x^2)^ p*(a + b*ArcSinh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] && EqQ[B*(1 + c^2) - 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[Sqrt[a_. + b_.*ArcSinh[c_ + d_.*x_^2]], x_Symbol] := x*Sqrt[a + b*ArcSinh[c + d*x^2]] - Sqrt[Pi]*x*(Cosh[a/(2*b)] - c*Sinh[a/(2*b)])* FresnelC[Sqrt[-c/(Pi*b)]*Sqrt[a + b*ArcSinh[c + d*x^2]]]/ (Sqrt[-(c/b)]*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2])) + Sqrt[Pi]*x*(Cosh[a/(2*b)] + c*Sinh[a/(2*b)])* FresnelS[Sqrt[-c/(Pi*b)]*Sqrt[a + b*ArcSinh[c + d*x^2]]]/ (Sqrt[-(c/b)]*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1]
Int[(a_. + b_.*ArcSinh[c_ + d_.*x_^2])^n_, x_Symbol] := x*(a + b*ArcSinh[c + d*x^2])^n - 2*b*n* Sqrt[2*c*d*x^2 + d^2*x^4]*(a + b*ArcSinh[c + d*x^2])^(n - 1)/(d*x) + 4*b^2*n*(n - 1)*Int[(a + b*ArcSinh[c + d*x^2])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1] && GtQ[n, 1]
Int[1/(a_. + b_.*ArcSinh[c_ + d_.*x_^2]), x_Symbol] := x*(c*Cosh[a/(2*b)] - Sinh[a/(2*b)])* CoshIntegral[(a + b*ArcSinh[c + d*x^2])/(2*b)]/ (2* b*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[(1/2)*ArcSinh[c + d*x^2]])) + x*(Cosh[a/(2*b)] - c*Sinh[a/(2*b)])* SinhIntegral[(a + b*ArcSinh[c + d*x^2])/(2*b)]/ (2* b*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[(1/2)*ArcSinh[c + d*x^2]])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1]
Int[1/Sqrt[a_. + b_.*ArcSinh[c_ + d_.*x_^2]], x_Symbol] := (c + 1)*Sqrt[Pi/2]*x*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Erfi[Sqrt[a + b*ArcSinh[c + d*x^2]]/Sqrt[2*b]]/ (2* Sqrt[b]*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2])) + (c - 1)*Sqrt[Pi/2]*x*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Erf[Sqrt[a + b*ArcSinh[c + d*x^2]]/Sqrt[2*b]]/ (2* Sqrt[b]*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1]
Int[1/(a_. + b_.*ArcSinh[c_ + d_.*x_^2])^(3/2), x_Symbol] := -Sqrt[2*c*d*x^2 + d^2*x^4]/(b*d*x*Sqrt[a + b*ArcSinh[c + d*x^2]]) - (-c/b)^(3/2)*Sqrt[Pi]*x*(Cosh[a/(2*b)] - c*Sinh[a/(2*b)])* FresnelC[Sqrt[-c/(Pi*b)]*Sqrt[a + b*ArcSinh[c + d*x^2]]]/ (Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2]) + (-c/b)^(3/2)*Sqrt[Pi]*x*(Cosh[a/(2*b)] + c*Sinh[a/(2*b)])* FresnelS[Sqrt[-c/(Pi*b)]*Sqrt[a + b*ArcSinh[c + d*x^2]]]/ (Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2]) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1]
Int[1/(a_. + b_.*ArcSinh[c_ + d_.*x_^2])^2, x_Symbol] := -Sqrt[2*c*d*x^2 + d^2*x^4]/(2*b*d*x*(a + b*ArcSinh[c + d*x^2])) + x*(Cosh[a/(2*b)] - c*Sinh[a/(2*b)])* CoshIntegral[(a + b*ArcSinh[c + d*x^2])/(2*b)]/ (4* b^2*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2])) + x*(c*Cosh[a/(2*b)] - Sinh[a/(2*b)])* SinhIntegral[(a + b*ArcSinh[c + d*x^2])/(2*b)]/ (4* b^2*(Cosh[ArcSinh[c + d*x^2]/2] + c*Sinh[ArcSinh[c + d*x^2]/2])) /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1]
Int[(a_. + b_.*ArcSinh[c_ + d_.*x_^2])^n_, x_Symbol] := -x*(a + b*ArcSinh[c + d*x^2])^(n + 2)/(4*b^2*(n + 1)*(n + 2)) + Sqrt[ 2*c*d*x^2 + d^2*x^4]*(a + b*ArcSinh[c + d*x^2])^(n + 1)/(2*b*d*(n + 1)* x) + 1/(4*b^2*(n + 1)*(n + 2))* Int[(a + b*ArcSinh[c + d*x^2])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, -1] && LtQ[n, -1] && NeQ[n, -2]
Int[ArcSinh[a_.*x_^p_]^n_./x_, x_Symbol] := 1/p*Subst[Int[x^n*Coth[x], x], x, ArcSinh[a*x^p]] /; FreeQ[{a, p}, x] && IGtQ[n, 0]
Int[u_.*ArcSinh[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCsch[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[ArcSinh[Sqrt[-1 + b_.*x_^2]]^n_./Sqrt[-1 + b_.*x_^2], x_Symbol] := Sqrt[b*x^2]/(b*x)* Subst[Int[ArcSinh[x]^n/Sqrt[1 + x^2], x], x, Sqrt[-1 + b*x^2]] /; FreeQ[{b, n}, x]
Int[f_^(c_.*ArcSinh[a_. + b_.*x_]^n_.), x_Symbol] := 1/b*Subst[Int[f^(c*x^n)*Cosh[x], x], x, ArcSinh[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[n, 0]
Int[x_^m_.*f_^(c_.*ArcSinh[a_. + b_.*x_]^n_.), x_Symbol] := 1/b*Subst[Int[(-a/b + Sinh[x]/b)^m*f^(c*x^n)*Cosh[x], x], x, ArcSinh[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[ArcSinh[u_], x_Symbol] := x*ArcSinh[u] - Int[SimplifyIntegrand[x*D[u, x]/Sqrt[1 + u^2], x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcSinh[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcSinh[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/Sqrt[1 + u^2], x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[v_*(a_. + b_.*ArcSinh[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcSinh[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/Sqrt[1 + u^2], x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]
Int[E^(n_.*ArcSinh[u_]), x_Symbol] := Int[(u + Sqrt[1 + u^2])^n, x] /; IntegerQ[n] && PolyQ[u, x]
Int[x_^m_.*E^(n_.*ArcSinh[u_]), x_Symbol] := Int[x^m*(u + Sqrt[1 + u^2])^n, x] /; RationalQ[m] && IntegerQ[n] && PolyQ[u, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.2 Inverse hyperbolic cosine/7.2.1 (a+b arccosh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.2.1 (a+b arccosh(c x))^n *)
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := x*(a + b*ArcCosh[c*x])^n - b*c*n* Int[x*(a + b*ArcCosh[c*x])^(n - 1)/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c}, x] && GtQ[n, 0]
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1)) - c/(b*(n + 1))* Int[x*(a + b*ArcCosh[c*x])^(n + 1)/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c}, x] && LtQ[n, -1]
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := 1/(b*c)* Subst[Int[x^n*Sinh[-a/b + x/b], x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.2 Inverse hyperbolic cosine/7.2.2 (d x)^m (a+b arccosh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.2.2 (d x)^m (a+b arccosh(c x))^n *)
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_./x_, x_Symbol] := 1/b*Subst[Int[x^n*Tanh[-a/b + x/b], x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[n, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCosh[c*x])^n/(d*(m + 1)) - b*c*n/(d*(m + 1))* Int[(d*x)^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1)/(Sqrt[1 + c*x]* Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := x^(m + 1)*(a + b*ArcCosh[c*x])^n/(m + 1) - b*c*n/(m + 1)* Int[x^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1)/(Sqrt[1 + c*x]* Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := x^m*Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1)) + 1/(b^2*c^(m + 1)*(n + 1))* Subst[ Int[ExpandTrigReduce[x^(n + 1), Cosh[-a/b + x/b]^(m - 1)*(m - (m + 1)*Cosh[-a/b + x/b]^2), x], x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && GeQ[n, -2] && LtQ[n, -1]
Int[x_^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := x^m*Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1)) + m/(b*c*(n + 1))* Int[x^(m - 1)*(a + b*ArcCosh[c*x])^(n + 1)/(Sqrt[1 + c*x]* Sqrt[-1 + c*x]), x] - c*(m + 1)/(b*(n + 1))* Int[x^(m + 1)*(a + b*ArcCosh[c*x])^(n + 1)/(Sqrt[1 + c*x]* Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c}, x] && IGtQ[m, 0] && LtQ[n, -2]
Int[x_^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := 1/(b*c^(m + 1))* Subst[Int[x^n*Cosh[-a/b + x/b]^m*Sinh[-a/b + x/b], x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[m, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d, m, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.2 Inverse hyperbolic cosine/7.2.3 (d+e x^2)^p (a+b arccosh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.2.3 (d+e x^2)^p (a+b arccosh(c x))^n *)
Int[(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[(d1*d2 + e1*e2*x^2)^p*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[d2*e1 + d1*e2, 0] && IntegerQ[p]
(* Int[(a_.+b_.*ArcCosh[c_.*x_])^n_./Sqrt[d_+e_.*x_^2],x_Symbol] := 1/c*Simp[Sqrt[1+c*x]*Sqrt[-1+c*x]/Sqrt[d+e*x^2]]*Subst[Int[(a+b*x)^ n,x],x,ArcCosh[c*x]] /; FreeQ[{a,b,c,d,e,n},x] && EqQ[c^2*d+e,0] *)
Int[1/(Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCosh[c_.*x_])), x_Symbol] := 1/(b*c)*Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]* Log[a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[1/(Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]*(a_. + b_.*ArcCosh[c_.*x_])), x_Symbol] := 1/(b*c)*Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]*Log[a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2]
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(b*c*(n + 1))* Simp[Sqrt[1 + c*x]* Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]*(a + b*ArcCosh[c*x])^(n + 1) /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && NeQ[n, -1]
Int[(a_. + b_.*ArcCosh[c_.*x_])^ n_./(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := 1/(b*c*(n + 1))*Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]*(a + b*ArcCosh[c*x])^(n + 1) /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && NeQ[n, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := x*Sqrt[d + e*x^2]*(a + b*ArcCosh[c*x])^n/2 - b*c*n/2*Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[x*(a + b*ArcCosh[c*x])^(n - 1), x] - 1/2*Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[(a + b*ArcCosh[c*x])^n/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0]
Int[Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := x*Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x]*(a + b*ArcCosh[c*x])^n/2 - b*c*n/2*Simp[Sqrt[d1 + e1*x]/Sqrt[1 + c*x]]* Simp[Sqrt[d2 + e2*x]/Sqrt[-1 + c*x]]* Int[x*(a + b*ArcCosh[c*x])^(n - 1), x] - 1/2*Simp[Sqrt[d1 + e1*x]/Sqrt[1 + c*x]]* Simp[Sqrt[d2 + e2*x]/Sqrt[-1 + c*x]]* Int[(a + b*ArcCosh[c*x])^n/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := x*(d + e*x^2)^p*(a + b*ArcCosh[c*x])^n/(2*p + 1) + 2*d*p/(2*p + 1)* Int[(d + e*x^2)^(p - 1)*(a + b*ArcCosh[c*x])^n, x] - b*c*n/(2*p + 1)*Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[ x*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0]
Int[(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := x*(d1 + e1*x)^p*(d2 + e2*x)^p*(a + b*ArcCosh[c*x])^n/(2*p + 1) + 2*d1*d2*p/(2*p + 1)* Int[(d1 + e1*x)^(p - 1)*(d2 + e2*x)^(p - 1)*(a + b*ArcCosh[c*x])^ n, x] - b*c*n/(2*p + 1)*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[ x*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_./(d_ + e_.*x_^2)^(3/2), x_Symbol] := x*(a + b*ArcCosh[c*x])^n/(d*Sqrt[d + e*x^2]) + b*c*n/d*Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]* Int[x*(a + b*ArcCosh[c*x])^(n - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0]
Int[(a_. + b_.*ArcCosh[c_.*x_])^ n_./((d1_ + e1_.*x_)^(3/2)*(d2_ + e2_.*x_)^(3/2)), x_Symbol] := x*(a + b*ArcCosh[c*x])^ n/(d1*d2*Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x]) + b*c*n/(d1*d2)*Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]* Int[x*(a + b*ArcCosh[c*x])^(n - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := -x*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^n/(2*d*(p + 1)) + (2*p + 3)/(2*d*(p + 1))* Int[(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^n, x] - b*c*n/(2*(p + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[ x*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^p_*(a_. + b_.*ArcCosh[c_.*x_])^ n_., x_Symbol] := -x*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(2*d1*d2*(p + 1)) + (2*p + 3)/(2*d1*d2*(p + 1))* Int[(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^ n, x] - b*c*n/(2*(p + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[ x*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && LtQ[p, -1] && NeQ[p, -3/2]
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := -1/(c*d)*Subst[Int[(a + b*x)^n*Csch[x], x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := Simp[Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(d + e*x^2)^p]*(a + b*ArcCosh[c*x])^(n + 1)/(b* c*(n + 1)) - c*(2*p + 1)/(b*(n + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[ x*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && IntegerQ[2*p]
Int[(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1)) - c*(2*p + 1)/(b*(n + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[x*(-1 + c^2*x^2)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && LtQ[n, -1] && IntegerQ[p + 1/2]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := 1/(b*c)*Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Subst[Int[x^n*Sinh[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[2*p, 0]
Int[(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := 1/(b*c)*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Subst[Int[x^n*Sinh[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && IGtQ[2*p, 0]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d + e, 0] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
(* Int[(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcCosh[c_.*x_])^n_,x_Symbol] := 1/(b*c^(2*p+1))*Subst[Int[x^n*(c^2*d+e*Cosh[-a/b+x/b]^2)^p*Sinh[-a/ b+x/b],x],x,a+b*ArcCosh[c*x]] /; FreeQ[{a,b,c,d,e,n},x] && IGtQ[p,0] *)
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCosh[c*x])^n, (d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && NeQ[c^2*d + e, 0] && IntegerQ[p] && (p > 0 || IGtQ[n, 0])
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Unintegrable[(d + e*x^2)^p*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, n, p}, x]
Int[(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Unintegrable[(d1 + e1*x)^p*(d2 + e2*x)^p*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.2 Inverse hyperbolic cosine/7.2.4 (f x)^m (d+e x^2)^p (a+b arccosh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.2.4 (f x)^m (d+e x^2)^p (a+b arccosh(c x))^n *)
Int[(f_.*x_)^m_.*(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[(f*x)^m*(d1*d2 + e1*e2*x^2)^p*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m, n}, x] && EqQ[d2*e1 + d1*e2, 0] && IntegerQ[p]
Int[x_*(a_. + b_.*ArcCosh[c_.*x_])^n_./(d_ + e_.*x_^2), x_Symbol] := 1/e*Subst[Int[(a + b*x)^n*Coth[x], x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^n/(2*e*(p + 1)) - b*n/(2*c*(p + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && NeQ[p, -1]
Int[x_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(2*e1*e2*(p + 1)) - b*n/(2*c*(p + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_./(x_*(d_ + e_.*x_^2)), x_Symbol] := -1/d*Subst[Int[(a + b*x)^n/(Cosh[x]*Sinh[x]), x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(d*f*(m + 1)) + b*c*n/(f*(m + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m + 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && EqQ[m + 2*p + 3, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^n/(d1*d2*f*(m + 1)) + b*c*n/(f*(m + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m + 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && EqQ[m + 2*p + 3, 0] && NeQ[p, -1]
Int[(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])/x_, x_Symbol] := (d + e*x^2)^p*(a + b*ArcCosh[c*x])/(2*p) - b*c*(-d)^p/(2*p)* Int[(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2), x] + d*Int[(d + e*x^2)^(p - 1)*(a + b*ArcCosh[c*x])/x, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcCosh[c*x])/(f*(m + 1)) - b*c*(-d)^p/(f*(m + 1))* Int[(f*x)^(m + 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2), x] - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcCosh[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && ILtQ[(m + 1)/2, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[x_^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCosh[c*x], u] - b*c*Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[SimplifyIntegrand[u/Sqrt[d + e*x^2], x], x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2] && NeQ[p, -1/2] && (IGtQ[(m + 1)/2, 0] || ILtQ[(m + 2*p + 3)/2, 0])
Int[x_^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d1 + e1*x)^p*(d2 + e2*x)^p, x]}, Dist[a + b*ArcCosh[c*x], u] - b*c* Simp[Sqrt[d1 + e1*x]* Sqrt[d2 + e2*x]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[SimplifyIntegrand[u/(Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x]), x], x]] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && IntegerQ[p - 1/2] && NeQ[p, -1/2] && (IGtQ[(m + 1)/2, 0] || ILtQ[(m + 2*p + 3)/2, 0])
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcCosh[c*x])^n/(f*(m + 1)) - b*c*n/(f*(m + 1))* Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[(f*x)^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1), x] - c^2/(f^2*(m + 1))* Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[(f*x)^(m + 2)*(a + b*ArcCosh[c*x])^ n/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*Sqrt[d1 + e1*x]* Sqrt[d2 + e2*x]*(a + b*ArcCosh[c*x])^n/(f*(m + 1)) - b*c*n/(f*(m + 1))*Simp[Sqrt[d1 + e1*x]/Sqrt[1 + c*x]]* Simp[Sqrt[d2 + e2*x]/Sqrt[-1 + c*x]]* Int[(f*x)^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1), x] - c^2/(f^2*(m + 1))*Simp[Sqrt[d1 + e1*x]/Sqrt[1 + c*x]]* Simp[Sqrt[d2 + e2*x]/Sqrt[-1 + c*x]]* Int[((f*x)^(m + 2)*(a + b*ArcCosh[c*x])^n)/(Sqrt[1 + c*x]* Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcCosh[c*x])^n/(f*(m + 2)) - b*c*n/(f*(m + 2))* Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[(f*x)^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1), x] - 1/(m + 2)*Simp[Sqrt[d + e*x^2]/(Sqrt[1 + c*x]*Sqrt[-1 + c*x])]* Int[(f*x)^ m*(a + b*ArcCosh[c*x])^n/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0] && (IGtQ[m, -2] || EqQ[n, 1])
Int[(f_.*x_)^m_*Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*Sqrt[d1 + e1*x]* Sqrt[d2 + e2*x]*(a + b*ArcCosh[c*x])^n/(f*(m + 2)) - b*c*n/(f*(m + 2))*Simp[Sqrt[d1 + e1*x]/Sqrt[1 + c*x]]* Simp[Sqrt[d2 + e2*x]/Sqrt[-1 + c*x]]* Int[(f*x)^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1), x] - 1/(m + 2)*Simp[Sqrt[d1 + e1*x]/Sqrt[1 + c*x]]* Simp[Sqrt[d2 + e2*x]/Sqrt[-1 + c*x]]* Int[(f*x)^ m*(a + b*ArcCosh[c*x])^n/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && IGtQ[n, 0] && (IGtQ[m, -2] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^p*(a + b*ArcCosh[c*x])^n/(f*(m + 1)) - 2*e*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^(p - 1)*(a + b*ArcCosh[c*x])^n, x] - b*c*n/(f*(m + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m + 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^n/(f*(m + 1)) - 2*e1*e2*p/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d1 + e1*x)^(p - 1)*(d2 + e2*x)^(p - 1)*(a + b*ArcCosh[c*x])^n, x] - b*c*n/(f*(m + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m + 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && GtQ[p, 0] && LtQ[m, -1]
(* Int[(f_.*x_)^m_*(d_+e_.*x_^2)^p_*(a_.+b_.*ArcCosh[c_.*x_])^n_.,x_ Symbol] := f*(f*x)^(m-1)*(d+e*x^2)^(p+1)*(a+b*ArcCosh[c*x])^n/(e*(m+2*p+1)) + f^2*(m-1)/(c^2*(m+2*p+1))*Int[(f*x)^(m-2)*(d+e*x^2)^p*(a+b*ArcCosh[ c*x])^n,x] - b*f*n/(c*(m+2*p+1))*Simp[(d+e*x^2)^p/((1+c*x)^p*(-1+c*x)^p)]* Int[(f*x)^(m-1)*(-1+c^2*x^2)^(p+1/2)*(a+b*ArcCosh[c*x])^(n-1),x] /; FreeQ[{a,b,c,d,e,f,p},x] && EqQ[c^2*d+e,0] && GtQ[n,0] && EqQ[n,1] &&  IGtQ[p+1/2,0] && IGtQ[(m-1)/2,0] *)
(* Int[(f_.*x_)^m_*(d_+e_.*x_^2)^p_*(a_.+b_.*ArcCosh[c_.*x_])^n_.,x_ Symbol] := f*(f*x)^(m-1)*(d+e*x^2)^(p+1)*(a+b*ArcCosh[c*x])^n/(2*e*(p+1)) - f^2*(m-1)/(2*e*(p+1))*Int[(f*x)^(m-2)*(d+e*x^2)^(p+1)*(a+b*ArcCosh[ c*x])^n,x] - b*f*n/(2*c*(p+1))*Simp[(d+e*x^2)^p/((1+c*x)^p*(-1+c*x)^p)]* Int[(f*x)^(m-1)*(1+c*x)^(p+1/2)*(-1+c*x)^(p+1/2)*(a+b*ArcCosh[c*x] )^(n-1),x] /; FreeQ[{a,b,c,d,e,f},x] && EqQ[c^2*d+e,0] && GtQ[n,0] && EqQ[n,1] &&  ILtQ[p-1/2,0] && IGtQ[(m-1)/2,0] *)
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^ p*(a + b*ArcCosh[c*x])^n/(f*(m + 2*p + 1)) + 2*d*p/(m + 2*p + 1)* Int[(f*x)^m*(d + e*x^2)^(p - 1)*(a + b*ArcCosh[c*x])^n, x] - b*c*n/(f*(m + 2*p + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m + 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && GtQ[p, 0] && Not[LtQ[m, -1]]
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^n/(f*(m + 2*p + 1)) + 2*d1*d2*p/(m + 2*p + 1)* Int[(f*x)^ m*(d1 + e1*x)^(p - 1)*(d2 + e2*x)^(p - 1)*(a + b*ArcCosh[c*x])^ n, x] - b*c*n/(f*(m + 2*p + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m + 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && GtQ[p, 0] && Not[LtQ[m, -1]]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(d*f*(m + 1)) + c^2*(m + 2*p + 3)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d + e*x^2)^p*(a + b*ArcCosh[c*x])^n, x] + b*c*n/(f*(m + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m + 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && ILtQ[m, -1]
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f*x)^(m + 1)*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^n/(d1*d2*f*(m + 1)) + c^2*(m + 2*p + 3)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^n, x] + b*c*n/(f*(m + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m + 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && ILtQ[m, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(2*e*(p + 1)) - f^2*(m - 1)/(2*e*(p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^n, x] - b*f*n/(2*c*(p + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m - 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && IGtQ[m, 1]
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^n/(2*e1*e2*(p + 1)) - f^2*(m - 1)/(2*e1*e2*(p + 1))* Int[(f*x)^(m - 2)*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^n, x] - b*f*n/(2*c*(p + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m - 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && LtQ[p, -1] && IGtQ[m, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := -(f*x)^(m + 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(2*d*f*(p + 1)) + (m + 2*p + 3)/(2*d*(p + 1))* Int[(f*x)^m*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^n, x] - b*c*n/(2*f*(p + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m + 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && LtQ[p, -1] && Not[GtQ[m, 1]] && (IntegerQ[m] || IntegerQ[p] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := -(f*x)^(m + 1)*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^n/(2*d1*d2*f*(p + 1)) + (m + 2*p + 3)/(2*d1*d2*(p + 1))* Int[(f*x)^ m*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^ n, x] - b*c*n/(2*f*(p + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m + 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && LtQ[p, -1] && Not[GtQ[m, 1]] && (IntegerQ[m] || EqQ[n, 1])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])^ n/(e*(m + 2*p + 1)) + f^2*(m - 1)/(c^2*(m + 2*p + 1))* Int[(f*x)^(m - 2)*(d + e*x^2)^p*(a + b*ArcCosh[c*x])^n, x] - b*f*n/(c*(m + 2*p + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m - 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, p}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && IGtQ[m, 1] && NeQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := f*(f*x)^(m - 1)*(d1 + e1*x)^(p + 1)*(d2 + e2*x)^(p + 1)*(a + b*ArcCosh[c*x])^n/(e1*e2*(m + 2*p + 1)) + f^2*(m - 1)/(c^2*(m + 2*p + 1))* Int[(f*x)^(m - 2)*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^n, x] - b*f*n/(c*(m + 2*p + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m - 1)*(1 + c*x)^(p + 1/2)*(-1 + c*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n - 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && IGtQ[m, 1] && NeQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := (f*x)^m* Simp[Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(d + e*x^2)^p]*(a + b*ArcCosh[c*x])^(n + 1)/(b* c*(n + 1)) + f*m/(b*c*(n + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m - 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && EqQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := (f*x)^m* Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]*(d1 + e1*x)^p]*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1)) + f*m/(b*c*(n + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m - 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && LtQ[n, -1] && EqQ[m + 2*p + 1, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := (f*x)^m* Simp[Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(d + e*x^2)^p]*(a + b*ArcCosh[c*x])^(n + 1)/(b* c*(n + 1)) + f*m/(b*c*(n + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m - 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] - c*(m + 2*p + 1)/(b*f*(n + 1))* Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Int[(f*x)^(m + 1)*(1 + c*x)^(p - 1/2)*(-1 + c*x)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1] && IGtQ[2*p, 0] && NeQ[m + 2*p + 1, 0] && IGtQ[m, -3]
Int[(f_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := (f*x)^m*Sqrt[1 + c*x]* Sqrt[-1 + c*x]*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1)) + f*m/(b*c*(n + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m - 1)*(-1 + c^2*x^2)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] - c*(m + 2*p + 1)/(b*f*(n + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Int[(f*x)^(m + 1)*(-1 + c^2*x^2)^(p - 1/2)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m, p}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && LtQ[n, -1] && IGtQ[p + 1/2, 0] && NeQ[m + 2*p + 1, 0] && IGtQ[m, -3]
(* Int[(f_.*x_)^m_.*(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcCosh[c_.*x_])^n_,x_ Symbol] := (f*x)^m*Simp[Sqrt[1+c*x]*Sqrt[-1+c*x]*(d+e*x^2)^p]*(a+b*ArcCosh[c*x] )^(n+1)/(b*c*(n+1)) - f*m/(b*c*(n+1))*Simp[(d+e*x^2)^p/((1+c*x)^p*(-1+c*x)^p)]* Int[(f*x)^(m-1)*(1+c*x)^(p+1/2)*(-1+c*x)^(p+1/2)*(a+b*ArcCosh[c*x] )^(n+1),x] - c*(2*p+1)/(b*f*(n+1))*Simp[(d+e*x^2)^p/((1+c*x)^p*(-1+c*x)^p)]* Int[(f*x)^(m+1)*(1+c*x)^(p-1/2)*(-1+c*x)^(p-1/2)*(a+b*ArcCosh[c*x] )^(n+1),x] /; FreeQ[{a,b,c,d,e,f,m,p},x] && EqQ[c^2*d+e,0] && LtQ[n,-1] &&  NeQ[p,-1/2] && IntegerQ[2*p] && IGtQ[m,-3] *)
(* Int[(f_.*x_)^m_.*(d1_+e1_.*x_)^p_*(d2_+e2_.*x_)^p_*(a_.+b_.* ArcCosh[c_.*x_])^n_,x_Symbol] := (f*x)^m*Sqrt[1+c*x]*Sqrt[-1+c*x]*(d1+e1*x)^p*(d2+e2*x)^p*(a+b* ArcCosh[c*x])^(n+1)/(b*c*(n+1)) - f*m/(b*c*(n+1))*Simp[(d1+e1*x)^p/(1+c*x)^p]*Simp[(d2+e2*x)^p/(-1+c* x)^p]* Int[(f*x)^(m-1)*(-1+c^2*x^2)^(p+1/2)*(a+b*ArcCosh[c*x])^(n+1),x] - c*(2*p+1)/(b*f*(n+1))*Simp[(d1+e1*x)^p/(1+c*x)^p]*Simp[(d2+e2*x)^p/( -1+c*x)^p]* Int[(f*x)^(m+1)*(-1+c^2*x^2)^(p-1/2)*(a+b*ArcCosh[c*x])^(n+1),x] /; FreeQ[{a,b,c,d1,e1,d2,e2,f,m,p},x] && EqQ[e1,c*d1] && EqQ[e2,-c*d2] &&  LtQ[n,-1] && ILtQ[p+1/2,0] && IGtQ[m,-3] *)
Int[(f_.*x_)^m_*(a_. + b_.*ArcCosh[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcCosh[c*x])^n/(e*m) - b*f*n/(c*m)*Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n - 1), x] + f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcCosh[c*x])^n/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[n, 0] && IGtQ[m, 1]
Int[(f_.*x_)^ m_*(a_. + b_.*ArcCosh[c_.*x_])^ n_./(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := f*(f*x)^(m - 1)*Sqrt[d1 + e1*x]* Sqrt[d2 + e2*x]*(a + b*ArcCosh[c*x])^n/(e1*e2*m) - b*f*n/(c*m)*Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]* Int[(f*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n - 1), x] + f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcCosh[c*x])^ n/(Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x]), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[n, 0] && IGtQ[m, 1]
Int[x_^m_*(a_. + b_.*ArcCosh[c_.*x_])^n_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/c^(m + 1)*Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]* Subst[Int[(a + b*x)^n*Cosh[x]^m, x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_*(a_. + b_.*ArcCosh[c_.*x_])^ n_./(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := 1/c^(m + 1)*Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]* Subst[Int[(a + b*x)^n*Cosh[x]^m, x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCosh[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))*Simp[Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]]* (a + b*ArcCosh[c*x])* Hypergeometric2F1[1/2, (1 + m)/2, (3 + m)/2, c^2*x^2] + b*c*(f*x)^(m + 2)/(f^2*(m + 1)*(m + 2))* Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]* HypergeometricPFQ[{1, 1 + m/2, 1 + m/2}, {3/2 + m/2, 2 + m/2}, c^2*x^2] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && Not[IntegerQ[m]]
Int[(f_.*x_)^ m_*(a_. + b_.*ArcCosh[c_.*x_])/(Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]), x_Symbol] := (f*x)^(m + 1)/(f*(m + 1))* Simp[Sqrt[1 - c^2*x^2]/(Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x])]* (a + b*ArcCosh[c*x])* Hypergeometric2F1[1/2, (1 + m)/2, (3 + m)/2, c^2*x^2] + b*c*(f*x)^(m + 2)/(f^2*(m + 1)*(m + 2))* Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]* HypergeometricPFQ[{1, 1 + m/2, 1 + m/2}, {3/2 + m/2, 2 + m/2}, c^2*x^2] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && Not[IntegerQ[m]]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_/Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^m*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1))* Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]] - f*m/(b*c*(n + 1))* Simp[Sqrt[1 + c*x]*Sqrt[-1 + c*x]/Sqrt[d + e*x^2]]* Int[(f*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[n, -1]
Int[(f_.*x_)^ m_.*(a_. + b_.*ArcCosh[c_.*x_])^ n_/(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := (f*x)^m*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*(n + 1))* Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]] - f*m/(b*c*(n + 1))*Simp[Sqrt[1 + c*x]/Sqrt[d1 + e1*x]]* Simp[Sqrt[-1 + c*x]/Sqrt[d2 + e2*x]]* Int[(f*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && LtQ[n, -1]
Int[x_^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := 1/(b*c^(m + 1))*Simp[(d + e*x^2)^p/((1 + c*x)^p*(-1 + c*x)^p)]* Subst[ Int[x^n*Cosh[-a/b + x/b]^m*Sinh[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[2*p + 2, 0] && IGtQ[m, 0]
Int[x_^m_.*(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := 1/(b*c^(m + 1))*Simp[(d1 + e1*x)^p/(1 + c*x)^p]* Simp[(d2 + e2*x)^p/(-1 + c*x)^p]* Subst[ Int[x^n*Cosh[-a/b + x/b]^m*Sinh[-a/b + x/b]^(2*p + 1), x], x, a + b*ArcCosh[c*x]] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && IGtQ[p + 3/2, 0] && IGtQ[m, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCosh[c*x])^n/ Sqrt[d + e*x^2], (f*x)^m*(d + e*x^2)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[c^2*d + e, 0] && IGtQ[p + 1/2, 0] && Not[IGtQ[(m + 1)/2, 0]] && (EqQ[m, -1] || EqQ[m, -2])
Int[(f_.*x_)^m_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCosh[c*x])^ n/(Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x]), (f*x)^ m*(d1 + e1*x)^(p + 1/2)*(d2 + e2*x)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m, n}, x] && EqQ[e1, c*d1] && EqQ[e2, -c*d2] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[p + 1/2, 0] && Not[IGtQ[(m + 1)/2, 0]] && (EqQ[m, -1] || EqQ[m, -2])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := d*(f*x)^(m + 1)*(a + b*ArcCosh[c*x])/(f*(m + 1)) + e*(f*x)^(m + 3)*(a + b*ArcCosh[c*x])/(f^3*(m + 3)) - b*c/(f*(m + 1)*(m + 3))* Int[(f*x)^(m + 1)*(d*(m + 3) + e*(m + 1)*x^2)/(Sqrt[1 + c*x]* Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[c^2*d + e, 0] && NeQ[m, -1] && NeQ[m, -3]
Int[x_*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcCosh[c*x])/(2*e*(p + 1)) - b*c/(2*e*(p + 1))* Int[(d + e*x^2)^(p + 1)/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[c^2*d + e, 0] && NeQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(Sqrt[1 + c*x]*Sqrt[-1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[c^2*d + e, 0] && IntegerQ[p] && (GtQ[p, 0] || IGtQ[(m - 1)/2, 0] && LeQ[m + p, 0])
(* Int[x_^m_.*(d_+e_.*x_^2)^p_.*(a_.+b_.*ArcCosh[c_.*x_])^n_,x_Symbol]  := 1/(b*c^(m+2*p+1))*Subst[Int[x^n*Cosh[-a/b+x/b]^m*(c^2*d+e*Cosh[-a/b+ x/b]^2)^p*Sinh[-a/b+x/b],x],x,a+b*ArcCosh[c*x]] /; FreeQ[{a,b,c,d,e,n},x] && IGtQ[m,0] && IGtQ[p,0] *)
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCosh[c*x])^n, (f*x)^m*(d + e*x^2)^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[c^2*d + e, 0] && IGtQ[n, 0] && IntegerQ[p] && IntegerQ[m]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Unintegrable[(f*x)^m*(d + e*x^2)^p*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(f_.*x_)^m_.*(d1_ + e1_.*x_)^p_.*(d2_ + e2_.*x_)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Unintegrable[(f*x)^m*(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.2 Inverse hyperbolic cosine/7.2.5 u (a+b arccosh(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.2.5 u (a+b arccosh(c x))^n *)
Int[(a_. + b_.*ArcCosh[c_.*x_])^n_./(d_. + e_.*x_), x_Symbol] := Subst[Int[(a + b*x)^n*Sinh[x]/(c*d + e*Cosh[x]), x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[n, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCosh[c*x])^n/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[(d + e*x)^(m + 1)*(a + b*ArcCosh[c*x])^(n - 1)/(Sqrt[-1 + c*x]* Sqrt[1 + c*x]), x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 0] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[(d + e*x)^m*(a + b*ArcCosh[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[m, 0] && LtQ[n, -1]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := 1/c^(m + 1)* Subst[Int[(a + b*x)^n*Sinh[x]*(c*d + e*Cosh[x])^m, x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[m, 0]
Int[Px_*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[ExpandExpression[Px, x], x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Sqrt[1 - c^2*x^2]/(Sqrt[-1 + c*x]*Sqrt[1 + c*x])* Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c}, x] && PolyQ[Px, x]
(* Int[Px_*(a_.+b_.*ArcCosh[c_.*x_])^n_.,x_Symbol] := With[{u=IntHide[Px,x]}, Dist[(a+b*ArcCosh[c*x])^n,u,x] - b*c*n*Sqrt[1-c^2*x^2]/(Sqrt[-1+c*x]*Sqrt[1+c*x])*Int[ SimplifyIntegrand[u*(a+b*ArcCosh[c*x])^(n-1)/Sqrt[1-c^2*x^2],x],x]] /; FreeQ[{a,b,c},x] && PolyQ[Px,x] && IGtQ[n,0] *)
Int[Px_*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := Int[ExpandIntegrand[Px*(a + b*ArcCosh[c*x])^n, x], x] /; FreeQ[{a, b, c, n}, x] && PolyQ[Px, x]
Int[Px_*(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[Px*(d + e*x)^m, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Sqrt[1 - c^2*x^2]/(Sqrt[-1 + c*x]*Sqrt[1 + c*x])* Int[SimplifyIntegrand[u/Sqrt[1 - c^2*x^2], x], x]] /; FreeQ[{a, b, c, d, e, m}, x] && PolyQ[Px, x]
Int[(f_. + g_.*x_)^p_.*(d_ + e_.*x_)^m_*(a_. + b_.*ArcCosh[c_.*x_])^ n_, x_Symbol] := With[{u = IntHide[(f + g*x)^p*(d + e*x)^m, x]}, Dist[(a + b*ArcCosh[c*x])^n, u, x] - b*c*n* Int[SimplifyIntegrand[ u*(a + b*ArcCosh[c*x])^(n - 1)/(Sqrt[-1 + c*x]*Sqrt[1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[n, 0] && IGtQ[p, 0] && ILtQ[m, 0] && LtQ[m + p + 1, 0]
Int[(f_. + g_.*x_ + h_.*x_^2)^ p_.*(a_. + b_.*ArcCosh[c_.*x_])^n_/(d_ + e_.*x_)^2, x_Symbol] := With[{u = IntHide[(f + g*x + h*x^2)^p/(d + e*x)^2, x]}, Dist[(a + b*ArcCosh[c*x])^n, u, x] - b*c*n* Int[SimplifyIntegrand[ u*(a + b*ArcCosh[c*x])^(n - 1)/(Sqrt[-1 + c*x]*Sqrt[1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[n, 0] && IGtQ[p, 0] && EqQ[e*g - 2*d*h, 0]
Int[Px_*(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[Px*(d + e*x)^m*(a + b*ArcCosh[c*x])^n, x], x] /; FreeQ[{a, b, c, d, e}, x] && PolyQ[Px, x] && IGtQ[n, 0] && IntegerQ[m]
Int[(f_ + g_.*x_)^m_.*(d_ + e_.*x_^2)^p_*(a_. + b_.*ArcCosh[c_.*x_])^ n_., x_Symbol] := (-d)^IntPart[p]*(d + e*x^2)^ FracPart[p]/((-1 + c*x)^FracPart[p]*(1 + c*x)^FracPart[p])* Int[(f + g*x)^m*(-1 + c*x)^p*(1 + c*x)^p*(a + b*ArcCosh[c*x])^ n, x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2] && IntegerQ[m]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(d_ + e_.*x_^2)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (-d)^IntPart[p]*(d + e*x^2)^ FracPart[p]/((-1 + c*x)^FracPart[p]*(1 + c*x)^FracPart[p])* Int[ Log[h*(f + g*x)^m]*(-1 + c*x)^p*(1 + c*x)^p*(a + b*ArcCosh[c*x])^ n, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && EqQ[c^2*d + e, 0] && IntegerQ[p - 1/2]
Int[(f_ + g_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f + g*x)^m*(d1 + e1*x)^p*(d2 + e2*x)^p, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Int[Dist[1/(Sqrt[-1 + c*x]*Sqrt[1 + c*x]), u, x], x]] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IGtQ[m, 0] && ILtQ[p + 1/2, 0] && GtQ[d1, 0] && LtQ[d2, 0] && (GtQ[m, 3] || LtQ[m, -2*p - 1])
Int[(f_ + g_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(d1 + e1*x)^p*(d2 + e2*x)^ p*(a + b*ArcCosh[c*x])^n, (f + g*x)^m, x], x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IGtQ[m, 0] && IntegerQ[p + 1/2] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[n, 0] && (EqQ[n, 1] && GtQ[p, -1] || GtQ[p, 0] || EqQ[m, 1] || EqQ[m, 2] && LtQ[p, -2])
Int[(f_ + g_.*x_)^m_*Sqrt[d1_ + e1_.*x_]* Sqrt[d2_ + e2_.*x_]*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f + g*x)^ m*(d1*d2 + e1*e2*x^2)*(a + b*ArcCosh[c*x])^(n + 1)/(b*c* Sqrt[-d1*d2]*(n + 1)) - 1/(b*c*Sqrt[-d1*d2]*(n + 1))* Int[(d1*d2*g*m + 2*e1*e2*f*x + e1*e2*g*(m + 2)*x^2)*(f + g*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && ILtQ[m, 0] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[ Sqrt[d1 + e1*x]* Sqrt[d2 + e2*x]*(a + b*ArcCosh[c*x])^n, (f + g*x)^ m*(d1 + e1*x)^(p - 1/2)*(d2 + e2*x)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[m] && IGtQ[p + 1/2, 0] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (f + g*x)^ m*(d1 + e1*x)^(p + 1/2)*(d2 + e2*x)^(p + 1/2)*(a + b*ArcCosh[c*x])^(n + 1)/(b*c* Sqrt[-d1*d2]*(n + 1)) - 1/(b*c*Sqrt[-d1*d2]*(n + 1))* Int[ ExpandIntegrand[(f + g*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n + 1), (d1*d2*g*m + e1*e2*f*(2*p + 1)*x + e1*e2*g*(m + 2*p + 1)*x^2)*(d1 + e1*x)^(p - 1/2)*(d2 + e2*x)^(p - 1/2), x], x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && ILtQ[m, 0] && IGtQ[p - 1/2, 0] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^ m_.*(a_. + b_.*ArcCosh[c_.*x_])^ n_/(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := (f + g*x)^ m*(a + b*ArcCosh[c*x])^(n + 1)/(b*c*Sqrt[-d1*d2]*(n + 1)) - g*m/(b*c*Sqrt[-d1*d2]*(n + 1))* Int[(f + g*x)^(m - 1)*(a + b*ArcCosh[c*x])^(n + 1), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IGtQ[m, 0] && GtQ[d1, 0] && LtQ[d2, 0] && LtQ[n, -1]
Int[(f_ + g_.*x_)^ m_.*(a_. + b_.*ArcCosh[c_.*x_])^ n_./(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := 1/(c^(m + 1)*Sqrt[-d1*d2])* Subst[Int[(a + b*x)^n*(c*f + g*Cosh[x])^m, x], x, ArcCosh[c*x]] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g, n}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[m] && GtQ[d1, 0] && LtQ[d2, 0] && (GtQ[m, 0] || IGtQ[n, 0])
Int[(f_ + g_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCosh[c*x])^ n/(Sqrt[d1 + e1*x]*Sqrt[d2 + e2*x]), (f + g*x)^ m*(d1 + e1*x)^(p + 1/2)*(d2 + e2*x)^(p + 1/2), x], x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[m] && ILtQ[p + 1/2, 0] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[n, 0]
Int[(f_ + g_.*x_)^m_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (-d1*d2)^IntPart[p]*(d1 + e1*x)^ FracPart[p]*(d2 + e2*x)^ FracPart[p]/((-1 + c*x)^FracPart[p]*(1 + c*x)^FracPart[p])* Int[(f + g*x)^m*(-1 + c*x)^p*(1 + c*x)^p*(a + b*ArcCosh[c*x])^ n, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g, n}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[m] && IntegerQ[p - 1/2] && Not[GtQ[d1, 0] && LtQ[d2, 0]]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(a_. + b_.*ArcCosh[c_.*x_])^ n_./(Sqrt[d1_ + e1_.*x_]*Sqrt[d2_ + e2_.*x_]), x_Symbol] := Log[h*(f + g*x)^m]*(a + b*ArcCosh[c*x])^(n + 1)/(b*c* Sqrt[-d1*d2]*(n + 1)) - g*m/(b*c*Sqrt[-d1*d2]*(n + 1))* Int[(a + b*ArcCosh[c*x])^(n + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g, h, m}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && GtQ[d1, 0] && LtQ[d2, 0] && IGtQ[n, 0]
Int[Log[h_.*(f_. + g_.*x_)^m_.]*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := (-d1*d2)^IntPart[p]*(d1 + e1*x)^ FracPart[p]*(d2 + e2*x)^ FracPart[p]/((-1 + c*x)^FracPart[p]*(1 + c*x)^FracPart[p])* Int[ Log[h*(f + g*x)^m]*(-1 + c*x)^p*(1 + c*x)^p*(a + b*ArcCosh[c*x])^ n, x] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g, h, m, n}, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[p - 1/2] && Not[GtQ[d1, 0] && LtQ[d2, 0]]
Int[(d_ + e_.*x_)^m_*(f_ + g_.*x_)^m_*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x)^m*(f + g*x)^m, x]}, Dist[a + b*ArcCosh[c*x], u, x] - b*c*Int[Dist[1/(Sqrt[-1 + c*x]*Sqrt[1 + c*x]), u, x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m + 1/2, 0]
Int[(d_ + e_.*x_)^m_.*(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCosh[c_.*x_])^ n_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCosh[c*x])^ n, (d + e*x)^m*(f + g*x)^m, x], x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && IntegerQ[m]
Int[u_*(a_. + b_.*ArcCosh[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[a + b*ArcCosh[c*x], v, x] - b*c*Sqrt[1 - c^2*x^2]/(Sqrt[-1 + c*x]*Sqrt[1 + c*x])* Int[SimplifyIntegrand[v/Sqrt[1 - c^2*x^2], x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[Px_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_. + b_.*ArcCosh[c_.*x_])^n_, x_Symbol] := With[{u = ExpandIntegrand[ Px*(d1 + e1*x)^p*(d2 + e2*x)^p*(a + b*ArcCosh[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d1, e1, d2, e2, n}, x] && PolyQ[Px, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[p - 1/2]
Int[Px_.*(f_ + g_.*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^p_)^ m_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := With[{u = ExpandIntegrand[ Px*(f + g*(d1 + e1*x)^p*(d2 + e2*x)^p)^m*(a + b*ArcCosh[c*x])^n, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d1, e1, d2, e2, f, g}, x] && PolyQ[Px, x] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IGtQ[p + 1/2, 0] && IntegersQ[m, n]
Int[RFx_*ArcCosh[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[ArcCosh[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[c, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(a_ + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[RFx*(a + b*ArcCosh[c*x])^n, x], x] /; FreeQ[{a, b, c}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0]
Int[RFx_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^p_*ArcCosh[c_.*x_]^n_., x_Symbol] := With[{u = ExpandIntegrand[(d1 + e1*x)^p*(d2 + e2*x)^p*ArcCosh[c*x]^n, RFx, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{c, d1, e1, d2, e2}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[p - 1/2]
Int[RFx_*(d1_ + e1_.*x_)^p_*(d2_ + e2_.*x_)^ p_*(a_ + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Int[ExpandIntegrand[(d1 + e1*x)^p*(d2 + e2*x)^p, RFx*(a + b*ArcCosh[c*x])^n, x], x] /; FreeQ[{a, b, c, d1, e1, d2, e2}, x] && RationalFunctionQ[RFx, x] && IGtQ[n, 0] && EqQ[e1 - c*d1, 0] && EqQ[e2 + c*d2, 0] && IntegerQ[p - 1/2]
Int[u_.*(a_. + b_.*ArcCosh[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcCosh[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.2 Inverse hyperbolic cosine/7.2.6 Miscellaneous inverse hyperbolic cosine.m
*)

(* ::Subsection::Closed:: *)
(* 7.2.6 Miscellaneous inverse hyperbolic cosine *)
Int[(a_. + b_.*ArcCosh[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCosh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, n}, x]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCosh[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCosh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(A_. + B_.*x_ + C_.*x_^2)^p_.*(a_. + b_.*ArcCosh[c_ + d_.*x_])^ n_., x_Symbol] := 1/d*Subst[Int[(-C/d^2 + C/d^2*x^2)^p*(a + b*ArcCosh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, n, p}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ p_.*(a_. + b_.*ArcCosh[c_ + d_.*x_])^n_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ p*(a + b*ArcCosh[x])^n, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[Sqrt[a_. + b_.*ArcCosh[1 + d_.*x_^2]], x_Symbol] := 2*Sqrt[a + b*ArcCosh[1 + d*x^2]]* Sinh[(1/2)*ArcCosh[1 + d*x^2]]^2/(d*x) - Sqrt[b]*Sqrt[Pi/2]*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Sinh[(1/2)*ArcCosh[1 + d*x^2]]* Erfi[(1/Sqrt[2*b])*Sqrt[a + b*ArcCosh[1 + d*x^2]]]/(d*x) + Sqrt[b]*Sqrt[Pi/2]*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Sinh[(1/2)*ArcCosh[1 + d*x^2]]* Erf[(1/Sqrt[2*b])*Sqrt[a + b*ArcCosh[1 + d*x^2]]]/(d*x) /; FreeQ[{a, b, d}, x]
Int[Sqrt[a_. + b_.*ArcCosh[-1 + d_.*x_^2]], x_Symbol] := 2*Sqrt[a + b*ArcCosh[-1 + d*x^2]]* Cosh[(1/2)*ArcCosh[-1 + d*x^2]]^2/(d*x) - Sqrt[b]*Sqrt[Pi/2]*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Cosh[(1/2)*ArcCosh[-1 + d*x^2]]* Erfi[(1/Sqrt[2*b])*Sqrt[a + b*ArcCosh[-1 + d*x^2]]]/(d*x) - Sqrt[b]*Sqrt[Pi/2]*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Cosh[(1/2)*ArcCosh[-1 + d*x^2]]* Erf[(1/Sqrt[2*b])*Sqrt[a + b*ArcCosh[-1 + d*x^2]]]/(d*x) /; FreeQ[{a, b, d}, x]
Int[(a_. + b_.*ArcCosh[c_ + d_.*x_^2])^n_, x_Symbol] := x*(a + b*ArcCosh[c + d*x^2])^n - 2*b* n*(2*c*d*x^2 + d^2*x^4)*(a + b*ArcCosh[c + d*x^2])^(n - 1)/(d*x* Sqrt[-1 + c + d*x^2]*Sqrt[1 + c + d*x^2]) + 4*b^2*n*(n - 1)*Int[(a + b*ArcCosh[c + d*x^2])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1] && GtQ[n, 1]
Int[1/(a_. + b_.*ArcCosh[1 + d_.*x_^2]), x_Symbol] := x*Cosh[a/(2*b)]* CoshIntegral[(a + b*ArcCosh[1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[d*x^2]) - x*Sinh[a/(2*b)]* SinhIntegral[(a + b*ArcCosh[1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[d*x^2]) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCosh[-1 + d_.*x_^2]), x_Symbol] := -x*Sinh[a/(2*b)]* CoshIntegral[(a + b*ArcCosh[-1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[d*x^2]) + x*Cosh[a/(2*b)]* SinhIntegral[(a + b*ArcCosh[-1 + d*x^2])/(2*b)]/(Sqrt[2]*b* Sqrt[d*x^2]) /; FreeQ[{a, b, d}, x]
Int[1/Sqrt[a_. + b_.*ArcCosh[1 + d_.*x_^2]], x_Symbol] := Sqrt[Pi/2]*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Sinh[ArcCosh[1 + d*x^2]/2]* Erfi[Sqrt[a + b*ArcCosh[1 + d*x^2]]/Sqrt[2*b]]/(Sqrt[b]*d*x) + Sqrt[Pi/2]*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Sinh[ArcCosh[1 + d*x^2]/2]* Erf[Sqrt[a + b*ArcCosh[1 + d*x^2]]/Sqrt[2*b]]/(Sqrt[b]*d*x) /; FreeQ[{a, b, d}, x]
Int[1/Sqrt[a_. + b_.*ArcCosh[-1 + d_.*x_^2]], x_Symbol] := Sqrt[Pi/2]*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Cosh[ArcCosh[-1 + d*x^2]/2]* Erfi[Sqrt[a + b*ArcCosh[-1 + d*x^2]]/Sqrt[2*b]]/(Sqrt[b]*d*x) - Sqrt[Pi/2]*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Cosh[ArcCosh[-1 + d*x^2]/2]* Erf[Sqrt[a + b*ArcCosh[-1 + d*x^2]]/Sqrt[2*b]]/(Sqrt[b]*d*x) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCosh[1 + d_.*x_^2])^(3/2), x_Symbol] := -Sqrt[d*x^2]* Sqrt[2 + d*x^2]/(b*d*x*Sqrt[a + b*ArcCosh[1 + d*x^2]]) + Sqrt[Pi/2]*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Sinh[ArcCosh[1 + d*x^2]/2]* Erfi[Sqrt[a + b*ArcCosh[1 + d*x^2]]/Sqrt[2*b]]/(b^(3/2)*d*x) - Sqrt[Pi/2]*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Sinh[ArcCosh[1 + d*x^2]/2]* Erf[Sqrt[a + b*ArcCosh[1 + d*x^2]]/Sqrt[2*b]]/(b^(3/2)*d*x) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCosh[-1 + d_.*x_^2])^(3/2), x_Symbol] := -Sqrt[d*x^2]* Sqrt[-2 + d*x^2]/(b*d*x*Sqrt[a + b*ArcCosh[-1 + d*x^2]]) + Sqrt[Pi/2]*(Cosh[a/(2*b)] - Sinh[a/(2*b)])* Cosh[ArcCosh[-1 + d*x^2]/2]* Erfi[Sqrt[a + b*ArcCosh[-1 + d*x^2]]/Sqrt[2*b]]/(b^(3/2)*d*x) + Sqrt[Pi/2]*(Cosh[a/(2*b)] + Sinh[a/(2*b)])* Cosh[ArcCosh[-1 + d*x^2]/2]* Erf[Sqrt[a + b*ArcCosh[-1 + d*x^2]]/Sqrt[2*b]]/(b^(3/2)*d*x) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCosh[1 + d_.*x_^2])^2, x_Symbol] := -Sqrt[d*x^2]*Sqrt[2 + d*x^2]/(2*b*d*x*(a + b*ArcCosh[1 + d*x^2])) - x*Sinh[a/(2*b)]* CoshIntegral[(a + b*ArcCosh[1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[d*x^2]) + x*Cosh[a/(2*b)]* SinhIntegral[(a + b*ArcCosh[1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[d*x^2]) /; FreeQ[{a, b, d}, x]
Int[1/(a_. + b_.*ArcCosh[-1 + d_.*x_^2])^2, x_Symbol] := -Sqrt[d*x^2]* Sqrt[-2 + d*x^2]/(2*b*d*x*(a + b*ArcCosh[-1 + d*x^2])) + x*Cosh[a/(2*b)]* CoshIntegral[(a + b*ArcCosh[-1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[d*x^2]) - x*Sinh[a/(2*b)]* SinhIntegral[(a + b*ArcCosh[-1 + d*x^2])/(2*b)]/(2*Sqrt[2]*b^2* Sqrt[d*x^2]) /; FreeQ[{a, b, d}, x]
Int[(a_. + b_.*ArcCosh[c_ + d_.*x_^2])^n_, x_Symbol] := -x*(a + b*ArcCosh[c + d*x^2])^(n + 2)/(4*b^2*(n + 1)*(n + 2)) + (2*c*x^2 + d*x^4)*(a + b*ArcCosh[c + d*x^2])^(n + 1)/(2*b*(n + 1)*x* Sqrt[-1 + c + d*x^2]*Sqrt[1 + c + d*x^2]) + 1/(4*b^2*(n + 1)*(n + 2))* Int[(a + b*ArcCosh[c + d*x^2])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && EqQ[c^2, 1] && LtQ[n, -1] && NeQ[n, -2]
Int[ArcCosh[a_.*x_^p_]^n_./x_, x_Symbol] := 1/p*Subst[Int[x^n*Tanh[x], x], x, ArcCosh[a*x^p]] /; FreeQ[{a, p}, x] && IGtQ[n, 0]
Int[u_.*ArcCosh[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcSech[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[ArcCosh[Sqrt[1 + b_.*x_^2]]^n_./Sqrt[1 + b_.*x_^2], x_Symbol] := Sqrt[-1 + Sqrt[1 + b*x^2]]*Sqrt[1 + Sqrt[1 + b*x^2]]/(b*x)* Subst[Int[ArcCosh[x]^n/(Sqrt[-1 + x]*Sqrt[1 + x]), x], x, Sqrt[1 + b*x^2]] /; FreeQ[{b, n}, x]
Int[f_^(c_.*ArcCosh[a_. + b_.*x_]^n_.), x_Symbol] := 1/b*Subst[Int[f^(c*x^n)*Sinh[x], x], x, ArcCosh[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[n, 0]
Int[x_^m_.*f_^(c_.*ArcCosh[a_. + b_.*x_]^n_.), x_Symbol] := 1/b*Subst[Int[(-a/b + Cosh[x]/b)^m*f^(c*x^n)*Sinh[x], x], x, ArcCosh[a + b*x]] /; FreeQ[{a, b, c, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[ArcCosh[u_], x_Symbol] := x*ArcCosh[u] - Int[SimplifyIntegrand[x*D[u, x]/(Sqrt[-1 + u]*Sqrt[1 + u]), x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCosh[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCosh[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)* D[u, x]/(Sqrt[-1 + u]*Sqrt[1 + u]), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[v_*(a_. + b_.*ArcCosh[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCosh[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/(Sqrt[-1 + u]*Sqrt[1 + u]), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]
Int[E^(n_.*ArcCosh[u_]), x_Symbol] := Int[(u + Sqrt[-1 + u]*Sqrt[1 + u])^n, x] /; IntegerQ[n] && PolyQ[u, x]
Int[x_^m_.*E^(n_.*ArcCosh[u_]), x_Symbol] := Int[x^m*(u + Sqrt[-1 + u]*Sqrt[1 + u])^n, x] /; RationalQ[m] && IntegerQ[n] && PolyQ[u, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.1 (a+b arctanh(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.1 (a+b arctanh(c x^n))^p *)
Int[(a_. + b_.*ArcTanh[c_.*x_^n_.])^p_., x_Symbol] := x*(a + b*ArcTanh[c*x^n])^p - b*c*n*p* Int[x^n*(a + b*ArcTanh[c*x^n])^(p - 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0] && (EqQ[n, 1] || EqQ[p, 1])
Int[(a_. + b_.*ArcCoth[c_.*x_^n_.])^p_., x_Symbol] := x*(a + b*ArcCoth[c*x^n])^p - b*c*n*p* Int[x^n*(a + b*ArcCoth[c*x^n])^(p - 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0] && (EqQ[n, 1] || EqQ[p, 1])
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*Log[1 + c*x^n]/2 - b*Log[1 - c*x^n]/2)^ p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*Log[1 + x^(-n)/c]/2 - b*Log[1 - x^(-n)/c]/2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := Int[(a + b*ArcCoth[x^(-n)/c])^p, x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := Int[(a + b*ArcTanh[x^(-n)/c])^p, x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcTanh[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && FractionQ[n]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcCoth[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && FractionQ[n]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_.])^p_, x_Symbol] := Unintegrable[(a + b*ArcTanh[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_.])^p_, x_Symbol] := Unintegrable[(a + b*ArcCoth[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.1 u (a+b arctanh(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.1 u (a+b arctanh(c x^n))^p *)
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := x*(a + b*ArcTanh[c*x])^p - b*c*p*Int[x*(a + b*ArcTanh[c*x])^(p - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := x*(a + b*ArcCoth[c*x])^p - b*c*p*Int[x*(a + b*ArcCoth[c*x])^(p - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])/x_, x_Symbol] := a*Log[x] - b/2*PolyLog[2, -c*x] + b/2*PolyLog[2, c*x] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcCoth[c_.*x_])/x_, x_Symbol] := a*Log[x] + b/2*PolyLog[2, -1/(c*x)] - b/2*PolyLog[2, 1/(c*x)] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_/x_, x_Symbol] := 2*(a + b*ArcTanh[c*x])^p*ArcTanh[1 - 2/(1 - c*x)] - 2*b*c*p* Int[(a + b*ArcTanh[c*x])^(p - 1)* ArcTanh[1 - 2/(1 - c*x)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_/x_, x_Symbol] := 2*(a + b*ArcCoth[c*x])^p*ArcCoth[1 - 2/(1 - c*x)] - 2*b*c*p* Int[(a + b*ArcCoth[c*x])^(p - 1)* ArcCoth[1 - 2/(1 - c*x)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := (d*x)^(m + 1)*(a + b*ArcTanh[c*x])^p/(d*(m + 1)) - b*c*p/(d*(m + 1))* Int[(d*x)^(m + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p, 0] && (EqQ[p, 1] || IntegerQ[m]) && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCoth[c*x])^p/(d*(m + 1)) - b*c*p/(d*(m + 1))* Int[(d*x)^(m + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p, 0] && (EqQ[p, 1] || IntegerQ[m]) && NeQ[m, -1]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])^p*Log[2/(1 + e*x/d)]/e + b*c*p/e* Int[(a + b*ArcTanh[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])^p*Log[2/(1 + e*x/d)]/e + b*c*p/e* Int[(a + b*ArcCoth[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])*Log[2/(1 + c*x)]/e + b*c/e*Int[Log[2/(1 + c*x)]/(1 - c^2*x^2), x] + (a + b*ArcTanh[c*x])*Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*c/e* Int[Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])*Log[2/(1 + c*x)]/e + b*c/e*Int[Log[2/(1 + c*x)]/(1 - c^2*x^2), x] + (a + b*ArcCoth[c*x])*Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*c/e* Int[Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])^2*Log[2/(1 + c*x)]/e + b*(a + b*ArcTanh[c*x])*PolyLog[2, 1 - 2/(1 + c*x)]/e + b^2*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + (a + b*ArcTanh[c*x])^2* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*(a + b*ArcTanh[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b^2*PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])^2*Log[2/(1 + c*x)]/e + b*(a + b*ArcCoth[c*x])*PolyLog[2, 1 - 2/(1 + c*x)]/e + b^2*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + (a + b*ArcCoth[c*x])^2* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*(a + b*ArcCoth[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b^2*PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])^3*Log[2/(1 + c*x)]/e + 3*b*(a + b*ArcTanh[c*x])^2*PolyLog[2, 1 - 2/(1 + c*x)]/(2*e) + 3*b^2*(a + b*ArcTanh[c*x])*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + 3*b^3*PolyLog[4, 1 - 2/(1 + c*x)]/(4*e) + (a + b*ArcTanh[c*x])^3* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - 3*b*(a + b*ArcTanh[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^2*(a + b*ArcTanh[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^3*PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])^3*Log[2/(1 + c*x)]/e + 3*b*(a + b*ArcCoth[c*x])^2*PolyLog[2, 1 - 2/(1 + c*x)]/(2*e) + 3*b^2*(a + b*ArcCoth[c*x])*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + 3*b^3*PolyLog[4, 1 - 2/(1 + c*x)]/(4*e) + (a + b*ArcCoth[c*x])^3* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - 3*b*(a + b*ArcCoth[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^2*(a + b*ArcCoth[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^3*PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTanh[c*x])/(e*(q + 1)) - b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCoth[c*x])/(e*(q + 1)) - b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTanh[c*x])^p/(e*(q + 1)) - b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 - c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCoth[c*x])^p/(e*(q + 1)) - b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 - c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := f/e*Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^p, x] - d*f/e*Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := f/e*Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^p, x] - d*f/e*Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && GtQ[m, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := (a + b*ArcTanh[c*x])^p*Log[2 - 2/(1 + e*x/d)]/d - b*c*p/d* Int[(a + b*ArcTanh[c*x])^(p - 1)* Log[2 - 2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := (a + b*ArcCoth[c*x])^p*Log[2 - 2/(1 + e*x/d)]/d - b*c*p/d* Int[(a + b*ArcCoth[c*x])^(p - 1)* Log[2 - 2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcTanh[c*x])^p, x] - e/(d*f)*Int[(f*x)^(m + 1)*(a + b*ArcTanh[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcCoth[c*x])^p, x] - e/(d*f)*Int[(f*x)^(m + 1)*(a + b*ArcCoth[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcTanh[c*x]), u] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[q, -1] && IntegerQ[ 2*m] && (IGtQ[m, 0] && IGtQ[q, 0] || ILtQ[m + q + 1, 0] && LtQ[m*q, 0])
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcCoth[c*x]), u] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[q, -1] && IntegerQ[ 2*m] && (IGtQ[m, 0] && IGtQ[q, 0] || ILtQ[m + q + 1, 0] && LtQ[m*q, 0])
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcTanh[c*x])^p, u] - b*c*p*Int[ ExpandIntegrand[(a + b*ArcTanh[c*x])^(p - 1), u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && IGtQ[p, 1] && EqQ[c^2*d^2 - e^2, 0] && IntegersQ[m, q] && NeQ[m, -1] && NeQ[q, -1] && ILtQ[m + q + 1, 0] && LtQ[m*q, 0]
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcCoth[c*x])^p, u] - b*c*p*Int[ ExpandIntegrand[(a + b*ArcCoth[c*x])^(p - 1), u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && IGtQ[p, 1] && EqQ[c^2*d^2 - e^2, 0] && IntegersQ[m, q] && NeQ[m, -1] && NeQ[q, -1] && ILtQ[m + q + 1, 0] && LtQ[m*q, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^p, (f*x)^m*(d + e*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || NeQ[a, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^p, (f*x)^m*(d + e*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || NeQ[a, 0] || IntegerQ[m])
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := b*(d + e*x^2)^q/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcTanh[c*x])/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := b*(d + e*x^2)^q/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcCoth[c*x])/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := b*p*(d + e*x^2)^ q*(a + b*ArcTanh[c*x])^(p - 1)/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^p, x] - b^2*d*p*(p - 1)/(2*q*(2*q + 1))* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && GtQ[p, 1]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := b*p*(d + e*x^2)^ q*(a + b*ArcCoth[c*x])^(p - 1)/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^p, x] - b^2*d*p*(p - 1)/(2*q*(2*q + 1))* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && GtQ[p, 1]
(* Int[(a_.+b_.*ArcTanh[c_.*x_])^p_./(d_+e_.*x_^2),x_Symbol] := 1/(c*d)*Subst[Int[(a+b*x)^p,x],x,ArcTanh[c*x]] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[c^2*d+e,0] *)
(* Int[(a_.+b_.*ArcCoth[c_.*x_])^p_./(d_+e_.*x_^2),x_Symbol] := 1/(c*d)*Subst[Int[(a+b*x)^p,x],x,ArcCoth[c*x]] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[c^2*d+e,0] *)
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcTanh[c_.*x_])), x_Symbol] := Log[RemoveContent[a + b*ArcTanh[c*x], x]]/(b*c*d) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcCoth[c_.*x_])), x_Symbol] := Log[RemoveContent[a + b*ArcCoth[c*x], x]]/(b*c*d) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcTanh[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := -2*(a + b*ArcTanh[c*x])* ArcTan[Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) - I*b*PolyLog[2, -I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) + I*b*PolyLog[2, I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := -2*(a + b*ArcCoth[c*x])* ArcTan[Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) - I*b*PolyLog[2, -I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) + I*b*PolyLog[2, I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(c*Sqrt[d])*Subst[Int[(a + b*x)^p*Sech[x], x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -x*Sqrt[1 - 1/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p*Csch[x], x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcTanh[c*x])^p/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcCoth[c*x])^p/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcTanh[c*x])^p/(2*d*(d + e*x^2)) + (a + b*ArcTanh[c*x])^(p + 1)/(2*b*c*d^2*(p + 1)) - b*c*p/2*Int[x*(a + b*ArcTanh[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcCoth[c*x])^p/(2*d*(d + e*x^2)) + (a + b*ArcCoth[c*x])^(p + 1)/(2*b*c*d^2*(p + 1)) - b*c*p/2*Int[x*(a + b*ArcCoth[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcTanh[c*x])/(d*Sqrt[d + e*x^2]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcCoth[c*x])/(d*Sqrt[d + e*x^2]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -3/2]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b*p*(a + b*ArcTanh[c*x])^(p - 1)/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcTanh[c*x])^p/(d*Sqrt[d + e*x^2]) + b^2*p*(p - 1)* Int[(a + b*ArcTanh[c*x])^(p - 2)/(d + e*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 1]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b*p*(a + b*ArcCoth[c*x])^(p - 1)/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcCoth[c*x])^p/(d*Sqrt[d + e*x^2]) + b^2*p*(p - 1)* Int[(a + b*ArcCoth[c*x])^(p - 2)/(d + e*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := -b*p*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(4*c* d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] + b^2*p*(p - 1)/(4*(q + 1)^2)* Int[(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && GtQ[p, 1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := -b*p*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(4*c* d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] + b^2*p*(p - 1)/(4*(q + 1)^2)* Int[(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && GtQ[p, 1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p + 1)/(b*c* d*(p + 1)) + 2*c*(q + 1)/(b*(p + 1))* Int[x*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p + 1)/(b*c* d*(p + 1)) + 2*c*(q + 1)/(b*(p + 1))* Int[x*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^q/c* Subst[Int[(a + b*x)^p/Cosh[x]^(2*(q + 1)), x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && (IntegerQ[q] || GtQ[d, 0])
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^(q + 1/2)*Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(1 - c^2*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && Not[IntegerQ[q] || GtQ[d, 0]]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^q/c* Subst[Int[(a + b*x)^p/Sinh[x]^(2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && IntegerQ[q]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^(q + 1/2)*x*Sqrt[(c^2*x^2 - 1)/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p/Sinh[x]^(2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && Not[IntegerQ[q]]
Int[ArcTanh[c_.*x_]/(d_. + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + c*x]/(d + e*x^2), x] - 1/2*Int[Log[1 - c*x]/(d + e*x^2), x] /; FreeQ[{c, d, e}, x]
Int[ArcCoth[c_.*x_]/(d_. + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + 1/(c*x)]/(d + e*x^2), x] - 1/2*Int[Log[1 - 1/(c*x)]/(d + e*x^2), x] /; FreeQ[{c, d, e}, x]
Int[(a_ + b_.*ArcTanh[c_.*x_])/(d_. + e_.*x_^2), x_Symbol] := a*Int[1/(d + e*x^2), x] + b*Int[ArcTanh[c*x]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(a_ + b_.*ArcCoth[c_.*x_])/(d_. + e_.*x_^2), x_Symbol] := a*Int[1/(d + e*x^2), x] + b*Int[ArcCoth[c*x]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^q, x]}, Dist[a + b*ArcTanh[c*x], u, x] - b*c*Int[u/(1 - c^2*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && (IntegerQ[q] || ILtQ[q + 1/2, 0])
Int[(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^q, x]}, Dist[a + b*ArcCoth[c*x], u, x] - b*c*Int[u/(1 - c^2*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && (IntegerQ[q] || ILtQ[q + 1/2, 0])
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^p, (d + e*x^2)^q, x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[q] && IGtQ[p, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^p, (d + e*x^2)^q, x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[q] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcTanh[c*x])^p, x] - d*f^2/e* Int[(f*x)^(m - 2)*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcCoth[c*x])^p, x] - d*f^2/e* Int[(f*x)^(m - 2)*(a + b*ArcCoth[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcTanh[c*x])^p, x] - e/(d*f^2)* Int[(f*x)^(m + 2)*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcCoth[c*x])^p, x] - e/(d*f^2)* Int[(f*x)^(m + 2)*(a + b*ArcCoth[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1]
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)/(b*e*(p + 1)) + 1/(c*d)*Int[(a + b*ArcTanh[c*x])^p/(1 - c*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)/(b*e*(p + 1)) + 1/(c*d)*Int[(a + b*ArcCoth[c*x])^p/(1 - c*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := x*(a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)) - 1/(b*c*d*(p + 1))*Int[(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && Not[IGtQ[p, 0]] && NeQ[p, -1]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := -x*(a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)) - 1/(b*c*d*(p + 1))*Int[(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && Not[IGtQ[p, 0]] && NeQ[p, -1]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_*(d_ + e_.*x_^2)), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)/(b*d*(p + 1)) + 1/d*Int[(a + b*ArcTanh[c*x])^p/(x*(1 + c*x)), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_*(d_ + e_.*x_^2)), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)/(b*d*(p + 1)) + 1/d*Int[(a + b*ArcCoth[c*x])^p/(x*(1 + c*x)), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := (f*x)^m*(a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)) - f*m/(b*c*d*(p + 1))* Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := (f*x)^m*(a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)) - f*m/(b*c*d*(p + 1))* Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_])/(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x]), x^m/(d + e*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m] && Not[EqQ[m, 1] && NeQ[a, 0]]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_])/(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x]), x^m/(d + e*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m] && Not[EqQ[m, 1] && NeQ[a, 0]]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p/(2*e*(q + 1)) + b*p/(2*c*(q + 1))* Int[(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, q}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && NeQ[q, -1]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p/(2*e*(q + 1)) + b*p/(2*c*(q + 1))* Int[(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, q}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && NeQ[q, -1]
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)*(d + e*x^2)) + (1 + c^2*x^2)*(a + b*ArcTanh[c*x])^(p + 2)/(b^2* e*(p + 1)*(p + 2)*(d + e*x^2)) + 4/(b^2*(p + 1)*(p + 2))* Int[x*(a + b*ArcTanh[c*x])^(p + 2)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)*(d + e*x^2)) + (1 + c^2*x^2)*(a + b*ArcCoth[c*x])^(p + 2)/(b^2* e*(p + 1)*(p + 2)*(d + e*x^2)) + 4/(b^2*(p + 1)*(p + 2))* Int[x*(a + b*ArcCoth[c*x])^(p + 2)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^2*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c^3*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(2*c^2*d*(q + 1)) + 1/(2*c^2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -5/2]
Int[x_^2*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c^3*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(2*c^2*d*(q + 1)) + 1/(2*c^2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -5/2]
Int[x_^2*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := -(a + b*ArcTanh[c*x])^(p + 1)/(2*b*c^3*d^2*(p + 1)) + x*(a + b*ArcTanh[c*x])^p/(2*c^2*d*(d + e*x^2)) - b*p/(2*c)*Int[x*(a + b*ArcTanh[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[x_^2*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := -(a + b*ArcCoth[c*x])^(p + 1)/(2*b*c^3*d^2*(p + 1)) + x*(a + b*ArcCoth[c*x])^p/(2*c^2*d*(d + e*x^2)) - b*p/(2*c)*Int[x*(a + b*ArcCoth[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := -b*(f*x)^m*(d + e*x^2)^(q + 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(c^2*d* m) - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := -b*(f*x)^m*(d + e*x^2)^(q + 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(c^2*d* m) - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := -b*p*(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^ p/(c^2*d*m) + b^2*p*(p - 1)/m^2* Int[(f*x)^m*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 2), x] - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1] && GtQ[p, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := -b*p*(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^ p/(c^2*d*m) + b^2*p*(p - 1)/m^2* Int[(f*x)^m*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 2), x] - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1] && GtQ[p, 1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := (f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p + 1)/(b*c* d*(p + 1)) - f*m/(b*c*(p + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := (f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p + 1)/(b*c* d*(p + 1)) - f*m/(b*c*(p + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^ p/(d*(m + 1)) - b*c*p/(m + 1)* Int[(f*x)^(m + 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 3, 0] && GtQ[p, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^ p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 3, 0] && GtQ[p, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])/(f*(m + 2)) - b*c*d/(f*(m + 2))*Int[(f*x)^(m + 1)/Sqrt[d + e*x^2], x] + d/(m + 2)*Int[(f*x)^m*(a + b*ArcTanh[c*x])/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && NeQ[m, -2]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])/(f*(m + 2)) - b*c*d/(f*(m + 2))*Int[(f*x)^(m + 1)/Sqrt[d + e*x^2], x] + d/(m + 2)*Int[(f*x)^m*(a + b*ArcCoth[c*x])/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && NeQ[m, -2]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGtQ[q, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGtQ[q, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d*Int[(f*x)^m*(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^p, x] - c^2*d/f^2* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && IGtQ[p, 0] && (RationalQ[m] || EqQ[p, 1] && IntegerQ[q])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := d*Int[(f*x)^m*(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^p, x] - c^2*d/f^2* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && IGtQ[p, 0] && (RationalQ[m] || EqQ[p, 1] && IntegerQ[q])
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])^p/(c^2*d*m) + b*f*p/(c*m)* Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcTanh[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])^p/(c^2*d*m) + b*f*p/(c*m)* Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcCoth[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && GtQ[m, 1]
Int[(a_. + b_.*ArcTanh[c_.*x_])/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -2/Sqrt[d]*(a + b*ArcTanh[c*x])* ArcTanh[Sqrt[1 - c*x]/Sqrt[1 + c*x]] + b/Sqrt[d]*PolyLog[2, -Sqrt[1 - c*x]/Sqrt[1 + c*x]] - b/Sqrt[d]*PolyLog[2, Sqrt[1 - c*x]/Sqrt[1 + c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -2/Sqrt[d]*(a + b*ArcCoth[c*x])* ArcTanh[Sqrt[1 - c*x]/Sqrt[1 + c*x]] + b/Sqrt[d]*PolyLog[2, -Sqrt[1 - c*x]/Sqrt[1 + c*x]] - b/Sqrt[d]*PolyLog[2, Sqrt[1 - c*x]/Sqrt[1 + c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := 1/Sqrt[d]*Subst[Int[(a + b*x)^p*Csch[x], x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -c*x*Sqrt[1 - 1/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p*Sech[x], x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcTanh[c*x])^p/(x*Sqrt[1 - c^2*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcCoth[c*x])^p/(x*Sqrt[1 - c^2*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_^2*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])^p/(d*x) + b*c*p*Int[(a + b*ArcTanh[c*x])^(p - 1)/(x*Sqrt[d + e*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_^2*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])^p/(d*x) + b*c*p*Int[(a + b*ArcCoth[c*x])^(p - 1)/(x*Sqrt[d + e*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])^p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(a + b*ArcTanh[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + c^2*(m + 2)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*ArcTanh[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])^p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(a + b*ArcCoth[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + c^2*(m + 2)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*ArcCoth[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := 1/e*Int[x^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] - d/e*Int[x^(m - 2)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && IGtQ[m, 1] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := 1/e*Int[x^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] - d/e*Int[x^(m - 2)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && IGtQ[m, 1] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := 1/d*Int[x^m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] - e/d*Int[x^(m + 2)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && ILtQ[m, 0] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := 1/d*Int[x^m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] - e/d*Int[x^(m + 2)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && ILtQ[m, 0] && NeQ[p, -1]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := x^m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p + 1)/(b*c* d*(p + 1)) - m/(b*c*(p + 1))* Int[x^(m - 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] + c*(m + 2*q + 2)/(b*(p + 1))* Int[x^(m + 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && LtQ[q, -1] && LtQ[p, -1] && NeQ[m + 2*q + 2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := x^m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p + 1)/(b*c* d*(p + 1)) - m/(b*c*(p + 1))* Int[x^(m - 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] + c*(m + 2*q + 2)/(b*(p + 1))* Int[x^(m + 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && LtQ[q, -1] && LtQ[p, -1] && NeQ[m + 2*q + 2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^q/c^(m + 1)* Subst[Int[(a + b*x)^p*Sinh[x]^m/Cosh[x]^(m + 2*(q + 1)), x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && (IntegerQ[q] || GtQ[d, 0])
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^(q + 1/2)*Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[x^m*(1 - c^2*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && Not[IntegerQ[q] || GtQ[d, 0]]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^q/c^(m + 1)* Subst[Int[(a + b*x)^p*Cosh[x]^m/Sinh[x]^(m + 2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && IntegerQ[q]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^(q + 1/2)*x* Sqrt[(c^2*x^2 - 1)/(c^2*x^2)]/(c^m*Sqrt[d + e*x^2])* Subst[Int[(a + b*x)^p*Cosh[x]^m/Sinh[x]^(m + 2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && Not[IntegerQ[q]]
Int[x_*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(2*e*(q + 1)) - b*c/(2*e*(q + 1))*Int[(d + e*x^2)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[x_*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(2*e*(q + 1)) - b*c/(2*e*(q + 1))*Int[(d + e*x^2)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^q, x]}, Dist[a + b*ArcTanh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && ( IGtQ[q, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*q + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[q, 0] && GtQ[m + 2*q + 3, 0]] || ILtQ[(m + 2*q + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^q, x]}, Dist[a + b*ArcCoth[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && ( IGtQ[q, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*q + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[q, 0] && GtQ[m + 2*q + 3, 0]] || ILtQ[(m + 2*q + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcTanh[c*x])^p/(1 - Rt[-e/d, 2]*x)^2, x] - 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcTanh[c*x])^p/(1 + Rt[-e/d, 2]*x)^2, x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcCoth[c*x])^p/(1 - Rt[-e/d, 2]*x)^2, x] - 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcCoth[c*x])^p/(1 + Rt[-e/d, 2]*x)^2, x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*ArcTanh[c*x])^p, (f*x)^m*(d + e*x^2)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[q] && IGtQ[p, 0] && (GtQ[q, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*ArcCoth[c*x])^p, (f*x)^m*(d + e*x^2)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[q] && IGtQ[p, 0] && (GtQ[q, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*ArcTanh[c_.*x_]), x_Symbol] := a*Int[(f*x)^m*(d + e*x^2)^q, x] + b*Int[(f*x)^m*(d + e*x^2)^q*ArcTanh[c*x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*ArcCoth[c_.*x_]), x_Symbol] := a*Int[(f*x)^m*(d + e*x^2)^q, x] + b*Int[(f*x)^m*(d + e*x^2)^q*ArcCoth[c*x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^p/(d + e*x^2), (f + g*x)^ m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && IGtQ[m, 0]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^p/(d + e*x^2), (f + g*x)^ m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && IGtQ[m, 0]
Int[ArcTanh[u_]*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] - 1/2*Int[Log[1 - u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[ArcCoth[u_]*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[ Log[SimplifyIntegrand[1 + 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] - 1/2* Int[Log[SimplifyIntegrand[1 - 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[ArcTanh[u_]*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] - 1/2*Int[Log[1 - u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[ArcCoth[u_]*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[ Log[SimplifyIntegrand[1 + 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] - 1/2* Int[Log[SimplifyIntegrand[1 - 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*Log[f_ + g_.*x_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)*Log[f + g*x]/(b*c*d*(p + 1)) - g/(b*c*d*(p + 1))* Int[(a + b*ArcTanh[c*x])^(p + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[c^2*f^2 - g^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*Log[f_ + g_.*x_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)*Log[f + g*x]/(b*c*d*(p + 1)) - g/(b*c*d*(p + 1))* Int[(a + b*ArcCoth[c*x])^(p + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[c^2*f^2 - g^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) - b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) - b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcTanh[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) + b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcCoth[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) + b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcTanh[c*x])^p*PolyLog[k + 1, u]/(2*c*d) + b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcCoth[c*x])^p*PolyLog[k + 1, u]/(2*c*d) + b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^p*PolyLog[k + 1, u]/(2*c*d) - b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^p*PolyLog[k + 1, u]/(2*c*d) - b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcCoth[c_.*x_])*(a_. + b_.*ArcTanh[c_.*x_])), x_Symbol] := (-Log[a + b*ArcCoth[c*x]] + Log[a + b*ArcTanh[c*x]])/(b^2*c* d*(ArcCoth[c*x] - ArcTanh[c*x])) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^ m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(m + 1)*(a + b*ArcTanh[c*x])^ p/(b*c*d*(m + 1)) - p/(m + 1)* Int[(a + b*ArcCoth[c*x])^(m + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGeQ[m, p]
Int[(a_. + b_.*ArcTanh[c_.*x_])^ m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(m + 1)*(a + b*ArcCoth[c*x])^ p/(b*c*d*(m + 1)) - p/(m + 1)* Int[(a + b*ArcTanh[c*x])^(m + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGtQ[m, p]
Int[ArcTanh[a_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := 1/2*Int[Log[1 + a*x]/(c + d*x^n), x] - 1/2*Int[Log[1 - a*x]/(c + d*x^n), x] /; FreeQ[{a, c, d}, x] && IntegerQ[n] && Not[EqQ[n, 2] && EqQ[a^2*c + d, 0]]
Int[ArcCoth[a_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := 1/2*Int[Log[1 + 1/(a*x)]/(c + d*x^n), x] - 1/2*Int[Log[1 - 1/(a*x)]/(c + d*x^n), x] /; FreeQ[{a, c, d}, x] && IntegerQ[n] && Not[EqQ[n, 2] && EqQ[a^2*c + d, 0]]
Int[Log[d_.*x_^m_.]*ArcTanh[c_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[d*x^m]*Log[1 + c*x^n]/x, x] - 1/2*Int[Log[d*x^m]*Log[1 - c*x^n]/x, x] /; FreeQ[{c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*ArcCoth[c_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[d*x^m]*Log[1 + 1/(c*x^n)]/x, x] - 1/2*Int[Log[d*x^m]*Log[1 - 1/(c*x^n)]/x, x] /; FreeQ[{c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*(a_ + b_.*ArcTanh[c_.*x_^n_.])/x_, x_Symbol] := a*Int[Log[d*x^m]/x, x] + b*Int[(Log[d*x^m]*ArcTanh[c*x^n])/x, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*(a_ + b_.*ArcCoth[c_.*x_^n_.])/x_, x_Symbol] := a*Int[Log[d*x^m]/x, x] + b*Int[(Log[d*x^m]*ArcCoth[c*x^n])/x, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := x*(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x]) - 2*e*g*Int[x^2*(a + b*ArcTanh[c*x])/(f + g*x^2), x] - b*c*Int[x*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := x*(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x]) - 2*e*g*Int[x^2*(a + b*ArcCoth[c*x])/(f + g*x^2), x] - b*c*Int[x*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[Log[f_. + g_.*x_^2]*ArcTanh[c_.*x_]/x_, x_Symbol] := (Log[f + g*x^2] - Log[1 - c*x] - Log[1 + c*x])* Int[ArcTanh[c*x]/x, x] - 1/2*Int[Log[1 - c*x]^2/x, x] + 1/2*Int[Log[1 + c*x]^2/x, x] /; FreeQ[{c, f, g}, x] && EqQ[c^2*f + g, 0]
Int[Log[f_. + g_.*x_^2]*ArcCoth[c_.*x_]/x_, x_Symbol] := (Log[f + g*x^2] - Log[-c^2*x^2] - Log[1 - 1/(c*x)] - Log[1 + 1/(c*x)])*Int[ArcCoth[c*x]/x, x] + Int[Log[-c^2*x^2]*ArcCoth[c*x]/x, x] - 1/2*Int[Log[1 - 1/(c*x)]^2/x, x] + 1/2*Int[Log[1 + 1/(c*x)]^2/x, x] /; FreeQ[{c, f, g}, x] && EqQ[c^2*f + g, 0]
Int[Log[f_. + g_.*x_^2]*(a_ + b_.*ArcTanh[c_.*x_])/x_, x_Symbol] := a*Int[Log[f + g*x^2]/x, x] + b*Int[Log[f + g*x^2]*ArcTanh[c*x]/x, x] /; FreeQ[{a, b, c, f, g}, x]
Int[Log[f_. + g_.*x_^2]*(a_ + b_.*ArcCoth[c_.*x_])/x_, x_Symbol] := a*Int[Log[f + g*x^2]/x, x] + b*Int[Log[f + g*x^2]*ArcCoth[c*x]/x, x] /; FreeQ[{a, b, c, f, g}, x]
Int[(d_ + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_])/x_, x_Symbol] := d*Int[(a + b*ArcTanh[c*x])/x, x] + e*Int[Log[f + g*x^2]*(a + b*ArcTanh[c*x])/x, x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[(d_ + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_])/x_, x_Symbol] := d*Int[(a + b*ArcCoth[c*x])/x, x] + e*Int[Log[f + g*x^2]*(a + b*ArcCoth[c*x])/x, x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := x^(m + 1)*(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x])/(m + 1) - 2*e*g/(m + 1)* Int[x^(m + 2)*(a + b*ArcTanh[c*x])/(f + g*x^2), x] - b*c/(m + 1)* Int[x^(m + 1)*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := x^(m + 1)*(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x])/(m + 1) - 2*e*g/(m + 1)* Int[x^(m + 2)*(a + b*ArcCoth[c*x])/(f + g*x^2), x] - b*c/(m + 1)* Int[x^(m + 1)*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*Log[f + g*x^2]), x]}, Dist[a + b*ArcTanh[c*x], u, x] - b*c*Int[ExpandIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[(m + 1)/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*Log[f + g*x^2]), x]}, Dist[a + b*ArcCoth[c*x], u, x] - b*c*Int[ExpandIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[(m + 1)/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(a + b*ArcTanh[c*x]), x]}, Dist[d + e*Log[f + g*x^2], u, x] - 2*e*g*Int[ExpandIntegrand[x*u/(f + g*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(a + b*ArcCoth[c*x]), x]}, Dist[d + e*Log[f + g*x^2], u, x] - 2*e*g*Int[ExpandIntegrand[x*u/(f + g*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_*(d_. + e_.*Log[f_ + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_])^2, x_Symbol] := (f + g*x^2)*(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x])^2/(2*g) - e*x^2*(a + b*ArcTanh[c*x])^2/2 + b/c*Int[(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x]), x] + b*c*e*Int[x^2*(a + b*ArcTanh[c*x])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*f + g, 0]
Int[x_*(d_. + e_.*Log[f_ + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_])^2, x_Symbol] := (f + g*x^2)*(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x])^2/(2*g) - e*x^2*(a + b*ArcCoth[c*x])^2/2 + b/c*Int[(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x]), x] + b*c*e*Int[x^2*(a + b*ArcCoth[c*x])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*f + g, 0]
Int[u_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_. + e_.*x)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x)^q_. /; FreeQ[{d, e, f, m, q}, x]] || MatchQ[u, (d_. + e_.*x^2)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x^2)^q_. /; FreeQ[{d, e, f, m, q}, x]])
Int[u_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_. + e_.*x)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x)^q_. /; FreeQ[{d, e, f, m, q}, x]] || MatchQ[u, (d_. + e_.*x^2)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x^2)^q_. /; FreeQ[{d, e, f, m, q}, x]])
Int[ArcTanh[c_.*x_^n_], x_Symbol] := x*ArcTanh[c*x^n] - c*n*Int[x^n/(1 - c^2*x^(2*n)), x] /; FreeQ[{c, n}, x]
Int[ArcCoth[c_.*x_^n_], x_Symbol] := x*ArcCoth[c*x^n] - c*n*Int[x^n/(1 - c^2*x^(2*n)), x] /; FreeQ[{c, n}, x]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[1 + c*x^n]/2 - b*Log[1 - c*x^n]/2)^ p, x], x] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0] && IntegerQ[n]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*Log[1 + x^(-n)/c]/2 - b*Log[1 - x^(-n)/c]/2)^p, x], x] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0] && IntegerQ[n]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])^p_./x_, x_Symbol] := 1/n*Subst[Int[(a + b*ArcTanh[c*x])^p/x, x], x, x^n] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])^p_./x_, x_Symbol] := 1/n*Subst[Int[(a + b*ArcCoth[c*x])^p/x, x], x, x^n] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcTanh[c*x^n])/(d*(m + 1)) - b*c*n/(d*(m + 1))* Int[x^(n - 1)*(d*x)^(m + 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCoth[c*x^n])/(d*(m + 1)) - b*c*n/(d*(m + 1))* Int[x^(n - 1)*(d*x)^(m + 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_., x_Symbol] := Int[ExpandIntegrand[(d*x)^ m*(a + b*Log[1 + c*x^n]/2 - b*Log[1 - c*x^n]/2)^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0] && IntegerQ[m] && IntegerQ[n]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_., x_Symbol] := Int[ExpandIntegrand[(d*x)^ m*(a + b*Log[1 + x^(-n)/c]/2 - b*Log[1 - x^(-n)/c]/2)^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0] && IntegerQ[m] && IntegerQ[n]
Int[u_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcTanh[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_.*x)^m_. /; FreeQ[{d, m}, x]]) 
Int[u_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcCoth[c*x^n])^p, x] /; FreeQ[{a, b, c, n, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_.*x)^m_. /; FreeQ[{d, m}, x]]) 

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.2 (d x)^m (a+b arctanh(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.2 (d x)^m (a+b arctanh(c x^n))^p *)
Int[(a_. + b_.*ArcTanh[c_.*x_])/x_, x_Symbol] := a*Log[x] - b/2*PolyLog[2, -c*x] + b/2*PolyLog[2, c*x] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcCoth[c_.*x_])/x_, x_Symbol] := a*Log[x] + b/2*PolyLog[2, -1/(c*x)] - b/2*PolyLog[2, 1/(c*x)] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_/x_, x_Symbol] := 2*(a + b*ArcTanh[c*x])^p*ArcTanh[1 - 2/(1 - c*x)] - 2*b*c*p* Int[(a + b*ArcTanh[c*x])^(p - 1)* ArcTanh[1 - 2/(1 - c*x)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_/x_, x_Symbol] := 2*(a + b*ArcCoth[c*x])^p*ArcCoth[1 - 2/(1 - c*x)] - 2*b*c*p* Int[(a + b*ArcCoth[c*x])^(p - 1)* ArcCoth[1 - 2/(1 - c*x)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])^p_./x_, x_Symbol] := 1/n*Subst[Int[(a + b*ArcTanh[c*x])^p/x, x], x, x^n] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])^p_./x_, x_Symbol] := 1/n*Subst[Int[(a + b*ArcCoth[c*x])^p/x, x], x, x^n] /; FreeQ[{a, b, c, n}, x] && IGtQ[p, 0]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_.])^p_., x_Symbol] := x^(m + 1)*(a + b*ArcTanh[c*x^n])^p/(m + 1) - b*c*n*p/(m + 1)* Int[x^(m + n)*(a + b*ArcTanh[c*x^n])^(p - 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || EqQ[n, 1] && IntegerQ[m]) && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_.])^p_., x_Symbol] := x^(m + 1)*(a + b*ArcCoth[c*x^n])^p/(m + 1) - b*c*n*p/(m + 1)* Int[x^(m + n)*(a + b*ArcCoth[c*x^n])^(p - 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || EqQ[n, 1] && IntegerQ[m]) && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*ArcTanh[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 1] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_., x_Symbol] := 1/n*Subst[ Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*ArcCoth[c*x])^p, x], x, x^n] /; FreeQ[{a, b, c, m, n}, x] && IGtQ[p, 1] && IntegerQ[Simplify[(m + 1)/n]]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[ x^m*(a + b*Log[1 + c*x^n]/2 - b*Log[1 - c*x^n]/2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[ x^m*(a + b*Log[1 + x^(-n)/c]/2 - b*Log[1 - x^(-n)/c]/2)^p, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && IntegerQ[m]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[m]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcTanh[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && FractionQ[m]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[m]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcCoth[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c}, x] && IGtQ[p, 1] && IGtQ[n, 0] && FractionQ[m]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := Int[x^m*(a + b*ArcCoth[x^(-n)/c])^p, x] /; FreeQ[{a, b, c, m}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := Int[x^m*(a + b*ArcTanh[x^(-n)/c])^p, x] /; FreeQ[{a, b, c, m}, x] && IGtQ[p, 1] && ILtQ[n, 0]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcTanh[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, m}, x] && IGtQ[p, 1] && FractionQ[n]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*ArcCoth[c*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, m}, x] && IGtQ[p, 1] && FractionQ[n]
Int[(d_*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_^n_.]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcTanh[c*x^n])/(d*(m + 1)) - b*c*n/(d^n*(m + 1))*Int[(d*x)^(m + n)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[n] && NeQ[m, -1]
Int[(d_*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_^n_.]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCoth[c*x^n])/(d*(m + 1)) - b*c*n/(d^n*(m + 1))*Int[(d*x)^(m + n)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[n] && NeQ[m, -1]
Int[(d_*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_^n_.])^p_., x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*ArcTanh[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || RationalQ[m, n])
Int[(d_*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_^n_.])^p_., x_Symbol] := d^IntPart[m]*(d*x)^FracPart[m]/x^FracPart[m]* Int[x^m*(a + b*ArcCoth[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0] && (EqQ[p, 1] || RationalQ[m, n])
Int[(d_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcTanh[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_.])^p_., x_Symbol] := Unintegrable[(d*x)^m*(a + b*ArcCoth[c*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.2 u (a+b arctanh(c+d x))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.2 u (a+b arctanh(c+d x))^p *)
Int[(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcTanh[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcCoth[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := (e + f*x)^(m + 1)*(a + b*ArcTanh[c + d*x])^p/(f*(m + 1)) - b*d*p/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(a + b*ArcTanh[c + d*x])^(p - 1)/(1 - (c + d*x)^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := (e + f*x)^(m + 1)*(a + b*ArcCoth[c + d*x])^p/(f*(m + 1)) - b*d*p/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(a + b*ArcCoth[c + d*x])^(p - 1)/(1 - (c + d*x)^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcTanh[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcCoth[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[ArcTanh[c_ + d_.*x_]/(e_ + f_.*x_^n_.), x_Symbol] := 1/2*Int[Log[1 + c + d*x]/(e + f*x^n), x] - 1/2*Int[Log[1 - c - d*x]/(e + f*x^n), x] /; FreeQ[{c, d, e, f}, x] && RationalQ[n]
Int[ArcCoth[c_ + d_.*x_]/(e_ + f_.*x_^n_.), x_Symbol] := 1/2*Int[Log[(1 + c + d*x)/(c + d*x)]/(e + f*x^n), x] - 1/2*Int[Log[(-1 + c + d*x)/(c + d*x)]/(e + f*x^n), x] /; FreeQ[{c, d, e, f}, x] && RationalQ[n]
Int[ArcTanh[c_ + d_.*x_]/(e_ + f_.*x_^n_), x_Symbol] := Unintegrable[ArcTanh[c + d*x]/(e + f*x^n), x] /; FreeQ[{c, d, e, f, n}, x] && Not[RationalQ[n]]
Int[ArcCoth[c_ + d_.*x_]/(e_ + f_.*x_^n_), x_Symbol] := Unintegrable[ArcCoth[c + d*x]/(e + f*x^n), x] /; FreeQ[{c, d, e, f, n}, x] && Not[RationalQ[n]]
Int[(A_. + B_.*x_ + C_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^ p_., x_Symbol] := 1/d*Subst[Int[(-C/d^2 + C/d^2*x^2)^q*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^ p_., x_Symbol] := 1/d*Subst[Int[(C/d^2 + C/d^2*x^2)^q*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ q_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ q*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ q_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ q*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.3 (d+e x)^m (a+b arctanh(c x^n))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.3 (d+e x)^m (a+b arctanh(c x^n))^p *)
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])^p*Log[2/(1 + e*x/d)]/e + b*c*p/e* Int[(a + b*ArcTanh[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])^p*Log[2/(1 + e*x/d)]/e + b*c*p/e* Int[(a + b*ArcCoth[c*x])^(p - 1)*Log[2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])*Log[2/(1 + c*x)]/e + b*c/e*Int[Log[2/(1 + c*x)]/(1 - c^2*x^2), x] + (a + b*ArcTanh[c*x])*Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*c/e* Int[Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])*Log[2/(1 + c*x)]/e + b*c/e*Int[Log[2/(1 + c*x)]/(1 - c^2*x^2), x] + (a + b*ArcCoth[c*x])*Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*c/e* Int[Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])^2*Log[2/(1 + c*x)]/e + b*(a + b*ArcTanh[c*x])*PolyLog[2, 1 - 2/(1 + c*x)]/e + b^2*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + (a + b*ArcTanh[c*x])^2* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*(a + b*ArcTanh[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b^2*PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^2/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])^2*Log[2/(1 + c*x)]/e + b*(a + b*ArcCoth[c*x])*PolyLog[2, 1 - 2/(1 + c*x)]/e + b^2*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + (a + b*ArcCoth[c*x])^2* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b*(a + b*ArcCoth[c*x])* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - b^2*PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcTanh[c*x])^3*Log[2/(1 + c*x)]/e + 3*b*(a + b*ArcTanh[c*x])^2*PolyLog[2, 1 - 2/(1 + c*x)]/(2*e) + 3*b^2*(a + b*ArcTanh[c*x])*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + 3*b^3*PolyLog[4, 1 - 2/(1 + c*x)]/(4*e) + (a + b*ArcTanh[c*x])^3* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - 3*b*(a + b*ArcTanh[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^2*(a + b*ArcTanh[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^3*PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^3/(d_ + e_.*x_), x_Symbol] := -(a + b*ArcCoth[c*x])^3*Log[2/(1 + c*x)]/e + 3*b*(a + b*ArcCoth[c*x])^2*PolyLog[2, 1 - 2/(1 + c*x)]/(2*e) + 3*b^2*(a + b*ArcCoth[c*x])*PolyLog[3, 1 - 2/(1 + c*x)]/(2*e) + 3*b^3*PolyLog[4, 1 - 2/(1 + c*x)]/(4*e) + (a + b*ArcCoth[c*x])^3* Log[2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/e - 3*b*(a + b*ArcCoth[c*x])^2* PolyLog[2, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^2*(a + b*ArcCoth[c*x])* PolyLog[3, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(2*e) - 3*b^3*PolyLog[4, 1 - 2*c*(d + e*x)/((c*d + e)*(1 + c*x))]/(4*e) /; FreeQ[{a, b, c, d, e}, x] && NeQ[c^2*d^2 - e^2, 0]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTanh[c*x])/(e*(q + 1)) - b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCoth[c*x])/(e*(q + 1)) - b*c/(e*(q + 1))*Int[(d + e*x)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcTanh[c*x])^p/(e*(q + 1)) - b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 - c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := (d + e*x)^(q + 1)*(a + b*ArcCoth[c*x])^p/(e*(q + 1)) - b*c*p/(e*(q + 1))* Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^(p - 1), (d + e*x)^(q + 1)/(1 - c^2*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 1] && IntegerQ[q] && NeQ[q, -1]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])/(d_. + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*ArcTanh[c*x^n])/e - b*c*n/e*Int[x^(n - 1)*Log[d + e*x]/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[n]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])/(d_. + e_.*x_), x_Symbol] := Log[d + e*x]*(a + b*ArcCoth[c*x^n])/e - b*c*n/e*Int[x^(n - 1)*Log[d + e*x]/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, n}, x] && IntegerQ[n]
Int[(a_. + b_.*ArcTanh[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcTanh[c*x^(k*n)])/(d + e*x^k), x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[n]
Int[(a_. + b_.*ArcCoth[c_.*x_^n_])/(d_ + e_.*x_), x_Symbol] := With[{k = Denominator[n]}, k*Subst[Int[x^(k - 1)*(a + b*ArcCoth[c*x^(k*n)])/(d + e*x^k), x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && FractionQ[n]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcTanh[c*x^n])/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[x^(n - 1)*(d + e*x)^(m + 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCoth[c*x^n])/(e*(m + 1)) - b*c*n/(e*(m + 1))* Int[x^(n - 1)*(d + e*x)^(m + 1)/(1 - c^2*x^(2*n)), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x^n])^p, (d + e*x)^m, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 1] && IGtQ[m, 0]
Int[(d_ + e_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_, x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x^n])^p, (d + e*x)^m, x], x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[p, 1] && IGtQ[m, 0]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[(d + e*x)^m*(a + b*ArcTanh[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_^n_])^p_., x_Symbol] := Unintegrable[(d + e*x)^m*(a + b*ArcCoth[c*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.3 Exponentials of inverse hyperbolic tangent.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.3 Exponentials of inverse hyperbolic tangent *)
Int[E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := Int[((1 + a*x)^((n + 1)/2)/((1 - a*x)^((n - 1)/2)* Sqrt[1 - a^2*x^2])), x] /; FreeQ[a, x] && IntegerQ[(n - 1)/2]
Int[x_^m_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := Int[x^ m*((1 + a*x)^((n + 1)/2)/((1 - a*x)^((n - 1)/2)* Sqrt[1 - a^2*x^2])), x] /; FreeQ[{a, m}, x] && IntegerQ[(n - 1)/2]
Int[E^(n_*ArcTanh[a_.*x_]), x_Symbol] := Int[(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, n}, x] && Not[IntegerQ[(n - 1)/2]]
Int[x_^m_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := Int[x^m*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[(n - 1)/2]]
Int[(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^n*Int[(c + d*x)^(p - n)*(1 - a^2*x^2)^(n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[a*c + d, 0] && IntegerQ[(n - 1)/2] && IntegerQ[2*p]
Int[(e_. + f_.*x_)^m_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^n*Int[(e + f*x)^m*(c + d*x)^(p - n)*(1 - a^2*x^2)^(n/2), x] /; FreeQ[{a, c, d, e, f, m, p}, x] && EqQ[a*c + d, 0] && IntegerQ[(n - 1)/2] && (IntegerQ[p] || EqQ[p, n/2] || EqQ[p - n/2 - 1, 0]) && IntegerQ[2*p]
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[u*(1 + d*x/c)^p*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 - d^2, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := Int[u*(c + d*x)^p*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 - d^2, 0] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_.*(c_ + d_./x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := d^p*Int[u*(1 + c*x/d)^p*E^(n*ArcTanh[a*x])/x^p, x] /; FreeQ[{a, c, d, n}, x] && EqQ[c^2 - a^2*d^2, 0] && IntegerQ[p]
Int[u_.*(c_ + d_./x_)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (-1)^(n/2)*c^p* Int[u*(1 + d/(c*x))^p*(1 + 1/(a*x))^(n/2)/(1 - 1/(a*x))^(n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && GtQ[c, 0]
Int[u_.*(c_ + d_./x_)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := Int[u*(c + d/x)^p*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && Not[GtQ[c, 0]]
Int[u_.*(c_ + d_./x_)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := x^p*(c + d/x)^p/(1 + c*x/d)^p* Int[u*(1 + c*x/d)^p*E^(n*ArcTanh[a*x])/x^p, x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[p]]
Int[E^(n_*ArcTanh[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (n - a*x)*E^(n*ArcTanh[a*x])/(a*c*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (n + 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTanh[a*x])/(a*c*(n^2 - 4*(p + 1)^2)) - 2*(p + 1)*(2*p + 3)/(c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && LtQ[p, -1] && Not[IntegerQ[n]] && NeQ[n^2 - 4*(p + 1)^2, 0] && IntegerQ[2*p]
Int[E^(n_.*ArcTanh[a_.*x_])/(c_ + d_.*x_^2), x_Symbol] := E^(n*ArcTanh[a*x])/(a*c*n) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[(1 - a^2*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && IntegerQ[p] && IGtQ[(n + 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[(1 - a^2*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && IntegerQ[p] && ILtQ[(n - 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^(n/2)*Int[(c + d*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && IGtQ[n/2, 0]
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := 1/c^(n/2)*Int[(c + d*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && ILtQ[n/2, 0]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 - a^2*x^2)^FracPart[p]* Int[(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[x_*E^(n_*ArcTanh[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (1 - a*n*x)*E^(n*ArcTanh[a*x])/(d*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[x_*(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (c + d*x^2)^(p + 1)*E^(n*ArcTanh[a*x])/(2*d*(p + 1)) - a*c*n/(2*d*(p + 1))*Int[(c + d*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && LtQ[p, -1] && Not[IntegerQ[n]] && IntegerQ[2*p]
(* Int[x_*(c_+d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]),x_Symbol] := -(2*(p+1)+a*n*x)*(c+d*x^2)^(p+1)*E^(n*ArcTanh[a*x])/(d*(n^2-4*(p+1)^ 2)) - n*(2*p+3)/(a*c*(n^2-4*(p+1)^2))*Int[(c+d*x^2)^(p+1)*E^(n*ArcTanh[a* x]),x] /; FreeQ[{a,c,d,n},x] && EqQ[a^2*c+d,0] && LeQ[p,-1] &&  NeQ[n^2-4*(p+1)^2,0] && Not[IntegerQ[n]] *)
Int[x_^2*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (1 - a*n*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTanh[a*x])/(a*d*n*(n^2 - 1)) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && EqQ[n^2 + 2*(p + 1), 0] && Not[IntegerQ[n]]
Int[x_^2*(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := -(n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTanh[a*x])/(a*d*(n^2 - 4*(p + 1)^2)) + (n^2 + 2*(p + 1))/(d*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && LtQ[p, -1] && Not[IntegerQ[n]] && NeQ[n^2 - 4*(p + 1)^2, 0] && IntegerQ[2*p]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - a^2*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0]) && IGtQ[(n + 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - a^2*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0]) && ILtQ[(n - 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^(n/2)*Int[x^m*(c + d*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && IGtQ[n/2, 0]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := 1/c^(n/2)*Int[x^m*(c + d*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && ILtQ[n/2, 0]
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 - a^2*x^2)^FracPart[p]* Int[x^m*(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && Not[IntegerQ[n/2]]
Int[u_*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[u*(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[u_*(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^ FracPart[p]/((1 - a*x)^FracPart[p]*(1 + a*x)^FracPart[p])* Int[u*(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && IntegerQ[n/2]
Int[u_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 - a^2*x^2)^FracPart[p]* Int[u*(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && Not[IntegerQ[n/2]]
Int[u_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := d^p*Int[u/x^(2*p)*(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[c + a^2*d, 0] && IntegerQ[p]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[u*(1 - 1/(a*x))^p*(1 + 1/(a*x))^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && GtQ[c, 0]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := x^(2*p)*(c + d/x^2)^p/((1 - a*x)^p*(1 + a*x)^p)* Int[u/x^(2*p)*(1 - a*x)^p*(1 + a*x)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && Not[GtQ[c, 0]]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := x^(2*p)*(c + d/x^2)^p/(1 + c*x^2/d)^p* Int[u/x^(2*p)*(1 + c*x^2/d)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[p]] && Not[IntegerQ[n/2]]
Int[E^(n_.*ArcTanh[c_.*(a_ + b_.*x_)]), x_Symbol] := Int[(1 + a*c + b*c*x)^(n/2)/(1 - a*c - b*c*x)^(n/2), x] /; FreeQ[{a, b, c, n}, x]
Int[x_^m_*E^(n_*ArcTanh[c_.*(a_ + b_.*x_)]), x_Symbol] := 4/(n*b^(m + 1)*c^(m + 1))* Subst[ Int[x^(2/n)*(-1 - a*c + (1 - a*c)*x^(2/n))^ m/(1 + x^(2/n))^(m + 2), x], x, (1 + c*(a + b*x))^(n/2)/(1 - c*(a + b*x))^(n/2)] /; FreeQ[{a, b, c}, x] && ILtQ[m, 0] && LtQ[-1, n, 1]
Int[(d_. + e_.*x_)^m_.*E^(n_.*ArcTanh[c_.*(a_ + b_.*x_)]), x_Symbol] := Int[(d + e*x)^m*(1 + a*c + b*c*x)^(n/2)/(1 - a*c - b*c*x)^(n/2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcTanh[a_ + b_.*x_]), x_Symbol] := (c/(1 - a^2))^p* Int[u*(1 - a - b*x)^(p - n/2)*(1 + a + b*x)^(p + n/2), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && (IntegerQ[p] || GtQ[c/(1 - a^2), 0])
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcTanh[a_ + b_.*x_]), x_Symbol] := (c + d*x + e*x^2)^p/(1 - a^2 - 2*a*b*x - b^2*x^2)^p* Int[u*(1 - a^2 - 2*a*b*x - b^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && Not[IntegerQ[p] || GtQ[c/(1 - a^2), 0]]
Int[u_.*E^(n_.*ArcTanh[c_./(a_. + b_.*x_)]), x_Symbol] := Int[u*E^(n*ArcCoth[a/c + b*x/c]), x] /; FreeQ[{a, b, c, n}, x]
Int[u_.*E^(n_*ArcCoth[a_.*x_]), x_Symbol] := (-1)^(n/2)*Int[u*E^(n*ArcTanh[a*x]), x] /; FreeQ[a, x] && IntegerQ[n/2]
Int[E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -Subst[ Int[(1 + x/a)^((n + 1)/2)/(x^2*(1 - x/a)^((n - 1)/2)* Sqrt[1 - x^2/a^2]), x], x, 1/x] /; FreeQ[a, x] && IntegerQ[(n - 1)/2]
Int[x_^m_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -Subst[ Int[(1 + x/a)^((n + 1)/2)/(x^(m + 2)*(1 - x/a)^((n - 1)/2)* Sqrt[1 - x^2/a^2]), x], x, 1/x] /; FreeQ[a, x] && IntegerQ[(n - 1)/2] && IntegerQ[m]
Int[E^(n_*ArcCoth[a_.*x_]), x_Symbol] := -Subst[Int[(1 + x/a)^(n/2)/(x^2*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, n}, x] && Not[IntegerQ[n]]
Int[x_^m_.*E^(n_*ArcCoth[a_.*x_]), x_Symbol] := -Subst[Int[(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[x_^m_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -x^m*(1/x)^m* Subst[Int[(1 + x/a)^((n + 1)/2)/(x^(m + 2)*(1 - x/a)^((n - 1)/2)* Sqrt[1 - x^2/a^2]), x], x, 1/x] /; FreeQ[{a, m}, x] && IntegerQ[(n - 1)/2] && Not[IntegerQ[m]]
Int[x_^m_*E^(n_*ArcCoth[a_.*x_]), x_Symbol] := -x^m*(1/x)^m* Subst[Int[(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]
Int[(c_ + d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (1 + a*x)*(c + d*x)^p*E^(n*ArcCoth[a*x])/(a*(p + 1)) /; FreeQ[{a, c, d, n, p}, x] && EqQ[a*c + d, 0] && EqQ[p, n/2] && Not[IntegerQ[n/2]]
(* Int[(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Subst[Int[(d+c*x)^(p-n)*(1-x^2/a^2)^(n/2)/x^(p+2),x],x, 1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] && IntegerQ[p] *)
(* Int[x_^m_.*(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Subst[Int[(d+c*x)^(p-n)*(1-x^2/a^2)^(n/2)/x^(m+p+2),x], x,1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] && IntegerQ[m] &&  IntegerQ[p] *)
(* Int[(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Sqrt[c+d*x]/(Sqrt[x]*Sqrt[d+c/x])*Subst[Int[(d+c*x)^(p- n)*(1-x^2/a^2)^(n/2)/x^(p+2),x],x,1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] &&  IntegerQ[p-1/2] *)
(* Int[x_^m_.*(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Sqrt[c+d*x]/(Sqrt[x]*Sqrt[d+c/x])*Subst[Int[(d+c*x)^(p- n)*(1-x^2/a^2)^(n/2)/x^(m+p+2),x],x,1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] && IntegerQ[m] &&  IntegerQ[p-1/2] *)
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := d^p*Int[u*x^p*(1 + c/(d*x))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c^2 - d^2, 0] && Not[IntegerQ[n/2]] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (c + d*x)^p/(x^p*(1 + c/(d*x))^p)* Int[u*x^p*(1 + c/(d*x))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 - d^2, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p]]
Int[(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^n*Subst[Int[(c + d*x)^(p - n)*(1 - x^2/a^2)^(n/2)/x^2, x], x, 1/x] /; FreeQ[{a, c, d, p}, x] && EqQ[c + a*d, 0] && IntegerQ[(n - 1)/2] && (IntegerQ[p] || EqQ[p, n/2] || EqQ[p, n/2 + 1]) && IntegerQ[2*p]
Int[x_^m_.*(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^n*Subst[Int[(c + d*x)^(p - n)*(1 - x^2/a^2)^(n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, p}, x] && EqQ[c + a*d, 0] && IntegerQ[(n - 1)/2] && IntegerQ[ m] && (IntegerQ[p] || EqQ[p, n/2] || EqQ[p, n/2 + 1] || LtQ[-5, m, -1]) && IntegerQ[2*p]
Int[(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 + d*x/c)^p*(1 + x/a)^(n/2)/(x^2*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0])
Int[x_^m_.*(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 + d*x/c)^p*(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && IntegerQ[m]
Int[x_^m_*(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*x^m*(1/x)^m* Subst[Int[(1 + d*x/c)^ p*(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegerQ[m]]
Int[u_.*(c_ + d_./x_)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (c + d/x)^p/(1 + d/(c*x))^p* Int[u*(1 + d/(c*x))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[E^(n_.*ArcCoth[a_.*x_])/(c_ + d_.*x_^2), x_Symbol] := E^(n*ArcCoth[a*x])/(a*c*n) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]]
Int[E^(n_*ArcCoth[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (n - a*x)*E^(n*ArcCoth[a*x])/(a*c*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (n + 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a*c*(n^2 - 4*(p + 1)^2)) - 2*(p + 1)*(2*p + 3)/(c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && LtQ[p, -1] && NeQ[p, -3/2] && NeQ[n^2 - 4*(p + 1)^2, 0] && (IntegerQ[p] || Not[IntegerQ[n]])
Int[x_*E^(n_*ArcCoth[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := -(1 - a*n*x)*E^(n*ArcCoth[a*x])/(a^2*c*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[x_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (2*(p + 1) + a*n*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a^2*c*(n^2 - 4*(p + 1)^2)) - n*(2*p + 3)/(a*c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && LeQ[p, -1] && NeQ[p, -3/2] && NeQ[n^2 - 4*(p + 1)^2, 0] && (IntegerQ[p] || Not[IntegerQ[n]])
Int[x_^2*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -(n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a^3*c*n^2*(n^2 - 1)) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && EqQ[n^2 + 2*(p + 1), 0] && NeQ[n^2, 1]
Int[x_^2*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a^3*c*(n^2 - 4*(p + 1)^2)) - (n^2 + 2*(p + 1))/(a^2*c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && LeQ[p, -1] && NeQ[n^2 + 2*(p + 1), 0] && NeQ[n^2 - 4*(p + 1)^2, 0] && (IntegerQ[p] || Not[IntegerQ[n]])
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -(-c)^p/a^(m + 1)* Subst[Int[E^(n*x)*Coth[x]^(m + 2*(p + 1))/Cosh[x]^(2*(p + 1)), x], x, ArcCoth[a*x]] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && IntegerQ[m] && LeQ[3, m, -2 (p + 1)] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := d^p*Int[u*x^(2*p)*(1 - 1/(a^2*x^2))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (c + d*x^2)^p/(x^(2*p)*(1 - 1/(a^2*x^2))^p)* Int[u*x^(2*p)*(1 - 1/(a^2*x^2))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p]]
Int[u_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := c^p/a^(2*p)* Int[u/x^(2*p)*(-1 + a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && IntegersQ[2*p, p + n/2]
Int[(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[Int[(1 - x/a)^(p - n/2)*(1 + x/a)^(p + n/2)/x^2, x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegersQ[2*p, p + n/2]]
Int[x_^m_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 - x/a)^(p - n/2)*(1 + x/a)^(p + n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegersQ[2*p, p + n/2]] && IntegerQ[m]
Int[x_^m_*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*x^m*(1/x)^m* Subst[Int[(1 - x/a)^(p - n/2)*(1 + x/a)^(p + n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegersQ[2*p, p + n/2]] && Not[IntegerQ[m]]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d/x^2)^FracPart[p]/(1 - 1/(a^2*x^2))^FracPart[p]* Int[u*(1 - 1/(a^2*x^2))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_.*E^(n_*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (-1)^(n/2)*Int[u*E^(n*ArcTanh[c*(a + b*x)]), x] /; FreeQ[{a, b, c}, x] && IntegerQ[n/2]
Int[E^(n_.*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (c*(a + b*x))^(n/ 2)*(1 + 1/(c*(a + b*x)))^(n/2)/(1 + a*c + b*c*x)^(n/2)* Int[(1 + a*c + b*c*x)^(n/2)/(-1 + a*c + b*c*x)^(n/2), x] /; FreeQ[{a, b, c, n}, x] && Not[IntegerQ[n/2]]
Int[x_^m_*E^(n_*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := -4/(n*b^(m + 1)*c^(m + 1))* Subst[ Int[x^(2/n)*(1 + a*c + (1 - a*c)*x^(2/n))^ m/(-1 + x^(2/n))^(m + 2), x], x, (1 + 1/(c*(a + b*x)))^(n/2)/(1 - 1/(c*(a + b*x)))^(n/2)] /; FreeQ[{a, b, c}, x] && ILtQ[m, 0] && LtQ[-1, n, 1]
Int[(d_. + e_.*x_)^m_.*E^(n_.*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (c*(a + b*x))^(n/ 2)*(1 + 1/(c*(a + b*x)))^(n/2)/(1 + a*c + b*c*x)^(n/2)* Int[(d + e*x)^m*(1 + a*c + b*c*x)^(n/2)/(-1 + a*c + b*c*x)^(n/2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && Not[IntegerQ[n/2]]
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcCoth[a_ + b_.*x_]), x_Symbol] := (c/(1 - a^2))^ p*((a + b*x)/(1 + a + b*x))^(n/2)*((1 + a + b*x)/(a + b*x))^(n/ 2)*((1 - a - b*x)^(n/2)/(-1 + a + b*x)^(n/2))* Int[u*(1 - a - b*x)^(p - n/2)*(1 + a + b*x)^(p + n/2), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && Not[IntegerQ[n/2]] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && (IntegerQ[p] || GtQ[c/(1 - a^2), 0])
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcCoth[a_ + b_.*x_]), x_Symbol] := (c + d*x + e*x^2)^p/(1 - a^2 - 2*a*b*x - b^2*x^2)^p* Int[u*(1 - a^2 - 2*a*b*x - b^2*x^2)^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && Not[IntegerQ[n/2]] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && Not[IntegerQ[p] || GtQ[c/(1 - a^2), 0]]
Int[u_.*E^(n_.*ArcCoth[c_./(a_. + b_.*x_)]), x_Symbol] := Int[u*E^(n*ArcTanh[a/c + b*x/c]), x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.4 Miscellaneous inverse hyperbolic tangent.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.4 Miscellaneous inverse hyperbolic tangent *)
Int[ArcTanh[a_ + b_.*x_^n_], x_Symbol] := x*ArcTanh[a + b*x^n] - b*n*Int[x^n/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b, n}, x]
Int[ArcCoth[a_ + b_.*x_^n_], x_Symbol] := x*ArcCoth[a + b*x^n] - b*n*Int[x^n/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b, n}, x]
Int[ArcTanh[a_. + b_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[1 + a + b*x^n]/x, x] - 1/2*Int[Log[1 - a - b*x^n]/x, x] /; FreeQ[{a, b, n}, x]
Int[ArcCoth[a_. + b_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[1 + 1/(a + b*x^n)]/x, x] - 1/2*Int[Log[1 - 1/(a + b*x^n)]/x, x] /; FreeQ[{a, b, n}, x]
Int[x_^m_.*ArcTanh[a_ + b_.*x_^n_], x_Symbol] := x^(m + 1)*ArcTanh[a + b*x^n]/(m + 1) - b*n/(m + 1)* Int[x^(m + n)/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b}, x] && RationalQ[m, n] && NeQ[m, -1] && NeQ[m + 1, n]
Int[x_^m_.*ArcCoth[a_ + b_.*x_^n_], x_Symbol] := x^(m + 1)*ArcCoth[a + b*x^n]/(m + 1) - b*n/(m + 1)* Int[x^(m + n)/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b}, x] && RationalQ[m, n] && NeQ[m, -1] && NeQ[m + 1, n]
Int[ArcTanh[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[Log[1 + a + b*f^(c + d*x)], x] - 1/2*Int[Log[1 - a - b*f^(c + d*x)], x] /; FreeQ[{a, b, c, d, f}, x] 
Int[ArcCoth[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[Log[1 + 1/(a + b*f^(c + d*x))], x] - 1/2*Int[Log[1 - 1/(a + b*f^(c + d*x))], x] /; FreeQ[{a, b, c, d, f}, x] 
Int[x_^m_.*ArcTanh[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[x^m*Log[1 + a + b*f^(c + d*x)], x] - 1/2*Int[x^m*Log[1 - a - b*f^(c + d*x)], x] /; FreeQ[{a, b, c, d, f}, x] && IGtQ[m, 0]
Int[x_^m_.*ArcCoth[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[x^m*Log[1 + 1/(a + b*f^(c + d*x))], x] - 1/2*Int[x^m*Log[1 - 1/(a + b*f^(c + d*x))], x] /; FreeQ[{a, b, c, d, f}, x] && IGtQ[m, 0]
Int[u_.*ArcTanh[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCoth[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*ArcCoth[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcTanh[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := x*ArcTanh[(c*x)/Sqrt[a + b*x^2]] - c*Int[x/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := x*ArcCoth[(c*x)/Sqrt[a + b*x^2]] - c*Int[x/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]/x_, x_Symbol] := ArcTanh[c*x/Sqrt[a + b*x^2]]*Log[x] - c*Int[Log[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]/x_, x_Symbol] := ArcCoth[c*x/Sqrt[a + b*x^2]]*Log[x] - c*Int[Log[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[(d_.*x_)^m_.*ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := (d*x)^(m + 1)*ArcTanh[(c*x)/Sqrt[a + b*x^2]]/(d*(m + 1)) - c/(d*(m + 1))*Int[(d*x)^(m + 1)/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[(d_.*x_)^m_.*ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := (d*x)^(m + 1)*ArcCoth[(c*x)/Sqrt[a + b*x^2]]/(d*(m + 1)) - c/(d*(m + 1))*Int[(d*x)^(m + 1)/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[1/(Sqrt[a_. + b_.*x_^2]*ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]), x_Symbol] := 1/c*Log[ArcTanh[c*x/Sqrt[a + b*x^2]]] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[1/(Sqrt[a_. + b_.*x_^2]*ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]), x_Symbol] := -1/c*Log[ArcCoth[c*x/Sqrt[a + b*x^2]]] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[a_. + b_.*x_^2], x_Symbol] := ArcTanh[c*x/Sqrt[a + b*x^2]]^(m + 1)/(c*(m + 1)) /; FreeQ[{a, b, c, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[a_. + b_.*x_^2], x_Symbol] := -ArcCoth[c*x/Sqrt[a + b*x^2]]^(m + 1)/(c*(m + 1)) /; FreeQ[{a, b, c, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[d_. + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[d + e*x^2]* Int[ArcTanh[c*x/Sqrt[a + b*x^2]]^m/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b, c^2] && EqQ[b*d - a*e, 0]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[d_. + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[d + e*x^2]* Int[ArcCoth[c*x/Sqrt[a + b*x^2]]^m/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b, c^2] && EqQ[b*d - a*e, 0]
If[TrueQ[$LoadShowSteps], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, ShowStep["", "Int[f[x,ArcTanh[a+b*x]]/(1-(a+b*x)^2),x]", "Subst[Int[f[-a/b+Tanh[x]/b,x],x],x,ArcTanh[a+b*x]]/b", Hold[ (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[Int[ SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Sech[x]^(2*(n + 1)), x], x], x, tmp]]] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcTanh] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; SimplifyFlag && QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[ Int[SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Sech[x]^(2*(n + 1)), x], x], x, tmp] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcTanh] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]]]
If[TrueQ[$LoadShowSteps], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, ShowStep["", "Int[f[x,ArcCoth[a+b*x]]/(1-(a+b*x)^2),x]", "Subst[Int[f[-a/b+Coth[x]/b,x],x],x,ArcCoth[a+b*x]]/b", Hold[ (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[Int[ SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*(-Csch[x]^2)^(n + 1), x], x], x, tmp]]] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcCoth] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; SimplifyFlag && QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[ Int[SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*(-Csch[x]^2)^(n + 1), x], x], x, tmp] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcCoth] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]]]
Int[ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tanh[a + b*x]] + b*Int[x/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tanh[a + b*x]] + b*Int[x/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Coth[a + b*x]] + b*Int[x/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Coth[a + b*x]] + b*Int[x/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tanh[a + b*x]] + b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tanh[a + b*x]] + b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Coth[a + b*x]] + b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Coth[a + b*x]] + b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Coth[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Coth[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Coth[a + b*x]]/(f*(m + 1)) + b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Coth[a + b*x]]/(f*(m + 1)) + b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[ArcTanh[Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[Tan[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcCoth[Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[Tan[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcTanh[Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[Cot[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcCoth[Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[Cot[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[(e_. + f_.*x_)^m_.*ArcTanh[Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[Tan[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcCoth[Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[Tan[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcTanh[Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[Cot[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcCoth[Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[Cot[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tan[a + b*x]] + I*b*Int[x/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c + I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tan[a + b*x]] + I*b*Int[x/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c + I*d)^2, 1]
Int[ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Cot[a + b*x]] + I*b*Int[x/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Cot[a + b*x]] + I*b*Int[x/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - I*d)^2, 1]
Int[ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tan[a + b*x]] + I*b*(1 - c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tan[a + b*x]] + I*b*(1 - c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, 1]
Int[ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Cot[a + b*x]] - I*b*(1 - c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Cot[a + b*x]] - I*b*(1 - c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Cot[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Cot[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b*(1 - c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b*(1 - c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Cot[a + b*x]]/(f*(m + 1)) - I*b*(1 - c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Cot[a + b*x]]/(f*(m + 1)) - I*b*(1 - c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - I*d)^2, 1]
Int[ArcTanh[u_], x_Symbol] := x*ArcTanh[u] - Int[SimplifyIntegrand[x*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[u, x]
Int[ArcCoth[u_], x_Symbol] := x*ArcCoth[u] - Int[SimplifyIntegrand[x*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[u, x]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcTanh[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcTanh[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(1 - u^2), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && FalseQ[PowerVariableExpn[u, m + 1, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCoth[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCoth[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(1 - u^2), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && FalseQ[PowerVariableExpn[u, m + 1, x]]
Int[v_*(a_. + b_.*ArcTanh[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcTanh[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]] && FalseQ[FunctionOfLinear[v*(a + b*ArcTanh[u]), x]]
Int[v_*(a_. + b_.*ArcCoth[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCoth[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]] && FalseQ[FunctionOfLinear[v*(a + b*ArcCoth[u]), x]]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.4 u (a+b arctanh(c x))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.4 u (a+b arctanh(c x))^p *)
Int[(f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := f/e*Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^p, x] - d*f/e*Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && GtQ[m, 0]
Int[(f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := f/e*Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^p, x] - d*f/e*Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && GtQ[m, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := (a + b*ArcTanh[c*x])^p*Log[2 - 2/(1 + e*x/d)]/d - b*c*p/d* Int[(a + b*ArcTanh[c*x])^(p - 1)* Log[2 - 2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_*(d_ + e_.*x_)), x_Symbol] := (a + b*ArcCoth[c*x])^p*Log[2 - 2/(1 + e*x/d)]/d - b*c*p/d* Int[(a + b*ArcCoth[c*x])^(p - 1)* Log[2 - 2/(1 + e*x/d)]/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcTanh[c*x])^p, x] - e/(d*f)*Int[(f*x)^(m + 1)*(a + b*ArcTanh[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcCoth[c*x])^p, x] - e/(d*f)*Int[(f*x)^(m + 1)*(a + b*ArcCoth[c*x])^p/(d + e*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && EqQ[c^2*d^2 - e^2, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcTanh[c*x]), u] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[q, -1] && IntegerQ[ 2*m] && (IGtQ[m, 0] && IGtQ[q, 0] || ILtQ[m + q + 1, 0] && LtQ[m*q, 0])
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcCoth[c*x]), u] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && NeQ[q, -1] && IntegerQ[ 2*m] && (IGtQ[m, 0] && IGtQ[q, 0] || ILtQ[m + q + 1, 0] && LtQ[m*q, 0])
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcTanh[c*x])^p, u] - b*c*p*Int[ ExpandIntegrand[(a + b*ArcTanh[c*x])^(p - 1), u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && IGtQ[p, 1] && EqQ[c^2*d^2 - e^2, 0] && IntegersQ[m, q] && NeQ[m, -1] && NeQ[q, -1] && ILtQ[m + q + 1, 0] && LtQ[m*q, 0]
Int[(f_.*x_)^m_.*(d_. + e_.*x_)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x)^q, x]}, Dist[(a + b*ArcCoth[c*x])^p, u] - b*c*p*Int[ ExpandIntegrand[(a + b*ArcCoth[c*x])^(p - 1), u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, q}, x] && IGtQ[p, 1] && EqQ[c^2*d^2 - e^2, 0] && IntegersQ[m, q] && NeQ[m, -1] && NeQ[q, -1] && ILtQ[m + q + 1, 0] && LtQ[m*q, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^p, (f*x)^m*(d + e*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || NeQ[a, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^p, (f*x)^m*(d + e*x)^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IntegerQ[q] && (GtQ[q, 0] || NeQ[a, 0] || IntegerQ[m])
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := b*(d + e*x^2)^q/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcTanh[c*x])/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := b*(d + e*x^2)^q/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcCoth[c*x])/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := b*p*(d + e*x^2)^ q*(a + b*ArcTanh[c*x])^(p - 1)/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^p, x] - b^2*d*p*(p - 1)/(2*q*(2*q + 1))* Int[(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && GtQ[p, 1]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := b*p*(d + e*x^2)^ q*(a + b*ArcCoth[c*x])^(p - 1)/(2*c*q*(2*q + 1)) + x*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p/(2*q + 1) + 2*d*q/(2*q + 1)* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^p, x] - b^2*d*p*(p - 1)/(2*q*(2*q + 1))* Int[(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && GtQ[p, 1]
(* Int[(a_.+b_.*ArcTanh[c_.*x_])^p_./(d_+e_.*x_^2),x_Symbol] := 1/(c*d)*Subst[Int[(a+b*x)^p,x],x,ArcTanh[c*x]] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[c^2*d+e,0] *)
(* Int[(a_.+b_.*ArcCoth[c_.*x_])^p_./(d_+e_.*x_^2),x_Symbol] := 1/(c*d)*Subst[Int[(a+b*x)^p,x],x,ArcCoth[c*x]] /; FreeQ[{a,b,c,d,e,p},x] && EqQ[c^2*d+e,0] *)
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcTanh[c_.*x_])), x_Symbol] := Log[RemoveContent[a + b*ArcTanh[c*x], x]]/(b*c*d) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcCoth[c_.*x_])), x_Symbol] := Log[RemoveContent[a + b*ArcCoth[c*x], x]]/(b*c*d) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)) /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && NeQ[p, -1]
Int[(a_. + b_.*ArcTanh[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := -2*(a + b*ArcTanh[c*x])* ArcTan[Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) - I*b*PolyLog[2, -I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) + I*b*PolyLog[2, I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/Sqrt[d_ + e_.*x_^2], x_Symbol] := -2*(a + b*ArcCoth[c*x])* ArcTan[Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) - I*b*PolyLog[2, -I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) + I*b*PolyLog[2, I*Sqrt[1 - c*x]/Sqrt[1 + c*x]]/(c*Sqrt[d]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := 1/(c*Sqrt[d])*Subst[Int[(a + b*x)^p*Sech[x], x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -x*Sqrt[1 - 1/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p*Csch[x], x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcTanh[c*x])^p/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcCoth[c*x])^p/Sqrt[1 - c^2*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcTanh[c*x])^p/(2*d*(d + e*x^2)) + (a + b*ArcTanh[c*x])^(p + 1)/(2*b*c*d^2*(p + 1)) - b*c*p/2*Int[x*(a + b*ArcTanh[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcCoth[c*x])^p/(2*d*(d + e*x^2)) + (a + b*ArcCoth[c*x])^(p + 1)/(2*b*c*d^2*(p + 1)) - b*c*p/2*Int[x*(a + b*ArcCoth[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcTanh[c*x])/(d*Sqrt[d + e*x^2]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcCoth[c*x])/(d*Sqrt[d + e*x^2]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -3/2]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b*p*(a + b*ArcTanh[c*x])^(p - 1)/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcTanh[c*x])^p/(d*Sqrt[d + e*x^2]) + b^2*p*(p - 1)* Int[(a + b*ArcTanh[c*x])^(p - 2)/(d + e*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 1]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2)^(3/2), x_Symbol] := -b*p*(a + b*ArcCoth[c*x])^(p - 1)/(c*d*Sqrt[d + e*x^2]) + x*(a + b*ArcCoth[c*x])^p/(d*Sqrt[d + e*x^2]) + b^2*p*(p - 1)* Int[(a + b*ArcCoth[c*x])^(p - 2)/(d + e*x^2)^(3/2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := -b*p*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(4*c* d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] + b^2*p*(p - 1)/(4*(q + 1)^2)* Int[(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && GtQ[p, 1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := -b*p*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(4*c* d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p/(2*d*(q + 1)) + (2*q + 3)/(2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] + b^2*p*(p - 1)/(4*(q + 1)^2)* Int[(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && GtQ[p, 1] && NeQ[q, -3/2]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p + 1)/(b*c* d*(p + 1)) + 2*c*(q + 1)/(b*(p + 1))* Int[x*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p + 1)/(b*c* d*(p + 1)) + 2*c*(q + 1)/(b*(p + 1))* Int[x*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && LtQ[p, -1]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^q/c* Subst[Int[(a + b*x)^p/Cosh[x]^(2*(q + 1)), x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && (IntegerQ[q] || GtQ[d, 0])
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^(q + 1/2)*Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(1 - c^2*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && Not[IntegerQ[q] || GtQ[d, 0]]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^q/c* Subst[Int[(a + b*x)^p/Sinh[x]^(2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && IntegerQ[q]
Int[(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^(q + 1/2)*x*Sqrt[(c^2*x^2 - 1)/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p/Sinh[x]^(2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && ILtQ[2*(q + 1), 0] && Not[IntegerQ[q]]
Int[ArcTanh[c_.*x_]/(d_. + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + c*x]/(d + e*x^2), x] - 1/2*Int[Log[1 - c*x]/(d + e*x^2), x] /; FreeQ[{c, d, e}, x]
Int[ArcCoth[c_.*x_]/(d_. + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + 1/(c*x)]/(d + e*x^2), x] - 1/2*Int[Log[1 - 1/(c*x)]/(d + e*x^2), x] /; FreeQ[{c, d, e}, x]
Int[(a_ + b_.*ArcTanh[c_.*x_])/(d_. + e_.*x_^2), x_Symbol] := a*Int[1/(d + e*x^2), x] + b*Int[ArcTanh[c*x]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(a_ + b_.*ArcCoth[c_.*x_])/(d_. + e_.*x_^2), x_Symbol] := a*Int[1/(d + e*x^2), x] + b*Int[ArcCoth[c*x]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^q, x]}, Dist[a + b*ArcTanh[c*x], u, x] - b*c*Int[u/(1 - c^2*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && (IntegerQ[q] || ILtQ[q + 1/2, 0])
Int[(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^q, x]}, Dist[a + b*ArcCoth[c*x], u, x] - b*c*Int[u/(1 - c^2*x^2), x]] /; FreeQ[{a, b, c, d, e}, x] && (IntegerQ[q] || ILtQ[q + 1/2, 0])
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^p, (d + e*x^2)^q, x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[q] && IGtQ[p, 0]
Int[(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^p, (d + e*x^2)^q, x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[q] && IGtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcTanh[c*x])^p, x] - d*f^2/e* Int[(f*x)^(m - 2)*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := f^2/e*Int[(f*x)^(m - 2)*(a + b*ArcCoth[c*x])^p, x] - d*f^2/e* Int[(f*x)^(m - 2)*(a + b*ArcCoth[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcTanh[c*x])^p, x] - e/(d*f^2)* Int[(f*x)^(m + 2)*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/d*Int[(f*x)^m*(a + b*ArcCoth[c*x])^p, x] - e/(d*f^2)* Int[(f*x)^(m + 2)*(a + b*ArcCoth[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && GtQ[p, 0] && LtQ[m, -1]
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)/(b*e*(p + 1)) + 1/(c*d)*Int[(a + b*ArcTanh[c*x])^p/(1 - c*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)/(b*e*(p + 1)) + 1/(c*d)*Int[(a + b*ArcCoth[c*x])^p/(1 - c*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := x*(a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)) - 1/(b*c*d*(p + 1))*Int[(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && Not[IGtQ[p, 0]] && NeQ[p, -1]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := -x*(a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)) - 1/(b*c*d*(p + 1))*Int[(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && Not[IGtQ[p, 0]] && NeQ[p, -1]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_*(d_ + e_.*x_^2)), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)/(b*d*(p + 1)) + 1/d*Int[(a + b*ArcTanh[c*x])^p/(x*(1 + c*x)), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_*(d_ + e_.*x_^2)), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)/(b*d*(p + 1)) + 1/d*Int[(a + b*ArcCoth[c*x])^p/(x*(1 + c*x)), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := (f*x)^m*(a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)) - f*m/(b*c*d*(p + 1))* Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2), x_Symbol] := (f*x)^m*(a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)) - f*m/(b*c*d*(p + 1))* Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1]
Int[x_^m_.*(a_. + b_.*ArcTanh[c_.*x_])/(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x]), x^m/(d + e*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m] && Not[EqQ[m, 1] && NeQ[a, 0]]
Int[x_^m_.*(a_. + b_.*ArcCoth[c_.*x_])/(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x]), x^m/(d + e*x^2), x], x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m] && Not[EqQ[m, 1] && NeQ[a, 0]]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p/(2*e*(q + 1)) + b*p/(2*c*(q + 1))* Int[(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, q}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && NeQ[q, -1]
Int[x_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p/(2*e*(q + 1)) + b*p/(2*c*(q + 1))* Int[(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, q}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && NeQ[q, -1]
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_/(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcTanh[c*x])^(p + 1)/(b*c*d*(p + 1)*(d + e*x^2)) + (1 + c^2*x^2)*(a + b*ArcTanh[c*x])^(p + 2)/(b^2* e*(p + 1)*(p + 2)*(d + e*x^2)) + 4/(b^2*(p + 1)*(p + 2))* Int[x*(a + b*ArcTanh[c*x])^(p + 2)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_/(d_ + e_.*x_^2)^2, x_Symbol] := x*(a + b*ArcCoth[c*x])^(p + 1)/(b*c*d*(p + 1)*(d + e*x^2)) + (1 + c^2*x^2)*(a + b*ArcCoth[c*x])^(p + 2)/(b^2* e*(p + 1)*(p + 2)*(d + e*x^2)) + 4/(b^2*(p + 1)*(p + 2))* Int[x*(a + b*ArcCoth[c*x])^(p + 2)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[x_^2*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c^3*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(2*c^2*d*(q + 1)) + 1/(2*c^2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -5/2]
Int[x_^2*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := -b*(d + e*x^2)^(q + 1)/(4*c^3*d*(q + 1)^2) - x*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(2*c^2*d*(q + 1)) + 1/(2*c^2*d*(q + 1))* Int[(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && LtQ[q, -1] && NeQ[q, -5/2]
Int[x_^2*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := -(a + b*ArcTanh[c*x])^(p + 1)/(2*b*c^3*d^2*(p + 1)) + x*(a + b*ArcTanh[c*x])^p/(2*c^2*d*(d + e*x^2)) - b*p/(2*c)*Int[x*(a + b*ArcTanh[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[x_^2*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := -(a + b*ArcCoth[c*x])^(p + 1)/(2*b*c^3*d^2*(p + 1)) + x*(a + b*ArcCoth[c*x])^p/(2*c^2*d*(d + e*x^2)) - b*p/(2*c)*Int[x*(a + b*ArcCoth[c*x])^(p - 1)/(d + e*x^2)^2, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := -b*(f*x)^m*(d + e*x^2)^(q + 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(c^2*d* m) - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := -b*(f*x)^m*(d + e*x^2)^(q + 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(c^2*d* m) - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := -b*p*(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^ p/(c^2*d*m) + b^2*p*(p - 1)/m^2* Int[(f*x)^m*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 2), x] - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1] && GtQ[p, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := -b*p*(f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(c*d*m^2) + f*(f*x)^(m - 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^ p/(c^2*d*m) + b^2*p*(p - 1)/m^2* Int[(f*x)^m*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 2), x] - f^2*(m - 1)/(c^2*d*m)* Int[(f*x)^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[q, -1] && GtQ[p, 1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_, x_Symbol] := (f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p + 1)/(b*c* d*(p + 1)) - f*m/(b*c*(p + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_, x_Symbol] := (f*x)^ m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p + 1)/(b*c* d*(p + 1)) - f*m/(b*c*(p + 1))* Int[(f*x)^(m - 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 2, 0] && LtQ[p, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^ p/(d*(m + 1)) - b*c*p/(m + 1)* Int[(f*x)^(m + 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 3, 0] && GtQ[p, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := (f*x)^(m + 1)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^ p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && EqQ[c^2*d + e, 0] && EqQ[m + 2*q + 3, 0] && GtQ[p, 0] && NeQ[m, -1]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])/(f*(m + 2)) - b*c*d/(f*(m + 2))*Int[(f*x)^(m + 1)/Sqrt[d + e*x^2], x] + d/(m + 2)*Int[(f*x)^m*(a + b*ArcTanh[c*x])/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && NeQ[m, -2]
Int[(f_.*x_)^m_*Sqrt[d_ + e_.*x_^2]*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := (f*x)^(m + 1)*Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])/(f*(m + 2)) - b*c*d/(f*(m + 2))*Int[(f*x)^(m + 1)/Sqrt[d + e*x^2], x] + d/(m + 2)*Int[(f*x)^m*(a + b*ArcCoth[c*x])/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && NeQ[m, -2]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGtQ[q, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Int[ExpandIntegrand[(f*x)^m*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGtQ[q, 1]
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d*Int[(f*x)^m*(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^p, x] - c^2*d/f^2* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && IGtQ[p, 0] && (RationalQ[m] || EqQ[p, 1] && IntegerQ[q])
Int[(f_.*x_)^m_*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := d*Int[(f*x)^m*(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^p, x] - c^2*d/f^2* Int[(f*x)^(m + 2)*(d + e*x^2)^(q - 1)*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[c^2*d + e, 0] && GtQ[q, 0] && IGtQ[p, 0] && (RationalQ[m] || EqQ[p, 1] && IntegerQ[q])
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])^p/(c^2*d*m) + b*f*p/(c*m)* Int[(f*x)^(m - 1)*(a + b*ArcTanh[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcTanh[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && GtQ[m, 1]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := -f*(f*x)^(m - 1)*Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])^p/(c^2*d*m) + b*f*p/(c*m)* Int[(f*x)^(m - 1)*(a + b*ArcCoth[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + f^2*(m - 1)/(c^2*m)* Int[(f*x)^(m - 2)*(a + b*ArcCoth[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && GtQ[m, 1]
Int[(a_. + b_.*ArcTanh[c_.*x_])/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -2/Sqrt[d]*(a + b*ArcTanh[c*x])* ArcTanh[Sqrt[1 - c*x]/Sqrt[1 + c*x]] + b/Sqrt[d]*PolyLog[2, -Sqrt[1 - c*x]/Sqrt[1 + c*x]] - b/Sqrt[d]*PolyLog[2, Sqrt[1 - c*x]/Sqrt[1 + c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -2/Sqrt[d]*(a + b*ArcCoth[c*x])* ArcTanh[Sqrt[1 - c*x]/Sqrt[1 + c*x]] + b/Sqrt[d]*PolyLog[2, -Sqrt[1 - c*x]/Sqrt[1 + c*x]] - b/Sqrt[d]*PolyLog[2, Sqrt[1 - c*x]/Sqrt[1 + c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := 1/Sqrt[d]*Subst[Int[(a + b*x)^p*Csch[x], x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_/(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -c*x*Sqrt[1 - 1/(c^2*x^2)]/Sqrt[d + e*x^2]* Subst[Int[(a + b*x)^p*Sech[x], x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && GtQ[d, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcTanh[c*x])^p/(x*Sqrt[1 - c^2*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_*Sqrt[d_ + e_.*x_^2]), x_Symbol] := Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[(a + b*ArcCoth[c*x])^p/(x*Sqrt[1 - c^2*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && Not[GtQ[d, 0]]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_./(x_^2*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])^p/(d*x) + b*c*p*Int[(a + b*ArcTanh[c*x])^(p - 1)/(x*Sqrt[d + e*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_./(x_^2*Sqrt[d_ + e_.*x_^2]), x_Symbol] := -Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])^p/(d*x) + b*c*p*Int[(a + b*ArcCoth[c*x])^(p - 1)/(x*Sqrt[d + e*x^2]), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0]
Int[(f_.*x_)^m_*(a_. + b_.*ArcTanh[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcTanh[c*x])^p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(a + b*ArcTanh[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + c^2*(m + 2)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*ArcTanh[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[(f_.*x_)^m_*(a_. + b_.*ArcCoth[c_.*x_])^p_./Sqrt[d_ + e_.*x_^2], x_Symbol] := (f*x)^(m + 1)* Sqrt[d + e*x^2]*(a + b*ArcCoth[c*x])^p/(d*f*(m + 1)) - b*c*p/(f*(m + 1))* Int[(f*x)^(m + 1)*(a + b*ArcCoth[c*x])^(p - 1)/Sqrt[d + e*x^2], x] + c^2*(m + 2)/(f^2*(m + 1))* Int[(f*x)^(m + 2)*(a + b*ArcCoth[c*x])^p/Sqrt[d + e*x^2], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[c^2*d + e, 0] && GtQ[p, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := 1/e*Int[x^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] - d/e*Int[x^(m - 2)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && IGtQ[m, 1] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := 1/e*Int[x^(m - 2)*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] - d/e*Int[x^(m - 2)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && IGtQ[m, 1] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := 1/d*Int[x^m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^p, x] - e/d*Int[x^(m + 2)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && ILtQ[m, 0] && NeQ[p, -1]
Int[x_^m_*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := 1/d*Int[x^m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^p, x] - e/d*Int[x^(m + 2)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegersQ[p, 2*q] && LtQ[q, -1] && ILtQ[m, 0] && NeQ[p, -1]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := x^m*(d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])^(p + 1)/(b*c* d*(p + 1)) - m/(b*c*(p + 1))* Int[x^(m - 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] + c*(m + 2*q + 2)/(b*(p + 1))* Int[x^(m + 1)*(d + e*x^2)^q*(a + b*ArcTanh[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && LtQ[q, -1] && LtQ[p, -1] && NeQ[m + 2*q + 2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := x^m*(d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])^(p + 1)/(b*c* d*(p + 1)) - m/(b*c*(p + 1))* Int[x^(m - 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] + c*(m + 2*q + 2)/(b*(p + 1))* Int[x^(m + 1)*(d + e*x^2)^q*(a + b*ArcCoth[c*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IntegerQ[m] && LtQ[q, -1] && LtQ[p, -1] && NeQ[m + 2*q + 2, 0]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^q/c^(m + 1)* Subst[Int[(a + b*x)^p*Sinh[x]^m/Cosh[x]^(m + 2*(q + 1)), x], x, ArcTanh[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && (IntegerQ[q] || GtQ[d, 0])
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := d^(q + 1/2)*Sqrt[1 - c^2*x^2]/Sqrt[d + e*x^2]* Int[x^m*(1 - c^2*x^2)^q*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && Not[IntegerQ[q] || GtQ[d, 0]]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^q/c^(m + 1)* Subst[Int[(a + b*x)^p*Cosh[x]^m/Sinh[x]^(m + 2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && IntegerQ[q]
Int[x_^m_.*(d_ + e_.*x_^2)^q_*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := -(-d)^(q + 1/2)*x* Sqrt[(c^2*x^2 - 1)/(c^2*x^2)]/(c^m*Sqrt[d + e*x^2])* Subst[Int[(a + b*x)^p*Cosh[x]^m/Sinh[x]^(m + 2*(q + 1)), x], x, ArcCoth[c*x]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[c^2*d + e, 0] && IGtQ[m, 0] && ILtQ[m + 2*q + 1, 0] && Not[IntegerQ[q]]
Int[x_*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcTanh[c*x])/(2*e*(q + 1)) - b*c/(2*e*(q + 1))*Int[(d + e*x^2)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[x_*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := (d + e*x^2)^(q + 1)*(a + b*ArcCoth[c*x])/(2*e*(q + 1)) - b*c/(2*e*(q + 1))*Int[(d + e*x^2)^(q + 1)/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, q}, x] && NeQ[q, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^q, x]}, Dist[a + b*ArcTanh[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && ( IGtQ[q, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*q + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[q, 0] && GtQ[m + 2*q + 3, 0]] || ILtQ[(m + 2*q + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^q, x]}, Dist[a + b*ArcCoth[c*x], u, x] - b*c*Int[SimplifyIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, m, q}, x] && ( IGtQ[q, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*q + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[q, 0] && GtQ[m + 2*q + 3, 0]] || ILtQ[(m + 2*q + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[x_*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcTanh[c*x])^p/(1 - Rt[-e/d, 2]*x)^2, x] - 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcTanh[c*x])^p/(1 + Rt[-e/d, 2]*x)^2, x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0]
Int[x_*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2)^2, x_Symbol] := 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcCoth[c*x])^p/(1 - Rt[-e/d, 2]*x)^2, x] - 1/(4*d^2*Rt[-e/d, 2])* Int[(a + b*ArcCoth[c*x])^p/(1 + Rt[-e/d, 2]*x)^2, x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*ArcTanh[c*x])^p, (f*x)^m*(d + e*x^2)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[q] && IGtQ[p, 0] && (GtQ[q, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := With[{u = ExpandIntegrand[(a + b*ArcCoth[c*x])^p, (f*x)^m*(d + e*x^2)^q, x]}, Int[u, x] /; SumQ[u]] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[q] && IGtQ[p, 0] && (GtQ[q, 0] || IntegerQ[m])
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*ArcTanh[c_.*x_]), x_Symbol] := a*Int[(f*x)^m*(d + e*x^2)^q, x] + b*Int[(f*x)^m*(d + e*x^2)^q*ArcTanh[c*x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x]
Int[(f_.*x_)^m_.*(d_ + e_.*x_^2)^q_.*(a_ + b_.*ArcCoth[c_.*x_]), x_Symbol] := a*Int[(f*x)^m*(d + e*x^2)^q, x] + b*Int[(f*x)^m*(d + e*x^2)^q*ArcCoth[c*x], x] /; FreeQ[{a, b, c, d, e, f, m, q}, x]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcTanh[c*x])^p/(d + e*x^2), (f + g*x)^ m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && IGtQ[m, 0]
Int[(f_ + g_.*x_)^m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := Int[ExpandIntegrand[(a + b*ArcCoth[c*x])^p/(d + e*x^2), (f + g*x)^ m, x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && IGtQ[m, 0]
Int[ArcTanh[u_]*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] - 1/2*Int[Log[1 - u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[ArcCoth[u_]*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[ Log[SimplifyIntegrand[1 + 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] - 1/2* Int[Log[SimplifyIntegrand[1 - 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[ArcTanh[u_]*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[Log[1 + u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] - 1/2*Int[Log[1 - u]*(a + b*ArcTanh[c*x])^p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[ArcCoth[u_]*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := 1/2*Int[ Log[SimplifyIntegrand[1 + 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] - 1/2* Int[Log[SimplifyIntegrand[1 - 1/u, x]]*(a + b*ArcCoth[c*x])^ p/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*Log[f_ + g_.*x_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(p + 1)*Log[f + g*x]/(b*c*d*(p + 1)) - g/(b*c*d*(p + 1))* Int[(a + b*ArcTanh[c*x])^(p + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[c^2*f^2 - g^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*Log[f_ + g_.*x_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(p + 1)*Log[f + g*x]/(b*c*d*(p + 1)) - g/(b*c*d*(p + 1))* Int[(a + b*ArcCoth[c*x])^(p + 1)/(f + g*x), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[c^2*f^2 - g^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) - b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) - b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcTanh[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) + b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*Log[u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcCoth[c*x])^p*PolyLog[2, 1 - u]/(2*c*d) + b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[2, 1 - u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[(1 - u)^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcTanh[c*x])^p*PolyLog[k + 1, u]/(2*c*d) + b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := -(a + b*ArcCoth[c*x])^p*PolyLog[k + 1, u]/(2*c*d) + b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 + c*x))^2, 0]
Int[(a_. + b_.*ArcTanh[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^p*PolyLog[k + 1, u]/(2*c*d) - b*p/2* Int[(a + b*ArcTanh[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^p_.*PolyLog[k_, u_]/(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^p*PolyLog[k + 1, u]/(2*c*d) - b*p/2* Int[(a + b*ArcCoth[c*x])^(p - 1)*PolyLog[k + 1, u]/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e, k}, x] && IGtQ[p, 0] && EqQ[c^2*d + e, 0] && EqQ[u^2 - (1 - 2/(1 - c*x))^2, 0]
Int[1/((d_ + e_.*x_^2)*(a_. + b_.*ArcCoth[c_.*x_])*(a_. + b_.*ArcTanh[c_.*x_])), x_Symbol] := (-Log[a + b*ArcCoth[c*x]] + Log[a + b*ArcTanh[c*x]])/(b^2*c* d*(ArcCoth[c*x] - ArcTanh[c*x])) /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0]
Int[(a_. + b_.*ArcCoth[c_.*x_])^ m_.*(a_. + b_.*ArcTanh[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcCoth[c*x])^(m + 1)*(a + b*ArcTanh[c*x])^ p/(b*c*d*(m + 1)) - p/(m + 1)* Int[(a + b*ArcCoth[c*x])^(m + 1)*(a + b*ArcTanh[c*x])^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGeQ[m, p]
Int[(a_. + b_.*ArcTanh[c_.*x_])^ m_.*(a_. + b_.*ArcCoth[c_.*x_])^p_./(d_ + e_.*x_^2), x_Symbol] := (a + b*ArcTanh[c*x])^(m + 1)*(a + b*ArcCoth[c*x])^ p/(b*c*d*(m + 1)) - p/(m + 1)* Int[(a + b*ArcTanh[c*x])^(m + 1)*(a + b*ArcCoth[c*x])^(p - 1)/(d + e*x^2), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c^2*d + e, 0] && IGtQ[p, 0] && IGtQ[m, p]
Int[ArcTanh[a_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := 1/2*Int[Log[1 + a*x]/(c + d*x^n), x] - 1/2*Int[Log[1 - a*x]/(c + d*x^n), x] /; FreeQ[{a, c, d}, x] && IntegerQ[n] && Not[EqQ[n, 2] && EqQ[a^2*c + d, 0]]
Int[ArcCoth[a_.*x_]/(c_ + d_.*x_^n_.), x_Symbol] := 1/2*Int[Log[1 + 1/(a*x)]/(c + d*x^n), x] - 1/2*Int[Log[1 - 1/(a*x)]/(c + d*x^n), x] /; FreeQ[{a, c, d}, x] && IntegerQ[n] && Not[EqQ[n, 2] && EqQ[a^2*c + d, 0]]
Int[Log[d_.*x_^m_.]*ArcTanh[c_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[d*x^m]*Log[1 + c*x^n]/x, x] - 1/2*Int[Log[d*x^m]*Log[1 - c*x^n]/x, x] /; FreeQ[{c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*ArcCoth[c_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[d*x^m]*Log[1 + 1/(c*x^n)]/x, x] - 1/2*Int[Log[d*x^m]*Log[1 - 1/(c*x^n)]/x, x] /; FreeQ[{c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*(a_ + b_.*ArcTanh[c_.*x_^n_.])/x_, x_Symbol] := a*Int[Log[d*x^m]/x, x] + b*Int[(Log[d*x^m]*ArcTanh[c*x^n])/x, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[Log[d_.*x_^m_.]*(a_ + b_.*ArcCoth[c_.*x_^n_.])/x_, x_Symbol] := a*Int[Log[d*x^m]/x, x] + b*Int[(Log[d*x^m]*ArcCoth[c*x^n])/x, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := x*(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x]) - 2*e*g*Int[x^2*(a + b*ArcTanh[c*x])/(f + g*x^2), x] - b*c*Int[x*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := x*(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x]) - 2*e*g*Int[x^2*(a + b*ArcCoth[c*x])/(f + g*x^2), x] - b*c*Int[x*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[Log[f_. + g_.*x_^2]*ArcTanh[c_.*x_]/x_, x_Symbol] := (Log[f + g*x^2] - Log[1 - c*x] - Log[1 + c*x])* Int[ArcTanh[c*x]/x, x] - 1/2*Int[Log[1 - c*x]^2/x, x] + 1/2*Int[Log[1 + c*x]^2/x, x] /; FreeQ[{c, f, g}, x] && EqQ[c^2*f + g, 0]
Int[Log[f_. + g_.*x_^2]*ArcCoth[c_.*x_]/x_, x_Symbol] := (Log[f + g*x^2] - Log[-c^2*x^2] - Log[1 - 1/(c*x)] - Log[1 + 1/(c*x)])*Int[ArcCoth[c*x]/x, x] + Int[Log[-c^2*x^2]*ArcCoth[c*x]/x, x] - 1/2*Int[Log[1 - 1/(c*x)]^2/x, x] + 1/2*Int[Log[1 + 1/(c*x)]^2/x, x] /; FreeQ[{c, f, g}, x] && EqQ[c^2*f + g, 0]
Int[Log[f_. + g_.*x_^2]*(a_ + b_.*ArcTanh[c_.*x_])/x_, x_Symbol] := a*Int[Log[f + g*x^2]/x, x] + b*Int[Log[f + g*x^2]*ArcTanh[c*x]/x, x] /; FreeQ[{a, b, c, f, g}, x]
Int[Log[f_. + g_.*x_^2]*(a_ + b_.*ArcCoth[c_.*x_])/x_, x_Symbol] := a*Int[Log[f + g*x^2]/x, x] + b*Int[Log[f + g*x^2]*ArcCoth[c*x]/x, x] /; FreeQ[{a, b, c, f, g}, x]
Int[(d_ + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_])/x_, x_Symbol] := d*Int[(a + b*ArcTanh[c*x])/x, x] + e*Int[Log[f + g*x^2]*(a + b*ArcTanh[c*x])/x, x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[(d_ + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_])/x_, x_Symbol] := d*Int[(a + b*ArcCoth[c*x])/x, x] + e*Int[Log[f + g*x^2]*(a + b*ArcCoth[c*x])/x, x] /; FreeQ[{a, b, c, d, e, f, g}, x]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := x^(m + 1)*(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x])/(m + 1) - 2*e*g/(m + 1)* Int[x^(m + 2)*(a + b*ArcTanh[c*x])/(f + g*x^2), x] - b*c/(m + 1)* Int[x^(m + 1)*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := x^(m + 1)*(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x])/(m + 1) - 2*e*g/(m + 1)* Int[x^(m + 2)*(a + b*ArcCoth[c*x])/(f + g*x^2), x] - b*c/(m + 1)* Int[x^(m + 1)*(d + e*Log[f + g*x^2])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && ILtQ[m/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*Log[f + g*x^2]), x]}, Dist[a + b*ArcTanh[c*x], u, x] - b*c*Int[ExpandIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[(m + 1)/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(d + e*Log[f + g*x^2]), x]}, Dist[a + b*ArcCoth[c*x], u, x] - b*c*Int[ExpandIntegrand[u/(1 - c^2*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[(m + 1)/2, 0]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(a + b*ArcTanh[c*x]), x]}, Dist[d + e*Log[f + g*x^2], u, x] - 2*e*g*Int[ExpandIntegrand[x*u/(f + g*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_^m_.*(d_. + e_.*Log[f_. + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_]), x_Symbol] := With[{u = IntHide[x^m*(a + b*ArcCoth[c*x]), x]}, Dist[d + e*Log[f + g*x^2], u, x] - 2*e*g*Int[ExpandIntegrand[x*u/(f + g*x^2), x], x]] /; FreeQ[{a, b, c, d, e, f, g}, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_*(d_. + e_.*Log[f_ + g_.*x_^2])*(a_. + b_.*ArcTanh[c_.*x_])^2, x_Symbol] := (f + g*x^2)*(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x])^2/(2*g) - e*x^2*(a + b*ArcTanh[c*x])^2/2 + b/c*Int[(d + e*Log[f + g*x^2])*(a + b*ArcTanh[c*x]), x] + b*c*e*Int[x^2*(a + b*ArcTanh[c*x])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*f + g, 0]
Int[x_*(d_. + e_.*Log[f_ + g_.*x_^2])*(a_. + b_.*ArcCoth[c_.*x_])^2, x_Symbol] := (f + g*x^2)*(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x])^2/(2*g) - e*x^2*(a + b*ArcCoth[c*x])^2/2 + b/c*Int[(d + e*Log[f + g*x^2])*(a + b*ArcCoth[c*x]), x] + b*c*e*Int[x^2*(a + b*ArcCoth[c*x])/(1 - c^2*x^2), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[c^2*f + g, 0]
Int[u_.*(a_. + b_.*ArcTanh[c_.*x_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcTanh[c*x])^p, x] /; FreeQ[{a, b, c, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_. + e_.*x)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x)^q_. /; FreeQ[{d, e, f, m, q}, x]] || MatchQ[u, (d_. + e_.*x^2)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x^2)^q_. /; FreeQ[{d, e, f, m, q}, x]])
Int[u_.*(a_. + b_.*ArcCoth[c_.*x_])^p_., x_Symbol] := Unintegrable[u*(a + b*ArcCoth[c*x])^p, x] /; FreeQ[{a, b, c, p}, x] && (EqQ[u, 1] || MatchQ[u, (d_. + e_.*x)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x)^q_. /; FreeQ[{d, e, f, m, q}, x]] || MatchQ[u, (d_. + e_.*x^2)^q_. /; FreeQ[{d, e, q}, x]] || MatchQ[ u, (f_.*x)^m_.*(d_. + e_.*x^2)^q_. /; FreeQ[{d, e, f, m, q}, x]])

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.5 u (a+b arctanh(c+d x))^p.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.5 u (a+b arctanh(c+d x))^p *)
Int[(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcTanh[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcCoth[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := (e + f*x)^(m + 1)*(a + b*ArcTanh[c + d*x])^p/(f*(m + 1)) - b*d*p/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(a + b*ArcTanh[c + d*x])^(p - 1)/(1 - (c + d*x)^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := (e + f*x)^(m + 1)*(a + b*ArcCoth[c + d*x])^p/(f*(m + 1)) - b*d*p/(f*(m + 1))* Int[(e + f*x)^(m + 1)*(a + b*ArcCoth[c + d*x])^(p - 1)/(1 - (c + d*x)^2), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcTanh[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcCoth[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[ArcTanh[c_ + d_.*x_]/(e_ + f_.*x_^n_.), x_Symbol] := 1/2*Int[Log[1 + c + d*x]/(e + f*x^n), x] - 1/2*Int[Log[1 - c - d*x]/(e + f*x^n), x] /; FreeQ[{c, d, e, f}, x] && RationalQ[n]
Int[ArcCoth[c_ + d_.*x_]/(e_ + f_.*x_^n_.), x_Symbol] := 1/2*Int[Log[(1 + c + d*x)/(c + d*x)]/(e + f*x^n), x] - 1/2*Int[Log[(-1 + c + d*x)/(c + d*x)]/(e + f*x^n), x] /; FreeQ[{c, d, e, f}, x] && RationalQ[n]
Int[ArcTanh[c_ + d_.*x_]/(e_ + f_.*x_^n_), x_Symbol] := Unintegrable[ArcTanh[c + d*x]/(e + f*x^n), x] /; FreeQ[{c, d, e, f, n}, x] && Not[RationalQ[n]]
Int[ArcCoth[c_ + d_.*x_]/(e_ + f_.*x_^n_), x_Symbol] := Unintegrable[ArcCoth[c + d*x]/(e + f*x^n), x] /; FreeQ[{c, d, e, f, n}, x] && Not[RationalQ[n]]
Int[(A_. + B_.*x_ + C_.*x_^2)^q_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^ p_., x_Symbol] := 1/d*Subst[Int[(-C/d^2 + C/d^2*x^2)^q*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(A_. + B_.*x_ + C_.*x_^2)^q_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^ p_., x_Symbol] := 1/d*Subst[Int[(C/d^2 + C/d^2*x^2)^q*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, A, B, C, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ q_.*(a_. + b_.*ArcTanh[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ q*(a + b*ArcTanh[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]
Int[(e_. + f_.*x_)^m_.*(A_. + B_.*x_ + C_.*x_^2)^ q_.*(a_. + b_.*ArcCoth[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[ Int[((d*e - c*f)/d + f*x/d)^m*(-C/d^2 + C/d^2*x^2)^ q*(a + b*ArcCoth[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, p, q}, x] && EqQ[B*(1 - c^2) + 2*A*c*d, 0] && EqQ[2*c*C - B*d, 0]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.6 Exponentials of inverse hyperbolic tangent.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.6 Exponentials of inverse hyperbolic tangent *)
Int[E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := Int[((1 + a*x)^((n + 1)/2)/((1 - a*x)^((n - 1)/2)* Sqrt[1 - a^2*x^2])), x] /; FreeQ[a, x] && IntegerQ[(n - 1)/2]
Int[x_^m_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := Int[x^ m*((1 + a*x)^((n + 1)/2)/((1 - a*x)^((n - 1)/2)* Sqrt[1 - a^2*x^2])), x] /; FreeQ[{a, m}, x] && IntegerQ[(n - 1)/2]
Int[E^(n_*ArcTanh[a_.*x_]), x_Symbol] := Int[(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, n}, x] && Not[IntegerQ[(n - 1)/2]]
Int[x_^m_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := Int[x^m*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[(n - 1)/2]]
Int[(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^n*Int[(c + d*x)^(p - n)*(1 - a^2*x^2)^(n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[a*c + d, 0] && IntegerQ[(n - 1)/2] && IntegerQ[2*p]
Int[(e_. + f_.*x_)^m_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^n*Int[(e + f*x)^m*(c + d*x)^(p - n)*(1 - a^2*x^2)^(n/2), x] /; FreeQ[{a, c, d, e, f, m, p}, x] && EqQ[a*c + d, 0] && IntegerQ[(n - 1)/2] && (IntegerQ[p] || EqQ[p, n/2] || EqQ[p - n/2 - 1, 0]) && IntegerQ[2*p]
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[u*(1 + d*x/c)^p*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 - d^2, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := Int[u*(c + d*x)^p*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 - d^2, 0] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_.*(c_ + d_./x_)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := d^p*Int[u*(1 + c*x/d)^p*E^(n*ArcTanh[a*x])/x^p, x] /; FreeQ[{a, c, d, n}, x] && EqQ[c^2 - a^2*d^2, 0] && IntegerQ[p]
Int[u_.*(c_ + d_./x_)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (-1)^(n/2)*c^p* Int[u*(1 + d/(c*x))^p*(1 + 1/(a*x))^(n/2)/(1 - 1/(a*x))^(n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && GtQ[c, 0]
Int[u_.*(c_ + d_./x_)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := Int[u*(c + d/x)^p*(1 + a*x)^(n/2)/(1 - a*x)^(n/2), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && Not[GtQ[c, 0]]
Int[u_.*(c_ + d_./x_)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := x^p*(c + d/x)^p/(1 + c*x/d)^p* Int[u*(1 + c*x/d)^p*E^(n*ArcTanh[a*x])/x^p, x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[p]]
Int[E^(n_*ArcTanh[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (n - a*x)*E^(n*ArcTanh[a*x])/(a*c*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (n + 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTanh[a*x])/(a*c*(n^2 - 4*(p + 1)^2)) - 2*(p + 1)*(2*p + 3)/(c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && LtQ[p, -1] && Not[IntegerQ[n]] && NeQ[n^2 - 4*(p + 1)^2, 0] && IntegerQ[2*p]
Int[E^(n_.*ArcTanh[a_.*x_])/(c_ + d_.*x_^2), x_Symbol] := E^(n*ArcTanh[a*x])/(a*c*n) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[(1 - a^2*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && IntegerQ[p] && IGtQ[(n + 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[(1 - a^2*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && IntegerQ[p] && ILtQ[(n - 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^(n/2)*Int[(c + d*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && IGtQ[n/2, 0]
Int[(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := 1/c^(n/2)*Int[(c + d*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && ILtQ[n/2, 0]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 - a^2*x^2)^FracPart[p]* Int[(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[x_*E^(n_*ArcTanh[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (1 - a*n*x)*E^(n*ArcTanh[a*x])/(d*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[x_*(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (c + d*x^2)^(p + 1)*E^(n*ArcTanh[a*x])/(2*d*(p + 1)) - a*c*n/(2*d*(p + 1))*Int[(c + d*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && LtQ[p, -1] && Not[IntegerQ[n]] && IntegerQ[2*p]
(* Int[x_*(c_+d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]),x_Symbol] := -(2*(p+1)+a*n*x)*(c+d*x^2)^(p+1)*E^(n*ArcTanh[a*x])/(d*(n^2-4*(p+1)^ 2)) - n*(2*p+3)/(a*c*(n^2-4*(p+1)^2))*Int[(c+d*x^2)^(p+1)*E^(n*ArcTanh[a* x]),x] /; FreeQ[{a,c,d,n},x] && EqQ[a^2*c+d,0] && LeQ[p,-1] &&  NeQ[n^2-4*(p+1)^2,0] && Not[IntegerQ[n]] *)
Int[x_^2*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := (1 - a*n*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTanh[a*x])/(a*d*n*(n^2 - 1)) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && EqQ[n^2 + 2*(p + 1), 0] && Not[IntegerQ[n]]
Int[x_^2*(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := -(n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcTanh[a*x])/(a*d*(n^2 - 4*(p + 1)^2)) + (n^2 + 2*(p + 1))/(d*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && LtQ[p, -1] && Not[IntegerQ[n]] && NeQ[n^2 - 4*(p + 1)^2, 0] && IntegerQ[2*p]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - a^2*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0]) && IGtQ[(n + 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - a^2*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0]) && ILtQ[(n - 1)/2, 0] && Not[IntegerQ[p - n/2]]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[x^m*(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^(n/2)*Int[x^m*(c + d*x^2)^(p - n/2)*(1 + a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && IGtQ[n/2, 0]
Int[x_^m_.*(c_ + d_.*x_^2)^p_.*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := 1/c^(n/2)*Int[x^m*(c + d*x^2)^(p + n/2)/(1 - a*x)^n, x] /; FreeQ[{a, c, d, m, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && ILtQ[n/2, 0]
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 - a^2*x^2)^FracPart[p]* Int[x^m*(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && Not[IntegerQ[n/2]]
Int[u_*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[u*(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && (IntegerQ[p] || GtQ[c, 0])
Int[u_*(c_ + d_.*x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^ FracPart[p]/((1 - a*x)^FracPart[p]*(1 + a*x)^FracPart[p])* Int[u*(1 - a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && IntegerQ[n/2]
Int[u_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d*x^2)^FracPart[p]/(1 - a^2*x^2)^FracPart[p]* Int[u*(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[p] || GtQ[c, 0]] && Not[IntegerQ[n/2]]
Int[u_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := d^p*Int[u/x^(2*p)*(1 - a^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[c + a^2*d, 0] && IntegerQ[p]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := c^p*Int[u*(1 - 1/(a*x))^p*(1 + 1/(a*x))^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && GtQ[c, 0]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_*ArcTanh[a_.*x_]), x_Symbol] := x^(2*p)*(c + d/x^2)^p/((1 - a*x)^p*(1 + a*x)^p)* Int[u/x^(2*p)*(1 - a*x)^p*(1 + a*x)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[p]] && IntegerQ[n/2] && Not[GtQ[c, 0]]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_.*ArcTanh[a_.*x_]), x_Symbol] := x^(2*p)*(c + d/x^2)^p/(1 + c*x^2/d)^p* Int[u/x^(2*p)*(1 + c*x^2/d)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[p]] && Not[IntegerQ[n/2]]
Int[E^(n_.*ArcTanh[c_.*(a_ + b_.*x_)]), x_Symbol] := Int[(1 + a*c + b*c*x)^(n/2)/(1 - a*c - b*c*x)^(n/2), x] /; FreeQ[{a, b, c, n}, x]
Int[x_^m_*E^(n_*ArcTanh[c_.*(a_ + b_.*x_)]), x_Symbol] := 4/(n*b^(m + 1)*c^(m + 1))* Subst[ Int[x^(2/n)*(-1 - a*c + (1 - a*c)*x^(2/n))^ m/(1 + x^(2/n))^(m + 2), x], x, (1 + c*(a + b*x))^(n/2)/(1 - c*(a + b*x))^(n/2)] /; FreeQ[{a, b, c}, x] && ILtQ[m, 0] && LtQ[-1, n, 1]
Int[(d_. + e_.*x_)^m_.*E^(n_.*ArcTanh[c_.*(a_ + b_.*x_)]), x_Symbol] := Int[(d + e*x)^m*(1 + a*c + b*c*x)^(n/2)/(1 - a*c - b*c*x)^(n/2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcTanh[a_ + b_.*x_]), x_Symbol] := (c/(1 - a^2))^p* Int[u*(1 - a - b*x)^(p - n/2)*(1 + a + b*x)^(p + n/2), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && (IntegerQ[p] || GtQ[c/(1 - a^2), 0])
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcTanh[a_ + b_.*x_]), x_Symbol] := (c + d*x + e*x^2)^p/(1 - a^2 - 2*a*b*x - b^2*x^2)^p* Int[u*(1 - a^2 - 2*a*b*x - b^2*x^2)^p*E^(n*ArcTanh[a*x]), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && Not[IntegerQ[p] || GtQ[c/(1 - a^2), 0]]
Int[u_.*E^(n_.*ArcTanh[c_./(a_. + b_.*x_)]), x_Symbol] := Int[u*E^(n*ArcCoth[a/c + b*x/c]), x] /; FreeQ[{a, b, c, n}, x]
Int[u_.*E^(n_*ArcCoth[a_.*x_]), x_Symbol] := (-1)^(n/2)*Int[u*E^(n*ArcTanh[a*x]), x] /; FreeQ[a, x] && IntegerQ[n/2]
Int[E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -Subst[ Int[(1 + x/a)^((n + 1)/2)/(x^2*(1 - x/a)^((n - 1)/2)* Sqrt[1 - x^2/a^2]), x], x, 1/x] /; FreeQ[a, x] && IntegerQ[(n - 1)/2]
Int[x_^m_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -Subst[ Int[(1 + x/a)^((n + 1)/2)/(x^(m + 2)*(1 - x/a)^((n - 1)/2)* Sqrt[1 - x^2/a^2]), x], x, 1/x] /; FreeQ[a, x] && IntegerQ[(n - 1)/2] && IntegerQ[m]
Int[E^(n_*ArcCoth[a_.*x_]), x_Symbol] := -Subst[Int[(1 + x/a)^(n/2)/(x^2*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, n}, x] && Not[IntegerQ[n]]
Int[x_^m_.*E^(n_*ArcCoth[a_.*x_]), x_Symbol] := -Subst[Int[(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, n}, x] && Not[IntegerQ[n]] && IntegerQ[m]
Int[x_^m_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -x^m*(1/x)^m* Subst[Int[(1 + x/a)^((n + 1)/2)/(x^(m + 2)*(1 - x/a)^((n - 1)/2)* Sqrt[1 - x^2/a^2]), x], x, 1/x] /; FreeQ[{a, m}, x] && IntegerQ[(n - 1)/2] && Not[IntegerQ[m]]
Int[x_^m_*E^(n_*ArcCoth[a_.*x_]), x_Symbol] := -x^m*(1/x)^m* Subst[Int[(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[n]] && Not[IntegerQ[m]]
Int[(c_ + d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (1 + a*x)*(c + d*x)^p*E^(n*ArcCoth[a*x])/(a*(p + 1)) /; FreeQ[{a, c, d, n, p}, x] && EqQ[a*c + d, 0] && EqQ[p, n/2] && Not[IntegerQ[n/2]]
(* Int[(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Subst[Int[(d+c*x)^(p-n)*(1-x^2/a^2)^(n/2)/x^(p+2),x],x, 1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] && IntegerQ[p] *)
(* Int[x_^m_.*(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Subst[Int[(d+c*x)^(p-n)*(1-x^2/a^2)^(n/2)/x^(m+p+2),x], x,1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] && IntegerQ[m] &&  IntegerQ[p] *)
(* Int[(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Sqrt[c+d*x]/(Sqrt[x]*Sqrt[d+c/x])*Subst[Int[(d+c*x)^(p- n)*(1-x^2/a^2)^(n/2)/x^(p+2),x],x,1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] &&  IntegerQ[p-1/2] *)
(* Int[x_^m_.*(c_+d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]),x_Symbol] := -(-a)^n*c^n*Sqrt[c+d*x]/(Sqrt[x]*Sqrt[d+c/x])*Subst[Int[(d+c*x)^(p- n)*(1-x^2/a^2)^(n/2)/x^(m+p+2),x],x,1/x] /; FreeQ[{a,c,d},x] && EqQ[a*c+d,0] && IntegerQ[(n-1)/2] && IntegerQ[m] &&  IntegerQ[p-1/2] *)
Int[u_.*(c_ + d_.*x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := d^p*Int[u*x^p*(1 + c/(d*x))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c^2 - d^2, 0] && Not[IntegerQ[n/2]] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (c + d*x)^p/(x^p*(1 + c/(d*x))^p)* Int[u*x^p*(1 + c/(d*x))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c^2 - d^2, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p]]
Int[(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^n*Subst[Int[(c + d*x)^(p - n)*(1 - x^2/a^2)^(n/2)/x^2, x], x, 1/x] /; FreeQ[{a, c, d, p}, x] && EqQ[c + a*d, 0] && IntegerQ[(n - 1)/2] && (IntegerQ[p] || EqQ[p, n/2] || EqQ[p, n/2 + 1]) && IntegerQ[2*p]
Int[x_^m_.*(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^n*Subst[Int[(c + d*x)^(p - n)*(1 - x^2/a^2)^(n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, p}, x] && EqQ[c + a*d, 0] && IntegerQ[(n - 1)/2] && IntegerQ[ m] && (IntegerQ[p] || EqQ[p, n/2] || EqQ[p, n/2 + 1] || LtQ[-5, m, -1]) && IntegerQ[2*p]
Int[(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 + d*x/c)^p*(1 + x/a)^(n/2)/(x^2*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0])
Int[x_^m_.*(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 + d*x/c)^p*(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && IntegerQ[m]
Int[x_^m_*(c_ + d_./x_)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*x^m*(1/x)^m* Subst[Int[(1 + d*x/c)^ p*(1 + x/a)^(n/2)/(x^(m + 2)*(1 - x/a)^(n/2)), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegerQ[m]]
Int[u_.*(c_ + d_./x_)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (c + d/x)^p/(1 + d/(c*x))^p* Int[u*(1 + d/(c*x))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c^2 - a^2*d^2, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[E^(n_.*ArcCoth[a_.*x_])/(c_ + d_.*x_^2), x_Symbol] := E^(n*ArcCoth[a*x])/(a*c*n) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]]
Int[E^(n_*ArcCoth[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := (n - a*x)*E^(n*ArcCoth[a*x])/(a*c*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (n + 2*a*(p + 1)*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a*c*(n^2 - 4*(p + 1)^2)) - 2*(p + 1)*(2*p + 3)/(c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && LtQ[p, -1] && NeQ[p, -3/2] && NeQ[n^2 - 4*(p + 1)^2, 0] && (IntegerQ[p] || Not[IntegerQ[n]])
Int[x_*E^(n_*ArcCoth[a_.*x_])/(c_ + d_.*x_^2)^(3/2), x_Symbol] := -(1 - a*n*x)*E^(n*ArcCoth[a*x])/(a^2*c*(n^2 - 1)*Sqrt[c + d*x^2]) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n]]
Int[x_*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (2*(p + 1) + a*n*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a^2*c*(n^2 - 4*(p + 1)^2)) - n*(2*p + 3)/(a*c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && LeQ[p, -1] && NeQ[p, -3/2] && NeQ[n^2 - 4*(p + 1)^2, 0] && (IntegerQ[p] || Not[IntegerQ[n]])
Int[x_^2*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -(n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a^3*c*n^2*(n^2 - 1)) /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && EqQ[n^2 + 2*(p + 1), 0] && NeQ[n^2, 1]
Int[x_^2*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (n + 2*(p + 1)*a*x)*(c + d*x^2)^(p + 1)* E^(n*ArcCoth[a*x])/(a^3*c*(n^2 - 4*(p + 1)^2)) - (n^2 + 2*(p + 1))/(a^2*c*(n^2 - 4*(p + 1)^2))* Int[(c + d*x^2)^(p + 1)*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && LeQ[p, -1] && NeQ[n^2 + 2*(p + 1), 0] && NeQ[n^2 - 4*(p + 1)^2, 0] && (IntegerQ[p] || Not[IntegerQ[n]])
Int[x_^m_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -(-c)^p/a^(m + 1)* Subst[Int[E^(n*x)*Coth[x]^(m + 2*(p + 1))/Cosh[x]^(2*(p + 1)), x], x, ArcCoth[a*x]] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && IntegerQ[m] && LeQ[3, m, -2 (p + 1)] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := d^p*Int[u*x^(2*p)*(1 - 1/(a^2*x^2))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && IntegerQ[p]
Int[u_.*(c_ + d_.*x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := (c + d*x^2)^p/(x^(2*p)*(1 - 1/(a^2*x^2))^p)* Int[u*x^(2*p)*(1 - 1/(a^2*x^2))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[a^2*c + d, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p]]
Int[u_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := c^p/a^(2*p)* Int[u/x^(2*p)*(-1 + a*x)^(p - n/2)*(1 + a*x)^(p + n/2), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && IntegersQ[2*p, p + n/2]
Int[(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[Int[(1 - x/a)^(p - n/2)*(1 + x/a)^(p + n/2)/x^2, x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegersQ[2*p, p + n/2]]
Int[x_^m_.*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*Subst[ Int[(1 - x/a)^(p - n/2)*(1 + x/a)^(p + n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegersQ[2*p, p + n/2]] && IntegerQ[m]
Int[x_^m_*(c_ + d_./x_^2)^p_.*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := -c^p*x^m*(1/x)^m* Subst[Int[(1 - x/a)^(p - n/2)*(1 + x/a)^(p + n/2)/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, d, m, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && (IntegerQ[p] || GtQ[c, 0]) && Not[IntegersQ[2*p, p + n/2]] && Not[IntegerQ[m]]
Int[u_.*(c_ + d_./x_^2)^p_*E^(n_.*ArcCoth[a_.*x_]), x_Symbol] := c^IntPart[p]*(c + d/x^2)^FracPart[p]/(1 - 1/(a^2*x^2))^FracPart[p]* Int[u*(1 - 1/(a^2*x^2))^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, c, d, n, p}, x] && EqQ[c + a^2*d, 0] && Not[IntegerQ[n/2]] && Not[IntegerQ[p] || GtQ[c, 0]]
Int[u_.*E^(n_*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (-1)^(n/2)*Int[u*E^(n*ArcTanh[c*(a + b*x)]), x] /; FreeQ[{a, b, c}, x] && IntegerQ[n/2]
Int[E^(n_.*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (c*(a + b*x))^(n/ 2)*(1 + 1/(c*(a + b*x)))^(n/2)/(1 + a*c + b*c*x)^(n/2)* Int[(1 + a*c + b*c*x)^(n/2)/(-1 + a*c + b*c*x)^(n/2), x] /; FreeQ[{a, b, c, n}, x] && Not[IntegerQ[n/2]]
Int[x_^m_*E^(n_*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := -4/(n*b^(m + 1)*c^(m + 1))* Subst[ Int[x^(2/n)*(1 + a*c + (1 - a*c)*x^(2/n))^ m/(-1 + x^(2/n))^(m + 2), x], x, (1 + 1/(c*(a + b*x)))^(n/2)/(1 - 1/(c*(a + b*x)))^(n/2)] /; FreeQ[{a, b, c}, x] && ILtQ[m, 0] && LtQ[-1, n, 1]
Int[(d_. + e_.*x_)^m_.*E^(n_.*ArcCoth[c_.*(a_ + b_.*x_)]), x_Symbol] := (c*(a + b*x))^(n/ 2)*(1 + 1/(c*(a + b*x)))^(n/2)/(1 + a*c + b*c*x)^(n/2)* Int[(d + e*x)^m*(1 + a*c + b*c*x)^(n/2)/(-1 + a*c + b*c*x)^(n/2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && Not[IntegerQ[n/2]]
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcCoth[a_ + b_.*x_]), x_Symbol] := (c/(1 - a^2))^ p*((a + b*x)/(1 + a + b*x))^(n/2)*((1 + a + b*x)/(a + b*x))^(n/ 2)*((1 - a - b*x)^(n/2)/(-1 + a + b*x)^(n/2))* Int[u*(1 - a - b*x)^(p - n/2)*(1 + a + b*x)^(p + n/2), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && Not[IntegerQ[n/2]] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && (IntegerQ[p] || GtQ[c/(1 - a^2), 0])
Int[u_.*(c_ + d_.*x_ + e_.*x_^2)^p_.*E^(n_.*ArcCoth[a_ + b_.*x_]), x_Symbol] := (c + d*x + e*x^2)^p/(1 - a^2 - 2*a*b*x - b^2*x^2)^p* Int[u*(1 - a^2 - 2*a*b*x - b^2*x^2)^p*E^(n*ArcCoth[a*x]), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && Not[IntegerQ[n/2]] && EqQ[b*d - 2*a*e, 0] && EqQ[b^2*c + e (1 - a^2), 0] && Not[IntegerQ[p] || GtQ[c/(1 - a^2), 0]]
Int[u_.*E^(n_.*ArcCoth[c_./(a_. + b_.*x_)]), x_Symbol] := Int[u*E^(n*ArcTanh[a/c + b*x/c]), x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.3 Inverse hyperbolic tangent/7.3.7 Miscellaneous inverse hyperbolic tangent.m
*)

(* ::Subsection::Closed:: *)
(* 7.3.7 Miscellaneous inverse hyperbolic tangent *)
Int[ArcTanh[a_ + b_.*x_^n_], x_Symbol] := x*ArcTanh[a + b*x^n] - b*n*Int[x^n/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b, n}, x]
Int[ArcCoth[a_ + b_.*x_^n_], x_Symbol] := x*ArcCoth[a + b*x^n] - b*n*Int[x^n/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b, n}, x]
Int[ArcTanh[a_. + b_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[1 + a + b*x^n]/x, x] - 1/2*Int[Log[1 - a - b*x^n]/x, x] /; FreeQ[{a, b, n}, x]
Int[ArcCoth[a_. + b_.*x_^n_.]/x_, x_Symbol] := 1/2*Int[Log[1 + 1/(a + b*x^n)]/x, x] - 1/2*Int[Log[1 - 1/(a + b*x^n)]/x, x] /; FreeQ[{a, b, n}, x]
Int[x_^m_.*ArcTanh[a_ + b_.*x_^n_], x_Symbol] := x^(m + 1)*ArcTanh[a + b*x^n]/(m + 1) - b*n/(m + 1)* Int[x^(m + n)/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b}, x] && RationalQ[m, n] && NeQ[m, -1] && NeQ[m + 1, n]
Int[x_^m_.*ArcCoth[a_ + b_.*x_^n_], x_Symbol] := x^(m + 1)*ArcCoth[a + b*x^n]/(m + 1) - b*n/(m + 1)* Int[x^(m + n)/(1 - a^2 - 2*a*b*x^n - b^2*x^(2*n)), x] /; FreeQ[{a, b}, x] && RationalQ[m, n] && NeQ[m, -1] && NeQ[m + 1, n]
Int[ArcTanh[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[Log[1 + a + b*f^(c + d*x)], x] - 1/2*Int[Log[1 - a - b*f^(c + d*x)], x] /; FreeQ[{a, b, c, d, f}, x] 
Int[ArcCoth[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[Log[1 + 1/(a + b*f^(c + d*x))], x] - 1/2*Int[Log[1 - 1/(a + b*f^(c + d*x))], x] /; FreeQ[{a, b, c, d, f}, x] 
Int[x_^m_.*ArcTanh[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[x^m*Log[1 + a + b*f^(c + d*x)], x] - 1/2*Int[x^m*Log[1 - a - b*f^(c + d*x)], x] /; FreeQ[{a, b, c, d, f}, x] && IGtQ[m, 0]
Int[x_^m_.*ArcCoth[a_. + b_.*f_^(c_. + d_.*x_)], x_Symbol] := 1/2*Int[x^m*Log[1 + 1/(a + b*f^(c + d*x))], x] - 1/2*Int[x^m*Log[1 - 1/(a + b*f^(c + d*x))], x] /; FreeQ[{a, b, c, d, f}, x] && IGtQ[m, 0]
Int[u_.*ArcTanh[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCoth[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*ArcCoth[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcTanh[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := x*ArcTanh[(c*x)/Sqrt[a + b*x^2]] - c*Int[x/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := x*ArcCoth[(c*x)/Sqrt[a + b*x^2]] - c*Int[x/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]/x_, x_Symbol] := ArcTanh[c*x/Sqrt[a + b*x^2]]*Log[x] - c*Int[Log[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]/x_, x_Symbol] := ArcCoth[c*x/Sqrt[a + b*x^2]]*Log[x] - c*Int[Log[x]/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[(d_.*x_)^m_.*ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := (d*x)^(m + 1)*ArcTanh[(c*x)/Sqrt[a + b*x^2]]/(d*(m + 1)) - c/(d*(m + 1))*Int[(d*x)^(m + 1)/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[(d_.*x_)^m_.*ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]], x_Symbol] := (d*x)^(m + 1)*ArcCoth[(c*x)/Sqrt[a + b*x^2]]/(d*(m + 1)) - c/(d*(m + 1))*Int[(d*x)^(m + 1)/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[1/(Sqrt[a_. + b_.*x_^2]*ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]), x_Symbol] := 1/c*Log[ArcTanh[c*x/Sqrt[a + b*x^2]]] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[1/(Sqrt[a_. + b_.*x_^2]*ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]), x_Symbol] := -1/c*Log[ArcCoth[c*x/Sqrt[a + b*x^2]]] /; FreeQ[{a, b, c}, x] && EqQ[b, c^2]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[a_. + b_.*x_^2], x_Symbol] := ArcTanh[c*x/Sqrt[a + b*x^2]]^(m + 1)/(c*(m + 1)) /; FreeQ[{a, b, c, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[a_. + b_.*x_^2], x_Symbol] := -ArcCoth[c*x/Sqrt[a + b*x^2]]^(m + 1)/(c*(m + 1)) /; FreeQ[{a, b, c, m}, x] && EqQ[b, c^2] && NeQ[m, -1]
Int[ArcTanh[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[d_. + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[d + e*x^2]* Int[ArcTanh[c*x/Sqrt[a + b*x^2]]^m/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b, c^2] && EqQ[b*d - a*e, 0]
Int[ArcCoth[c_.*x_/Sqrt[a_. + b_.*x_^2]]^m_./Sqrt[d_. + e_.*x_^2], x_Symbol] := Sqrt[a + b*x^2]/Sqrt[d + e*x^2]* Int[ArcCoth[c*x/Sqrt[a + b*x^2]]^m/Sqrt[a + b*x^2], x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b, c^2] && EqQ[b*d - a*e, 0]
If[TrueQ[$LoadShowSteps], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, ShowStep["", "Int[f[x,ArcTanh[a+b*x]]/(1-(a+b*x)^2),x]", "Subst[Int[f[-a/b+Tanh[x]/b,x],x],x,ArcTanh[a+b*x]]/b", Hold[ (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[Int[ SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Sech[x]^(2*(n + 1)), x], x], x, tmp]]] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcTanh] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; SimplifyFlag && QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[ Int[SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*Sech[x]^(2*(n + 1)), x], x], x, tmp] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcTanh] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]]]
If[TrueQ[$LoadShowSteps], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, ShowStep["", "Int[f[x,ArcCoth[a+b*x]]/(1-(a+b*x)^2),x]", "Subst[Int[f[-a/b+Coth[x]/b,x],x],x,ArcCoth[a+b*x]]/b", Hold[ (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[Int[ SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*(-Csch[x]^2)^(n + 1), x], x], x, tmp]]] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcCoth] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; SimplifyFlag && QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]], Int[u_*v_^n_., x_Symbol] := With[{tmp = InverseFunctionOfLinear[u, x]}, (-Discriminant[v, x]/(4*Coefficient[v, x, 2]))^n/ Coefficient[tmp[[1]], x, 1]* Subst[ Int[SimplifyIntegrand[ SubstForInverseFunction[u, tmp, x]*(-Csch[x]^2)^(n + 1), x], x], x, tmp] /; Not[FalseQ[tmp]] && EqQ[Head[tmp], ArcCoth] && EqQ[Discriminant[v, x]*tmp[[1]]^2 - D[v, x]^2, 0]] /; QuadraticQ[v, x] && ILtQ[n, 0] && PosQ[Discriminant[v, x]] && MatchQ[u, r_.*f_^w_ /; FreeQ[f, x]]]
Int[ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tanh[a + b*x]] + b*Int[x/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tanh[a + b*x]] + b*Int[x/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Coth[a + b*x]] + b*Int[x/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Coth[a + b*x]] + b*Int[x/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - d)^2, 1]
Int[ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tanh[a + b*x]] + b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tanh[a + b*x]] + b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Coth[a + b*x]] + b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Coth[a + b*x]] + b*(1 + c + d)* Int[x*E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)* Int[x*E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d + c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Coth[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Coth[a + b*x]]/(f*(m + 1)) + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - d - c*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tanh[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tanh[a + b*x]]/(f*(m + 1)) + b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d + (1 - c - d)*E^(2*a + 2*b*x)), x] - b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d + (1 + c + d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Coth[a + b*x]]/(f*(m + 1)) + b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Coth[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Coth[a + b*x]]/(f*(m + 1)) + b*(1 + c + d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 + c - d - (1 + c + d)*E^(2*a + 2*b*x)), x] - b*(1 - c - d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*a + 2*b*x)/(1 - c + d - (1 - c - d)*E^(2*a + 2*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - d)^2, 1]
Int[ArcTanh[Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[Tan[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcCoth[Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[Tan[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcTanh[Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[Cot[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[ArcCoth[Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[Cot[a + b*x]] - b*Int[x*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b}, x]
Int[(e_. + f_.*x_)^m_.*ArcTanh[Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[Tan[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcCoth[Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[Tan[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcTanh[Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[Cot[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*ArcCoth[Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[Cot[a + b*x]]/(f*(m + 1)) - b/(f*(m + 1))*Int[(e + f*x)^(m + 1)*Sec[2*a + 2*b*x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m, 0]
Int[ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tan[a + b*x]] + I*b*Int[x/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c + I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tan[a + b*x]] + I*b*Int[x/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c + I*d)^2, 1]
Int[ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Cot[a + b*x]] + I*b*Int[x/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Cot[a + b*x]] + I*b*Int[x/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && EqQ[(c - I*d)^2, 1]
Int[ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Tan[a + b*x]] + I*b*(1 - c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Tan[a + b*x]] + I*b*(1 - c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c + I*d)^2, 1]
Int[ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcTanh[c + d*Cot[a + b*x]] - I*b*(1 - c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - I*d)^2, 1]
Int[ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := x*ArcCoth[c + d*Cot[a + b*x]] - I*b*(1 - c - I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)* Int[x*E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c + I*d + c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Cot[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Cot[a + b*x]]/(f*(m + 1)) + I*b/(f*(m + 1))* Int[(e + f*x)^(m + 1)/(c - I*d - c*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b*(1 - c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Tan[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Tan[a + b*x]]/(f*(m + 1)) + I*b*(1 - c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c - I*d + (1 - c + I*d)*E^(2*I*a + 2*I*b*x)), x] - I*b*(1 + c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c + I*d + (1 + c - I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c + I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcTanh[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcTanh[c + d*Cot[a + b*x]]/(f*(m + 1)) - I*b*(1 - c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - I*d)^2, 1]
Int[(e_. + f_.*x_)^m_.*ArcCoth[c_. + d_.*Cot[a_. + b_.*x_]], x_Symbol] := (e + f*x)^(m + 1)*ArcCoth[c + d*Cot[a + b*x]]/(f*(m + 1)) - I*b*(1 - c - I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 - c + I*d - (1 - c - I*d)*E^(2*I*a + 2*I*b*x)), x] + I*b*(1 + c + I*d)/(f*(m + 1))* Int[(e + f*x)^(m + 1)* E^(2*I*a + 2*I*b*x)/(1 + c - I*d - (1 + c + I*d)*E^(2*I*a + 2*I*b*x)), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[(c - I*d)^2, 1]
Int[ArcTanh[u_], x_Symbol] := x*ArcTanh[u] - Int[SimplifyIntegrand[x*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[u, x]
Int[ArcCoth[u_], x_Symbol] := x*ArcCoth[u] - Int[SimplifyIntegrand[x*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[u, x]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcTanh[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcTanh[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(1 - u^2), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && FalseQ[PowerVariableExpn[u, m + 1, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCoth[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCoth[u])/(d*(m + 1)) - b/(d*(m + 1))* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(1 - u^2), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && FalseQ[PowerVariableExpn[u, m + 1, x]]
Int[v_*(a_. + b_.*ArcTanh[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcTanh[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]] && FalseQ[FunctionOfLinear[v*(a + b*ArcTanh[u]), x]]
Int[v_*(a_. + b_.*ArcCoth[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCoth[u]), w, x] - b*Int[SimplifyIntegrand[w*D[u, x]/(1 - u^2), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]] && FalseQ[FunctionOfLinear[v*(a + b*ArcCoth[u]), x]]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.5 Inverse hyperbolic secant/7.5.1 u (a+b arcsech(c x))^n.m
*)

(* ::Subsection::Closed:: *)
(* 7.5.1 u (a+b arcsech(c x))^n *)
Int[ArcSech[c_.*x_], x_Symbol] := x*ArcSech[c*x] + Sqrt[1 + c*x]*Sqrt[1/(1 + c*x)]*Int[1/Sqrt[1 - c^2*x^2], x] /; FreeQ[c, x]
Int[ArcCsch[c_.*x_], x_Symbol] := x*ArcCsch[c*x] + 1/c*Int[1/(x*Sqrt[1 + 1/(c^2*x^2)]), x] /; FreeQ[c, x]
Int[(a_. + b_.*ArcSech[c_.*x_])^n_, x_Symbol] := -1/c*Subst[Int[(a + b*x)^n*Sech[x]*Tanh[x], x], x, ArcSech[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[n, 0]
Int[(a_. + b_.*ArcCsch[c_.*x_])^n_, x_Symbol] := -1/c*Subst[Int[(a + b*x)^n*Csch[x]*Coth[x], x], x, ArcCsch[c*x]] /; FreeQ[{a, b, c, n}, x] && IGtQ[n, 0]
Int[(a_. + b_.*ArcSech[c_.*x_])/x_, x_Symbol] := -Subst[Int[(a + b*ArcCosh[x/c])/x, x], x, 1/x] /; FreeQ[{a, b, c}, x]
Int[(a_. + b_.*ArcCsch[c_.*x_])/x_, x_Symbol] := -Subst[Int[(a + b*ArcSinh[x/c])/x, x], x, 1/x] /; FreeQ[{a, b, c}, x]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcSech[c_.*x_]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcSech[c*x])/(d*(m + 1)) + b*Sqrt[1 + c*x]/(m + 1)*Sqrt[1/(1 + c*x)]* Int[(d*x)^m/(Sqrt[1 - c*x]*Sqrt[1 + c*x]), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[(d_.*x_)^m_.*(a_. + b_.*ArcCsch[c_.*x_]), x_Symbol] := (d*x)^(m + 1)*(a + b*ArcCsch[c*x])/(d*(m + 1)) + b*d/(c*(m + 1))*Int[(d*x)^(m - 1)/Sqrt[1 + 1/(c^2*x^2)], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[x_^m_.*(a_. + b_.*ArcSech[c_.*x_])^n_, x_Symbol] := -1/c^(m + 1)* Subst[Int[(a + b*x)^n*Sech[x]^(m + 1)*Tanh[x], x], x, ArcSech[c*x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && IntegerQ[m] && (GtQ[n, 0] || LtQ[m, -1])
Int[x_^m_.*(a_. + b_.*ArcCsch[c_.*x_])^n_, x_Symbol] := -1/c^(m + 1)* Subst[Int[(a + b*x)^n*Csch[x]^(m + 1)*Coth[x], x], x, ArcCsch[c*x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && IntegerQ[m] && (GtQ[n, 0] || LtQ[m, -1])
Int[(a_. + b_.*ArcSech[c_.*x_])/(d_. + e_.*x_), x_Symbol] := (a + b*ArcSech[c*x])* Log[1 + (e - Sqrt[-c^2*d^2 + e^2])/(c*d*E^ArcSech[c*x])]/e + (a + b*ArcSech[c*x])* Log[1 + (e + Sqrt[-c^2*d^2 + e^2])/(c*d*E^ArcSech[c*x])]/e - (a + b*ArcSech[c*x])*Log[1 + 1/E^(2*ArcSech[c*x])]/e + b/e* Int[(Sqrt[(1 - c*x)/(1 + c*x)]* Log[1 + (e - Sqrt[-c^2*d^2 + e^2])/(c*d* E^ArcSech[c*x])])/(x*(1 - c*x)), x] + b/e* Int[(Sqrt[(1 - c*x)/(1 + c*x)]* Log[1 + (e + Sqrt[-c^2*d^2 + e^2])/(c*d* E^ArcSech[c*x])])/(x*(1 - c*x)), x] - b/e* Int[(Sqrt[(1 - c*x)/(1 + c*x)]* Log[1 + 1/E^(2*ArcSech[c*x])])/(x*(1 - c*x)), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcSech[c_.*x_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcSech[c*x])/(e*(m + 1)) + b*Sqrt[1 + c*x]/(e*(m + 1))*Sqrt[1/(1 + c*x)]* Int[(d + e*x)^(m + 1)/(x*Sqrt[1 - c^2*x^2]), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[m, -1]
Int[(a_. + b_.*ArcCsch[c_.*x_])/(d_. + e_.*x_), x_Symbol] := (a + b*ArcCsch[c*x])* Log[1 - (e - Sqrt[c^2*d^2 + e^2])*E^ArcCsch[c*x]/(c*d)]/e + (a + b*ArcCsch[c*x])* Log[1 - (e + Sqrt[c^2*d^2 + e^2])*E^ArcCsch[c*x]/(c*d)]/e - (a + b*ArcCsch[c*x])*Log[1 - E^(2*ArcCsch[c*x])]/e + b/(c*e)* Int[Log[1 - (e - Sqrt[c^2*d^2 + e^2])*E^ArcCsch[c*x]/(c*d)]/(x^2* Sqrt[1 + 1/(c^2*x^2)]), x] + b/(c*e)* Int[Log[1 - (e + Sqrt[c^2*d^2 + e^2])*E^ArcCsch[c*x]/(c*d)]/(x^2* Sqrt[1 + 1/(c^2*x^2)]), x] - b/(c*e)* Int[Log[1 - E^(2*ArcCsch[c*x])]/(x^2*Sqrt[1 + 1/(c^2*x^2)]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[(d_. + e_.*x_)^m_.*(a_. + b_.*ArcCsch[c_.*x_]), x_Symbol] := (d + e*x)^(m + 1)*(a + b*ArcCsch[c*x])/(e*(m + 1)) + b/(c*e*(m + 1))* Int[(d + e*x)^(m + 1)/(x^2*Sqrt[1 + 1/(c^2*x^2)]), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[m, -1]
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSech[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[(a + b*ArcSech[c*x]), u, x] + b*Sqrt[1 + c*x]*Sqrt[1/(1 + c*x)]* Int[SimplifyIntegrand[u/(x*Sqrt[1 - c*x]*Sqrt[1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e}, x] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsch[c_.*x_]), x_Symbol] := With[{u = IntHide[(d + e*x^2)^p, x]}, Dist[(a + b*ArcCsch[c*x]), u, x] - b*c*x/Sqrt[-c^2*x^2]* Int[SimplifyIntegrand[u/(x*Sqrt[-1 - c^2*x^2]), x], x]] /; FreeQ[{a, b, c, d, e}, x] && (IGtQ[p, 0] || ILtQ[p + 1/2, 0])
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := -Subst[Int[(e + d*x^2)^p*(a + b*ArcCosh[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegerQ[p]
Int[(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := -Subst[Int[(e + d*x^2)^p*(a + b*ArcSinh[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegerQ[p]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcCosh[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcSinh[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[e - c^2*d, 0] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcCosh[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcSinh[x/c])^n/x^(2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[e - c^2*d, 0] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[x_*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSech[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcSech[c*x])/(2*e*(p + 1)) + b*Sqrt[1 + c*x]/(2*e*(p + 1))*Sqrt[1/(1 + c*x)]* Int[(d + e*x^2)^(p + 1)/(x*Sqrt[1 - c*x]*Sqrt[1 + c*x]), x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[p, -1]
Int[x_*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsch[c_.*x_]), x_Symbol] := (d + e*x^2)^(p + 1)*(a + b*ArcCsch[c*x])/(2*e*(p + 1)) - b*c*x/(2*e*(p + 1)*Sqrt[-c^2*x^2])* Int[(d + e*x^2)^(p + 1)/(x*Sqrt[-1 - c^2*x^2]), x] /; FreeQ[{a, b, c, d, e, p}, x] && NeQ[p, -1]
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSech[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[(a + b*ArcSech[c*x]), u, x] + b*Sqrt[1 + c*x]*Sqrt[1/(1 + c*x)]* Int[SimplifyIntegrand[u/(x*Sqrt[1 - c*x]*Sqrt[1 + c*x]), x], x]] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && ( IGtQ[p, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*p + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[p, 0] && GtQ[m + 2*p + 3, 0]] || ILtQ[(m + 2*p + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]])
Int[(f_.*x_)^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsch[c_.*x_]), x_Symbol] := With[{u = IntHide[(f*x)^m*(d + e*x^2)^p, x]}, Dist[(a + b*ArcCsch[c*x]), u, x] - b*c*x/Sqrt[-c^2*x^2]* Int[SimplifyIntegrand[u/(x*Sqrt[-1 - c^2*x^2]), x], x]] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && ( IGtQ[p, 0] && Not[ILtQ[(m - 1)/2, 0] && GtQ[m + 2*p + 3, 0]] || IGtQ[(m + 1)/2, 0] && Not[ILtQ[p, 0] && GtQ[m + 2*p + 3, 0]] || ILtQ[(m + 2*p + 1)/2, 0] && Not[ILtQ[(m - 1)/2, 0]] )
Int[x_^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := -Subst[ Int[(e + d*x^2)^p*(a + b*ArcCosh[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegersQ[m, p]
Int[x_^m_.*(d_. + e_.*x_^2)^p_.*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := -Subst[ Int[(e + d*x^2)^p*(a + b*ArcSinh[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && IntegersQ[m, p]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcCosh[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := -Sqrt[x^2]/x* Subst[Int[(e + d*x^2)^p*(a + b*ArcSinh[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[e - c^2*d, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && GtQ[e, 0] && LtQ[d, 0]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcCosh[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[c^2*d + e, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[x_^m_.*(d_. + e_.*x_^2)^p_*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := -Sqrt[d + e*x^2]/(x*Sqrt[e + d/x^2])* Subst[Int[(e + d*x^2)^p*(a + b*ArcSinh[x/c])^n/x^(m + 2*(p + 1)), x], x, 1/x] /; FreeQ[{a, b, c, d, e, n}, x] && IGtQ[n, 0] && EqQ[e - c^2*d, 0] && IntegerQ[m] && IntegerQ[p + 1/2] && Not[GtQ[e, 0] && LtQ[d, 0]]
Int[u_*(a_. + b_.*ArcSech[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[(a + b*ArcSech[c*x]), v, x] + b* Sqrt[1 - c^2*x^2]/(c*x*Sqrt[-1 + 1/(c*x)]*Sqrt[1 + 1/(c*x)])* Int[SimplifyIntegrand[v/(x*Sqrt[1 - c^2*x^2]), x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[u_*(a_. + b_.*ArcCsch[c_.*x_]), x_Symbol] := With[{v = IntHide[u, x]}, Dist[(a + b*ArcCsch[c*x]), v, x] + b/c* Int[SimplifyIntegrand[v/(x^2*Sqrt[1 + 1/(c^2*x^2)]), x], x] /; InverseFunctionFreeQ[v, x]] /; FreeQ[{a, b, c}, x]
Int[u_.*(a_. + b_.*ArcSech[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcSech[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]
Int[u_.*(a_. + b_.*ArcCsch[c_.*x_])^n_., x_Symbol] := Unintegrable[u*(a + b*ArcCsch[c*x])^n, x] /; FreeQ[{a, b, c, n}, x]

(*FILE: 
Rubi/IntegrationRules/7 Inverse hyperbolic functions/7.5 Inverse hyperbolic secant/7.5.2 Miscellaneous inverse hyperbolic secant.m
*)

(* ::Subsection::Closed:: *)
(* 7.5.2 Miscellaneous inverse hyperbolic secant *)
Int[ArcSech[c_ + d_.*x_], x_Symbol] := (c + d*x)*ArcSech[c + d*x]/d + Int[Sqrt[(1 - c - d*x)/(1 + c + d*x)]/(1 - c - d*x), x] /; FreeQ[{c, d}, x]
Int[ArcCsch[c_ + d_.*x_], x_Symbol] := (c + d*x)*ArcCsch[c + d*x]/d + Int[1/((c + d*x)*Sqrt[1 + 1/(c + d*x)^2]), x] /; FreeQ[{c, d}, x]
Int[(a_. + b_.*ArcSech[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcSech[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcCsch[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(a + b*ArcCsch[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0]
Int[(a_. + b_.*ArcSech[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcSech[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(a_. + b_.*ArcCsch[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(a + b*ArcCsch[c + d*x])^p, x] /; FreeQ[{a, b, c, d, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSech[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcSech[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsch[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[(f*x/d)^m*(a + b*ArcCsch[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[d*e - c*f, 0] && IGtQ[p, 0]
(* Int[x_^m_.*ArcSech[a_+b_.*x_],x_Symbol] := -((-a)^(m+1)-b^(m+1)*x^(m+1))*ArcSech[a+b*x]/(b^(m+1)*(m+1)) + 1/(b^(m+1)*(m+1))*Subst[Int[((-a*x)^(m+1)-(1-a*x)^(m+1))/(x^(m+1)* Sqrt[-1+x]*Sqrt[1+x]),x],x,1/(a+b*x)] /; FreeQ[{a,b},x] && IntegerQ[m] && NeQ[m,-1] *)
(* Int[x_^m_.*ArcCsch[a_+b_.*x_],x_Symbol] := -((-a)^(m+1)-b^(m+1)*x^(m+1))*ArcCsch[a+b*x]/(b^(m+1)*(m+1)) + 1/(b^(m+1)*(m+1))*Subst[Int[((-a*x)^(m+1)-(1-a*x)^(m+1))/(x^(m+1)* Sqrt[1+x^2]),x],x,1/(a+b*x)] /; FreeQ[{a,b},x] && IntegerQ[m] && NeQ[m,-1] *)
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSech[c_ + d_.*x_])^p_., x_Symbol] := -1/d^(m + 1)* Subst[Int[(a + b*x)^p*Sech[x]*Tanh[x]*(d*e - c*f + f*Sech[x])^m, x], x, ArcSech[c + d*x]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsch[c_ + d_.*x_])^p_., x_Symbol] := -1/d^(m + 1)* Subst[Int[(a + b*x)^p*Csch[x]*Coth[x]*(d*e - c*f + f*Csch[x])^m, x], x, ArcCsch[c + d*x]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[m]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSech[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcSech[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsch[c_ + d_.*x_])^p_., x_Symbol] := 1/d*Subst[Int[((d*e - c*f)/d + f*x/d)^m*(a + b*ArcCsch[x])^p, x], x, c + d*x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcSech[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcSech[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[(e_. + f_.*x_)^m_.*(a_. + b_.*ArcCsch[c_ + d_.*x_])^p_, x_Symbol] := Unintegrable[(e + f*x)^m*(a + b*ArcCsch[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && Not[IGtQ[p, 0]]
Int[u_.*ArcSech[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcCosh[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[u_.*ArcCsch[c_./(a_. + b_.*x_^n_.)]^m_., x_Symbol] := Int[u*ArcSinh[a/c + b*x^n/c]^m, x] /; FreeQ[{a, b, c, n, m}, x]
Int[E^ArcSech[a_.*x_], x_Symbol] := x*E^ArcSech[a*x] + Log[x]/a + 1/a*Int[1/(x*(1 - a*x))*Sqrt[(1 - a*x)/(1 + a*x)], x] /; FreeQ[a, x]
Int[E^ArcSech[a_.*x_^p_], x_Symbol] := x*E^ArcSech[a*x^p] + p/a*Int[1/x^p, x] + p*Sqrt[1 + a*x^p]/a*Sqrt[1/(1 + a*x^p)]* Int[1/(x^p*Sqrt[1 + a*x^p]*Sqrt[1 - a*x^p]), x] /; FreeQ[{a, p}, x]
Int[E^ArcCsch[a_.*x_^p_.], x_Symbol] := 1/a*Int[1/x^p, x] + Int[Sqrt[1 + 1/(a^2*x^(2*p))], x] /; FreeQ[{a, p}, x]
Int[E^(n_.*ArcSech[u_]), x_Symbol] := Int[(1/u + Sqrt[(1 - u)/(1 + u)] + 1/u*Sqrt[(1 - u)/(1 + u)])^n, x] /; IntegerQ[n]
Int[E^(n_.*ArcCsch[u_]), x_Symbol] := Int[(1/u + Sqrt[1 + 1/u^2])^n, x] /; IntegerQ[n]
Int[E^ArcSech[a_.*x_^p_.]/x_, x_Symbol] := -1/(a*p*x^p) + Sqrt[1 + a*x^p]/a*Sqrt[1/(1 + a*x^p)]* Int[Sqrt[1 + a*x^p]*Sqrt[1 - a*x^p]/x^(p + 1), x] /; FreeQ[{a, p}, x]
Int[x_^m_.*E^ArcSech[a_.*x_^p_.], x_Symbol] := x^(m + 1)*E^ArcSech[a*x^p]/(m + 1) + p/(a*(m + 1))*Int[x^(m - p), x] + p*Sqrt[1 + a*x^p]/(a*(m + 1))*Sqrt[1/(1 + a*x^p)]* Int[x^(m - p)/(Sqrt[1 + a*x^p]*Sqrt[1 - a*x^p]), x] /; FreeQ[{a, m, p}, x] && NeQ[m, -1]
Int[x_^m_.*E^ArcCsch[a_.*x_^p_.], x_Symbol] := 1/a*Int[x^(m - p), x] + Int[x^m*Sqrt[1 + 1/(a^2*x^(2*p))], x] /; FreeQ[{a, m, p}, x]
Int[x_^m_.*E^(n_.*ArcSech[u_]), x_Symbol] := Int[x^m*(1/u + Sqrt[(1 - u)/(1 + u)] + 1/u*Sqrt[(1 - u)/(1 + u)])^ n, x] /; FreeQ[m, x] && IntegerQ[n]
Int[x_^m_.*E^(n_.*ArcCsch[u_]), x_Symbol] := Int[x^m*(1/u + Sqrt[1 + 1/u^2])^n, x] /; FreeQ[m, x] && IntegerQ[n]
Int[E^(ArcSech[c_.*x_])/(a_ + b_.*x_^2), x_Symbol] := 1/(a*c)*Int[Sqrt[1/(1 + c*x)]/(x*Sqrt[1 - c*x]), x] + 1/c*Int[1/(x*(a + b*x^2)), x] /; FreeQ[{a, b, c}, x] && EqQ[b + a*c^2, 0]
Int[E^(ArcCsch[c_.*x_])/(a_ + b_.*x_^2), x_Symbol] := 1/(a*c^2)*Int[1/(x^2*Sqrt[1 + 1/(c^2*x^2)]), x] + 1/c*Int[1/(x*(a + b*x^2)), x] /; FreeQ[{a, b, c}, x] && EqQ[b - a*c^2, 0]
Int[(d_.*x_)^m_.*E^(ArcSech[c_.*x_])/(a_ + b_.*x_^2), x_Symbol] := d/(a*c)*Int[(d*x)^(m - 1)*Sqrt[1/(1 + c*x)]/Sqrt[1 - c*x], x] + d/c*Int[(d*x)^(m - 1)/(a + b*x^2), x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b + a*c^2, 0]
Int[(d_.*x_)^m_.*E^(ArcCsch[c_.*x_])/(a_ + b_.*x_^2), x_Symbol] := d^2/(a*c^2)*Int[(d*x)^(m - 2)/Sqrt[1 + 1/(c^2*x^2)], x] + d/c*Int[(d*x)^(m - 1)/(a + b*x^2), x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[b - a*c^2, 0]
Int[ArcSech[u_], x_Symbol] := x*ArcSech[u] + Sqrt[1 - u^2]/(u*Sqrt[-1 + 1/u]*Sqrt[1 + 1/u])* Int[SimplifyIntegrand[x*D[u, x]/(u*Sqrt[1 - u^2]), x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[ArcCsch[u_], x_Symbol] := x*ArcCsch[u] - u/Sqrt[-u^2]* Int[SimplifyIntegrand[x*D[u, x]/(u*Sqrt[-1 - u^2]), x], x] /; InverseFunctionFreeQ[u, x] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcSech[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcSech[u])/(d*(m + 1)) + b*Sqrt[1 - u^2]/(d*(m + 1)*u*Sqrt[-1 + 1/u]*Sqrt[1 + 1/u])* Int[SimplifyIntegrand[(c + d*x)^(m + 1)*D[u, x]/(u*Sqrt[1 - u^2]), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[(c_. + d_.*x_)^m_.*(a_. + b_.*ArcCsch[u_]), x_Symbol] := (c + d*x)^(m + 1)*(a + b*ArcCsch[u])/(d*(m + 1)) - b*u/(d*(m + 1)*Sqrt[-u^2])* Int[SimplifyIntegrand[(c + d*x)^(m + 1)* D[u, x]/(u*Sqrt[-1 - u^2]), x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1] && InverseFunctionFreeQ[u, x] && Not[FunctionOfQ[(c + d*x)^(m + 1), u, x]] && Not[FunctionOfExponentialQ[u, x]]
Int[v_*(a_. + b_.*ArcSech[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcSech[u]), w, x] + b*Sqrt[1 - u^2]/(u*Sqrt[-1 + 1/u]*Sqrt[1 + 1/u])* Int[SimplifyIntegrand[w*D[u, x]/(u*Sqrt[1 - u^2]), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]
Int[v_*(a_. + b_.*ArcCsch[u_]), x_Symbol] := With[{w = IntHide[v, x]}, Dist[(a + b*ArcCsch[u]), w, x] - b*u/Sqrt[-u^2]* Int[SimplifyIntegrand[w*D[u, x]/(u*Sqrt[-1 - u^2]), x], x] /; InverseFunctionFreeQ[w, x]] /; FreeQ[{a, b}, x] && InverseFunctionFreeQ[u, x] && Not[MatchQ[v, (c_. + d_.*x)^m_. /; FreeQ[{c, d, m}, x]]]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.1 Error functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.1 Error functions *)
Int[Erf[a_. + b_.*x_], x_Symbol] := (a + b*x)*Erf[a + b*x]/b + 1/(b*Sqrt[Pi]*E^(a + b*x)^2) /; FreeQ[{a, b}, x]
Int[Erfc[a_. + b_.*x_], x_Symbol] := (a + b*x)*Erfc[a + b*x]/b - 1/(b*Sqrt[Pi]*E^(a + b*x)^2) /; FreeQ[{a, b}, x]
Int[Erfi[a_. + b_.*x_], x_Symbol] := (a + b*x)*Erfi[a + b*x]/b - E^(a + b*x)^2/(b*Sqrt[Pi]) /; FreeQ[{a, b}, x]
Int[Erf[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*Erf[a + b*x]^2/b - 4/Sqrt[Pi]*Int[(a + b*x)*Erf[a + b*x]/E^(a + b*x)^2, x] /; FreeQ[{a, b}, x]
Int[Erfc[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*Erfc[a + b*x]^2/b + 4/Sqrt[Pi]*Int[(a + b*x)*Erfc[a + b*x]/E^(a + b*x)^2, x] /; FreeQ[{a, b}, x]
Int[Erfi[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*Erfi[a + b*x]^2/b - 4/Sqrt[Pi]*Int[(a + b*x)*E^(a + b*x)^2*Erfi[a + b*x], x] /; FreeQ[{a, b}, x]
Int[Erf[a_. + b_.*x_]^n_, x_Symbol] := Unintegrable[Erf[a + b*x]^n, x] /; FreeQ[{a, b, n}, x] && NeQ[n, 1] && NeQ[n, 2]
Int[Erfc[a_. + b_.*x_]^n_, x_Symbol] := Unintegrable[Erfc[a + b*x]^n, x] /; FreeQ[{a, b, n}, x] && NeQ[n, 1] && NeQ[n, 2]
Int[Erfi[a_. + b_.*x_]^n_, x_Symbol] := Unintegrable[Erfi[a + b*x]^n, x] /; FreeQ[{a, b, n}, x] && NeQ[n, 1] && NeQ[n, 2]
Int[Erf[b_.*x_]/x_, x_Symbol] := 2*b*x/Sqrt[Pi]* HypergeometricPFQ[{1/2, 1/2}, {3/2, 3/2}, -b^2*x^2] /; FreeQ[b, x]
Int[Erfc[b_.*x_]/x_, x_Symbol] := Log[x] - Int[Erf[b*x]/x, x] /; FreeQ[b, x]
Int[Erfi[b_.*x_]/x_, x_Symbol] := 2*b*x/Sqrt[Pi]*HypergeometricPFQ[{1/2, 1/2}, {3/2, 3/2}, b^2*x^2] /; FreeQ[b, x]
Int[(c_. + d_.*x_)^m_.*Erf[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*Erf[a + b*x]/(d*(m + 1)) - 2*b/(Sqrt[Pi]*d*(m + 1))* Int[(c + d*x)^(m + 1)/E^(a + b*x)^2, x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*Erfc[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*Erfc[a + b*x]/(d*(m + 1)) + 2*b/(Sqrt[Pi]*d*(m + 1))* Int[(c + d*x)^(m + 1)/E^(a + b*x)^2, x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*Erfi[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*Erfi[a + b*x]/(d*(m + 1)) - 2*b/(Sqrt[Pi]*d*(m + 1))* Int[(c + d*x)^(m + 1)*E^(a + b*x)^2, x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[x_^m_.*Erf[b_.*x_]^2, x_Symbol] := x^(m + 1)*Erf[b*x]^2/(m + 1) - 4*b/(Sqrt[Pi]*(m + 1))*Int[x^(m + 1)*E^(-b^2*x^2)*Erf[b*x], x] /; FreeQ[b, x] && (IGtQ[m, 0] || ILtQ[(m + 1)/2, 0])
Int[x_^m_.*Erfc[b_.*x_]^2, x_Symbol] := x^(m + 1)*Erfc[b*x]^2/(m + 1) + 4*b/(Sqrt[Pi]*(m + 1))*Int[x^(m + 1)*E^(-b^2*x^2)*Erfc[b*x], x] /; FreeQ[b, x] && (IGtQ[m, 0] || ILtQ[(m + 1)/2, 0])
Int[x_^m_.*Erfi[b_.*x_]^2, x_Symbol] := x^(m + 1)*Erfi[b*x]^2/(m + 1) - 4*b/(Sqrt[Pi]*(m + 1))*Int[x^(m + 1)*E^(b^2*x^2)*Erfi[b*x], x] /; FreeQ[b, x] && (IGtQ[m, 0] || ILtQ[(m + 1)/2, 0])
Int[(c_. + d_.*x_)^m_.*Erf[a_ + b_.*x_]^2, x_Symbol] := 1/b^(m + 1)* Subst[Int[ExpandIntegrand[Erf[x]^2, (b*c - a*d + d*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Erfc[a_ + b_.*x_]^2, x_Symbol] := 1/b^(m + 1)* Subst[Int[ExpandIntegrand[Erfc[x]^2, (b*c - a*d + d*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Erfi[a_ + b_.*x_]^2, x_Symbol] := 1/b^(m + 1)* Subst[Int[ExpandIntegrand[Erfi[x]^2, (b*c - a*d + d*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Erf[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(c + d*x)^m*Erf[a + b*x]^n, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(c_. + d_.*x_)^m_.*Erfc[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(c + d*x)^m*Erfc[a + b*x]^n, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(c_. + d_.*x_)^m_.*Erfi[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(c + d*x)^m*Erfi[a + b*x]^n, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[E^(c_. + d_.*x_^2)*Erf[b_.*x_]^n_., x_Symbol] := E^c*Sqrt[Pi]/(2*b)*Subst[Int[x^n, x], x, Erf[b*x]] /; FreeQ[{b, c, d, n}, x] && EqQ[d, -b^2]
Int[E^(c_. + d_.*x_^2)*Erfc[b_.*x_]^n_., x_Symbol] := -E^c*Sqrt[Pi]/(2*b)*Subst[Int[x^n, x], x, Erfc[b*x]] /; FreeQ[{b, c, d, n}, x] && EqQ[d, -b^2]
Int[E^(c_. + d_.*x_^2)*Erfi[b_.*x_]^n_., x_Symbol] := E^c*Sqrt[Pi]/(2*b)*Subst[Int[x^n, x], x, Erfi[b*x]] /; FreeQ[{b, c, d, n}, x] && EqQ[d, b^2]
Int[E^(c_. + d_.*x_^2)*Erf[b_.*x_], x_Symbol] := b*E^c*x^2/Sqrt[Pi]*HypergeometricPFQ[{1, 1}, {3/2, 2}, b^2*x^2] /; FreeQ[{b, c, d}, x] && EqQ[d, b^2]
Int[E^(c_. + d_.*x_^2)*Erfc[b_.*x_], x_Symbol] := Int[E^(c + d*x^2), x] - Int[E^(c + d*x^2)*Erf[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d, b^2]
Int[E^(c_. + d_.*x_^2)*Erfi[b_.*x_], x_Symbol] := b*E^c*x^2/Sqrt[Pi]*HypergeometricPFQ[{1, 1}, {3/2, 2}, -b^2*x^2] /; FreeQ[{b, c, d}, x] && EqQ[d, -b^2]
Int[E^(c_. + d_.*x_^2)*Erf[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[E^(c + d*x^2)*Erf[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[E^(c_. + d_.*x_^2)*Erfc[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[E^(c + d*x^2)*Erfc[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[E^(c_. + d_.*x_^2)*Erfi[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[E^(c + d*x^2)*Erfi[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[x_*E^(c_. + d_.*x_^2)*Erf[a_. + b_.*x_], x_Symbol] := E^(c + d*x^2)*Erf[a + b*x]/(2*d) - b/(d*Sqrt[Pi])*Int[E^(-a^2 + c - 2*a*b*x - (b^2 - d)*x^2), x] /; FreeQ[{a, b, c, d}, x]
Int[x_*E^(c_. + d_.*x_^2)*Erfc[a_. + b_.*x_], x_Symbol] := E^(c + d*x^2)*Erfc[a + b*x]/(2*d) + b/(d*Sqrt[Pi])*Int[E^(-a^2 + c - 2*a*b*x - (b^2 - d)*x^2), x] /; FreeQ[{a, b, c, d}, x]
Int[x_*E^(c_. + d_.*x_^2)*Erfi[a_. + b_.*x_], x_Symbol] := E^(c + d*x^2)*Erfi[a + b*x]/(2*d) - b/(d*Sqrt[Pi])*Int[E^(a^2 + c + 2*a*b*x + (b^2 + d)*x^2), x] /; FreeQ[{a, b, c, d}, x]
Int[x_^m_*E^(c_. + d_.*x_^2)*Erf[a_. + b_.*x_], x_Symbol] := x^(m - 1)*E^(c + d*x^2)*Erf[a + b*x]/(2*d) - b/(d*Sqrt[Pi])* Int[x^(m - 1)*E^(-a^2 + c - 2*a*b*x - (b^2 - d)*x^2), x] - (m - 1)/(2*d)*Int[x^(m - 2)*E^(c + d*x^2)*Erf[a + b*x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 1]
Int[x_^m_*E^(c_. + d_.*x_^2)*Erfc[a_. + b_.*x_], x_Symbol] := x^(m - 1)*E^(c + d*x^2)*Erfc[a + b*x]/(2*d) + b/(d*Sqrt[Pi])* Int[x^(m - 1)*E^(-a^2 + c - 2*a*b*x - (b^2 - d)*x^2), x] - (m - 1)/(2*d)*Int[x^(m - 2)*E^(c + d*x^2)*Erfc[a + b*x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 1]
Int[x_^m_*E^(c_. + d_.*x_^2)*Erfi[a_. + b_.*x_], x_Symbol] := x^(m - 1)*E^(c + d*x^2)*Erfi[a + b*x]/(2*d) - b/(d*Sqrt[Pi])* Int[x^(m - 1)*E^(a^2 + c + 2*a*b*x + (b^2 + d)*x^2), x] - (m - 1)/(2*d)*Int[x^(m - 2)*E^(c + d*x^2)*Erfi[a + b*x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 1]
Int[E^(c_. + d_.*x_^2)*Erf[b_.*x_]/x_, x_Symbol] := 2*b*E^c*x/Sqrt[Pi]* HypergeometricPFQ[{1/2, 1}, {3/2, 3/2}, b^2*x^2] /; FreeQ[{b, c, d}, x] && EqQ[d, b^2]
Int[E^(c_. + d_.*x_^2)*Erfc[b_.*x_]/x_, x_Symbol] := Int[E^(c + d*x^2)/x, x] - Int[E^(c + d*x^2)*Erf[b*x]/x, x] /; FreeQ[{b, c, d}, x] && EqQ[d, b^2]
Int[E^(c_. + d_.*x_^2)*Erfi[b_.*x_]/x_, x_Symbol] := 2*b*E^c*x/Sqrt[Pi]* HypergeometricPFQ[{1/2, 1}, {3/2, 3/2}, -b^2*x^2] /; FreeQ[{b, c, d}, x] && EqQ[d, -b^2]
Int[x_^m_*E^(c_. + d_.*x_^2)*Erf[a_. + b_.*x_], x_Symbol] := x^(m + 1)*E^(c + d*x^2)*Erf[a + b*x]/(m + 1) - 2*b/((m + 1)*Sqrt[Pi])* Int[x^(m + 1)*E^(-a^2 + c - 2*a*b*x - (b^2 - d)*x^2), x] - 2*d/(m + 1)*Int[x^(m + 2)*E^(c + d*x^2)*Erf[a + b*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[m, -1]
Int[x_^m_*E^(c_. + d_.*x_^2)*Erfc[a_. + b_.*x_], x_Symbol] := x^(m + 1)*E^(c + d*x^2)*Erfc[a + b*x]/(m + 1) + 2*b/((m + 1)*Sqrt[Pi])* Int[x^(m + 1)*E^(-a^2 + c - 2*a*b*x - (b^2 - d)*x^2), x] - 2*d/(m + 1)*Int[x^(m + 2)*E^(c + d*x^2)*Erfc[a + b*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[m, -1]
Int[x_^m_*E^(c_. + d_.*x_^2)*Erfi[a_. + b_.*x_], x_Symbol] := x^(m + 1)*E^(c + d*x^2)*Erfi[a + b*x]/(m + 1) - 2*b/((m + 1)*Sqrt[Pi])* Int[x^(m + 1)*E^(a^2 + c + 2*a*b*x + (b^2 + d)*x^2), x] - 2*d/(m + 1)*Int[x^(m + 2)*E^(c + d*x^2)*Erfi[a + b*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[m, -1]
Int[(e_.*x_)^m_.*E^(c_. + d_.*x_^2)*Erf[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*E^(c + d*x^2)*Erf[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*E^(c_. + d_.*x_^2)*Erfc[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*E^(c + d*x^2)*Erfc[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*E^(c_. + d_.*x_^2)*Erfi[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*E^(c + d*x^2)*Erfi[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[Erf[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*Erf[d*(a + b*Log[c*x^n])] - 2*b*d*n/(Sqrt[Pi])*Int[1/E^(d*(a + b*Log[c*x^n]))^2, x] /; FreeQ[{a, b, c, d, n}, x]
Int[Erfc[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*Erfc[d*(a + b*Log[c*x^n])] + 2*b*d*n/(Sqrt[Pi])*Int[1/E^(d*(a + b*Log[c*x^n]))^2, x] /; FreeQ[{a, b, c, d, n}, x]
Int[Erfi[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*Erfi[d*(a + b*Log[c*x^n])] - 2*b*d*n/(Sqrt[Pi])*Int[E^(d*(a + b*Log[c*x^n]))^2, x] /; FreeQ[{a, b, c, d, n}, x]
Int[F_[d_.*(a_. + b_.*Log[c_.*x_^n_.])]/x_, x_Symbol] := 1/n*Subst[F[d*(a + b*x)], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, n}, x] && MemberQ[{Erf, Erfc, Erfi}, F]
Int[(e_.*x_)^m_.*Erf[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*Erf[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - 2*b*d*n/(Sqrt[Pi]*(m + 1))* Int[(e*x)^m/E^(d*(a + b*Log[c*x^n]))^2, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(e_.*x_)^m_.*Erfc[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*Erfc[d*(a + b*Log[c*x^n])]/(e*(m + 1)) + 2*b*d*n/(Sqrt[Pi]*(m + 1))* Int[(e*x)^m/E^(d*(a + b*Log[c*x^n]))^2, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(e_.*x_)^m_.*Erfi[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*Erfi[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - 2*b*d*n/(Sqrt[Pi]*(m + 1))* Int[(e*x)^m*E^(d*(a + b*Log[c*x^n]))^2, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[Sin[c_. + d_.*x_^2]*Erf[b_.*x_], x_Symbol] := I/2*Int[E^(-I*c - I*d*x^2)*Erf[b*x], x] - I/2*Int[E^(I*c + I*d*x^2)*Erf[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -b^4]
Int[Sin[c_. + d_.*x_^2]*Erfc[b_.*x_], x_Symbol] := I/2*Int[E^(-I*c - I*d*x^2)*Erfc[b*x], x] - I/2*Int[E^(I*c + I*d*x^2)*Erfc[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -b^4]
Int[Sin[c_. + d_.*x_^2]*Erfi[b_.*x_], x_Symbol] := I/2*Int[E^(-I*c - I*d*x^2)*Erfi[b*x], x] - I/2*Int[E^(I*c + I*d*x^2)*Erfi[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -b^4]
Int[Cos[c_. + d_.*x_^2]*Erf[b_.*x_], x_Symbol] := 1/2*Int[E^(-I*c - I*d*x^2)*Erf[b*x], x] + 1/2*Int[E^(I*c + I*d*x^2)*Erf[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -b^4]
Int[Cos[c_. + d_.*x_^2]*Erfc[b_.*x_], x_Symbol] := 1/2*Int[E^(-I*c - I*d*x^2)*Erfc[b*x], x] + 1/2*Int[E^(I*c + I*d*x^2)*Erfc[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -b^4]
Int[Cos[c_. + d_.*x_^2]*Erfi[b_.*x_], x_Symbol] := 1/2*Int[E^(-I*c - I*d*x^2)*Erfi[b*x], x] + 1/2*Int[E^(I*c + I*d*x^2)*Erfi[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -b^4]
Int[Sinh[c_. + d_.*x_^2]*Erf[b_.*x_], x_Symbol] := 1/2*Int[E^(c + d*x^2)*Erf[b*x], x] - 1/2*Int[E^(-c - d*x^2)*Erf[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, b^4]
Int[Sinh[c_. + d_.*x_^2]*Erfc[b_.*x_], x_Symbol] := 1/2*Int[E^(c + d*x^2)*Erfc[b*x], x] - 1/2*Int[E^(-c - d*x^2)*Erfc[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, b^4]
Int[Sinh[c_. + d_.*x_^2]*Erfi[b_.*x_], x_Symbol] := 1/2*Int[E^(c + d*x^2)*Erfi[b*x], x] - 1/2*Int[E^(-c - d*x^2)*Erfi[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, b^4]
Int[Cosh[c_. + d_.*x_^2]*Erf[b_.*x_], x_Symbol] := 1/2*Int[E^(c + d*x^2)*Erf[b*x], x] + 1/2*Int[E^(-c - d*x^2)*Erf[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, b^4]
Int[Cosh[c_. + d_.*x_^2]*Erfc[b_.*x_], x_Symbol] := 1/2*Int[E^(c + d*x^2)*Erfc[b*x], x] + 1/2*Int[E^(-c - d*x^2)*Erfc[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, b^4]
Int[Cosh[c_. + d_.*x_^2]*Erfi[b_.*x_], x_Symbol] := 1/2*Int[E^(c + d*x^2)*Erfi[b*x], x] + 1/2*Int[E^(-c - d*x^2)*Erfi[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, b^4]
Int[F_[f_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])], x_Symbol] := 1/e*Subst[Int[F[f*(a + b*Log[c*x^n])], x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, n}, x] && MemberQ[{Erf, Erfc, Erfi, FresnelS, FresnelC, ExpIntegralEi, SinIntegral, CosIntegral, SinhIntegral, CoshIntegral}, F]
Int[(g_ + h_. x_)^m_.*F_[f_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])], x_Symbol] := 1/e*Subst[Int[(g*x/d)^m*F[f*(a + b*Log[c*x^n])], x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, m, n}, x] && EqQ[e*f - d*g, 0] && MemberQ[{Erf, Erfc, Erfi, FresnelS, FresnelC, ExpIntegralEi, SinIntegral, CosIntegral, SinhIntegral, CoshIntegral}, F]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.10 Bessel functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.10 Bessel functions *)
Int[BesselJ[1, a_. + b_.*x_], x_Symbol] := -BesselJ[0, a + b*x]/b /; FreeQ[{a, b}, x]
Int[BesselJ[n_, a_. + b_.*x_], x_Symbol] := -2*BesselJ[n - 1, a + b*x]/b + Int[BesselJ[n - 2, a + b*x], x] /; FreeQ[{a, b}, x] && IGtQ[(n - 1)/2, 0]
(* Int[BesselJ[n_,a_.+b_.*x_],x_Symbol] := (-1)^n*Int[BesselJ[-n,a+b*x],x] /; FreeQ[{a,b},x] && ILtQ[n,0] *)
Int[BesselJ[n_, a_. + b_.*x_], x_Symbol] := (a + b*x)^(n + 1)* HypergeometricPFQ[{(n + 1)/2}, {(n + 3)/2, n + 1}, -1/4*(a + b*x)^2]/(2^n*b*Gamma[n + 2]) /; FreeQ[{a, b, n}, x]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.2 Fresnel integral functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.2 Fresnel integral functions *)
Int[FresnelS[a_. + b_.*x_], x_Symbol] := (a + b*x)*FresnelS[a + b*x]/b + Cos[Pi/2*(a + b*x)^2]/(b*Pi) /; FreeQ[{a, b}, x]
Int[FresnelC[a_. + b_.*x_], x_Symbol] := (a + b*x)*FresnelC[a + b*x]/b - Sin[Pi/2*(a + b*x)^2]/(b*Pi) /; FreeQ[{a, b}, x]
Int[FresnelS[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*FresnelS[a + b*x]^2/b - 2*Int[(a + b*x)*Sin[Pi/2*(a + b*x)^2]*FresnelS[a + b*x], x] /; FreeQ[{a, b}, x]
Int[FresnelC[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*FresnelC[a + b*x]^2/b - 2*Int[(a + b*x)*Cos[Pi/2*(a + b*x)^2]*FresnelC[a + b*x], x] /; FreeQ[{a, b}, x]
Int[FresnelS[a_. + b_.*x_]^n_, x_Symbol] := Unintegrable[FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, n}, x] && NeQ[n, 1] && NeQ[n, 2]
Int[FresnelC[a_. + b_.*x_]^n_, x_Symbol] := Unintegrable[FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, n}, x] && NeQ[n, 1] && NeQ[n, 2]
Int[FresnelS[b_.*x_]/x_, x_Symbol] := (1 + I)/4*Int[Erf[Sqrt[Pi]/2*(1 + I)*b*x]/x, x] + (1 - I)/4* Int[Erf[Sqrt[Pi]/2*(1 - I)*b*x]/x, x] /; FreeQ[b, x]
Int[FresnelC[b_.*x_]/x_, x_Symbol] := (1 - I)/4*Int[Erf[Sqrt[Pi]/2*(1 + I)*b*x]/x, x] + (1 + I)/4* Int[Erf[Sqrt[Pi]/2*(1 - I)*b*x]/x, x] /; FreeQ[b, x]
Int[(d_.*x_)^m_.*FresnelS[b_.*x_], x_Symbol] := (d*x)^(m + 1)*FresnelS[b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(d*x)^(m + 1)*Sin[Pi/2*b^2*x^2], x] /; FreeQ[{b, d, m}, x] && NeQ[m, -1]
Int[(d_.*x_)^m_.*FresnelC[b_.*x_], x_Symbol] := (d*x)^(m + 1)*FresnelC[b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(d*x)^(m + 1)*Cos[Pi/2*b^2*x^2], x] /; FreeQ[{b, d, m}, x] && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*FresnelS[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*FresnelS[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Sin[Pi/2*(a + b*x)^2], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*FresnelC[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*FresnelC[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Cos[Pi/2*(a + b*x)^2], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[x_^m_.*FresnelS[b_.*x_]^2, x_Symbol] := x^(m + 1)*FresnelS[b*x]^2/(m + 1) - 2*b/(m + 1)*Int[x^(m + 1)*Sin[Pi/2*b^2*x^2]*FresnelS[b*x], x] /; FreeQ[b, x] && IntegerQ[m] && NeQ[m, -1]
Int[x_^m_.*FresnelC[b_.*x_]^2, x_Symbol] := x^(m + 1)*FresnelC[b*x]^2/(m + 1) - 2*b/(m + 1)*Int[x^(m + 1)*Cos[Pi/2*b^2*x^2]*FresnelC[b*x], x] /; FreeQ[b, x] && IntegerQ[m] && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*FresnelS[a_ + b_.*x_]^2, x_Symbol] := 1/b^(m + 1)* Subst[Int[ExpandIntegrand[FresnelS[x]^2, (b*c - a*d + d*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*FresnelC[a_ + b_.*x_]^2, x_Symbol] := 1/b^(m + 1)* Subst[Int[ExpandIntegrand[FresnelC[x]^2, (b*c - a*d + d*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*FresnelS[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(c + d*x)^m*FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[(c_. + d_.*x_)^m_.*FresnelC[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(c + d*x)^m*FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[E^(c_. + d_.*x_^2)*FresnelS[b_.*x_], x_Symbol] := (1 + I)/4* Int[E^(c + d*x^2)*Erf[Sqrt[Pi]/2*(1 + I)*b*x], x] + (1 - I)/4* Int[E^(c + d*x^2)*Erf[Sqrt[Pi]/2*(1 - I)*b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -Pi^2/4*b^4]
Int[E^(c_. + d_.*x_^2)*FresnelC[b_.*x_], x_Symbol] := (1 - I)/4* Int[E^(c + d*x^2)*Erf[Sqrt[Pi]/2*(1 + I)*b*x], x] + (1 + I)/4* Int[E^(c + d*x^2)*Erf[Sqrt[Pi]/2*(1 - I)*b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, -Pi^2/4*b^4]
Int[E^(c_. + d_.*x_^2)*FresnelS[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[E^(c + d*x^2)*FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[E^(c_. + d_.*x_^2)*FresnelC[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[E^(c + d*x^2)*FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[Sin[d_.*x_^2]*FresnelS[b_.*x_]^n_., x_Symbol] := Pi*b/(2*d)*Subst[Int[x^n, x], x, FresnelS[b*x]] /; FreeQ[{b, d, n}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Cos[d_.*x_^2]*FresnelC[b_.*x_]^n_., x_Symbol] := Pi*b/(2*d)*Subst[Int[x^n, x], x, FresnelC[b*x]] /; FreeQ[{b, d, n}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Sin[c_ + d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := Sin[c]*Int[Cos[d*x^2]*FresnelS[b*x], x] + Cos[c]*Int[Sin[d*x^2]*FresnelS[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Cos[c_ + d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := Cos[c]*Int[Cos[d*x^2]*FresnelC[b*x], x] - Sin[c]*Int[Sin[d*x^2]*FresnelC[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Sin[c_. + d_.*x_^2]*FresnelS[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[Sin[c + d*x^2]*FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[Cos[c_. + d_.*x_^2]*FresnelC[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[Cos[c + d*x^2]*FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[Cos[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := FresnelC[b*x]*FresnelS[b*x]/(2*b) - 1/8*I*b*x^2* HypergeometricPFQ[{1, 1}, {3/2, 2}, -1/2*I*b^2*Pi*x^2] + 1/8*I*b*x^2* HypergeometricPFQ[{1, 1}, {3/2, 2}, 1/2*I*b^2*Pi*x^2] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Sin[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := b*Pi*FresnelC[b*x]*FresnelS[b*x]/(4*d) + 1/8*I*b*x^2*HypergeometricPFQ[{1, 1}, {3/2, 2}, -I*d*x^2] - 1/8*I*b*x^2*HypergeometricPFQ[{1, 1}, {3/2, 2}, I*d*x^2] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Cos[c_ + d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := Cos[c]*Int[Cos[d*x^2]*FresnelS[b*x], x] - Sin[c]*Int[Sin[d*x^2]*FresnelS[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Sin[c_ + d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := Sin[c]*Int[Cos[d*x^2]*FresnelC[b*x], x] + Cos[c]*Int[Sin[d*x^2]*FresnelC[b*x], x] /; FreeQ[{b, c, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[Cos[c_. + d_.*x_^2]*FresnelS[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[Cos[c + d*x^2]*FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[Sin[c_. + d_.*x_^2]*FresnelC[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[Sin[c + d*x^2]*FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x]
Int[x_*Sin[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := -Cos[d*x^2]*FresnelS[b*x]/(2*d) + 1/(2*b*Pi)*Int[Sin[2*d*x^2], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[x_*Cos[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := Sin[d*x^2]*FresnelC[b*x]/(2*d) - b/(4*d)*Int[Sin[2*d*x^2], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[x_^m_*Sin[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := -x^(m - 1)*Cos[d*x^2]*FresnelS[b*x]/(2*d) + 1/(2*b*Pi)*Int[x^(m - 1)*Sin[2*d*x^2], x] + (m - 1)/(2*d)*Int[x^(m - 2)*Cos[d*x^2]*FresnelS[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && IGtQ[m, 1]
Int[x_^m_*Cos[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := x^(m - 1)*Sin[d*x^2]*FresnelC[b*x]/(2*d) - b/(4*d)*Int[x^(m - 1)*Sin[2*d*x^2], x] - (m - 1)/(2*d)*Int[x^(m - 2)*Sin[d*x^2]*FresnelC[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && IGtQ[m, 1]
Int[x_^m_*Sin[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := x^(m + 1)*Sin[d*x^2]*FresnelS[b*x]/(m + 1) - d*x^(m + 2)/(Pi*b*(m + 1)*(m + 2)) + d/(Pi*b*(m + 1))*Int[x^(m + 1)*Cos[2*d*x^2], x] - 2*d/(m + 1)*Int[x^(m + 2)*Cos[d*x^2]*FresnelS[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && ILtQ[m, -2]
Int[x_^m_*Cos[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := x^(m + 1)*Cos[d*x^2]*FresnelC[b*x]/(m + 1) - b*x^(m + 2)/(2*(m + 1)*(m + 2)) - b/(2*(m + 1))*Int[x^(m + 1)*Cos[2*d*x^2], x] + 2*d/(m + 1)*Int[x^(m + 2)*Sin[d*x^2]*FresnelC[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && ILtQ[m, -2]
Int[(e_.*x_)^m_.*Sin[c_. + d_.*x_^2]*FresnelS[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*Sin[c + d*x^2]*FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*Cos[c_. + d_.*x_^2]*FresnelC[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*Cos[c + d*x^2]*FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[x_*Cos[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := Sin[d*x^2]*FresnelS[b*x]/(2*d) - 1/(Pi*b)*Int[Sin[d*x^2]^2, x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[x_*Sin[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := -Cos[d*x^2]*FresnelC[b*x]/(2*d) + b/(2*d)*Int[Cos[d*x^2]^2, x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4]
Int[x_^m_*Cos[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := x^(m - 1)*Sin[d*x^2]*FresnelS[b*x]/(2*d) - 1/(Pi*b)*Int[x^(m - 1)*Sin[d*x^2]^2, x] - (m - 1)/(2*d)*Int[x^(m - 2)*Sin[d*x^2]*FresnelS[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && IGtQ[m, 1]
Int[x_^m_*Sin[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := -x^(m - 1)*Cos[d*x^2]*FresnelC[b*x]/(2*d) + b/(2*d)*Int[x^(m - 1)*Cos[d*x^2]^2, x] + (m - 1)/(2*d)*Int[x^(m - 2)*Cos[d*x^2]*FresnelC[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && IGtQ[m, 1]
Int[x_^m_*Cos[d_.*x_^2]*FresnelS[b_.*x_], x_Symbol] := x^(m + 1)*Cos[d*x^2]*FresnelS[b*x]/(m + 1) - d/(Pi*b*(m + 1))*Int[x^(m + 1)*Sin[2*d*x^2], x] + 2*d/(m + 1)*Int[x^(m + 2)*Sin[d*x^2]*FresnelS[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && ILtQ[m, -1]
Int[x_^m_*Sin[d_.*x_^2]*FresnelC[b_.*x_], x_Symbol] := x^(m + 1)*Sin[d*x^2]*FresnelC[b*x]/(m + 1) - b/(2*(m + 1))*Int[x^(m + 1)*Sin[2*d*x^2], x] - 2*d/(m + 1)*Int[x^(m + 2)*Cos[d*x^2]*FresnelC[b*x], x] /; FreeQ[{b, d}, x] && EqQ[d^2, Pi^2/4*b^4] && ILtQ[m, -1]
Int[(e_.*x_)^m_.*Cos[c_. + d_.*x_^2]*FresnelS[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*Cos[c + d*x^2]*FresnelS[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(e_.*x_)^m_.*Sin[c_. + d_.*x_^2]*FresnelC[a_. + b_.*x_]^n_., x_Symbol] := Unintegrable[(e*x)^m*Sin[c + d*x^2]*FresnelC[a + b*x]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[FresnelS[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*FresnelS[d*(a + b*Log[c*x^n])] - b*d*n*Int[Sin[Pi/2*(d*(a + b*Log[c*x^n]))^2], x] /; FreeQ[{a, b, c, d, n}, x]
Int[FresnelC[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*FresnelC[d*(a + b*Log[c*x^n])] - b*d*n*Int[Cos[Pi/2*(d*(a + b*Log[c*x^n]))^2], x] /; FreeQ[{a, b, c, d, n}, x]
Int[F_[d_.*(a_. + b_.*Log[c_.*x_^n_.])]/x_, x_Symbol] := 1/n*Subst[F[d*(a + b*x)], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, n}, x] && MemberQ[{FresnelS, FresnelC}, F]
Int[(e_.*x_)^m_.*FresnelS[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*FresnelS[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*d*n/(m + 1)* Int[(e*x)^m*Sin[Pi/2*(d*(a + b*Log[c*x^n]))^2], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(e_.*x_)^m_.*FresnelC[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*FresnelC[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*d*n/(m + 1)* Int[(e*x)^m*Cos[Pi/2*(d*(a + b*Log[c*x^n]))^2], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.3 Exponential integral functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.3 Exponential integral functions *)
Int[ExpIntegralE[n_, a_. + b_.*x_], x_Symbol] := -ExpIntegralE[n + 1, a + b*x]/b /; FreeQ[{a, b, n}, x]
Int[x_^m_.*ExpIntegralE[n_, b_.*x_], x_Symbol] := -x^m*ExpIntegralE[n + 1, b*x]/b + m/b*Int[x^(m - 1)*ExpIntegralE[n + 1, b*x], x] /; FreeQ[b, x] && EqQ[m + n, 0] && IGtQ[m, 0]
Int[ExpIntegralE[1, b_.*x_]/x_, x_Symbol] := b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, -b*x] - EulerGamma*Log[x] - 1/2*Log[b*x]^2 /; FreeQ[b, x]
Int[x_^m_*ExpIntegralE[n_, b_.*x_], x_Symbol] := x^(m + 1)*ExpIntegralE[n, b*x]/(m + 1) + b/(m + 1)*Int[x^(m + 1)*ExpIntegralE[n - 1, b*x], x] /; FreeQ[b, x] && EqQ[m + n, 0] && ILtQ[m, -1]
Int[(d_.*x_)^m_*ExpIntegralE[n_, b_.*x_], x_Symbol] := (d*x)^m*Gamma[m + 1]*Log[x]/(b*(b*x)^m) - (d*x)^(m + 1)* HypergeometricPFQ[{m + 1, m + 1}, {m + 2, m + 2}, -b* x]/(d*(m + 1)^2) /; FreeQ[{b, d, m, n}, x] && EqQ[m + n, 0] && Not[IntegerQ[m]]
Int[(d_.*x_)^m_.*ExpIntegralE[n_, b_.*x_], x_Symbol] := (d*x)^(m + 1)*ExpIntegralE[n, b*x]/(d*(m + n)) - (d*x)^(m + 1)* ExpIntegralE[-m, b*x]/(d*(m + n)) /; FreeQ[{b, d, m, n}, x] && NeQ[m + n, 0]
Int[(c_. + d_.*x_)^m_.*ExpIntegralE[n_, a_ + b_.*x_], x_Symbol] := -(c + d*x)^m*ExpIntegralE[n + 1, a + b*x]/b + d*m/b*Int[(c + d*x)^(m - 1)*ExpIntegralE[n + 1, a + b*x], x] /; FreeQ[{a, b, c, d, m, n}, x] && (IGtQ[m, 0] || ILtQ[n, 0] || GtQ[m, 0] && LtQ[n, -1])
Int[(c_. + d_.*x_)^m_.*ExpIntegralE[n_, a_ + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*ExpIntegralE[n, a + b*x]/(d*(m + 1)) + b/(d*(m + 1))* Int[(c + d*x)^(m + 1)*ExpIntegralE[n - 1, a + b*x], x] /; FreeQ[{a, b, c, d, m, n}, x] && (IGtQ[n, 0] || LtQ[m, -1] && GtQ[n, 0]) && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*ExpIntegralE[n_, a_ + b_.*x_], x_Symbol] := Unintegrable[(c + d*x)^m*ExpIntegralE[n, a + b*x], x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[ExpIntegralEi[a_. + b_.*x_], x_Symbol] := (a + b*x)*ExpIntegralEi[a + b*x]/b - E^(a + b*x)/b /; FreeQ[{a, b}, x]
Int[ExpIntegralEi[b_.*x_]/x_, x_Symbol] := Log[x]*(ExpIntegralEi[b*x] + ExpIntegralE[1, -b*x]) - Int[ExpIntegralE[1, -b*x]/x, x] /; FreeQ[b, x]
Int[ExpIntegralEi[a_. + b_.*x_]/(c_. + d_.*x_), x_Symbol] := Unintegrable[ExpIntegralEi[a + b*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[(c_. + d_.*x_)^m_.*ExpIntegralEi[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*ExpIntegralEi[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*E^(a + b*x)/(a + b*x), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[ExpIntegralEi[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*ExpIntegralEi[a + b*x]^2/b - 2*Int[E^(a + b*x)*ExpIntegralEi[a + b*x], x] /; FreeQ[{a, b}, x]
Int[x_^m_.*ExpIntegralEi[b_.*x_]^2, x_Symbol] := x^(m + 1)*ExpIntegralEi[b*x]^2/(m + 1) - 2/(m + 1)*Int[x^m*E^(b*x)*ExpIntegralEi[b*x], x] /; FreeQ[b, x] && IGtQ[m, 0]
Int[x_^m_.*ExpIntegralEi[a_ + b_.*x_]^2, x_Symbol] := x^(m + 1)*ExpIntegralEi[a + b*x]^2/(m + 1) + a*x^m*ExpIntegralEi[a + b*x]^2/(b*(m + 1)) - 2/(m + 1)*Int[x^m*E^(a + b*x)*ExpIntegralEi[a + b*x], x] - a*m/(b*(m + 1))*Int[x^(m - 1)*ExpIntegralEi[a + b*x]^2, x] /; FreeQ[{a, b}, x] && IGtQ[m, 0]
(* Int[x_^m_.*ExpIntegralEi[a_+b_.*x_]^2,x_Symbol] := b*x^(m+2)*ExpIntegralEi[a+b*x]^2/(a*(m+1)) + x^(m+1)*ExpIntegralEi[a+b*x]^2/(m+1) - 2*b/(a*(m+1))*Int[x^(m+1)*E^(a+b*x)*ExpIntegralEi[a+b*x],x] - b*(m+2)/(a*(m+1))*Int[x^(m+1)*ExpIntegralEi[a+b*x]^2,x] /; FreeQ[{a,b},x] && ILtQ[m,-2] *)
Int[E^(a_. + b_.*x_)*ExpIntegralEi[c_. + d_.*x_], x_Symbol] := E^(a + b*x)*ExpIntegralEi[c + d*x]/b - d/b*Int[E^(a + c + (b + d)*x)/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[x_^m_.*E^(a_. + b_.*x_)*ExpIntegralEi[c_. + d_.*x_], x_Symbol] := x^m*E^(a + b*x)*ExpIntegralEi[c + d*x]/b - d/b*Int[x^m*E^(a + c + (b + d)*x)/(c + d*x), x] - m/b*Int[x^(m - 1)*E^(a + b*x)*ExpIntegralEi[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[x_^m_*E^(a_. + b_.*x_)*ExpIntegralEi[c_. + d_.*x_], x_Symbol] := x^(m + 1)*E^(a + b*x)*ExpIntegralEi[c + d*x]/(m + 1) - d/(m + 1)*Int[x^(m + 1)*E^(a + c + (b + d)*x)/(c + d*x), x] - b/(m + 1)*Int[x^(m + 1)*E^(a + b*x)*ExpIntegralEi[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[m, -1]
Int[ExpIntegralEi[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*ExpIntegralEi[d*(a + b*Log[c*x^n])] - b*n*E^(a*d)*Int[(c*x^n)^(b*d)/(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, n}, x]
Int[ExpIntegralEi[d_.*(a_. + b_.*Log[c_.*x_^n_.])]/x_, x_Symbol] := 1/n*Subst[ExpIntegralEi[d*(a + b*x)], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, n}, x]
Int[(e_.*x_)^m_.*ExpIntegralEi[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*ExpIntegralEi[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*n*E^(a*d)*(c*x^n)^(b*d)/((m + 1)*(e*x)^(b*d*n))* Int[(e*x)^(m + b*d*n)/(a + b*Log[c*x^n]), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[LogIntegral[a_. + b_.*x_], x_Symbol] := (a + b*x)*LogIntegral[a + b*x]/b - ExpIntegralEi[2*Log[a + b*x]]/b /; FreeQ[{a, b}, x]
Int[LogIntegral[b_.*x_]/x_, x_Symbol] := -b*x + Log[b*x]*LogIntegral[b*x] /; FreeQ[b, x]
Int[LogIntegral[a_. + b_.*x_]/(c_. + d_.*x_), x_Symbol] := Unintegrable[LogIntegral[a + b*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[(c_. + d_.*x_)^m_.*LogIntegral[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*LogIntegral[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)/Log[a + b*x], x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.4 Trig integral functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.4 Trig integral functions *)
Int[SinIntegral[a_. + b_.*x_], x_Symbol] := (a + b*x)*SinIntegral[a + b*x]/b + Cos[a + b*x]/b /; FreeQ[{a, b}, x]
Int[CosIntegral[a_. + b_.*x_], x_Symbol] := (a + b*x)*CosIntegral[a + b*x]/b - Sin[a + b*x]/b /; FreeQ[{a, b}, x]
Int[SinIntegral[b_.*x_]/x_, x_Symbol] := 1/2*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, -I*b*x] + 1/2*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, I*b*x] /; FreeQ[b, x]
Int[CosIntegral[b_.*x_]/x_, x_Symbol] := -1/2*I*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, -I*b*x] + 1/2*I*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, I*b*x] + EulerGamma*Log[x] + 1/2*Log[b*x]^2 /; FreeQ[b, x]
Int[(c_. + d_.*x_)^m_.*SinIntegral[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*SinIntegral[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Sin[a + b*x]/(a + b*x), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*CosIntegral[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*CosIntegral[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Cos[a + b*x]/(a + b*x), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[SinIntegral[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*SinIntegral[a + b*x]^2/b - 2*Int[Sin[a + b*x]*SinIntegral[a + b*x], x] /; FreeQ[{a, b}, x]
Int[CosIntegral[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*CosIntegral[a + b*x]^2/b - 2*Int[Cos[a + b*x]*CosIntegral[a + b*x], x] /; FreeQ[{a, b}, x]
Int[x_^m_.*SinIntegral[b_.*x_]^2, x_Symbol] := x^(m + 1)*SinIntegral[b*x]^2/(m + 1) - 2/(m + 1)*Int[x^m*Sin[b*x]*SinIntegral[b*x], x] /; FreeQ[b, x] && IGtQ[m, 0]
Int[x_^m_.*CosIntegral[b_.*x_]^2, x_Symbol] := x^(m + 1)*CosIntegral[b*x]^2/(m + 1) - 2/(m + 1)*Int[x^m*Cos[b*x]*CosIntegral[b*x], x] /; FreeQ[b, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*SinIntegral[a_ + b_.*x_]^2, x_Symbol] := (a + b*x)*(c + d*x)^m*SinIntegral[a + b*x]^2/(b*(m + 1)) - 2/(m + 1)*Int[(c + d*x)^m*Sin[a + b*x]*SinIntegral[a + b*x], x] + (b*c - a*d)*m/(b*(m + 1))* Int[(c + d*x)^(m - 1)*SinIntegral[a + b*x]^2, x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*CosIntegral[a_ + b_.*x_]^2, x_Symbol] := (a + b*x)*(c + d*x)^m*CosIntegral[a + b*x]^2/(b*(m + 1)) - 2/(m + 1)*Int[(c + d*x)^m*Cos[a + b*x]*CosIntegral[a + b*x], x] + (b*c - a*d)*m/(b*(m + 1))* Int[(c + d*x)^(m - 1)*CosIntegral[a + b*x]^2, x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
(* Int[x_^m_.*SinIntegral[a_+b_.*x_]^2,x_Symbol] := b*x^(m+2)*SinIntegral[a+b*x]^2/(a*(m+1)) + x^(m+1)*SinIntegral[a+b*x]^2/(m+1) - 2*b/(a*(m+1))*Int[x^(m+1)*Sin[a+b*x]*SinIntegral[a+b*x],x] - b*(m+2)/(a*(m+1))*Int[x^(m+1)*SinIntegral[a+b*x]^2,x] /; FreeQ[{a,b},x] && ILtQ[m,-2] *)
(* Int[x_^m_.*CosIntegral[a_+b_.*x_]^2,x_Symbol] := b*x^(m+2)*CosIntegral[a+b*x]^2/(a*(m+1)) + x^(m+1)*CosIntegral[a+b*x]^2/(m+1) - 2*b/(a*(m+1))*Int[x^(m+1)*Cos[a+b*x]*CosIntegral[a+b*x],x] - b*(m+2)/(a*(m+1))*Int[x^(m+1)*CosIntegral[a+b*x]^2,x] /; FreeQ[{a,b},x] && ILtQ[m,-2] *)
Int[Sin[a_. + b_.*x_]*SinIntegral[c_. + d_.*x_], x_Symbol] := -Cos[a + b*x]*SinIntegral[c + d*x]/b + d/b*Int[Cos[a + b*x]*Sin[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[Cos[a_. + b_.*x_]*CosIntegral[c_. + d_.*x_], x_Symbol] := Sin[a + b*x]*CosIntegral[c + d*x]/b - d/b*Int[Sin[a + b*x]*Cos[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[(e_. + f_.*x_)^m_.*Sin[a_. + b_.*x_]*SinIntegral[c_. + d_.*x_], x_Symbol] := -(e + f*x)^m*Cos[a + b*x]*SinIntegral[c + d*x]/b + d/b*Int[(e + f*x)^m*Cos[a + b*x]*Sin[c + d*x]/(c + d*x), x] + f*m/b* Int[(e + f*x)^(m - 1)*Cos[a + b*x]*SinIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*Cos[a_. + b_.*x_]*CosIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^m*Sin[a + b*x]*CosIntegral[c + d*x]/b - d/b*Int[(e + f*x)^m*Sin[a + b*x]*Cos[c + d*x]/(c + d*x), x] - f*m/b* Int[(e + f*x)^(m - 1)*Sin[a + b*x]*CosIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_*Sin[a_. + b_.*x_]*SinIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Sin[a + b*x]*SinIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sin[a + b*x]*Sin[c + d*x]/(c + d*x), x] - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cos[a + b*x]*SinIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_.*Cos[a_. + b_.*x_]*CosIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Cos[a + b*x]*CosIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cos[a + b*x]*Cos[c + d*x]/(c + d*x), x] + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sin[a + b*x]*CosIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[Cos[a_. + b_.*x_]*SinIntegral[c_. + d_.*x_], x_Symbol] := Sin[a + b*x]*SinIntegral[c + d*x]/b - d/b*Int[Sin[a + b*x]*Sin[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[Sin[a_. + b_.*x_]*CosIntegral[c_. + d_.*x_], x_Symbol] := -Cos[a + b*x]*CosIntegral[c + d*x]/b + d/b*Int[Cos[a + b*x]*Cos[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[(e_. + f_.*x_)^m_.*Cos[a_. + b_.*x_]*SinIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^m*Sin[a + b*x]*SinIntegral[c + d*x]/b - d/b*Int[(e + f*x)^m*Sin[a + b*x]*Sin[c + d*x]/(c + d*x), x] - f*m/b* Int[(e + f*x)^(m - 1)*Sin[a + b*x]*SinIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*Sin[a_. + b_.*x_]*CosIntegral[c_. + d_.*x_], x_Symbol] := -(e + f*x)^m*Cos[a + b*x]*CosIntegral[c + d*x]/b + d/b*Int[(e + f*x)^m*Cos[a + b*x]*Cos[c + d*x]/(c + d*x), x] + f*m/b* Int[(e + f*x)^(m - 1)*Cos[a + b*x]*CosIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*Cos[a_. + b_.*x_]*SinIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Cos[a + b*x]*SinIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cos[a + b*x]*Sin[c + d*x]/(c + d*x), x] + b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sin[a + b*x]*SinIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_*Sin[a_. + b_.*x_]*CosIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Sin[a + b*x]*CosIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sin[a + b*x]*Cos[c + d*x]/(c + d*x), x] - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cos[a + b*x]*CosIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[SinIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*SinIntegral[d*(a + b*Log[c*x^n])] - b*d*n*Int[Sin[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, n}, x]
Int[CosIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*CosIntegral[d*(a + b*Log[c*x^n])] - b*d*n*Int[Cos[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, n}, x]
Int[F_[d_.*(a_. + b_.*Log[c_.*x_^n_.])]/x_, x_Symbol] := 1/n*Subst[F[d*(a + b*x)], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, n}, x] && MemberQ[{SinIntegral, CosIntegral}, x]
Int[(e_.*x_)^m_.*SinIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*SinIntegral[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*d*n/(m + 1)* Int[(e*x)^m*Sin[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(e_.*x_)^m_.*CosIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*CosIntegral[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*d*n/(m + 1)* Int[(e*x)^m*Cos[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.5 Hyperbolic integral functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.5 Hyperbolic integral functions *)
Int[SinhIntegral[a_. + b_.*x_], x_Symbol] := (a + b*x)*SinhIntegral[a + b*x]/b - Cosh[a + b*x]/b /; FreeQ[{a, b}, x]
Int[CoshIntegral[a_. + b_.*x_], x_Symbol] := (a + b*x)*CoshIntegral[a + b*x]/b - Sinh[a + b*x]/b /; FreeQ[{a, b}, x]
Int[SinhIntegral[b_.*x_]/x_, x_Symbol] := 1/2*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, -b*x] + 1/2*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, b*x] /; FreeQ[b, x]
Int[CoshIntegral[b_.*x_]/x_, x_Symbol] := -1/2*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, -b*x] + 1/2*b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, b*x] + EulerGamma*Log[x] + 1/2*Log[b*x]^2 /; FreeQ[b, x]
Int[(c_. + d_.*x_)^m_.*SinhIntegral[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*SinhIntegral[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Sinh[a + b*x]/(a + b*x), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*CoshIntegral[a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*CoshIntegral[a + b*x]/(d*(m + 1)) - b/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Cosh[a + b*x]/(a + b*x), x] /; FreeQ[{a, b, c, d, m}, x] && NeQ[m, -1]
Int[SinhIntegral[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*SinhIntegral[a + b*x]^2/b - 2*Int[Sinh[a + b*x]*SinhIntegral[a + b*x], x] /; FreeQ[{a, b}, x]
Int[CoshIntegral[a_. + b_.*x_]^2, x_Symbol] := (a + b*x)*CoshIntegral[a + b*x]^2/b - 2*Int[Cosh[a + b*x]*CoshIntegral[a + b*x], x] /; FreeQ[{a, b}, x]
Int[x_^m_.*SinhIntegral[b_.*x_]^2, x_Symbol] := x^(m + 1)*SinhIntegral[b*x]^2/(m + 1) - 2/(m + 1)*Int[x^m*Sinh[b*x]*SinhIntegral[b*x], x] /; FreeQ[b, x] && IGtQ[m, 0]
Int[x_^m_.*CoshIntegral[b_.*x_]^2, x_Symbol] := x^(m + 1)*CoshIntegral[b*x]^2/(m + 1) - 2/(m + 1)*Int[x^m*Cosh[b*x]*CoshIntegral[b*x], x] /; FreeQ[b, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*SinhIntegral[a_ + b_.*x_]^2, x_Symbol] := (a + b*x)*(c + d*x)^m*SinhIntegral[a + b*x]^2/(b*(m + 1)) - 2/(m + 1)* Int[(c + d*x)^m*Sinh[a + b*x]*SinhIntegral[a + b*x], x] + (b*c - a*d)*m/(b*(m + 1))* Int[(c + d*x)^(m - 1)*SinhIntegral[a + b*x]^2, x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*CoshIntegral[a_ + b_.*x_]^2, x_Symbol] := (a + b*x)*(c + d*x)^m*CoshIntegral[a + b*x]^2/(b*(m + 1)) - 2/(m + 1)* Int[(c + d*x)^m*Cosh[a + b*x]*CoshIntegral[a + b*x], x] + (b*c - a*d)*m/(b*(m + 1))* Int[(c + d*x)^(m - 1)*CoshIntegral[a + b*x]^2, x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
(* Int[x_^m_.*SinhIntegral[a_+b_.*x_]^2,x_Symbol] := b*x^(m+2)*SinhIntegral[a+b*x]^2/(a*(m+1)) + x^(m+1)*SinhIntegral[a+b*x]^2/(m+1) - 2*b/(a*(m+1))*Int[x^(m+1)*Sinh[a+b*x]*SinhIntegral[a+b*x],x] - b*(m+2)/(a*(m+1))*Int[x^(m+1)*SinhIntegral[a+b*x]^2,x] /; FreeQ[{a,b},x] && ILtQ[m,-2] *)
(* Int[x_^m_.*CoshIntegral[a_+b_.*x_]^2,x_Symbol] := b*x^(m+2)*CoshIntegral[a+b*x]^2/(a*(m+1)) + x^(m+1)*CoshIntegral[a+b*x]^2/(m+1) - 2*b/(a*(m+1))*Int[x^(m+1)*Cosh[a+b*x]*CoshIntegral[a+b*x],x] - b*(m+2)/(a*(m+1))*Int[x^(m+1)*CoshIntegral[a+b*x]^2,x] /; FreeQ[{a,b},x] && ILtQ[m,-2] *)
Int[Sinh[a_. + b_.*x_]*SinhIntegral[c_. + d_.*x_], x_Symbol] := Cosh[a + b*x]*SinhIntegral[c + d*x]/b - d/b*Int[Cosh[a + b*x]*Sinh[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[Cosh[a_. + b_.*x_]*CoshIntegral[c_. + d_.*x_], x_Symbol] := Sinh[a + b*x]*CoshIntegral[c + d*x]/b - d/b*Int[Sinh[a + b*x]*Cosh[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[(e_. + f_.*x_)^m_.*Sinh[a_. + b_.*x_]*SinhIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^m*Cosh[a + b*x]*SinhIntegral[c + d*x]/b - d/b*Int[(e + f*x)^m*Cosh[a + b*x]*Sinh[c + d*x]/(c + d*x), x] - f*m/b* Int[(e + f*x)^(m - 1)*Cosh[a + b*x]*SinhIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*Cosh[a_. + b_.*x_]*CoshIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^m*Sinh[a + b*x]*CoshIntegral[c + d*x]/b - d/b*Int[(e + f*x)^m*Sinh[a + b*x]*Cosh[c + d*x]/(c + d*x), x] - f*m/b* Int[(e + f*x)^(m - 1)*Sinh[a + b*x]*CoshIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_*Sinh[a_. + b_.*x_]*SinhIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Sinh[a + b*x]*SinhIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sinh[a + b*x]*Sinh[c + d*x]/(c + d*x), x] - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cosh[a + b*x]*SinhIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_.*Cosh[a_. + b_.*x_]*CoshIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Cosh[a + b*x]*CoshIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cosh[a + b*x]*Cosh[c + d*x]/(c + d*x), x] - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sinh[a + b*x]*CoshIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[Cosh[a_. + b_.*x_]*SinhIntegral[c_. + d_.*x_], x_Symbol] := Sinh[a + b*x]*SinhIntegral[c + d*x]/b - d/b*Int[Sinh[a + b*x]*Sinh[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[Sinh[a_. + b_.*x_]*CoshIntegral[c_. + d_.*x_], x_Symbol] := Cosh[a + b*x]*CoshIntegral[c + d*x]/b - d/b*Int[Cosh[a + b*x]*Cosh[c + d*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x]
Int[(e_. + f_.*x_)^m_.*Cosh[a_. + b_.*x_]*SinhIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^m*Sinh[a + b*x]*SinhIntegral[c + d*x]/b - d/b*Int[(e + f*x)^m*Sinh[a + b*x]*Sinh[c + d*x]/(c + d*x), x] - f*m/b* Int[(e + f*x)^(m - 1)*Sinh[a + b*x]*SinhIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*Sinh[a_. + b_.*x_]*CoshIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^m*Cosh[a + b*x]*CoshIntegral[c + d*x]/b - d/b*Int[(e + f*x)^m*Cosh[a + b*x]*Cosh[c + d*x]/(c + d*x), x] - f*m/b* Int[(e + f*x)^(m - 1)*Cosh[a + b*x]*CoshIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^m_.*Cosh[a_. + b_.*x_]*SinhIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Cosh[a + b*x]* SinhIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cosh[a + b*x]*Sinh[c + d*x]/(c + d*x), x] - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sinh[a + b*x]*SinhIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[(e_. + f_.*x_)^m_*Sinh[a_. + b_.*x_]*CoshIntegral[c_. + d_.*x_], x_Symbol] := (e + f*x)^(m + 1)*Sinh[a + b*x]* CoshIntegral[c + d*x]/(f*(m + 1)) - d/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Sinh[a + b*x]*Cosh[c + d*x]/(c + d*x), x] - b/(f*(m + 1))* Int[(e + f*x)^(m + 1)*Cosh[a + b*x]*CoshIntegral[c + d*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[m, -1]
Int[SinhIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*SinhIntegral[d*(a + b*Log[c*x^n])] - b*d*n*Int[Sinh[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, n}, x]
Int[CoshIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*CoshIntegral[d*(a + b*Log[c*x^n])] - b*d*n*Int[Cosh[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, n}, x]
Int[F_[d_.*(a_. + b_.*Log[c_.*x_^n_.])]/x_, x_Symbol] := 1/n*Subst[F[d*(a + b*x)], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, n}, x] && MemberQ[{SinhIntegral, CoshIntegral}, x]
Int[(e_.*x_)^m_.*SinhIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*SinhIntegral[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*d*n/(m + 1)* Int[(e*x)^m*Sinh[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]
Int[(e_.*x_)^m_.*CoshIntegral[d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*CoshIntegral[d*(a + b*Log[c*x^n])]/(e*(m + 1)) - b*d*n/(m + 1)* Int[(e*x)^m*Cosh[d*(a + b*Log[c*x^n])]/(d*(a + b*Log[c*x^n])), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.6 Gamma functions.m
*)

(* ::Subsection::Closed:: *)
(* 8.6 Gamma functions *)
Int[Gamma[n_, a_. + b_.*x_], x_Symbol] := (a + b*x)*Gamma[n, a + b*x]/b - Gamma[n + 1, a + b*x]/b /; FreeQ[{a, b, n}, x]
Int[Gamma[0, b_.*x_]/x_, x_Symbol] := b*x*HypergeometricPFQ[{1, 1, 1}, {2, 2, 2}, -b*x] - EulerGamma*Log[x] - 1/2*Log[b*x]^2 /; FreeQ[b, x]
(* Int[Gamma[1,b_.*x_]/x_,x_Symbol] := Int[1/(x*E^(b*x)),x] /; FreeQ[b,x] *)
Int[Gamma[n_, b_.*x_]/x_, x_Symbol] := -Gamma[n - 1, b*x] + (n - 1)*Int[Gamma[n - 1, b*x]/x, x] /; FreeQ[b, x] && IGtQ[n, 1]
Int[Gamma[n_, b_.*x_]/x_, x_Symbol] := Gamma[n, b*x]/n + 1/n*Int[Gamma[n + 1, b*x]/x, x] /; FreeQ[b, x] && ILtQ[n, 0]
Int[Gamma[n_, b_.*x_]/x_, x_Symbol] := Gamma[n]*Log[x] - (b*x)^n/n^2* HypergeometricPFQ[{n, n}, {1 + n, 1 + n}, -b*x] /; FreeQ[{b, n}, x] && Not[IntegerQ[n]]
Int[(d_.*x_)^m_.*Gamma[n_, b_.*x_], x_Symbol] := (d*x)^(m + 1)*Gamma[n, b*x]/(d*(m + 1)) - (d*x)^m*Gamma[m + n + 1, b*x]/(b*(m + 1)*(b*x)^m) /; FreeQ[{b, d, m, n}, x] && NeQ[m, -1]
Int[(c_ + d_.*x_)^m_.*Gamma[n_, a_ + b_.*x_], x_Symbol] := 1/b*Subst[Int[(d*x/b)^m*Gamma[n, x], x], x, a + b*x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[b*c - a*d, 0]
Int[Gamma[n_, a_. + b_.*x_]/(c_. + d_.*x_), x_Symbol] := Int[(a + b*x)^(n - 1)/((c + d*x)*E^(a + b*x)), x] + (n - 1)* Int[Gamma[n - 1, a + b*x]/(c + d*x), x] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 1]
Int[(c_. + d_.*x_)^m_.*Gamma[n_, a_. + b_.*x_], x_Symbol] := Block[{$UseGamma = True}, (c + d*x)^(m + 1)*Gamma[n, a + b*x]/(d*(m + 1)) + b/(d*(m + 1))* Int[(c + d*x)^(m + 1)*(a + b*x)^(n - 1)/E^(a + b*x), x]] /; FreeQ[{a, b, c, d, m, n}, x] && (IGtQ[m, 0] || IGtQ[n, 0] || IntegersQ[m, n]) && NeQ[m, -1]
Int[(c_. + d_.*x_)^m_.*Gamma[n_, a_. + b_.*x_], x_Symbol] := Unintegrable[(c + d*x)^m*Gamma[n, a + b*x], x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[LogGamma[a_. + b_.*x_], x_Symbol] := PolyGamma[-2, a + b*x]/b /; FreeQ[{a, b}, x]
Int[(c_. + d_.*x_)^m_.*LogGamma[a_. + b_.*x_], x_Symbol] := (c + d*x)^m*PolyGamma[-2, a + b*x]/b - d*m/b*Int[(c + d*x)^(m - 1)*PolyGamma[-2, a + b*x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*LogGamma[a_. + b_.*x_], x_Symbol] := Unintegrable[(c + d*x)^m*LogGamma[a + b*x], x] /; FreeQ[{a, b, c, d, m}, x]
Int[PolyGamma[n_, a_. + b_.*x_], x_Symbol] := PolyGamma[n - 1, a + b*x]/b /; FreeQ[{a, b, n}, x]
Int[(c_. + d_.*x_)^m_.*PolyGamma[n_, a_. + b_.*x_], x_Symbol] := (c + d*x)^m*PolyGamma[n - 1, a + b*x]/b - d*m/b*Int[(c + d*x)^(m - 1)*PolyGamma[n - 1, a + b*x], x] /; FreeQ[{a, b, c, d, n}, x] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*PolyGamma[n_, a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*PolyGamma[n, a + b*x]/(d*(m + 1)) - b/(d*(m + 1))* Int[(c + d*x)^(m + 1)*PolyGamma[n + 1, a + b*x], x] /; FreeQ[{a, b, c, d, n}, x] && LtQ[m, -1]
Int[(c_. + d_.*x_)^m_.*PolyGamma[n_, a_. + b_.*x_], x_Symbol] := Unintegrable[(c + d*x)^m*PolyGamma[n, a + b*x], x] /; FreeQ[{a, b, c, d, m, n}, x]
Int[Gamma[a_. + b_.*x_]^n_.*PolyGamma[0, a_. + b_.*x_], x_Symbol] := Gamma[a + b*x]^n/(b*n) /; FreeQ[{a, b, n}, x]
Int[((a_. + b_.*x_)!)^n_.*PolyGamma[0, c_. + b_.*x_], x_Symbol] := ((a + b*x)!)^n/(b*n) /; FreeQ[{a, b, c, n}, x] && EqQ[c, a + 1]
Int[Gamma[p_, d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := x*Gamma[p, d*(a + b*Log[c*x^n])] + b*d*n*E^(-a*d)* Int[(d*(a + b*Log[c*x^n]))^(p - 1)/(c*x^n)^(b*d), x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[Gamma[p_, d_.*(a_. + b_.*Log[c_.*x_^n_.])]/x_, x_Symbol] := 1/n*Subst[Gamma[p, d*(a + b*x)], x, Log[c*x^n]] /; FreeQ[{a, b, c, d, n, p}, x]
Int[(e_.*x_)^m_.*Gamma[p_, d_.*(a_. + b_.*Log[c_.*x_^n_.])], x_Symbol] := (e*x)^(m + 1)*Gamma[p, d*(a + b*Log[c*x^n])]/(e*(m + 1)) + b*d*n*E^(-a*d)*(e*x)^(b*d*n)/((m + 1)*(c*x^n)^(b*d))* Int[(e*x)^(m - b*d*n)*(d*(a + b*Log[c*x^n]))^(p - 1), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && NeQ[m, -1]
Int[Gamma[p_, f_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])], x_Symbol] := 1/e*Subst[Int[Gamma[p, f*(a + b*Log[c*x^n])], x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, n, p}, x]
Int[(g_ + h_. x_)^m_.* Gamma[p_, f_.*(a_. + b_.*Log[c_.*(d_ + e_.*x_)^n_.])], x_Symbol] := 1/e*Subst[Int[(g*x/d)^m*Gamma[p, f*(a + b*Log[c*x^n])], x], x, d + e*x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x] && EqQ[e*g - d*h, 0]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.7 Zeta function.m
*)

(* ::Subsection::Closed:: *)
(* 8.7 Zeta function *)
Int[Zeta[2, a_. + b_.*x_], x_Symbol] := Int[PolyGamma[1, a + b*x], x] /; FreeQ[{a, b}, x]
Int[Zeta[s_, a_. + b_.*x_], x_Symbol] := -Zeta[s - 1, a + b*x]/(b*(s - 1)) /; FreeQ[{a, b, s}, x] && NeQ[s, 1] && NeQ[s, 2]
Int[(c_. + d_.*x_)^m_.*Zeta[2, a_. + b_.*x_], x_Symbol] := Int[(c + d*x)^m*PolyGamma[1, a + b*x], x] /; FreeQ[{a, b, c, d}, x] && RationalQ[m]
Int[(c_. + d_.*x_)^m_.*Zeta[s_, a_. + b_.*x_], x_Symbol] := -(c + d*x)^m*Zeta[s - 1, a + b*x]/(b*(s - 1)) + d*m/(b*(s - 1))*Int[(c + d*x)^(m - 1)*Zeta[s - 1, a + b*x], x] /; FreeQ[{a, b, c, d, s}, x] && NeQ[s, 1] && NeQ[s, 2] && GtQ[m, 0]
Int[(c_. + d_.*x_)^m_.*Zeta[s_, a_. + b_.*x_], x_Symbol] := (c + d*x)^(m + 1)*Zeta[s, a + b*x]/(d*(m + 1)) + b*s/(d*(m + 1))*Int[(c + d*x)^(m + 1)*Zeta[s + 1, a + b*x], x] /; FreeQ[{a, b, c, d, s}, x] && NeQ[s, 1] && NeQ[s, 2] && LtQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.8 Polylogarithm function.m
*)

(* ::Subsection::Closed:: *)
(* 8.8 Polylogarithm function *)
(* Int[PolyLog[2,a_.*(b_.*x_^p_.)^q_.],x_Symbol] := x*PolyLog[2,a*(b*x^p)^q] + p*q*Int[Log[1-a*(b*x^p)^q],x] /; FreeQ[{a,b,p,q},x] *)
Int[PolyLog[n_, a_.*(b_.*x_^p_.)^q_.], x_Symbol] := x*PolyLog[n, a*(b*x^p)^q] - p*q*Int[PolyLog[n - 1, a*(b*x^p)^q], x] /; FreeQ[{a, b, p, q}, x] && GtQ[n, 0]
Int[PolyLog[n_, a_.*(b_.*x_^p_.)^q_.], x_Symbol] := x*PolyLog[n + 1, a*(b*x^p)^q]/(p*q) - 1/(p*q)*Int[PolyLog[n + 1, a*(b*x^p)^q], x] /; FreeQ[{a, b, p, q}, x] && LtQ[n, -1]
Int[PolyLog[n_, a_.*(b_.*x_^p_.)^q_.], x_Symbol] := Unintegrable[PolyLog[n, a*(b*x^p)^q], x] /; FreeQ[{a, b, n, p, q}, x]
Int[PolyLog[n_, c_.*(a_. + b_.*x_)^p_.]/(d_. + e_.*x_), x_Symbol] := PolyLog[n + 1, c*(a + b*x)^p]/(e*p) /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[b*d, a*e]
Int[PolyLog[n_, a_.*(b_.*x_^p_.)^q_.]/x_, x_Symbol] := PolyLog[n + 1, a*(b*x^p)^q]/(p*q) /; FreeQ[{a, b, n, p, q}, x]
Int[(d_.*x_)^m_.*PolyLog[n_, a_.*(b_.*x_^p_.)^q_.], x_Symbol] := (d*x)^(m + 1)*PolyLog[n, a*(b*x^p)^q]/(d*(m + 1)) - p*q/(m + 1)*Int[(d*x)^m*PolyLog[n - 1, a*(b*x^p)^q], x] /; FreeQ[{a, b, d, m, p, q}, x] && NeQ[m, -1] && GtQ[n, 0]
Int[(d_.*x_)^m_.*PolyLog[n_, a_.*(b_.*x_^p_.)^q_.], x_Symbol] := (d*x)^(m + 1)*PolyLog[n + 1, a*(b*x^p)^q]/(d*p*q) - (m + 1)/(p*q)*Int[(d*x)^m*PolyLog[n + 1, a*(b*x^p)^q], x] /; FreeQ[{a, b, d, m, p, q}, x] && NeQ[m, -1] && LtQ[n, -1]
Int[(d_.*x_)^m_.*PolyLog[n_, a_.*(b_.*x_^p_.)^q_.], x_Symbol] := Unintegrable[(d*x)^m*PolyLog[n, a*(b*x^p)^q], x] /; FreeQ[{a, b, d, m, n, p, q}, x]
Int[Log[c_.*x_^m_.]^r_.*PolyLog[n_, a_.*(b_.*x_^p_.)^q_.]/x_, x_Symbol] := Log[c*x^m]^r*PolyLog[n + 1, a*(b*x^p)^q]/(p*q) - m*r/(p*q)* Int[Log[c*x^m]^(r - 1)*PolyLog[n + 1, a*(b*x^p)^q]/x, x] /; FreeQ[{a, b, c, m, n, q, r}, x] && GtQ[r, 0]
Int[PolyLog[n_, c_.*(a_. + b_.*x_)^p_.], x_Symbol] := x*PolyLog[n, c*(a + b*x)^p] - p*Int[PolyLog[n - 1, c*(a + b*x)^p], x] + a*p*Int[PolyLog[n - 1, c*(a + b*x)^p]/(a + b*x), x] /; FreeQ[{a, b, c, p}, x] && GtQ[n, 0]
Int[PolyLog[2, c_.*(a_. + b_.*x_)]/(d_. + e_.*x_), x_Symbol] := Log[1 - a*c - b*c*x]*PolyLog[2, c*(a + b*x)]/e + b/e*Int[Log[1 - a*c - b*c*x]^2/(a + b*x), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[c*(b*d - a*e) + e, 0]
Int[PolyLog[2, c_.*(a_. + b_.*x_)]/(d_. + e_.*x_), x_Symbol] := Log[d + e*x]*PolyLog[2, c*(a + b*x)]/e + b/e*Int[Log[d + e*x]*Log[1 - a*c - b*c*x]/(a + b*x), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[c*(b*d - a*e) + e, 0]
Int[(d_. + e_.*x_)^m_.*PolyLog[2, c_.*(a_. + b_.*x_)], x_Symbol] := (d + e*x)^(m + 1)*PolyLog[2, c*(a + b*x)]/(e*(m + 1)) + b/(e*(m + 1))* Int[(d + e*x)^(m + 1)*Log[1 - a*c - b*c*x]/(a + b*x), x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[m, -1]
(* Int[(d_.+e_.*x_)^m_.*PolyLog[n_,c_.*(a_.+b_.*x_)^p_.],x_Symbol] := (d+e*x)^(m+1)*PolyLog[n,c*(a+b*x)^p]/(e*(m+1)) - b*p/(e*(m+1))*Int[(d+e*x)^(m+1)*PolyLog[n-1,c*(a+b*x)^p]/(a+b*x),x]  /; FreeQ[{a,b,c,d,e,m,p},x] && GtQ[n,0] && IGtQ[m,0] *)
Int[x_^m_.*PolyLog[n_, c_.*(a_. + b_.*x_)^p_.], x_Symbol] := -(a^(m + 1) - b^(m + 1)*x^(m + 1))* PolyLog[n, c*(a + b*x)^p]/((m + 1)*b^(m + 1)) + p/((m + 1)*b^m)* Int[ExpandIntegrand[ PolyLog[n - 1, c*(a + b*x)^p], (a^(m + 1) - b^(m + 1)*x^(m + 1))/(a + b*x), x], x] /; FreeQ[{a, b, c, p}, x] && GtQ[n, 0] && IntegerQ[m] && NeQ[m, -1]
Int[(g_. + h_.*Log[f_.*(d_. + e_.*x_)^n_.])* PolyLog[2, c_.*(a_. + b_.*x_)], x_Symbol] := x*(g + h*Log[f*(d + e*x)^n])*PolyLog[2, c*(a + b*x)] + b*Int[(g + h*Log[f*(d + e*x)^n])*Log[1 - a*c - b*c*x]* ExpandIntegrand[x/(a + b*x), x], x] - e*h*n* Int[PolyLog[2, c*(a + b*x)]*ExpandIntegrand[x/(d + e*x), x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n}, x]
Int[Log[1 + e_.*x_]*PolyLog[2, c_.*x_]/x_, x_Symbol] := -PolyLog[2, c*x]^2/2 /; FreeQ[{c, e}, x] && EqQ[c + e, 0]
Int[(g_ + h_.*Log[1 + e_.*x_])*PolyLog[2, c_.*x_]/x_, x_Symbol] := g*Int[PolyLog[2, c*x]/x, x] + h*Int[(Log[1 + e*x]*PolyLog[2, c*x])/x, x] /; FreeQ[{c, e, g, h}, x] && EqQ[c + e, 0]
Int[x_^m_.*(g_. + h_.*Log[f_.*(d_. + e_.*x_)^n_.])* PolyLog[2, c_.*(a_. + b_.*x_)], x_Symbol] := x^(m + 1)*(g + h*Log[f*(d + e*x)^n])* PolyLog[2, c*(a + b*x)]/(m + 1) + b/(m + 1)* Int[ExpandIntegrand[(g + h*Log[f*(d + e*x)^n])* Log[1 - a*c - b*c*x], x^(m + 1)/(a + b*x), x], x] - e*h*n/(m + 1)* Int[ExpandIntegrand[PolyLog[2, c*(a + b*x)], x^(m + 1)/(d + e*x), x], x] /; FreeQ[{a, b, c, d, e, f, g, h, n}, x] && IntegerQ[m] && NeQ[m, -1]
Int[Px_*(g_. + h_.*Log[f_.*(d_. + e_.*x_)^n_.])* PolyLog[2, c_.*(a_. + b_.*x_)], x_Symbol] := With[{u = IntHide[Px, x]}, u*(g + h*Log[f*(d + e*x)^n])*PolyLog[2, c*(a + b*x)] + b*Int[ ExpandIntegrand[(g + h*Log[f*(d + e*x)^n])*Log[1 - a*c - b*c*x], u/(a + b*x), x], x] - e*h*n* Int[ExpandIntegrand[PolyLog[2, c*(a + b*x)], u/(d + e*x), x], x]] /; FreeQ[{a, b, c, d, e, f, g, h, n}, x] && PolyQ[Px, x]
Int[x_^m_*Px_*(g_. + h_.*Log[1 + e_.*x_])*PolyLog[2, c_.*x_], x_Symbol] := Coeff[Px, x, -m - 1]* Int[(g + h*Log[1 + e*x])*PolyLog[2, c*x]/x, x] + Int[ x^m*(Px - Coeff[Px, x, -m - 1]*x^(-m - 1))*(g + h*Log[1 + e*x])* PolyLog[2, c*x], x] /; FreeQ[{c, e, g, h}, x] && PolyQ[Px, x] && ILtQ[m, 0] && EqQ[c + e, 0] && NeQ[Coeff[Px, x, -m - 1], 0]
Int[x_^m_.*Px_*(g_. + h_.*Log[f_.*(d_. + e_.*x_)^n_.])* PolyLog[2, c_.*(a_. + b_.*x_)], x_Symbol] := With[{u = IntHide[x^m*Px, x]}, u*(g + h*Log[f*(d + e*x)^n])*PolyLog[2, c*(a + b*x)] + b*Int[ ExpandIntegrand[(g + h*Log[f*(d + e*x)^n])*Log[1 - a*c - b*c*x], u/(a + b*x), x], x] - e*h*n* Int[ExpandIntegrand[PolyLog[2, c*(a + b*x)], u/(d + e*x), x], x]] /; FreeQ[{a, b, c, d, e, f, g, h, n}, x] && PolyQ[Px, x] && IntegerQ[m]
Int[x_^m_*Px_.*(g_. + h_.*Log[f_.*(d_. + e_.*x_)^n_.])* PolyLog[2, c_.*(a_. + b_.*x_)], x_Symbol] := Unintegrable[ x^m*Px*(g + h*Log[f*(d + e*x)^n])*PolyLog[2, c*(a + b*x)], x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n}, x] && PolyQ[Px, x]
Int[PolyLog[n_, d_.*(F_^(c_.*(a_. + b_.*x_)))^p_.], x_Symbol] := PolyLog[n + 1, d*(F^(c*(a + b*x)))^p]/(b*c*p*Log[F]) /; FreeQ[{F, a, b, c, d, n, p}, x]
Int[(e_. + f_.*x_)^m_.*PolyLog[n_, d_.*(F_^(c_.*(a_. + b_.*x_)))^p_.], x_Symbol] := (e + f*x)^m* PolyLog[n + 1, d*(F^(c*(a + b*x)))^p]/(b*c*p*Log[F]) - f*m/(b*c*p*Log[F])* Int[(e + f*x)^(m - 1)*PolyLog[n + 1, d*(F^(c*(a + b*x)))^p], x] /; FreeQ[{F, a, b, c, d, e, f, n, p}, x] && GtQ[m, 0]
Int[u_*PolyLog[n_, v_], x_Symbol] := With[{w = DerivativeDivides[v, u*v, x]}, w*PolyLog[n + 1, v] /; Not[FalseQ[w]]] /; FreeQ[n, x]
Int[u_*Log[w_]*PolyLog[n_, v_], x_Symbol] := With[{z = DerivativeDivides[v, u*v, x]}, z*Log[w]*PolyLog[n + 1, v] - Int[SimplifyIntegrand[z*D[w, x]*PolyLog[n + 1, v]/w, x], x] /; Not[FalseQ[z]]] /; FreeQ[n, x] && InverseFunctionFreeQ[w, x]

(*FILE: 
Rubi/IntegrationRules/8 Special functions/8.9 Product logarithm function.m
*)

(* ::Subsection::Closed:: *)
(* 8.9 Product logarithm function *)
Int[(c_.*ProductLog[a_. + b_.*x_])^p_, x_Symbol] := (a + b*x)*(c*ProductLog[a + b*x])^p/(b*(p + 1)) + p/(c*(p + 1))* Int[(c*ProductLog[a + b*x])^(p + 1)/(1 + ProductLog[a + b*x]), x] /; FreeQ[{a, b, c}, x] && LtQ[p, -1]
Int[(c_.*ProductLog[a_. + b_.*x_])^p_., x_Symbol] := (a + b*x)*(c*ProductLog[a + b*x])^p/b - p*Int[(c*ProductLog[a + b*x])^p/(1 + ProductLog[a + b*x]), x] /; FreeQ[{a, b, c}, x] && Not[LtQ[p, -1]]
Int[(e_. + f_.*x_)^m_.*(c_.*ProductLog[a_ + b_.*x_])^p_., x_Symbol] := 1/b^(m + 1)* Subst[Int[ ExpandIntegrand[(c*ProductLog[x])^p, (b*e - a*f + f*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, e, f, p}, x] && IGtQ[m, 0]
Int[(c_.*ProductLog[a_.*x_^n_])^p_., x_Symbol] := x*(c*ProductLog[a*x^n])^p - n*p*Int[(c*ProductLog[a*x^n])^p/(1 + ProductLog[a*x^n]), x] /; FreeQ[{a, c, n, p}, x] && (EqQ[n*(p - 1), -1] || IntegerQ[p - 1/2] && EqQ[n*(p - 1/2), -1])
Int[(c_.*ProductLog[a_.*x_^n_])^p_., x_Symbol] := x*(c*ProductLog[a*x^n])^p/(n*p + 1) + n*p/(c*(n*p + 1))* Int[(c*ProductLog[a*x^n])^(p + 1)/(1 + ProductLog[a*x^n]), x] /; FreeQ[{a, c, n}, x] && (IntegerQ[p] && EqQ[n*(p + 1), -1] || IntegerQ[p - 1/2] && EqQ[n*(p + 1/2), -1])
Int[(c_.*ProductLog[a_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(c*ProductLog[a*x^(-n)])^p/x^2, x], x, 1/x] /; FreeQ[{a, c, p}, x] && ILtQ[n, 0]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^p_., x_Symbol] := x^(m + 1)*(c*ProductLog[a*x^n])^p/(m + 1) - n*p/(m + 1)* Int[x^m*(c*ProductLog[a*x^n])^p/(1 + ProductLog[a*x^n]), x] /; FreeQ[{a, c, m, n, p}, x] && NeQ[m, -1] && (IntegerQ[p - 1/2] && IGtQ[2*Simplify[p + (m + 1)/n], 0] || Not[IntegerQ[p - 1/2]] && IGtQ[Simplify[p + (m + 1)/n] + 1, 0])
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^p_., x_Symbol] := x^(m + 1)*(c*ProductLog[a*x^n])^p/(m + n*p + 1) + n*p/(c*(m + n*p + 1))* Int[x^m*(c*ProductLog[a*x^n])^(p + 1)/(1 + ProductLog[a*x^n]), x] /; FreeQ[{a, c, m, n, p}, x] && (EqQ[m, -1] || IntegerQ[p - 1/2] && ILtQ[Simplify[p + (m + 1)/n] - 1/2, 0] || Not[IntegerQ[p - 1/2]] && ILtQ[Simplify[p + (m + 1)/n], 0])
Int[x_^m_.*(c_.*ProductLog[a_.*x_])^p_., x_Symbol] := Int[x^m*(c*ProductLog[a*x])^p/(1 + ProductLog[a*x]), x] + 1/c* Int[x^m*(c*ProductLog[a*x])^(p + 1)/(1 + ProductLog[a*x]), x] /; FreeQ[{a, c, m}, x]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_])^p_., x_Symbol] := -Subst[Int[(c*ProductLog[a*x^(-n)])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, c, p}, x] && ILtQ[n, 0] && IntegerQ[m] && NeQ[m, -1]
Int[1/(d_ + d_.*ProductLog[a_. + b_.*x_]), x_Symbol] := (a + b*x)/(b*d*ProductLog[a + b*x]) /; FreeQ[{a, b, d}, x]
Int[ProductLog[a_. + b_.*x_]/(d_ + d_.*ProductLog[a_. + b_.*x_]), x_Symbol] := d*x - Int[1/(d + d*ProductLog[a + b*x]), x] /; FreeQ[{a, b, d}, x]
Int[(c_.*ProductLog[a_. + b_.*x_])^ p_/(d_ + d_.*ProductLog[a_. + b_.*x_]), x_Symbol] := c*(a + b*x)*(c*ProductLog[a + b*x])^(p - 1)/(b*d) - c*p* Int[(c*ProductLog[a + b*x])^(p - 1)/(d + d*ProductLog[a + b*x]), x] /; FreeQ[{a, b, c, d}, x] && GtQ[p, 0]
Int[1/(ProductLog[a_. + b_.*x_]*(d_ + d_.*ProductLog[a_. + b_.*x_])), x_Symbol] := ExpIntegralEi[ProductLog[a + b*x]]/(b*d) /; FreeQ[{a, b, d}, x]
Int[1/(Sqrt[ c_.*ProductLog[a_. + b_.*x_]]*(d_ + d_.*ProductLog[a_. + b_.*x_])), x_Symbol] := Rt[Pi*c, 2]*Erfi[Sqrt[c*ProductLog[a + b*x]]/Rt[c, 2]]/(b*c*d) /; FreeQ[{a, b, c, d}, x] && PosQ[c]
Int[1/(Sqrt[ c_.*ProductLog[a_. + b_.*x_]]*(d_ + d_.*ProductLog[a_. + b_.*x_])), x_Symbol] := Rt[-Pi*c, 2]*Erf[Sqrt[c*ProductLog[a + b*x]]/Rt[-c, 2]]/(b*c*d) /; FreeQ[{a, b, c, d}, x] && NegQ[c]
Int[(c_.*ProductLog[a_. + b_.*x_])^ p_/(d_ + d_.*ProductLog[a_. + b_.*x_]), x_Symbol] := (a + b*x)*(c*ProductLog[a + b*x])^p/(b*d*(p + 1)) - 1/(c*(p + 1))* Int[(c*ProductLog[a + b*x])^(p + 1)/(d + d*ProductLog[a + b*x]), x] /; FreeQ[{a, b, c, d}, x] && LtQ[p, -1]
Int[(c_.*ProductLog[a_. + b_.*x_])^ p_./(d_ + d_.*ProductLog[a_. + b_.*x_]), x_Symbol] := Gamma[ p + 1, -ProductLog[a + b*x]]*(c*ProductLog[a + b*x])^ p/(b*d*(-ProductLog[a + b*x])^p) /; FreeQ[{a, b, c, d, p}, x]
Int[(e_. + f_.*x_)^m_./(d_ + d_.*ProductLog[a_ + b_.*x_]), x_Symbol] := 1/b^(m + 1)* Subst[Int[ ExpandIntegrand[1/(d + d*ProductLog[x]), (b*e - a*f + f*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, d, e, f}, x] && IGtQ[m, 0]
Int[(e_. + f_.*x_)^ m_.*(c_.*ProductLog[a_ + b_.*x_])^ p_./(d_ + d_.*ProductLog[a_ + b_.*x_]), x_Symbol] := 1/b^(m + 1)* Subst[Int[ ExpandIntegrand[(c*ProductLog[x])^ p/(d + d*ProductLog[x]), (b*e - a*f + f*x)^m, x], x], x, a + b*x] /; FreeQ[{a, b, c, d, e, f, p}, x] && IGtQ[m, 0]
Int[1/(d_ + d_.*ProductLog[a_.*x_^n_]), x_Symbol] := -Subst[Int[1/(x^2*(d + d*ProductLog[a*x^(-n)])), x], x, 1/x] /; FreeQ[{a, d}, x] && ILtQ[n, 0]
Int[(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := c*x*(c*ProductLog[a*x^n])^(p - 1)/d /; FreeQ[{a, c, d, n, p}, x] && EqQ[n*(p - 1), -1]
Int[ProductLog[a_.*x_^n_.]^p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := a^p*ExpIntegralEi[-p*ProductLog[a*x^n]]/(d*n) /; FreeQ[{a, d}, x] && IntegerQ[p] && EqQ[n*p, -1]
Int[(c_.*ProductLog[a_.*x_^n_.])^p_/(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := Rt[Pi*c*n, 2]/(d*n*a^(1/n)*c^(1/n))* Erfi[Sqrt[c*ProductLog[a*x^n]]/Rt[c*n, 2]] /; FreeQ[{a, c, d}, x] && IntegerQ[1/n] && EqQ[p, 1/2 - 1/n] && PosQ[c*n]
Int[(c_.*ProductLog[a_.*x_^n_.])^p_/(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := Rt[-Pi*c*n, 2]/(d*n*a^(1/n)*c^(1/n))* Erf[Sqrt[c*ProductLog[a*x^n]]/Rt[-c*n, 2]] /; FreeQ[{a, c, d}, x] && IntegerQ[1/n] && EqQ[p, 1/2 - 1/n] && NegQ[c*n]
Int[(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := c*x*(c*ProductLog[a*x^n])^(p - 1)/d - c*(n*(p - 1) + 1)* Int[(c*ProductLog[a*x^n])^(p - 1)/(d + d*ProductLog[a*x^n]), x] /; FreeQ[{a, c, d}, x] && GtQ[n, 0] && GtQ[n*(p - 1) + 1, 0]
Int[(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := x*(c*ProductLog[a*x^n])^p/(d*(n*p + 1)) - 1/(c*(n*p + 1))* Int[(c*ProductLog[a*x^n])^(p + 1)/(d + d*ProductLog[a*x^n]), x] /; FreeQ[{a, c, d}, x] && GtQ[n, 0] && LtQ[n*p + 1, 0]
Int[(c_.*ProductLog[a_.*x_^n_])^p_./(d_ + d_.*ProductLog[a_.*x_^n_]), x_Symbol] := -Subst[ Int[(c*ProductLog[a*x^(-n)])^p/(x^2*(d + d*ProductLog[a*x^(-n)])), x], x, 1/x] /; FreeQ[{a, c, d, p}, x] && ILtQ[n, 0]
Int[x_^m_./(d_ + d_.*ProductLog[a_.*x_]), x_Symbol] := x^(m + 1)/(d*(m + 1)*ProductLog[a*x]) - m/(m + 1)*Int[x^m/(ProductLog[a*x]*(d + d*ProductLog[a*x])), x] /; FreeQ[{a, d}, x] && GtQ[m, 0]
Int[1/(x_*(d_ + d_.*ProductLog[a_.*x_])), x_Symbol] := Log[ProductLog[a*x]]/d /; FreeQ[{a, d}, x]
Int[x_^m_./(d_ + d_.*ProductLog[a_.*x_]), x_Symbol] := x^(m + 1)/(d*(m + 1)) - Int[x^m*ProductLog[a*x]/(d + d*ProductLog[a*x]), x] /; FreeQ[{a, d}, x] && LtQ[m, -1]
Int[x_^m_./(d_ + d_.*ProductLog[a_.*x_]), x_Symbol] := x^m*Gamma[m + 1, -(m + 1)*ProductLog[a*x]]/ (a*d*(m + 1)* E^(m*ProductLog[a*x])*(-(m + 1)*ProductLog[a*x])^m) /; FreeQ[{a, d, m}, x] && Not[IntegerQ[m]]
Int[1/(x_*(d_ + d_.*ProductLog[a_.*x_^n_.])), x_Symbol] := Log[ProductLog[a*x^n]]/(d*n) /; FreeQ[{a, d, n}, x]
Int[x_^m_./(d_ + d_.*ProductLog[a_.*x_^n_]), x_Symbol] := -Subst[Int[1/(x^(m + 2)*(d + d*ProductLog[a*x^(-n)])), x], x, 1/x] /; FreeQ[{a, d}, x] && IntegerQ[m] && ILtQ[n, 0] && NeQ[m, -1]
Int[(c_.*ProductLog[a_.*x_^n_.])^ p_./(x_*(d_ + d_.*ProductLog[a_.*x_^n_.])), x_Symbol] := (c*ProductLog[a*x^n])^p/(d*n*p) /; FreeQ[{a, c, d, n, p}, x]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := c*x^(m + 1)*(c*ProductLog[a*x^n])^(p - 1)/(d*(m + 1)) /; FreeQ[{a, c, d, m, n, p}, x] && NeQ[m, -1] && EqQ[m + n*(p - 1), -1]
Int[x_^m_.* ProductLog[a_.*x_^n_.]^p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := a^p*ExpIntegralEi[-p*ProductLog[a*x^n]]/(d*n) /; FreeQ[{a, d, m, n}, x] && IntegerQ[p] && EqQ[m + n*p, -1]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^ p_/(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := a^(p - 1/2)*c^(p - 1/2)*Rt[Pi*c/(p - 1/2), 2]* Erf[Sqrt[c*ProductLog[a*x^n]]/Rt[c/(p - 1/2), 2]]/(d*n) /; FreeQ[{a, c, d, m, n}, x] && NeQ[m, -1] && IntegerQ[p - 1/2] && EqQ[m + n*(p - 1/2), -1] && PosQ[c/(p - 1/2)]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^ p_/(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := a^(p - 1/2)*c^(p - 1/2)*Rt[-Pi*c/(p - 1/2), 2]* Erfi[Sqrt[c*ProductLog[a*x^n]]/Rt[-c/(p - 1/2), 2]]/(d*n) /; FreeQ[{a, c, d, m, n}, x] && NeQ[m, -1] && IntegerQ[p - 1/2] && EqQ[m + n*(p - 1/2), -1] && NegQ[c/(p - 1/2)]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := c*x^(m + 1)*(c*ProductLog[a*x^n])^(p - 1)/(d*(m + 1)) - c*(m + n*(p - 1) + 1)/(m + 1)* Int[x^m*(c*ProductLog[a*x^n])^(p - 1)/(d + d*ProductLog[a*x^n]), x] /; FreeQ[{a, c, d, m, n, p}, x] && NeQ[m, -1] && GtQ[Simplify[p + (m + 1)/n], 1]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := x^(m + 1)*(c*ProductLog[a*x^n])^p/(d*(m + n*p + 1)) - (m + 1)/(c*(m + n*p + 1))* Int[x^m*(c*ProductLog[a*x^n])^(p + 1)/(d + d*ProductLog[a*x^n]), x] /; FreeQ[{a, c, d, m, n, p}, x] && NeQ[m, -1] && LtQ[Simplify[p + (m + 1)/n], 0]
Int[x_^m_.*(c_.*ProductLog[a_.*x_])^p_./(d_ + d_.*ProductLog[a_.*x_]), x_Symbol] := x^m*Gamma[ m + p + 1, -(m + 1)*ProductLog[a*x]]*(c*ProductLog[a*x])^p/ (a*d*(m + 1)* E^(m*ProductLog[a*x])*(-(m + 1)*ProductLog[a*x])^(m + p)) /; FreeQ[{a, c, d, m, p}, x] && NeQ[m, -1]
Int[x_^m_.*(c_.*ProductLog[a_.*x_^n_.])^ p_./(d_ + d_.*ProductLog[a_.*x_^n_.]), x_Symbol] := -Subst[ Int[(c*ProductLog[a*x^(-n)])^ p/(x^(m + 2)*(d + d*ProductLog[a*x^(-n)])), x], x, 1/x] /; FreeQ[{a, c, d, p}, x] && NeQ[m, -1] && IntegerQ[m] && LtQ[n, 0]
Int[u_, x_Symbol] := Subst[ Int[SimplifyIntegrand[(x + 1)*E^x*SubstFor[ProductLog[x], u, x], x], x], x, ProductLog[x]] /; FunctionOfQ[ProductLog[x], u, x]

(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.1 Derivative integration rules.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[Derivative[n_][f_][x_],x_Symbol] :=
  Derivative[n-1][f][x] /;
FreeQ[{f,n},x]


(* ::Code:: *)
Int[(c_.*F_^(a_.+b_.*x_))^p_.*Derivative[n_][f_][x_],x_Symbol] :=
  (c*F^(a+b*x))^p*Derivative[n-1][f][x] - b*p*Log[F] \[Star] Int[(c*F^(a+b*x))^p*Derivative[n-1][f][x],x] /;
FreeQ[{a,b,c,f,F,p},x] && IGtQ[n,0]


(* ::Code:: *)
Int[(c_.*F_^(a_.+b_.*x_))^p_.*Derivative[n_][f_][x_],x_Symbol] :=
  (c*F^(a+b*x))^p*Derivative[n][f][x]/(b*p*Log[F]) - 1/(b*p*Log[F]) \[Star] Int[(c*F^(a+b*x))^p*Derivative[n+1][f][x],x] /;
FreeQ[{a,b,c,f,F,p},x] && ILtQ[n,0]


(* ::Code:: *)
Int[Sin[a_.+b_.*x_]*Derivative[n_][f_][x_],x_Symbol] :=
  Sin[a+b*x]*Derivative[n-1][f][x] - b \[Star] Int[Cos[a+b*x]*Derivative[n-1][f][x],x] /;
FreeQ[{a,b,f},x] && IGtQ[n,0]


(* ::Code:: *)
Int[Cos[a_.+b_.*x_]*Derivative[n_][f_][x_],x_Symbol] :=
  Cos[a+b*x]*Derivative[n-1][f][x] + b \[Star] Int[Sin[a+b*x]*Derivative[n-1][f][x],x] /;
FreeQ[{a,b,f},x] && IGtQ[n,0]


(* ::Code:: *)
Int[Sin[a_.+b_.*x_]*Derivative[n_][f_][x_],x_Symbol] :=
  -Cos[a+b*x]*Derivative[n][f][x]/b + 1/b \[Star] Int[Cos[a+b*x]*Derivative[n+1][f][x],x] /;
FreeQ[{a,b,f},x] && ILtQ[n,0]


(* ::Code:: *)
Int[Cos[a_.+b_.*x_]*Derivative[n_][f_][x_],x_Symbol] :=
  Sin[a+b*x]*Derivative[n][f][x]/b - 1/b \[Star] Int[Sin[a+b*x]*Derivative[n+1][f][x],x] /;
FreeQ[{a,b,f},x] && ILtQ[n,0]


(* ::Code:: *)
Int[u_*Derivative[n_][f_][x_],x_Symbol] :=
  Subst[Int[SimplifyIntegrand[SubstFor[Derivative[n-1][f][x],u,x],x],x],x,Derivative[n-1][f][x]] /;
FreeQ[{f,n},x] && FunctionOfQ[Derivative[n-1][f][x],u,x]


(* ::Code:: *)
Int[u_*(a_.*Derivative[1][f_][x_]*g_[x_]+a_.*f_[x_]*Derivative[1][g_][x_]),x_Symbol] :=
  a \[Star] Subst[Int[SimplifyIntegrand[SubstFor[f[x]*g[x],u,x],x],x],x,f[x]*g[x]] /;
FreeQ[{a,f,g},x] && FunctionOfQ[f[x]*g[x],u,x]


(* ::Code:: *)
Int[u_*(a_.*Derivative[m_][f_][x_]*g_[x_]+a_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]),x_Symbol] :=
  a \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]*g[x],u,x],x],x],x,Derivative[m-1][f][x]*g[x]] /;
FreeQ[{a,f,g,m},x] && EqQ[m1,m-1] && FunctionOfQ[Derivative[m-1][f][x]*g[x],u,x]


(* ::Code:: *)
Int[u_*(a_.*Derivative[m_][f_][x_]*Derivative[n1_][g_][x_]+a_.*Derivative[m1_][f_][x_]*Derivative[n_][g_][x_]),x_Symbol] :=
  a \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]*Derivative[n-1][g][x],u,x],x],x],x,Derivative[m-1][f][x]*Derivative[n-1][g][x]] /;
FreeQ[{a,f,g,m,n},x] && EqQ[m1,m-1] && EqQ[n1,n-1] && FunctionOfQ[Derivative[m-1][f][x]*Derivative[n-1][g][x],u,x]


(* ::Code:: *)
Int[u_*f_[x_]^p_.*(a_.*Derivative[1][f_][x_]*g_[x_]+b_.*f_[x_]*Derivative[1][g_][x_]),x_Symbol] :=
  b \[Star] Subst[Int[SimplifyIntegrand[SubstFor[f[x]^(p+1)*g[x],u,x],x],x],x,f[x]^(p+1)*g[x]] /;
FreeQ[{a,b,f,g,p},x] && EqQ[a,b*(p+1)] && FunctionOfQ[f[x]^(p+1)*g[x],u,x]


(* ::Code:: *)
Int[u_*Derivative[m1_][f_][x_]^p_.*
    (a_.*Derivative[m_][f_][x_]*g_[x_]+b_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]),x_Symbol] :=
  b \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]^(p+1)*g[x],u,x],x],x],x,
    Derivative[m-1][f][x]^(p+1)*g[x]] /;
FreeQ[{a,b,f,g,m,p},x] && EqQ[m1,m-1] && EqQ[a,b*(p+1)] && FunctionOfQ[Derivative[m-1][f][x]^(p+1)*g[x],u,x]


(* ::Code:: *)
Int[u_*g_[x_]^q_.*
    (a_.*Derivative[m_][f_][x_]*g_[x_]+b_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]),x_Symbol] :=
  a \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]*g[x]^(q+1),u,x],x],x],x,
    Derivative[m-1][f][x]*g[x]^(q+1)] /;
FreeQ[{a,b,f,g,m,q},x] && EqQ[m1,m-1] && EqQ[a*(q+1),b] && FunctionOfQ[Derivative[m-1][f][x]*g[x]^(q+1),u,x]


(* ::Code:: *)
Int[u_*Derivative[m1_][f_][x_]^p_.*
    (a_.*Derivative[m_][f_][x_]*Derivative[n1_][g_][x_]+b_.*Derivative[m1_][f_][x_]*Derivative[n_][g_][x_]),x_Symbol] :=
  b \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]^(p+1)*Derivative[n-1][g][x],u,x],x],x],x,
    Derivative[m-1][f][x]^(p+1)*Derivative[n-1][g][x]] /;
FreeQ[{a,b,f,g,m,n,p},x] && EqQ[m1,m-1] && EqQ[n1,n-1] && EqQ[a,b*(p+1)] && 
  FunctionOfQ[Derivative[m-1][f][x]^(p+1)*Derivative[n-1][g][x],u,x]


(* ::Code:: *)
Int[u_*f_[x_]^p_.*g_[x_]^q_.*(a_.*Derivative[1][f_][x_]*g_[x_]+b_.*f_[x_]*Derivative[1][g_][x_]),x_Symbol] :=
  a/(p+1) \[Star] Subst[Int[SimplifyIntegrand[SubstFor[f[x]^(p+1)*g[x]^(q+1),u,x],x],x],x,f[x]^(p+1)*g[x]^(q+1)] /;
FreeQ[{a,b,f,g,p,q},x] && EqQ[a*(q+1),b*(p+1)] && FunctionOfQ[f[x]^(p+1)*g[x]^(q+1),u,x]


(* ::Code:: *)
Int[u_*Derivative[m1_][f_][x_]^p_.*g_[x_]^q_.*
    (a_.*Derivative[m_][f_][x_]*g_[x_]+b_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]),x_Symbol] :=
  a/(p+1) \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]^(p+1)*g[x]^(q+1),u,x],x],x],x,
    Derivative[m-1][f][x]^(p+1)*g[x]^(q+1)] /;
FreeQ[{a,b,f,g,m,p,q},x] && EqQ[m1,m-1] && EqQ[a*(q+1),b*(p+1)] && FunctionOfQ[Derivative[m-1][f][x]^(p+1)*g[x]^(q+1),u,x]


(* ::Code:: *)
Int[u_*Derivative[m1_][f_][x_]^p_.*Derivative[n1_][g_][x_]^q_.*
    (a_.*Derivative[m_][f_][x_]*Derivative[n1_][g_][x_]+b_.*Derivative[m1_][f_][x_]*Derivative[n_][g_][x_]),x_Symbol] :=
  a/(p+1) \[Star] Subst[Int[SimplifyIntegrand[SubstFor[Derivative[m-1][f][x]^(p+1)*Derivative[n-1][g][x]^(q+1),u,x],x],x],x,
    Derivative[m-1][f][x]^(p+1)*Derivative[n-1][g][x]^(q+1)] /;
FreeQ[{a,b,f,g,m,n,p,q},x] && EqQ[m1,m-1] && EqQ[n1,n-1] && EqQ[a*(q+1),b*(p+1)] && 
  FunctionOfQ[Derivative[m-1][f][x]^(p+1)*Derivative[n-1][g][x]^(q+1),u,x]


(* ::Code:: *)
Int[f_'[x_]*g_[x_] + f_[x_]*g_'[x_],x_Symbol] :=
  f[x]*g[x] /;
FreeQ[{f,g},x]


(* ::Code:: *)
Int[(f_'[x_]*g_[x_] - f_[x_]*g_'[x_])/g_[x_]^2,x_Symbol] :=
  f[x]/g[x] /;
FreeQ[{f,g},x]


(* ::Code:: *)
Int[(f_'[x_]*g_[x_] - f_[x_]*g_'[x_])/(f_[x_]*g_[x_]),x_Symbol] :=
  Log[f[x]/g[x]] /;
FreeQ[{f,g},x]




(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.1 Integrand simplification rules.m
*)

(* ::Subsection::Closed:: *)
(* 9.1 Integrand simplification rules *)
(* Int[u_.*(v_+w_)^p_.,x_Symbol] := Int[u*w^p,x] /; FreeQ[p,x] && EqQ[v,0] *)
Int[u_.*(a_ + b_.*x_^n_.)^p_., x_Symbol] := Int[u*(b*x^n)^p, x] /; FreeQ[{a, b, n, p}, x] && EqQ[a, 0]
Int[u_.*(a_. + b_.*x_^n_.)^p_., x_Symbol] := Int[u*a^p, x] /; FreeQ[{a, b, n, p}, x] && EqQ[b, 0]
Int[u_.*(a_ + b_.*x_^n_. + c_.*x_^j_.)^p_., x_Symbol] := Int[u*(b*x^n + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[j, 2*n] && EqQ[a, 0]
Int[u_.*(a_. + b_.*x_^n_. + c_.*x_^j_.)^p_., x_Symbol] := Int[u*(a + c*x^(2*n))^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[j, 2*n] && EqQ[b, 0]
Int[u_.*(a_. + b_.*x_^n_. + c_.*x_^j_.)^p_., x_Symbol] := Int[u*(a + b*x^n)^p, x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[j, 2*n] && EqQ[c, 0]
Int[u_.*(a_.*v_ + b_.*v_ + w_.)^p_., x_Symbol] := Int[u*((a + b)*v + w)^p, x] /; FreeQ[{a, b}, x] && Not[FreeQ[v, x]]
Int[u_.*Px_^p_, x_Symbol] := Int[u*Px^Simplify[p], x] /; PolyQ[Px, x] && Not[RationalQ[p]] && FreeQ[p, x] && RationalQ[Simplify[p]]
Int[a_, x_Symbol] := a*x /; FreeQ[a, x]
Int[a_*(b_ + c_.*x_), x_Symbol] := a*(b + c*x)^2/(2*c) /; FreeQ[{a, b, c}, x]
Int[-u_, x_Symbol] := Identity[-1]*Int[u, x]
Int[Complex[0, a_]*u_, x_Symbol] := Complex[Identity[0], a]*Int[u, x] /; FreeQ[a, x] && EqQ[a^2, 1]
Int[a_*u_, x_Symbol] := a*Int[u, x] /; FreeQ[a, x] && Not[MatchQ[u, b_*v_ /; FreeQ[b, x]]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := ShowStep["", "Int[a*u + b*v + ...,x]", "a*Integrate[u,x] + b*Integrate[v,x] + ...", Hold[ IntSum[u, x]]] /; SimplifyFlag && SumQ[u], Int[u_, x_Symbol] := IntSum[u, x] /; SumQ[u]]
Int[(c_.*x_)^m_.*u_, x_Symbol] := Int[ExpandIntegrand[(c*x)^m*u, x], x] /; FreeQ[{c, m}, x] && SumQ[u] && Not[LinearQ[u, x]] && Not[MatchQ[u, a_ + b_.*v_ /; FreeQ[{a, b}, x] && InverseFunctionQ[v]]]
Int[u_.*(a_.*x_^n_)^m_, x_Symbol] := a^IntPart[m]*(a*x^n)^FracPart[m]/x^(n*FracPart[m])* Int[u*x^(m*n), x] /; FreeQ[{a, m, n}, x] && Not[IntegerQ[m]]
Int[u_.*v_^m_.*(b_*v_)^n_, x_Symbol] := 1/b^m*Int[u*(b*v)^(m + n), x] /; FreeQ[{b, n}, x] && IntegerQ[m]
Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_, x_Symbol] := a^(m + 1/2)*b^(n - 1/2)*Sqrt[b*v]/Sqrt[a*v]*Int[u*v^(m + n), x] /; FreeQ[{a, b, m}, x] && Not[IntegerQ[m]] && IGtQ[n + 1/2, 0] && IntegerQ[m + n]
(* Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_,x_Symbol] := b^(n-1/2)*Sqrt[b*v]/(a^(n-1/2)*Sqrt[a*v])*Int[u*(a*v)^(m+n),x] /; FreeQ[{a,b,m},x] && Not[IntegerQ[m]] && IGtQ[n+1/2,0] &&  Not[IntegerQ[m+n]] *)
Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_, x_Symbol] := a^(m - 1/2)*b^(n + 1/2)*Sqrt[a*v]/Sqrt[b*v]*Int[u*v^(m + n), x] /; FreeQ[{a, b, m}, x] && Not[IntegerQ[m]] && ILtQ[n - 1/2, 0] && IntegerQ[m + n]
(* Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_,x_Symbol] := b^(n+1/2)*Sqrt[a*v]/(a^(n+1/2)*Sqrt[b*v])*Int[u*(a*v)^(m+n),x] /; FreeQ[{a,b,m},x] && Not[IntegerQ[m]] && ILtQ[n-1/2,0] &&  Not[IntegerQ[m+n]] *)
Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_, x_Symbol] := a^(m + n)*(b*v)^n/(a*v)^n*Int[u*v^(m + n), x] /; FreeQ[{a, b, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && IntegerQ[m + n]
Int[u_.*(a_.*v_)^m_*(b_.*v_)^n_, x_Symbol] := b^IntPart[n]*(b*v)^FracPart[n]/(a^IntPart[n]*(a*v)^FracPart[n])* Int[u*(a*v)^(m + n), x] /; FreeQ[{a, b, m, n}, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]] && Not[IntegerQ[m + n]]
Int[u_.*(a_ + b_.*v_)^m_.*(c_ + d_.*v_)^n_., x_Symbol] := (b/d)^m*Int[u*(c + d*v)^(m + n), x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[b*c - a*d, 0] && IntegerQ[m] && (Not[IntegerQ[n]] || SimplerQ[c + d*x, a + b*x])
Int[u_.*(a_ + b_.*v_)^m_*(c_ + d_.*v_)^n_, x_Symbol] := (b/d)^m*Int[u*(c + d*v)^(m + n), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[b*c - a*d, 0] && GtQ[b/d, 0] && Not[IntegerQ[m] || IntegerQ[n]]
Int[u_.*(a_ + b_.*v_)^m_*(c_ + d_.*v_)^n_, x_Symbol] := (a + b*v)^m/(c + d*v)^m*Int[u*(c + d*v)^(m + n), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[b*c - a*d, 0] && Not[IntegerQ[m] || IntegerQ[n] || GtQ[b/d, 0]]
(* Int[u_.*(a_.*v_)^m_*(b_.*v_+c_.*v_^2),x_Symbol] := 1/a*Int[u*(a*v)^(m+1)*(b+c*v),x] /; FreeQ[{a,b,c},x] && LeQ[m,-1] *)
Int[u_.*(a_ + b_.*v_)^m_*(A_. + B_.*v_ + C_.*v_^2), x_Symbol] := 1/b^2*Int[u*(a + b*v)^(m + 1)*Simp[b*B - a*C + b*C*v, x], x] /; FreeQ[{a, b, A, B, C}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0] && LeQ[m, -1]
Int[u_.*(a_ + b_.*x_^n_.)^m_.*(c_ + d_.*x_^q_.)^p_., x_Symbol] := (d/a)^p*Int[u*(a + b*x^n)^(m + p)/x^(n*p), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[q, -n] && IntegerQ[p] && EqQ[a*c - b*d, 0] && Not[IntegerQ[m] && NegQ[n]]
Int[u_.*(a_ + b_.*x_^n_.)^m_.*(c_ + d_.*x_^j_)^p_., x_Symbol] := (-b^2/d)^m*Int[u*(a - b*x^n)^(-m), x] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[j, 2*n] && EqQ[p, -m] && EqQ[b^2*c + a^2*d, 0] && GtQ[a, 0] && LtQ[d, 0]
Int[u_.*(a_ + b_.*x_ + c_.*x_^2)^p_., x_Symbol] := Int[u*Cancel[(b/2 + c*x)^(2*p)/c^p], x] /; FreeQ[{a, b, c}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[u_.*(a_ + b_.*x_^n_ + c_.*x_^n2_.)^p_., x_Symbol] := 1/c^p*Int[u*(b/2 + c*x^n)^(2*p), x] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]

(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.2 Derivative integration rules.m
*)

(* ::Subsection::Closed:: *)
(* 9.2 Derivative integration rules *)
Int[Derivative[n_][f_][x_], x_Symbol] := Derivative[n - 1][f][x] /; FreeQ[{f, n}, x]
Int[(c_.*F_^(a_. + b_.*x_))^p_.*Derivative[n_][f_][x_], x_Symbol] := (c*F^(a + b*x))^p*Derivative[n - 1][f][x] - b*p*Log[F]*Int[(c*F^(a + b*x))^p*Derivative[n - 1][f][x], x] /; FreeQ[{a, b, c, f, F, p}, x] && IGtQ[n, 0]
Int[(c_.*F_^(a_. + b_.*x_))^p_.*Derivative[n_][f_][x_], x_Symbol] := (c*F^(a + b*x))^p*Derivative[n][f][x]/(b*p*Log[F]) - 1/(b*p*Log[F])*Int[(c*F^(a + b*x))^p*Derivative[n + 1][f][x], x] /; FreeQ[{a, b, c, f, F, p}, x] && ILtQ[n, 0]
Int[Sin[a_. + b_.*x_]*Derivative[n_][f_][x_], x_Symbol] := Sin[a + b*x]*Derivative[n - 1][f][x] - b*Int[Cos[a + b*x]*Derivative[n - 1][f][x], x] /; FreeQ[{a, b, f}, x] && IGtQ[n, 0]
Int[Cos[a_. + b_.*x_]*Derivative[n_][f_][x_], x_Symbol] := Cos[a + b*x]*Derivative[n - 1][f][x] + b*Int[Sin[a + b*x]*Derivative[n - 1][f][x], x] /; FreeQ[{a, b, f}, x] && IGtQ[n, 0]
Int[Sin[a_. + b_.*x_]*Derivative[n_][f_][x_], x_Symbol] := -Cos[a + b*x]*Derivative[n][f][x]/b + 1/b*Int[Cos[a + b*x]*Derivative[n + 1][f][x], x] /; FreeQ[{a, b, f}, x] && ILtQ[n, 0]
Int[Cos[a_. + b_.*x_]*Derivative[n_][f_][x_], x_Symbol] := Sin[a + b*x]*Derivative[n][f][x]/b - 1/b*Int[Sin[a + b*x]*Derivative[n + 1][f][x], x] /; FreeQ[{a, b, f}, x] && ILtQ[n, 0]
Int[u_*Derivative[n_][f_][x_], x_Symbol] := Subst[ Int[SimplifyIntegrand[SubstFor[Derivative[n - 1][f][x], u, x], x], x], x, Derivative[n - 1][f][x]] /; FreeQ[{f, n}, x] && FunctionOfQ[Derivative[n - 1][f][x], u, x]
Int[u_*(a_.*Derivative[1][f_][x_]*g_[x_] + a_.*f_[x_]*Derivative[1][g_][x_]), x_Symbol] := a*Subst[Int[SimplifyIntegrand[SubstFor[f[x]*g[x], u, x], x], x], x, f[x]*g[x]] /; FreeQ[{a, f, g}, x] && FunctionOfQ[f[x]*g[x], u, x]
Int[u_*(a_.*Derivative[m_][f_][x_]*g_[x_] + a_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]), x_Symbol] := a*Subst[ Int[SimplifyIntegrand[ SubstFor[Derivative[m - 1][f][x]*g[x], u, x], x], x], x, Derivative[m - 1][f][x]*g[x]] /; FreeQ[{a, f, g, m}, x] && EqQ[m1, m - 1] && FunctionOfQ[Derivative[m - 1][f][x]*g[x], u, x]
Int[u_*(a_.*Derivative[m_][f_][x_]*Derivative[n1_][g_][x_] + a_.*Derivative[m1_][f_][x_]*Derivative[n_][g_][x_]), x_Symbol] := a*Subst[ Int[SimplifyIntegrand[ SubstFor[Derivative[m - 1][f][x]*Derivative[n - 1][g][x], u, x], x], x], x, Derivative[m - 1][f][x]*Derivative[n - 1][g][x]] /; FreeQ[{a, f, g, m, n}, x] && EqQ[m1, m - 1] && EqQ[n1, n - 1] && FunctionOfQ[Derivative[m - 1][f][x]*Derivative[n - 1][g][x], u, x]
Int[u_*f_[x_]^ p_.*(a_.*Derivative[1][f_][x_]*g_[x_] + b_.*f_[x_]*Derivative[1][g_][x_]), x_Symbol] := b*Subst[ Int[SimplifyIntegrand[SubstFor[f[x]^(p + 1)*g[x], u, x], x], x], x, f[x]^(p + 1)*g[x]] /; FreeQ[{a, b, f, g, p}, x] && EqQ[a, b*(p + 1)] && FunctionOfQ[f[x]^(p + 1)*g[x], u, x]
Int[u_*Derivative[m1_][f_][x_]^p_.* (a_.*Derivative[m_][f_][x_]*g_[x_] + b_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]), x_Symbol] := b*Subst[ Int[SimplifyIntegrand[ SubstFor[Derivative[m - 1][f][x]^(p + 1)*g[x], u, x], x], x], x, Derivative[m - 1][f][x]^(p + 1)*g[x]] /; FreeQ[{a, b, f, g, m, p}, x] && EqQ[m1, m - 1] && EqQ[a, b*(p + 1)] && FunctionOfQ[Derivative[m - 1][f][x]^(p + 1)*g[x], u, x]
Int[u_*g_[x_]^q_.* (a_.*Derivative[m_][f_][x_]*g_[x_] + b_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]), x_Symbol] := a*Subst[ Int[SimplifyIntegrand[ SubstFor[Derivative[m - 1][f][x]*g[x]^(q + 1), u, x], x], x], x, Derivative[m - 1][f][x]*g[x]^(q + 1)] /; FreeQ[{a, b, f, g, m, q}, x] && EqQ[m1, m - 1] && EqQ[a*(q + 1), b] && FunctionOfQ[Derivative[m - 1][f][x]*g[x]^(q + 1), u, x]
Int[u_*Derivative[m1_][f_][x_]^p_.* (a_.*Derivative[m_][f_][x_]*Derivative[n1_][g_][x_] + b_.*Derivative[m1_][f_][x_]*Derivative[n_][g_][x_]), x_Symbol] := b*Subst[ Int[SimplifyIntegrand[ SubstFor[ Derivative[m - 1][f][x]^(p + 1)*Derivative[n - 1][g][x], u, x], x], x], x, Derivative[m - 1][f][x]^(p + 1)*Derivative[n - 1][g][x]] /; FreeQ[{a, b, f, g, m, n, p}, x] && EqQ[m1, m - 1] && EqQ[n1, n - 1] && EqQ[a, b*(p + 1)] && FunctionOfQ[ Derivative[m - 1][f][x]^(p + 1)*Derivative[n - 1][g][x], u, x]
Int[u_*f_[x_]^p_.* g_[x_]^q_.*(a_.*Derivative[1][f_][x_]*g_[x_] + b_.*f_[x_]*Derivative[1][g_][x_]), x_Symbol] := a/(p + 1)* Subst[Int[ SimplifyIntegrand[SubstFor[f[x]^(p + 1)*g[x]^(q + 1), u, x], x], x], x, f[x]^(p + 1)*g[x]^(q + 1)] /; FreeQ[{a, b, f, g, p, q}, x] && EqQ[a*(q + 1), b*(p + 1)] && FunctionOfQ[f[x]^(p + 1)*g[x]^(q + 1), u, x]
Int[u_*Derivative[m1_][f_][x_]^p_.*g_[x_]^q_.* (a_.*Derivative[m_][f_][x_]*g_[x_] + b_.*Derivative[m1_][f_][x_]*Derivative[1][g_][x_]), x_Symbol] := a/(p + 1)* Subst[Int[ SimplifyIntegrand[ SubstFor[Derivative[m - 1][f][x]^(p + 1)*g[x]^(q + 1), u, x], x], x], x, Derivative[m - 1][f][x]^(p + 1)*g[x]^(q + 1)] /; FreeQ[{a, b, f, g, m, p, q}, x] && EqQ[m1, m - 1] && EqQ[a*(q + 1), b*(p + 1)] && FunctionOfQ[Derivative[m - 1][f][x]^(p + 1)*g[x]^(q + 1), u, x]
Int[u_*Derivative[m1_][f_][x_]^p_.*Derivative[n1_][g_][x_]^q_.* (a_.*Derivative[m_][f_][x_]*Derivative[n1_][g_][x_] + b_.*Derivative[m1_][f_][x_]*Derivative[n_][g_][x_]), x_Symbol] := a/(p + 1)* Subst[Int[ SimplifyIntegrand[ SubstFor[ Derivative[m - 1][f][x]^(p + 1)* Derivative[n - 1][g][x]^(q + 1), u, x], x], x], x, Derivative[m - 1][f][x]^(p + 1)* Derivative[n - 1][g][x]^(q + 1)] /; FreeQ[{a, b, f, g, m, n, p, q}, x] && EqQ[m1, m - 1] && EqQ[n1, n - 1] && EqQ[a*(q + 1), b*(p + 1)] && FunctionOfQ[ Derivative[m - 1][f][x]^(p + 1)*Derivative[n - 1][g][x]^(q + 1), u, x]
Int[f_'[x_]*g_[x_] + f_[x_]*g_'[x_], x_Symbol] := f[x]*g[x] /; FreeQ[{f, g}, x]
Int[(f_'[x_]*g_[x_] - f_[x_]*g_'[x_])/g_[x_]^2, x_Symbol] := f[x]/g[x] /; FreeQ[{f, g}, x]
Int[(f_'[x_]*g_[x_] - f_[x_]*g_'[x_])/(f_[x_]*g_[x_]), x_Symbol] := Log[f[x]/g[x]] /; FreeQ[{f, g}, x]

(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.2 Piecewise linear functions.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[u_^m_.,x_Symbol] :=
  With[{c=Simplify[D[u,x]]},
  1/c \[Star] Subst[Int[x^m,x],x,u]] /;
FreeQ[m,x] && PiecewiseLinearQ[u,x]


(* ::Code:: *)
Int[v_/u_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  b*x/a - (b*u-a*v)/a \[Star] Int[1/u,x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x]


(* ::Code:: *)
Int[v_^n_/u_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  v^n/(a*n) - (b*u-a*v)/a \[Star] Int[v^(n-1)/u,x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && GtQ[n,0] && NeQ[n,1]


(* ::Code:: *)
Int[1/(u_*v_),x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  b/(b*u-a*v) \[Star] Int[1/v,x] - a/(b*u-a*v) \[Star] Int[1/u,x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x]


(* ::Code:: *)
Int[1/(u_*Sqrt[v_]),x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  2*ArcTan[Sqrt[v]/Rt[(b*u-a*v)/a,2]]/(a*Rt[(b*u-a*v)/a,2]) /;
 NeQ[b*u-a*v,0] && PosQ[(b*u-a*v)/a]] /;
PiecewiseLinearQ[u,v,x]


(* ::Code:: *)
Int[1/(u_*Sqrt[v_]),x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  -2*ArcTanh[Sqrt[v]/Rt[-(b*u-a*v)/a,2]]/(a*Rt[-(b*u-a*v)/a,2]) /;
 NeQ[b*u-a*v,0] && NegQ[(b*u-a*v)/a]] /;
PiecewiseLinearQ[u,v,x]


(* ::Code:: *)
Int[v_^n_/u_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  v^(n+1)/((n+1)*(b*u-a*v)) - 
  a*(n+1)/((n+1)*(b*u-a*v)) \[Star] Int[v^(n+1)/u,x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && LtQ[n,-1]


(* ::Code:: *)
Int[v_^n_/u_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  v^(n+1)/((n+1)*(b*u-a*v))*Hypergeometric2F1[1,n+1,n+2,-a*v/(b*u-a*v)] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[1/(Sqrt[u_]*Sqrt[v_]),x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  2/Rt[a*b,2]*ArcTanh[Rt[a*b,2]*Sqrt[u]/(a*Sqrt[v])] /;
 NeQ[b*u-a*v,0] && PosQ[a*b]] /;
PiecewiseLinearQ[u,v,x]


(* ::Code:: *)
Int[1/(Sqrt[u_]*Sqrt[v_]),x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  2/Rt[-a*b,2]*ArcTan[Rt[-a*b,2]*Sqrt[u]/(a*Sqrt[v])] /;
 NeQ[b*u-a*v,0] && NegQ[a*b]] /;
PiecewiseLinearQ[u,v,x]


(* ::Code:: *)
Int[u_^m_*v_^n_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  -u^(m+1)*v^(n+1)/((m+1)*(b*u-a*v)) /;
 NeQ[b*u-a*v,0]] /;
FreeQ[{m,n},x] && PiecewiseLinearQ[u,v,x] && EqQ[m+n+2,0] && NeQ[m,-1]


(* ::Code:: *)
Int[u_^m_*v_^n_.,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  u^(m+1)*v^n/(a*(m+1)) - 
  b*n/(a*(m+1)) \[Star] Int[u^(m+1)*v^(n-1),x] /;
 NeQ[b*u-a*v,0]] /;
FreeQ[{m,n},x] && PiecewiseLinearQ[u,v,x] (* && NeQ[m+n+2,0] *) && NeQ[m,-1] && (
  LtQ[m,-1] && GtQ[n,0] && Not[ILtQ[m+n,-2] && (FractionQ[m] || GeQ[2*n+m+1,0])] || 
  IGtQ[n,0] && IGtQ[m,0] && LeQ[n,m] ||
(* ILtQ[n,0] && ILtQ[m,0] && LeQ[n,m] || *)
  IGtQ[n,0] && Not[IntegerQ[m]] ||
  ILtQ[m,0] && Not[IntegerQ[n]])


(* ::Code:: *)
Int[u_^m_*v_^n_.,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  u^(m+1)*v^n/(a*(m+n+1)) - 
  n*(b*u-a*v)/(a*(m+n+1)) \[Star] Int[u^m*v^(n-1),x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && NeQ[m+n+2,0] && GtQ[n,0] && NeQ[m+n+1,0] && 
  Not[IGtQ[m,0] && (Not[IntegerQ[n]] || LtQ[0,m,n])] && 
  Not[ILtQ[m+n,-2]]


(* ::Code:: *)
Int[u_^m_*v_^n_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  u^(m+1)*v^n/(a*(m+n+1)) - 
  n*(b*u-a*v)/(a*(m+n+1)) \[Star] Int[u^m*v^Simplify[n-1],x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && NeQ[m+n+1,0] && Not[RationalQ[n]] && SumSimplerQ[n,-1]


(* ::Code:: *)
Int[u_^m_*v_^n_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  -u^(m+1)*v^(n+1)/((m+1)*(b*u-a*v)) + 
  b*(m+n+2)/((m+1)*(b*u-a*v)) \[Star] Int[u^(m+1)*v^n,x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && NeQ[m+n+2,0] && LtQ[m,-1]


(* ::Code:: *)
Int[u_^m_*v_^n_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  -u^(m+1)*v^(n+1)/((m+1)*(b*u-a*v)) + 
  b*(m+n+2)/((m+1)*(b*u-a*v)) \[Star] Int[u^Simplify[m+1]*v^n,x] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && Not[RationalQ[m]] && SumSimplerQ[m,1]


(* ::Code:: *)
Int[u_^m_*v_^n_,x_Symbol] :=
  With[{a=Simplify[D[u,x]],b=Simplify[D[v,x]]},
  u^m*v^(n+1)/(b*(n+1)*(b*u/(b*u-a*v))^m)*Hypergeometric2F1[-m,n+1,n+2,-a*v/(b*u-a*v)] /;
 NeQ[b*u-a*v,0]] /;
PiecewiseLinearQ[u,v,x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]


(* ::Code:: *)
Int[u_^n_.*Log[a_.+b_.*x_],x_Symbol] :=
  With[{c=Simplify[D[u,x]]},
  u^n*(a+b*x)*Log[a+b*x]/b - 
  Int[u^n,x] - 
  c*n/b \[Star] Int[u^(n-1)*(a+b*x)*Log[a+b*x],x]] /;
FreeQ[{a,b},x] && PiecewiseLinearQ[u,x] && Not[LinearQ[u,x]] && GtQ[n,0]


(* ::Code:: *)
(* Int[u_^n_.*Log[a_.+b_.*x_]/(a_.+b_.*x_),x_Symbol] :=
  With[{c=Simplify[D[u,x]]},
  u^n*Log[a+b*x]^2/(2*b) - 
  c*n/(2*b) \[Star] Int[u^(n-1)*Log[a+b*x]^2,x]] /;
FreeQ[{a,b},x] && PiecewiseLinearQ[u,x] && GtQ[n,0] *)


(* ::Code:: *)
Int[u_^n_.*(a_.+b_.*x_)^m_.*Log[a_.+b_.*x_],x_Symbol] :=
  With[{c=Simplify[D[u,x]]},
  u^n*(a+b*x)^(m+1)*Log[a+b*x]/(b*(m+1)) - 
  1/(m+1) \[Star] Int[u^n*(a+b*x)^m,x] - 
  c*n/(b*(m+1)) \[Star] Int[u^(n-1)*(a+b*x)^(m+1)*Log[a+b*x],x]] /;
FreeQ[{a,b,m},x] && PiecewiseLinearQ[u,x] && Not[LinearQ[u,x]] && GtQ[n,0] && NeQ[m,-1]




(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.3 Miscellaneous integration rules.m
*)
(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(a_.+b_.*F_[c_.*Sqrt[d_.+e_.*x_]/Sqrt[f_.+g_.*x_]])^n_./(A_.+B_.*x_+C_.*x_^2),x_Symbol] :=
  2*e*g/(C*(e*f-d*g)) \[Star] Subst[Int[(a+b*F[c*x])^n/x,x],x,Sqrt[d+e*x]/Sqrt[f+g*x]] /;
FreeQ[{a,b,c,d,e,f,g,A,B,C,F},x] && EqQ[C*d*f-A*e*g,0] && EqQ[B*e*g-C*(e*f+d*g),0] && IGtQ[n,0]


(* ::Code:: *)
Int[(a_.+b_.*F_[c_.*Sqrt[d_.+e_.*x_]/Sqrt[f_.+g_.*x_]])^n_./(A_.+C_.*x_^2),x_Symbol] :=
  2*e*g/(C*(e*f-d*g)) \[Star] Subst[Int[(a+b*F[c*x])^n/x,x],x,Sqrt[d+e*x]/Sqrt[f+g*x]] /;
FreeQ[{a,b,c,d,e,f,g,A,C,F},x] && EqQ[C*d*f-A*e*g,0] && EqQ[e*f+d*g,0] && IGtQ[n,0]


(* ::Code:: *)
Int[(a_.+b_.*F_[c_.*Sqrt[d_.+e_.*x_]/Sqrt[f_.+g_.*x_]])^n_/(A_.+B_.*x_+C_.*x_^2),x_Symbol] :=
  Unintegrable[(a+b*F[c*Sqrt[d+e*x]/Sqrt[f+g*x]])^n/(A+B*x+C*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g,A,B,C,F,n},x] && EqQ[C*d*f-A*e*g,0] && EqQ[B*e*g-C*(e*f+d*g),0] && Not[IGtQ[n,0]]


(* ::Code:: *)
Int[(a_.+b_.*F_[c_.*Sqrt[d_.+e_.*x_]/Sqrt[f_.+g_.*x_]])^n_/(A_+C_.*x_^2),x_Symbol] :=
  Unintegrable[(a+b*F[c*Sqrt[d+e*x]/Sqrt[f+g*x]])^n/(A+C*x^2),x] /;
FreeQ[{a,b,c,d,e,f,g,A,C,F,n},x] && EqQ[C*d*f-A*e*g,0] && EqQ[e*f+d*g,0] && Not[IGtQ[n,0]]


(* ::Code:: *)
Int[u_/y_,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
    q*Log[RemoveContent[y,x]] /;
 Not[FalseQ[q]]]


(* ::Code:: *)
Int[u_/(y_*w_),x_Symbol] :=
  With[{q=DerivativeDivides[y*w,u,x]},
    q*Log[RemoveContent[y*w,x]] /;
 Not[FalseQ[q]]]


(* ::Code:: *)
Int[u_*y_^m_.,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
   q*y^(m+1)/(m+1) /;
 Not[FalseQ[q]]] /;
FreeQ[m,x] && NeQ[m,-1]


(* ::Code:: *)
Int[u_*y_^m_.*z_^n_.,x_Symbol] :=
  With[{q=DerivativeDivides[y*z,u*z^(n-m),x]},
   q*y^(m+1)*z^(m+1)/(m+1) /;
 Not[FalseQ[q]]] /;
FreeQ[{m,n},x] && NeQ[m,-1]


(* ::Code:: *)
Int[u_,x_Symbol] :=
  With[{v=SimplifyIntegrand[u,x]},
  Int[v,x] /;
 SimplerIntegrandQ[v,u,x]]


(* ::Code:: *)
Int[u_.*(e_.*Sqrt[a_.+b_.*x_^n_.]+f_.*Sqrt[c_.+d_.*x_^n_.])^m_,x_Symbol] :=
  (a*e^2-c*f^2)^m \[Star] Int[ExpandIntegrand[u*(e*Sqrt[a+b*x^n]-f*Sqrt[c+d*x^n])^(-m),x],x] /;
FreeQ[{a,b,c,d,e,f,n},x] && ILtQ[m,0] && EqQ[b*e^2-d*f^2,0]


(* ::Code:: *)
Int[u_.*(e_.*Sqrt[a_.+b_.*x_^n_.]+f_.*Sqrt[c_.+d_.*x_^n_.])^m_,x_Symbol] :=
  (b*e^2-d*f^2)^m \[Star] Int[ExpandIntegrand[u*x^(m*n)*(e*Sqrt[a+b*x^n]-f*Sqrt[c+d*x^n])^(-m),x],x] /;
FreeQ[{a,b,c,d,e,f,n},x] && ILtQ[m,0] && EqQ[a*e^2-c*f^2,0]


(* ::Code:: *)
Int[u_^m_.*(a_.*u_^n_+v_)^p_.*w_,x_Symbol] :=
  Int[u^(m+n*p)*(a+u^(-n)*v)^p*w,x] /;
FreeQ[{a,m,n},x] && IntegerQ[p] && Not[GtQ[n,0]] && Not[FreeQ[v,x]]


(* ::Code:: *)
Int[u_*(a_.+b_.*y_)^m_.*(c_.+d_.*v_)^n_.,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
   q \[Star] Subst[Int[(a+b*x)^m*(c+d*x)^n,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,c,d,m,n},x] && EqQ[v,y]


(* ::Code:: *)
Int[u_*(a_.+b_.*y_)^m_.*(c_.+d_.*v_)^n_.*(e_.+f_.*w_)^p_.,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
   q \[Star] Subst[Int[(a+b*x)^m*(c+d*x)^n*(e+f*x)^p,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && EqQ[v,y] && EqQ[w,y]


(* ::Code:: *)
Int[u_*(a_.+b_.*y_)^m_.*(c_.+d_.*v_)^n_.*(e_.+f_.*w_)^p_.*(g_.+h_.*z_)^q_.,x_Symbol] :=
  With[{r=DerivativeDivides[y,u,x]},
   r \[Star] Subst[Int[(a+b*x)^m*(c+d*x)^n*(e+f*x)^p*(g+h*x)^q,x],x,y] /;
 Not[FalseQ[r]]] /;
FreeQ[{a,b,c,d,e,f,g,h,m,n,p,q},x] && EqQ[v,y] && EqQ[w,y] && EqQ[z,y]


(* ::Code:: *)
Int[u_.*(a_+b_.*y_^n_),x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
   a \[Star] Int[u,x] + b*q \[Star] Subst[Int[x^n,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,n},x]


(* ::Code:: *)
Int[u_.*(a_.+b_.*y_^n_)^p_,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
   q \[Star] Subst[Int[(a+b*x^n)^p,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,n,p},x]


(* ::Code:: *)
Int[u_.*v_^m_.*(a_.+b_.*y_^n_)^p_.,x_Symbol] :=
  Module[{q,r},
    q*r \[Star] Subst[Int[x^m*(a+b*x^n)^p,x],x,y] /;
  Not[FalseQ[r=Divides[y^m,v^m,x]]] && Not[FalseQ[q=DerivativeDivides[y,u,x]]]] /;
FreeQ[{a,b,m,n,p},x]


(* ::Code:: *)
Int[u_.*(a_.+b_.*y_^n_+c_.*v_^n2_.)^p_,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
  q \[Star] Subst[Int[(a+b*x^n+c*x^(2*n))^p,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,c,n,p},x] && EqQ[n2,2*n] && EqQ[v,y]


(* ::Code:: *)
Int[u_.*(A_+B_.*y_^n_)(a_.+b_.*v_^n_+c_.*w_^n2_.)^p_.,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
  q \[Star] Subst[Int[(A+B*x^n)*(a+b*x^n+c*x^(2*n))^p,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,c,A,B,n,p},x] && EqQ[n2,2*n] && EqQ[v,y] && EqQ[w,y]


(* ::Code:: *)
Int[u_.*(A_+B_.*y_^n_)(a_.+c_.*w_^n2_.)^p_.,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
  q \[Star] Subst[Int[(A+B*x^n)*(a+c*x^(2*n))^p,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,c,A,B,n,p},x] && EqQ[n2,2*n] && EqQ[w,y]


(* ::Code:: *)
Int[u_.*v_^m_.*(a_.+b_.*y_^n_+c_.*w_^n2_.)^p_.,x_Symbol] :=
  Module[{q,r},
    q*r \[Star] Subst[Int[x^m*(a+b*x^n+c*x^(2*n))^p,x],x,y] /;
  Not[FalseQ[r=Divides[y^m,v^m,x]]] && Not[FalseQ[q=DerivativeDivides[y,u,x]]]] /;
FreeQ[{a,b,c,m,n,p},x] && EqQ[n2,2*n] && EqQ[w,y]


(* ::Code:: *)
Int[u_.*z_^m_.*(A_+B_.*y_^n_)*(a_.+b_.*v_^n_+c_.*w_^n2_.)^p_.,x_Symbol] :=
  Module[{q,r},
    q*r \[Star] Subst[Int[x^m*(A+B*x^n)*(a+b*x^n+c*x^(2*n))^p,x],x,y] /;
  Not[FalseQ[r=Divides[y^m,z^m,x]]] && Not[FalseQ[q=DerivativeDivides[y,u,x]]]] /;
FreeQ[{a,b,c,A,B,m,n,p},x] && EqQ[n2,2*n] && EqQ[v,y] && EqQ[w,y]


(* ::Code:: *)
Int[u_.*z_^m_.*(A_+B_.*y_^n_)*(a_.+c_.*w_^n2_.)^p_.,x_Symbol] :=
  Module[{q,r},
    q*r \[Star] Subst[Int[x^m*(A+B*x^n)*(a+c*x^(2*n))^p,x],x,y] /;
  Not[FalseQ[r=Divides[y^m,z^m,x]]] && Not[FalseQ[q=DerivativeDivides[y,u,x]]]] /;
FreeQ[{a,c,A,B,m,n,p},x] && EqQ[n2,2*n] && EqQ[w,y]


(* ::Code:: *)
Int[u_.*(a_.+b_.*y_^n_)^m_.*(c_.+d_.*v_^n_)^p_.,x_Symbol] :=
  With[{q=DerivativeDivides[y,u,x]},
  q \[Star] Subst[Int[(a+b*x^n)^m*(c+d*x^n)^p,x],x,y] /;
 Not[FalseQ[q]]] /;
FreeQ[{a,b,c,d,m,n,p},x] && EqQ[v,y]


(* ::Code:: *)
Int[u_.*(a_.+b_.*y_^n_)^m_.*(c_.+d_.*v_^n_)^p_.*(e_.+f_.*w_^n_)^q_.,x_Symbol] :=
  With[{r=DerivativeDivides[y,u,x]},
  r \[Star] Subst[Int[(a+b*x^n)^m*(c+d*x^n)^p*(e+f*x^n)^q,x],x,y] /;
 Not[FalseQ[r]]] /;
FreeQ[{a,b,c,d,e,f,m,n,p,q},x] && EqQ[v,y] && EqQ[w,y]


(* ::Code:: *)
Int[u_*F_^v_,x_Symbol] :=
  With[{q=DerivativeDivides[v,u,x]},
   q*F^v/Log[F] /;
 Not[FalseQ[q]]] /;
FreeQ[F,x]


(* ::Code:: *)
Int[u_*w_^m_.*F_^v_,x_Symbol] :=
  With[{q=DerivativeDivides[v,u,x]},
   q \[Star] Subst[Int[x^m*F^x,x],x,v] /;
 Not[FalseQ[q]]] /;
FreeQ[{F,m},x] && EqQ[w,v]


(* ::Code:: *)
Int[u_*(a_+b_.*v_^p_.*w_^p_.)^m_.,x_Symbol] :=
  With[{c=Simplify[u/(w*D[v,x]+v*D[w,x])]},
  c \[Star] Subst[Int[(a+b*x^p)^m,x],x,v*w] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p},x] && IntegerQ[p]


(* ::Code:: *)
Int[u_*(a_+b_.*v_^p_.*w_^q_.)^m_.*v_^r_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]+q*v*D[w,x])]},
  c*p/(r+1) \[Star] Subst[Int[(a+b*x^(p/(r+1)))^m,x],x,v^(r+1)*w] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q,r},x] && EqQ[p,q*(r+1)] && NeQ[r,-1] && IntegerQ[p/(r+1)]


(* ::Code:: *)
Int[u_*(a_+b_.*v_^p_.*w_^q_.)^m_.*v_^r_.*w_^s_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]+q*v*D[w,x])]},
  c*p/(r+1) \[Star] Subst[Int[(a+b*x^(p/(r+1)))^m,x],x,v^(r+1)*w^(s+1)] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q,r,s},x] && EqQ[p*(s+1),q*(r+1)] && NeQ[r,-1] && IntegerQ[p/(r+1)]


(* ::Code:: *)
Int[u_*(a_.*v_^p_.+b_.*w_^q_.)^m_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]-q*v*D[w,x])]},
  c*p \[Star] Subst[Int[(b+a*x^p)^m,x],x,v*w^(m*q+1)] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q},x] && EqQ[p+q*(m*p+1),0] && IntegerQ[p] && IntegerQ[m]


(* ::Code:: *)
(* Int[u_*(a_.*v_^p_.+b_.*w_^q_.)^m_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]-q*v*D[w,x])]},
  -c*q \[Star] Subst[Int[(a+b*x^q)^m,x],x,v^(m*p+1)*w] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q},x] && EqQ[p+q*(m*p+1),0] && IntegerQ[q] && IntegerQ[m] *)


(* ::Code:: *)
Int[u_*(a_.*v_^p_.+b_.*w_^q_.)^m_.*v_^r_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]-q*v*D[w,x])]},
  -c*q \[Star] Subst[Int[(a+b*x^q)^m,x],x,v^(m*p+r+1)*w] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q,r},x] && EqQ[p+q*(m*p+r+1),0] && IntegerQ[q] && IntegerQ[m]


(* ::Code:: *)
Int[u_*(a_.*v_^p_.+b_.*w_^q_.)^m_.*w_^s_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]-q*v*D[w,x])]},
  -c*q/(s+1) \[Star] Subst[Int[(a+b*x^(q/(s+1)))^m,x],x,v^(m*p+1)*w^(s+1)] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q,s},x] && EqQ[p*(s+1)+q*(m*p+1),0] && NeQ[s,-1] && IntegerQ[q/(s+1)] && IntegerQ[m]


(* ::Code:: *)
Int[u_*(a_.*v_^p_.+b_.*w_^q_.)^m_.*v_^r_.*w_^s_.,x_Symbol] :=
  With[{c=Simplify[u/(p*w*D[v,x]-q*v*D[w,x])]},
  -c*q/(s+1) \[Star] Subst[Int[(a+b*x^(q/(s+1)))^m,x],x,v^(m*p+r+1)*w^(s+1)] /;
 FreeQ[c,x]] /;
FreeQ[{a,b,m,p,q,r,s},x] && EqQ[p*(s+1)+q*(m*p+r+1),0] && NeQ[s,-1] && IntegerQ[q/(s+1)] && IntegerQ[m]


(* ::Code:: *)
Int[u_*x_^m_.,x_Symbol] :=
  1/(m+1) \[Star] Subst[Int[SubstFor[x^(m+1),u,x],x],x,x^(m+1)] /;
FreeQ[m,x] && NeQ[m,-1] && FunctionOfQ[x^(m+1),u,x]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=SubstForFractionalPowerOfLinear[u,x]},
  ShowStep["","Int[F[(a+b*x)^(1/n),x],x]",
			"n/b \[Star] Subst[Int[x^(n-1)*F[x,-a/b+x^n/b],x],x,(a+b*x)^(1/n)]",Hold[
  lst[[2]]*lst[[4]] \[Star] Subst[Int[lst[[1]],x],x,lst[[3]]^(1/lst[[2]])]]] /;
 Not[FalseQ[lst]] && SubstForFractionalPowerQ[u,lst[[3]],x]] /;
SimplifyFlag,

Int[u_,x_Symbol] :=
  With[{lst=SubstForFractionalPowerOfLinear[u,x]},
  lst[[2]]*lst[[4]] \[Star] Subst[Int[lst[[1]],x],x,lst[[3]]^(1/lst[[2]])] /;
 Not[FalseQ[lst]] && SubstForFractionalPowerQ[u,lst[[3]],x]]]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=SubstForFractionalPowerOfQuotientOfLinears[u,x]},
  ShowStep["","Int[F[((a+b*x)/(c+d*x))^(1/n),x],x]",
"n*(b*c-a*d) \[Star] Subst[Int[x^(n-1)*F[x,(-a+c*x^n)/(b-d*x^n)]/(b-d*x^n)^2,x],x,((a+b*x)/(c+d*x))^(1/n)]",Hold[
  lst[[2]]*lst[[4]] \[Star] Subst[Int[lst[[1]],x],x,lst[[3]]^(1/lst[[2]])]]] /;
 Not[FalseQ[lst]]] /;
SimplifyFlag,

Int[u_,x_Symbol] :=
  With[{lst=SubstForFractionalPowerOfQuotientOfLinears[u,x]},
  lst[[2]]*lst[[4]] \[Star] Subst[Int[lst[[1]],x],x,lst[[3]]^(1/lst[[2]])] /;
 Not[FalseQ[lst]]]]


(* ::Code:: *)
Int[u_.*(a_.*v_^m_.*w_^n_.*z_^q_.)^p_,x_Symbol] :=
  a^IntPart[p]*(a*v^m*w^n*z^q)^FracPart[p]/(v^(m*FracPart[p])*w^(n*FracPart[p])*z^(q*FracPart[p])) \[Star] Int[u*v^(m*p)*w^(n*p)*z^(p*q),x] /;
FreeQ[{a,m,n,p,q},x] && Not[IntegerQ[p]] && Not[FreeQ[v,x]] && Not[FreeQ[w,x]] && Not[FreeQ[z,x]]


(* ::Code:: *)
Int[u_.*(a_.*v_^m_.*w_^n_.)^p_,x_Symbol] :=
  a^IntPart[p]*(a*v^m*w^n)^FracPart[p]/(v^(m*FracPart[p])*w^(n*FracPart[p])) \[Star] Int[u*v^(m*p)*w^(n*p),x] /;
FreeQ[{a,m,n,p},x] && Not[IntegerQ[p]] && Not[FreeQ[v,x]] && Not[FreeQ[w,x]]


(* ::Code:: *)
Int[u_.*(a_.*v_^m_.)^p_,x_Symbol] :=
  a^IntPart[p]*(a*v^m)^FracPart[p]/v^(m*FracPart[p]) \[Star] Int[u*v^(m*p),x] /;
FreeQ[{a,m,p},x] && Not[IntegerQ[p]] && Not[FreeQ[v,x]] && Not[EqQ[a,1] && EqQ[m,1]] && Not[EqQ[v,x] && EqQ[m,1]]


(* ::Code:: *)
Int[u_.*(a_.+b_.*x_^n_)^p_,x_Symbol] :=
  b^IntPart[p]*(a+b*x^n)^FracPart[p]/(x^(n*FracPart[p])*(1+a*x^(-n)/b)^FracPart[p]) \[Star] Int[u*x^(n*p)*(1+a*x^(-n)/b)^p,x] /;
FreeQ[{a,b,p},x] && Not[IntegerQ[p]] && ILtQ[n,0] && Not[RationalFunctionQ[u,x]] && IntegerQ[p+1/2]


(* ::Code:: *)
Int[u_.*(a_.+b_.*v_^n_)^p_,x_Symbol] :=
  (a+b*v^n)^FracPart[p]/(v^(n*FracPart[p])*(b+a*v^(-n))^FracPart[p]) \[Star] Int[u*v^(n*p)*(b+a*v^(-n))^p,x] /;
FreeQ[{a,b,p},x] && Not[IntegerQ[p]] && ILtQ[n,0] && BinomialQ[v,x] && Not[LinearQ[v,x]]


(* ::Code:: *)
Int[u_.*(a_.+b_.*x_^m_.*v_^n_)^p_,x_Symbol] :=
  (a+b*x^m*v^n)^FracPart[p]/(v^(n*FracPart[p])*(b*x^m+a*v^(-n))^FracPart[p]) \[Star] Int[u*v^(n*p)*(b*x^m+a*v^(-n))^p,x] /;
FreeQ[{a,b,m,p},x] && Not[IntegerQ[p]] && ILtQ[n,0] && BinomialQ[v,x]


(* ::Code:: *)
Int[u_.*(a_.*x_^r_.+b_.*x_^s_.)^m_,x_Symbol] :=
  With[{v=(a*x^r+b*x^s)^FracPart[m]/(x^(r*FracPart[m])*(a+b*x^(s-r))^FracPart[m])},
  v \[Star] Int[u*x^(m*r)*(a+b*x^(s-r))^m,x] /;
 NeQ[Simplify[v],1]] /;
FreeQ[{a,b,m,r,s},x] && Not[IntegerQ[m]] && PosQ[s-r]


(* ::Code:: *)
Int[u_/(a_+b_.*x_^n_),x_Symbol] :=
  With[{v=RationalFunctionExpand[u/(a+b*x^n),x]},
  Int[v,x] /;
 SumQ[v]] /;
FreeQ[{a,b},x] && IGtQ[n,0]


(* ::Code:: *)
Int[u_*(a_.+b_.*x_^n_.+c_.*x_^n2_.)^p_.,x_Symbol] :=
  1/(4^p*c^p) \[Star] Int[u*(b+2*c*x^n)^(2*p),x] /;
FreeQ[{a,b,c,n},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] && IntegerQ[p] && Not[AlgebraicFunctionQ[u,x]]


(* ::Code:: *)
Int[u_*(a_.+b_.*x_^n_.+c_.*x_^n2_.)^p_,x_Symbol] :=
  (a+b*x^n+c*x^(2*n))^p/(b+2*c*x^n)^(2*p) \[Star] Int[u*(b+2*c*x^n)^(2*p),x] /;
FreeQ[{a,b,c,n,p},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] && Not[IntegerQ[p]] && Not[AlgebraicFunctionQ[u,x]]


(* ::Code:: *)
Int[u_/(a_.+b_.*x_^n_.+c_.*x_^n2_.),x_Symbol] :=
  With[{v=RationalFunctionExpand[u/(a+b*x^n+c*x^(2*n)),x]},
  Int[v,x] /;
 SumQ[v]] /;
FreeQ[{a,b,c},x] && EqQ[n2,2*n] && IGtQ[n,0]


(* ::Code:: *)
Int[u_./(a_.*x_^m_.+b_.*Sqrt[c_.*x_^n_]),x_Symbol] :=
  Int[u*(a*x^m-b*Sqrt[c*x^n])/(a^2*x^(2*m)-b^2*c*x^n),x] /;
FreeQ[{a,b,c,m,n},x]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfLinear[u,x]},
  ShowStep["","Int[F[a+b*x],x]","Subst[Int[F[x],x],x,a+b*x]/b",Hold[
  1/lst[[3]] \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]+lst[[3]]*x]]] /;
 Not[FalseQ[lst]]] /;
SimplifyFlag,

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfLinear[u,x]},
  1/lst[[3]] \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]+lst[[3]]*x] /;
 Not[FalseQ[lst]]]]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_/x_,x_Symbol] :=
  With[{lst=PowerVariableExpn[u,0,x]},
  ShowStep["","Int[F[(c*x)^n]/x,x]","Subst[Int[F[x]/x,x],x,(c*x)^n]/n",Hold[
  1/lst[[2]] \[Star] Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x],x],x],x,(lst[[3]]*x)^lst[[2]]]]] /;
 Not[FalseQ[lst]] && NeQ[lst[[2]],0]] /;
SimplifyFlag && NonsumQ[u] && Not[RationalFunctionQ[u,x]],

Int[u_/x_,x_Symbol] :=
  With[{lst=PowerVariableExpn[u,0,x]},
  1/lst[[2]] \[Star] Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x],x],x],x,(lst[[3]]*x)^lst[[2]]] /;
 Not[FalseQ[lst]] && NeQ[lst[[2]],0]] /;
NonsumQ[u] && Not[RationalFunctionQ[u,x]]]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_*x_^m_.,x_Symbol] :=
  With[{lst=PowerVariableExpn[u,m+1,x]},
  ShowStep["If g=GCD[m+1,n]>1,","Int[x^m*F[x^n],x]",
		"1/g \[Star] Subst[Int[x^((m+1)/g-1)*F[x^(n/g)],x],x,x^g]",Hold[
  1/lst[[2]] \[Star] Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x],x],x],x,(lst[[3]]*x)^lst[[2]]]]] /;
 Not[FalseQ[lst]] && NeQ[lst[[2]],m+1]] /;
SimplifyFlag && IntegerQ[m] && NeQ[m,-1] && NonsumQ[u] && (GtQ[m,0] || Not[AlgebraicFunctionQ[u,x]]),

Int[u_*x_^m_.,x_Symbol] :=
  With[{lst=PowerVariableExpn[u,m+1,x]},
  1/lst[[2]] \[Star] Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x],x],x],x,(lst[[3]]*x)^lst[[2]]] /;
 Not[FalseQ[lst]] && NeQ[lst[[2]],m+1]] /;
IntegerQ[m] && NeQ[m,-1] && NonsumQ[u] && (GtQ[m,0] || Not[AlgebraicFunctionQ[u,x]])]


(* ::Code:: *)
Int[x_^m_*Fx_,x_Symbol] :=
  With[{k=Denominator[m]},
  k \[Star] Subst[Int[x^(k*(m+1)-1)*SubstPower[Fx,x,k],x],x,x^(1/k)]] /;
FractionQ[m]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfSquareRootOfQuadratic[u,x]},
  ShowStep["","Int[F[Sqrt[a+b*x+c*x^2],x],x]",
			"2 \[Star] Subst[Int[F[(c*Sqrt[a]-b*x+Sqrt[a]*x^2)/(c-x^2),(-b+2*Sqrt[a]*x)/(c-x^2)]*
				(c*Sqrt[a]-b*x+Sqrt[a]*x^2)/(c-x^2)^2,x],x,(-Sqrt[a]+Sqrt[a+b*x+c*x^2])/x]",
			Hold[2 \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]]]] /;
 Not[FalseQ[lst]] && EqQ[lst[[3]],1]] /;
SimplifyFlag && EulerIntegrandQ[u,x],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfSquareRootOfQuadratic[u,x]},
  2 \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]] /;
 Not[FalseQ[lst]] && EqQ[lst[[3]],1]] /;
EulerIntegrandQ[u,x]]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfSquareRootOfQuadratic[u,x]},
  ShowStep["","Int[F[Sqrt[a+b*x+c*x^2],x],x]",
			"2 \[Star] Subst[Int[F[(a*Sqrt[c]+b*x+Sqrt[c]*x^2)/(b+2*Sqrt[c]*x),(-a+x^2)/(b+2*Sqrt[c]*x)]*
				(a*Sqrt[c]+b*x+Sqrt[c]*x^2)/(b+2*Sqrt[c]*x)^2,x],x,Sqrt[c]*x+Sqrt[a+b*x+c*x^2]]",
			Hold[2 \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]]]] /;
 Not[FalseQ[lst]] && EqQ[lst[[3]],2]] /;
SimplifyFlag && EulerIntegrandQ[u,x],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfSquareRootOfQuadratic[u,x]},
  2 \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]] /;
 Not[FalseQ[lst]] && EqQ[lst[[3]],2]] /;
EulerIntegrandQ[u,x]]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfSquareRootOfQuadratic[u,x]},
  ShowStep["","Int[F[Sqrt[a+b*x+c*x^2],x],x]",
		   "-2*Sqrt[b^2-4*a*c] \[Star] Subst[Int[F[-Sqrt[b^2-4*a*c]*x/(c-x^2),
			  (b*c+c*Sqrt[b^2-4*a*c]+(-b+Sqrt[b^2-4*a*c])*x^2)/(-2*c*(c-x^2))]*x/(c-x^2)^2,x],
			   x,2*c*Sqrt[a+b*x+c*x^2]/(b-Sqrt[b^2-4*a*c]+2*c*x)]",
		   Hold[2 \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]]]] /;
 Not[FalseQ[lst]] && EqQ[lst[[3]],3]] /;
SimplifyFlag && EulerIntegrandQ[u,x],

Int[u_,x_Symbol] :=
  With[{lst=FunctionOfSquareRootOfQuadratic[u,x]},
  2 \[Star] Subst[Int[lst[[1]],x],x,lst[[2]]] /;
 Not[FalseQ[lst]] && EqQ[lst[[3]],3]] /;
EulerIntegrandQ[u,x]]


(* ::Code:: *)
Int[1/(a_+b_.*v_^2),x_Symbol] :=
(*1/(2*a) \[Star] Int[Together[1/(1-Rt[-b/a,2]*v)],x] + 1/(2*a) \[Star] Int[Together[1/(1+Rt[-b/a,2]*v)],x] /; *)
  1/(2*a) \[Star] Int[Together[1/(1-v/Rt[-a/b,2])],x] + 1/(2*a) \[Star] Int[Together[1/(1+v/Rt[-a/b,2])],x] /;
FreeQ[{a,b},x]


(* ::Code:: *)
Int[1/(a_+b_.*v_^n_),x_Symbol] :=
  2/(a*n) \[Star] Sum[Int[Together[1/(1-v^2/((-1)^(4*k/n)*Rt[-a/b,n/2]))],x],{k,1,n/2}] /;
FreeQ[{a,b},x] && IGtQ[n/2,1]


(* ::Code:: *)
Int[1/(a_+b_.*v_^n_),x_Symbol] :=
  1/(a*n) \[Star] Sum[Int[Together[1/(1-v/((-1)^(2*k/n)*Rt[-a/b,n]))],x],{k,1,n}] /;
FreeQ[{a,b},x] && IGtQ[(n-1)/2,0]


(* ::Code:: *)
Int[v_/(a_+b_.*u_^n_.),x_Symbol] :=
  Int[ReplaceAll[ExpandIntegrand[PolynomialInSubst[v,u,x]/(a+b*x^n),x],x->u],x] /;
FreeQ[{a,b},x] && IGtQ[n,0] && PolynomialInQ[v,u,x]


(* ::Code:: *)
Int[u_,x_Symbol] :=
  With[{v=NormalizeIntegrand[u,x]},
  Int[v,x] /;
 v=!=u]


(* ::Code:: *)
Int[u_,x_Symbol] :=
  With[{v=ExpandIntegrand[u,x]},
  Int[v,x] /;
 SumQ[v]]


(* ::Code:: *)
Int[u_.*(a_.+b_.*x_^m_.)^p_.*(c_.+d_.*x_^n_.)^q_., x_Symbol] :=
  (a+b*x^m)^p*(c+d*x^n)^q/x^(m*p) \[Star] Int[u*x^(m*p),x] /;
FreeQ[{a,b,c,d,m,n,p,q},x] && EqQ[a+d,0] && EqQ[b+c,0] && EqQ[m+n,0] && EqQ[p+q,0]


(* ::Code:: *)
Int[u_*(a_+b_.*x_^n_.+c_.*x_^n2_.)^p_, x_Symbol] :=
  Sqrt[a+b*x^n+c*x^(2*n)]/((4*c)^(p-1/2)*(b+2*c*x^n)) \[Star] Int[u*(b+2*c*x^n)^(2*p),x] /;
FreeQ[{a,b,c,n,p},x] && EqQ[n2,2*n] && EqQ[b^2-4*a*c,0] && IntegerQ[p-1/2]


(* ::Code:: *)
If[TrueQ[$LoadShowSteps],

Int[u_,x_Symbol] :=
  With[{lst=SubstForFractionalPowerOfLinear[u,x]},
  ShowStep["","Int[F[(a+b*x)^(1/n),x],x]",
			"n/b \[Star] Subst[Int[x^(n-1)*F[x,-a/b+x^n/b],x],x,(a+b*x)^(1/n)]",Hold[
  lst[[2]]*lst[[4]] \[Star] Subst[Int[lst[[1]],x],x,lst[[3]]^(1/lst[[2]])]]] /;
 Not[FalseQ[lst]]] /;
SimplifyFlag,

Int[u_,x_Symbol] :=
  With[{lst=SubstForFractionalPowerOfLinear[u,x]},
  lst[[2]]*lst[[4]] \[Star] Subst[Int[lst[[1]],x],x,lst[[3]]^(1/lst[[2]])] /;
 Not[FalseQ[lst]]]]


(* ::Code:: *)
Int[u_,x_] := CannotIntegrate[u,x]




(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.3 Piecewise linear functions.m
*)

(* ::Subsection::Closed:: *)
(* 9.3 Piecewise linear functions *)
Int[u_^m_., x_Symbol] := With[{c = Simplify[D[u, x]]}, 1/c*Subst[Int[x^m, x], x, u]] /; FreeQ[m, x] && PiecewiseLinearQ[u, x]
Int[v_/u_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, b*x/a - (b*u - a*v)/a*Int[1/u, x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x]
Int[v_^n_/u_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, v^n/(a*n) - (b*u - a*v)/a*Int[v^(n - 1)/u, x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && GtQ[n, 0] && NeQ[n, 1]
Int[1/(u_*v_), x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, b/(b*u - a*v)*Int[1/v, x] - a/(b*u - a*v)*Int[1/u, x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x]
Int[1/(u_*Sqrt[v_]), x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, 2*ArcTan[Sqrt[v]/Rt[(b*u - a*v)/a, 2]]/(a*Rt[(b*u - a*v)/a, 2]) /; NeQ[b*u - a*v, 0] && PosQ[(b*u - a*v)/a]] /; PiecewiseLinearQ[u, v, x]
Int[1/(u_*Sqrt[v_]), x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, -2*ArcTanh[ Sqrt[v]/Rt[-(b*u - a*v)/a, 2]]/(a*Rt[-(b*u - a*v)/a, 2]) /; NeQ[b*u - a*v, 0] && NegQ[(b*u - a*v)/a]] /; PiecewiseLinearQ[u, v, x]
Int[v_^n_/u_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, v^(n + 1)/((n + 1)*(b*u - a*v)) - a*(n + 1)/((n + 1)*(b*u - a*v))*Int[v^(n + 1)/u, x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && LtQ[n, -1]
Int[v_^n_/u_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, v^(n + 1)/((n + 1)*(b*u - a*v))* Hypergeometric2F1[1, n + 1, n + 2, -a*v/(b*u - a*v)] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && Not[IntegerQ[n]]
Int[1/(Sqrt[u_]*Sqrt[v_]), x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, 2/Rt[a*b, 2]*ArcTanh[Rt[a*b, 2]*Sqrt[u]/(a*Sqrt[v])] /; NeQ[b*u - a*v, 0] && PosQ[a*b]] /; PiecewiseLinearQ[u, v, x]
Int[1/(Sqrt[u_]*Sqrt[v_]), x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, 2/Rt[-a*b, 2]*ArcTan[Rt[-a*b, 2]*Sqrt[u]/(a*Sqrt[v])] /; NeQ[b*u - a*v, 0] && NegQ[a*b]] /; PiecewiseLinearQ[u, v, x]
Int[u_^m_*v_^n_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, -u^(m + 1)*v^(n + 1)/((m + 1)*(b*u - a*v)) /; NeQ[b*u - a*v, 0]] /; FreeQ[{m, n}, x] && PiecewiseLinearQ[u, v, x] && EqQ[m + n + 2, 0] && NeQ[m, -1]
Int[u_^m_*v_^n_., x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, u^(m + 1)*v^n/(a*(m + 1)) - b*n/(a*(m + 1))*Int[u^(m + 1)*v^(n - 1), x] /; NeQ[b*u - a*v, 0]] /; FreeQ[{m, n}, x] && PiecewiseLinearQ[u, v, x] (* && NeQ[m+n+2, 0] *) && NeQ[m, -1] && ( LtQ[m, -1] && GtQ[n, 0] && Not[ILtQ[ m + n, -2] && (FractionQ[m] || GeQ[2*n + m + 1, 0])] || IGtQ[n, 0] && IGtQ[m, 0] && LeQ[n, m] || (* ILtQ[n,0] && ILtQ[m,0] && LeQ[n,m] || *) IGtQ[n, 0] && Not[IntegerQ[m]] || ILtQ[m, 0] && Not[IntegerQ[n]])
Int[u_^m_*v_^n_., x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, u^(m + 1)*v^n/(a*(m + n + 1)) - n*(b*u - a*v)/(a*(m + n + 1))*Int[u^m*v^(n - 1), x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && NeQ[m + n + 2, 0] && GtQ[n, 0] && NeQ[m + n + 1, 0] && Not[IGtQ[m, 0] && (Not[IntegerQ[n]] || LtQ[0, m, n])] && Not[ILtQ[m + n, -2]]
Int[u_^m_*v_^n_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, u^(m + 1)*v^n/(a*(m + n + 1)) - n*(b*u - a*v)/(a*(m + n + 1))*Int[u^m*v^Simplify[n - 1], x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && NeQ[m + n + 1, 0] && Not[RationalQ[n]] && SumSimplerQ[n, -1]
Int[u_^m_*v_^n_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, -u^(m + 1)*v^(n + 1)/((m + 1)*(b*u - a*v)) + b*(m + n + 2)/((m + 1)*(b*u - a*v))*Int[u^(m + 1)*v^n, x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && NeQ[m + n + 2, 0] && LtQ[m, -1]
Int[u_^m_*v_^n_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, -u^(m + 1)*v^(n + 1)/((m + 1)*(b*u - a*v)) + b*(m + n + 2)/((m + 1)*(b*u - a*v))* Int[u^Simplify[m + 1]*v^n, x] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && Not[RationalQ[m]] && SumSimplerQ[m, 1]
Int[u_^m_*v_^n_, x_Symbol] := With[{a = Simplify[D[u, x]], b = Simplify[D[v, x]]}, u^m*v^(n + 1)/(b*(n + 1)*(b*u/(b*u - a*v))^m)* Hypergeometric2F1[-m, n + 1, n + 2, -a*v/(b*u - a*v)] /; NeQ[b*u - a*v, 0]] /; PiecewiseLinearQ[u, v, x] && Not[IntegerQ[m]] && Not[IntegerQ[n]]
Int[u_^n_.*Log[a_. + b_.*x_], x_Symbol] := With[{c = Simplify[D[u, x]]}, u^n*(a + b*x)*Log[a + b*x]/b - Int[u^n, x] - c*n/b*Int[u^(n - 1)*(a + b*x)*Log[a + b*x], x]] /; FreeQ[{a, b}, x] && PiecewiseLinearQ[u, x] && Not[LinearQ[u, x]] && GtQ[n, 0]
(* Int[u_^n_.*Log[a_.+b_.*x_]/(a_.+b_.*x_),x_Symbol] := With[{c=Simplify[D[u,x]]}, u^n*Log[a+b*x]^2/(2*b) - c*n/(2*b)*Int[u^(n-1)*Log[a+b*x]^2,x]] /; FreeQ[{a,b},x] && PiecewiseLinearQ[u,x] && GtQ[n,0] *)
Int[u_^n_.*(a_. + b_.*x_)^m_.*Log[a_. + b_.*x_], x_Symbol] := With[{c = Simplify[D[u, x]]}, u^n*(a + b*x)^(m + 1)*Log[a + b*x]/(b*(m + 1)) - 1/(m + 1)*Int[u^n*(a + b*x)^m, x] - c*n/(b*(m + 1))* Int[u^(n - 1)*(a + b*x)^(m + 1)*Log[a + b*x], x]] /; FreeQ[{a, b, m}, x] && PiecewiseLinearQ[u, x] && Not[LinearQ[u, x]] && GtQ[n, 0] && NeQ[m, -1]

(*FILE: 
Rubi/IntegrationRules/9 Miscellaneous/9.4 Miscellaneous integration rules.m
*)

(* ::Subsection::Closed:: *)
(* 9.4 Miscellaneous integration rules *)
Int[(a_. + b_.*F_[c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]])^ n_./(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := 2*e*g/(C*(e*f - d*g))* Subst[Int[(a + b*F[c*x])^n/x, x], x, Sqrt[d + e*x]/Sqrt[f + g*x]] /; FreeQ[{a, b, c, d, e, f, g, A, B, C, F}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[B*e*g - C*(e*f + d*g), 0] && IGtQ[n, 0]
Int[(a_. + b_.*F_[c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]])^ n_./(A_. + C_.*x_^2), x_Symbol] := 2*e*g/(C*(e*f - d*g))* Subst[Int[(a + b*F[c*x])^n/x, x], x, Sqrt[d + e*x]/Sqrt[f + g*x]] /; FreeQ[{a, b, c, d, e, f, g, A, C, F}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[e*f + d*g, 0] && IGtQ[n, 0]
Int[(a_. + b_.*F_[c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]])^ n_/(A_. + B_.*x_ + C_.*x_^2), x_Symbol] := Unintegrable[(a + b*F[c*Sqrt[d + e*x]/Sqrt[f + g*x]])^ n/(A + B*x + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, g, A, B, C, F, n}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[B*e*g - C*(e*f + d*g), 0] && Not[IGtQ[n, 0]]
Int[(a_. + b_.*F_[c_.*Sqrt[d_. + e_.*x_]/Sqrt[f_. + g_.*x_]])^ n_/(A_ + C_.*x_^2), x_Symbol] := Unintegrable[(a + b*F[c*Sqrt[d + e*x]/Sqrt[f + g*x]])^ n/(A + C*x^2), x] /; FreeQ[{a, b, c, d, e, f, g, A, C, F, n}, x] && EqQ[C*d*f - A*e*g, 0] && EqQ[e*f + d*g, 0] && Not[IGtQ[n, 0]]
Int[u_/y_, x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Log[RemoveContent[y, x]] /; Not[FalseQ[q]]]
Int[u_/(y_*w_), x_Symbol] := With[{q = DerivativeDivides[y*w, u, x]}, q*Log[RemoveContent[y*w, x]] /; Not[FalseQ[q]]]
Int[u_*y_^m_., x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*y^(m + 1)/(m + 1) /; Not[FalseQ[q]]] /; FreeQ[m, x] && NeQ[m, -1]
Int[u_*y_^m_.*z_^n_., x_Symbol] := With[{q = DerivativeDivides[y*z, u*z^(n - m), x]}, q*y^(m + 1)*z^(m + 1)/(m + 1) /; Not[FalseQ[q]]] /; FreeQ[{m, n}, x] && NeQ[m, -1]
Int[u_, x_Symbol] := With[{v = SimplifyIntegrand[u, x]}, Int[v, x] /; SimplerIntegrandQ[v, u, x]]
Int[u_.*(e_.*Sqrt[a_. + b_.*x_^n_.] + f_.*Sqrt[c_. + d_.*x_^n_.])^m_, x_Symbol] := (a*e^2 - c*f^2)^m* Int[ExpandIntegrand[u*(e*Sqrt[a + b*x^n] - f*Sqrt[c + d*x^n])^(-m), x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && ILtQ[m, 0] && EqQ[b*e^2 - d*f^2, 0]
Int[u_.*(e_.*Sqrt[a_. + b_.*x_^n_.] + f_.*Sqrt[c_. + d_.*x_^n_.])^m_, x_Symbol] := (b*e^2 - d*f^2)^m* Int[ExpandIntegrand[ u*x^(m*n)*(e*Sqrt[a + b*x^n] - f*Sqrt[c + d*x^n])^(-m), x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && ILtQ[m, 0] && EqQ[a*e^2 - c*f^2, 0]
Int[u_^m_.*(a_.*u_^n_ + v_)^p_.*w_, x_Symbol] := Int[u^(m + n*p)*(a + u^(-n)*v)^p*w, x] /; FreeQ[{a, m, n}, x] && IntegerQ[p] && Not[GtQ[n, 0]] && Not[FreeQ[v, x]]
Int[u_*(a_. + b_.*y_)^m_.*(c_. + d_.*v_)^n_., x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(a + b*x)^m*(c + d*x)^n, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[v, y]
Int[u_*(a_. + b_.*y_)^m_.*(c_. + d_.*v_)^n_.*(e_. + f_.*w_)^p_., x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[v, y] && EqQ[w, y]
Int[u_*(a_. + b_.*y_)^m_.*(c_. + d_.*v_)^n_.*(e_. + f_.*w_)^ p_.*(g_. + h_.*z_)^q_., x_Symbol] := With[{r = DerivativeDivides[y, u, x]}, r*Subst[Int[(a + b*x)^m*(c + d*x)^n*(e + f*x)^p*(g + h*x)^q, x], x, y] /; Not[FalseQ[r]]] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p, q}, x] && EqQ[v, y] && EqQ[w, y] && EqQ[z, y]
Int[u_.*(a_ + b_.*y_^n_), x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, a*Int[u, x] + b*q*Subst[Int[x^n, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, n}, x]
Int[u_.*(a_. + b_.*y_^n_)^p_, x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(a + b*x^n)^p, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, n, p}, x]
Int[u_.*v_^m_.*(a_. + b_.*y_^n_)^p_., x_Symbol] := Module[{q, r}, q*r*Subst[Int[x^m*(a + b*x^n)^p, x], x, y] /; Not[FalseQ[r = Divides[y^m, v^m, x]]] && Not[FalseQ[q = DerivativeDivides[y, u, x]]]] /; FreeQ[{a, b, m, n, p}, x]
Int[u_.*(a_. + b_.*y_^n_ + c_.*v_^n2_.)^p_, x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(a + b*x^n + c*x^(2*n))^p, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && EqQ[v, y]
Int[u_.*(A_ + B_.*y_^n_) (a_. + b_.*v_^n_ + c_.*w_^n2_.)^p_., x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(A + B*x^n)*(a + b*x^n + c*x^(2*n))^p, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, c, A, B, n, p}, x] && EqQ[n2, 2*n] && EqQ[v, y] && EqQ[w, y]
Int[u_.*(A_ + B_.*y_^n_) (a_. + c_.*w_^n2_.)^p_., x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(A + B*x^n)*(a + c*x^(2*n))^p, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, c, A, B, n, p}, x] && EqQ[n2, 2*n] && EqQ[w, y]
Int[u_.*v_^m_.*(a_. + b_.*y_^n_ + c_.*w_^n2_.)^p_., x_Symbol] := Module[{q, r}, q*r*Subst[Int[x^m*(a + b*x^n + c*x^(2*n))^p, x], x, y] /; Not[FalseQ[r = Divides[y^m, v^m, x]]] && Not[FalseQ[q = DerivativeDivides[y, u, x]]]] /; FreeQ[{a, b, c, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[w, y]
Int[u_.*z_^m_.*(A_ + B_.*y_^n_)*(a_. + b_.*v_^n_ + c_.*w_^n2_.)^p_., x_Symbol] := Module[{q, r}, q*r* Subst[Int[x^m*(A + B*x^n)*(a + b*x^n + c*x^(2*n))^p, x], x, y] /; Not[FalseQ[r = Divides[y^m, z^m, x]]] && Not[FalseQ[q = DerivativeDivides[y, u, x]]]] /; FreeQ[{a, b, c, A, B, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[v, y] && EqQ[w, y]
Int[u_.*z_^m_.*(A_ + B_.*y_^n_)*(a_. + c_.*w_^n2_.)^p_., x_Symbol] := Module[{q, r}, q*r*Subst[Int[x^m*(A + B*x^n)*(a + c*x^(2*n))^p, x], x, y] /; Not[FalseQ[r = Divides[y^m, z^m, x]]] && Not[FalseQ[q = DerivativeDivides[y, u, x]]]] /; FreeQ[{a, c, A, B, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[w, y]
Int[u_.*(a_. + b_.*y_^n_)^m_.*(c_. + d_.*v_^n_)^p_., x_Symbol] := With[{q = DerivativeDivides[y, u, x]}, q*Subst[Int[(a + b*x^n)^m*(c + d*x^n)^p, x], x, y] /; Not[FalseQ[q]]] /; FreeQ[{a, b, c, d, m, n, p}, x] && EqQ[v, y]
Int[u_.*(a_. + b_.*y_^n_)^m_.*(c_. + d_.*v_^n_)^p_.*(e_. + f_.*w_^n_)^ q_., x_Symbol] := With[{r = DerivativeDivides[y, u, x]}, r*Subst[Int[(a + b*x^n)^m*(c + d*x^n)^p*(e + f*x^n)^q, x], x, y] /; Not[FalseQ[r]]] /; FreeQ[{a, b, c, d, e, f, m, n, p, q}, x] && EqQ[v, y] && EqQ[w, y]
Int[u_*F_^v_, x_Symbol] := With[{q = DerivativeDivides[v, u, x]}, q*F^v/Log[F] /; Not[FalseQ[q]]] /; FreeQ[F, x]
Int[u_*w_^m_.*F_^v_, x_Symbol] := With[{q = DerivativeDivides[v, u, x]}, q*Subst[Int[x^m*F^x, x], x, v] /; Not[FalseQ[q]]] /; FreeQ[{F, m}, x] && EqQ[w, v]
Int[u_*(a_ + b_.*v_^p_.*w_^p_.)^m_., x_Symbol] := With[{c = Simplify[u/(w*D[v, x] + v*D[w, x])]}, c*Subst[Int[(a + b*x^p)^m, x], x, v*w] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p}, x] && IntegerQ[p]
Int[u_*(a_ + b_.*v_^p_.*w_^q_.)^m_.*v_^r_., x_Symbol] := With[{c = Simplify[u/(p*w*D[v, x] + q*v*D[w, x])]}, c*p/(r + 1)* Subst[Int[(a + b*x^(p/(r + 1)))^m, x], x, v^(r + 1)*w] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p, q, r}, x] && EqQ[p, q*(r + 1)] && NeQ[r, -1] && IntegerQ[p/(r + 1)]
Int[u_*(a_ + b_.*v_^p_.*w_^q_.)^m_.*v_^r_.*w_^s_., x_Symbol] := With[{c = Simplify[u/(p*w*D[v, x] + q*v*D[w, x])]}, c*p/(r + 1)* Subst[Int[(a + b*x^(p/(r + 1)))^m, x], x, v^(r + 1)*w^(s + 1)] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p, q, r, s}, x] && EqQ[p*(s + 1), q*(r + 1)] && NeQ[r, -1] && IntegerQ[p/(r + 1)]
Int[u_*(a_.*v_^p_. + b_.*w_^q_.)^m_., x_Symbol] := With[{c = Simplify[u/(p*w*D[v, x] - q*v*D[w, x])]}, c*p*Subst[Int[(b + a*x^p)^m, x], x, v*w^(m*q + 1)] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p, q}, x] && EqQ[p + q*(m*p + 1), 0] && IntegerQ[p] && IntegerQ[m]
(* Int[u_*(a_.*v_^p_.+b_.*w_^q_.)^m_.,x_Symbol] := With[{c=Simplify[u/(p*w*D[v,x]-q*v*D[w,x])]}, -c*q*Subst[Int[(a+b*x^q)^m,x],x,v^(m*p+1)*w] /; FreeQ[c,x]] /; FreeQ[{a,b,m,p,q},x] && EqQ[p+q*(m*p+1),0] && IntegerQ[q] &&  IntegerQ[m] *)
Int[u_*(a_.*v_^p_. + b_.*w_^q_.)^m_.*v_^r_., x_Symbol] := With[{c = Simplify[u/(p*w*D[v, x] - q*v*D[w, x])]}, -c*q*Subst[Int[(a + b*x^q)^m, x], x, v^(m*p + r + 1)*w] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p, q, r}, x] && EqQ[p + q*(m*p + r + 1), 0] && IntegerQ[q] && IntegerQ[m]
Int[u_*(a_.*v_^p_. + b_.*w_^q_.)^m_.*w_^s_., x_Symbol] := With[{c = Simplify[u/(p*w*D[v, x] - q*v*D[w, x])]}, -c*q/(s + 1)* Subst[Int[(a + b*x^(q/(s + 1)))^m, x], x, v^(m*p + 1)*w^(s + 1)] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p, q, s}, x] && EqQ[p*(s + 1) + q*(m*p + 1), 0] && NeQ[s, -1] && IntegerQ[q/(s + 1)] && IntegerQ[m]
Int[u_*(a_.*v_^p_. + b_.*w_^q_.)^m_.*v_^r_.*w_^s_., x_Symbol] := With[{c = Simplify[u/(p*w*D[v, x] - q*v*D[w, x])]}, -c*q/(s + 1)* Subst[Int[(a + b*x^(q/(s + 1)))^m, x], x, v^(m*p + r + 1)*w^(s + 1)] /; FreeQ[c, x]] /; FreeQ[{a, b, m, p, q, r, s}, x] && EqQ[p*(s + 1) + q*(m*p + r + 1), 0] && NeQ[s, -1] && IntegerQ[q/(s + 1)] && IntegerQ[m]
Int[u_*x_^m_., x_Symbol] := 1/(m + 1)*Subst[Int[SubstFor[x^(m + 1), u, x], x], x, x^(m + 1)] /; FreeQ[m, x] && NeQ[m, -1] && FunctionOfQ[x^(m + 1), u, x]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = SubstForFractionalPowerOfLinear[u, x]}, ShowStep["", "Int[F[(a+b*x)^(1/n),x],x]", "n/b*Subst[Int[x^(n-1)*F[x,-a/b+x^n/b],x],x,(a+b*x)^(1/n)]", Hold[ lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])]]] /; Not[FalseQ[lst]] && SubstForFractionalPowerQ[u, lst[[3]], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{lst = SubstForFractionalPowerOfLinear[u, x]}, lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])] /; Not[FalseQ[lst]] && SubstForFractionalPowerQ[u, lst[[3]], x]]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = SubstForFractionalPowerOfQuotientOfLinears[u, x]}, ShowStep["", "Int[F[((a+b*x)/(c+d*x))^(1/n),x],x]", "n*(b*c-a*d)*Subst[Int[x^(n-1)*F[x,(-a+c*x^n)/(b-d*x^n)]/(b-d*x^ n)^2,x],x,((a+b*x)/(c+d*x))^(1/n)]", Hold[ lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])]]] /; Not[FalseQ[lst]]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{lst = SubstForFractionalPowerOfQuotientOfLinears[u, x]}, lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])] /; Not[FalseQ[lst]]]]
Int[u_.*(a_.*v_^m_.*w_^n_.*z_^q_.)^p_, x_Symbol] := a^IntPart[p]*(a*v^m*w^n*z^q)^ FracPart[p]/(v^(m*FracPart[p])*w^(n*FracPart[p])* z^(q*FracPart[p]))*Int[u*v^(m*p)*w^(n*p)*z^(p*q), x] /; FreeQ[{a, m, n, p, q}, x] && Not[IntegerQ[p]] && Not[FreeQ[v, x]] && Not[FreeQ[w, x]] && Not[FreeQ[z, x]]
Int[u_.*(a_.*v_^m_.*w_^n_.)^p_, x_Symbol] := a^IntPart[p]*(a*v^m*w^n)^ FracPart[p]/(v^(m*FracPart[p])*w^(n*FracPart[p]))* Int[u*v^(m*p)*w^(n*p), x] /; FreeQ[{a, m, n, p}, x] && Not[IntegerQ[p]] && Not[FreeQ[v, x]] && Not[FreeQ[w, x]]
Int[u_.*(a_.*v_^m_.)^p_, x_Symbol] := a^IntPart[p]*(a*v^m)^FracPart[p]/v^(m*FracPart[p])* Int[u*v^(m*p), x] /; FreeQ[{a, m, p}, x] && Not[IntegerQ[p]] && Not[FreeQ[v, x]] && Not[EqQ[a, 1] && EqQ[m, 1]] && Not[EqQ[v, x] && EqQ[m, 1]]
Int[u_.*(a_. + b_.*x_^n_)^p_, x_Symbol] := b^IntPart[p]*(a + b*x^n)^ FracPart[p]/(x^(n*FracPart[p])*(1 + a*x^(-n)/b)^FracPart[p])* Int[u*x^(n*p)*(1 + a*x^(-n)/b)^p, x] /; FreeQ[{a, b, p}, x] && Not[IntegerQ[p]] && ILtQ[n, 0] && Not[RationalFunctionQ[u, x]] && IntegerQ[p + 1/2]
Int[u_.*(a_. + b_.*v_^n_)^p_, x_Symbol] := (a + b*v^n)^ FracPart[p]/(v^(n*FracPart[p])*(b + a*v^(-n))^FracPart[p])* Int[u*v^(n*p)*(b + a*v^(-n))^p, x] /; FreeQ[{a, b, p}, x] && Not[IntegerQ[p]] && ILtQ[n, 0] && BinomialQ[v, x] && Not[LinearQ[v, x]]
Int[u_.*(a_. + b_.*x_^m_.*v_^n_)^p_, x_Symbol] := (a + b*x^m*v^n)^ FracPart[p]/(v^(n*FracPart[p])*(b*x^m + a*v^(-n))^FracPart[p])* Int[u*v^(n*p)*(b*x^m + a*v^(-n))^p, x] /; FreeQ[{a, b, m, p}, x] && Not[IntegerQ[p]] && ILtQ[n, 0] && BinomialQ[v, x]
Int[u_.*(a_.*x_^r_. + b_.*x_^s_.)^m_, x_Symbol] := With[{v = (a*x^r + b*x^s)^ FracPart[ m]/(x^(r*FracPart[m])*(a + b*x^(s - r))^FracPart[m])}, v*Int[u*x^(m*r)*(a + b*x^(s - r))^m, x] /; NeQ[Simplify[v], 1]] /; FreeQ[{a, b, m, r, s}, x] && Not[IntegerQ[m]] && PosQ[s - r]
Int[u_/(a_ + b_.*x_^n_), x_Symbol] := With[{v = RationalFunctionExpand[u/(a + b*x^n), x]}, Int[v, x] /; SumQ[v]] /; FreeQ[{a, b}, x] && IGtQ[n, 0]
Int[u_*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^p_., x_Symbol] := 1/(4^p*c^p)*Int[u*(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p] && Not[AlgebraicFunctionQ[u, x]]
Int[u_*(a_. + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := (a + b*x^n + c*x^(2*n))^p/(b + 2*c*x^n)^(2*p)* Int[u*(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]] && Not[AlgebraicFunctionQ[u, x]]
Int[u_/(a_. + b_.*x_^n_. + c_.*x_^n2_.), x_Symbol] := With[{v = RationalFunctionExpand[u/(a + b*x^n + c*x^(2*n)), x]}, Int[v, x] /; SumQ[v]] /; FreeQ[{a, b, c}, x] && EqQ[n2, 2*n] && IGtQ[n, 0]
Int[u_./(a_.*x_^m_. + b_.*Sqrt[c_.*x_^n_]), x_Symbol] := Int[u*(a*x^m - b*Sqrt[c*x^n])/(a^2*x^(2*m) - b^2*c*x^n), x] /; FreeQ[{a, b, c, m, n}, x]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = FunctionOfLinear[u, x]}, ShowStep["", "Int[F[a+b*x],x]", "Subst[Int[F[x],x],x,a+b*x]/b", Hold[ Dist[1/lst[[3]], Subst[Int[lst[[1]], x], x, lst[[2]] + lst[[3]]*x], x]]] /; Not[FalseQ[lst]]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{lst = FunctionOfLinear[u, x]}, Dist[1/lst[[3]], Subst[Int[lst[[1]], x], x, lst[[2]] + lst[[3]]*x], x] /; Not[FalseQ[lst]]]]
If[TrueQ[$LoadShowSteps], Int[u_/x_, x_Symbol] := With[{lst = PowerVariableExpn[u, 0, x]}, ShowStep["", "Int[F[(c*x)^n]/x,x]", "Subst[Int[F[x]/x,x],x,(c*x)^n]/n", Hold[ 1/lst[[2]]* Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x], x], x], x, (lst[[3]]*x)^lst[[2]]]]] /; Not[FalseQ[lst]] && NeQ[lst[[2]], 0]] /; SimplifyFlag && NonsumQ[u] && Not[RationalFunctionQ[u, x]], Int[u_/x_, x_Symbol] := With[{lst = PowerVariableExpn[u, 0, x]}, 1/lst[[2]]* Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x], x], x], x, (lst[[3]]*x)^lst[[2]]] /; Not[FalseQ[lst]] && NeQ[lst[[2]], 0]] /; NonsumQ[u] && Not[RationalFunctionQ[u, x]]]
If[TrueQ[$LoadShowSteps], Int[u_*x_^m_., x_Symbol] := With[{lst = PowerVariableExpn[u, m + 1, x]}, ShowStep["If g=GCD[m+1,n]>1,", "Int[x^m*F[x^n],x]", "1/g*Subst[Int[x^((m+1)/g-1)*F[x^(n/g)],x],x,x^g]", Hold[ 1/lst[[2]]* Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x], x], x], x, (lst[[3]]*x)^lst[[2]]]]] /; Not[FalseQ[lst]] && NeQ[lst[[2]], m + 1]] /; SimplifyFlag && IntegerQ[m] && NeQ[m, -1] && NonsumQ[u] && (GtQ[m, 0] || Not[AlgebraicFunctionQ[u, x]]), Int[u_*x_^m_., x_Symbol] := With[{lst = PowerVariableExpn[u, m + 1, x]}, 1/lst[[2]]* Subst[Int[NormalizeIntegrand[Simplify[lst[[1]]/x], x], x], x, (lst[[3]]*x)^lst[[2]]] /; Not[FalseQ[lst]] && NeQ[lst[[2]], m + 1]] /; IntegerQ[m] && NeQ[m, -1] && NonsumQ[u] && (GtQ[m, 0] || Not[AlgebraicFunctionQ[u, x]])]
Int[x_^m_*u_, x_Symbol] := With[{k = Denominator[m]}, k*Subst[Int[x^(k*(m + 1) - 1)*ReplaceAll[u, x -> x^k], x], x, x^(1/k)]] /; FractionQ[m]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = FunctionOfSquareRootOfQuadratic[u, x]}, ShowStep["", "Int[F[Sqrt[a+b*x+c*x^2],x],x]", "2*Subst[Int[F[(c*Sqrt[a]-b*x+Sqrt[a]*x^2)/(c-x^2),(-b+2*Sqrt[a] *x)/(c-x^2)]* (c*Sqrt[a]-b*x+Sqrt[a]*x^2)/(c-x^2)^2,x],x,(-Sqrt[a]+Sqrt[a+b*x+c* x^2])/x]", Hold[2*Subst[Int[lst[[1]], x], x, lst[[2]]]]] /; Not[FalseQ[lst]] && EqQ[lst[[3]], 1]] /; SimplifyFlag && EulerIntegrandQ[u, x], Int[u_, x_Symbol] := With[{lst = FunctionOfSquareRootOfQuadratic[u, x]}, 2*Subst[Int[lst[[1]], x], x, lst[[2]]] /; Not[FalseQ[lst]] && EqQ[lst[[3]], 1]] /; EulerIntegrandQ[u, x]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = FunctionOfSquareRootOfQuadratic[u, x]}, ShowStep["", "Int[F[Sqrt[a+b*x+c*x^2],x],x]", "2*Subst[Int[F[(a*Sqrt[c]+b*x+Sqrt[c]*x^2)/(b+2*Sqrt[c]*x),(-a+ x^2)/(b+2*Sqrt[c]*x)]* (a*Sqrt[c]+b*x+Sqrt[c]*x^2)/(b+2*Sqrt[c]*x)^2,x],x,Sqrt[c]*x+Sqrt[ a+b*x+c*x^2]]", Hold[2*Subst[Int[lst[[1]], x], x, lst[[2]]]]] /; Not[FalseQ[lst]] && EqQ[lst[[3]], 2]] /; SimplifyFlag && EulerIntegrandQ[u, x], Int[u_, x_Symbol] := With[{lst = FunctionOfSquareRootOfQuadratic[u, x]}, 2*Subst[Int[lst[[1]], x], x, lst[[2]]] /; Not[FalseQ[lst]] && EqQ[lst[[3]], 2]] /; EulerIntegrandQ[u, x]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = FunctionOfSquareRootOfQuadratic[u, x]}, ShowStep["", "Int[F[Sqrt[a+b*x+c*x^2],x],x]", "-2*Sqrt[b^2-4*a*c]*Subst[Int[F[-Sqrt[b^2-4*a*c]*x/(c-x^2), (b*c+c*Sqrt[b^2-4*a*c]+(-b+Sqrt[b^2-4*a*c])*x^2)/(-2*c*(c-x^2))]* x/(c-x^2)^2,x], x,2*c*Sqrt[a+b*x+c*x^2]/(b-Sqrt[b^2-4*a*c]+2*c*x)]", Hold[2*Subst[Int[lst[[1]], x], x, lst[[2]]]]] /; Not[FalseQ[lst]] && EqQ[lst[[3]], 3]] /; SimplifyFlag && EulerIntegrandQ[u, x], Int[u_, x_Symbol] := With[{lst = FunctionOfSquareRootOfQuadratic[u, x]}, 2*Subst[Int[lst[[1]], x], x, lst[[2]]] /; Not[FalseQ[lst]] && EqQ[lst[[3]], 3]] /; EulerIntegrandQ[u, x]]
Int[1/(a_ + b_.*v_^2), x_Symbol] := (*1/(2*a)*Int[Together[1/(1-Rt[-b/a,2]*v)],x] +  1/(2*a)*Int[Together[1/(1+Rt[-b/a,2]*v)],x] /; *) 1/(2*a)*Int[Together[1/(1 - v/Rt[-a/b, 2])], x] + 1/(2*a)*Int[Together[1/(1 + v/Rt[-a/b, 2])], x] /; FreeQ[{a, b}, x]
Int[1/(a_ + b_.*v_^n_), x_Symbol] := Dist[2/(a*n), Sum[Int[Together[1/(1 - v^2/((-1)^(4*k/n)*Rt[-a/b, n/2]))], x], {k, 1, n/2}], x] /; FreeQ[{a, b}, x] && IGtQ[n/2, 1]
Int[1/(a_ + b_.*v_^n_), x_Symbol] := Dist[1/(a*n), Sum[Int[Together[1/(1 - v/((-1)^(2*k/n)*Rt[-a/b, n]))], x], {k, 1, n}], x] /; FreeQ[{a, b}, x] && IGtQ[(n - 1)/2, 0]
Int[v_/(a_ + b_.*u_^n_.), x_Symbol] := Int[ReplaceAll[ ExpandIntegrand[PolynomialInSubst[v, u, x]/(a + b*x^n), x], x -> u], x] /; FreeQ[{a, b}, x] && IGtQ[n, 0] && PolynomialInQ[v, u, x]
Int[u_, x_Symbol] := With[{v = NormalizeIntegrand[u, x]}, Int[v, x] /; v =!= u]
Int[u_, x_Symbol] := With[{v = ExpandIntegrand[u, x]}, Int[v, x] /; SumQ[v]]
Int[u_.*(a_. + b_.*x_^m_.)^p_.*(c_. + d_.*x_^n_.)^q_., x_Symbol] := (a + b*x^m)^p*(c + d*x^n)^q/x^(m*p)*Int[u*x^(m*p), x] /; FreeQ[{a, b, c, d, m, n, p, q}, x] && EqQ[a + d, 0] && EqQ[b + c, 0] && EqQ[m + n, 0] && EqQ[p + q, 0]
Int[u_*(a_ + b_.*x_^n_. + c_.*x_^n2_.)^p_, x_Symbol] := Sqrt[a + b*x^n + c*x^(2*n)]/((4*c)^(p - 1/2)*(b + 2*c*x^n))* Int[u*(b + 2*c*x^n)^(2*p), x] /; FreeQ[{a, b, c, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p - 1/2]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{lst = SubstForFractionalPowerOfLinear[u, x]}, ShowStep["", "Int[F[(a+b*x)^(1/n),x],x]", "n/b*Subst[Int[x^(n-1)*F[x,-a/b+x^n/b],x],x,(a+b*x)^(1/n)]", Hold[ lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])]]] /; Not[FalseQ[lst]]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{lst = SubstForFractionalPowerOfLinear[u, x]}, lst[[2]]*lst[[4]]* Subst[Int[lst[[1]], x], x, lst[[3]]^(1/lst[[2]])] /; Not[FalseQ[lst]]]]
Int[u_, x_] := CannotIntegrate[u, x]

(*FILE: 
Rubi/IntegrationUtilityFunctions.m
*)
(* ::Package:: *)

(* ::Title:: *)
(*Integration Utility Functions*)


$TimeLimit::usage = "$TimeLimit is the time constraint in seconds on some potentially expensive routines.";
If[Not[NumberQ[$TimeLimit]], $TimeLimit=5.0];


(* ::Section::Closed:: *)
(*IntHide[u,x]*)


IntHide::usage = "IntHide[u,x] suppresses the display of steps while integrating u wrt x.";
IntHide[u_,x_Symbol] := 
  Block[{$ShowSteps=False,$StepCounter=Null}, Int[u,x]]


(* ::Section::Closed:: *)
(*Mapping functions*)


(* ::Subsection::Closed:: *)
(*EveryQ[func,lst]*)


EveryQ::usage = "EveryQ[func,lst] applies func to the elements of lst until False is returned and EveryQ returns False; else it returns True.";
EveryQ[func_,lst_] :=
  Catch[Scan[Function[If[func[#],Null,Throw[False]]],lst];True]


(* ::Subsection::Closed:: *)
(*Map2[func,lst1,lst2]*)


Map2[func_,lst1_,lst2_] :=
  Module[{ii},
    ReapList[Do[Sow[func[lst1[[ii]],lst2[[ii]]]],{ii,Length[lst1]}]]]


(* ::Subsection::Closed:: *)
(*ReapList[u]*)


ReapList[u_] :=
  With[{lst=Reap[u][[2]]},
  If[lst==={}, lst, lst[[1]]]]

SetAttributes[ReapList,HoldFirst]


(* ::Section::Closed:: *)
(*Numerical type predicates*)


(* ::Subsection::Closed:: *)
(*FalseQ[u]*)


FalseQ::usage = "If u is False, FalseQ[u] returns True; else it returns False.";
FalseQ[False] = True;
FalseQ[_] = False;


(* ::Subsection::Closed:: *)
(*IntegersQ[u]*)


IntegersQ::usage = "If m, n, ... are explicit integers, IntegersQ[m,n,...] returns True; else it returns False.";
IntegersQ[__Integer] = True;
IntegersQ[__] = False;


(* ::Subsection::Closed:: *)
(*HalfIntegerQ[u]*)


HalfIntegerQ::usage = "If m, n, ... are explicit half-integers, HalfIntegerQ[m,n,...] returns True; else it returns False.";
HalfIntegerQ[u__] := Scan[Function[If[Head[#]===Rational && Denominator[#]==2,Null,Return[False]]],{u}]===Null


(* ::Subsection::Closed:: *)
(*FractionQ[u]*)


FractionQ::usage = "If m, n, ... are explicit fractions, FractionQ[m,n,...] returns True; else it returns False.";
FractionQ[__Rational] = True;
FractionQ[__] = False;


(* ::Subsection::Closed:: *)
(*RationalQ[u]*)


RationalQ::usage = "If m, n, ... are explicit integers or fractions, RationalQ[m,n,...] returns True; else it returns False.";
RationalQ[u__] := Scan[Function[If[IntegerQ[#] || Head[#]===Rational,Null,Return[False]]],{u}]===Null


(* ::Subsection::Closed:: *)
(*ComplexNumberQ[u]*)


ComplexNumberQ::usage = "If u an explicit complex number, ComplexNumberQ[u] returns True; else it returns False.";
ComplexNumberQ[_Complex] = True;
ComplexNumberQ[_] = False;


(* ::Subsection::Closed:: *)
(*FractionOrNegativeQ[u]*)


FractionOrNegativeQ::usage = "If u a fraction or negative number, FractionOrNegativeQ[u] returns True; else it returns False.";
FractionOrNegativeQ[u__] := Scan[Function[If[FractionQ[#] || IntegerQ[#] && #<0,Null,Return[False]]],{u}]===Null


(* ::Subsection::Closed:: *)
(*SqrtNumberQ[u]*)


SqrtNumberQ::usage = "If u is equivalent to the square-root of a rational number, SqrtNumberQ[u] returns True; else it returns False.";
SqrtNumberQ[m_^n_] :=
  IntegerQ[n] && SqrtNumberQ[m] || IntegerQ[n-1/2] && RationalQ[m]


SqrtNumberQ[u_*v_] :=
  SqrtNumberQ[u] && SqrtNumberQ[v]


SqrtNumberQ[u_] :=
  RationalQ[u] || u===I


(* ::Subsection::Closed:: *)
(*SqrtNumberSumQ[u]*)


SqrtNumberSumQ::usage = "If u is equivalent to the sum of square-root numbers, SqrtNumberSumQ[u] returns True; else it returns False.";
SqrtNumberSumQ[u_] :=
  SumQ[u] && SqrtNumberQ[First[u]] && SqrtNumberQ[Rest[u]] || 
  ProductQ[u] && SqrtNumberQ[First[u]] && SqrtNumberSumQ[Rest[u]]


(* ::Subsection::Closed:: *)
(*IndependentQ[u,x]*)


IndependentQ::usage = "If u is independent of x, IndependentQ[u,x] returns True; else it returns False.";
IndependentQ[u_,x_] :=
  FreeQ[u,x]


(* ::Section::Closed:: *)
(*Expression type predicates*)


(* ::Subsection::Closed:: *)
(*PowerQ[u]*)


PowerQ::usage = "If u is a power, PowerQ[u] returns True; else it returns False.";
PowerQ[_Power] = True;
PowerQ[_] = False;


(* ::Subsection::Closed:: *)
(*ProductQ[u]*)


ProductQ::usage = "If u is a product, ProductQ[u] returns True; else it returns False.";
ProductQ[_Times] = True;
ProductQ[_] = False;


(* ::Subsection::Closed:: *)
(*SumQ[u]*)


SumQ::usage = "If u is a sum, SumQ[u] returns True; else it returns False.";
SumQ[_Plus] = True;
SumQ[_] = False;


(* ::Subsection::Closed:: *)
(*NonsumQ[u]*)


NonsumQ::usage = "If u is not a sum, NonsumQ[u] returns True; else it returns False.";
NonsumQ[_Plus] = False;
NonsumQ[_] = True;


(* ::Subsection::Closed:: *)
(*IntegerPowerQ[u]*)


IntegerPowerQ::usage = "If u is an integer power, IntegerPowerQ[u] returns True; else it returns False.";
IntegerPowerQ = Function[Head[#]===Power && IntegerQ[#[[2]]]];


(* ::Subsection::Closed:: *)
(*FractionalPowerQ[u]*)


FractionalPowerQ::usage = "If u is an fractional power, FractionalPowerQ[u] returns True; else it returns False.";
FractionalPowerQ = Function[Head[#]===Power && Head[#[[2]]]===Rational];


(* ::Subsection::Closed:: *)
(*FractionalPowerFreeQ[u]*)


FractionalPowerFreeQ::usage = "If u is free of fractional powers whose bases are not atoms, FractionalPowerFreeQ[u] returns True; else it returns False.";
FractionalPowerFreeQ[u_] :=
  If[AtomQ[u],
    True,
  If[FractionalPowerQ[u] && Not[AtomQ[u[[1]]]],
    False,
  Catch[Scan[Function[If[FractionalPowerFreeQ[#],Null,Throw[False]]],u];True]]]


(* ::Subsection::Closed:: *)
(*ComplexFreeQ[u]*)


ComplexFreeQ::usage = "If u is free of complex numbers, ComplexFreeQ[u] returns True; else it returns False.";
ComplexFreeQ[u_] :=
  If[AtomQ[u],
    Not[ComplexNumberQ[u]],
  Scan[Function[If[ComplexFreeQ[#],Null,Return[False]]],u]===Null]


(* ::Subsection::Closed:: *)
(*LogQ[u]*)


LogQ::usage = "If u is an expression of the form Log[v], LogQ[u] returns True; else it returns False.";
LogQ[u_] := Head[u]===Log


(* ::Subsection::Closed:: *)
(*TrigQ[u]*)


TrigQ::usage = "If u is an expression of the form F[v] where F is a circular trig function, TrigQ[u] returns True; else it returns False.";
$TrigFunctions = {Sin, Cos, Tan, Cot, Sec, Csc};
TrigQ[u_] := MemberQ[$TrigFunctions, If[AtomQ[u],u,Head[u]]]


(* ::Subsection::Closed:: *)
(*HyperbolicQ[u]*)


HyperbolicQ::usage = "If u is an expression of the form F[v] where F is a hyperbolic trig function, HyperbolicQ[u] returns True; else it returns False.";
$HyperbolicFunctions = {Sinh, Cosh, Tanh, Coth, Sech, Csch};
HyperbolicQ[u_] := MemberQ[$HyperbolicFunctions, If[AtomQ[u],u,Head[u]]]


(* ::Subsection::Closed:: *)
(*InverseTrigQ[u]*)


InverseTrigQ::usage = "If u is an expression of the form F[v] where F is an inverse circular trig function, InverseTrigQ[u] returns True; else it returns False.";
$InverseTrigFunctions = {ArcSin, ArcCos, ArcTan, ArcCot, ArcSec, ArcCsc};
InverseTrigQ[u_] := MemberQ[$InverseTrigFunctions, If[AtomQ[u],u,Head[u]]]


(* ::Subsection::Closed:: *)
(*InverseHyperbolicQ[u]*)


InverseHyperbolicQ::usage = "If u is an expression of the form F[v] where F is an inverse hyperbolic trig function, InverseHyperbolicQ[u] returns True; else it returns False.";
$InverseHyperbolicFunctions = {ArcSinh, ArcCosh, ArcTanh, ArcCoth, ArcSech, ArcCsch};
InverseHyperbolicQ[u_] := MemberQ[$InverseHyperbolicFunctions, If[AtomQ[u],u,Head[u]]]


(* ::Subsection::Closed:: *)
(*CalculusQ[u]*)


CalculusQ::usage = "If u involves a calculus function (e.g. D, Integrate or Sum), CalculusQ[u] returns True; else it returns False.";
$CalculusFunctions = {D, Integrate, Sum, Product, Int, Unintegrable, CannotIntegrate, Dif, Subst};
CalculusQ[u_] := MemberQ[$CalculusFunctions, If[AtomQ[u],u,Head[u]]]


HeldFormQ::usage = "If u is a held form (e.g. Hold, Defer or Pattern), HeldFormQ[u] returns True; else it returns False.";
$HeldFunctions = {Hold, HoldForm, Defer, Pattern};
HeldFormQ[u_] :=
  If[AtomQ[Head[u]],
    MemberQ[$HeldFunctions,Head[u]],
  HeldFormQ[Head[u]]]


StopFunctionQ::usage = "If u is a held form or unevaluated integral (e.g. Unintegrable), StopFunctionQ[u] returns True; else it returns False.";
$StopFunctions = {Hold, HoldForm, Defer, Pattern, If, Int, Unintegrable, CannotIntegrate};
StopFunctionQ[u_] :=
  If[AtomQ[Head[u]],
    MemberQ[$StopFunctions,Head[u]],
  StopFunctionQ[Head[u]]]


InverseFunctionQ::usage = "If u is a call on an inverse function, InverseFunctionQ[u] returns True; else it returns False.";
InverseFunctionQ[u_] :=
  LogQ[u] || InverseTrigQ[u] && Length[u]<=1 || InverseHyperbolicQ[u] || Head[u]===Mods  || Head[u]===PolyLog 


TrigHyperbolicFreeQ::usage = "If u is free of trig, hyperbolic and calculus functions involving x, TrigHyperbolicFreeQ[u,x] returns true; else it returns False.";
TrigHyperbolicFreeQ[u_,x_Symbol] :=
  If[AtomQ[u],
    True,
  If[TrigQ[u] || HyperbolicQ[u] || CalculusQ[u],
    FreeQ[u,x],
  Catch[Scan[Function[If[TrigHyperbolicFreeQ[#,x],Null,Throw[False]]],u];True]]]


InverseFunctionFreeQ::usage = "If u is free of inverse, calculus and hypergeometric functions involving x, InverseFunctionFreeQ[u,x] returns true; else it returns False.";
InverseFunctionFreeQ[u_,x_Symbol] :=
  If[AtomQ[u],
    True,
  If[InverseFunctionQ[u] || CalculusQ[u] || Head[u]===Hypergeometric2F1 || Head[u]===AppellF1,
    FreeQ[u,x],
  Catch[Scan[Function[If[InverseFunctionFreeQ[#,x],Null,Throw[False]]],u];True]]]


(* ElementaryExpressionQ::usage = "ElementaryExpressionQ[u] returns True if u is a sum, product, or power and all the operands are elementary expressions; or if u is a call on a trig, hyperbolic, or inverse function and all the arguments are elementary expressions; else it returns False."; *)
(* ElementaryFunctionQ[u_] :=
  If[AtomQ[u],
    True,
  If[SumQ[u] || ProductQ[u] || PowerQ[u] || TrigQ[u] || HyperbolicQ[u] || InverseFunctionQ[u],
    Catch[Scan[Function[If[ElementaryFunctionQ[#],Null,Throw[False]]],u];True],
  False]] *)


(* ::Subsection::Closed:: *)
(*CalculusFreeQ[u,x]*)


CalculusFreeQ::usage = "If u is free of calculus functions whose variable is x, CalculusFreeQ[u,x] returns True; else it returns False.";
CalculusFreeQ[u_,x_] :=
  If[AtomQ[u],
    True,
  If[CalculusQ[u] && u[[2]]===x || HeldFormQ[u],
    False,
  Catch[Scan[Function[If[CalculusFreeQ[#,x],Null,Throw[False]]],u]; True]]]


(* ::Subsection::Closed:: *)
(*IntegralFreeQ[u]*)


IntegralFreeQ::usage = "If u is free of integrals, IntegralFreeQ[u] returns True; else it returns False.";
IntegralFreeQ[u_] :=
  FreeQ[u,Int] && FreeQ[u,Integral] && FreeQ[u,Unintegrable] && FreeQ[u,CannotIntegrate]


(* ::Section::Closed:: *)
(*Equality and inequality predicates*)


(* ::Subsection::Closed:: *)
(*Equality predicates*)


EqQ::usage = "If u-v equals 0, EqQ[u,v] returns True; else it returns False.";
EqQ[u_,v_] := Quiet[PossibleZeroQ[u-v]] || Refine[u==v]===True
EqQ[args___] := Null /; CheckArguments[EqQ[args], 2]


NeQ::usage = "If u-v equals 0, NeQ[u,v] returns False; else it returns True.";
NeQ[u_,v_] := Not[Quiet[PossibleZeroQ[u-v]] || Refine[u==v]===True]
NeQ[args___] := Null /; CheckArguments[NeQ[args], 2]


(* ::Subsection::Closed:: *)
(*Integer inequality predicates*)


IGtQ::usage = "n must be a rational number.  If u is an integer and u>n, IGtQ[u,n] returns True; else it returns False.";
IGtQ[su_,n_] := IntegerQ[u] && u>n
IGtQ[args___] := Null /; CheckArguments[IGtQ[args], 2]


ILtQ::usage = "n must be a rational number.  If u is an integer and u<n, ILtQ[u,n] returns True; else it returns False.";
ILtQ[u_,n_] := IntegerQ[u] && u<n
ILtQ[args___] := Null /; CheckArguments[ILtQ[args], 2]


IGeQ::usage = "n must be a rational number.  If u is an integer and u>=n, IGeQ[u,n] returns True; else it returns False.";
IGeQ[u_,n_] := IntegerQ[u] && u>=n
IGeQ[args___] := Null /; CheckArguments[IGeQ[args], 2]


ILeQ::usage = "n must be a rational number.  If u is an integer and u<=n, ILeQ[u,n] returns True; else it returns False.";
ILeQ[u_,n_] := IntegerQ[u] && u<=n
ILeQ[args___] := Null /; CheckArguments[ILeQ[args], 2]


(* ::Subsection::Closed:: *)
(*Numeric inequality predicates*)


GtQ::usage = "If u>v, GtQ[u,v] returns True; else it returns False.  If u>v and v>w, GtQ[u,v,w] returns True; else it returns False.";
GtQ[u_,v_] := 
  If[RealNumberQ[u],
    If[RealNumberQ[v],
      u>v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && u>vn]],
  With[{un=N[Together[u]]},
  If[Head[un]===Real,
    If[RealNumberQ[v],
      un>v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && un>vn]],
  False]]]

GtQ[u_,v_,w_] := GtQ[u,v] && GtQ[v,w]  


LtQ::usage = "If u>v, LtQ[u,v] returns True; else it returns False.  If u<v and v<w, LtQ[u,v,w] returns True; else it returns False.";
LtQ[u_,v_] := 
  If[RealNumberQ[u],
    If[RealNumberQ[v],
      u<v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && u<vn]],
  With[{un=N[Together[u]]},
  If[Head[un]===Real,
    If[RealNumberQ[v],
      un<v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && un<vn]],
  False]]]

LtQ[u_,v_,w_] := LtQ[u,v] && LtQ[v,w]  


GeQ::usage = "If u>v, GeQ[u,v] returns True; else it returns False.  If u>=v and v>=w, GeQ[u,v,w] returns True; else it returns False.";
GeQ[u_,v_] := 
  If[RealNumberQ[u],
    If[RealNumberQ[v],
      u>=v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && u>=vn]],
  With[{un=N[Together[u]]},
  If[Head[un]===Real,
    If[RealNumberQ[v],
      un>=v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && un>=vn]],
  False]]]

GeQ[u_,v_,w_] := GeQ[u,v] && GeQ[v,w]  


LeQ::usage = "If u>v, LeQ[u,v] returns True; else it returns False.  If u<=v and v<=w, LeQ[u,v,w] returns True; else it returns False.";
LeQ[u_,v_] := 
  If[RealNumberQ[u],
    If[RealNumberQ[v],
      u<=v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && u<=vn]],
  With[{un=N[Together[u]]},
  If[Head[un]===Real,
    If[RealNumberQ[v],
      un<=v,
    With[{vn=N[Together[v]]},
    Head[vn]===Real && un<=vn]],
  False]]]

LeQ[u_,v_,w_] := LeQ[u,v] && LeQ[v,w]  


RealNumberQ::usage = "If u is an explicit non-complex number, RealNumberQ[u] returns True; else it returns False.";
RealNumberQ[u_] := NumberQ[u] && Head[u]=!=Complex


(* ::Section::Closed:: *)
(*Multinomial predicates*)


(* ::Subsection::Closed:: *)
(*PolyQ[u,x,n]*)


(* Mathematica's built-in PolynomialQ, Exponent and Coefficient functions can return erroneous results because they do not *)
(* cancel the gcd in pseudo-rational functions that are actually polynomial. *)
(* PolynomialQ[F[x],x] returns false, but PolynomialQ[F[x],x^2] returns True! *)
(* For some unfully expanded polynomials, the built-in Mathematica function Exponent sometimes returns erronously large degrees. *)
(* For example, Exponent[3*(1+a)*x^4 + 3*x^5 + x^6 - (a+x+x^2)^3, x] incorrectly returns 4 instead of 3. *)
(* Despite what the online help says, PolynomialQ[u,x^v] returns an error message if v is a sum. *)


PolyQ::usage = 
"If u is a polynomial in x, PolyQ[u,x] returns True; else it returns False.
If u is a polynomial in x of degree n, PolyQ[u,x,n] returns True; else it returns False.
If v is free of x and u is a polynomial in x^v, PolyQ[u,x^v] returns True; else it returns False.
If v is free of x and u is a polynomial in x^v of degree n, PolyQ[u,x^v,n] returns True; else it returns False.";


PolyQ[u_,x_Symbol] :=
  PolynomialQ[u,x] || PolynomialQ[Together[u],x]


PolyQ[u_,x_Symbol,n_] :=
  If[PolynomialQ[u,x],
    EqQ[Exponent[u,x],n] && NeQ[Coefficient[u,x,n],0],
  With[{v=Together[u]},
  PolynomialQ[v,x] && EqQ[Exponent[v,x],n] && NeQ[Coefficient[v,x,n],0]]]


PolyQ[u_,x_Symbol^n_Integer] :=
  If[PolynomialQ[u,x],
    PolynomialQ[u,x^n],
  With[{v=Together[u]}, PolynomialQ[v,x] && PolynomialQ[v,x^n]]] /;
n>0

(* PolyQ[u_,x_Symbol^(n_*v_Symbol)] :=
  PolyQ[ReplaceAll[u,v->v/n],x^v] /;
RationalQ[n] && NeQ[v,x] *)

PolyQ[u_,x_Symbol^v_] :=
  If[Quiet[PolynomialQ[u,x^v]]===True,
    FreeQ[CoefficientList[u,x^v],x],
  With[{w=Together[u]}, Quiet[PolynomialQ[w,x^v]]===True && FreeQ[CoefficientList[w,x^v],x]]] /;
NonsumQ[v] && FreeQ[v,x]

PolyQ[u_,v_] :=
  False


PolyQ[u_,x_Symbol^v_,n_] :=
  PolyQ[u,x^v] && EqQ[Expon[u,x^v],n] && NeQ[Coeff[u,x^v,n],0]


(* ::Subsection::Closed:: *)
(*ProperPolyQ[u,x]*)


ProperPolyQ::usage = "If u is a polynomial in x and the constant term is nonzero, ProperPolyQ[u,x] returns True; else it returns False.";
ProperPolyQ[u_,x_Symbol] :=
  PolyQ[u,x] && NeQ[Coeff[u,x,0],0]


(* ::Subsection::Closed:: *)
(*BinomialQ[u,x,n]*)


BinomialQ::usage = 
"If u is equivalent to an expression of the form a+b*x^n where n and b are not 0, BinomialQ[u,x] returns True; else it returns False.
If u is equivalent to an expression of the form a+b*x^n, BinomialQ[u,x,n] returns True; else it returns False.";
BinomialQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[BinomialQ[#,x]],Throw[False]]],u]; True],
  ListQ[BinomialParts[u,x]]]

BinomialQ[u_,x_Symbol,n_] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[BinomialQ[#,x,n]],Throw[False]]],u]; True],
  Function[ListQ[#] && #[[3]]===n][BinomialParts[u,x]]]


(* ::Subsection::Closed:: *)
(*TrinomialQ[u,x]*)


TrinomialQ::usage = "If u is equivalent to an expression of the form a+b*x^n+c*x^(2*n) where n, b and c are not 0, TrinomialQ[u,x] returns True; else it returns False.";
TrinomialQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[TrinomialQ[#,x]],Throw[False]]],u]; True],
  ListQ[TrinomialParts[u,x]] && Not[QuadraticQ[u,x]] && Not[MatchQ[u,w_^2 /; BinomialQ[w,x]]]]


(* ::Subsection::Closed:: *)
(*GeneralizedBinomialQ[u,x]*)


GeneralizedBinomialQ::usage = "If u is equivalent to an expression of the form a*x^q+b*x^n where n, q and b are not 0, GeneralizedBinomialQ[u,x] returns True; else it returns False.";
GeneralizedBinomialQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[GeneralizedBinomialQ[#,x]],Throw[False]]],u]; True],
  ListQ[GeneralizedBinomialParts[u,x]]]


(* ::Subsection::Closed:: *)
(*GeneralizedTrinomialQ[u,x]*)


GeneralizedTrinomialQ::usage = "If u is equivalent to an expression of the form a*x^q+b*x^n+c*x^(2*n-q) where n, q, b and c are not 0, GeneralizedTrinomialQ[u,x] returns True; else it returns False.";
GeneralizedTrinomialQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[GeneralizedTrinomialQ[#,x]],Throw[False]]],u]; True],
  ListQ[GeneralizedTrinomialParts[u,x]]]


(* ::Section::Closed:: *)
(*Expression form predicates*)


(* ::Subsection::Closed:: *)
(*PosQ[u]*)


PosQ::usage = "If u is not 0 and has a positive form, PosQ[u] returns True, else it returns False.";
PosQ[u_] :=
  PosAux[TogetherSimplify[u]]

PosAux[u_] :=
  If[NumberQ[u],
    If[Head[u]===Complex,
      If[EqQ[Re[u],0],
        PosAux[Im[u]],
      PosAux[Re[u]]],
    u>0],
  If[NumericQ[u],
    With[{v=Simplify[Re[u]]},
      If[NumberQ[v],
        If[EqQ[v,0],
          PosAux[Simplify[Im[u]]],
        v>0],
      With[{w=N[u]}, NumberQ[w] && PosAux[w]]]],
  With[{v=Refine[u>0]}, If[v===True || v===False,
    v,
  If[PowerQ[u],
    If[IntegerQ[u[[2]]],
      EvenQ[u[[2]]] || PosAux[u[[1]]],
    True],
  If[ProductQ[u],
    If[PosAux[First[u]],
      PosAux[Rest[u]],
    Not[PosAux[Rest[u]]]],
  If[SumQ[u],
    PosAux[First[u]],
  True]]]]]]]


(* ::Subsection::Closed:: *)
(*NegQ[u]*)


NegQ::usage = "If u is not 0 and has a negative form, NegQ[u] returns True, else it returns False.";
NegQ[u_] :=
  Not[PosQ[u]] && NeQ[u,0]


(* ::Subsection::Closed:: *)
(*NiceSqrtQ[u]*)


NiceSqrtQ::usage = "If u has a nice squareroot (e.g. a positive number or none of the degrees of the factors of the squareroot of u are fractions), NiceSqrtQ[u] returns True, else it returns False.";
NiceSqrtQ[u_] :=
  If[RationalQ[u],
    u>0,
  Not[FractionalPowerFactorQ[Rt[u,2]]]]


(* ::Subsection::Closed:: *)
(*FractionalPowerFactorQ[u]*)


FractionalPowerFactorQ::usage = "If a factor of u is a complex constant or a fractional power, FractionalPowerFactorQ[u] returns True; else it returns False.";
FractionalPowerFactorQ[u_] :=
  If[AtomQ[u],
    Head[u]===Complex,
  If[PowerQ[u],
    FractionQ[u[[2]]],
  If[ProductQ[u],
    FractionalPowerFactorQ[First[u]] || FractionalPowerFactorQ[Rest[u]],
  False]]]


(* ::Section::Closed:: *)
(*Simpler functions*)


(* ::Subsection::Closed:: *)
(*SimplerQ[u,v]*)


SimplerQ::usage = "If u is simpler than v, SimplerQ[u,v] returns True, else it returns False.  SimplerQ[u,u] returns False.";
SimplerQ[u_,v_] :=
  If[IntegerQ[u],
    If[IntegerQ[v],
      If[u==v,
        False,
      If[u==-v,
        v<0,
      Abs[u]<Abs[v]]],
    True],
  If[IntegerQ[v],
    False,
  If[FractionQ[u],
    If[FractionQ[v],
      If[Denominator[u]==Denominator[v],
        SimplerQ[Numerator[u],Numerator[v]],
      Denominator[u]<Denominator[v]],
    True],
  If[FractionQ[v],
    False,
  If[(Re[u]===0 || Re[u]===0.0) && (Re[v]===0 || Re[v]===0.0),
    SimplerQ[Im[u],Im[v]],
  If[ComplexNumberQ[u],
    If[ComplexNumberQ[v],
      If[Re[u]==Re[v],
        SimplerQ[Im[u],Im[v]],
      SimplerQ[Re[u],Re[v]]],
    False],
  If[NumberQ[u],
    If[NumberQ[v],
      OrderedQ[{u,v}],
    True],
  If[NumberQ[v],
    False,
  If[AtomQ[u],
    If[AtomQ[v],
      OrderedQ[{u,v}],
    True],
  If[AtomQ[v],
    False,
  If[Head[u]===Head[v],
    If[Length[u]==Length[v],
      If[LeafCount[u]==LeafCount[v],
        Catch[Do[If[u[[ii]]===v[[ii]],Null,Throw[SimplerQ[u[[ii]],v[[ii]]]]],{ii,Length[u]}]; False],
      LeafCount[u]<LeafCount[v]],
    Length[u]<Length[v]],
  If[LeafCount[u]==LeafCount[v],
    Not[OrderedQ[{v,u}]],
  LeafCount[u]<LeafCount[v]]]]]]]]]]]]]


(* ::Subsection::Closed:: *)
(*SimplerSqrtQ[u,v]*)


SimplerSqrtQ::usage = "If Rt[u,2] is simpler than Rt[v,2], SimplerSqrtQ[u,v] returns True, else it returns False.  SimplerSqrtQ[u,u] returns False.";
SimplerSqrtQ[u_,v_] :=
  If[LtQ[v,0] && Not[LtQ[u,0]],
    True,
  If[LtQ[u,0] && Not[LtQ[v,0]],
    False,
  With[{sqrtu=Rt[u,2],sqrtv=Rt[v,2]},
  If[IntegerQ[sqrtu],
    If[IntegerQ[sqrtv],
      sqrtu<sqrtv,
    True],
  If[IntegerQ[sqrtv],
    False,
  If[RationalQ[sqrtu],
    If[RationalQ[sqrtv],
      sqrtu<sqrtv,
    True],
  If[RationalQ[sqrtv],
    False,
  If[PosQ[u],
    If[PosQ[v],
      LeafCount[sqrtu]<LeafCount[sqrtv],
    True],
  If[PosQ[v],
    False,
  If[LeafCount[sqrtu]<LeafCount[sqrtv],
    True,
  If[LeafCount[sqrtv]<LeafCount[sqrtu],
    False,
  Not[OrderedQ[{v,u}]]]]]]]]]]]]]


(* ::Subsection::Closed:: *)
(*SumSimplerQ[u,v]*)


SumSimplerQ::usage = 
"If u+v is simpler than u, SumSimplerQ[u,v] returns True, else it returns False.
If for every term w of v there is a term of u equal to n*w where n<-1/2, u+v will be simpler than u.";
SumSimplerQ[u_,v_] :=
  If[RationalQ[u,v],
    If[v==0,
      False,
    If[v>0,
      u<-1,
    u>=-v]],
  SumSimplerAuxQ[Expand[u],Expand[v]]]


SumSimplerAuxQ[u_,v_] :=
  (RationalQ[First[v]] || SumSimplerAuxQ[u,First[v]]) && 
  (RationalQ[Rest[v]] || SumSimplerAuxQ[u,Rest[v]]) /;
SumQ[v]

SumSimplerAuxQ[u_,v_] :=
  SumSimplerAuxQ[First[u],v] || SumSimplerAuxQ[Rest[u],v] /;
SumQ[u]

SumSimplerAuxQ[u_,v_] :=
  v=!=0 && 
  NonnumericFactors[u]===NonnumericFactors[v] && 
  (NumericFactor[u]/NumericFactor[v]<-1/2 || NumericFactor[u]/NumericFactor[v]==-1/2 && NumericFactor[u]<0)  


(* ::Subsection::Closed:: *)
(*SimplerIntegrandQ[u,v,x]*)


SimplerIntegrandQ::usage = "If u is simpler to integrate wrt x than v, SimplerIntegrandQ[u,v,x] returns True; else it returns False.";
SimplerIntegrandQ[u_,v_,x_Symbol] :=
  Module[{lst=CancelCommonFactors[u,v],u1,v1},
  u1=lst[[1]];
  v1=lst[[2]];
(*If[Head[u1]===Head[v1] && Length[u1]==Length[v1]==1,
    SimplerIntegrandQ[u1[[1]],v1[[1]],x], *)
  If[LeafCount[u1]<6/10*LeafCount[v1],
(*If[LeafCount[u1]<3/4*LeafCount[v1], *)
    True,
  If[RationalFunctionQ[u1,x],
    If[RationalFunctionQ[v1,x],
      Apply[Plus,RationalFunctionExponents[u1,x]]<Apply[Plus,RationalFunctionExponents[v1,x]],
    True],
  False]]]


CancelCommonFactors::usage = "CancelCommonFactors[u,v] returns the list {u',v'} where u' and v' are the noncommon factors of u and v respectively.";
CancelCommonFactors[u_,v_] :=
  If[ProductQ[u],
    If[ProductQ[v],
      If[MemberQ[v,First[u]],
        CancelCommonFactors[Rest[u],DeleteCases[v,First[u],1,1]],
      Function[{First[u]*#[[1]],#[[2]]}][CancelCommonFactors[Rest[u],v]]],
    If[MemberQ[u,v],
      {DeleteCases[u,v,1,1],1},
    {u,v}]],
  If[ProductQ[v],
    If[MemberQ[v,u],
      {1,DeleteCases[v,u,1,1]},
    {u,v}],
  {u,v}]]


(* ::Section::Closed:: *)
(*Parts functions*)


(* ::Subsection::Closed:: *)
(*BinomialParts[u,x]*)


BinomialDegree::usage = "u is a binomial. BinomialDegree[u,x] returns the degree of x in u.";
BinomialDegree[u_,x_Symbol] :=
  BinomialParts[u,x][[3]]


BinomialDegree::usage = "If u[x] is equivalent to an expression of the form a+b*x^n where n!=0 and b!=0, BinomialParts[u,x] returns the list {a,b,n}; else it returns False.";
BinomialParts[u_,x_Symbol] :=
  If[PolynomialQ[u,x],
    If[Exponent[u,x]>0,
      With[{lst=Exponent[u,x,List]},
        If[Length[lst]==1,
          {0, Coefficient[u,x,Exponent[u,x]], Exponent[u,x]},
        If[Length[lst]==2 && lst[[1]]==0,
          {Coefficient[u,x,0], Coefficient[u,x,Exponent[u,x]], Exponent[u,x]},
        False]]],
    False],
  If[PowerQ[u],
    If[u[[1]]===x && FreeQ[u[[2]],x],
      {0,1,u[[2]]},
    False],
  If[ProductQ[u],
    If[FreeQ[First[u],x],
      With[{lst2=BinomialParts[Rest[u],x]},
      If[AtomQ[lst2],
        False,
      {First[u]*lst2[[1]],First[u]*lst2[[2]],lst2[[3]]}]],
    If[FreeQ[Rest[u],x],
      With[{lst1=BinomialParts[First[u],x]},
      If[AtomQ[lst1],
        False,
      {Rest[u]*lst1[[1]],Rest[u]*lst1[[2]],lst1[[3]]}]],
    With[{lst1=BinomialParts[First[u],x]},
    If[AtomQ[lst1],
      False,
    With[{lst2=BinomialParts[Rest[u],x]},
    If[AtomQ[lst2],
      False,
    With[{a=lst1[[1]],b=lst1[[2]],m=lst1[[3]], c=lst2[[1]],d=lst2[[2]],n=lst2[[3]]},
    If[EqQ[a,0],
      If[EqQ[c,0],
        {0,b*d,m+n},
      If[EqQ[m+n,0],
        {b*d,b*c,m},
      False]],
    If[EqQ[c,0],
      If[EqQ[m+n,0],
        {b*d,a*d,n},
      False],
    If[EqQ[m,n] && EqQ[a*d+b*c,0],
      {a*c,b*d,2*m},
    False]]]]]]]]]],
  If[SumQ[u],
    If[FreeQ[First[u],x],
     With[{lst2=BinomialParts[Rest[u],x]},
      If[AtomQ[lst2],
        False,
      {First[u]+lst2[[1]],lst2[[2]],lst2[[3]]}]],
    If[FreeQ[Rest[u],x],
      With[{lst1=BinomialParts[First[u],x]},
      If[AtomQ[lst1],
        False,
      {Rest[u]+lst1[[1]],lst1[[2]],lst1[[3]]}]],
    With[{lst1=BinomialParts[First[u],x]},
    If[AtomQ[lst1],
      False,
    With[{lst2=BinomialParts[Rest[u],x]},
    If[AtomQ[lst2],
      False,
    If[EqQ[lst1[[3]],lst2[[3]]],
      {lst1[[1]]+lst2[[1]],lst1[[2]]+lst2[[2]],lst1[[3]]},
    False]]]]]]],
  False]]]]


(* ::Subsection::Closed:: *)
(*TrinomialParts[u,x]*)


TrinomialDegree::usage = "If u is equivalent to a trinomial of the form a + b*x^n + c*x^(2*n) where n!=0, b!=0 and c!=0, TrinomialDegree[u,x] returns n.";
TrinomialDegree[u_,x_Symbol] :=
  TrinomialParts[u,x][[4]]


TrinomialParts::usage = "If u is equivalent to a trinomial of the form a + b*x^n + c*x^(2*n) where n!=0, b!=0 and c!=0, TrinomialParts[u,x] returns the list {a,b,c,n}; else it returns False.";
TrinomialParts[u_,x_Symbol] :=
  If[PolynomialQ[u,x],
    With[{lst=CoefficientList[u,x]},
    If[Length[lst]<3 || EvenQ[Length[lst]] || EqQ[lst[[(Length[lst]+1)/2]],0],
      False,
    Catch[
      Scan[Function[If[EqQ[#,0],Null,Throw[False]]],Drop[Drop[Drop[lst,{(Length[lst]+1)/2}],1],-1]];
      {First[lst],lst[[(Length[lst]+1)/2]],Last[lst],(Length[lst]-1)/2}]]],
  If[PowerQ[u],
    If[EqQ[u[[2]],2],
      With[{lst=BinomialParts[u[[1]],x]},
      If[AtomQ[lst] || EqQ[lst[[1]],0],
        False,
      {lst[[1]]^2,2*lst[[1]]*lst[[2]],lst[[2]]^2,lst[[3]]}]],
    False],
  If[ProductQ[u],
    If[FreeQ[First[u],x],
      With[{lst2=TrinomialParts[Rest[u],x]},
      If[AtomQ[lst2],
        False,
      {First[u]*lst2[[1]],First[u]*lst2[[2]],First[u]*lst2[[3]],lst2[[4]]}]],
    If[FreeQ[Rest[u],x],
      With[{lst1=TrinomialParts[First[u],x]},
      If[AtomQ[lst1],
        False,
      {Rest[u]*lst1[[1]],Rest[u]*lst1[[2]],Rest[u]*lst1[[3]],lst1[[4]]}]],
    With[{lst1=BinomialParts[First[u],x]},
    If[AtomQ[lst1],
      False,
    With[{lst2=BinomialParts[Rest[u],x]},
    If[AtomQ[lst2],
      False,
    With[{a=lst1[[1]],b=lst1[[2]],m=lst1[[3]], c=lst2[[1]],d=lst2[[2]],n=lst2[[3]]},
    If[EqQ[m,n] && NeQ[a*d+b*c,0],
      {a*c,a*d+b*c,b*d,m},
    False]]]]]]]],
  If[SumQ[u],
    If[FreeQ[First[u],x],
      With[{lst2=TrinomialParts[Rest[u],x]},
      If[AtomQ[lst2],
        False,
      {First[u]+lst2[[1]],lst2[[2]],lst2[[3]],lst2[[4]]}]],
    If[FreeQ[Rest[u],x],
      With[{lst1=TrinomialParts[First[u],x]},
      If[AtomQ[lst1],
        False,
      {Rest[u]+lst1[[1]],lst1[[2]],lst1[[3]],lst1[[4]]}]],
    With[{lst1=TrinomialParts[First[u],x]},
    If[AtomQ[lst1],
      With[{lst3=BinomialParts[First[u],x]},
      If[AtomQ[lst3],
        False,
      With[{lst2=TrinomialParts[Rest[u],x]},
      If[AtomQ[lst2],
        With[{lst4=BinomialParts[Rest[u],x]},
        If[AtomQ[lst4],
          False,
        If[EqQ[lst3[[3]],2*lst4[[3]]],
          {lst3[[1]]+lst4[[1]],lst4[[2]],lst3[[2]],lst4[[3]]},
        If[EqQ[lst4[[3]],2*lst3[[3]]],
          {lst3[[1]]+lst4[[1]],lst3[[2]],lst4[[2]],lst3[[3]]},
        False]]]],
      If[EqQ[lst3[[3]],lst2[[4]]] && NeQ[lst3[[2]]+lst2[[2]],0],
        {lst3[[1]]+lst2[[1]],lst3[[2]]+lst2[[2]],lst2[[3]],lst2[[4]]},
      If[EqQ[lst3[[3]],2*lst2[[4]]] && NeQ[lst3[[2]]+lst2[[3]],0],
        {lst3[[1]]+lst2[[1]],lst2[[2]],lst3[[2]]+lst2[[3]],lst2[[4]]},
      False]]]]]],
    With[{lst2=TrinomialParts[Rest[u],x]},
    If[AtomQ[lst2],
      With[{lst4=BinomialParts[Rest[u],x]},
      If[AtomQ[lst4],
        False,
      If[EqQ[lst4[[3]],lst1[[4]]] && NeQ[lst1[[2]]+lst4[[2]],0],
        {lst1[[1]]+lst4[[1]],lst1[[2]]+lst4[[2]],lst1[[3]],lst1[[4]]},
      If[EqQ[lst4[[3]],2*lst1[[4]]] && NeQ[lst1[[3]]+lst4[[2]],0],
        {lst1[[1]]+lst4[[1]],lst1[[2]],lst1[[3]]+lst4[[2]],lst1[[4]]},
      False]]]],
    If[EqQ[lst1[[4]],lst2[[4]]] && NeQ[lst1[[2]]+lst2[[2]],0] && NeQ[lst1[[3]]+lst2[[3]],0],
      {lst1[[1]]+lst2[[1]],lst1[[2]]+lst2[[2]],lst1[[3]]+lst2[[3]],lst1[[4]]},
    False]]]]]]],
  False]]]]


(* ::Subsection::Closed:: *)
(*GeneralizedBinomialParts[u,x]*)


GeneralizedBinomialDegree::usage = "If u is equivalent to a generalized binomial of the form a*x^q + b*x^n where a, b, n, and q not equal 0, GeneralizedBinomialDegree[u,x] returns n-q.";
GeneralizedBinomialDegree[u_,x_Symbol] :=
  Function[#[[3]]-#[[4]]][GeneralizedBinomialParts[u,x]]


GeneralizedBinomialParts::usage = "If u is equivalent to a generalized binomial of the form a*x^q + b*x^n where a, b, n, and q not equal 0, GeneralizedBinomialParts[u,x] returns the list {a,b,n,q}; else it returns False.";
GeneralizedBinomialParts[a_.*x_^q_.+b_.*x_^n_.,x_Symbol] :=
  {a,b,n,q} /;
FreeQ[{a,b,n,q},x] && PosQ[n-q]

GeneralizedBinomialParts[a_*u_,x_Symbol] :=
  With[{lst=GeneralizedBinomialParts[u,x]},
  {a*lst[[1]], a*lst[[2]], lst[[3]], lst[[4]]} /;
 ListQ[lst]] /;
FreeQ[a,x]

GeneralizedBinomialParts[x_^m_.*u_,x_Symbol] :=
  With[{lst=GeneralizedBinomialParts[u,x]},
  {lst[[1]], lst[[2]], m+lst[[3]], m+lst[[4]]} /;
 ListQ[lst] && NeQ[m+lst[[3]],0] && NeQ[m+lst[[4]],0]] /;
FreeQ[m,x]

GeneralizedBinomialParts[x_^m_.*u_,x_Symbol] :=
  With[{lst=BinomialParts[u,x]},
  {lst[[1]], lst[[2]], m+lst[[3]], m} /;
 ListQ[lst] && NeQ[m+lst[[3]],0]] /;
FreeQ[m,x]

GeneralizedBinomialParts[u_,x_Symbol] :=
  False


(* ::Subsection::Closed:: *)
(*GeneralizedTrinomialParts[u,x]*)


GeneralizedTrinomialDegree::usage = "If u is equivalent to a generalized trinomial of the form a*x^q + b*x^n + c*x^(2*n-q) where n!=0, q!=0, b!=0 and c!=0, GeneralizedTrinomialDegree[u,x] returns n-q.";
GeneralizedTrinomialDegree[u_,x_Symbol] :=
  Function[#[[4]]-#[[5]]][GeneralizedTrinomialParts[u,x]]


GeneralizedTrinomialParts::usage = "If u is equivalent to a generalized trinomial of the form a*x^q + b*x^n + c*x^(2*n-q) where n!=0, q!=0, b!=0 and c!=0, GeneralizedTrinomialParts[u,x] returns the list {a,b,c,n,q}; else it returns False.";
GeneralizedTrinomialParts[a_.*x_^q_.+b_.*x_^n_.+c_.*x_^r_.,x_Symbol] :=
  {a,b,c,n,q} /;
FreeQ[{a,b,c,n,q},x] && EqQ[r,2*n-q]

GeneralizedTrinomialParts[a_*u_,x_Symbol] :=
  With[{lst=GeneralizedTrinomialParts[u,x]},
  {a*lst[[1]], a*lst[[2]], a*lst[[3]], lst[[4]], lst[[5]]} /;
 ListQ[lst]] /;
FreeQ[a,x]

GeneralizedTrinomialParts[u_,x_Symbol] :=
  With[{lst=Expon[u,x,List]},
  If[Length[lst]==3 && NeQ[lst[[1]],0] && EqQ[lst[[3]],2*lst[[2]]-lst[[1]]],
    {Coeff[u,x,lst[[1]]],Coeff[u,x,lst[[2]]],Coeff[u,x,lst[[3]]],lst[[2]],lst[[1]]},
  False]] /;
PolyQ[u,x]

GeneralizedTrinomialParts[x_^m_.*u_,x_Symbol] :=
  With[{lst=GeneralizedTrinomialParts[u,x]},
  {lst[[1]], lst[[2]], lst[[3]], m+lst[[4]], m+lst[[5]]} /;
 ListQ[lst] && NeQ[m+lst[[4]],0] && NeQ[m+lst[[5]],0]] /;
FreeQ[m,x]

GeneralizedTrinomialParts[x_^m_.*u_,x_Symbol] :=
  With[{lst=TrinomialParts[u,x]},
  {lst[[1]], lst[[2]], lst[[3]], m+lst[[4]], m} /;
 ListQ[lst] && NeQ[m+lst[[4]],0]] /;
FreeQ[m,x]

GeneralizedTrinomialParts[u_,x_Symbol] :=
  False


(* ::Section::Closed:: *)
(*Selection functions*)


(* ::Subsection::Closed:: *)
(*NumericFactor[u] *)


NumericFactor::usage = "NumericFactor[u] returns the real numeric factor of u.";
NumericFactor[u_] :=
  If[NumberQ[u],
    If[EqQ[Im[u],0],
      u,
    If[EqQ[Re[u],0],
      Im[u],
    1]],
  If[PowerQ[u],
    If[RationalQ[u[[1]]] && FractionQ[u[[2]]],
      If[u[[2]]>0,
        1/Denominator[u[[1]]],
      1/Denominator[1/u[[1]]]],
    1],
  If[ProductQ[u],
    Map[NumericFactor,u],
  If[SumQ[u],
    If[LeafCount[u]<50,             (* Eliminate this kludge! *)
      Function[If[SumQ[#], 1, NumericFactor[#]]][ContentFactor[u]],
    With[{m=NumericFactor[First[u]],n=NumericFactor[Rest[u]]},
    If[m<0 && n<0,
      -GCD[-m,-n],
    GCD[m,n]]]],
  1]]]]


NumericFactor::usage = "NonnumericFactors[u] returns the product of the factors of u that are not real numbers.";
NonnumericFactors[u_] :=
  If[NumberQ[u],
    If[EqQ[Im[u],0],
      1,    
    If[EqQ[Re[u],0],
      I,
    u]],
  If[PowerQ[u],
    If[RationalQ[u[[1]]] && FractionQ[u[[2]]],
      u/NumericFactor[u],
    u],
  If[ProductQ[u],
    Map[NonnumericFactors,u],
  If[SumQ[u],
    If[LeafCount[u]<50,             (* Eliminate this kludge! *)
      Function[If[SumQ[#], u, NonnumericFactors[#]]][ContentFactor[u]],
    With[{n=NumericFactor[u]},
    Map[Function[#/n],u]]],
  u]]]]


(* ::Subsection::Closed:: *)
(*RemoveContent[u,x]*)


RemoveContent::usage = "RemoveContent[u,x] returns u with the content free of x removed.";
RemoveContent[u_,x_Symbol] :=
  With[{v=NonfreeFactors[u,x]},
  With[{w=Together[v]},
  If[EqQ[FreeFactors[w,x],1],
    RemoveContentAux[v,x],
  RemoveContentAux[NonfreeFactors[w,x],x]]]]


RemoveContentAux[a_^m_*u_.+b_*v_.,x_Symbol] :=
  If[m>1,
    RemoveContentAux[a^(m-1)*u-v,x],
  RemoveContentAux[u-a^(1-m)*v,x]] /;
IntegersQ[a,b] && a+b==0 && RationalQ[m]


RemoveContentAux[a_^m_.*u_.+a_^n_.*v_.,x_Symbol] :=
  RemoveContentAux[u+a^(n-m)*v,x] /;
FreeQ[a,x] && RationalQ[m,n] && n-m>=0


RemoveContentAux[a_^m_.*u_.+a_^n_.*v_.+a_^p_.*w_.,x_Symbol] :=
  RemoveContentAux[u+a^(n-m)*v+a^(p-m)*w,x] /;
FreeQ[a,x] && RationalQ[m,n,p] && n-m>=0 && p-m>=0


RemoveContentAux[u_,x_Symbol] :=
  If[SumQ[u] && NegQ[First[u]],
    -u,
  u]


(* ::Subsection::Closed:: *)
(*FreeFactors[u,x]*)


FreeFactors::usage = "FreeFactors[u,x] returns the product of the factors of u free of x.";
FreeFactors[u_,x_] :=
  If[ProductQ[u],
    Map[Function[If[FreeQ[#,x],#,1]],u],
  If[FreeQ[u,x],
    u,
  1]]


(* ::Subsection::Closed:: *)
(*NonfreeFactors[u,x]*)


NonfreeFactors::usage = "NonfreeFactors[u,x] returns the product of the factors of u not free of x.";
NonfreeFactors[u_,x_] :=
  If[ProductQ[u],
    Map[Function[If[FreeQ[#,x],1,#]],u],
  If[FreeQ[u,x],
    1,
  u]]


(* ::Subsection::Closed:: *)
(*FreeTerms[u,x]*)


FreeTerms::usage = "FreeTerms[u,x] returns the sum of the terms of u free of x.";
FreeTerms[u_,x_] :=
  If[SumQ[u],
    Map[Function[If[FreeQ[#,x],#,0]],u],
  If[FreeQ[u,x],
    u,
  0]]


(* ::Subsection::Closed:: *)
(*NonfreeTerms[u,x]*)


NonfreeTerms::usage = "NonfreeTerms[u,x] returns the sum of the terms of u not free of x.";
NonfreeTerms[u_,x_] :=
  If[SumQ[u],
    Map[Function[If[FreeQ[#,x],0,#]],u],
  If[FreeQ[u,x],
    0,
  u]]


(* ::Subsection::Closed:: *)
(*Polynomial functions*)


Expon[expr_,form_] :=
  Exponent[Together[expr],form]

Expon[expr_,form_,h_] :=
  Exponent[Together[expr],form,h]


Coeff[expr_,form_] :=
  Coefficient[Together[expr],form]

Coeff[expr_,form_,n_] :=
  With[{coef1=Coefficient[expr,form,n],coef2=Coefficient[Together[expr],form,n]},
  If[Simplify[coef1-coef2]===0,
    coef1,
  coef2]]


(* ::Subsection::Closed:: *)
(*LeadTerm[u]*)


LeadTerm[u_] :=
  If[SumQ[u],
    First[u],
  u]


(* ::Subsection::Closed:: *)
(*RemainingTerms[u]*)


RemainingTerms[u_] :=
  If[SumQ[u],
    Rest[u],
  0]


(* ::Subsection::Closed:: *)
(*LeadFactor[u]*)


LeadFactor::usage = "LeadFactor[u] returns the leading factor of u.";
LeadFactor[u_] :=
  If[ProductQ[u],
    LeadFactor[First[u]],
  If[ComplexNumberQ[u] && Re[u]===0,
    If[Im[u]===1,
      u,
    LeadFactor[Im[u]]],
  u]]


(* ::Subsection::Closed:: *)
(*RemainingFactors[u]*)


RemainingFactors::usage = "RemainingFactors[u] returns the remaining factors of u.";
RemainingFactors[u_] :=
  If[ProductQ[u],
    RemainingFactors[First[u]]*Rest[u],
  If[ComplexNumberQ[u] && Re[u]===0,
    If[Im[u]===1,
      1,
    I*RemainingFactors[Im[u]]],
  1]]


(* ::Subsection::Closed:: *)
(*LeadBase[u]*)


LeadBase::usage = "LeadBase[u] returns the base of the leading factor of u.";
LeadBase[u_] :=
  With[{v=LeadFactor[u]},
  If[PowerQ[v],
    v[[1]],
  v]]


(* ::Subsection::Closed:: *)
(*LeadDegree[u]*)


LeadDegree::usage = "LeadDegree[u] returns the degree of the leading factor of u.";
LeadDegree[u_] :=
  With[{v=LeadFactor[u]},
  If[PowerQ[v],
    v[[2]],
  1]]


(* ::Subsection::Closed:: *)
(*Numer[u]*)


Numer::usage = "Numer[u] returns the numerator of u.";
Numer[m_Integer^n_Rational] :=
  1 /;
n<0


Numer[u_*v_] :=
  Numer[u]*Numer[v]


Numer[u_] := Numerator[u]


(* ::Subsection::Closed:: *)
(*Denom[u]*)


Denom::usage = "Denom[u] returns the denominator of u.";
Denom[m_Integer^n_Rational] :=
  m^-n /;
n<0


Denom[u_*v_] :=
  Denom[u]*Denom[v]


Denom[u_] := Denominator[u]


(* ::Section::Closed:: *)
(*Multinomial functions*)


(* ::Subsection::Closed:: *)
(*Multinomial Recognizer functions*)


LinearQ::usage = "LinearQ[u,x] returns True iff u is a polynomial of degree 1.";
LinearQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[PolyQ[#,x,1],Null,Throw[False]]],u]; True],
  PolyQ[u,x,1]]


QuadraticQ::usage = "QuadraticQ[u,x] returns True iff u is a polynomial of degree 2 and not a monomial of the form a x^2.";
QuadraticQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[QuadraticQ[#,x]],Throw[False]]],u]; True],
  PolyQ[u,x,2] && Not[Coefficient[u,x,0]===0 && Coefficient[u,x,1]===0]]


LinearPairQ::usage = "LinearPairQ[u,v,x] returns True iff u and v are linear not equal x but u/v is a constant wrt x.";
LinearPairQ[u_,v_,x_Symbol] :=
  LinearQ[u,x] && LinearQ[v,x] && NeQ[u,x] && EqQ[Coefficient[u,x,0]*Coefficient[v,x,1]-Coefficient[u,x,1]*Coefficient[v,x,0],0]


MonomialQ::usage = "If u is of the form a*x^n where n!=0 and a!=0, MonomialQ[u,x] returns True; else False.";
MonomialQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[MonomialQ[#,x],Null,Throw[False]]],u]; True],
  MatchQ[u, a_.*x^n_. /; FreeQ[{a,n},x]]]


MinimumMonomialExponent::usage = "u is sum whose terms are monomials.  MinimumExponent[u,x] returns the exponent of the term having the smallest exponent.";
MinimumMonomialExponent[u_,x_Symbol] :=
  Module[{n=MonomialExponent[First[u],x]},
  Scan[Function[If[PosQ[n-MonomialExponent[#,x]],n=MonomialExponent[#,x]]],u];
  n]


MonomialExponent::usage = "u is a monomial. MonomialExponent[u,x] returns the exponent of x in u.";
MonomialExponent[a_,x_Symbol] :=
  0 /; 
FreeQ[a,x]

MonomialExponent[a_.*x_^n_.,x_Symbol] :=
  n /; 
FreeQ[{a,n},x]


(* ::Subsection::Closed:: *)
(*Multinomial Match functions*)


LinearMatchQ::usage = "LinearMatchQ[u,x] returns True iff u matches patterns of the form a+b x where a and b are free of x.";
LinearMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[LinearMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.+b_.*x /; FreeQ[{a,b},x]]]


QuadraticMatchQ::usage = "QuadraticMatchQ[u,x] returns True iff u matches patterns of the form a+b x+c x^2 or a+c x^2 where a, b and c are free of x.";
QuadraticMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[QuadraticMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.+b_.*x+c_.*x^2 /; FreeQ[{a,b,c},x]] || MatchQ[u, a_.+c_.*x^2 /; FreeQ[{a,c},x]]]


CubicMatchQ::usage = "CubicMatchQ[u,x] returns True iff u matches patterns of the form a+b x+c x^2+d x^3, a+b x+d x^3, a+c x^2+d x^3 or a+d x^3 where a, b, c and d are free of x.";
CubicMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[CubicMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.+b_.*x+c_.*x^2+d_.*x^3 /; FreeQ[{a,b,c,d},x]] || 
  MatchQ[u, a_.+b_.*x+d_.*x^3 /; FreeQ[{a,b,d},x]] ||
  MatchQ[u, a_.+c_.*x^2+d_.*x^3 /; FreeQ[{a,c,d},x]] || 
  MatchQ[u, a_.+d_.*x^3 /; FreeQ[{a,d},x]]]


BinomialMatchQ::usage = "BinomialMatchQ[u,x] returns True iff u matches patterns of the form a+b x^n where a, b and n are free of x.";
BinomialMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[BinomialMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.+b_.*x^n_. /; FreeQ[{a,b,n},x]]]


GeneralizedBinomialMatchQ::usage = "GeneralizedBinomialMatchQ[u,x] returns True iff u matches patterns of the form a x^q+b x^n where a, b, n and q are free of x.";
GeneralizedBinomialMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[GeneralizedBinomialMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.*x^q_.+b_.*x^n_. /; FreeQ[{a,b,n,q},x]]]


TrinomialMatchQ::usage = "TrinomialMatchQ[u,x] returns True iff u matches patterns of the form a+b x+c x^n or a+c x^(2 n) where a, b, c and n are free of x.";
TrinomialMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[TrinomialMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.+b_.*x^n_.+c_.*x^j_. /; FreeQ[{a,b,c,n},x] && EqQ[j-2*n,0]]]


GeneralizedTrinomialMatchQ::usage = "GeneralizedTrinomialMatchQ[u,x] returns True iff u matches patterns of the form a x^q+b x^n+c x^(2 n-q) where a, b, c, n and q are free of x.";
GeneralizedTrinomialMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[GeneralizedTrinomialMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, a_.*x^q_.+b_.*x^n_.+c_.*x^r_. /; FreeQ[{a,b,c,n,q},x] && EqQ[r-(2*n-q),0]]]


QuotientOfLinearsMatchQ::usage = "QuotientOfLinearsMatchQ[u,x] returns True iff u matches patterns of the form e (a+b x)/(c+d x) where a, b, c and d are free of x.";
QuotientOfLinearsMatchQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[QuotientOfLinearsMatchQ[#,x]],Throw[False]]],u]; True],
  MatchQ[u, e_.*(a_.+b_.*x)/(c_.+d_.*x) /; FreeQ[{a,b,c,d,e},x]]]


(* ::Subsection::Closed:: *)
(*Polynomial Terms functions*)


PolynomialTermQ::usage = "If u(x) is an expression of the form a*x^n where n is zero or a positive integer, PolynomialTermQ[u,x] returns True; else it returns False.";
PolynomialTermQ[u_,x_Symbol] :=
  FreeQ[u,x] || MatchQ[u,a_.*x^n_. /; FreeQ[a,x] && IntegerQ[n] && n>0]


PolynomialTerms::usage = "u(x) is a sum.  PolynomialTerms[u,x] returns the sum of the polynomial terms of u(x).";
PolynomialTerms[u_,x_Symbol] :=
  Map[Function[If[PolynomialTermQ[#,x],#,0]],u]


NonpolynomialTerms::usage = "u(x) is a sum.  NonpolynomialTerms[u,x] returns the sum of the nonpolynomial terms of u(x).";
NonpolynomialTerms[u_,x_Symbol] :=
  Map[Function[If[PolynomialTermQ[#,x],0,#]],u]


(* ::Subsection::Closed:: *)
(*PseudoBinomial Routines*)


PseudoBinomialQ::usage = "If u is equivalent to a polynomial of the form a+b*(c+d*x)^n where n\[Element]\[DoubleStruckCapitalZ] and n>2, PseudoBinomialQ[u,x] returns True; else it returns False.";
PseudoBinomialQ[u_,x_Symbol] :=
  ListQ[PseudoBinomialParts[u,x]]


PseudoBinomialPairQ::usage = "If u is equivalent to a polynomial of the form a+b*(e+f*x)^n and v to a polynomial of the form c+d*(e+f*x)^n where n\[Element]\[DoubleStruckCapitalZ] and n>2, PseudoBinomialPairQ[u,v,x] returns True; else it returns False.";
PseudoBinomialPairQ[u_,v_,x_Symbol] :=
  With[{lst1=PseudoBinomialParts[u,x]},
  If[AtomQ[lst1],
    False,
  With[{lst2=PseudoBinomialParts[v,x]},
  If[AtomQ[lst2],
    False,
  Drop[lst1,2]===Drop[lst2,2]]]]]


NormalizePseudoBinomial::usage = "u is pseudo-binomial in x, NormalizePseudoBinomial[u,x] returns u in the form a+b*(c+d*x)^n.";
NormalizePseudoBinomial[u_,x_Symbol] :=
  With[{lst=PseudoBinomialParts[u,x]},
  lst[[1]]+lst[[2]]*(lst[[3]]+lst[[4]]*x)^lst[[5]]]


PseudoBinomialParts::usage = "If u is equivalent to a polynomial of the form a+b*(c+d*x)^n where n\[Element]\[DoubleStruckCapitalZ] and n>2, PseudoBinomialParts[u,x] returns the list {a,b,c,d,n}; else it returns False.";
PseudoBinomialParts[u_,x_Symbol] :=
  If[PolynomialQ[u,x] && Expon[u,x]>2,
    Module[{a,c,d,n},
    n=Expon[u,x];
    d=Rt[Coefficient[u,x,n],n];
    c=Coefficient[u,x,n-1]/(n*d^(n-1));
    a=Simplify[u-(c+d*x)^n];
    If[NeQ[a,0] && FreeQ[a,x],
      {a,1,c,d,n},
    False]],
  False]


(* ::Subsection::Closed:: *)
(*Perfect Power Test Function*)


PerfectPowerTest::usage = "If u (x) is equivalent to a polynomial raised to an integer power greater than 1, PerfectPowerTest[u,x] returns u (x) as an expanded polynomial raised to the power; else it returns False.";
PerfectPowerTest[u_,x_Symbol] :=
  If[PolynomialQ[u,x],
    Module[{lst=FactorSquareFreeList[u],gcd=0,v=1},
    If[lst[[1]]==={1,1},
      lst=Rest[lst]];
    Scan[Function[gcd=GCD[gcd,#[[2]]]],lst];
    If[gcd>1,
      Scan[Function[v=v*#[[1]]^(#[[2]]/gcd)],lst];
      Expand[v]^gcd,
    False]],
  False]


(* ::Subsection::Closed:: *)
(*Square Free Factor Test Function*)


(* SquareFreeFactorTest::usage = "If u (x) can be square free factored, SquareFreeFactorTest[u,x] returns u (x) in factored form; else it returns False."; *)
(* SquareFreeFactorTest[u_,x_Symbol] :=
  If[PolynomialQ[u,x],
    With[{v=FactorSquareFree[u]},
    If[PowerQ[v] || ProductQ[v],
      v,
    False]],
  False] *)


(* ::Section::Closed:: *)
(*Rational function functions*)


(* ::Subsection::Closed:: *)
(*RationalFunctionQ[u,x]*)


RationalFunctionQ::usage = "If u is a rational function of x, RationalFunctionQ[u,x] returns True; else it returns False.";
RationalFunctionQ[u_,x_Symbol] :=
  If[AtomQ[u] || FreeQ[u,x],
    True,
  If[IntegerPowerQ[u],
    RationalFunctionQ[u[[1]],x],
  If[ProductQ[u] || SumQ[u],
    Catch[Scan[Function[If[Not[RationalFunctionQ[#,x]],Throw[False]]],u];True],
  False]]]


(* ::Subsection::Closed:: *)
(*RationalFunctionFactors[u,x]*)


RationalFunctionFactors::usage = "RationalFunctionFactors[u,x] returns the product of the factors of u that are rational functions of x.";
RationalFunctionFactors[u_,x_Symbol] :=
  If[ProductQ[u],
    Map[Function[If[RationalFunctionQ[#,x],#,1]],u],
  If[RationalFunctionQ[u,x],
    u,
  1]]


(* ::Subsection::Closed:: *)
(*NonrationalFunctionFactors[u,x]*)


NonrationalFunctionFactors::usage = "NonrationalFunctionFactors[u,x] returns the product of the factors of u that are not rational functions of x.";
NonrationalFunctionFactors[u_,x_Symbol] :=
  If[ProductQ[u],
    Map[Function[If[RationalFunctionQ[#,x],1,#]],u],
  If[RationalFunctionQ[u,x],
    1,
  u]]


(* ::Subsection::Closed:: *)
(*RationalFunctionExponents[u,x]*)


RationalFunctionExponents::usage = "u is a polynomial or rational function of x.  RationalFunctionExponents[u,x] returns a list of the exponent of the numerator of u and the exponent of the denominator of u.";
RationalFunctionExponents[u_,x_Symbol] :=
  If[PolynomialQ[u,x],
    {Exponent[u,x],0},
  If[IntegerPowerQ[u],
    If[u[[2]]>0,
      u[[2]]*RationalFunctionExponents[u[[1]],x],
    (-u[[2]])*Reverse[RationalFunctionExponents[u[[1]],x]]],
  If[ProductQ[u],
    RationalFunctionExponents[First[u],x]+RationalFunctionExponents[Rest[u],x],
  If[SumQ[u],
    With[{v=Together[u]},
    If[SumQ[v],
      Module[{lst1,lst2},
      lst1=RationalFunctionExponents[First[u],x];
      lst2=RationalFunctionExponents[Rest[u],x];
      {Max[lst1[[1]]+lst2[[2]],lst2[[1]]+lst1[[2]]],lst1[[2]]+lst2[[2]]}],
    RationalFunctionExponents[v,x]]],
  {0,0}]]]]    


(* ::Subsection::Closed:: *)
(*RationalFunctionExpand[u,x]*)


RationalFunctionExpand::usage = "u is a polynomial or rational function of x.  RationalFunctionExpand[u,x] returns the expansion of the factors of u that are rational functions times the other factors.";
RationalFunctionExpand[u_*v_^n_,x_Symbol] :=
  With[{w=RationalFunctionExpand[u,x]},
  If[SumQ[w],
    Map[Function[#*v^n],w],
  w*v^n]] /;
FractionQ[n] && v=!=x

RationalFunctionExpand[u_,x_Symbol] :=
  Module[{v,w},
  v=ExpandIntegrand[u,x];
  If[v=!=u && Not[MatchQ[u, x^m_.*(c_+d_.*x)^p_/(a_+b_.*x^n_) /; FreeQ[{a,b,c,d,p},x] && IntegersQ[m,n] && m==n-1]],
    v,
  v=ExpandIntegrand[RationalFunctionFactors[u,x],x];
  w=NonrationalFunctionFactors[u,x];
  If[SumQ[v],
    Map[Function[#*w],v],
  v*w]]]


(* ::Subsection::Closed:: *)
(*PolyGCD[u,v,x]*)


PolyGCD::usage = "u and v are polynomials in x.  PolyGCD[u,v,x] returns the factors of the gcd of u and v dependent on x.";
PolyGCD[u_,v_,x_Symbol] :=
  NonfreeFactors[PolynomialGCD[u,v],x]


(* ::Section::Closed:: *)
(*Algebraic function functions*)


(* ::Subsection::Closed:: *)
(*AlgebraicFunctionQ*)


AlgebraicFunctionQ::usage = "AlgebraicFunctionQ[u,x] returns True iff u is an algebraic function of x. If flag is True, exponents can be nonnumeric.";
AlgebraicFunctionQ[u_,x_Symbol,flag_:False] :=
  If[AtomQ[u] || FreeQ[u,x],
    True,
  If[PowerQ[u] && (RationalQ[u[[2]]] || flag && FreeQ[u[[2]],x]),
    AlgebraicFunctionQ[u[[1]],x,flag],
  If[ProductQ[u] || SumQ[u],
    Catch[Scan[Function[If[Not[AlgebraicFunctionQ[#,x,flag]],Throw[False]]],u];True],
  If[ListQ[u],
    If[u==={},
      True,
    If[AlgebraicFunctionQ[First[u],x,flag],
      AlgebraicFunctionQ[Rest[u],x,flag],
    False]],
  False]]]]


(* ::Subsection::Closed:: *)
(*AlgebraicFunctionFactors*)


(* AlgebraicFunctionFactors::usage = "AlgebraicFunctionFactors[u,x] returns the product of the factors of u that are algebraic functions of x."; *)
(* AlgebraicFunctionFactors[u_,x_Symbol,flag_:False] :=
  If[ProductQ[u],
    Map[Function[If[AlgebraicFunctionQ[#,x,flag],#,1]],u],
  If[AlgebraicFunctionQ[u,x,flag],u,1]] *)


(* ::Subsection::Closed:: *)
(*NonalgebraicFunctionFactors*)


(* NonalgebraicFunctionFactors::usage = "NonalgebraicFunctionFactors[u,x] returns the product of the factors of u that are not algebraic functions of x."; *)
(* NonalgebraicFunctionFactors[u_,x_Symbol,flag_:False] :=
  If[ProductQ[u],
    Map[Function[If[AlgebraicFunctionQ[#,x,flag],1,#]],u],
  If[AlgebraicFunctionQ[u,x,flag],1,u]] *)


(* ::Section::Closed:: *)
(*Quotient of linears functions*)


(* ::Subsection::Closed:: *)
(*QuotientOfLinearsQ*)


(* ::Item:: *)
(*QuotientOfLinearsQ[u,x] returns True iff u is equivalent to an expression of the form (a+b x)/(c+d x) where b!=0 and d!=0.*)


QuotientOfLinearsQ[u_,x_Symbol] :=
  If[ListQ[u],
    Catch[Scan[Function[If[Not[QuotientOfLinearsQ[#,x]],Throw[False]]],u]; True],
  QuotientOfLinearsP[u,x] && Function[NeQ[#[[2]],0] && NeQ[#[[4]],0]][QuotientOfLinearsParts[u,x]]]


QuotientOfLinearsP[a_*u_,x_] :=
  QuotientOfLinearsP[u,x] /;
FreeQ[a,x]

QuotientOfLinearsP[a_+u_,x_] :=
  QuotientOfLinearsP[u,x] /;
FreeQ[a,x]

QuotientOfLinearsP[1/u_,x_] :=
  QuotientOfLinearsP[u,x]

QuotientOfLinearsP[u_,x_] :=
  True /;
LinearQ[u,x]

QuotientOfLinearsP[u_/v_,x_] :=
  True /;
LinearQ[u,x] && LinearQ[v,x]

QuotientOfLinearsP[u_,x_] :=
  u===x || FreeQ[u,x]


(* ::Subsection::Closed:: *)
(*QuotientOfLinearsParts*)


QuotientOfLinearsParts::usage = "If u is equivalent to an expression of the form (a+b*x)/(c+d*x), QuotientOfLinearsParts[u,x] returns the list {a, b, c, d}.";

QuotientOfLinearsParts::error = "unexpected form."

QuotientOfLinearsParts[a_*u_,x_] :=
  Apply[Function[{a*#1, a*#2, #3, #4}], QuotientOfLinearsParts[u,x]] /;
FreeQ[a,x]

QuotientOfLinearsParts[a_+u_,x_] :=
  Apply[Function[{#1+a*#3, #2+a*#4, #3, #4}], QuotientOfLinearsParts[u,x]] /;
FreeQ[a,x]

QuotientOfLinearsParts[1/u_,x_] :=
  Apply[Function[{#3, #4, #1, #2}], QuotientOfLinearsParts[u,x]]

QuotientOfLinearsParts[u_,x_] :=
  {Coefficient[u,x,0], Coefficient[u,x,1], 1, 0} /;
LinearQ[u,x]

QuotientOfLinearsParts[u_/v_,x_] :=
  {Coefficient[u,x,0], Coefficient[u,x,1], Coefficient[v,x,0], Coefficient[v,x,1]} /;
LinearQ[u,x] && LinearQ[v,x]

QuotientOfLinearsParts[u_,x_] :=
  If[u===x,
    {0, 1, 1, 0},
  If[FreeQ[u,x],
    {u, 0, 1, 0},
  Message[QuotientOfLinearsParts::error];
  {u, 0, 1, 0}]]


(* ::Subsection::Closed:: *)
(*SubstForFractionalPowerOfQuotientOfLinears*)


SubstForFractionalPowerOfQuotientOfLinears::usage = "If u has a subexpression of the form ((a+b*x)/(c+d*x))^(m/n) where m and n>1 are integers, SubstForFractionalPowerOfQuotientOfLinears[u,x] returns the list {v,n,(a+b*x)/(c+d*x),b*c-a*d} where v is u with subexpressions of the form ((a+b*x)/(c+d*x))^(m/n) replaced by x^m and x replaced by (-a+c*x^n)/(b-d*x^n), and all times x^(n-1)/(b-d*x^n)^2; else it returns False.";
SubstForFractionalPowerOfQuotientOfLinears[u_,x_Symbol] :=
  Module[{lst=FractionalPowerOfQuotientOfLinears[u,1,False,x]},
  If[AtomQ[lst] || AtomQ[lst[[2]]],
    False,
  With[{n=lst[[1]],tmp=lst[[2]]},
  lst=QuotientOfLinearsParts[tmp,x];
  With[{a=lst[[1]],b=lst[[2]],c=lst[[3]],d=lst[[4]]},
  If[EqQ[d,0],
    False,
  lst=Simplify[x^(n-1)*SubstForFractionalPower[u,tmp,n,(-a+c*x^n)/(b-d*x^n),x]/(b-d*x^n)^2];
  {NonfreeFactors[lst,x],n,tmp,FreeFactors[lst,x]*(b*c-a*d)}]]]]]


SubstForFractionalPowerQ::usage = "If the substitution x=v^(1/n) will not complicate algebraic subexpressions of u, SubstForFractionalPowerQ[u,v,x] returns True; else it returns False.";
SubstForFractionalPowerQ[u_,v_,x_Symbol] :=
  If[AtomQ[u] || FreeQ[u,x],
    True,
  If[FractionalPowerQ[u],
    SubstForFractionalPowerAuxQ[u,v,x],
  Catch[Scan[Function[If[Not[SubstForFractionalPowerQ[#,v,x]],Throw[False]]],u];True]]]

SubstForFractionalPowerAuxQ[u_,v_,x_] :=
  If[AtomQ[u],
    False,
  If[FractionalPowerQ[u] && EqQ[u[[1]],v],
    True,
  Catch[Scan[Function[If[SubstForFractionalPowerAuxQ[#,v,x],Throw[True]]],u];False]]]


FractionalPowerOfQuotientOfLinears::usage = "If u has a subexpression of the form ((a+b*x)/(c+d*x))^(m/n), FractionalPowerOfQuotientOfLinears[u,1,False,x] returns {n,(a+b*x)/(c+d*x)}; else it returns False.";
FractionalPowerOfQuotientOfLinears[u_,n_,v_,x_] :=
  If[AtomQ[u] || FreeQ[u,x],
    {n,v},
  If[CalculusQ[u],
    False,
  If[FractionalPowerQ[u] && QuotientOfLinearsQ[u[[1]],x] && Not[LinearQ[u[[1]],x]] && (FalseQ[v] || EqQ[u[[1]],v]),
    {LCM[Denominator[u[[2]]],n],u[[1]]},
  Catch[Module[{lst={n,v}},
    Scan[Function[If[AtomQ[lst=FractionalPowerOfQuotientOfLinears[#,lst[[1]],lst[[2]],x]],Throw[False]]],u];
    lst]]]]]


(* ::Subsection::Closed:: *)
(*SubstForInverseFunctionOfQuotientOfLinears*)


SubstForInverseFunctionOfQuotientOfLinears::usage = "If u has a subexpression of the form g[(a+b*x)/(c+d*x)] where g is the inverse of function h and f[x,g[(a+b*x)/(c+d*x)]] equals u, SubstForInverseFunctionOfQuotientOfLinears[u,x] returns the list {f[(-a+c*h[x])/(b-d*h[x]),x]*h'[x]/(b-d*h[x])^2, g[(a+b*x)/(c+d*x)], b*c-a*d}.";
SubstForInverseFunctionOfQuotientOfLinears[u_,x_Symbol] :=
  With[{tmp=InverseFunctionOfQuotientOfLinears[u,x]},
  If[AtomQ[tmp],
    False,
  With[{h=InverseFunction[Head[tmp]],lst=QuotientOfLinearsParts[tmp[[1]],x]},
  With[{a=lst[[1]],b=lst[[2]],c=lst[[3]],d=lst[[4]]},
  {SubstForInverseFunction[u,tmp,(-a+c*h[x])/(b-d*h[x]),x]*D[h[x],x]/(b-d*h[x])^2, tmp, b*c-a*d}]]]]


InverseFunctionOfQuotientOfLinears::usage = "If u has a subexpression of the form g[(a+b*x)/(c+d*x)] where g is an inverse function, InverseFunctionOfQuotientOfLinears[u,x] returns g[(a+b*x)/(c+d*x)]; else it returns False.";
InverseFunctionOfQuotientOfLinears[u_,x_Symbol] :=
  If[AtomQ[u] || CalculusQ[u] || FreeQ[u,x],
    False,
  If[InverseFunctionQ[u] && QuotientOfLinearsQ[u[[1]],x],
    u,
  Module[{tmp},
  Catch[
    Scan[Function[If[Not[AtomQ[tmp=InverseFunctionOfQuotientOfLinears[#,x]]],Throw[tmp]]],u];
    False]]]]


(* ::Subsubsection::Closed:: *)
(*Substitution for inverse functions*)


SubstForFractionalPower::usage = "SubstForFractionalPower[u,v,n,w,x] returns u with subexpressions equal to v^(m/n) replaced by x^m and x replaced by w.";
SubstForFractionalPower[u_,v_,n_,w_,x_Symbol] :=
  If[AtomQ[u],
    If[u===x,
      w,
    u],
  If[FractionalPowerQ[u] && EqQ[u[[1]],v],
    x^(n*u[[2]]),
  Map[Function[SubstForFractionalPower[#,v,n,w,x]],u]]]


SubstForInverseFunction::usage = "SubstForInverseFunction[u,v,w,x] returns u with subexpressions equal to v replaced by x and x replaced by w.";
SubstForInverseFunction[u_,v_,x_Symbol] :=
(*  Module[{a=Coefficient[v[[1]],0],b=Coefficient[v[[1]],1]},
  SubstForInverseFunction[u,v,-a/b+InverseFunction[Head[v]]/b,x]] *)
  SubstForInverseFunction[u,v,
		(-Coefficient[v[[1]],x,0]+InverseFunction[Head[v]][x])/Coefficient[v[[1]],x,1],x]

SubstForInverseFunction[u_,v_,w_,x_Symbol] :=
  If[AtomQ[u],
    If[u===x,
      w,
    u],
  If[Head[u]===Head[v] && EqQ[u[[1]],v[[1]]],
    x,
  Map[Function[SubstForInverseFunction[#,v,w,x]],u]]]


(* ::Section::Closed:: *)
(*Absurd number factors*)


AbsurdNumberQ::usage = "AbsurdNumberQ[u] returns True if u is an absurd number, else it returns False.  A number is absurd if it is a rational number, a positive rational number raised to a fractional power, or a product of absurd numbers.";
(*  *)
AbsurdNumberQ[u_] :=
  RationalQ[u]

AbsurdNumberQ[u_^v_] :=
  RationalQ[u] && u>0 && FractionQ[v]

AbsurdNumberQ[u_*v_] :=
  AbsurdNumberQ[u] && AbsurdNumberQ[v]


AbsurdNumberFactors::usage = "AbsurdNumberFactors[u] returns the product of the factors of u that are absurd numbers.";
AbsurdNumberFactors[u_] :=
  If[AbsurdNumberQ[u],
    u,
  If[ProductQ[u],
    Map[AbsurdNumberFactors,u],
  NumericFactor[u]]]


NonabsurdNumberFactors::usage = "NonabsurdNumberFactors[u] returns the product of the factors of u that are not absurd numbers.";
NonabsurdNumberFactors[u_] :=
  If[AbsurdNumberQ[u],
    1,
  If[ProductQ[u],
    Map[NonabsurdNumberFactors,u],
  NonnumericFactors[u]]]


FactorAbsurdNumber::usage = "m must be an absurd number.  FactorAbsurdNumber[m] returns the prime factorization of m as list of base-degree pairs where the bases are prime numbers and the degrees are rational.";
FactorAbsurdNumber[m_] :=
  If[RationalQ[m],
    FactorInteger[m],
  If[PowerQ[m],
    Map[Function[{#[[1]], #[[2]]*m[[2]]}],FactorInteger[m[[1]]]],
  CombineExponents[Sort[Flatten[Map[FactorAbsurdNumber,Apply[List,m]],1], Function[#1[[1]]<#2[[1]]]]]]]


CombineExponents[lst_] :=
  If[Length[lst]<2,
    lst,
  If[lst[[1,1]]==lst[[2,1]],
    CombineExponents[Prepend[Drop[lst,2],{lst[[1,1]],lst[[1,2]]+lst[[2,2]]}]],
  Prepend[CombineExponents[Rest[lst]],First[lst]]]]


AbsurdNumberGCD::usage = "m, n, ... must be absurd numbers.  AbsurdNumberGCD[m,n,...] returns the gcd of m, n, ... .";
AbsurdNumberGCD[seq__] :=
  With[{lst={seq}},
  If[Length[lst]==1,
    First[lst],
  AbsurdNumberGCDList[FactorAbsurdNumber[First[lst]],FactorAbsurdNumber[Apply[AbsurdNumberGCD,Rest[lst]]]]]]


AbsurdNumberGCDList::usage = "lst1 and lst2 must be absurd number prime factorization lists.  AbsurdNumberGCDList[lst1,lst2] returns the gcd of the absurd numbers represented by lst1 and lst2.";
AbsurdNumberGCDList[lst1_,lst2_] :=
  If[lst1==={},
    Apply[Times,Map[Function[#[[1]]^Min[#[[2]],0]],lst2]],
  If[lst2==={},
    Apply[Times,Map[Function[#[[1]]^Min[#[[2]],0]],lst1]],
  If[lst1[[1,1]]==lst2[[1,1]],
    If[lst1[[1,2]]<=lst2[[1,2]],
      lst1[[1,1]]^lst1[[1,2]]*AbsurdNumberGCDList[Rest[lst1],Rest[lst2]],
    lst1[[1,1]]^lst2[[1,2]]*AbsurdNumberGCDList[Rest[lst1],Rest[lst2]]],
  If[lst1[[1,1]]<lst2[[1,1]],
    If[lst1[[1,2]]<0,
      lst1[[1,1]]^lst1[[1,2]]*AbsurdNumberGCDList[Rest[lst1],lst2],
    AbsurdNumberGCDList[Rest[lst1],lst2]],
  If[lst2[[1,2]]<0,
    lst2[[1,1]]^lst2[[1,2]]*AbsurdNumberGCDList[lst1,Rest[lst2]],
  AbsurdNumberGCDList[lst1,Rest[lst2]]]]]]]


(* ::Section::Closed:: *)
(*Normalization functions*)


(* ::Subsection::Closed:: *)
(*NormalizeIntegrand*)


NormalizeIntegrand::usage = "NormalizeIntegrand[u,x] returns u in a standard form recognizable by integration rules.";
NormalizeIntegrand[u_,x_Symbol] :=
  With[{v=NormalizeLeadTermSigns[NormalizeIntegrandAux[u,x]]},
  If[v===NormalizeLeadTermSigns[u],
    u,
  v]]


(* ::Subsection::Closed:: *)
(*NormalizeIntegrandAux*)


NormalizeIntegrandAux[u_,x_Symbol] :=
  If[SumQ[u],
    Map[Function[NormalizeIntegrandAux[#,x]],u],
  If[ProductQ[MergeMonomials[u,x]],
    Map[Function[NormalizeIntegrandFactor[#,x]],MergeMonomials[u,x]],
  NormalizeIntegrandFactor[MergeMonomials[u,x],x]]]


NormalizeIntegrandFactor[u_,x_Symbol] :=
  Module[{bas,deg,min},
  If[PowerQ[u] && FreeQ[u[[2]],x],
    bas=NormalizeIntegrandFactorBase[u[[1]],x];
    deg=u[[2]];
    If[IntegerQ[deg] && SumQ[bas] && EveryQ[Function[MonomialQ[#,x]],bas],
      min=MinimumMonomialExponent[bas,x];
      x^(min*deg)*Map[Function[Simplify[#/x^min]],bas]^deg,
    bas^deg],
  If[PowerQ[u] && FreeQ[u[[1]],x],
    u[[1]]^NormalizeIntegrandFactorBase[u[[2]],x],
  bas=NormalizeIntegrandFactorBase[u,x];
  If[SumQ[bas] && EveryQ[Function[MonomialQ[#,x]],bas],
    min=MinimumMonomialExponent[bas,x];
    x^min*Map[Function[#/x^min],bas],
  bas]]]]


NormalizeIntegrandFactorBase[x_^m_.*u_,x_Symbol] :=
  NormalizeIntegrandFactorBase[Map[Function[x^m*#],u],x] /;
FreeQ[m,x] && SumQ[u]


NormalizeIntegrandFactorBase[u_,x_Symbol] :=
  If[BinomialQ[u,x],
    If[BinomialMatchQ[u,x],
      u,
    ExpandToSum[u,x]],
  If[TrinomialQ[u,x],
    If[TrinomialMatchQ[u,x],
      u,
    ExpandToSum[u,x]],
  If[ProductQ[u],
    Map[Function[NormalizeIntegrandFactor[#,x]],u],
  If[PolynomialQ[u,x] && Exponent[u,x]<=4,
    ExpandToSum[u,x],    
  If[SumQ[u],
    With[{v=TogetherSimplify[u]},
    If[SumQ[v] || MatchQ[v, x^m_.*w_ /; FreeQ[m,x] && SumQ[w]] || LeafCount[v]>LeafCount[u]+2,
      UnifySum[u,x],
    NormalizeIntegrandFactorBase[v,x]]],
  Map[Function[NormalizeIntegrandFactor[#,x]],u]]]]]]


(* ::Subsection::Closed:: *)
(*NormalizeLeadTermSigns*)


NormalizeTogether[u_] :=
  NormalizeLeadTermSigns[Together[u]]


NormalizeLeadTermSigns::usage = "NormalizeLeadTermSigns[u] returns an expression equal u but with not more than one sum factor raised to a integer degree having a lead term with a negative coefficient.";
NormalizeLeadTermSigns[u_] :=
  With[{lst=If[ProductQ[u], Map[SignOfFactor,u], SignOfFactor[u]]},
  If[lst[[1]]==1,
    lst[[2]],
  AbsorbMinusSign[lst[[2]]]]]


AbsorbMinusSign::usage = "AbsorbMinusSign[u] returns an expression equal to -u.  If there is a factor of u of the form v^m where v is a sum and m is an odd power, the minus sign is distributed over v; otherwise -u is returned.";
AbsorbMinusSign[u_.*v_Plus] :=
  u*(-v)

AbsorbMinusSign[u_.*v_Plus^m_] :=
  u*(-v)^m /;
OddQ[m]

AbsorbMinusSign[u_] :=
  -u


(* ::Subsection::Closed:: *)
(*NormalizeSumFactors*)


NormalizeSumFactors::usage = "NormalizeSumFactors[u] returns an expression equal u but with the numeric coefficient of the lead term of sum factors made positive where possible.";
NormalizeSumFactors[u_] :=
  If[AtomQ[u] || StopFunctionQ[u],
    u,
  If[ProductQ[u],
    Function[#[[1]]*#[[2]]][SignOfFactor[Map[NormalizeSumFactors,u]]],
  Map[NormalizeSumFactors,u]]]


SignOfFactor::usage = "SignOfFactor[u] returns the list {n,v} where n*v equals u, n^2 equals 1, and the lead term of the sum factors of v raised to integer degrees all have positive coefficients.";
SignOfFactor[u_] :=
  If[RationalQ[u] && u<0 || SumQ[u] && NumericFactor[First[u]]<0,
    {-1, -u},
  If[IntegerPowerQ[u] && SumQ[u[[1]]] && NumericFactor[First[u[[1]]]]<0,
    {(-1)^u[[2]], (-u[[1]])^u[[2]]},
  If[ProductQ[u],
    Map[SignOfFactor,u],
  {1, u}]]]


(* ::Subsection::Closed:: *)
(*MergeMonomials*)


(* ::Subsubsection::Closed:: *)
(*Basis: If  m\[Element]\[DoubleStruckCapitalZ] \[And] b c-a d==0, then (a+b z)^m==b^m/d^m (c+d z)^m*)


MergeMonomials[u_.*(a_.+b_.*x_)^m_.*(c_.+d_.*x_)^n_.,x_Symbol] :=
  u*b^m/d^m*(c+d*x)^(m+n) /;
FreeQ[{a,b,c,d},x] && IntegerQ[m] && EqQ[b*c-a*d,0]


(* ::Subsubsection::Closed:: *)
(*Basis: If  m/n\[Element]\[DoubleStruckCapitalZ], then z^m (c z^n)^p==(c z^n)^(m/n+p)/c^(m/n)*)


MergeMonomials[u_.*(a_.+b_.*x_)^m_.*(c_.*(a_.+b_.*x_)^n_.)^p_,x_Symbol] :=
  u*(c*(a+b*x)^n)^(m/n+p)/c^(m/n) /;
FreeQ[{a,b,c,m,n,p},x] && IntegerQ[m/n]


(* ::Subsubsection::Closed:: *)
(*Miscellaneous simplification*)


MergeMonomials[a_.*u_^m_,x_Symbol] := 
  a*u^Simplify[m] /;
FreeQ[{a,m},x]

MergeMonomials[u_,x_Symbol] := 
  If[LinearQ[u,x],
    Cancel[u],
  u]


(* ::Section::Closed:: *)
(*Simplification functions*)


(* ::Subsection::Closed:: *)
(*SimplifyIntegrand*)


SimplifyIntegrand::usage = "SimplifyIntegrand[u,x] simplifies u and returns the result in a standard form recognizable by integration rules.";
SimplifyIntegrand[u_,x_Symbol] :=
  Module[{v},
  v=NormalizeLeadTermSigns[NormalizeIntegrandAux[Simplify[u],x]];
  If[LeafCount[v]<4/5*LeafCount[u],
    v,
  If[v=!=NormalizeLeadTermSigns[u],
    v,
  u]]]


(* ::Subsection::Closed:: *)
(*SimplifyTerm        ????*)


(* SimplifyTerm[u_,x_Symbol] :=
  Module[{v=Simplify[u],w},
  w=Together[v];
  NormalizeIntegrand[If[LeafCount[v]<LeafCount[w],v,w],x]] *)


SimplifyTerm[u_,x_Symbol] :=
  Module[{v=Simplify[u],w},
  w=Together[v];
  NormalizeIntegrand[If[LeafCount[v]<LeafCount[w],w,w],x]]


(* ::Subsection::Closed:: *)
(*TogetherSimplify*)


TogetherSimplify[u_] :=
  TimeConstrained[
    With[{v=Together[Simplify[Together[u]]]},
    TimeConstrained[FixSimplify[v],$TimeLimit/3,v]],
  $TimeLimit,u]


(* TogetherSimplify could replace SmartSimplify, but results in more complicated antiderivatives and would require thousands of changes to test suite. *)
SmartSimplify[u_] :=
  TimeConstrained[
    Module[{v,w},
    v=Simplify[u];
    w=Factor[v];
    v=If[LeafCount[w]<LeafCount[v] (* -1 *),w,v];
    v=If[Not[FalseQ[w=FractionalPowerOfSquareQ[v]]] && FractionalPowerSubexpressionQ[u,w,Expand[w]],SubstForExpn[v,w,Expand[w]],v];
    v=FactorNumericGcd[v];
    TimeConstrained[FixSimplify[v],$TimeLimit/3,v]],
  $TimeLimit,u]


SubstForExpn[u_,v_,w_] :=
  If[u===v,
    w,
  If[AtomQ[u],
    u,
  Map[Function[SubstForExpn[#,v,w]],u]]]


(* ::Subsection::Closed:: *)
(*Simp[expn]*)


Simp::usage = "Simp[u] and Simp[u,x] simplifies and returns u.";


Simp[(e_.*(a_+b_)^r_.)^p_.*(c_+d_)^q_.] :=
  With[{u=Simplify[(a+b)/(c+d)]},
  If[IntegerQ[p] || GtQ[e,0] && GtQ[u,0] && GtQ[r,0],
    e^p*u^(p*r),
  e^IntPart[p]*u^(r*IntPart[p])*(e*(a+b)^r)^FracPart[p]/(c+d)^(r*FracPart[p])]] /;
IntegerQ[r] && EqQ[p*r+q,0]


Simp[(g_.*(a_+b_)^s_.)^p_.*(c_+d_)^q_.*(e_+f_)^r_.] :=
  With[{u=Simplify[(a+b)/((c+d)*(e+f))]},
  If[IntegerQ[p],
    g^p*u^(p*s),
  If[GtQ[g,0] && GtQ[u,0] && (NeQ[g,1] || NeQ[u,1]),
    g^p*u^(p*s)*Simp[((c+d)^s*(e+f)^s)^p/((c+d)^(p*s)*(e+f)^(p*s))],
  If[GtQ[g,0] && EqQ[a,c^2] && EqQ[b,-d^2] && GtQ[c,0],
    g^p*Simp[(c-d)^(p*s)/(e+f)^(p*s)],
  If[GtQ[g,0] && EqQ[a,e^2] && EqQ[b,-f^2] && GtQ[e,0],
    g^p*Simp[(e-f)^(p*s)/(c+d)^(p*s)],
  g^IntPart[p]*u^(s*IntPart[p])*(g*(a+b)^s)^FracPart[p]/((c+d)^(s*FracPart[p])*(e+f)^(s*FracPart[p]))]]]]] /;
IntegerQ[s] && EqQ[p*s+q,0] && EqQ[p*s+r,0]


Simp[(u_^q_.*v_^r_.)^p_.*u_^pq_.*v_^pr_.] :=
  If[IntegerQ[p],
    1,
  (u^q*v^r)^FracPart[p]/(u^(q*FracPart[p])*v^(r*FracPart[p]))] /;
IntegersQ[q,r] && EqQ[pq+p*q,0] && EqQ[pr+p*r,0]


Simp[(u_*v_)^p_.] :=
  If[IntegerQ[p] || GtQ[u,0] || GtQ[v,0],
    Simp[u^p]*Simp[v^p],
  (u*v)^p]


Simp[(a_+b_)^p_.*(c_+d_)^q_*(e_+f_)^q_] :=
  (a/c^2)^p*(c+d)^(p+q)*(e+f)^(p+q) /;
IntegerQ[p] && EqQ[e,c] && EqQ[f,-d] && EqQ[b*c^2+a*d^2,0]


Simp[(a_+b_)^p_*(c_+d_)^p_] :=
  (a^2-b^2)^p /;
 EqQ[a,c] && EqQ[b,-d] && GtQ[a,0]


Simp[u_] := Simplify[u]


(* ::Subsection::Closed:: *)
(*Simp[expn,var]*)


Simp[u_,x_] :=
  TimeConstrained[NormalizeSumFactors[SimpHelp[u,x]],$TimeLimit,u]


SimpHelp[E^(u_.*(v_.*Log[a_]+w_)),x_] :=
  a^(u*v)*SimpHelp[E^(u*w),x]

SimpHelp[u_,x_] :=
  If[AtomQ[u] || StopFunctionQ[u],
    u,
  If[FreeQ[u,x],
    With[{v=SmartSimplify[u]},
    If[LeafCount[v]<=LeafCount[u],
      v,
    u]],
  If[ProductQ[u],
    If[EqQ[First[u],1/2] && MatchQ[Rest[u],a_.+n_*Pi+b_.*v_ /; FreeQ[{a,b},x] && Not[FreeQ[v,x]] && EqQ[n^2,1/4]],
      If[MatchQ[Rest[u],n_*Pi+b_.*v_ /; FreeQ[b,x] && Not[FreeQ[v,x]] && EqQ[n^2,1/4]],
        Map[Function[1/2*#],Rest[u]],
      If[MatchQ[Rest[u],m_*a_.+n_*Pi+p_*b_.*v_ /; FreeQ[{a,b},x] && Not[FreeQ[v,x]] && IntegersQ[m/2,p/2]],
        Map[Function[1/2*#],Rest[u]],
      u]],
    Module[{v=FreeFactors[u,x],w=NonfreeFactors[u,x]},
    v=NumericFactor[v]*SmartSimplify[NonnumericFactors[v]*x^2]/x^2;
    w=If[ProductQ[w], Map[Function[SimpHelp[#,x]],w], SimpHelp[w,x]];
    w=FactorNumericGcd[w];
    v=MergeFactors[v,w];
    If[ProductQ[v],
      Map[Function[SimpFixFactor[#,x]],v],
    v]]],
  If[SumQ[u],
    If[MatchQ[u,a_.+n_*Pi+b_.*x /; FreeQ[{a,b},x] && EqQ[n^2,1/16]],
      u,
    If[PolynomialQ[u,x] && Exponent[u,x]<=0,
      SimpHelp[Coefficient[u,x,0],x],
    If[PolynomialQ[u,x] && Exponent[u,x]==1 && Coefficient[u,x,0]===0,
      SimpHelp[Coefficient[u,x,1],x]*x,
    Module[{v=0,w=0},
    Scan[Function[If[FreeQ[#,x],v=#+v,w=#+w]],u];
    v=SmartSimplify[v];
    w=If[SumQ[w], Map[Function[SimpHelp[#,x]],w], SimpHelp[w,x]];
    v+w]]]],
  If[TrigQ[u],
    With[{v=SimpHelp[u[[1]],x]},
    If[LinearQ[v,x] && MatchQ[Coefficient[v,x,0],m_.*(n_.*Pi+r_.)+s_. /; RationalQ[m,n]],
      NormalizeTrig[Head[u],Coefficient[v,x,0],Coefficient[v,x,1],x],
    Head[u][v]]],
  If[HyperbolicQ[u],
    With[{v=SimpHelp[u[[1]],x]},
    If[LinearQ[v,x] && MatchQ[Coefficient[v,x,0],m_.*(n_.*Complex[0,nz_]*Pi+r_.)+s_. /; RationalQ[m,n,nz]],
      NormalizeHyperbolic[Head[u],Coefficient[v,x,0],Coefficient[v,x,1],x],
    Head[u][v]]],
  Map[Function[SimpHelp[#,x]],u]]]]]]]


NormalizeTrig[func_,m_.*(n_.*Pi+r_.)+s_.,b_,x_] :=
  If[m*n==1/4 && NegQ[b],
    Switch[func,
	  Sin, Cos[Pi/4-m*r-s-b*x],        (* Sin[Pi/4-z] == Cos[Pi/4+z] *)
	  Cos, Sin[Pi/4-m*r-s-b*x],        (* Cos[Pi/4-z] == Sin[Pi/4+z] *)
	  Tan, Cot[Pi/4-m*r-s-b*x],        (* Tan[Pi/4-z] == Cot[Pi/4+z] *)
	  Cot, Tan[Pi/4-m*r-s-b*x],        (* Cot[Pi/4-z] == Tan[Pi/4+z] *)
	  Sec, Csc[Pi/4-m*r-s-b*x],        (* Sec[Pi/4-z] == Csc[Pi/4+z] *)
	  Csc, Sec[Pi/4-m*r-s-b*x]],       (* Csc[Pi/4-z] == Sec[Pi/4+z] *)
  If[m*n==-1/4,
    If[PosQ[b],
      Switch[func,
	    Sin, -Cos[Pi/4+m*r+s+b*x],     (* Sin[-Pi/4+z] == -Cos[Pi/4+z] *)
	    Cos, Sin[Pi/4+m*r+s+b*x],      (* Cos[-Pi/4+z] == Sin[Pi/4+z] *)
	    Tan, -Cot[Pi/4+m*r+s+b*x],     (* Tan[-Pi/4+z] == -Cot[Pi/4+z] *)
	    Cot, -Tan[Pi/4+m*r+s+b*x],     (* Cot[-Pi/4+z] == -Tan[Pi/4+z] *)
	    Sec, Csc[Pi/4+m*r+s+b*x],      (* Sec[-Pi/4+z] == Csc[Pi/4+z] *)
	    Csc, -Sec[Pi/4+m*r+s+b*x]],    (* Csc[-Pi/4+z] == -Sec[Pi/4+z] *)
    Switch[func,
	  Sin, -Sin[Pi/4-m*r-s-b*x],       (* Sin[-Pi/4-z] == -Sin[Pi/4+z] *)
	  Cos, Cos[Pi/4-m*r-s-b*x],        (* Cos[-Pi/4-z] == Cos[Pi/4+z] *)
	  Tan, -Tan[Pi/4-m*r-s-b*x],       (* Tan[-Pi/4-z] == -Tan[Pi/4+z] *)
	  Cot, -Cot[Pi/4-m*r-s-b*x],       (* Cot[-Pi/4-z] == -Cot[Pi/4+z] *)
	  Sec, Sec[Pi/4-m*r-s-b*x],        (* Sec[-Pi/4-z] == Sec[Pi/4+z] *)
	  Csc, -Csc[Pi/4-m*r-s-b*x]]],     (* Csc[-Pi/4-z] == -Csc[Pi/4+z] *)
  func[m*n*Pi+m*r+s+b*x]]] /;
RationalQ[m,n]


NormalizeHyperbolic[func_,m_.*(n_.*Complex[0,nz_]*Pi+r_.)+s_.,b_,x_] :=
  If[m*n*nz==1/4 && NegQ[b],
    Switch[func,
	  Sinh, I*Cosh[I*Pi/4-m*r-s-b*x],        (* Sinh[I*Pi/4-z] == I*Cosh[I*Pi/4+z] *)
	  Cosh, -I*Sinh[I*Pi/4-m*r-s-b*x],       (* Cosh[I*Pi/4-z] == -I*Sinh[I*Pi/4+z] *)
	  Tanh, -Coth[I*Pi/4-m*r-s-b*x],         (* Tanh[I*Pi/4-z] == -Coth[I*Pi/4+z] *)
	  Coth, -Tanh[I*Pi/4-m*r-s-b*x],         (* Coth[I*Pi/4-z] == -Tanh[I*Pi/4+z] *)
	  Sech, I*Csch[I*Pi/4-m*r-s-b*x],        (* Sech[I*Pi/4-z] == I*Csch[I*Pi/4+z] *)
	  Csch, -I*Sech[I*Pi/4-m*r-s-b*x]],      (* Csch[I*Pi/4-z] == -I*Sech[I*Pi/4+z] *)
  If[m*n*nz==-1/4,
    If[PosQ[b],
      Switch[func,
	    Sinh, -I*Cosh[I*Pi/4+m*r+s+b*x],     (* Sinh[-I*Pi/4+z] == -I*Cosh[I*Pi/4+z] *)
	    Cosh, -I*Sinh[I*Pi/4+m*r+s+b*x],     (* Cosh[-I*Pi/4+z] == -I*Sinh[I*Pi/4+z] *)
	    Tanh, Coth[I*Pi/4+m*r+s+b*x],        (* Tanh[-I*Pi/4+z] == Coth[I*Pi/4+z] *)
	    Coth, Tanh[I*Pi/4+m*r+s+b*x],        (* Coth[-I*Pi/4+z] == Tanh[I*Pi/4+z] *)
	    Sech, I*Csch[I*Pi/4+m*r+s+b*x],      (* Sech[-I*Pi/4+z] == I*Csch[I*Pi/4+z] *)
	    Csch, I*Sech[I*Pi/4+m*r+s+b*x]],     (* Csch[-I*Pi/4+z] == I*Sech[I*Pi/4+z] *)
    Switch[func,
	  Sinh, -Sinh[I*Pi/4-m*r-s-b*x],         (* Sinh[-I*Pi/4-z] == -Sinh[I*Pi/4+z] *)
	  Cosh, Cosh[I*Pi/4-m*r-s-b*x],          (* Cosh[-I*Pi/4-z] == Cosh[I*Pi/4+z] *)
	  Tanh, -Tanh[I*Pi/4-m*r-s-b*x],         (* Tanh[-I*Pi/4-z] == -Tanh[I*Pi/4+z] *)
	  Coth, -Coth[I*Pi/4-m*r-s-b*x],         (* Coth[-I*Pi/4-z] == -Coth[I*Pi/4+z] *)
	  Sech, Sech[I*Pi/4-m*r-s-b*x],          (* Sech[-I*Pi/4-z] == Sech[I*Pi/4+z] *)
	  Csch, -Csch[I*Pi/4-m*r-s-b*x]]],       (* Csch[-I*Pi/4-z] == -Csch[I*Pi/4+z] *)
  func[m*n*nz*I*Pi+m*r+s+b*x]]] /;
RationalQ[m,n,nz]


(* ::Subsection::Closed:: *)
(*FractionalPowerOfSquareQ*)


FractionalPowerOfSquareQ::usage = "If a subexpression of u is of the form ((v+w)^2)^n where n is a fraction, FractionalPowerOfSquareQ[u] returns (v+w)^2; else it returns False.";
FractionalPowerOfSquareQ[u_] :=
  If[AtomQ[u],
    False,
  If[FractionalPowerQ[u] && MatchQ[u[[1]], a_.*(b_+c_)^2 /; NonsumQ[a]],
    u[[1]],
  Module[{tmp},
  Catch[
    Scan[Function[If[Not[FalseQ[tmp=FractionalPowerOfSquareQ[#]]],Throw[tmp]]],u];
    False]]]]


FractionalPowerSubexpressionQ::usage = "If a subexpression of u is of the form w^n where n is a fraction but not equal to v, FractionalPowerSubexpressionQ[u,v,w] returns True; else it returns False.";
FractionalPowerSubexpressionQ[u_,v_,w_] :=
  If[AtomQ[u],
    False,
  If[FractionalPowerQ[u] && GtQ[u[[1]]/w,0],
    Not[u[[1]]===v] && LeafCount[w]<3*LeafCount[v],
  Catch[Scan[Function[If[FractionalPowerSubexpressionQ[#,v,w],Throw[True]]],u]; False]]]


(* ::Subsection::Closed:: *)
(*FixSimplify*)


Clear[FixSimplify]


(* ::Item:: *)
(*Basis: If  n\[Element]\[DoubleStruckCapitalZ], then u I (v I+w)^n==(-1)^((n+1)/2) u (v-I w)^n*)


FixSimplify[u_.*Complex[0,a_]*(v_.*Complex[0,b_]+w_)^n_.] :=
  (-1)^((n+1)/2)*a*u*FixSimplify[(b*v-Complex[0,1]*w)^n] /;
OddQ[n]


(* ::Item:: *)
(*Basis: If  u>0 \[And] v>0, let g=GCD[m,n], then u^m v^n==((u^(m/g) v^(n/g)))^g*)


FixSimplify[w_.*u_^m_.*v_^n_] :=
  With[{z=Simplify[u^(m/GCD[m,n])*v^(n/GCD[m,n])]},
  FixSimplify[w*z^GCD[m,n]]/;
 AbsurdNumberQ[z] || SqrtNumberSumQ[z]] /;
RationalQ[m] && FractionQ[n] && SqrtNumberSumQ[u] && SqrtNumberSumQ[v] && GtQ[u,0] && GtQ[v,0]


FixSimplify[w_.*u_^m_.*v_^n_] :=
  With[{z=Simplify[u^(m/GCD[m,-n])*v^(n/GCD[m,-n])]},
  FixSimplify[w*z^GCD[m,-n]]/;
 AbsurdNumberQ[z] || SqrtNumberSumQ[z]] /;
RationalQ[m] && FractionQ[n] && SqrtNumberSumQ[u] && SqrtNumberSumQ[1/v] && GtQ[u,0] && GtQ[v,0]


(* ::Item:: *)
(*Basis: If  m\[Element]\[DoubleStruckCapitalZ] \[And] u<0 \[And] v>0, then u^m v^n==-(((-u))^(m/n) v)^n*)


FixSimplify[w_.*u_^m_.*v_^n_] :=
  With[{z=Simplify[(-u)^(m/GCD[m,n])*v^(n/GCD[m,n])]},
  FixSimplify[-w*z^GCD[m,n]]/;
 AbsurdNumberQ[z] || SqrtNumberSumQ[z]] /;
IntegerQ[m] && FractionQ[n] && SqrtNumberSumQ[u] && SqrtNumberSumQ[v] && LtQ[u,0] && GtQ[v,0]


FixSimplify[w_.*u_^m_.*v_^n_] :=
  With[{z=Simplify[(-u)^(m/GCD[m,-n])*v^(n/GCD[m,-n])]},
  FixSimplify[-w*z^GCD[m,-n]]/;
 AbsurdNumberQ[z] || SqrtNumberSumQ[z]] /;
IntegerQ[m] && FractionQ[n] && SqrtNumberSumQ[u] && SqrtNumberSumQ[1/v] && LtQ[u,0] && GtQ[v,0]


(* ::Item:: *)
(*Basis: If  p\[Element]\[DoubleStruckCapitalZ] \[Or] a>0, then a^m (u+v)^p==(a^(m/p) u+a^(m/p) v)^p*)


FixSimplify[w_.*a_^m_*(u_+b_^n_*v_.)^p_.] :=
  With[{c=Simplify[a^(m/p)*b^n]},
  FixSimplify[w*(a^(m/p)*u+c*v)^p] /;
 RationalQ[c]] /;
RationalQ[a,b,m,n] && a>0 && b>0 && IGtQ[p,0]


(* ::Item:: *)
(*Basis: If  p\[Element]\[DoubleStruckCapitalZ], then a^m (a^n u+(-a)^p v)==a^(m+n) (u+(-1)^p a^(p-n) v)*)


FixSimplify[w_.*a_^m_.*(a_^n_*u_.+b_^p_.*v_.)] :=
  With[{z=w*a^(m+n)*(u+(-1)^p*a^(p-n)*v)},
  FixSimplify[z] /;
 Not[MatchQ[z, ww_.*aa_^mm_*(uu_+bb_^nn_*vv_.) /; 
   RationalQ[aa,bb,mm,nn] && aa>0 && bb>0 && RationalQ[Simplify[aa^mm*bb^nn]]]]] /;
RationalQ[m] && FractionQ[n] && IntegerQ[p] && p-n>0 && a+b===0


(* ::Item:: *)
(*Basis: If  m\[Element]\[DoubleStruckCapitalZ] \[And] b c-a d==0, then (a+b)^m==(b/d)^m (c+d)^m*)


FixSimplify[w_.*(a_+b_)^m_.*(c_+d_)^n_] :=
  With[{q=Simplify[b/d]},
  FixSimplify[w*q^m*(c+d)^(m+n)] /;
 FreeQ[q,Plus]] /;
IntegerQ[m] && Not[IntegerQ[n]] && EqQ[b*c-a*d,0]


(* ::Item:: *)
(*Basis: If  t\[Element]\[DoubleStruckCapitalZ], then (a^m u+a^n v+...)^t==a^(m t) (u+a^(n-m) v+...)^t*)


FixSimplify[w_.*(a_^m_.*u_.+a_^n_.*v_.)^t_.] :=
  FixSimplify[a^(m*t)*w*(u+a^(n-m)*v)^t] /;
Not[RationalQ[a]] && IntegerQ[t] && RationalQ[m,n] && 0<m<=n

FixSimplify[w_.*(a_^m_.*u_.+a_^n_.*v_.+a_^p_.*z_.)^t_.] :=
  FixSimplify[a^(m*t)*w*(u+a^(n-m)*v+a^(p-m)*z)^t] /;
Not[RationalQ[a]] && IntegerQ[t] && RationalQ[m,n,p] && 0<m<=n<=p

FixSimplify[w_.*(a_^m_.*u_.+a_^n_.*v_.+a_^p_.*z_.+a_^q_.*y_.)^t_.] :=
  FixSimplify[a^(m*t)*w*(u+a^(n-m)*v+a^(p-m)*z+a^(q-m)*y)^t] /;
Not[RationalQ[a]] && IntegerQ[t] && RationalQ[m,n,p] && 0<m<=n<=p<=q


(* ::Item:: *)
(*Basis: a Sqrt[v]+b Sqrt[v]+...==(a+b+...)Sqrt[v]*)


FixSimplify[w_.*(u_.+a_.*Sqrt[v_Plus]+b_.*Sqrt[v_]+c_.*Sqrt[v_]+d_.*Sqrt[v_])] :=
  FixSimplify[w*(u+FixSimplify[a+b+c+d]*Sqrt[v])]

FixSimplify[w_.*(u_.+a_.*Sqrt[v_Plus]+b_.*Sqrt[v_]+c_.*Sqrt[v_])] :=
  FixSimplify[w*(u+FixSimplify[a+b+c]*Sqrt[v])]

FixSimplify[w_.*(u_.+a_.*Sqrt[v_Plus]+b_.*Sqrt[v_])] :=
  FixSimplify[w*(u+FixSimplify[a+b]*Sqrt[v])]


(* ::Item:: *)
(*Basis: If  a>0, then a^(m/4) Sqrt[b(c+d Sqrt[a])]==Sqrt[b(c a^(m/2)+d a^((m+1)/2))]*)


(* FixSimplify[u_.*a_^m_*Sqrt[b_.*(c_+d_.*Sqrt[a_])]] :=
  Sqrt[Together[b*(c*a^(2*m)+d*a^(2*m+1/2))]]*FixSimplify[u] /;
RationalQ[a,b,c,d,m] && a>0 && Denominator[m]==4

FixSimplify[u_.*a_^m_/Sqrt[b_.*(c_+d_.*Sqrt[a_])]] :=
  FixSimplify[u]/Sqrt[Together[b*(c/a^(2*m)+d/a^(2*m-1/2))]] /;
RationalQ[a,b,c,d,m] && a>0 && Denominator[m]==4 *)


(* ::Item:: *)
(*Basis: If  w^-n==v, then v^m w^n==v^(m-1)*)


FixSimplify[u_.*v_^m_*w_^n_] :=
  -FixSimplify[u*v^(m-1)] /;
RationalQ[m] && Not[RationalQ[w]] && FractionQ[n] && n<0 && EqQ[v+w^(-n),0]


(* ::Item:: *)
(*Basis: If  n\[Element]\[DoubleStruckCapitalZ], then v^m (-v)^n==(-1)^n v^(m+n)*)


FixSimplify[u_.*v_^m_*w_^n_.] :=
  (-1)^(n)*FixSimplify[u*v^(m+n)] /;
RationalQ[m] && Not[RationalQ[w]] && IntegerQ[n] && EqQ[v+w,0]


(* ::Item:: *)
(*Basis: If  n/p\[Element]\[DoubleStruckCapitalZ], then (-v^p)^m v^n==(-1)^(n/p) (-v^p)^(m+n/p)*)


FixSimplify[u_.*(-v_^p_.)^m_*w_^n_.] :=
  (-1)^(n/p)*FixSimplify[u*(-v^p)^(m+n/p)] /;
RationalQ[m] && Not[RationalQ[w]] && IntegerQ[n/p] && EqQ[v-w,0]


(* ::Item:: *)
(*Basis: If  (n|n/p)\[Element]\[DoubleStruckCapitalZ], then (-v^p)^m (-v)^n==(-1)^(n+n/p) (-v^p)^(m+n/p)*)


FixSimplify[u_.*(-v_^p_.)^m_*w_^n_.] :=
  (-1)^(n+n/p)*FixSimplify[u*(-v^p)^(m+n/p)] /;
RationalQ[m] && Not[RationalQ[w]] && IntegersQ[n,n/p] && EqQ[v+w,0]


(* ::Item:: *)
(*Basis: (a-b) (a+b) == a^2-b^2*)


FixSimplify[u_.*(a_-b_)^m_.*(a_+b_)^m_.] :=
  u*(a^2-b^2)^m /;
IntegerQ[m] && AtomQ[a] && AtomQ[b]


FixSimplify[u_.*(c_Symbol*d_Symbol^2-e_Symbol*(b_Symbol*d_Symbol-a_Symbol*e_Symbol))^m_.] :=
  u*(c*d^2-b*d*e+a*e^2)^m /;
RationalQ[m] && OrderedQ[{a,b,c,d,e}]

FixSimplify[u_.*(c_Symbol*d_Symbol^2+e_Symbol*(-b_Symbol*d_Symbol+a_Symbol*e_Symbol))^m_.] :=
  u*(c*d^2-b*d*e+a*e^2)^m /;
RationalQ[m] && OrderedQ[{a,b,c,d,e}]

FixSimplify[u_.*(-c_Symbol*d_Symbol^2+e_Symbol*(b_Symbol*d_Symbol-a_Symbol*e_Symbol))^m_.] :=
  (-1)^m*u*(c*d^2-b*d*e+a*e^2)^m /;
IntegerQ[m] && OrderedQ[{a,b,c,d,e}]

FixSimplify[u_.*(-c_Symbol*d_Symbol^2-e_Symbol*(-b_Symbol*d_Symbol+a_Symbol*e_Symbol))^m_.] :=
  (-1)^m*u*(c*d^2-b*d*e+a*e^2)^m /;
RationalQ[m] && OrderedQ[{a,b,c,d,e}]


FixSimplify[u_] := u


(* ::Subsection::Closed:: *)
(*SimpFixFactor*)


(* SimpFixFactor[(a_.*c_ + b_.*c_)^p_.,x_] :=
  c^p*SimpFixFactor[(a+b)^p,x] /;
FreeQ[c,x] && IntegerQ[p] && c^p=!=-1 *)

SimpFixFactor[(a_.*Complex[0,c_] + b_.*Complex[0,d_])^p_.,x_] :=
  I^p*SimpFixFactor[(a*c+b*d)^p,x] /;
IntegerQ[p]

SimpFixFactor[(a_.*Complex[0,d_] + b_.*Complex[0,e_]+ c_.*Complex[0,f_])^p_.,x_] :=
  I^p*SimpFixFactor[(a*d+b*e+c*f)^p,x] /;
IntegerQ[p]


SimpFixFactor[(a_.*c_^r_ + b_.*x_^n_.)^p_.,x_] :=
  c^(p*r)*SimpFixFactor[(a+b/c^r*x^n)^p,x] /;
FreeQ[{a,b,c},x] && IntegersQ[n,p] && AtomQ[c] && RationalQ[r] && r<0

SimpFixFactor[(a_. + b_.*c_^r_*x_^n_.)^p_.,x_] :=
  c^(p*r)*SimpFixFactor[(a/c^r+b*x^n)^p,x] /;
FreeQ[{a,b,c},x] && IntegersQ[n,p] && AtomQ[c] && RationalQ[r] && r<0


SimpFixFactor[(a_.*c_^s_. + b_.*c_^r_.*x_^n_.)^p_.,x_] :=
  c^(p*s)*SimpFixFactor[(a+b*c^(r-s)*x^n)^p,x] /;
FreeQ[{a,b,c},x] && IntegersQ[n,p] && RationalQ[s,r] && 0<s<=r && c^(p*s)=!=-1

SimpFixFactor[(a_.*c_^s_. + b_.*c_^r_.*x_^n_.)^p_.,x_] :=
  c^(p*r)*SimpFixFactor[(a*c^(s-r)+b*x^n)^p,x] /;
FreeQ[{a,b,c},x] && IntegersQ[n,p] && RationalQ[s,r] && 0<r<s && c^(p*r)=!=-1

SimpFixFactor[u_,x_] := u


(* ::Subsection::Closed:: *)
(*FactorNumericGcd*)


FactorNumericGcd::usage = "FactorNumericGcd[u] returns u with the gcd of the numeric coefficients of terms of sums factored out.";
FactorNumericGcd[u_] :=
  If[PowerQ[u] && RationalQ[u[[2]]],
    FactorNumericGcd[u[[1]]]^u[[2]],
  If[ProductQ[u],
    Map[FactorNumericGcd,u],
  If[SumQ[u],
    With[{g=Apply[GCD,Map[NumericFactor,Apply[List,u]]]},
    g*Map[Function[#/g],u]],
  u]]]


(* ::Subsection::Closed:: *)
(*MergeFactors*)


MergeFactors::usage = "MergeFactors[u,v] returns the product of u and v, but with the mergeable factors of u merged into v.";
MergeFactors[u_,v_] :=
  If[ProductQ[u],
    MergeFactors[Rest[u],MergeFactors[First[u],v]],
  If[PowerQ[u],
    If[MergeableFactorQ[u[[1]],u[[2]],v],
      MergeFactor[u[[1]],u[[2]],v],
    If[RationalQ[u[[2]]] && u[[2]]<-1 && MergeableFactorQ[u[[1]],-1,v],
      MergeFactors[u[[1]]^(u[[2]]+1),MergeFactor[u[[1]],-1,v]],
    u*v]],
  If[MergeableFactorQ[u,1,v],
    MergeFactor[u,1,v],
  u*v]]]


MergeFactor::usage = "If MergeableFactorQ[bas,deg,v], MergeFactor[bas,deg,v] return the product of bas^deg and v, but with bas^deg merged into the factor of v whose base equals bas.";
MergeFactor[bas_,deg_,v_] :=
  If[bas===v,
    bas^(deg+1),
  If[PowerQ[v],
    If[bas===v[[1]],
      bas^(deg+v[[2]]),
    MergeFactor[bas,deg/v[[2]],v[[1]]]^v[[2]]],
  If[ProductQ[v],
    If[MergeableFactorQ[bas,deg,First[v]],
      MergeFactor[bas,deg,First[v]]*Rest[v],
    First[v]*MergeFactor[bas,deg,Rest[v]]],
  MergeFactor[bas,deg,First[v]] + MergeFactor[bas,deg,Rest[v]]]]]


MergeableFactorQ::usage = "MergeableFactorQ[bas,deg,v] returns True iff bas equals the base of a factor of v or bas is a factor of every term of v.";
MergeableFactorQ[bas_,deg_,v_] :=
  If[bas===v,
    RationalQ[deg+1] && (deg+1>=0 || RationalQ[deg] && deg>0),
  If[PowerQ[v],
    If[bas===v[[1]],
      RationalQ[deg+v[[2]]] && (deg+v[[2]]>=0 || RationalQ[deg] && deg>0),
    SumQ[v[[1]]] && IntegerQ[v[[2]]] && (Not[IntegerQ[deg]] || IntegerQ[deg/v[[2]]]) && MergeableFactorQ[bas,deg/v[[2]],v[[1]]]],
  If[ProductQ[v],
    MergeableFactorQ[bas,deg,First[v]] || MergeableFactorQ[bas,deg,Rest[v]],
  SumQ[v] && MergeableFactorQ[bas,deg,First[v]] && MergeableFactorQ[bas,deg,Rest[v]]]]]


(* ::Subsection::Closed:: *)
(*TrigSimplify*)


TrigSimplifyQ::usage = "TrigSimplifyQ[u] returns True if TrigSimplify[u] actually simplifies u; else False.";
TrigSimplifyQ[u_] :=
  ActivateTrig[u]=!=TrigSimplify[u]


TrigSimplify::usage = "TrigSimplify[u] returns a bottom-up trig simplification of u.";
TrigSimplify[u_] :=
  ActivateTrig[TrigSimplifyRecur[u]]


TrigSimplifyRecur[u_] :=
  If[AtomQ[u],
    u,
  If[Head[u]===If,
    u,
  TrigSimplifyAux[Map[TrigSimplifyRecur,u]]]]

Clear[TrigSimplifyAux]


(* Basis: a*z^m+b*z^n == z^m*(a+b*z^(n-m)) *)
TrigSimplifyAux[u_.*(a_.*v_^m_.+b_.*v_^n_.)^p_] :=
  u*v^(m*p)*TrigSimplifyAux[a+b*v^(n-m)]^p /;
InertTrigQ[v] && IntegerQ[p] && RationalQ[m,n] && m<n


(* ::Subsubsection:: *)
(*Basis: Sin[z]^2+Cos[z]^2==1*)


(* ::Subsubsection:: *)
(*Basis: Sec[z]^2-Tan[z]^2==1*)


(* ::Subsubsection::Closed:: *)
(*Basis: Csc[z]^2-Cot[z]^2==1*)


TrigSimplifyAux[a_.*cos[u_]^2+b_.*sin[u_]^2+v_.] := a+v /; a===b

TrigSimplifyAux[a_.*sec[u_]^2+b_.*tan[u_]^2+v_.] := a+v /; a===-b

TrigSimplifyAux[a_.*csc[u_]^2+b_.*cot[u_]^2+v_.] := a+v /; a===-b


(* ::Subsubsection::Closed:: *)
(*Basis: a Cos[z]^2==a-a Sin[z]^2*)


TrigSimplifyAux[(a_.*cos[u_]^2+b_.*sin[u_]^2+v_.)^n_] := 
  ((b-a)*Sin[u]^2+a+v)^n


(* Basis: 1-Sin[z]^2 == Cos[z]^2 *)
TrigSimplifyAux[u_+v_.*sin[z_]^2+w_.] := u*Cos[z]^2+w /; u===-v

(* Basis: 1-Cos[z]^2 == Sin[z]^2 *)
TrigSimplifyAux[u_+v_.*cos[z_]^2+w_.] := u*Sin[z]^2+w /; u===-v

(* Basis: 1+Tan[z]^2 == Sec[z]^2 *)
TrigSimplifyAux[u_+v_.*tan[z_]^2+w_.] := u*Sec[z]^2+w /; u===v

(* Basis: 1+Cot[z]^2 == Csc[z]^2 *)
TrigSimplifyAux[u_+v_.*cot[z_]^2+w_.] := u*Csc[z]^2+w /; u===v

(* Basis: -1+Sec[z]^2 == Tan[z]^2 *)
TrigSimplifyAux[u_+v_.*sec[z_]^2+w_.] := v*Tan[z]^2+w /; u===-v

(* Basis: -1+Csc[z]^2 == Cot[z]^2 *)
TrigSimplifyAux[u_+v_.*csc[z_]^2+w_.] := v*Cot[z]^2+w /; u===-v


(* Basis: If a^2-b^2==0, Sin[z]^2/(a+b*Cos[z]) == 1/a-Cos[z]/b *)
TrigSimplifyAux[u_.*sin[v_]^2/(a_+b_.*cos[v_])] := u*(1/a - Cos[v]/b) /; EqQ[a^2-b^2,0]

(* Basis: If a^2-b^2==0, Cos[z]^2/(a+b*Sin[z]) == 1/a-Sin[z]/b *)
TrigSimplifyAux[u_.*cos[v_]^2/(a_+b_.*sin[v_])] := u*(1/a - Sin[v]/b) /; EqQ[a^2-b^2,0]


(* Basis: If n is an integer, Tan[z]^n/(a+b*Tan[z]^n) == 1/(b+a*Cot[z]^n) *)
TrigSimplifyAux[u_.*tan[v_]^n_./(a_+b_.*tan[v_]^n_.)] := u/(b+a*Cot[v]^n) /; IGtQ[n,0] && NonsumQ[a]

(* Basis: If n is an integer, Cot[z]^n/(a+b*Cot[z]^n) == 1/(b+a*Tan[z]^n) *)
TrigSimplifyAux[u_.*cot[v_]^n_./(a_+b_.*cot[v_]^n_.)] := u/(b+a*Tan[v]^n) /; IGtQ[n,0] && NonsumQ[a]

(* Basis: If n is an integer, Sec[z]^n/(a+b*Sec[z]^n) == 1/(b+a*Cos[z]^n) *)
TrigSimplifyAux[u_.*sec[v_]^n_./(a_+b_.*sec[v_]^n_.)] := u/(b+a*Cos[v]^n) /; IGtQ[n,0] && NonsumQ[a]

(* Basis: If n is an integer, Csc[z]^n/(a+b*Csc[z]^n) == 1/(b+a*Sin[z]^n) *)
TrigSimplifyAux[u_.*csc[v_]^n_./(a_+b_.*csc[v_]^n_.)] := u/(b+a*Sin[v]^n) /; IGtQ[n,0] && NonsumQ[a]


(* Basis: If n is an integer, Tan[z]^n/(a+b*Sec[z]^n) == Sin[z]^n/(b+a*Cos[z]^n) *)
TrigSimplifyAux[u_.*tan[v_]^n_./(a_+b_.*sec[v_]^n_.)] := u*Sin[v]^n/(b+a*Cos[v]^n) /; IGtQ[n,0] && NonsumQ[a]

(* Basis: If n is an integer, Cot[z]^n/(a+b*Csc[z]^n) == Cos[z]^n/(b+a*Sin[z]^n) *)
TrigSimplifyAux[u_.*cot[v_]^n_./(a_+b_.*csc[v_]^n_.)] := u*Cos[v]^n/(b+a*Sin[v]^n) /; IGtQ[n,0] && NonsumQ[a]


(* ::Subsubsection::Closed:: *)
(*Basis: a Sec[z]+b Tan[z]==Sec[z](a+b Sin[z])*)


TrigSimplifyAux[u_.*(a_.*sec[v_]^n_.+b_.*tan[v_]^n_.)^p_.] :=
  u*Sec[v]^(n*p)*(a+b*Sin[v]^n)^p /;
IntegersQ[n,p]

TrigSimplifyAux[u_.*(a_.*csc[v_]^n_.+b_.*cot[v_]^n_.)^p_.] :=
  u*Csc[v]^(n*p)*(a+b*Cos[v]^n)^p /;
IntegersQ[n,p]


(* ::Subsubsection::Closed:: *)
(*Basis: a Tan[z]+b Sin[z]==Tan[z](a+b Cos[z])*)


TrigSimplifyAux[u_.*(a_.*tan[v_]^n_.+b_.*sin[v_]^n_.)^p_.] :=
  u*Tan[v]^(n*p)*(a+b*Cos[v]^n)^p /;
IntegersQ[n,p]

TrigSimplifyAux[u_.*(a_.*cot[v_]^n_.+b_.*cos[v_]^n_.)^p_.] :=
  u*Cot[v]^(n*p)*(a+b*Sin[v]^n)^p /;
IntegersQ[n,p]


(* ::Subsubsection:: *)
(*Basis: a+b Tan[z]+c Sec[z]==(c+b Sin[z]+a Cos[z])/Cos[z]*)


(* ::Subsubsection:: *)
(*Basis: a+b Tan[z]+c Sec[z]==Sec[z] (c+b Sin[z]+a Cos[z])*)


(* ::Subsubsection:: *)
(*Basis: a+b Cot[z]+c Csc[z]==(c+b Cos[z]+a Sin[z])/Sin[z]*)


(* ::Subsubsection::Closed:: *)
(*Basis: a+b Cot[z]+c Csc[z]==Csc[z] (c+b Cos[z]+a Sin[z])*)


TrigSimplifyAux[u_.*cos[v_]^m_.*(a_.+b_.*tan[v_]^n_.+c_.*sec[v_]^n_.)^p_.] :=
  u*Cos[v]^(m-n*p)*(c+b*Sin[v]^n+a*Cos[v]^n)^p /;
IntegersQ[m,n,p]

TrigSimplifyAux[u_.*sec[v_]^m_.*(a_.+b_.*tan[v_]^n_.+c_.*sec[v_]^n_.)^p_.] :=
  u*Sec[v]^(m+n*p)*(c+b*Sin[v]^n+a*Cos[v]^n)^p /;
IntegersQ[m,n,p]

TrigSimplifyAux[u_.*sin[v_]^m_.*(a_.+b_.*cot[v_]^n_.+c_.*csc[v_]^n_.)^p_.] :=
  u*Sin[v]^(m-n*p)*(c+b*Cos[v]^n+a*Sin[v]^n)^p /;
IntegersQ[m,n,p]

TrigSimplifyAux[u_.*csc[v_]^m_.*(a_.+b_.*cot[v_]^n_.+c_.*csc[v_]^n_.)^p_.] :=
  u*Csc[v]^(m+n*p)*(c+b*Cos[v]^n+a*Sin[v]^n)^p /;
IntegersQ[m,n,p]


(* ::Subsubsection:: *)
(*Basis: If n\[Element]\[DoubleStruckCapitalZ], then  a Csc[z]^m+b Sin[z]^n==(a+b Sin[z]^(m+n))/Sin[z]^m*)


(* ::Subsubsection::Closed:: *)
(*Basis: If n\[Element]\[DoubleStruckCapitalZ], then  a Sec[z]^m+b Cos[z]^n==(a+b Cos[z]^(m+n))/Cos[z]^m*)


TrigSimplifyAux[u_.*(a_.*csc[v_]^m_.+b_.*sin[v_]^n_.)^p_.] :=
  If[EqQ[m+n-2,0] && EqQ[a+b,0],
    u*(a*Cos[v]^2/Sin[v]^m)^p,
  u*((a+b*Sin[v]^(m+n))/Sin[v]^m)^p] /;
IntegersQ[m,n]

TrigSimplifyAux[u_.*(a_.*sec[v_]^m_.+b_.*cos[v_]^n_.)^p_.] :=
  If[EqQ[m+n-2,0] && EqQ[a+b,0],
    u*(a*Sin[v]^2/Cos[v]^m)^p,
  u*((a+b*Cos[v]^(m+n))/Cos[v]^m)^p] /;
IntegersQ[m,n]


(* (* Basis: Csc[z]+Cot[z] == Cot[z/2] *)
TrigSimplifyAux[(a_.*csc[v_]+b_.*cot[v_])^n_] := a^n*Cot[v/2]^n /; EvenQ[n] && EqQ[a-b,0]

(* Basis: Csc[z]-Cot[z] == Tan[z/2] *)
TrigSimplifyAux[(a_.*csc[v_]+b_.*cot[v_])^n_] := a^n*Tan[v/2]^n /; EvenQ[n] && EqQ[a+b,0] *)


(* (* Basis: Sin[z]*(a+b*Cot[z]) == a*Sin[z] + b*Cos[z] *)
(* TrigSimplifyAux[u_*sin[v_]^m_.*(a_.+b_.*cot[v_]^2)^p_.] :=
  u*(b*Cos[v]^2+a*Sin[v]^2)^p /;
IntegersQ[m,p] && m==2*p *)

(* Basis: a+b*Cot[z] == (b*Cos[z]+a*Sin[z])/Sin[z] *)
TrigSimplifyAux[u_.*sin[v_]^m_.*(a_.+b_.*cot[v_]^n_.)^p_.] :=
  u*Sin[v]^(m-n*p)*(b*Cos[v]^n+a*Sin[v]^n)^p /;
IntegersQ[m,n,p]

(* Basis: Cos[z]*(a+b*Tan[z]) == a*Cos[z] + b*Sin[z] *)
(* TrigSimplifyAux[u_*cos[v_]^m_.*(a_.+b_.*tan[v_]^2)^p_.] :=
  u*(b*Sin[v]^2+a*Cos[v]^2)^p /;
IntegersQ[m,p] && m==2*p *)

(* Basis: a+b*Tan[z] == (b*Sin[z]+a*Cos[z])/Cos[z] *)
TrigSimplifyAux[u_.*cos[v_]^m_.*(a_.+b_.*tan[v_]^n_.)^p_.] :=
  u*Cos[v]^(m-n*p)*(b*Sin[v]^n+a*Cos[v]^n)^p /;
IntegersQ[m,n,p]

(* Basis: (a+b*Tan[z])/Sec[z] == a*Cos[z] + b*Sin[z] *)
TrigSimplifyAux[u_*sec[v_]^m_.*(a_.+b_.*tan[v_]^2)^p_.] :=
  u*(b*Sin[v]^2+a*Cos[v]^2)^p /;
IntegersQ[m,p] && m+2*p==0

(* Basis: (a+b*Cot[z])/Csc[z] == a*Sin[z] + b*Cos[z] *)
TrigSimplifyAux[u_*csc[v_]^m_.*(a_.+b_.*cot[v_]^2)^p_.] :=
  u*(b*Cos[v]^2+a*Sin[v]^2)^p /;
IntegersQ[m,p] && m+2*p==0 *)


(* (* Basis: If n is an integer, Sin[z]^(-n)*(a*Cos[z]^n+b*Sin[z]^n) == b+a*Cot[z]^n *)
TrigSimplifyAux[sin[v_]^m_.*(a_.*cos[v_]^n_.+b_.*sin[v_]^n_.)^p_] :=
  (b+a*Cot[v]^n)^p /;
IntegersQ[m,n,p] && n>0 && p<0 && m==-n*p

(* Basis: If n is an integer, Cos[z]^(-n)*(a*Cos[z]^n+b*Sin[z]^n) == a+b*Tan[z]^n *)
TrigSimplifyAux[cos[v_]^m_.*(a_.*cos[v_]^n_.+b_.*sin[v_]^n_.)^p_] :=
  (a+b*Tan[v]^n)^p /;
IntegersQ[m,n,p] && n>0 && p<0 && m==-n*p *)


(* (* Basis: If a^2+b^2=0, 1/(a*Cos[z] + b*Sin[z]) == Cos[z]/a + Sin[z]/b *)
TrigSimplifyAux[(a_.*cos[v_]+b_.*sin[v_])^n_] :=
  (Cos[v]/a + Sin[v]/b)^(-n) /;
IntegerQ[n] && n<0 && EqQ[a^2+b^2,0] *)


TrigSimplifyAux[u_] := u


(* ::Subsubsection::Closed:: *)
(*Basis: Tan[z] Tan[2 z]==-1+Sec[2 z]*)


TrigSimplifyAux[u_.*(c_.*tan[v_]^n_.*tan[w_]^n_.)^p_.] :=
  u*((-c+c*sec[w])^n)^p /;
IntegerQ[n] && EqQ[w,2*v]


(* ::Subsection::Closed:: *)
(*IntPart[u]*)


IntPart::usage = "IntPart[u] returns the sum of the integer terms of u.";
IntPart[m_*u_,n_:1] :=
  IntPart[u,m*n] /;
RationalQ[m]

IntPart[u_,n_:1] :=
  If[RationalQ[u],
    IntegerPart[n*u],
  If[SumQ[u],
    Map[Function[IntPart[#,n]],u],
  0]]


(* ::Subsection::Closed:: *)
(*FracPart[u]*)


FracPart::usage = "FracPart[u] returns the sum of the non-integer terms of u.";
FracPart[m_*u_,n_:1] :=
  FracPart[u,m*n] /;
RationalQ[m]

FracPart[u_,n_:1] :=
  If[RationalQ[u],
    FractionalPart[n*u],
  If[SumQ[u],
    Map[Function[FracPart[#,n]],u],
  n*u]]


(* ::Section::Closed:: *)
(*Factoring functions*)


(* ::Subsection::Closed:: *)
(*ContentFactor*)


(* Basis: a*b+a*c == a*(b+c) *)
ContentFactor::usage = "ContentFactor[expn] returns expn with the content of sum factors factored out.";
ContentFactor[expn_] :=
  TimeConstrained[ContentFactorAux[expn],$TimeLimit,expn];

ContentFactorAux[expn_] :=
  If[AtomQ[expn],
    expn,
  If[IntegerPowerQ[expn],
    If[SumQ[expn[[1]]] && NumericFactor[expn[[1,1]]]<0,
      (-1)^expn[[2]] * ContentFactorAux[-expn[[1]]]^expn[[2]],
    ContentFactorAux[expn[[1]]]^expn[[2]]],
  If[ProductQ[expn],
    Module[{num=1,tmp},
    tmp=Map[Function[If[SumQ[#] && NumericFactor[#[[1]]]<0, num=-num; ContentFactorAux[-#], ContentFactorAux[#]]], expn];
    num*UnifyNegativeBaseFactors[tmp]],
  If[SumQ[expn],
    With[{lst=CommonFactors[Apply[List,expn]]},
    If[lst[[1]]===1 || lst[[1]]===-1,
      expn,
    lst[[1]]*Apply[Plus,Rest[lst]]]],
  expn]]]]


(* FWIW: This simplification should be done automatically by the host CAS! *)
UnifyNegativeBaseFactors::usage = "UnifyNegativeBaseFactors[u] returns u with factors of the form (-v)^m and v^n where n is an integer replaced with (-1)^n*(-v)^(m+n).";
UnifyNegativeBaseFactors[u_.*(-v_)^m_*v_^n_.] :=
  UnifyNegativeBaseFactors[(-1)^n*u*(-v)^(m+n)] /;
IntegerQ[n]

UnifyNegativeBaseFactors[u_] :=
  u


CommonFactors::usage = "If lst is a list of n terms, CommonFactors[lst] returns a n+1-element list whose first element is the product of the factors common to all terms of lst, and whose remaining elements are quotients of each term divided by the common factor.";
CommonFactors[lst_] :=
  Module[{lst1,lst2,lst3,lst4,common,base,num},
  lst1=Map[NonabsurdNumberFactors,lst];
  lst2=Map[AbsurdNumberFactors,lst];
  num=Apply[AbsurdNumberGCD,lst2];
  common=num;
  lst2=Map[Function[#/num],lst2];
  While[True,
    lst3=Map[LeadFactor,lst1];
    ( If[Apply[SameQ,lst3],
        common=common*lst3[[1]];
        lst1=Map[RemainingFactors,lst1],
      If[EveryQ[Function[LogQ[#] && IntegerQ[First[#]] && First[#]>0],lst3] &&
           EveryQ[RationalQ,lst4=Map[Function[FullSimplify[#/First[lst3]]],lst3]],
        num=Apply[GCD,lst4];
        common=common*Log[(First[lst3][[1]])^num];
        lst2=Map2[Function[#1*#2/num],lst2,lst4];
        lst1=Map[RemainingFactors,lst1],
      lst4=Map[LeadDegree,lst1];
      If[Apply[SameQ,Map[LeadBase,lst1]] && EveryQ[RationalQ,lst4],
        num=Smallest[lst4];
        base=LeadBase[lst1[[1]]];
        ( If[num!=0,
            common=common*base^num] );
        lst2=Map2[Function[#1*base^(#2-num)],lst2,lst4];
        lst1=Map[RemainingFactors,lst1],
      If[Length[lst1]==2 && EqQ[LeadBase[lst1[[1]]]+LeadBase[lst1[[2]]],0] && 
         NeQ[lst1[[1]],1] && IntegerQ[lst4[[1]]] && FractionQ[lst4[[2]]],
        num=Min[lst4];
        base=LeadBase[lst1[[2]]];
        ( If[num!=0,
            common=common*base^num] );
        lst2={lst2[[1]]*(-1)^lst4[[1]],lst2[[2]]};
        lst2=Map2[Function[#1*base^(#2-num)],lst2,lst4];
        lst1=Map[RemainingFactors,lst1],
      If[Length[lst1]==2 && EqQ[LeadBase[lst1[[1]]]+LeadBase[lst1[[2]]],0] && 
         NeQ[lst1[[2]],1] && IntegerQ[lst4[[2]]] && FractionQ[lst4[[1]]],
        num=Min[lst4];
        base=LeadBase[lst1[[1]]];
        ( If[num!=0,
            common=common*base^num] );
        lst2={lst2[[1]],lst2[[2]]*(-1)^lst4[[2]]};
        lst2=Map2[Function[#1*base^(#2-num)],lst2,lst4];
        lst1=Map[RemainingFactors,lst1],
      num=MostMainFactorPosition[lst3];
      lst2=ReplacePart[lst2,lst3[[num]]*lst2[[num]],num];      
      lst1=ReplacePart[lst1,RemainingFactors[lst1[[num]]],num]]]]]] );
    If[EveryQ[Function[#===1],lst1],
      Return[Prepend[lst2,common]]]]]


MostMainFactorPosition[lst_List] :=
  Module[{factor=1,num=1,ii},
  Do[If[FactorOrder[lst[[ii]],factor]>0,factor=lst[[ii]];num=ii],{ii,Length[lst]}];
  num]


FactorOrder[u_,v_] :=
  If[u===1,
    If[v===1,
      0,
    -1],
  If[v===1,
    1,
  Order[u,v]]]


Smallest[num1_,num2_] :=
  If[num1>0,
    If[num2>0,
      Min[num1,num2],
    0],
  If[num2>0,
    0,
  Max[num1,num2]]]

Smallest[lst_List] :=
  Module[{num=lst[[1]]},
  Scan[Function[num=Smallest[num,#]],Rest[lst]];
  num]


(* ::Subsection::Closed:: *)
(*MonomialFactor*)


MonomialFactor::usage = "MonomialFactor[u,x] returns the list {n,v} where x^n*v==u and n is free of x.";
MonomialFactor[u_,x_Symbol] :=
  If[AtomQ[u],
    If[u===x,
      {1,1},
    {0,u}],
  If[PowerQ[u],
    If[IntegerQ[u[[2]]],
      With[{lst=MonomialFactor[u[[1]],x]},
      {lst[[1]]*u[[2]],lst[[2]]^u[[2]]}],
    If[u[[1]]===x && FreeQ[u[[2]],x],
      {u[[2]],1},
    {0,u}]],
  If[ProductQ[u],
    With[{lst1=MonomialFactor[First[u],x],lst2=MonomialFactor[Rest[u],x]},
    {lst1[[1]]+lst2[[1]],lst1[[2]]*lst2[[2]]}],
  If[SumQ[u],
    Module[{lst,deg},
    lst=Map[Function[MonomialFactor[#,x]],Apply[List,u]];
    deg=lst[[1,1]];
    Scan[Function[deg=MinimumDegree[deg,#[[1]]]],Rest[lst]];
    If[EqQ[deg,0] || RationalQ[deg] && deg<0,
      {0,u},
    {deg,Apply[Plus,Map[Function[x^(#[[1]]-deg)*#[[2]]],lst]]}]],
  {0,u}]]]]


MinimumDegree[deg1_,deg2_] :=
  If[RationalQ[deg1],
    If[RationalQ[deg2],
      Min[deg1,deg2],
    deg1],
  If[RationalQ[deg2],
    deg2,
  With[{deg=Simplify[deg1-deg2]},
  If[RationalQ[deg],
    If[deg>0,
      deg2,
    deg1],
  If[OrderedQ[{deg1,deg2}],
    deg1,
  deg2]]]]]


(* ::Subsection::Closed:: *)
(*ConstantFactor*)


ConstantFactor::usage = "ConstantFactor[u,x] returns a 2-element list of the factors of u[x] free of x and the factors not free of u[x].  Common constant factors of the terms of sums are also collected.";
ConstantFactor[u_,x_Symbol] :=
  If[FreeQ[u,x],
    {u,1},
  If[AtomQ[u],
    {1,u},
  If[PowerQ[u] && FreeQ[u[[2]],x],
    Module[{lst=ConstantFactor[u[[1]],x],tmp},
    If[IntegerQ[u[[2]]],
      {lst[[1]]^u[[2]],lst[[2]]^u[[2]]},
    tmp=PositiveFactors[lst[[1]]];
    If[tmp===1,
      {1,u},
    {tmp^u[[2]],(NonpositiveFactors[lst[[1]]]*lst[[2]])^u[[2]]}]]],
  If[ProductQ[u],
    With[{lst=Map[Function[ConstantFactor[#,x]],Apply[List,u]]},
    {Apply[Times,Map[First,lst]],Apply[Times,Map[Function[#[[2]]],lst]]}],
  If[SumQ[u],
    With[{lst1=Map[Function[ConstantFactor[#,x]],Apply[List,u]]},
    If[Apply[SameQ,Map[Function[#[[2]]],lst1]],
      {Apply[Plus,Map[First,lst1]],lst1[[1,2]]},
    With[{lst2=CommonFactors[Map[First,lst1]]},
    {First[lst2],Apply[Plus,Map2[Times,Rest[lst2],Map[Function[#[[2]]],lst1]]]}]]],
  {1,u}]]]]]


PositiveFactors::usage = "PositiveFactors[u] returns the positive factors of u.";
PositiveFactors[u_] :=
  If[EqQ[u,0],
    1,
  If[RationalQ[u],
    Abs[u],
  If[GtQ[u,0],
    u,
  If[ProductQ[u],
    Map[PositiveFactors,u],
  1]]]]


NonpositiveFactors::usage = "NonpositiveFactors[u] returns the nonpositive factors of u.";
NonpositiveFactors[u_] :=
  If[EqQ[u,0],
    u,
  If[RationalQ[u],
    Sign[u],
  If[GtQ[u,0],
    1,
  If[ProductQ[u],
    Map[NonpositiveFactors,u],
  u]]]]


(* ::Section::Closed:: *)
(*Generalized polynomial functions*)


(* ::Subsection::Closed:: *)
(*PolynomialInQ*)


(* ::Item:: *)
(*If u is a polynomial in v[x], PolynomialInQ[u,v,x] returns True; else it returns False.*)


PolynomialInQ[u_,v_,x_Symbol] :=
  PolynomialInAuxQ[u,NonfreeFactors[NonfreeTerms[v,x],x],x]


PolynomialInAuxQ[u_,v_,x_] :=
  If[u===v,
    True,
  If[AtomQ[u],
    u=!=x,
  If[PowerQ[u],
    If[PowerQ[v] && u[[1]]===v[[1]],
      IGtQ[u[[2]]/v[[2]],0],
    IGtQ[u[[2]],0] && PolynomialInAuxQ[u[[1]],v,x]],
  If[SumQ[u] || ProductQ[u],
    Catch[Scan[Function[If[Not[PolynomialInAuxQ[#,v,x]],Throw[False]]],u];True],
  False]]]]


(* ::Subsection::Closed:: *)
(*ExponentIn*)


(* ::Item:: *)
(*If u[v] is a polynomial in w, GeneralizedExponent[u,v,x] returns the degree of the u[x].*)


ExponentIn[u_,v_,x_Symbol] :=
  ExponentInAux[u,NonfreeFactors[NonfreeTerms[v,x],x],x]


ExponentInAux[u_,v_,x_] :=
  If[u===v,
    1,
  If[AtomQ[u],
    0,
  If[PowerQ[u],
    If[PowerQ[v] && u[[1]]===v[[1]],
      u[[2]]/v[[2]],
    u[[2]]*ExponentInAux[u[[1]],v,x]],
  If[ProductQ[u],
    Apply[Plus,Map[Function[ExponentInAux[#,v,x]],Apply[List,u]]],
  Apply[Max,Map[Function[ExponentInAux[#,v,x]],Apply[List,u]]]]]]]


(* ::Subsection::Closed:: *)
(*PolynomialInSubst*)


(* ::Item:: *)
(*If u is a polynomial in v[x], PolynomialInSubst[u,v,x] returns the polynomial u in x.*)


PolynomialInSubst[u_,v_,x_Symbol] :=
  With[{w=NonfreeTerms[v,x]},
  ReplaceAll[PolynomialInSubstAux[u,NonfreeFactors[w,x],x],{x->(x-FreeTerms[v,x])/FreeFactors[w,x]}]]


PolynomialInSubstAux[u_,v_,x_] :=
  If[u===v,
    x,
  If[AtomQ[u],
    u,
  If[PowerQ[u],
    If[PowerQ[v] && u[[1]]===v[[1]],
      x^(u[[2]]/v[[2]]),
    PolynomialInSubstAux[u[[1]],v,x]^u[[2]]],
  Map[Function[PolynomialInSubstAux[#,v,x]],u]]]]


(* ::Subsection::Closed:: *)
(*PolynomialDivide*)


PolynomialDivide::usage = "If u and v are polynomials in x, PolynomialDivide[u,v,x] returns the polynomial quotient of u and v plus the polynomial remainder divided by v.
If u[w] and v[w] are polynomials in w, PolynomialDivide[u,v,w,x] returns the polynomial quotient of u[x] and v[x] plus the polynomial remainder divided by v[x] with x replaced by w.";
PolynomialDivide[u_,v_,x_Symbol] :=
  Module[{quo=PolynomialQuotient[u,v,x],rem=PolynomialRemainder[u,v,x],free,monomial},
  quo=Apply[Plus,Map[Function[Simp[Together[Coefficient[quo,x,#]*x^#],x]],Exponent[quo,x,List]]];
  rem=Together[rem];
  free=FreeFactors[rem,x];
  rem=NonfreeFactors[rem,x];
  monomial=x^Exponent[rem,x,Min];
  If[NegQ[Coefficient[rem,x,0]], monomial=-monomial];
  rem=Apply[Plus,Map[Function[Simp[Together[Coefficient[rem,x,#]*x^#/monomial],x]],Exponent[rem,x,List]]];
(*rem=Simplify[rem]; *)
  If[BinomialQ[v,x],
    quo+free*monomial*rem/ExpandToSum[v,x],
  quo+free*monomial*rem/v]]


PolynomialDivide[u_,v_,w_,x_Symbol] :=
  ReplaceAll[PolynomialDivide[PolynomialInSubst[u,w,x],PolynomialInSubst[v,w,x],x],{x->w}]


(* ::Section::Closed:: *)
(*Expansion functions*)


(* ::Subsection::Closed:: *)
(*ExpandToSum[u,x]*)


(* ::Item:: *)
(*ExpandToSum[u,v,x] returns v expanded into a sum of monomials of x and distributes u over v.*)


ExpandToSum[u_,v_,x_Symbol] :=
  Module[{w=ExpandToSum[v,x],r},
  r=NonfreeTerms[w,x];
  If[SumQ[r],
    u*FreeTerms[w,x]+Map[Function[MergeMonomials[u*#,x]],r],
  u*FreeTerms[w,x]+MergeMonomials[u*r,x]]]


(* ::Item:: *)
(*ExpandToSum[u,x] returns u expanded into a sum of monomials of x.*)


ExpandToSum::error = "Unrecognized expression for expansion.";

ExpandToSum[u_,x_Symbol] :=
  If[PolyQ[u,x],
    Simp[Apply[Plus,Map[Function[Coeff[u,x,#]*x^#], Expon[u,x,List]]],x],
  If[BinomialQ[u,x],
    Function[#[[1]] + #[[2]]*x^#[[3]]][BinomialParts[u,x]],
  If[TrinomialQ[u,x],
    Function[#[[1]] + #[[2]]*x^#[[4]] + #[[3]]*x^(2*#[[4]])][TrinomialParts[u,x]],
  If[GeneralizedBinomialQ[u,x],
    Function[#[[1]]*x^#[[4]] + #[[2]]*x^#[[3]]][GeneralizedBinomialParts[u,x]],
  If[GeneralizedTrinomialQ[u,x],
    Function[#[[1]]*x^#[[5]] + #[[2]]*x^#[[4]] + #[[3]]*x^(2*#[[4]]-#[[5]])][GeneralizedTrinomialParts[u,x]],
  Message[ExpandToSum::error];
  Expand[u,x]]]]]]


(* ::Subsection::Closed:: *)
(*ExpandTrig[u,x]*)


ExpandTrig[u_,x_Symbol] :=
  ActivateTrig[ExpandIntegrand[u,x]]

ExpandTrig[u_,v_,x_Symbol] :=
  With[{w=ExpandTrig[v,x],z=ActivateTrig[u]},
  If[SumQ[w],
    Map[Function[z*#],w],
  z*w]]


(* ::Subsection::Closed:: *)
(*ExpandIntegrand[u,v,x]*)


Clear[ExpandIntegrand];


ExpandIntegrand[(a_.+b_.*Log[c_.*x_^n_.])^p_.,x_^m_.*(d_+e_.*x_^r_.)^q_.,x_Symbol] :=
  DistributeOverTerms[(a+b*Log[c*x^n])^p,CollectRecipTerms[ExpandIntegrand[x^m*(d+e*x^r)^q,x],x],x] /;
FreeQ[{a,b,c,d,e,n},x] && IGtQ[p,0] && IGtQ[r,0] && ILtQ[m,0] && ILtQ[q,0]   && EqQ[r,1]


ExpandIntegrand[u_,v_,x_Symbol] :=
  DistributeOverTerms[u,ExpandIntegrand[v,x],x]


DistributeOverTerms[u_,v_,x_Symbol] :=
  With[{w=NonfreeTerms[v,x]},
  u*FreeTerms[v,x] + If[SumQ[w], 
    Map[Function[MergeMonomials[u*#,x]],w], 
    MergeMonomials[u*w,x]]]


CollectRecipTerms[u_.+A_./x_+B_./(d_+e_.*x_),x_Symbol] :=
  u+A*d/(x*(d+e*x)) /;
FreeQ[{A,B,d,e},x] && EqQ[B+A*e,0]

CollectRecipTerms[u_,x_Symbol] := u


(* ::Subsection::Closed:: *)
(*ExpandIntegrand[u,x]*)


(* ExpandIntegrand[u_,x_Symbol] :=
  With[{nn=FunctionOfPower[u,x]},
  ReplaceAll[ExpandIntegrand[SubstFor[x^nn,u,x],x],x->x^nn] /;
 nn!=1] *)


ExpandIntegrand[u_^p_.,x_Symbol] :=
  If[EqQ[p,1],
    ExpandCleanup[u,x],
  ExpandCleanup[Expand[u^p,x],x]] /;
SumQ[u] && IGtQ[p,0]


ExpandIntegrand[(a_+b_.*x_^n_)^p_.,x_Symbol] :=
  ExpandIntegrand[x^(n*p)*(b+a*x^(-n))^p,x] /;
IntegerQ[p] && ILtQ[n,0]

ExpandIntegrand[x_^m_.*(a_+b_.*x_^n_)^p_.,x_Symbol] :=
  ExpandIntegrand[x^(m+n*p)*(b+a*x^(-n))^p,x] /;
IntegerQ[p] && ILtQ[n,0]


ExpandIntegrand[Px_.*x_^m_*(b_.*x_^n_.+c_.*x_^n1_)^p_.,x_Symbol] :=
  ExpandIntegrand[Px*x^(m+n*p)*(b+c*x)^p,x] /;
FreeQ[{b,c,m},x] && PolyQ[Px,x] && IGtQ[n,0] && EqQ[n1,n+1] && IntegerQ[p]

ExpandIntegrand[Px_.*(b_.*x_^n_.+c_.*x_^n1_)^p_.,x_Symbol] :=
  ExpandIntegrand[Px*x^(n*p)*(b+c*x)^p,x] /;
FreeQ[{b,c},x] && PolyQ[Px,x] && IGtQ[n,0] && EqQ[n1,n+1] && IntegerQ[p]


ExpandIntegrand[(a_.+b_.*F_^u_)^p_.*(c_.+d_.*F_^v_)^q_.,x_Symbol] :=
  With[{k=Simplify[u/v]},
  ReplaceAll[ExpandIntegrand[(a+b*x^Numerator[k])^p*(c+d*x^Denominator[k])^q,x],x->F^(v/Denominator[k])] /;
 RationalQ[k]] /;
FreeQ[{F,a,b,c,d},x] && IntegersQ[p,q]


(* ::Subsubsection::Closed:: *)
(*Basis: (a+b x)^m/(c+d x)==(b (a+b x)^(m-1))/d+((a d-b c) (a+b x)^(m-1))/(d (c+d x))*)


ExpandIntegrand[(a_.+b_.*x_)^m_.*F_^(e_.*(c_.+d_.*x_)^n_.)/(g_.+h_.*x_),x_Symbol] :=
  With[{tmp=a*h-b*g},
  Module[{k},
  SimplifyTerm[tmp^m/h^m,x]*F^(e*(c+d*x)^n)/(g+h*x) + 
	Sum[SimplifyTerm[b*tmp^(k-1)/h^k,x]*F^(e*(c+d*x)^n)*(a+b*x)^(m-k),{k,1,m}]]] /;
FreeQ[{F,a,b,c,d,e,g,h},x] && IGtQ[m,0] && EqQ[b*c-a*d,0]


ExpandIntegrand[x_^m_.*(e_+f_.*x_)^p_.*F_^(b_.*(c_.+d_.*x_)^n_.),x_Symbol] :=
  If[IGtQ[m,0] && IGtQ[p,0] && m<=p && (EqQ[n,1] || EqQ[d*e-c*f,0]),
    ExpandLinearProduct[(e+f*x)^p*F^(b*(c+d*x)^n),x^m,e,f,x],
  If[IGtQ[p,0],
    Distribute[x^m*F^(b*(c+d*x)^n)*Expand[(e+f*x)^p,x],Plus,Times],
  ExpandIntegrand[F^(b*(c+d*x)^n),x^m*(e+f*x)^p,x]]] /;
FreeQ[{F,b,c,d,e,f,m,n,p},x]


ExpandIntegrand[x_^m_.*(e_+f_.*x_)^p_.*F_^(a_.+b_.*(c_.+d_.*x_)^n_.),x_Symbol] :=
  If[IGtQ[m,0] && IGtQ[p,0] && m<=p && (EqQ[n,1] || EqQ[d*e-c*f,0]),
    ExpandLinearProduct[(e+f*x)^p*F^(a+b*(c+d*x)^n),x^m,e,f,x],
  If[IGtQ[p,0],
    Distribute[x^m*F^(a+b*(c+d*x)^n)*Expand[(e+f*x)^p,x],Plus,Times],
  ExpandIntegrand[F^(a+b*(c+d*x)^n),x^m*(e+f*x)^p,x]]] /;
FreeQ[{F,a,b,c,d,e,f,m,n,p},x]


ExpandIntegrand[u_.*(a_+b_.*F_^v_)^m_.*(c_+d_.*F_^v_)^n_,x_Symbol] :=
  With[{w=ReplaceAll[ExpandIntegrand[(a+b*x)^m*(c+d*x)^n,x],x->F^v]},
  Map[Function[u*#],w] /;
 SumQ[w]] /;
FreeQ[{F,a,b,c,d},x] && IntegersQ[m,n] && n<0


ExpandIntegrand[u_*(a_.+b_.*x_)^m_.*F_^(e_.*(c_.+d_.*x_)^n_.),x_Symbol] :=
  With[{v=ExpandIntegrand[u*(a+b*x)^m,x]},
  Distribute[F^(e*(c+d*x)^n)*v,Plus,Times] /;
 SumQ[v]] /;
FreeQ[{F,a,b,c,d,e,m,n},x] && PolynomialQ[u,x]


ExpandIntegrand[u_*(a_.+b_.*x_)^m_.*Log[c_.*(d_.+e_.*x_^n_.)^p_.],x_Symbol] :=
  ExpandIntegrand[Log[c*(d+e*x^n)^p],u*(a+b*x)^m,x] /; 
FreeQ[{a,b,c,d,e,m,n,p},x] && PolynomialQ[u,x]


ExpandIntegrand[u_*F_^(e_.*(c_.+d_.*x_)^n_.),x_Symbol] :=
  If[EqQ[n,1],
    ExpandIntegrand[F^(e*(c+d*x)^n),u,x],
  ExpandLinearProduct[F^(e*(c+d*x)^n),u,c,d,x]] /;
FreeQ[{F,c,d,e,n},x] && PolynomialQ[u,x]


ExpandIntegrand[F_[u_]^m_.*(a_+b_.*G_[u_])^n_.,x_Symbol] :=
  ReplaceAll[ExpandIntegrand[(a+b*x)^n/x^m,x],x->G[u]] /;
FreeQ[{a,b},x] && IntegersQ[m,n] && F[u]*G[u]===1


ExpandIntegrand[u_*(a_.+b_.*Log[c_.*(d_.*(e_.+f_.*x_)^p_.)^q_.])^n_,x_Symbol] :=
  ExpandLinearProduct[(a+b*Log[c*(d*(e+f*x)^p)^q])^n,u,e,f,x] /;
FreeQ[{a,b,c,d,e,f,n,p,q},x] && PolynomialQ[u,x]


ExpandIntegrand[u_*(a_.+b_.*F_[c_.+d_.*x_])^n_,x_Symbol] :=
  ExpandLinearProduct[(a+b*F[c+d*x])^n,u,c,d,x] /;
FreeQ[{a,b,c,d,n},x] && PolynomialQ[u,x] && MemberQ[{ArcSin,ArcCos,ArcSinh,ArcCosh},F]


(* ::Subsubsection::Closed:: *)
(*Basis: 1/(a x^n+b Sqrt[c+d x^(2 n)])==(a x^n-b Sqrt[c+d x^(2 n)])/(-b^2 c+(a^2-b^2 d) x^(2 n))*)


ExpandIntegrand[u_./(a_.*x_^n_+b_.*Sqrt[c_+d_.*x_^j_]),x_Symbol] :=
  ExpandIntegrand[u*(a*x^n-b*Sqrt[c+d*x^(2*n)])/(-b^2*c+(a^2-b^2*d)*x^(2*n)),x] /;
FreeQ[{a,b,c,d,n},x] && EqQ[j,2*n]


(* ::Subsubsection::Closed:: *)
(*Basis: (a+b x)^m/(c+d x)==(b (a+b x)^(m-1))/d+((a d-b c) (a+b x)^(m-1))/(d (c+d x))*)


ExpandIntegrand[(a_+b_.*x_)^m_/(c_+d_.*x_),x_Symbol] :=
  If[RationalQ[a,b,c,d],
    ExpandExpression[(a+b*x)^m/(c+d*x),x],
  With[{tmp=a*d-b*c},
  Module[{k},
  SimplifyTerm[tmp^m/d^m,x]/(c+d*x) + Sum[SimplifyTerm[b*tmp^(k-1)/d^k,x]*(a+b*x)^(m-k),{k,1,m}]]]] /;
FreeQ[{a,b,c,d},x] && IGtQ[m,0]


(* ::Subsubsection::Closed:: *)
(*Basis: ((a+b x)^m (A+B x))/(c+d x)==(B (a+b x)^m)/d+((A d-B c) (a+b x)^m)/(d (c+d x))*)


ExpandIntegrand[(a_+b_.*x_)^m_.*(A_+B_.*x_)/(c_+d_.*x_),x_Symbol] :=
  If[RationalQ[a,b,c,d,A,B],
    ExpandExpression[(a+b*x)^m*(A+B*x)/(c+d*x),x],
(*  PolynomialDivide[(a+b*x)^m*(A+B*x),c+d*x,x], *)
  Module[{tmp1,tmp2},
  tmp1=(A*d-B*c)/d;
  tmp2=ExpandIntegrand[(a+b*x)^m/(c+d*x),x];
  tmp2=If[SumQ[tmp2], Map[Function[SimplifyTerm[tmp1*#,x]],tmp2], SimplifyTerm[tmp1*tmp2,x]];
  SimplifyTerm[B/d,x]*(a+b*x)^m + tmp2]] /;
FreeQ[{a,b,c,d,A,B},x] && IGtQ[m,0]


ExpandIntegrand[u_*(a_+b_.*x_)^m_.*(c_+d_.*x_)^n_.,x_Symbol] :=
  ExpandIntegrand[(c+d*x)^n,u*(a+b*x)^m,x] /;
FreeQ[{a,b,c,d,m,n},x] && PolynomialQ[u,x] && Not[IntegerQ[m]] && IGtQ[n-m,0]


ExpandIntegrand[u_*(a_+b_.*x_)^m_.,x_Symbol] :=
  With[{sum1=ExpandLinearProduct[(a+b*x)^m,u,a,b,x]},
  If[Not[IntegerQ[m]] || m>2 && LinearQ[u,x],
    sum1,
  With[{sum2=ExpandExpression[u*(a+b*x)^m,x]},
(* With[{sum2=If[EqQ[m,-1], PolynomialDivide[u,a+b*x,x], ExpandExpression[u*(a+b*x)^m,x]]}, *)
  If[SumQ[sum2],
    If[m>0,
      If[Length[sum2]<=Exponent[u,x]+2 || LeafCount[sum2]<=2/3*LeafCount[sum1],
        sum2,
      sum1],
    If[LeafCount[sum2]<=LeafCount[sum1]+2,
      sum2,
    sum1]],
  sum1]]]] /;
FreeQ[{a,b,m},x] && PolynomialQ[u,x] && 
  Not[IGtQ[m,0] && MatchQ[u,w_.*(c_+d_.*x)^p_ /; FreeQ[{c,d},x] && IntegerQ[p] && p>m]]


ExpandIntegrand[u_*v_^n_*(a_+b_.*x_)^m_,x_Symbol] :=
  Function[ExpandIntegrand[#[[1]]*(a+b*x)^FractionalPart[m],x] + ExpandIntegrand[#[[2]]*v^n*(a+b*x)^m,x]][
    PolynomialQuotientRemainder[u,v^(-n)*(a+b*x)^(-IntegerPart[m]),x]]/;
FreeQ[{a,b,m},x] && ILtQ[n,0] && Not[IntegerQ[m]] && PolynomialQ[u,x] && PolynomialQ[v,x] && 
  RationalQ[m] && m<-1 && Exponent[u,x]>=-(n+IntegerPart[m])*Exponent[v,x]


ExpandIntegrand[u_*v_^n_*(a_+b_.*x_)^m_,x_Symbol] :=
  Function[ExpandIntegrand[#[[1]]*(a+b*x)^m,x] + ExpandIntegrand[#[[2]]*v^n*(a+b*x)^m,x]][PolynomialQuotientRemainder[u,v^(-n),x]]/;
FreeQ[{a,b,m},x] && ILtQ[n,0] && Not[IntegerQ[m]] && PolynomialQ[u,x] && PolynomialQ[v,x] && 
  Exponent[u,x]>=-n*Exponent[v,x]


(* ::Subsubsection::Closed:: *)
(*Basis: Let r/s=(-a/b)^(1/3), then  1/(a+b z^3)==r/(3a(r-s z))+(r(2 r+s z))/(3a(r^2+r s z+s^2 z^2))*)


(* ExpandIntegrand[1/(a_+b_.*u_^3),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,3]],s=Denominator[Rt[-a/b,3]]},
  r/(3*a*(r-s*u)) + r*(2*r+s*u)/(3*a*(r^2+r*s*u+s^2*u^2))] /;
FreeQ[{a,b},x] *)


(* ::Subsubsection::Closed:: *)
(*Basis: Let r/s=Sqrt[-a/b], then  1/(a+b z^2)==r/(2a(r-s z))+r/(2a(r+s z))*)


ExpandIntegrand[1/(a_+b_.*u_^n_),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,2]],s=Denominator[Rt[-a/b,2]]},
  r/(2*a*(r-s*u^(n/2))) + r/(2*a*(r+s*u^(n/2)))] /;
FreeQ[{a,b},x] && IGtQ[n/2,0]


(* ::Subsubsection::Closed:: *)
(*Basis: Let r/s=Sqrt[-a/b], then  (c+d z)/(a+b z^2) == -s (d r+c s)/(2 b r (r-s z))+s (d r-c s)/(2 b r (r+s z))*)


ExpandIntegrand[(c_+d_.*u_^n_)/(a_+b_.*u_^n2_),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,2]],s=Denominator[Rt[-a/b,2]]},
  -s*(d*r+c*s)/(2*b*r*(r-s*u^n)) + s*(d*r-c*s)/(2*b*r*(r+s*u^n))] /;
FreeQ[{a,b,c,d},x] && IGtQ[n,0] && EqQ[n2,2*n]


(* ::Subsubsection::Closed:: *)
(*Basis: (a+b z)^m (c+d z) == d/b (a+b z)^(m+1)+(b c-a d)/b (a+b z)^m*)


ExpandIntegrand[(a_+b_.*u_)^m_*(c_.+d_.*u_),x_Symbol] :=
  d/b*(a+b*u)^(m+1) + (b*c-a*d)/b*(a+b*u)^m /;
FreeQ[{a,b,c,d},x] && ILtQ[m,0]


(* ::Subsubsection::Closed:: *)
(*Basis: If  n\[Element]\[DoubleStruckCapitalZ]+, let r/s=(-a/b)^(1/n), then  1/(a+b*z^n) == (r*Sum[1/(r - (-1)^(2*(k/n))*s*z), {k, 1, n}])/(a*n)*)


ExpandIntegrand[1/(a_+b_.*u_^n_),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,n]],s=Denominator[Rt[-a/b,n]]},
  Module[{k},
  Sum[r/(a*n*(r-(-1)^(2*k/n)*s*u)),{k,1,n}]]] /;
FreeQ[{a,b},x] && IGtQ[n,1]


(* ::Subsubsection::Closed:: *)
(*Basis: If (m|n)\[Element]\[DoubleStruckCapitalZ] \[And] 0<=m<n, let r/s=(-a/b)^(1/n), then  (c + d*z^m)/(a + b*z^n) == (r*Sum[(c + (d*(r/s)^m)/(-1)^(2*k*(m/n)))/(r - (-1)^(2*(k/n))*s*z), {k, 1, n}])/(a*n)*)


ExpandIntegrand[(c_+d_.*u_^m_.)/(a_+b_.*u_^n_),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,n]],s=Denominator[Rt[-a/b,n]]},
  Module[{k},
  Sum[(r*c+r*d*(r/s)^m*(-1)^(-2*k*m/n))/(a*n*(r-(-1)^(2*k/n)*s*u)),{k,1,n}]]] /;
FreeQ[{a,b,c,d},x] && IntegersQ[m,n] && 0<m<n


(* ::Subsubsection::Closed:: *)
(*Basis: If (m|n,p)\[Element]\[DoubleStruckCapitalZ] \[And] 0<=m<p<n, let r/s=(-a/b)^(1/n), then  (c + d*z^m + e*z^p)/(a + b*z^n) == (r*Sum[(c + (d*(r/s)^m)/(-1)^(2*k*(m/n)) + (e*(r/s)^p)/(-1)^(2*k*(p/n)))/(r - (-1)^(2*(k/n))*s*z), {k, 1, n}])/(a*n)*)


ExpandIntegrand[(c_.+d_.*u_^m_.+e_.*u_^p_)/(a_+b_.*u_^n_),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,n]],s=Denominator[Rt[-a/b,n]]},
  Module[{k},
  Sum[(r*c+r*d*(r/s)^m*(-1)^(-2*k*m/n)+r*e*(r/s)^p*(-1)^(-2*k*p/n))/(a*n*(r-(-1)^(2*k/n)*s*u)),{k,1,n}]]] /;
FreeQ[{a,b,c,d,e},x] && IntegersQ[m,n,p] && 0<m<p<n


(* ::Subsubsection::Closed:: *)
(*Basis: If (m|n,p,q)\[Element]\[DoubleStruckCapitalZ] \[And] 0<=m<p<q<n, let r/s=(-a/b)^(1/n), then  (c + d*z^m + e*z^p + f*z^q)/(a + b*z^n) == (r*Sum[(c + (d*(r/s)^m)/(-1)^(2*k*(m/n)) + (e*(r/s)^p)/(-1)^(2*k*(p/n)) + (f*(r/s)^q)/(-1)^(2*k*(q/n)))/(r - (-1)^(2*(k/n))*s*z), {k, 1, n}])/(a*n)*)


ExpandIntegrand[(c_.+d_.*u_^m_.+e_.*u_^p_+f_.*u_^q_)/(a_+b_.*u_^n_),x_Symbol] :=
  With[{r=Numerator[Rt[-a/b,n]],s=Denominator[Rt[-a/b,n]]},
  Module[{k},
  Sum[(r*c+r*d*(r/s)^m*(-1)^(-2*k*m/n)+r*e*(r/s)^p*(-1)^(-2*k*p/n)+r*f*(r/s)^q*(-1)^(-2*k*q/n))/(a*n*(r-(-1)^(2*k/n)*s*u)),{k,1,n}]]] /;
FreeQ[{a,b,c,d,e,f},x] && IntegersQ[m,n,p,q] && 0<m<p<q<n


(* ::Subsubsection::Closed:: *)
(*Basis: If  q=Sqrt[-a c], then a+c z^2==((-q+c z)(q+c z))/c*)


ExpandIntegrand[(a_+c_.*u_^n_)^p_,x_Symbol] :=
  Module[{q},
  ReplaceAll[ExpandIntegrand[1/c^p,(-q+c*x)^p*(q+c*x)^p,x],{q->Rt[-a*c,2],x->u^(n/2)}]] /;
FreeQ[{a,c},x] && EvenQ[n] && ILtQ[p,0]


ExpandIntegrand[u_^m_.*(a_.+c_.*u_^n_)^p_,x_Symbol] :=
  Module[{q},
  ReplaceAll[ExpandIntegrand[1/c^p,x^m*(-q+c*x^(n/2))^p*(q+c*x^(n/2))^p,x],{q->Rt[-a*c,2],x->u}]] /;
FreeQ[{a,c},x] && IntegersQ[m,n/2] && ILtQ[p,0] && 0<m<n && m!=n/2


(* ::Subsubsection::Closed:: *)
(*Basis: If  n\[Element]\[DoubleStruckCapitalZ]+, then  a+b*z^n == -b*Product[(-a/b)^(1/n)-(-1)^((2*k)/n)*z, {k, 1, n}]*)


ExpandIntegrand[(a_+b_.*x_^n_)^p_,x_Symbol] :=
  With[{q=Rt[-a/b,n]},
  Module[{ii},
  ExpandIntegrand[(-b)^p,Product[(q-(-1)^((2*ii)/n)*x)^p,{ii,1,n}],x]]] /;
FreeQ[{a,b},x] && IGtQ[n,1] && ILtQ[p,-1]


(* ::Subsubsection::Closed:: *)
(*Basis: If  q=Sqrt[b^2-4 a c], then a+b z+c z^2 == (b-q+2 c z)(b+q+2 c z)/(4 c)*)


ExpandIntegrand[(a_.+b_.*u_^n_.+c_.*u_^n2_.)^p_,x_Symbol] :=
  Module[{q},
  ReplaceAll[ExpandIntegrand[1/(4^p*c^p),(b-q+2*c*x)^p*(b+q+2*c*x)^p,x],{q->Rt[b^2-4*a*c,2],x->u^n}]] /;
FreeQ[{a,b,c},x] && IntegerQ[n] && EqQ[n2,2*n] && ILtQ[p,0] && NeQ[b^2-4*a*c,0]


ExpandIntegrand[u_^m_.*(a_.+b_.*u_^n_.+c_.*u_^n2_.)^p_,x_Symbol] :=
  Module[{q},
  ReplaceAll[ExpandIntegrand[1/(4^p*c^p),x^m*(b-q+2*c*x^n)^p*(b+q+2*c*x^n)^p,x],{q->Rt[b^2-4*a*c,2],x->u}]] /;
FreeQ[{a,b,c},x] && IntegersQ[m,n,n2] && EqQ[n2,2*n] && ILtQ[p,0] && 0<m<2*n && Not[m==n && p==-1] && NeQ[b^2-4*a*c,0]


(* ::Subsubsection::Closed:: *)
(*Basis: If  q=Sqrt[-a/b], then (c+d z)/(a+b z^2)==-((c-d q)/(2 b q(q+z)))-(c+d q)/(2 b q(q-z))*)


ExpandIntegrand[(c_+d_.*u_^n_.)/(a_+b_.*u_^n2_.),x_Symbol] :=
  With[{q=Rt[-a/b,2]},
  -(c-d*q)/(2*b*q*(q+u^n)) - (c+d*q)/(2*b*q*(q-u^n))] /;
FreeQ[{a,b,c,d,n},x] && EqQ[n2,2*n]


(* ::Subsubsection::Closed:: *)
(*Basis: If  q=Sqrt[b^2-4a c] and r=(2 c d-b e)/q, then (d+e z)/(a+b z+c z^2)==(e+r)/(b-q+2 c z)+(e-r)/(b+q+2 c z)*)


ExpandIntegrand[(d_.+e_.*(f_.+g_.*u_^n_.))/(a_.+b_.*u_^n_.+c_.*u_^n2_.),x_Symbol] :=
  With[{q=Rt[b^2-4*a*c,2]}, With[{r=TogetherSimplify[(2*c*(d+e*f)-b*e*g)/q]},
  (e*g+r)/(b-q+2*c*u^n) + (e*g-r)/(b+q+2*c*u^n)]] /;
FreeQ[{a,b,c,d,e,f,g,n},x] && EqQ[n2,2*n] && NeQ[b^2-4*a*c,0]


(* ::Subsubsection::Closed:: *)
(*Basis: Miscellaneous*)


(* ExpandIntegrand[u_/v_,x_Symbol] :=
  With[{lst=CoefficientList[u,x]},
  Module[{i},
  lst[[-1]]*x^Exponent[u,x]/v + Sum[lst[[i]]*x^(i-1),{i,1,Exponent[u,x]}]/v]] /;
PolynomialQ[u,x] && PolynomialQ[v,x] && BinomialQ[v,x] && Exponent[u,x]==Exponent[v,x]-1>=2 *)


ExpandIntegrand[u_/v_,x_Symbol] :=
  PolynomialDivide[u,v,x] /;
PolynomialQ[u,x] && PolynomialQ[v,x] && Exponent[u,x]>=Exponent[v,x]


ExpandIntegrand[u_*(a_.*x_)^p_,x_Symbol] :=
  ExpandToSum[(a*x)^p,u,x] /;
Not[IntegerQ[p]] && PolynomialQ[u,x]


ExpandIntegrand[u_.*v_^p_,x_Symbol] :=
  ExpandIntegrand[NormalizeIntegrand[v^p,x],u,x] /;
Not[IntegerQ[p]]


ExpandIntegrand[u_,x_Symbol] :=
  With[{v=ExpandExpression[u,x]},
    v /;
 SumQ[v]]


ExpandIntegrand[u_^m_./(a_+b_.*u_^n_),x_Symbol] :=
  ExpandBinomial[a,b,m,n,u,x] /;
FreeQ[{a,b},x] && IntegersQ[m,n] && 0<m<n


ExpandIntegrand[u_,x_Symbol] := u


(* ::Subsection::Closed:: *)
(*ExpandExpression[u,x]*)


ExpandExpression[u_,x_Symbol] :=
  Module[{v,w},
  v=If[AlgebraicFunctionQ[u,x] && Not[RationalFunctionQ[u,x]], ExpandAlgebraicFunction[u,x], 0];
  If[SumQ[v],
    ExpandCleanup[v,x],
  v=SmartApart[u,x];
  If[SumQ[v],
    ExpandCleanup[v,x],
  v=SmartApart[RationalFunctionFactors[u,x],x,x];
  If[SumQ[v],
    w=NonrationalFunctionFactors[u,x];
    ExpandCleanup[Map[Function[#*w],v],x],
  v=Expand[u,x];
  If[SumQ[v],
    ExpandCleanup[v,x],
  v=Expand[u];
  If[SumQ[v],
    ExpandCleanup[v,x],
  SimplifyTerm[u,x]]]]]]]


(* ::Subsection::Closed:: *)
(*ExpandCleanup[u,x]*)


ExpandCleanup[u_+v_/(a_+b_.*x_)+w_/(c_+d_.*x_),x_Symbol] :=
  ExpandCleanup[u+(c*v+a*w)/(a*c+b*d*x^2),x] /;
FreeQ[{a,b,c,d},x] && EqQ[b*c+a*d,0] && EqQ[d*v+b*w,0]


ExpandCleanup[u_,x_Symbol] :=
  Module[{v=CollectReciprocals[u,x]},
  If[SumQ[v],
    v=Map[Function[SimplifyTerm[#,x]],v];
    If[SumQ[v],
      UnifySum[v,x],
    v],
  v]]


(* ::Subsubsection::Closed:: *)
(*Basis: e/(a+b x)+f/(c+d x)==(c e+a f+(d e+b f) x)/(a c+(b c+a d) x+b d x^2)*)


CollectReciprocals[u_+e_/(a_+b_.*x_)+f_/(c_+d_.*x_),x_Symbol] :=
  CollectReciprocals[u+(c*e+a*f)/(a*c+b*d*x^2),x] /;
FreeQ[{a,b,c,d,e,f},x] && EqQ[b*c+a*d,0] && EqQ[d*e+b*f,0] 

CollectReciprocals[u_+e_/(a_+b_.*x_)+f_/(c_+d_.*x_),x_Symbol] :=
  CollectReciprocals[u+(d*e+b*f)*x/(a*c+b*d*x^2),x] /;
FreeQ[{a,b,c,d,e,f},x] && EqQ[b*c+a*d,0] && EqQ[c*e+a*f,0]

CollectReciprocals[u_,x_Symbol] := u


(* ::Subsection::Closed:: *)
(*ExpandBinomial[u,x]*)


(* ::Subsubsection:: *)
(*Basis: If  (m|(n-1)/2)\[Element]\[DoubleStruckCapitalZ] \[And] 0<=m<n, let r/s=(a/b)^(1/n), then z^m/(a + b*z^n) == (r*(-(r/s))^m*Sum[1/((-1)^(2*k*(m/n))*(r + (-1)^(2*(k/n))*s*z)), {k, 1, n}])/(a*n) == (r*(-(r/s))^m*Sum[(-1)^(2*k*((m + 1)/n))/((-1)^(2*(k/n))*r + s*z), {k, 1, n}])/(a*n)*)


(* ::Subsubsection:: *)
(*Basis: If  r/s=(-a/b)^(1/2), then z/(a+b z^2)==s/(2b(r+s z))-s/(2b(r-s z))==r^2/(2 a s (r-s z))-r^2/(2 a s (r+s z))*)


(* ::Subsubsection:: *)
(*Basis: If (m|n)\[Element]\[DoubleStruckCapitalZ] \[And] 0<=m<n, let r/s=(-a/b)^(1/n), then  z^m/(a + b*z^n) == (r*(r/s)^m*Sum[1/((-1)^(2*k*(m/n))*(r - (-1)^(2*(k/n))*s*z)), {k, 1, n}])/(a*n) == (r*(r/s)^m*Sum[(-1)^(2*k*((m + 1)/n))/((-1)^(2*(k/n))*r - s*z), {k, 1, n}])/(a*n)*)


(* ::Subsubsection:: *)
(*Note: If  m+1 and n are not coprime, the second summation is used since the coefficient (-1)^(2 k (m+1)/n) will be simpler.*)


(* ::Subsubsection::Closed:: *)
(*Note: The code reduces the exponents by their gcd.*)


ExpandBinomial::usage = "Assumes m and n are integers and 0<m<n. ExpandBinomial[a,b,m,n,u,x] expands u^m/(a+b*u^n) into a sum of terms of the form 1/(r+s*u).";
ExpandBinomial[a_,b_,m_,n_,u_,x_Symbol] :=
  If[OddQ[n/GCD[m,n]] && PosQ[a/b],
    With[{g=GCD[m,n],r=Numerator[Rt[a/b,n/GCD[m,n]]],s=Denominator[Rt[a/b,n/GCD[m,n]]]},
    Module[{k},
    If[CoprimeQ[m+g,n],
      Sum[r*(-r/s)^(m/g)*(-1)^(-2*k*m/n)/(a*n*(r+(-1)^(2*k*g/n)*s*u^g)),{k,1,n/g}],
    Sum[r*(-r/s)^(m/g)*(-1)^(2*k*(m+g)/n)/(a*n*((-1)^(2*k*g/n)*r+s*u^g)),{k,1,n/g}]]]],
  With[{g=GCD[m,n],r=Numerator[Rt[-a/b,n/GCD[m,n]]],s=Denominator[Rt[-a/b,n/GCD[m,n]]]},
  If[n/g==2,
    s/(2*b*(r+s*u^g)) - s/(2*b*(r-s*u^g)),
  Module[{k},
  If[CoprimeQ[m+g,n],
    Sum[r*(r/s)^(m/g)*(-1)^(-2*k*m/n)/(a*n*(r-(-1)^(2*k*g/n)*s*u^g)),{k,1,n/g}],
  Sum[r*(r/s)^(m/g)*(-1)^(2*k*(m+g)/n)/(a*n*((-1)^(2*k*g/n)*r-s*u^g)),{k,1,n/g}]]]]]]


(* ::Subsection::Closed:: *)
(*SmartApart[u,x]*)


SmartApart::usage = "SmartApart[u,x] returns the partial fraction expansion of u wrt x, avoiding the undesired side-effects of Apart[u,x]."


(* Apart[u,x] has the side-effect of factoring out -1 from terms having negative integer powers of linears when the coefficient of x is negative. *)
(* SmartApart[Px_.*(a_.+b_.*x_)^m_,x_Symbol] :=
  Module[{$a,$b},
  ReplaceAll[Apart[Px*($a+$b*x)^m,x],{$a->a,$b->b}]] /;
FreeQ[{a,b},x] && ILtQ[m,0] && PolynomialQ[Px,x] *)


(* SmartApart[Px_.*(a_.+b_.*x_)^m_*(c_.+d_.*x_)^n_,x_Symbol] :=
  Module[{$a,$b,$c,$d},
  ReplaceAll[Apart[Px*($a+$b*x)^m*($c+$d*x)^n,x],{$a->a,$b->b,$c->c,$d->d}]] /;
FreeQ[{a,b,c,d},x] && ILtQ[m,0] && ILtQ[n,0] && PolynomialQ[Px,x] *)


(* Apart[u,x] rationalizes denominators involving fractional powers resulting in hard to integrate expressions. *)
SmartApart[u_,x_Symbol] :=
  With[{alst=MakeAssocList[u,x]},
  With[{tmp=KernelSubst[Apart[GensymSubst[u,x,alst]],x,alst]},
  If[tmp===Indeterminate, u, tmp]]]

SmartApart[u_,v_,x_Symbol] :=
  With[{alst=MakeAssocList[u,x]},
  With[{tmp=KernelSubst[Apart[GensymSubst[u,x,alst],v],x,alst]},
  If[tmp===Indeterminate, u, tmp]]]


MakeAssocList::usage = "MakeAssocList[u,x,alst] returns an association list of gensymed symbols with the nonatomic parameters of a u that are not integer powers, products or sums.";
MakeAssocList[u_,x_Symbol,alst_List:{}] :=
  If[AtomQ[u],
    alst,
  If[IntegerPowerQ[u],
    MakeAssocList[u[[1]],x,alst],
  If[ProductQ[u] || SumQ[u],
    MakeAssocList[Rest[u],x,MakeAssocList[First[u],x,alst]],
  If[FreeQ[u,x],
    With[{tmp=Select[alst,Function[#[[2]]===u],1]},
    If[tmp==={},
      Append[alst,{Unique["Rubi"],u}],
    alst]],
  alst]]]]


GensymSubst::usage = "GensymSubst[u,x,alst] returns u with the kernels in alst free of x replaced by gensymed names.";
GensymSubst[u_,x_Symbol,alst_List] :=
  If[AtomQ[u],
    u,
  If[IntegerPowerQ[u],
    GensymSubst[u[[1]],x,alst]^u[[2]],
  If[ProductQ[u] || SumQ[u],
    Map[Function[GensymSubst[#,x,alst]],u],
  If[FreeQ[u,x],
    With[{tmp=Select[alst,Function[#[[2]]===u],1]},
    If[tmp==={},
      u,
    tmp[[1,1]]]],
  u]]]]


KernelSubst::usage = "KernelSubst[u,x,alst] returns u with the gensymed names in alst replaced by kernels free of x.";
KernelSubst[u_,x_Symbol,alst_List] :=
  If[AtomQ[u],
    With[{tmp=Select[alst,Function[#[[1]]===u],1]},
    If[tmp==={},
      u,
    tmp[[1,2]]]],
  If[IntegerPowerQ[u],
    With[{tmp=KernelSubst[u[[1]],x,alst]},
    If[u[[2]]<0 && EqQ[tmp,0],
      Indeterminate,
    tmp^u[[2]]]],
  If[ProductQ[u] || SumQ[u],
    Map[Function[KernelSubst[#,x,alst]],u],
  u]]]


(* ::Subsection::Closed:: *)
(*IncrementalExpand[u,x]*)


IncrementalExpand[u_,v_,x_Symbol] :=
  DistributeOverTerms[u,IncrementalExpand[v,x],x]


IncrementalExpand[u_,x_Symbol] :=
  ApartCollect[SmartApart[u,x],x]


ApartCollect[u_+v_.*Px_^m_Integer+w_.*Px_^n_Integer,x_Symbol] :=
  ApartCollect[u+Together[v*Px^m+w*Px^n],x] /;
PolyQ[Px,x] && GtQ[Expon[Px,x],0] && m<0 && n<0

ApartCollect[u_,x_Symbol] := u


(* ::Subsection::Closed:: *)
(*ExpandAlgebraicFunction*)


ExpandAlgebraicFunction[u_Plus*v_,x_Symbol] :=
  Map[Function[#*v],u] /;
Not[FreeQ[u,x]]

ExpandAlgebraicFunction[u_Plus^n_*v_.,x_Symbol] :=
  With[{w=Expand[u^n,x]},
  Map[Function[#*v],w] /;
 SumQ[w]] /;
IGtQ[n,0] && Not[FreeQ[u,x]]


(* ::Subsection::Closed:: *)
(*UnifySum[u,x]*)


UnifySum::usage = "UnifySum[u,x] returns u with terms having indentical nonfree factors of x collected into a single term.";
UnifySum[u_,x_Symbol] :=
  If[SumQ[u],
    Apply[Plus,UnifyTerms[Apply[List,u],x]],  
  SimplifyTerm[u,x]]


UnifyTerms::usage = "lst is a list of terms.  UnifyTerms[lst,x] returns lst with terms collected into a single element.";
UnifyTerms[lst_,x_] :=
  If[lst==={},
    lst,
  UnifyTerm[First[lst],UnifyTerms[Rest[lst],x],x]]


UnifyTerm[term_,lst_,x_] :=
  If[lst==={},
    {term},
  With[{tmp=Simplify[First[lst]/term]},
  If[FreeQ[tmp,x],
    Prepend[Rest[lst],(1+tmp)*term],
  Prepend[UnifyTerm[term,Rest[lst],x],First[lst]]]]]


(* ::Subsection::Closed:: *)
(*ExpandLinearProduct[v,u,a,b,x]*)


ExpandLinearProduct::usage = "If u is a polynomial in x, ExpandLinearProduct[v,u,a,b,x] expands v*u into a sum of terms of the form c*v*(a+b*x)^n where n is a positive integer.";
ExpandLinearProduct[v_,u_,a_,b_,x_Symbol] :=
  Module[{lst},
  lst=CoefficientList[ReplaceAll[u,x->(x-a)/b],x];
  lst=Map[Function[SimplifyTerm[#,x]],lst];
  Module[{ii},
  Sum[v*lst[[ii]]*(a+b*x)^(ii-1),{ii,1,Length[lst]}]]] /;
FreeQ[{a,b},x] && PolynomialQ[u,x]


(* ::Subsection::Closed:: *)
(*ExpandTrigExpand[u,F,v,m,n,x]*)


ExpandTrigExpand[u_,F_,v_,m_,n_,x_Symbol] :=
  With[{w=ReplaceAll[Expand[TrigExpand[F[n*x]]^m,x],x->v]},
  If[SumQ[w],
    Map[Function[u*#],w],
  u*w]]


(* ::Subsection::Closed:: *)
(*ExpandTrigReduce[u,v,x]*)


ExpandTrigReduce[u_,v_,x_Symbol] :=
  With[{w=ExpandTrigReduce[v,x]},
  If[SumQ[w],
    Map[Function[u*#],w],
  u*w]]


(* This is necessary, because TrigReduce expands Sinh[n+v] and Cosh[n+v] to exponential form if n is a number. *)
ExpandTrigReduce[u_.*F_[n_+v_.]^m_.,x_Symbol] :=
  Module[{nn},
  ExpandTrigReduce[u*F[nn+v]^m,x] /. nn->n]/;
MemberQ[{Sinh,Cosh},F] && IntegerQ[m] && RationalQ[n]

ExpandTrigReduce[u_,x_Symbol] :=
  ExpandTrigReduceAux[u,x]


ExpandTrigReduceAux[u_,x_Symbol] :=
  With[{v=Expand[TrigReduce[u]]},
  If[SumQ[v],
    Map[Function[NormalizeTrigReduce[#,x]],v],
  NormalizeTrigReduce[v,x]]]


NormalizeTrigReduce[a_.*F_[u_]^n_.,x_Symbol] :=
  a*F[ExpandToSum[u,x]]^n /;
FreeQ[{F,a,n},x] && PolynomialQ[u,x] && Exponent[u,x]>0

NormalizeTrigReduce[u_,x_Symbol] := u


(* ::Subsection::Closed:: *)
(*ExpandTrigToExp[u,v,x]*)


Clear[ExpandTrigToExp];

ExpandTrigToExp[u_,x_Symbol] := ExpandTrigToExp[1,u,x]


ExpandTrigToExp[u_,v_,x_Symbol] :=
  Module[{w=TrigToExp[v]},
  w=If[SumQ[w], Map[Function[SimplifyIntegrand[u*#,x]],w], SimplifyIntegrand[u*w,x]];
  ExpandIntegrand[FreeFactors[w,x],NonfreeFactors[w,x],x]]


(* ::Section::Closed:: *)
(*Distribution functions*)


(* ::Subsection::Closed:: *)
(*Star[u,v]*)


Star::usage = "Star[u,v] displays as u*v, and returns the product of u and v with u distributed over the terms of v.";


DownValues[Star]={};


Star::error = "Inert multiplication by zero!";
Star[u_,v_] := (
  Message[Star::error];
  0 ) /; 
EqQ[u,0]


Star[u_,v_] := 
  Map[Function[Star[u,#]],v] /; 
SumQ[v]


Star[u_,Star[v_,w_]] := 
  Star[u*v,w]


Star[u_,v_] := 
  -Star[-u,v] /;
NumericFactor[u]<0 && NumericFactor[-u]>0


Star[u_,v_] := 
  u*v /;
Not[TrueQ[$ShowSteps]] || EqQ[u^2,1] || IntegralFreeQ[v]


Star[u_,v_*w_] := 
  Star[u*v,w] /;
IntegralFreeQ[v]


(* ::Section::Closed:: *)
(*Function of functions*)


(* ::Subsection::Closed:: *)
(*FunctionOfPower*)


(* FunctionOfPower::usage = "FunctionOfPower[u,x] returns the gcd of the integer degrees of x in u."; *)
(* FunctionOfPower[u_,x_Symbol] :=
  FunctionOfPower[u,Null,x]

FunctionOfPower[u_,n_,x_] :=
  If[FreeQ[u,x],
    n,
  If[u===x,
    1,
  If[PowerQ[u] && u[[1]]===x && IntegerQ[u[[2]]],
    If[n===Null,
      u[[2]],
    GCD[n,u[[2]]]],
  Module[{tmp=n},
    Scan[Function[tmp=FunctionOfPower[#,tmp,x]],u];
    tmp]]]] *)


(* ::Subsection::Closed:: *)
(*FunctionOfLinear*)


FunctionOfLinear::usage = "If u (x) is equivalent to an expression of the form f (a+b*x) and not the case that a==0 and b==1, FunctionOfLinear[u,x] returns the list {f (x),a,b}; else it returns False.";
FunctionOfLinear[u_,x_Symbol] :=
  With[{lst=FunctionOfLinear[u,False,False,x,False]},
  If[AtomQ[lst] || FalseQ[lst[[1]]] || lst[[1]]===0 && lst[[2]]===1,
    False,
  {FunctionOfLinearSubst[u,lst[[1]],lst[[2]],x],lst[[1]],lst[[2]]}]]


FunctionOfLinear[u_,a_,b_,x_,flag_] :=
  If[FreeQ[u,x],
    {a,b},
  If[CalculusQ[u],
    False,
  If[LinearQ[u,x],
    If[FalseQ[a],
      {Coefficient[u,x,0],Coefficient[u,x,1]},
    With[{lst=CommonFactors[{b,Coefficient[u,x,1]}]},
    If[EqQ[Coefficient[u,x,0],0] && Not[flag],
      {0,lst[[1]]},
    If[EqQ[b*Coefficient[u,x,0]-a*Coefficient[u,x,1],0],
      {a/lst[[2]],lst[[1]]},
    {0,1}]]]],
  If[PowerQ[u] && FreeQ[u[[1]],x],
    FunctionOfLinear[Log[u[[1]]]*u[[2]],a,b,x,False],
  Module[{lst},
  If[ProductQ[u] && NeQ[(lst=MonomialFactor[u,x])[[1]],0],
    If[False && IntegerQ[lst[[1]]] && lst[[1]]!=-1 && FreeQ[lst[[2]],x],
      If[RationalQ[LeadFactor[lst[[2]]]] && LeadFactor[lst[[2]]]<0,
        FunctionOfLinear[DivideDegreesOfFactors[-lst[[2]],lst[[1]]]*x,a,b,x,False],
      FunctionOfLinear[DivideDegreesOfFactors[lst[[2]],lst[[1]]]*x,a,b,x,False]],
    False],
  lst={a,b};
  Catch[
  Scan[Function[lst=FunctionOfLinear[#,lst[[1]],lst[[2]],x,SumQ[u]];
			If[AtomQ[lst],Throw[False]]],u];
  lst]]]]]]]


FunctionOfLinearSubst[u_,a_,b_,x_] :=
  If[FreeQ[u,x],
    u,
  If[LinearQ[u,x],
    Module[{tmp=Coefficient[u,x,1]},
    tmp=If[tmp===b, 1, tmp/b];
    Coefficient[u,x,0]-a*tmp+tmp*x],
  If[PowerQ[u] && FreeQ[u[[1]],x],
    E^FullSimplify[FunctionOfLinearSubst[Log[u[[1]]]*u[[2]],a,b,x]],
  Module[{lst},
  If[ProductQ[u] && NeQ[(lst=MonomialFactor[u,x])[[1]],0],
    If[RationalQ[LeadFactor[lst[[2]]]] && LeadFactor[lst[[2]]]<0,
      -FunctionOfLinearSubst[DivideDegreesOfFactors[-lst[[2]],lst[[1]]]*x,a,b,x]^lst[[1]],
    FunctionOfLinearSubst[DivideDegreesOfFactors[lst[[2]],lst[[1]]]*x,a,b,x]^lst[[1]]],
  Map[Function[FunctionOfLinearSubst[#,a,b,x]],u]]]]]]


DivideDegreesOfFactors::usage = "DivideDegreesOfFactors[u,n] returns the product of the base of the factors of u raised to the degree of the factors divided by n.";
DivideDegreesOfFactors[u_,n_] :=
  If[ProductQ[u],
    Map[Function[LeadBase[#]^(LeadDegree[#]/n)],u],
  LeadBase[u]^(LeadDegree[u]/n)]


(* ::Subsection::Closed:: *)
(*FunctionOfInverseLinear*)


FunctionOfInverseLinear::usage = "If u is a function of an inverse linear binomial of the form 1/(a+b*x), FunctionOfInverseLinear[u,x] returns the list {a,b}; else it returns False.";
FunctionOfInverseLinear[u_,x_Symbol] :=
  FunctionOfInverseLinear[u,Null,x]

FunctionOfInverseLinear[u_,lst_,x_] :=
  If[FreeQ[u,x],
    lst,
  If[u===x,
    False,
  If[QuotientOfLinearsQ[u,x],
    With[{tmp=Drop[QuotientOfLinearsParts[u,x],2]},
    If[tmp[[2]]===0,
      False,
    If[lst===Null,
      tmp,
    If[EqQ[lst[[1]]*tmp[[2]]-lst[[2]]*tmp[[1]],0],
      lst,
    False]]]],
  If[CalculusQ[u],
    False,
  Module[{tmp=lst},Catch[
  Scan[Function[If[AtomQ[tmp=FunctionOfInverseLinear[#,tmp,x]],Throw[False]]],u];
  tmp]]]]]]


(* ::Subsection::Closed:: *)
(*FunctionOfExponential*)


FunctionOfExponentialQ::usage = "FunctionOfExponentialQ[u,x] returns True iff u is a function of F^v where F is a constant and v is linear in x, and such an exponential explicitly occurs in u (i.e. not just implicitly in hyperbolic functions).";
FunctionOfExponentialQ[u_,x_Symbol] :=
  Block[{$base$=Null,$expon$=Null,$exponFlag$=False},
    FunctionOfExponentialTest[u,x] && $exponFlag$]


FunctionOfExponential::usage = "u is a function of F^v where v is linear in x.  FunctionOfExponential[u,x] returns F^v.";
FunctionOfExponential[u_,x_Symbol] :=
  Block[{$base$=Null,$expon$=Null,$exponFlag$=False},
    FunctionOfExponentialTest[u,x];
    $base$^$expon$]


FunctionOfExponentialFunction::usage = "u is a function of F^v where v is linear in x.  FunctionOfExponentialFunction[u,x] returns u with F^v replaced by x.";
FunctionOfExponentialFunction[u_,x_Symbol] :=
  Block[{$base$=Null,$expon$=Null,$exponFlag$=False},
    FunctionOfExponentialTest[u,x];
    SimplifyIntegrand[FunctionOfExponentialFunctionAux[u,x],x]]


FunctionOfExponentialFunctionAux::usage = "u is a function of F^v where v is linear in x, and the fluid variables $base$=F and $expon$=v.  FunctionOfExponentialFunctionAux[u,x] returns u with F^v replaced by x.";
FunctionOfExponentialFunctionAux[u_,x_] :=
  If[AtomQ[u],
    u,
  If[PowerQ[u] && FreeQ[u[[1]],x] && LinearQ[u[[2]],x],
    If[EqQ[Coefficient[$expon$,x,0],0],
      u[[1]]^Coefficient[u[[2]],x,0]*x^FullSimplify[Log[u[[1]]]*Coefficient[u[[2]],x,1]/(Log[$base$]*Coefficient[$expon$,x,1])],
    x^FullSimplify[Log[u[[1]]]*Coefficient[u[[2]],x,1]/(Log[$base$]*Coefficient[$expon$,x,1])]],
  If[HyperbolicQ[u] && LinearQ[u[[1]],x],
    Module[{tmp},
    tmp=x^FullSimplify[Coefficient[u[[1]],x,1]/(Log[$base$]*Coefficient[$expon$,x,1])];
    Switch[Head[u], 
      Sinh, tmp/2-1/(2*tmp),
      Cosh, tmp/2+1/(2*tmp),
      Tanh, (tmp-1/tmp)/(tmp+1/tmp),
      Coth, (tmp+1/tmp)/(tmp-1/tmp),
      Sech, 2/(tmp+1/tmp),
      Csch, 2/(tmp-1/tmp)]],
  If[PowerQ[u] && FreeQ[u[[1]],x] && SumQ[u[[2]]],
    FunctionOfExponentialFunctionAux[u[[1]]^First[u[[2]]],x]*FunctionOfExponentialFunctionAux[u[[1]]^Rest[u[[2]]],x],
  Map[Function[FunctionOfExponentialFunctionAux[#,x]],u]]]]]


FunctionOfExponentialTest::usage = "FunctionOfExponentialTest[u,x] returns True iff u is a function of F^v where F is a constant and v is linear in x.  Before it is called, the fluid variables $base$ and $expon$ should be set to Null and $exponFlag$ to False.  If u is a function of F^v, $base$ and $expon$ are set to F and v, respectively.  If an explicit exponential occurs in u, $exponFlag$ is set to True.";
FunctionOfExponentialTest[u_,x_] :=
  If[FreeQ[u,x],
    True,
  If[u===x || CalculusQ[u],
    False,
  If[PowerQ[u] && FreeQ[u[[1]],x] && LinearQ[u[[2]],x],
    $exponFlag$=True;
    FunctionOfExponentialTestAux[u[[1]],u[[2]],x],
  If[HyperbolicQ[u] && LinearQ[u[[1]],x],
    FunctionOfExponentialTestAux[E,u[[1]],x],
  If[PowerQ[u] && FreeQ[u[[1]],x] && SumQ[u[[2]]],
    FunctionOfExponentialTest[u[[1]]^First[u[[2]]],x] && FunctionOfExponentialTest[u[[1]]^Rest[u[[2]]],x],
  Catch[Scan[Function[If[Not[FunctionOfExponentialTest[#,x]],Throw[False]]],u]; True]]]]]]


FunctionOfExponentialTestAux[base_,expon_,x_] :=
  If[$base$===Null,
    $base$=base;
    $expon$=expon;
    True,
  Module[{tmp},
  tmp=FullSimplify[Log[base]*Coefficient[expon,x,1]/(Log[$base$]*Coefficient[$expon$,x,1])];
  If[Not[RationalQ[tmp]],
    False,
  If[EqQ[Coefficient[$expon$,x,0],0] || NeQ[tmp,FullSimplify[Log[base]*Coefficient[expon,x,0]/(Log[$base$]*Coefficient[$expon$,x,0])]],
    ( If[IGtQ[base,0] && IGtQ[$base$,0] && base<$base$,
        $base$=base;
        $expon$=expon;
        tmp=1/tmp] );
    $expon$=Coefficient[$expon$,x,1]*x/Denominator[tmp];
    If[tmp<0 && NegQ[Coefficient[$expon$,x,1]],
      $expon$=-$expon$;
      True,
    True],
  ( If[IGtQ[base,0] && IGtQ[$base$,0] && base<$base$,
      $base$=base;
      $expon$=expon;
      tmp=1/tmp] );
(*$expon$=If[SumQ[$expon$], Map[Function[#/Denominator[tmp]],$expon$], $expon$/Denominator[tmp]]; *)
  $expon$=$expon$/Denominator[tmp];
  If[tmp<0 && NegQ[Coefficient[$expon$,x,1]],
    $expon$=-$expon$;
    True,
  True]]]]]


(* ::Subsection::Closed:: *)
(*FunctionOfTrigOfLinearQ*)


FunctionOfTrigOfLinearQ::usage = "If u is an algebraic function of trig functions of a linear function of x, FunctionOfTrigOfLinearQ[u,x] returns True; else it returns False.";
FunctionOfTrigOfLinearQ[u_,x_Symbol] :=
  If[MatchQ[u,(c_.+d_.*x)^m_.*(a_.+b_.*trig_[e_.+f_.*x])^n_. /; FreeQ[{a,b,c,d,e,f,m,n},x] && (TrigQ[trig] || HyperbolicQ[trig])],
    True,
  Not[MemberQ[{Null, False}, FunctionOfTrig[u,Null,x]]] && AlgebraicTrigFunctionQ[u,x]]


FunctionOfTrig::usage = "If u is a function of trig functions of v where v is a linear function of x, FunctionOfTrig[u,x] returns v; else it returns False.";
FunctionOfTrig[u_,x_Symbol] :=
  With[{v=FunctionOfTrig[ActivateTrig[u],Null,x]},
  If[v===Null, False, v]]

FunctionOfTrig[u_,v_,x_] :=
  If[AtomQ[u],
    If[u===x,
      False,
    v],
  If[TrigQ[u] && LinearQ[u[[1]],x],
    If[v===Null,
      u[[1]],
    With[{a=Coefficient[v,x,0],b=Coefficient[v,x,1],c=Coefficient[u[[1]],x,0],d=Coefficient[u[[1]],x,1]},
    If[EqQ[a*d-b*c,0] && RationalQ[b/d],
      a/Numerator[b/d]+b*x/Numerator[b/d],
    False]]],
  If[HyperbolicQ[u] && LinearQ[u[[1]],x],
    If[v===Null,
      I*u[[1]],
    With[{a=Coefficient[v,x,0],b=Coefficient[v,x,1],c=I*Coefficient[u[[1]],x,0],d=I*Coefficient[u[[1]],x,1]},
    If[EqQ[a*d-b*c,0] && RationalQ[b/d],
      a/Numerator[b/d]+b*x/Numerator[b/d],
    False]]],
  If[CalculusQ[u],
    False,
  Module[{w=v},Catch[
  Scan[Function[If[FalseQ[w=FunctionOfTrig[#,w,x]],Throw[False]]],u];
  w]]]]]]


AlgebraicTrigFunctionQ::usage = "If u is algebraic function of trig functions, AlgebraicTrigFunctionQ[u,x] returns True; else it returns False.";
AlgebraicTrigFunctionQ[u_,x_Symbol] :=
  If[AtomQ[u],
    True,
  If[TrigQ[u] && LinearQ[u[[1]],x],
    True,
  If[HyperbolicQ[u] && LinearQ[u[[1]],x],
    True,
  If[PowerQ[u] && FreeQ[u[[2]],x],
    AlgebraicTrigFunctionQ[u[[1]],x],
  If[ProductQ[u] || SumQ[u],
    Catch[Scan[Function[If[Not[AlgebraicTrigFunctionQ[#,x]],Throw[False]]],u]; True],
  False]]]]]


(* ::Subsection::Closed:: *)
(*FunctionOfHyperbolic*)


FunctionOfHyperbolic::usage = "If u is a function of hyperbolic trig functions of v where v is linear in x, FunctionOfHyperbolic[u,x] returns v; else it returns False.";
FunctionOfHyperbolic[u_,x_Symbol] :=
  With[{v=FunctionOfHyperbolic[u,Null,x]},
  If[v===Null, False, v]]

FunctionOfHyperbolic[u_,v_,x_] :=
  If[AtomQ[u],
    If[u===x,
      False,
    v],
  If[HyperbolicQ[u] && LinearQ[u[[1]],x],
    If[v===Null,
      u[[1]],
    With[{a=Coefficient[v,x,0],b=Coefficient[v,x,1],c=Coefficient[u[[1]],x,0],d=Coefficient[u[[1]],x,1]},
    If[EqQ[a*d-b*c,0] && RationalQ[b/d],
      a/Numerator[b/d]+b*x/Numerator[b/d],
    False]]],
  If[CalculusQ[u],
    False,
  Module[{w=v},Catch[
  Scan[Function[If[FalseQ[w=FunctionOfHyperbolic[#,w,x]],Throw[False]]],u];
  w]]]]]


(* ::Subsection::Closed:: *)
(*FunctionOfQ*)


FunctionOfQ::usage = "v is a function of x.  If u is a function of v, FunctionOfQ[v,u,x] returns True; else it returns False.";
FunctionOfQ[v_,u_,x_Symbol,PureFlag_:False] :=
  If[FreeQ[u,x],
    False,
  If[AtomQ[v],
    True,
  If[Not[InertTrigFreeQ[u]],
    FunctionOfQ[v,ActivateTrig[u],x,PureFlag],
  If[ProductQ[v] && NeQ[FreeFactors[v,x],1],
    FunctionOfQ[NonfreeFactors[v,x],u,x,PureFlag],

  If[PureFlag, Switch[Head[v],
    Sin, PureFunctionOfSinQ[u,v[[1]],x],
    Cos, PureFunctionOfCosQ[u,v[[1]],x],
    Tan, PureFunctionOfTanQ[u,v[[1]],x],
    Cot, PureFunctionOfCotQ[u,v[[1]],x],
    Sec, PureFunctionOfCosQ[u,v[[1]],x],
    Csc, PureFunctionOfSinQ[u,v[[1]],x],

    Sinh, PureFunctionOfSinhQ[u,v[[1]],x],
    Cosh, PureFunctionOfCoshQ[u,v[[1]],x],
    Tanh, PureFunctionOfTanhQ[u,v[[1]],x],
    Coth, PureFunctionOfCothQ[u,v[[1]],x],
    Sech, PureFunctionOfCoshQ[u,v[[1]],x],
    Csch, PureFunctionOfSinhQ[u,v[[1]],x],
    _, FunctionOfExpnQ[u,v,x]=!=False],

  Switch[Head[v],
    Sin, FunctionOfSinQ[u,v[[1]],x],
    Cos, FunctionOfCosQ[u,v[[1]],x],
    Tan, FunctionOfTanQ[u,v[[1]],x],
    Cot, FunctionOfTanQ[u,v[[1]],x],
    Sec, FunctionOfCosQ[u,v[[1]],x],
    Csc, FunctionOfSinQ[u,v[[1]],x],

    Sinh, FunctionOfSinhQ[u,v[[1]],x],
    Cosh, FunctionOfCoshQ[u,v[[1]],x],
    Tanh, FunctionOfTanhQ[u,v[[1]],x],
    Coth, FunctionOfTanhQ[u,v[[1]],x],
    Sech, FunctionOfCoshQ[u,v[[1]],x],
    Csch, FunctionOfSinhQ[u,v[[1]],x],
    _, FunctionOfExpnQ[u,v,x]=!=False]]]]]]


FunctionOfExpnQ[u_,v_,x_] :=
  If[u===v,
    1,
  If[AtomQ[u],
    If[u===x,
      False,
    0],
  If[CalculusQ[u],
    False,
  If[PowerQ[u] && FreeQ[u[[2]],x],
    If[EqQ[u[[1]],v],
      If[IntegerQ[u[[2]]], u[[2]], 1],
    If[PowerQ[v] && FreeQ[v[[2]],x] && EqQ[u[[1]],v[[1]]],
      If[RationalQ[v[[2]]],
        If[RationalQ[u[[2]]] && IntegerQ[u[[2]]/v[[2]]] && (v[[2]]>0 || u[[2]]<0), u[[2]]/v[[2]], False],
      If[IntegerQ[Simplify[u[[2]]/v[[2]]]], Simplify[u[[2]]/v[[2]]], False]],
    FunctionOfExpnQ[u[[1]],v,x]]],
  If[ProductQ[u] && NeQ[FreeFactors[u,x],1],
    FunctionOfExpnQ[NonfreeFactors[u,x],v,x],
  If[ProductQ[u] && ProductQ[v],
    Module[{deg1=FunctionOfExpnQ[First[u],First[v],x],deg2},
    If[deg1===False,
      False,
    deg2=FunctionOfExpnQ[Rest[u],Rest[v],x];
    If[deg1===deg2 && FreeQ[Simplify[u/v^deg1],x],
      deg1,
    False]]],
  With[{lst=Map[Function[FunctionOfExpnQ[#,v,x]],Apply[List,u]]},
  If[MemberQ[lst,False],
    False,
  Apply[GCD,lst]]]]]]]]]


(* ::Subsubsection::Closed:: *)
(*Pure function of trig functions predicates*)


PureFunctionOfSinQ::usage = "If u is a pure function of Sin[v] and/or Csc[v], PureFunctionOfSinQ[u,v,x] returns True; else it returns False.";
PureFunctionOfSinQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && EqQ[u[[1]],v],
    Head[u]===Sin || Head[u]===Csc,
  Catch[Scan[Function[If[Not[PureFunctionOfSinQ[#,v,x]],Throw[False]]],u];True]]]]


PureFunctionOfCosQ::usage = "If u is a pure function of Cos[v] and/or Sec[v], PureFunctionOfCosQ[u,v,x] returns True; else it returns False.";
PureFunctionOfCosQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && EqQ[u[[1]],v],
    Head[u]===Cos || Head[u]===Sec,
  Catch[Scan[Function[If[Not[PureFunctionOfCosQ[#,v,x]],Throw[False]]],u];True]]]]


PureFunctionOfTanQ::usage = "If u is a pure function of Tan[v] and/or Cot[v], PureFunctionOfTanQ[u,v,x] returns True; else it returns False.";
PureFunctionOfTanQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && EqQ[u[[1]],v],
    Head[u]===Tan || Head[u]===Cot,
  Catch[Scan[Function[If[Not[PureFunctionOfTanQ[#,v,x]],Throw[False]]],u];True]]]]


PureFunctionOfCotQ::usage = "If u is a pure function of Cot[v], PureFunctionOfCotQ[u,v,x] returns True; else it returns False.";
PureFunctionOfCotQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && EqQ[u[[1]],v],
    Head[u]===Cot,
  Catch[Scan[Function[If[Not[PureFunctionOfCotQ[#,v,x]],Throw[False]]],u];True]]]]


(* ::Subsubsection::Closed:: *)
(*Function of trig functions predicates*)


FunctionOfSinQ::usage = "If u is a function of Sin[v], FunctionOfSinQ[u,v,x] returns True; else it returns False.";
FunctionOfSinQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && IntegerQuotientQ[u[[1]],v],
    If[OddQuotientQ[u[[1]],v],
(* Basis: If m odd, Sin[m*v]^n is a function of Sin[v]. *)
      Head[u]===Sin || Head[u]===Csc,
(* Basis: If m even, Cos[m*v]^n is a function of Sin[v]. *)
    Head[u]===Cos || Head[u]===Sec],
  If[IntegerPowerQ[u] && TrigQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    If[EvenQ[u[[2]]],
(* Basis: If m integer and n even, Trig[m*v]^n is a function of Sin[v]. *)
      True,
    FunctionOfSinQ[u[[1]],v,x]],
  If[ProductQ[u],
    If[Head[u[[1]]]===Cos && Head[u[[2]]]===Sin && EqQ[u[[1,1]],v/2] && EqQ[u[[2,1]],v/2],
      FunctionOfSinQ[Drop[u,2],v,x],
    Module[{lst},
    lst=FindTrigFactor[Sin,Csc,u,v,False];
    If[ListQ[lst] && EvenQuotientQ[lst[[1]],v],
(* Basis: If m even and n odd, Sin[m*v]^n == Cos[v]*u where u is a function of Sin[v]. *)
      FunctionOfSinQ[Cos[v]*lst[[2]],v,x],
    lst=FindTrigFactor[Cos,Sec,u,v,False];
    If[ListQ[lst] && OddQuotientQ[lst[[1]],v],
(* Basis: If m odd and n odd, Cos[m*v]^n == Cos[v]*u where u is a function of Sin[v]. *)
      FunctionOfSinQ[Cos[v]*lst[[2]],v,x],
    lst=FindTrigFactor[Tan,Cot,u,v,True];
    If[ListQ[lst],
(* Basis: If m integer and n odd, Tan[m*v]^n == Cos[v]*u where u is a function of Sin[v]. *)
      FunctionOfSinQ[Cos[v]*lst[[2]],v,x],
    Catch[Scan[Function[If[Not[FunctionOfSinQ[#,v,x]],Throw[False]]],u];True]]]]]],
  Catch[Scan[Function[If[Not[FunctionOfSinQ[#,v,x]],Throw[False]]],u];True]]]]]]


FunctionOfCosQ::usage = "If u is a function of Cos[v], FunctionOfCosQ[u,v,x] returns True; else it returns False.";
FunctionOfCosQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && IntegerQuotientQ[u[[1]],v],
(* Basis: If m integer, Cos[m*v]^n is a function of Cos[v]. *)
    Head[u]===Cos || Head[u]===Sec,
  If[IntegerPowerQ[u] && TrigQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    If[EvenQ[u[[2]]],
(* Basis: If m integer and n even, Trig[m*v]^n is a function of Cos[v]. *)
      True,
    FunctionOfCosQ[u[[1]],v,x]],
  If[ProductQ[u],
    Module[{lst},
    lst=FindTrigFactor[Sin,Csc,u,v,False];
    If[ListQ[lst],
(* Basis: If m integer and n odd, Sin[m*v]^n == Sin[v]*u where u is a function of Cos[v]. *)
      FunctionOfCosQ[Sin[v]*lst[[2]],v,x],
    lst=FindTrigFactor[Tan,Cot,u,v,True];
    If[ListQ[lst],
(* Basis: If m integer and n odd, Tan[m*v]^n == Sin[v]*u where u is a function of Cos[v]. *)
      FunctionOfCosQ[Sin[v]*lst[[2]],v,x],
    Catch[Scan[Function[If[Not[FunctionOfCosQ[#,v,x]],Throw[False]]],u];True]]]],
  Catch[Scan[Function[If[Not[FunctionOfCosQ[#,v,x]],Throw[False]]],u];True]]]]]]


FunctionOfTanQ::usage = "If u is a function of the form f[Tan[v],Cot[v]] where f is independent of x, FunctionOfTanQ[u,v,x] returns True; else it returns False.";
FunctionOfTanQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && IntegerQuotientQ[u[[1]],v],
    Head[u]===Tan || Head[u]===Cot || EvenQuotientQ[u[[1]],v],
  If[PowerQ[u] && EvenQ[u[[2]]] && TrigQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    True,
  If[PowerQ[u] && EvenQ[u[[2]]] && SumQ[u[[1]]],
    FunctionOfTanQ[Expand[u[[1]]^2],v,x],
  If[ProductQ[u],
    Module[{lst=ReapList[Scan[Function[If[Not[FunctionOfTanQ[#,v,x]],Sow[#]]],u]]},
    If[lst==={},
      True,
    Length[lst]==2 && OddTrigPowerQ[lst[[1]],v,x] && OddTrigPowerQ[lst[[2]],v,x]]],
  Catch[Scan[Function[If[Not[FunctionOfTanQ[#,v,x]],Throw[False]]],u];True]]]]]]]

OddTrigPowerQ[u_,v_,x_] :=
  If[MemberQ[{Sin,Cos,Sec,Csc},Head[u]],
    OddQuotientQ[u[[1]],v],
  If[PowerQ[u],
    OddQ[u[[2]]] && OddTrigPowerQ[u[[1]],v,x],
  If[ProductQ[u],
    If[NeQ[FreeFactors[u,x],1],
      OddTrigPowerQ[NonfreeFactors[u,x],v,x],
    Module[{lst=ReapList[Scan[Function[If[Not[FunctionOfTanQ[#,v,x]],Sow[#]]],u]]},
    If[lst==={},
      True,
    Length[lst]==1 && OddTrigPowerQ[lst[[1]],v,x]]]],
  If[SumQ[u],
    Catch[Scan[Function[If[Not[OddTrigPowerQ[#,v,x]],Throw[False]]],u];True],
  False]]]]


FunctionOfTanWeight::usage = "u is a function of the form f[Tan[v],Cot[v]] where f is independent of x.  FunctionOfTanWeight[u,v,x] returns a nonnegative number if u is best considered a function of Tan[v]; else it returns a negative number.";
FunctionOfTanWeight[u_,v_,x_] :=
  If[AtomQ[u],
    0,
  If[CalculusQ[u],
    0,
  If[TrigQ[u] && IntegerQuotientQ[u[[1]],v],
    If[Head[u]===Tan && EqQ[u[[1]],v],
      1,
    If[Head[u]===Cot && EqQ[u[[1]],v],
      -1,
    0]],
  If[PowerQ[u] && EvenQ[u[[2]]] && TrigQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    If[Head[u[[1]]]===Tan || Head[u[[1]]]===Cos || Head[u[[1]]]===Sec,
      1,
    -1],
  If[ProductQ[u],
    If[Catch[Scan[Function[If[Not[FunctionOfTanQ[#,v,x]],Throw[False]]],u];True],
      Apply[Plus,Map[Function[FunctionOfTanWeight[#,v,x]],Apply[List,u]]],
    0],
  Apply[Plus,Map[Function[FunctionOfTanWeight[#,v,x]],Apply[List,u]]]]]]]]


FunctionOfTrigQ::usage = "If u (x) is equivalent to an expression of the form f (Sin[v],Cos[v],Tan[v],Cot[v],Sec[v],Csc[v]) where f is independent of x, FunctionOfTrigQ[u,v,x] returns True; else it returns False.";
FunctionOfTrigQ[u_,v_,x_Symbol] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[TrigQ[u] && IntegerQuotientQ[u[[1]],v],
    True,
  Catch[
    Scan[Function[If[Not[FunctionOfTrigQ[#,v,x]],Throw[False]]],u];
    True]]]]


(* ::Subsubsection::Closed:: *)
(*Pure function of hyperbolic functions predicates*)


PureFunctionOfSinhQ::usage = "If u is a pure function of Sinh[v] and/or Csch[v], PureFunctionOfSinhQ[u,v,x] returns True; else it returns False.";
PureFunctionOfSinhQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && EqQ[u[[1]],v],
    Head[u]===Sinh || Head[u]===Csch,
  Catch[Scan[Function[If[Not[PureFunctionOfSinhQ[#,v,x]],Throw[False]]],u];True]]]]


PureFunctionOfCoshQ::usage = "If u is a pure function of Cosh[v] and/or Sech[v], PureFunctionOfCoshQ[u,v,x] returns True; else it returns False.";
PureFunctionOfCoshQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && EqQ[u[[1]],v],
    Head[u]===Cosh || Head[u]===Sech,
  Catch[Scan[Function[If[Not[PureFunctionOfCoshQ[#,v,x]],Throw[False]]],u];True]]]]


PureFunctionOfTanhQ::usage = "If u is a pure function of Tanh[v] and/or Coth[v], PureFunctionOfTanhQ[u,v,x] returns True; else it returns False.";
PureFunctionOfTanhQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && EqQ[u[[1]],v],
    Head[u]===Tanh || Head[u]===Coth,
  Catch[Scan[Function[If[Not[PureFunctionOfTanhQ[#,v,x]],Throw[False]]],u];True]]]]


PureFunctionOfCothQ::usage = "If u is a pure function of Coth[v], PureFunctionOfCothQ[u,v,x] returns True; else it returns False.";
PureFunctionOfCothQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && EqQ[u[[1]],v],
    Head[u]===Coth,
  Catch[Scan[Function[If[Not[PureFunctionOfCothQ[#,v,x]],Throw[False]]],u];True]]]]


(* ::Subsubsection::Closed:: *)
(*Function of hyperbolic functions predicates*)


FunctionOfSinhQ::usage = "If u is a function of Sinh[v], FunctionOfSinhQ[u,v,x] returns True; else it returns False.";
FunctionOfSinhQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && IntegerQuotientQ[u[[1]],v],
    If[OddQuotientQ[u[[1]],v],
(* Basis: If m odd, Sinh[m*v]^n is a function of Sinh[v]. *)
      Head[u]===Sinh || Head[u]===Csch,
(* Basis: If m even, Cos[m*v]^n is a function of Sinh[v]. *)
    Head[u]===Cosh || Head[u]===Sech],
  If[IntegerPowerQ[u] && HyperbolicQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    If[EvenQ[u[[2]]],
(* Basis: If m integer and n even, Hyper[m*v]^n is a function of Sinh[v]. *)
      True,
    FunctionOfSinhQ[u[[1]],v,x]],
  If[ProductQ[u],
    If[Head[u[[1]]]===Cosh && Head[u[[2]]]===Sinh && EqQ[u[[1,1]],v/2] && EqQ[u[[2,1]],v/2],
      FunctionOfSinhQ[Drop[u,2],v,x],
    Module[{lst},
    lst=FindTrigFactor[Sinh,Csch,u,v,False];
    If[ListQ[lst] && EvenQuotientQ[lst[[1]],v],
(* Basis: If m even and n odd, Sinh[m*v]^n == Cosh[v]*u where u is a function of Sinh[v]. *)
      FunctionOfSinhQ[Cosh[v]*lst[[2]],v,x],
    lst=FindTrigFactor[Cosh,Sech,u,v,False];
    If[ListQ[lst] && OddQuotientQ[lst[[1]],v],
(* Basis: If m odd and n odd, Cosh[m*v]^n == Cosh[v]*u where u is a function of Sinh[v]. *)
      FunctionOfSinhQ[Cosh[v]*lst[[2]],v,x],
    lst=FindTrigFactor[Tanh,Coth,u,v,True];
    If[ListQ[lst],
(* Basis: If m integer and n odd, Tanh[m*v]^n == Cosh[v]*u where u is a function of Sinh[v]. *)
      FunctionOfSinhQ[Cosh[v]*lst[[2]],v,x],
    Catch[Scan[Function[If[Not[FunctionOfSinhQ[#,v,x]],Throw[False]]],u];True]]]]]],
  Catch[Scan[Function[If[Not[FunctionOfSinhQ[#,v,x]],Throw[False]]],u];True]]]]]]


FunctionOfCoshQ::usage = "If u is a function of Cosh[v], FunctionOfCoshQ[u,v,x] returns True; else it returns False.";
FunctionOfCoshQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && IntegerQuotientQ[u[[1]],v],
(* Basis: If m integer, Cosh[m*v]^n is a function of Cosh[v]. *)
    Head[u]===Cosh || Head[u]===Sech,
  If[IntegerPowerQ[u] && HyperbolicQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    If[EvenQ[u[[2]]],
(* Basis: If m integer and n even, Hyper[m*v]^n is a function of Cosh[v]. *)
      True,
    FunctionOfCoshQ[u[[1]],v,x]],
  If[ProductQ[u],
    Module[{lst},
    lst=FindTrigFactor[Sinh,Csch,u,v,False];
    If[ListQ[lst],
(* Basis: If m integer and n odd, Sinh[m*v]^n == Sinh[v]*u where u is a function of Cosh[v]. *)
      FunctionOfCoshQ[Sinh[v]*lst[[2]],v,x],
    lst=FindTrigFactor[Tanh,Coth,u,v,True];
    If[ListQ[lst],
(* Basis: If m integer and n odd, Tanh[m*v]^n == Sinh[v]*u where u is a function of Cosh[v]. *)
      FunctionOfCoshQ[Sinh[v]*lst[[2]],v,x],
    Catch[Scan[Function[If[Not[FunctionOfCoshQ[#,v,x]],Throw[False]]],u];True]]]],
  Catch[Scan[Function[If[Not[FunctionOfCoshQ[#,v,x]],Throw[False]]],u];True]]]]]]


FunctionOfTanhQ::usage = "If u is a function of the form f[Tanh[v],Coth[v]] where f is independent of x, FunctionOfTanhQ[u,v,x] returns True; else it returns False.";
FunctionOfTanhQ[u_,v_,x_] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && IntegerQuotientQ[u[[1]],v],
    Head[u]===Tanh || Head[u]===Coth || EvenQuotientQ[u[[1]],v],
  If[PowerQ[u] && EvenQ[u[[2]]] && HyperbolicQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    True,
  If[PowerQ[u] && EvenQ[u[[2]]] && SumQ[u[[1]]],
    FunctionOfTanhQ[Expand[u[[1]]^2],v,x],
  If[ProductQ[u],
    With[{lst=ReapList[Scan[Function[If[Not[FunctionOfTanhQ[#,v,x]],Sow[#]]],u]]},
    If[lst==={},
      True,
    Length[lst]==2 && OddHyperbolicPowerQ[lst[[1]],v,x] && OddHyperbolicPowerQ[lst[[2]],v,x]]],
  Catch[Scan[Function[If[Not[FunctionOfTanhQ[#,v,x]],Throw[False]]],u];True]]]]]]]

OddHyperbolicPowerQ[u_,v_,x_] :=
  If[MemberQ[{Sinh,Cosh,Sech,Csch},Head[u]],
    OddQuotientQ[u[[1]],v],
  If[PowerQ[u],
    OddQ[u[[2]]] && OddHyperbolicPowerQ[u[[1]],v,x],
  If[ProductQ[u],
    If[NeQ[FreeFactors[u,x],1],
      OddHyperbolicPowerQ[NonfreeFactors[u,x],v,x],
    With[{lst=ReapList[Scan[Function[If[Not[FunctionOfTanhQ[#,v,x]],Sow[#]]],u]]},
    If[lst==={},
      True,
    Length[lst]==1 && OddHyperbolicPowerQ[lst[[1]],v,x]]]],
  If[SumQ[u],
    Catch[Scan[Function[If[Not[OddHyperbolicPowerQ[#,v,x]],Throw[False]]],u];True],
  False]]]]


FunctionOfTanhWeight::usage = "u is a function of the form f[Tanh[v],Coth[v]] where f is independent of x.  FunctionOfTanhWeight[u,v,x] returns a nonnegative number if u is best considered a function of Tanh[v]; else it returns a negative number.";
FunctionOfTanhWeight[u_,v_,x_] :=
  If[AtomQ[u],
    0,
  If[CalculusQ[u],
    0,
  If[HyperbolicQ[u] && IntegerQuotientQ[u[[1]],v],
    If[Head[u]===Tanh && EqQ[u[[1]],v],
      1,
    If[Head[u]===Coth && EqQ[u[[1]],v],
      -1,
    0]],
  If[PowerQ[u] && EvenQ[u[[2]]] && HyperbolicQ[u[[1]]] && IntegerQuotientQ[u[[1,1]],v],
    If[Head[u[[1]]]===Tanh || Head[u[[1]]]===Cosh || Head[u[[1]]]===Sech,
      1,
    -1],
  If[ProductQ[u],
    If[Catch[Scan[Function[If[Not[FunctionOfTanhQ[#,v,x]],Throw[False]]],u];True],
      Apply[Plus,Map[Function[FunctionOfTanhWeight[#,v,x]],Apply[List,u]]],
    0],
  Apply[Plus,Map[Function[FunctionOfTanhWeight[#,v,x]],Apply[List,u]]]]]]]]


FunctionOfHyperbolicQ::usage = "If u (x) is equivalent to a function of the form f (Sinh[v],Cosh[v],Tanh[v],Coth[v],Sech[v],Csch[v]) where f is independent of x, FunctionOfHyperbolicQ[u,v,x] returns True; else it returns False.";
FunctionOfHyperbolicQ[u_,v_,x_Symbol] :=
  If[AtomQ[u],
    u=!=x,
  If[CalculusQ[u],
    False,
  If[HyperbolicQ[u] && IntegerQuotientQ[u[[1]],v],
    True,
  Catch[Scan[Function[If[FunctionOfHyperbolicQ[#,v,x],Null,Throw[False]]],u];True]]]]


FindTrigFactor::usage = "If func[w]^m is a factor of u where m is odd and w is an integer multiple of v, FindTrigFactor[func1,func2,u,v,True] returns the list {w,u/func[w]^n}; else it returns False.  If func[w]^m is a factor of u where m is odd and w is an integer multiple of v not equal to v, FindTrigFactor[func1,func2,u,v,False] returns the list {w,u/func[w]^n}; else it returns False.";
FindTrigFactor[func1_,func2_,u_,v_,flag_] :=
  If[u===1,
    False,
  If[(Head[LeadBase[u]]===func1 || Head[LeadBase[u]]===func2) && 
		OddQ[LeadDegree[u]] && 
		IntegerQuotientQ[LeadBase[u][[1]],v] && 
		(flag || NeQ[LeadBase[u][[1]],v]),
    {LeadBase[u][[1]], RemainingFactors[u]},
  With[{lst=FindTrigFactor[func1,func2,RemainingFactors[u],v,flag]},
  If[AtomQ[lst],
    False,
  {lst[[1]], LeadFactor[u]*lst[[2]]}]]]]


IntegerQuotientQ::usage = "If u/v is an integer, IntegerQuotientQ[u,v] returns True; else it returns False.";
IntegerQuotientQ[u_,v_] :=
(* u===v || EqQ[u,v] || IntegerQ[u/v] *)
  IntegerQ[Simplify[u/v]]

OddQuotientQ::usage = "If u/v is odd, OddQuotientQ[u,v] returns True; else it returns False.";
OddQuotientQ[u_,v_] :=
(* u===v || EqQ[u,v] || OddQ[u/v] *)
  OddQ[Simplify[u/v]]

EvenQuotientQ::usage = "If u/v is even, EvenQuotientQ[u,v] returns True; else it returns False.";
EvenQuotientQ[u_,v_] :=
  EvenQ[Simplify[u/v]]


(* ::Subsection::Closed:: *)
(*FunctionOfDensePolynomialsQ*)


FunctionOfDensePolynomialsQ::usage = "If all occurrences of x in u (x) are in dense polynomials, FunctionOfDensePolynomialsQ[u,x] returns True; else it returns False.";
FunctionOfDensePolynomialsQ[u_,x_Symbol] :=
  If[FreeQ[u,x],
    True,
  If[PolynomialQ[u,x],
    Length[Exponent[u,x,List]]>1,
  Catch[
  Scan[Function[If[FunctionOfDensePolynomialsQ[#,x],Null,Throw[False]]],u];
  True]]]


(* ::Subsection::Closed:: *)
(*FunctionOfLog*)


FunctionOfLog::usage = "If u (x) is equivalent to an expression of the form f (Log[a*x^n]), FunctionOfLog[u,x] returns the list {f (x),a*x^n,n}; else it returns False.";
FunctionOfLog[u_,x_Symbol] :=
  With[{lst=FunctionOfLog[u,False,False,x]},
  If[AtomQ[lst] || FalseQ[lst[[2]]],
    False,
  lst]]


FunctionOfLog[u_,v_,n_,x_] :=
  If[AtomQ[u],
    If[u===x,
      False,
    {u,v,n}],
  If[CalculusQ[u],
    False,
  Module[{lst},
  If[LogQ[u] && ListQ[lst=BinomialParts[u[[1]],x]] && EqQ[lst[[1]],0],
    If[FalseQ[v] || u[[1]]===v,
      {x,u[[1]],lst[[3]]},
    False],
  lst={0,v,n};
  Catch[
    {Map[Function[lst=FunctionOfLog[#,lst[[2]],lst[[3]],x];
				  If[AtomQ[lst],Throw[False],lst[[1]]]],
			u],lst[[2]],lst[[3]]}]]]]]


(* ::Subsection::Closed:: *)
(*PowerVariableExpn*)


PowerVariableExpn::usage = "If m is an integer, u is an expression of the form f[(c*x)^n] and g=GCD[m,n]>1, PowerVariableExpn[u,m,x] returns the list {x^(m/g)*f[(c*x)^(n/g)],g,c}; else it returns False.";
PowerVariableExpn[u_,m_,x_Symbol] :=
  If[IntegerQ[m],
    With[{lst=PowerVariableDegree[u,m,1,x]},
    If[AtomQ[lst],
      False,
    {x^(m/lst[[1]])*PowerVariableSubst[u,lst[[1]],x], lst[[1]], lst[[2]]}]],
  False]


PowerVariableDegree[u_,m_,c_,x_Symbol] :=
  If[FreeQ[u,x],
    {m, c},
  If[AtomQ[u] || CalculusQ[u],
    False,
  If[PowerQ[u] && FreeQ[u[[1]]/x,x],
    If[EqQ[m,0] || m===u[[2]] && c===u[[1]]/x,
      {u[[2]], u[[1]]/x},
    If[IntegerQ[u[[2]]] && IntegerQ[m] && GCD[m,u[[2]]]>1 && c===u[[1]]/x,
      {GCD[m,u[[2]]], c},
    False]],
  Catch[Module[{lst={m, c}},
  Scan[Function[lst=PowerVariableDegree[#,lst[[1]],lst[[2]],x];If[AtomQ[lst],Throw[False]]],u];
  lst]]]]]


PowerVariableSubst[u_,m_,x_Symbol] :=
  If[FreeQ[u,x] || AtomQ[u] ||CalculusQ[u],
    u,
  If[PowerQ[u] && FreeQ[u[[1]]/x,x],
    x^(u[[2]]/m),
  Map[Function[PowerVariableSubst[#,m,x]],u]]]


(* ::Subsection::Closed:: *)
(*EulerIntegrandQ*)


(* ::Subsubsection::Closed:: *)
(*Note: If an Euler substitution should be used to integrate u wrt x,  EulerIntegrandQ[u,x] returns True.*)


EulerIntegrandQ[(a_.*x_+b_.*u_^n_)^p_,x_Symbol] :=
  True /;
FreeQ[{a,b},x] && IntegerQ[n+1/2] && QuadraticQ[u,x] && (Not[RationalQ[p]] || ILtQ[p,0] && Not[BinomialQ[u,x]])


EulerIntegrandQ[v_^m_.*(a_.*x_+b_.*u_^n_)^p_,x_Symbol] :=
  True /;
FreeQ[{a,b},x] && EqQ[u,v] && IntegersQ[2*m,n+1/2] && QuadraticQ[u,x] && 
  (Not[RationalQ[p]] || ILtQ[p,0] && Not[BinomialQ[u,x]])


EulerIntegrandQ[v_^m_.*(a_.*x_+b_.*u_^n_)^p_,x_Symbol] :=
  True /;
FreeQ[{a,b},x] && EqQ[u,v] && IntegersQ[2*m,n+1/2] && QuadraticQ[u,x] && 
  (Not[RationalQ[p]] || ILtQ[p,0] && Not[BinomialQ[u,x]])


EulerIntegrandQ[u_^n_*v_^p_,x_Symbol] :=
  True /;
ILtQ[p,0] && IntegerQ[n+1/2] && QuadraticQ[u,x] && QuadraticQ[v,x] && Not[BinomialQ[v,x]]

EulerIntegrandQ[u_,x_Symbol] :=
  False


(* ::Subsection::Closed:: *)
(*FunctionOfSquareRootOfQuadratic*)


(*
Euler substitution #2:
  If u is an expression of the form f (Sqrt[a+b*x+c*x^2],x), f (x,x) is a rational function, and
	PosQ[c], FunctionOfSquareRootOfQuadratic[u,x] returns the 3-element list {
		f ((a*Sqrt[c]+b*x+Sqrt[c]*x^2)/(b+2*Sqrt[c]*x),(-a+x^2)/(b+2*Sqrt[c]*x))*
		  (a*Sqrt[c]+b*x+Sqrt[c]*x^2)/(b+2*Sqrt[c]*x)^2,
		Sqrt[c]*x+Sqrt[a+b*x+c*x^2], 2 };

Euler substitution #1:
  If u is an expression of the form f (Sqrt[a+b*x+c*x^2],x), f (x,x) is a rational function, and
	PosQ[a], FunctionOfSquareRootOfQuadratic[u,x] returns the two element list {
		f ((c*Sqrt[a]-b*x+Sqrt[a]*x^2)/(c-x^2),(-b+2*Sqrt[a]*x)/(c-x^2))*
		  (c*Sqrt[a]-b*x+Sqrt[a]*x^2)/(c-x^2)^2,
		(-Sqrt[a]+Sqrt[a+b*x+c*x^2])/x, 1 };

Euler substitution #3:
  If u is an expression of the form f (Sqrt[a+b*x+c*x^2],x), f (x,x) is a rational function, and
	NegQ[a] and NegQ[c], FunctionOfSquareRootOfQuadratic[u,x] returns the two element list {
		-Sqrt[b^2-4*a*c]*
		f (-Sqrt[b^2-4*a*c]*x/(c-x^2),-(b*c+c*Sqrt[b^2-4*a*c]+(-b+Sqrt[b^2-4*a*c])*x^2)/(2*c*(c-x^2)))*
		  x/(c-x^2)^2,
		2*c*Sqrt[a+b*x+c*x^2]/(b-Sqrt[b^2-4*a*c]+2*c*x), 3 };

  else it returns False. *)

FunctionOfSquareRootOfQuadratic[u_,x_Symbol] :=
  If[MatchQ[u,x^m_.*(a_+b_.*x^n_.)^p_ /; FreeQ[{a,b,m,n,p},x]],
    False,
  Module[{tmp=FunctionOfSquareRootOfQuadratic[u,False,x]},
  If[AtomQ[tmp] || FalseQ[tmp[[1]]],
    False,
  tmp=tmp[[1]];
  Module[{a=Coefficient[tmp,x,0],b=Coefficient[tmp,x,1],c=Coefficient[tmp,x,2],sqrt,q,r},
  If[EqQ[a,0] && EqQ[b,0] || EqQ[b^2-4*a*c,0],
    False,
  If[PosQ[c],
    sqrt=Rt[c,2];
    q=a*sqrt+b*x+sqrt*x^2;
    r=b+2*sqrt*x;
    {Simplify[SquareRootOfQuadraticSubst[u,q/r,(-a+x^2)/r,x]*q/r^2],
     Simplify[sqrt*x+Sqrt[tmp]],
     2},
  If[PosQ[a],
    sqrt=Rt[a,2];
    q=c*sqrt-b*x+sqrt*x^2;
    r=c-x^2;
    {Simplify[SquareRootOfQuadraticSubst[u,q/r,(-b+2*sqrt*x)/r,x]*q/r^2],
     Simplify[(-sqrt+Sqrt[tmp])/x],
     1},
  sqrt=Rt[b^2-4*a*c,2];
  r=c-x^2;
  {Simplify[-sqrt*SquareRootOfQuadraticSubst[u,-sqrt*x/r,-(b*c+c*sqrt+(-b+sqrt)*x^2)/(2*c*r),x]*x/r^2],
   FullSimplify[2*c*Sqrt[tmp]/(b-sqrt+2*c*x)],
   3}]]]]]]]


FunctionOfSquareRootOfQuadratic[u_,v_,x_Symbol] :=
  If[AtomQ[u] || FreeQ[u,x],
    {v},
  If[PowerQ[u] && FreeQ[u[[2]],x],
    If[FractionQ[u[[2]]] && Denominator[u[[2]]]==2 && PolynomialQ[u[[1]],x] && Exponent[u[[1]],x]==2,
      If[(FalseQ[v] || u[[1]]===v),
        {u[[1]]},
      False],
    FunctionOfSquareRootOfQuadratic[u[[1]],v,x]],
  If[ProductQ[u] || SumQ[u],
    Catch[Module[{lst={v}},
    Scan[Function[lst=FunctionOfSquareRootOfQuadratic[#,lst[[1]],x];If[AtomQ[lst],Throw[False]]],u];
    lst]],
  False]]]


SquareRootOfQuadraticSubst::usage = "SquareRootOfQuadraticSubst[u,vv,xx,x] returns u with fractional powers replaced by vv raised to the power and x replaced by xx.";
SquareRootOfQuadraticSubst[u_,vv_,xx_,x_Symbol] :=
  If[AtomQ[u] || FreeQ[u,x],
    If[u===x,
      xx,
    u],
  If[PowerQ[u] && FreeQ[u[[2]],x],
    If[FractionQ[u[[2]]] && Denominator[u[[2]]]==2 && PolynomialQ[u[[1]],x] && Exponent[u[[1]],x]==2,
      vv^Numerator[u[[2]]],
    SquareRootOfQuadraticSubst[u[[1]],vv,xx,x]^u[[2]]],
  Map[Function[SquareRootOfQuadraticSubst[#,vv,xx,x]],u]]]


(* ::Section::Closed:: *)
(*Substitution functions*)


(* ::Subsection::Closed:: *)
(*Subst[u,v,w]*)


Subst::usage = "Subst[u,x,v] returns u with all nondummy occurences of x replaced by v and resulting constant terms replaced by 0.";
Subst[u_,x_Symbol,v_] :=
  If[PowerQ[v] && Not[IntegerQ[v[[2]]]] && 
      MatchQ[v[[1]],a_+b_.*x+c_.*x^2 /; FreeQ[{a,b,c},x] && Not[AtomQ[b]]] && 
      LeafCount[Simplify[v[[1]]]]<2/3*LeafCount[v[[1]]],
    Subst[u,x,Simplify[v[[1]]]^v[[2]]],
  If[SumQ[u],
    If[BinomialQ[v,x],
      SimplifyAntiderivative[Map[Function[SubstAux[#,x,v,True]],u],x],
    SimplifyAntiderivative[Map[Function[SubstAux[#,x,v,False]],u],x]],
  SimplifyAntiderivative[SubstAux[u,x,v,BinomialQ[v,x]],x]]]

Subst[u_,Rule[x_Symbol,v_]] := Subst[u,x,v]


Subst[u_,(a_.*x_)^n_,v_] := 
  If[AtomQ[u],
    u,
  If[RationalQ[n] && Numerator[n]!=1,
    Subst[u,(a*x)^(1/Denominator[n]),v/(a*x)^(n-1/Denominator[n])],
  If[PowerQ[u] && FreeQ[u[[2]],x] && u[[1]]===a*x,
    If[IntegerQ[u[[2]]/n],
      Simplify[v^(u[[2]]/n)],
    If[SumQ[u[[2]]],
      Apply[Times,Map[Function[Subst[u[[1]]^#,(a*x)^n,v]],Apply[List,u[[2]]]]],
    With[{w=Expand[u[[2]]]},
    If[SumQ[w],
      Apply[Times,Map[Function[Subst[u[[1]]^#,(a*x)^n,v]],Apply[List,w]]],
    With[{m=NumericFactor[u[[2]]]},
    If[Numerator[m]!=1,
      Subst[u[[1]]^(m/Numerator[m]*NonnumericFactors[u[[2]]]),(a*x)^n,v]^Numerator[m],
    Subst[u[[1]],(a*x)^n,v]^u[[2]]]]]]]],
  If[CalculusQ[u] && Not[FreeQ[x,u[[2]]]] || HeldFormQ[u] && Head[u]=!=Defer[AppellF1],
    Defer[Subst][u,(a*x)^n,v],
  Map[Function[Subst[#,(a*x)^n,v]],u]]]]] /;
FreeQ[{a,n},x]


Subst[u_,v_,w_] := 
  If[u===v,
    w,
  If[AtomQ[u],
    u,
  If[CalculusQ[u] && Not[FreeQ[v,u[[2]]]] || HeldFormQ[u] && Head[u]=!=Defer[AppellF1],
    Defer[Subst][u,v,w],
  Map[Function[Subst[#,v,w]],u]]]]


(* ::Subsection::Closed:: *)
(*SubstAux[u,x,v]*)


SubstAux::usage = "x is a variable symbol.  SubstAux[u,x,v] returns u with all nondummy occurences of x replaced by v.  x is a variable symbol. flag is True if v is a binomial in x; else it is False.  SubstAux[u,x,v,flag] returns u with all nondummy occurences of x replaced by v.";
SubstAux[a_+b_.*x_,x_,c_.*F_[z_]^2,False] :=
  a*Simplify[1-F[z]^2] /;
FreeQ[{a,b,c},x] && MemberQ[{Sin,Cos,Sec,Csc,Cosh,Tanh,Coth,Sech},F] && EqQ[a+b*c,0]

SubstAux[a_+b_.*x_,x_,c_.*F_[z_]^2,False] :=
  a*Simplify[1+F[z]^2] /;
FreeQ[{a,b,c},x] && MemberQ[{Tan,Cot,Sinh,Csch},F] && EqQ[a-b*c,0]


SubstAux[a_+b_.*x_^2,x_,c_.*F_[z_],False] :=
  a*Simplify[1-F[z]^2] /;
FreeQ[{a,b,c},x] && MemberQ[{Sin,Cos,Sec,Csc,Cosh,Tanh,Coth,Sech},F] && EqQ[a+b*c^2,0]

SubstAux[a_+b_.*x_^2,x_,c_.*F_[z_],False] :=
  a*Simplify[1+F[z]^2] /;
FreeQ[{a,b,c},x] && MemberQ[{Tan,Cot,Sinh,Csch},F] && EqQ[a-b*c^2,0]


SubstAux[F_[a_.*x_^m_.],x_,b_.*x_^n_,flag_] :=
  Switch[F,
    ArcSin, ArcCsc,  ArcCos, ArcSec,  ArcTan, ArcCot,  ArcCot, ArcTan,  ArcSec, ArcCos,  ArcCsc, ArcSin,
    ArcSinh, ArcCsch,  ArcCosh, ArcSech,  ArcTanh, ArcCoth,  ArcCoth, ArcTanh,  ArcSech, ArcCosh,  ArcCsch, ArcSinh][x^(-m*n)/(a*b^m)] /;
FreeQ[{a,b},x] && IGtQ[m,0] && ILtQ[n,0] && MemberQ[{ArcSin,ArcCos,ArcTan,ArcCot,ArcSec,ArcCsc,ArcSinh,ArcCosh,ArcTanh,ArcCoth,ArcSech,ArcCsch},F]


SubstAux[e_+f_.*x_,x_,(a_.+b_.*x_)/(c_.+d_.*x_),flag_] :=
  Together[c*e+a*f]/(c+d*x) /;
FreeQ[{a,b,c,d,e,f},x] && EqQ[d*e+b*f,0]


SubstAux[u_,x_,v_,flag_] :=
  If[AtomQ[u],
    If[u===x,
      v,
    u],
  If[FreeQ[u,x],
    u,
  If[flag && PowerQ[u],
    If[Not[IntegerQ[u[[2]]]] && LinearQ[u[[1]],x],
      Simplify[SubstAux[u[[1]],x,v,flag]]^SubstAux[u[[2]],x,v,flag],
    SubstAux[u[[1]],x,v,flag]^SubstAux[u[[2]],x,v,flag]],
  If[Head[u]===Defer[Subst],
    If[u[[2]]===x || FreeQ[u[[1]],x],
      SubstAux[u[[1]],u[[2]],SubstAux[u[[3]],x,v,flag],flag],
    Defer[Subst][u,x,v]],
(*If[Head[u]===Defer[Dist],
    Defer[Dist][SubstAux[u[[1]],x,v,flag],SubstAux[u[[2]],x,v,flag],u[[3]]], *)
  If[SimplifyFlag && MemberQ[{Unintegrable,CannotIntegrate},Head[u]] && u[[2]]===x,
    With[{w=Simplify[D[v,x]]}, FreeFactors[w,x]*Head[u][Subst[u[[1]],x,v]*NonfreeFactors[w,x],x]],
  If[CalculusQ[u] && Not[FreeQ[x,u[[2]]]] || HeldFormQ[u] && Head[u]=!=Defer[AppellF1],
    Defer[Subst][u,x,v],
  If[flag && Length[u]==1 && LinearQ[u[[1]],x],
    Head[u][Simplify[SubstAux[u[[1]],x,v,flag]]],
  If[flag && Head[u]===PolyLog && Length[u]==2 && LinearQ[u[[2]],x],
    PolyLog[SubstAux[u[[1]],x,v,flag],Simplify[SubstAux[u[[2]],x,v,flag]]],
  With[{w=Simp[Map[Function[SubstAux[#,x,v,flag]],u],x]},
  If[PolyQ[w,x],
    With[{z=If[LinearQ[v,x] || MonomialQ[v,x],ExpandToSum[w,x],Simplify[w]]},
(*  Print[{u,v,w,z}]; *)
    If[LeafCount[z]<=If[LinearQ[u,x], 3/4, 9/10]*LeafCount[w],
      If[EqQ[NumericFactor[z]^2,1],
        z,
      NumericFactor[z]*NonnumericFactors[z]],
    If[EqQ[NumericFactor[w]^2,1],
      w,
    NumericFactor[w]*NonnumericFactors[w]]]],
  With[{ulst=BinomialParts[u,x]},
  If[Not[FalseQ[ulst]] && IGtQ[ulst[[3]],0] && NeQ[ulst[[1]],0] && (NeQ[ulst[[3]],1] || AlgebraicFunctionQ[v,x]),
    With[{z=Simplify[w]},
    If[LeafCount[z]<9/10*LeafCount[w],
      z,
    w]],
  w]]]]]]]]]]]]


(* ::Subsection::Closed:: *)
(*SimplifyAntiderivative[u,x]*)


SimplifyAntiderivative::usage = "SimplifyAntiderivative[u,x] returns the simplest, continuous expression whose derivative wrt x equals the derivative of u wrt x.";
Clear[SimplifyAntiderivative];


(* ::Item:: *)
(*Basis: D[c*F[x], x] == c*D[F[x], x]*)


SimplifyAntiderivative[c_*u_,x_Symbol] :=
  With[{v=SimplifyAntiderivative[u,x]},
  If[SumQ[v] && NonsumQ[u],
    Map[Function[c*#],v],
  c*v]] /;
FreeQ[c,x]


(* ::Item:: *)
(*Basis: D[Log[c*F[x]], x] == D[Log[F[x]], x]*)


SimplifyAntiderivative[Log[c_*u_],x_Symbol] :=
  SimplifyAntiderivative[Log[u],x] /;
FreeQ[c,x]


(* ::Item:: *)
(*Basis: D[Log[F[x]^n], x] == n*D[Log[F[x]], x]*)


SimplifyAntiderivative[Log[u_^n_],x_Symbol] :=
  n*SimplifyAntiderivative[Log[u],x] /;
FreeQ[n,x]


(* ::Item:: *)
(*Basis: If  F\[Element]{Log,ArcTan,ArcCot}, then D[F[G[x]], x] == -D[F[1/G[x]], x]*)


SimplifyAntiderivative[F_[G_[u_]],x_Symbol] :=
  -SimplifyAntiderivative[F[1/G[u]],x] /;
MemberQ[{Log,ArcTan,ArcCot},F] && MemberQ[{Cot,Sec,Csc,Coth,Sech,Csch},G]


(* ::Item:: *)
(*Basis: If  F\[Element]{ArcTanh,ArcCoth}, then D[F[G[x]], x] == D[F[1/G[x]], x]*)


SimplifyAntiderivative[F_[G_[u_]],x_Symbol] :=
  SimplifyAntiderivative[F[1/G[u]],x] /;
MemberQ[{ArcTanh,ArcCoth},F] && MemberQ[{Cot,Sec,Csc,Coth,Sech,Csch},G]


SimplifyAntiderivative[Log[F_[u_]],x_Symbol] :=
  -SimplifyAntiderivative[Log[1/F[u]],x] /;
MemberQ[{Cot,Sec,Csc,Coth,Sech,Csch},F]


(* ::Item:: *)
(*Basis: D[Log[f^G[x]], x] == Log[f]*D[G[x], x]*)


SimplifyAntiderivative[Log[f_^u_],x_Symbol] :=
  Log[f]*SimplifyAntiderivative[u,x] /;
FreeQ[f,x]


(* ::Item:: *)
(*Basis: If  a^2+b^2==0, then D[Log[a + b*Tan[F[x]]], x] == (b*D[F[x], x])/a - D[Log[Cos[F[x]]], x]*)


SimplifyAntiderivative[Log[a_+b_.*Tan[u_]],x_Symbol] :=
  b/a*SimplifyAntiderivative[u,x] - SimplifyAntiderivative[Log[Cos[u]],x] /;
FreeQ[{a,b},x] && EqQ[a^2+b^2,0]


(* ::Item:: *)
(*Basis: If  a^2+b^2==0, then D[Log[a + b*Cot[F[x]]], x] == -((b/a)*D[F[x], x]) - D[Log[Sin[F[x]]], x]*)


SimplifyAntiderivative[Log[a_+b_.*Cot[u_]],x_Symbol] :=
  -b/a*SimplifyAntiderivative[u,x] - SimplifyAntiderivative[Log[Sin[u]],x] /;
FreeQ[{a,b},x] && EqQ[a^2+b^2,0]


(* ::Input:: *)
(* *)


(* ::Item:: *)
(*Note: Should also recognize that Tan[z/2]==Sin[z]/(1+Cos[z])==Tan[z]/(1+Sec[z])*)


SimplifyAntiderivative[ArcTan[a_.*Tan[u_]],x_Symbol] :=
  RectifyTangent[u,a,1,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[ArcCot[a*Tan[f[x]]], x] == -D[ArcTan[a*Tan[f[x]]], x]*)


SimplifyAntiderivative[ArcCot[a_.*Tan[u_]],x_Symbol] :=
  RectifyTangent[u,a,-1,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcTan[a Tanh[z]]==-ArcTan[I a Tan[I z]]*)


(* SimplifyAntiderivative[ArcTan[a_.*Tanh[u_]],x_Symbol] :=
  RectifyTangent[I*u,I*a,-1,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u] *)


(* ::Item:: *)
(*Basis: D[ArcCot[a*Tanh[f[x]]], x] == -D[ArcTan[a*Tanh[f[x]]], x]*)


SimplifyAntiderivative[ArcCot[a_.*Tanh[u_]],x_Symbol] :=
  -SimplifyAntiderivative[ArcTan[a*Tanh[u]],x] /;
FreeQ[a,x] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcTanh[a Tan[z]]==-I ArcTan[I a Tan[z]]*)


SimplifyAntiderivative[ArcTanh[a_.*Tan[u_]],x_Symbol] :=
  RectifyTangent[u,I*a,-I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[ArcCoth[a*Tan[f[x]]], x] == -(I*D[ArcTan[I*a*Tan[f[x]]], x])*)


SimplifyAntiderivative[ArcCoth[a_.*Tan[u_]],x_Symbol] :=
  RectifyTangent[u,I*a,-I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcTanh[a Tanh[z]]==-I ArcTan[a Tan[I z]]*)


(* ::Item:: *)
(*Note: Although this makes the antiderivative continuous on the imaginary line, it makes it discontinous on the real line.*)


(* SimplifyAntiderivative[ArcTanh[a_.*Tanh[u_]],x_Symbol] :=
  RectifyTangent[I*u,a,-I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u] *)


(* ::Item:: *)
(*Basis: D[ArcTanh[Tanh[f[x]]], x] == D[f[x], x]*)


SimplifyAntiderivative[ArcTanh[Tanh[u_]],x_Symbol] :=
  SimplifyAntiderivative[u,x]


(* ::Item:: *)
(*Basis: D[ArcCoth[a*Tanh[f[x]]], x] == -(I*D[ArcTan[a*Tan[I*f[x]]], x])*)


(* ::Item:: *)
(*Note: Although this makes the antiderivative continuous on the imaginary line, it makes it discontinous on the real line.*)


(* SimplifyAntiderivative[ArcCoth[a_.*Tanh[u_]],x_Symbol] :=
  RectifyTangent[I*u,a,-I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u] *)


(* ::Item:: *)
(*Basis: D[ArcCoth[Tanh[f[x]]], x] == D[f[x], x]*)


SimplifyAntiderivative[ArcCoth[Tanh[u_]],x_Symbol] :=
  SimplifyAntiderivative[u,x]


(* ::Input:: *)
(* *)


SimplifyAntiderivative[ArcCot[a_.*Cot[u_]],x_Symbol] :=
  RectifyCotangent[u,a,1,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[ArcTan[a*Cot[f[x]]], x] == -D[ArcCot[a*Cot[f[x]]], x]*)


SimplifyAntiderivative[ArcTan[a_.*Cot[u_]],x_Symbol] :=
  RectifyCotangent[u,a,-1,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcCot[a Coth[z]]==ArcCot[I a Cot[I z]]*)


(* SimplifyAntiderivative[ArcCot[a_.*Coth[u_]],x_Symbol] :=
  RectifyCotangent[I*u,I*a,1,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u] *)


(* ::Item:: *)
(*Basis: D[ArcTan[a*Coth[f[x]]], x] == -D[ArcTan[Tanh[f[x]]/a], x]*)


SimplifyAntiderivative[ArcTan[a_.*Coth[u_]],x_Symbol] :=
  -SimplifyAntiderivative[ArcTan[Tanh[u]/a],x] /;
FreeQ[a,x] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcCoth[a Cot[z]]==I ArcCot[I a Cot[z]]*)


SimplifyAntiderivative[ArcCoth[a_.*Cot[u_]],x_Symbol] :=
  RectifyCotangent[u,I*a,I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[ArcTanh[a*Cot[f[x]]], x] == I*D[ArcCot[I*a*Cot[f[x]]], x]*)


SimplifyAntiderivative[ArcTanh[a_.*Cot[u_]],x_Symbol] :=
  RectifyCotangent[u,I*a,I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcCoth[a Coth[z]]==-I ArcCot[a Cot[I z]]*)


(* ::Item:: *)
(*Note: Although this makes the antiderivative continuous on the imaginary line, it makes it discontinous on the real line.*)


(* SimplifyAntiderivative[ArcCoth[a_.*Coth[u_]],x_Symbol] :=
  RectifyCotangent[I*u,a,-I,x] /;
FreeQ[a,x] && GtQ[a^2,0] && ComplexFreeQ[u] *)


(* ::Item:: *)
(*Basis: D[ArcCoth[Coth[f[x]]], x] == D[f[x], x]*)


SimplifyAntiderivative[ArcCoth[Coth[u_]],x_Symbol] :=
  SimplifyAntiderivative[u,x]


(* ::Item:: *)
(*Basis: D[ArcTanh[a*Coth[f[x]]], x] == D[ArcTanh[Tanh[f[x]]/a], x]*)


SimplifyAntiderivative[ArcTanh[a_.*Coth[u_]],x_Symbol] :=
  SimplifyAntiderivative[ArcTanh[Tanh[u]/a],x] /;
FreeQ[a,x] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[ArcTanh[Coth[f[x]]], x] == D[f[x], x]*)


SimplifyAntiderivative[ArcTanh[Coth[u_]],x_Symbol] :=
  SimplifyAntiderivative[u,x]


(* ::Input:: *)
(* *)


SimplifyAntiderivative[ArcTan[c_.*(a_+b_.*Tan[u_])],x_Symbol] :=
  RectifyTangent[u,a*c,b*c,1,x] /;
FreeQ[{a,b,c},x] && GtQ[a^2*c^2,0] && GtQ[b^2*c^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcTanh[a+b Tan[z]]==-I ArcTan[I a+I b Tan[z]]*)


SimplifyAntiderivative[ArcTanh[c_.*(a_+b_.*Tan[u_])],x_Symbol] :=
  RectifyTangent[u,I*a*c,I*b*c,-I,x] /;
FreeQ[{a,b,c},x] && GtQ[a^2*c^2,0] && GtQ[b^2*c^2,0] && ComplexFreeQ[u]


(* ::Input:: *)
(* *)


SimplifyAntiderivative[ArcTan[c_.*(a_+b_.*Cot[u_])],x_Symbol] :=
  RectifyCotangent[u,a*c,b*c,1,x] /;
FreeQ[{a,b,c},x] && GtQ[a^2*c^2,0] && GtQ[b^2*c^2,0] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: ArcTanh[a+b Cot[z]]==-I ArcTan[I a+I b Cot[z]]*)


SimplifyAntiderivative[ArcTanh[c_.*(a_+b_.*Cot[u_])],x_Symbol] :=
  RectifyCotangent[u,I*a*c,I*b*c,-I,x] /;
FreeQ[{a,b,c},x] && GtQ[a^2*c^2,0] && GtQ[b^2*c^2,0] && ComplexFreeQ[u]


(* ::Input:: *)
(* *)


(* ::Item:: *)
(*Basis: D[ArcTan[a + b*Tan[F[x]] + c*Tan[F[x]]^2], x] == D[ArcTan[(c + (a - c - 1)*Cos[F[x]]^2 + b*Cos[F[x]]*Sin[F[x]])/(c + (a - c + 1)*Cos[F[x]]^2 + b*Cos[F[x]]*Sin[F[x]])], x] == D[ArcTan[(a + c - 1 + (a - c - 1)*Cos[2*F[x]] + b*Sin[2*F[x]])/(a + c + 1 + (a - c + 1)*Cos[2*F[x]] + b*Sin[2*F[x]])], x]*)


SimplifyAntiderivative[ArcTan[a_.+b_.*Tan[u_]+c_.*Tan[u_]^2],x_Symbol] :=
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    ArcTan[NormalizeTogether[(a+c-1+(a-c-1)*Cos[2*u]+b*Sin[2*u])/(a+c+1+(a-c+1)*Cos[2*u]+b*Sin[2*u])]],
  ArcTan[NormalizeTogether[(c+(a-c-1)*Cos[u]^2+b*Cos[u]*Sin[u])/(c+(a-c+1)*Cos[u]^2+b*Cos[u]*Sin[u])]]] /;
FreeQ[{a,b,c},x] && ComplexFreeQ[u]

SimplifyAntiderivative[ArcTan[a_.+b_.*(d_.+e_.*Tan[u_])+c_.*(f_.+g_.*Tan[u_])^2],x_Symbol] :=
  SimplifyAntiderivative[ArcTan[a+b*d+c*f^2+(b*e+2*c*f*g)*Tan[u]+c*g^2*Tan[u]^2],x] /;
FreeQ[{a,b,c},x] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[ArcTan[a + c*Tan[F[x]]^2], x] == D[ArcTan[(c + (a - c - 1)*Cos[F[x]]^2)/(c + (a - c + 1)*Cos[F[x]]^2)], x] == D[ArcTan[(a + c - 1 + (a - c - 1)*Cos[2*F[x]])/(a + c + 1 + (a - c + 1)*Cos[2*F[x]])], x]*)


SimplifyAntiderivative[ArcTan[a_.+c_.*Tan[u_]^2],x_Symbol] :=
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    ArcTan[NormalizeTogether[(a+c-1+(a-c-1)*Cos[2*u])/(a+c+1+(a-c+1)*Cos[2*u])]],
  ArcTan[NormalizeTogether[(c+(a-c-1)*Cos[u]^2)/(c+(a-c+1)*Cos[u]^2)]]] /;
FreeQ[{a,c},x] && ComplexFreeQ[u]

SimplifyAntiderivative[ArcTan[a_.+c_.*(f_.+g_.*Tan[u_])^2],x_Symbol] :=
  SimplifyAntiderivative[ArcTan[a+c*f^2+(2*c*f*g)*Tan[u]+c*g^2*Tan[u]^2],x] /;
FreeQ[{a,c},x] && ComplexFreeQ[u]


(* ::Item:: *)
(*Basis: D[c, x] == D[0, x]*)


SimplifyAntiderivative[u_,x_Symbol] :=
  If[FreeQ[u,x],
    0,
  If[LogQ[u],
    With[{v=RemoveContent[u[[1]],x]},
    If[v===u[[1]],
      u,
    SimplifyAntiderivative[Log[v],x]]],
  If[SumQ[u],
    SimplifyAntiderivativeSum[Map[Function[SimplifyAntiderivative[#,x]],u],x],
  u]]]


(* ::Subsection::Closed:: *)
(*SimplifyAntiderivativeSum*)


Clear[SimplifyAntiderivativeSum];

SimplifyAntiderivativeSum[v_.+A_.*Log[a_+b_.*Tan[u_]^n_.]+B_.*Log[Cos[u_]],x_Symbol] :=
  SimplifyAntiderivativeSum[v,x] + A*Log[RemoveContent[a*Cos[u]^n+b*Sin[u]^n,x]] /;
FreeQ[{a,b,A,B},x] && IntegerQ[n] && EqQ[n*A-B,0]


SimplifyAntiderivativeSum[v_.+A_.*Log[a_+b_.*Cot[u_]^n_.]+B_.*Log[Sin[u_]],x_Symbol] :=
  SimplifyAntiderivativeSum[v,x] + A*Log[RemoveContent[a*Sin[u]^n+b*Cos[u]^n,x]] /;
FreeQ[{a,b,A,B},x] && IntegerQ[n] && EqQ[n*A-B,0]


SimplifyAntiderivativeSum[v_.+A_.*Log[a_+b_.*Tan[u_]^n_.]+B_.*Log[c_+d_.*Tan[u_]^n_.],x_Symbol] :=
  SimplifyAntiderivativeSum[v,x] + A*Log[RemoveContent[a*Cos[u]^n+b*Sin[u]^n,x]] + B*Log[RemoveContent[c*Cos[u]^n+d*Sin[u]^n,x]] /;
FreeQ[{a,b,c,d,A,B},x] && IntegerQ[n] && EqQ[A+B,0]


SimplifyAntiderivativeSum[v_.+A_.*Log[a_+b_.*Cot[u_]^n_.]+B_.*Log[c_+d_.*Cot[u_]^n_.],x_Symbol] :=
  SimplifyAntiderivativeSum[v,x] + A*Log[RemoveContent[b*Cos[u]^n+a*Sin[u]^n,x]] + B*Log[RemoveContent[d*Cos[u]^n+c*Sin[u]^n,x]] /;
FreeQ[{a,b,c,d,A,B},x] && IntegerQ[n] && EqQ[A+B,0]


SimplifyAntiderivativeSum[v_.+A_.*Log[a_+b_.*Tan[u_]^n_.]+B_.*Log[c_+d_.*Tan[u_]^n_.]+C_.*Log[e_+f_.*Tan[u_]^n_.],x_Symbol] :=
  SimplifyAntiderivativeSum[v,x] + A*Log[RemoveContent[a*Cos[u]^n+b*Sin[u]^n,x]] + 
	B*Log[RemoveContent[c*Cos[u]^n+d*Sin[u]^n,x]] + C*Log[RemoveContent[e*Cos[u]^n+f*Sin[u]^n,x]] /;
FreeQ[{a,b,c,d,e,f,A,B,C},x] && IntegerQ[n] && EqQ[A+B+C,0]


SimplifyAntiderivativeSum[v_.+A_.*Log[a_+b_.*Cot[u_]^n_.]+B_.*Log[c_+d_.*Cot[u_]^n_.]+C_.*Log[e_+f_.*Cot[u_]^n_.],x_Symbol] :=
  SimplifyAntiderivativeSum[v,x] + A*Log[RemoveContent[b*Cos[u]^n+a*Sin[u]^n,x]] + 
	B*Log[RemoveContent[d*Cos[u]^n+c*Sin[u]^n,x]] + C*Log[RemoveContent[f*Cos[u]^n+e*Sin[u]^n,x]] /;
FreeQ[{a,b,c,d,e,f,A,B,C},x] && IntegerQ[n] && EqQ[A+B+C,0]


SimplifyAntiderivativeSum[u_,x_Symbol] := u


(* ::Subsection::Closed:: *)
(*RectifyTangent*)


(* ::Item:: *)
(*Basis: ArcTan[I a Tan[f[x]]]==I ArcTanh[a Tan[f[x]]]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[(c/e)*Tan[f[x]]], x] == D[Log[e*Cos[f[x]] + c*Sin[f[x]]]/2 - Log[e*Cos[f[x]] - c*Sin[f[x]]]/2, x]*)


(* ::Item:: *)
(*Note: Note unlike the above, the log terms in the following two identities are real-valued when c, e and f[x] are real.*)


(* ::Item:: *)
(*Basis: D[ArcTanh[(c/e)*Tan[f[x]]], x] == D[Log[c^2 + e^2 - (c^2 - e^2)*Cos[2*f[x]] + 2*c*e*Sin[2*f[x]]]/4 - Log[c^2 + e^2 - (c^2 - e^2)*Cos[2*f[x]] - 2*c*e*Sin[2*f[x]]]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[(c/e)*Tan[f[x]]], x] == D[Log[e^2 + 2*c*e*Cos[f[x]]*Sin[f[x]] + (c^2 - e^2)*Sin[f[x]]^2]/4 - Log[e^2 - 2*c*e*Cos[f[x]]*Sin[f[x]] + (c^2 - e^2)*Sin[f[x]]^2]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTan[a*Tan[f[x]]], x] == D[f[x] - ArcTan[Sin[2*f[x]]/((1 + a)/(1 - a) + Cos[2*f[x]])], x]*)


(* ::Item:: *)
(*Basis: D[ArcTan[a*Tan[f[x]]], x] == D[f[x] + ArcTan[(Cos[f[x]]*Sin[f[x]])/(1/(a - 1) + Sin[f[x]]^2)], x] == D[f[x] - ArcTan[(Cos[f[x]]*Sin[f[x]])/(a/(1 - a) + Cos[f[x]]^2)], x]*)


(* ::Item:: *)
(*Note: If  a>0 and f[x] is real, then 1/(1-a)-Sin[f[x]]^2 is nonzero and f[x]-ArcTan[(Cos[f[x]] Sin[f[x]])/(1/(1-a)-Sin[f[x]]^2)] is continuous, unlike ArcTan[a Tan[f[x]]].*)


RectifyTangent::usage = "RectifyTangent[u,a,b,x] returns an expression whose derivative equals the derivative of b*ArcTan[a*Tan[u]] wrt x.  RectifyTangent[u,a,b,r,x] returns an expression whose derivative equals the derivative of r*ArcTan[a+b*Tan[u]] wrt x.";
RectifyTangent[u_,a_,b_,x_Symbol] :=
  If[MatchQ[Together[a],d_.*Complex[0,c_]],
    Module[{c=a/I,e},
    If[LtQ[c,0],
      RectifyTangent[u,-a,-b,x],
    If[EqQ[c,1],
      If[EvenQ[Denominator[NumericFactor[Together[u]]]],
        I*b*ArcTanh[Sin[2*u]]/2,
      I*b*ArcTanh[2*Cos[u]*Sin[u]]/2],
    e=SmartDenominator[c];
    c=c*e;
(*  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
      I*b*Log[RemoveContent[c^2+e^2-(c^2-e^2)*Cos[2*u]+2*c*e*Sin[2*u],x]]/4 - 
      I*b*Log[RemoveContent[c^2+e^2-(c^2-e^2)*Cos[2*u]-2*c*e*Sin[2*u],x]]/4,
    I*b*Log[RemoveContent[e^2+2*c*e*Cos[u]*Sin[u]+(c^2-e^2)*Sin[u]^2,x]]/4 - 
    I*b*Log[RemoveContent[e^2-2*c*e*Cos[u]*Sin[u]+(c^2-e^2)*Sin[u]^2,x]]/4]]]], *)
    I*b*Log[RemoveContent[e*Cos[u]+c*Sin[u],x]]/2 - 
    I*b*Log[RemoveContent[e*Cos[u]-c*Sin[u],x]]/2]]],
  If[LtQ[a,0],
    RectifyTangent[u,-a,-b,x],
  If[EqQ[a,1],
    b*SimplifyAntiderivative[u,x],
  Module[{c,numr,denr},
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    c=Simplify[(1+a)/(1-a)];
    numr=SmartNumerator[c];
    denr=SmartDenominator[c];
    b*SimplifyAntiderivative[u,x] - b*ArcTan[NormalizeLeadTermSigns[denr*Sin[2*u]/(numr+denr*Cos[2*u])]],
  If[GtQ[a,1],
    c=Simplify[1/(a-1)];
    numr=SmartNumerator[c];
    denr=SmartDenominator[c];
    b*SimplifyAntiderivative[u,x] + b*ArcTan[NormalizeLeadTermSigns[denr*Cos[u]*Sin[u]/(numr+denr*Sin[u]^2)]],
  c=Simplify[a/(1-a)];
  numr=SmartNumerator[c];
  denr=SmartDenominator[c];
  b*SimplifyAntiderivative[u,x] - b*ArcTan[NormalizeLeadTermSigns[denr*Cos[u]*Sin[u]/(numr+denr*Cos[u]^2)]]]]]]]]


(* ::Input:: *)
(* *)


(* ::Item:: *)
(*Basis: ArcTan[I a+I b Tan[f[x]]]==I ArcTanh[a+b Tan[f[x]]]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[c/e + (d/e)*Tan[f[x]]], x] == D[Log[(c + e)^2 + d^2 + ((c + e)^2 - d^2)*Cos[2*f[x]] + 2*(c + e)*d*Sin[2*f[x]]]/4 - Log[(c - e)^2 + d^2 + ((c - e)^2 - d^2)*Cos[2*f[x]] + 2*(c - e)*d*Sin[2*f[x]]]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[c/e + (d/e)*Tan[f[x]]], x] == D[Log[(c + e)^2 + 2*(c + e)*d*Cos[f[x]]*Sin[f[x]] - ((c + e)^2 - d^2)*Sin[f[x]]^2]/4 - Log[(c - e)^2 + 2*(c - e)*d*Cos[f[x]]*Sin[f[x]] - ((c - e)^2 - d^2)*Sin[f[x]]^2]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTan[a + b*Tan[f[x]]], x] == D[f[x] + ArcTan[(2*a*b*Cos[2*f[x]] - (1 + a^2 - b^2)*Sin[2*f[x]])/(a^2 + (1 + b)^2 + (1 + a^2 - b^2)*Cos[2*f[x]] + 2*a*b*Sin[2*f[x]])], x]*)


(* ::Item:: *)
(*Basis: D[ArcTan[a + b*Tan[f[x]]], x] == D[f[x] - ArcTan[(a*b - 2*a*b*Cos[f[x]]^2 + (1 + a^2 - b^2)*Cos[f[x]]*Sin[f[x]])/(b*(1 + b) + (1 + a^2 - b^2)*Cos[f[x]]^2 + 2*a*b*Cos[f[x]]*Sin[f[x]])], x]*)


RectifyTangent[u_,a_,b_,r_,x_Symbol] :=
  If[MatchQ[Together[a],d_.*Complex[0,c_]] && MatchQ[Together[b],d_.*Complex[0,c_]],
    Module[{c=a/I,d=b/I,e},
    If[LtQ[d,0],
      RectifyTangent[u,-a,-b,-r,x],
    e=SmartDenominator[Together[c+d*x]];
    c=c*e;
    d=d*e;
    If[EvenQ[Denominator[NumericFactor[Together[u]]]],
      I*r*Log[RemoveContent[Simplify[(c+e)^2+d^2]+Simplify[(c+e)^2-d^2]*Cos[2*u]+Simplify[2*(c+e)*d]*Sin[2*u],x]]/4 - 
      I*r*Log[RemoveContent[Simplify[(c-e)^2+d^2]+Simplify[(c-e)^2-d^2]*Cos[2*u]+Simplify[2*(c-e)*d]*Sin[2*u],x]]/4,
    I*r*Log[RemoveContent[Simplify[(c+e)^2]+Simplify[2*(c+e)*d]*Cos[u]*Sin[u]-Simplify[(c+e)^2-d^2]*Sin[u]^2,x]]/4 - 
    I*r*Log[RemoveContent[Simplify[(c-e)^2]+Simplify[2*(c-e)*d]*Cos[u]*Sin[u]-Simplify[(c-e)^2-d^2]*Sin[u]^2,x]]/4]]],
  If[LtQ[b,0],
    RectifyTangent[u,-a,-b,-r,x],
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    r*SimplifyAntiderivative[u,x] + 
    r*ArcTan[Simplify[(2*a*b*Cos[2*u]-(1+a^2-b^2)*Sin[2*u])/(a^2+(1+b)^2+(1+a^2-b^2)*Cos[2*u]+2*a*b*Sin[2*u])]],
  r*SimplifyAntiderivative[u,x] - 
  r*ArcTan[ActivateTrig[Simplify[(a*b-2*a*b*cos[u]^2+(1+a^2-b^2)*cos[u]*sin[u])/(b*(1+b)+(1+a^2-b^2)*cos[u]^2+2*a*b*cos[u]*sin[u])]]]]]]


(* ::Input:: *)
(* *)


(* ::Item:: *)
(*Basis: D[ArcTanh[a + b*Tanh[f[x]]], x] == D[f[x] - ArcTanh[(2*a*b*Cosh[2*f[x]] - (1 - a^2 - b^2)*Sinh[2*f[x]])/(a^2 - (1 + b)^2 - (1 - a^2 - b^2)*Cosh[2*f[x]] + 2*a*b*Sinh[2*f[x]])], x]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[a + b*Tanh[f[x]]], x] == D[f[x] - ArcTanh[(a*b - 2*a*b*Cosh[f[x]]^2 + (1 - a^2 - b^2)*Cosh[f[x]]*Sinh[f[x]])/(b*(1 + b) + (1 - a^2 - b^2)*Cosh[f[x]]^2 - 2*a*b*Cosh[f[x]]*Sinh[f[x]])], x]*)


(* SimplifyAntiderivative[ArcTanh[c_.*(a_+b_.*Tanh[u_])],x_Symbol] :=
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    SimplifyAntiderivative[u,x] - 
    ArcTanh[NormalizeTogether[(2*a*b*c^2*Cosh[2*u]-(1-a^2*c^2-b^2*c^2)*Sinh[2*u])/(a^2*c^2-(1+b*c)^2-(1-a^2*c^2-b^2*c^2)*Cosh[2*u]+2*a*b*c^2*Sinh[2*u])]],
  SimplifyAntiderivative[u,x] - 
  ArcTanh[NormalizeTogether[(a*b*c^2-2*a*b*c^2*Cosh[u]^2+(1-a^2*c^2-b^2*c^2)*Cosh[u]*Sinh[u])/(b*c*(1+b*c)+(1-a^2*c^2-b^2*c^2)*Cosh[u]^2-2*a*b*c^2*Cosh[u]*Sinh[u])]]] /;
FreeQ[{a,b,c},x] *)


(* ::Subsection::Closed:: *)
(*RectifyCotangent*)


(* ::Item:: *)
(*Basis: ArcCot[I a Cot[f[x]]]==-I ArcCoth[a Cot[f[x]]]*)


(* ::Item:: *)
(*Basis: D[ArcCoth[(c/e)*Cot[f[x]]], x] == D[Log[c*Cos[f[x]] + e*Sin[f[x]]]/2 - Log[c*Cos[f[x]] - e*Sin[f[x]]]/2, x]*)


(* ::Item:: *)
(*Note: Note unlike the above, the log terms in the following two identities are real-valued when c, e and f[x] are real.*)


(* ::Item:: *)
(*Basis: D[ArcTanh[(c/e)*Cot[f[x]]], x] == D[Log[c^2 + e^2 + (c^2 - e^2)*Cos[2*f[x]] + 2*c*e*Sin[2*f[x]]]/4 - Log[c^2 + e^2 + (c^2 - e^2)*Cos[2*f[x]] - 2*c*e*Sin[2*f[x]]]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[(c/e)*Cot[f[x]]], x] == D[Log[e^2 + (c^2 - e^2)*Cos[f[x]]^2 + 2*c*e*Cos[f[x]]*Sin[f[x]]]/4 - Log[e^2 + (c^2 - e^2)*Cos[f[x]]^2 - 2*c*e*Cos[f[x]]*Sin[f[x]]]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcCot[a*Cot[f[x]]], x] == D[f[x] + ArcTan[Sin[2*f[x]]/((1 + a)/(1 - a) - Cos[2*f[x]])], x]*)


(* ::Item:: *)
(*Basis: D[ArcCot[a*Cot[f[x]]], x] == D[f[x] - ArcTan[(Cos[f[x]]*Sin[f[x]])/(1/(a - 1) + Cos[f[x]]^2)], x] == D[f[x] + ArcTan[(Cos[f[x]]*Sin[f[x]])/(a/(1 - a) + Sin[f[x]]^2)], x]*)


RectifyCotangent::usage = "RectifyCotangent[u,a,b,x] returns an expression whose derivative equals the derivative of b*ArcCot[a*Cot[u]] wrt x.  RectifyCotangent[u,a,b,r,x] returns an expression whose derivative equals the derivative of r*ArcTan[a+b*Cot[u]] wrt x.";
RectifyCotangent[u_,a_,b_,x_Symbol] :=
  If[MatchQ[Together[a],d_.*Complex[0,c_]],
    Module[{c=a/I,e},
    If[LtQ[c,0],
      RectifyCotangent[u,-a,-b,x],
    If[EqQ[c,1],
      If[EvenQ[Denominator[NumericFactor[Together[u]]]],
        -I*b*ArcTanh[Sin[2*u]]/2,
      -I*b*ArcTanh[2*Cos[u]*Sin[u]]/2],
    e=SmartDenominator[c];
    c=c*e;
(*  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
      -I*b*Log[RemoveContent[c^2+e^2+(c^2-e^2)*Cos[2*u]+2*c*e*Sin[2*u],x]]/4 + 
       I*b*Log[RemoveContent[c^2+e^2+(c^2-e^2)*Cos[2*u]-2*c*e*Sin[2*u],x]]/4,
    -I*b*Log[RemoveContent[e^2+(c^2-e^2)*Cos[u]^2+2*c*e*Cos[u]*Sin[u],x]]/4 + 
     I*b*Log[RemoveContent[e^2+(c^2-e^2)*Cos[u]^2-2*c*e*Cos[u]*Sin[u],x]]/4]]]], *)
    -I*b*Log[RemoveContent[c*Cos[u]+e*Sin[u],x]]/2 + 
    I*b*Log[RemoveContent[c*Cos[u]-e*Sin[u],x]]/2]]],
  If[LtQ[a,0],
    RectifyCotangent[u,-a,-b,x],
  If[EqQ[a,1],
    b*SimplifyAntiderivative[u,x],
  Module[{c,numr,denr},
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    c=Simplify[(1+a)/(1-a)];
    numr=SmartNumerator[c];
    denr=SmartDenominator[c];
    b*SimplifyAntiderivative[u,x] + b*ArcTan[NormalizeLeadTermSigns[denr*Sin[2*u]/(numr-denr*Cos[2*u])]],
  If[GtQ[a,1],
    c=Simplify[1/(a-1)];
    numr=SmartNumerator[c];
    denr=SmartDenominator[c];
    b*SimplifyAntiderivative[u,x] - b*ArcTan[NormalizeLeadTermSigns[denr*Cos[u]*Sin[u]/(numr+denr*Cos[u]^2)]],
  c=Simplify[a/(1-a)];
  numr=SmartNumerator[c];
  denr=SmartDenominator[c];
  b*SimplifyAntiderivative[u,x] + b*ArcTan[NormalizeLeadTermSigns[denr*Cos[u]*Sin[u]/(numr+denr*Sin[u]^2)]]]]]]]]


(* ::Input:: *)
(* *)


(* ::Item:: *)
(*Basis: ArcTan[I a+I b Cot[f[x]]]==I ArcTanh[a+b Cot[f[x]]]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[c/e + (d/e)*Cot[f[x]]], x] == D[Log[(c + e)^2 + d^2 - ((c + e)^2 - d^2)*Cos[2*f[x]] + 2*(c + e)*d*Sin[2*f[x]]]/4 - Log[(c - e)^2 + d^2 - ((c - e)^2 - d^2)*Cos[2*f[x]] + 2*(c - e)*d*Sin[2*f[x]]]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[c/e + (d/e)*Cot[f[x]]], x] == D[Log[(c + e)^2 - ((c + e)^2 - d^2)*Cos[f[x]]^2 + 2*(c + e)*d*Cos[f[x]]*Sin[f[x]]]/4 - Log[(c - e)^2 - ((c - e)^2 - d^2)*Cos[f[x]]^2 + 2*(c - e)*d*Cos[f[x]]*Sin[f[x]]]/4, x]*)


(* ::Item:: *)
(*Basis: D[ArcTan[a + b*Cot[f[x]]], x] == D[-f[x] - ArcTan[(2*a*b*Cos[2*f[x]] + (1 + a^2 - b^2)*Sin[2*f[x]])/(a^2 + (1 + b)^2 - (1 + a^2 - b^2)*Cos[2*f[x]] + 2*a*b*Sin[2*f[x]])], x]*)


(* ::Item:: *)
(*Basis: D[ArcTan[a + b*Cot[f[x]]], x] == D[-f[x] - ArcTan[(a*b - 2*a*b*Sin[f[x]]^2 + (1 + a^2 - b^2)*Cos[f[x]]*Sin[f[x]])/(b*(1 + b) + (1 + a^2 - b^2)*Sin[f[x]]^2 + 2*a*b*Cos[f[x]]*Sin[f[x]])], x]*)


RectifyCotangent[u_,a_,b_,r_,x_Symbol] :=
  If[MatchQ[Together[a],d_.*Complex[0,c_]] && MatchQ[Together[b],d_.*Complex[0,c_]],
    Module[{c=a/I,d=b/I,e},
    If[LtQ[d,0],
      RectifyTangent[u,-a,-b,-r,x],
    e=SmartDenominator[Together[c+d*x]];
    c=c*e;
    d=d*e;
    If[EvenQ[Denominator[NumericFactor[Together[u]]]],
      I*r*Log[RemoveContent[Simplify[(c+e)^2+d^2]-Simplify[(c+e)^2-d^2]*Cos[2*u]+Simplify[2*(c+e)*d]*Sin[2*u],x]]/4 - 
      I*r*Log[RemoveContent[Simplify[(c-e)^2+d^2]-Simplify[(c-e)^2-d^2]*Cos[2*u]+Simplify[2*(c-e)*d]*Sin[2*u],x]]/4,
    I*r*Log[RemoveContent[Simplify[(c+e)^2]-Simplify[(c+e)^2-d^2]*Cos[u]^2+Simplify[2*(c+e)*d]*Cos[u]*Sin[u],x]]/4 - 
    I*r*Log[RemoveContent[Simplify[(c-e)^2]-Simplify[(c-e)^2-d^2]*Cos[u]^2+Simplify[2*(c-e)*d]*Cos[u]*Sin[u],x]]/4]]],
  If[LtQ[b,0],
    RectifyCotangent[u,-a,-b,-r,x],
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    -r*SimplifyAntiderivative[u,x] - 
    r*ArcTan[Simplify[(2*a*b*Cos[2*u]+(1+a^2-b^2)*Sin[2*u])/(a^2+(1+b)^2-(1+a^2-b^2)*Cos[2*u]+2*a*b*Sin[2*u])]],
  -r*SimplifyAntiderivative[u,x] - 
  r*ArcTan[ActivateTrig[Simplify[(a*b-2*a*b*sin[u]^2+(1+a^2-b^2)*cos[u]*sin[u])/(b*(1+b)+(1+a^2-b^2)*sin[u]^2+2*a*b*cos[u]*sin[u])]]]]]]


(* ::Input:: *)
(* *)


(* ::Item:: *)
(*Basis: D[ArcTanh[a + b*Coth[f[x]]], x] == D[f[x] - ArcTanh[(2*a*b*Cosh[2*f[x]] - (1 - a^2 - b^2)*Sinh[2*f[x]])/(-a^2 + (1 + b)^2 - (1 - a^2 - b^2)*Cosh[2*f[x]] + 2*a*b*Sinh[2*f[x]])], x]*)


(* ::Item:: *)
(*Basis: D[ArcTanh[a + b*Coth[f[x]]], x] == D[f[x] - ArcTanh[(a*b + 2*a*b*Sinh[f[x]]^2 - (1 - a^2 - b^2)*Cosh[f[x]]*Sinh[f[x]])/(b*(1 + b) - (1 - a^2 - b^2)*Sinh[f[x]]^2 + 2*a*b*Cosh[f[x]]*Sinh[f[x]])], x]*)


(* SimplifyAntiderivative[ArcTanh[c_.*(a_+b_.*Coth[u_])],x_Symbol] :=
  If[EvenQ[Denominator[NumericFactor[Together[u]]]],
    SimplifyAntiderivative[u,x] - 
    ArcTanh[NormalizeTogether[(2*a*b*c^2*Cosh[2*u]-(1-a^2*c^2-b^2*c^2)*Sinh[2*u])/(-a^2*c^2+(1+b*c)^2-(1-a^2*c^2-b^2*c^2)*Cosh[2*u]+2*a*b*c^2*Sinh[2*u])]],
  SimplifyAntiderivative[u,x] - 
  ArcTanh[NormalizeTogether[(a*b*c^2+2*a*b*c^2*Sinh[u]^2-(1-a^2*c^2-b^2*c^2)*Cosh[u]*Sinh[u])/(b*c*(1+b*c)-(1-a^2*c^2-b^2*c^2)*Sinh[u]^2+2*a*b*c^2*Cosh[u]*Sinh[u])]]] /;
FreeQ[{a,b,c},x] *)


SmartNumerator[u_^n_] := SmartDenominator[u^(-n)] /; RationalQ[n] && n<0

SmartNumerator[u_*v_] := SmartNumerator[u]*SmartNumerator[v]

SmartNumerator[u_] := Numerator[u]


SmartDenominator[u_^n_] := SmartNumerator[u^(-n)] /; RationalQ[n] && n<0

SmartDenominator[u_*v_] := SmartDenominator[u]*SmartDenominator[v]

SmartDenominator[u_] := Denominator[u]


(* ::Subsection::Closed:: *)
(*SubstFor*)


SubstFor::usage = "u is a function of v.  SubstFor[w,v,u,x] returns w times u with v replaced by x.  u is a function of v.  SubstFor[v,u,x] returns u with v replaced by x.";
SubstFor[w_,v_,u_,x_] :=
  SimplifyIntegrand[w*SubstFor[v,u,x],x]


SubstFor[v_,u_,x_] :=
  If[AtomQ[v],
    Subst[u,v,x],
  If[Not[InertTrigFreeQ[u]],
    SubstFor[v,ActivateTrig[u],x],
  If[NeQ[FreeFactors[v,x],1],
    SubstFor[NonfreeFactors[v,x],u,x/FreeFactors[v,x]],
  Switch[Head[v],
    Sin, SubstForTrig[u,x,Sqrt[1-x^2],v[[1]],x],
    Cos, SubstForTrig[u,Sqrt[1-x^2],x,v[[1]],x],
    Tan, SubstForTrig[u,x/Sqrt[1+x^2],1/Sqrt[1+x^2],v[[1]],x],
    Cot, SubstForTrig[u,1/Sqrt[1+x^2],x/Sqrt[1+x^2],v[[1]],x],
    Sec, SubstForTrig[u,1/Sqrt[1-x^2],1/x,v[[1]],x],
    Csc, SubstForTrig[u,1/x,1/Sqrt[1-x^2],v[[1]],x],
    Sinh, SubstForHyperbolic[u,x,Sqrt[1+x^2],v[[1]],x],
    Cosh, SubstForHyperbolic[u,Sqrt[-1+x^2],x,v[[1]],x],
    Tanh, SubstForHyperbolic[u,x/Sqrt[1-x^2],1/Sqrt[1-x^2],v[[1]],x],
    Coth, SubstForHyperbolic[u,1/Sqrt[-1+x^2],x/Sqrt[-1+x^2],v[[1]],x],
    Sech, SubstForHyperbolic[u,1/Sqrt[-1+x^2],1/x,v[[1]],x],
    Csch, SubstForHyperbolic[u,1/x,1/Sqrt[1+x^2],v[[1]],x],
    _, SubstForAux[u,v,x]]]]]


SubstForAux::usage = "u is a function of v.  SubstForAux[u,v,x] returns u with v replaced by x.";
SubstForAux[u_,v_,x_] :=
  If[u===v,
    x,
  If[AtomQ[u],
    If[PowerQ[v] && FreeQ[v[[2]],x] && EqQ[u,v[[1]]],
      x^Simplify[1/v[[2]]],
    u],
  If[PowerQ[u] && FreeQ[u[[2]],x],
    If[EqQ[u[[1]],v],
      x^u[[2]],
    If[PowerQ[v] && FreeQ[v[[2]],x] && EqQ[u[[1]],v[[1]]],
      x^Simplify[u[[2]]/v[[2]]],
    SubstForAux[u[[1]],v,x]^u[[2]]]],
  If[ProductQ[u] && NeQ[FreeFactors[u,x],1],
    FreeFactors[u,x]*SubstForAux[NonfreeFactors[u,x],v,x],
  If[ProductQ[u] && ProductQ[v],
    SubstForAux[First[u],First[v],x],
  Map[Function[SubstForAux[#,v,x]],u]]]]]]


SubstForTrig::usage = " u(v) is an expression of the form f(Sin[v],Cos[v],Tan[v],Cot[v],Sec[v],Csc[v]).  SubstForTrig[u,sin,cos,v,x] returns the expression f(sin,cos,sin/cos,cos/sin,1/cos,1/sin).";
SubstForTrig[u_,sin_,cos_,v_,x_] :=
  If[AtomQ[u],
    u,
  If[TrigQ[u] && IntegerQuotientQ[u[[1]],v],
    If[u[[1]]===v || EqQ[u[[1]],v],
      Switch[Head[u], Sin, sin,  Cos, cos,  Tan, sin/cos,  Cot, cos/sin,  Sec, 1/cos,  Csc, 1/sin],
    Map[Function[SubstForTrig[#,sin,cos,v,x]],
			ReplaceAll[TrigExpand[Head[u][Simplify[u[[1]]/v]*x]],x->v]]],
  If[ProductQ[u] && Head[u[[1]]]===Cos && Head[u[[2]]]===Sin && EqQ[u[[1,1]],v/2] && EqQ[u[[2,1]],v/2],
    sin/2*SubstForTrig[Drop[u,2],sin,cos,v,x],
  Map[Function[SubstForTrig[#,sin,cos,v,x]],u]]]]


SubstForHyperbolic::usage = "u (v) is an expression of the form f (Sinh[v],Cosh[v],Tanh[v],Coth[v],Sech[v],Csch[v]).  SubstForHyperbolic[u,sinh,cosh,v,x] returns the expression f(sinh,cosh,sinh/cosh,cosh/sinh,1/cosh,1/sinh).";
SubstForHyperbolic[u_,sinh_,cosh_,v_,x_] :=
  If[AtomQ[u],
    u,
  If[HyperbolicQ[u] && IntegerQuotientQ[u[[1]],v],
    If[u[[1]]===v || EqQ[u[[1]],v],
      Switch[Head[u], Sinh, sinh,  Cosh, cosh,  Tanh, sinh/cosh,  Coth, cosh/sinh,  Sech, 1/cosh, Csch, 1/sinh],
    Map[Function[SubstForHyperbolic[#,sinh,cosh,v,x]],
			ReplaceAll[TrigExpand[Head[u][Simplify[u[[1]]/v]*x]],x->v]]],
  If[ProductQ[u] && Head[u[[1]]]===Cosh && Head[u[[2]]]===Sinh && EqQ[u[[1,1]],v/2] && EqQ[u[[2,1]],v/2],
    sinh/2*SubstForHyperbolic[Drop[u,2],sinh,cosh,v,x],
  Map[Function[SubstForHyperbolic[#,sinh,cosh,v,x]],u]]]]


(* ::Subsection::Closed:: *)
(*SubstForFractionalPowerOfLinear*)


SubstForFractionalPowerOfLinear::usage = "If u has a subexpression of the form (a+b*x)^(m/n) where m and n>1 are integers, SubstForFractionalPowerOfLinear[u,x] returns the list {v,n,a+b*x,1/b} where v is u with subexpressions of the form (a+b*x)^(m/n) replaced by x^m and x replaced by -a/b+x^n/b, and all times x^(n-1); else it returns False.";
SubstForFractionalPowerOfLinear[u_,x_Symbol] :=
  With[{lst=FractionalPowerOfLinear[u,1,False,x]},
  If[AtomQ[lst] || FalseQ[lst[[2]]],
    False,
  With[{n=lst[[1]], a=Coefficient[lst[[2]],x,0], b=Coefficient[lst[[2]],x,1]},
  With[{tmp=Simplify[x^(n-1)*SubstForFractionalPower[u,lst[[2]],n,-a/b+x^n/b,x]]},
  {NonfreeFactors[tmp,x],n,lst[[2]],FreeFactors[tmp,x]/b}]]]]


FractionalPowerOfLinear::usage = "If u has a subexpression of the form (a+b*x)^(m/n), FractionalPowerOfLinear[u,1,False,x] returns {n,a+b*x}; else it returns False.";
FractionalPowerOfLinear[u_,n_,v_,x_] :=
  If[AtomQ[u] || FreeQ[u,x],
    {n,v},
  If[CalculusQ[u],
    False,
  If[FractionalPowerQ[u] && LinearQ[u[[1]],x] && (FalseQ[v] || EqQ[u[[1]],v]),
    {LCM[Denominator[u[[2]]],n],u[[1]]},
  Catch[Module[{lst={n,v}},
    Scan[Function[If[AtomQ[lst=FractionalPowerOfLinear[#,lst[[1]],lst[[2]],x]],Throw[False]]],u];
    lst]]]]]


(* ::Subsection::Closed:: *)
(*InverseFunctionOfLinear*)


InverseFunctionOfLinear::usage = "If u has a subexpression of the form g[a+b*x] where g is an inverse function, InverseFunctionOfLinear[u,x] returns g[a+b*x]; else it returns False.";
InverseFunctionOfLinear[u_,x_Symbol] :=
  If[AtomQ[u] || CalculusQ[u] || FreeQ[u,x],
    False,
  If[InverseFunctionQ[u] && LinearQ[u[[1]],x],
    u,
  Module[{tmp},
  Catch[
    Scan[Function[If[Not[AtomQ[tmp=InverseFunctionOfLinear[#,x]]],Throw[tmp]]],u];
    False]]]]


(* ::Subsection::Closed:: *)
(*TryPureTanSubst*)


TryPureTanSubst[u_,x_Symbol] :=
(*  Not[MatchQ[u,Log[v_]]] &&
  Not[MatchQ[u,f_[v_]^2 /; LinearQ[v,x]]] &&
  Not[MatchQ[u,ArcTan[a_.*Tan[v_]] /; FreeQ[a,x]]] &&
  Not[MatchQ[u,ArcTan[a_.*Cot[v_]] /; FreeQ[a,x]]] &&
  Not[MatchQ[u,ArcCot[a_.*Tan[v_]] /; FreeQ[a,x]]] &&
  Not[MatchQ[u,ArcCot[a_.*Cot[v_]] /; FreeQ[a,x]]] &&
  u===ExpandIntegrand[u,x] *)
  Not[MatchQ[u,F_[c_.*(a_.+b_.*G_[v_])] /; FreeQ[{a,b,c},x] && MemberQ[{ArcTan,ArcCot,ArcTanh,ArcCoth},F] && MemberQ[{Tan,Cot,Tanh,Coth},G] && LinearQ[v,x]]]


(* ::Subsection::Closed:: *)
(*TryPureTanhSubst*)


MemberQ[{Sinh,Cosh,Sech,Csch},f]


TryTanhSubst[u_,x_Symbol] :=
  FalseQ[FunctionOfLinear[u,x]] &&
  Not[MatchQ[u,r_.*(s_+t_)^n_. /; IntegerQ[n] && n>0]] &&
(*Not[MatchQ[u,Log[f_[x]^2] /; MemberQ[{Sinh,Cosh,Sech,Csch},f]]]  && *)
  Not[MatchQ[u,Log[v_]]]  &&
  Not[MatchQ[u,1/(a_+b_.*f_[x]^n_) /; MemberQ[{Sinh,Cosh,Sech,Csch},f] && IntegerQ[n] && n>2]] &&
  Not[MatchQ[u,f_[m_.*x]*g_[n_.*x] /; IntegersQ[m,n] && MemberQ[{Sinh,Cosh,Sech,Csch},f] && MemberQ[{Sinh,Cosh,Sech,Csch},g]]] &&
  Not[MatchQ[u,r_.*(a_.*s_^m_)^p_ /; FreeQ[{a,m,p},x] && Not[m===2 && (s===Sech[x] || s===Csch[x])]]] &&
  u===ExpandIntegrand[u,x]


TryPureTanhSubst[u_,x_Symbol] :=
  Not[MatchQ[u,Log[v_]]]  &&
  Not[MatchQ[u,ArcTanh[a_.*Tanh[v_]] /; FreeQ[a,x]]] &&
  Not[MatchQ[u,ArcTanh[a_.*Coth[v_]] /; FreeQ[a,x]]] &&
  Not[MatchQ[u,ArcCoth[a_.*Tanh[v_]] /; FreeQ[a,x]]] &&
  Not[MatchQ[u,ArcCoth[a_.*Coth[v_]] /; FreeQ[a,x]]] &&
  u===ExpandIntegrand[u,x]


(* ::Subsection::Closed:: *)
(*SubstPower[F[x],x,n]*)


SubstPower::usage = "SubstPower[F[x],x,n] returns F[x] with x^m replaced by x^(m*n) and x replaced by x^n.";
SubstPower[Fx_,x_Symbol,n_Integer] :=
  If[AtomQ[Fx],
    If[Fx===x,
      x^n,
    Fx],
  If[PowerQ[Fx] && Fx[[1]]===x && FreeQ[Fx[[2]],x],
    x^(n*Fx[[2]]),
  Map[Function[SubstPower[#,x,n]],Fx]]]


(* ::Section::Closed:: *)
(*Inert trig functions*)


(* ::Subsection::Closed:: *)
(*InertTrigQ*)


InertTrigQ[f_] := MemberQ[{sin,cos,tan,cot,sec,csc},f]

InertTrigQ[f_,g_] := 
  If[f===g,
    InertTrigQ[f],
  InertReciprocalQ[f,g] || InertReciprocalQ[g,f]]

InertTrigQ[f_,g_,h_] := InertTrigQ[f,g] && InertTrigQ[g,h]


InertReciprocalQ[f_,g_] := f===sin && g===csc || f===cos && g===sec || f===tan && g===cot


InertTrigFreeQ[u_] := FreeQ[u,sin] && FreeQ[u,cos] && FreeQ[u,tan] && FreeQ[u,cot] && FreeQ[u,sec] && FreeQ[u,csc]


(* ::Subsection::Closed:: *)
(*ActivateTrig[u]*)


ActivateTrig[u_] :=
  ReplaceAll[u,{sin->Sin,cos->Cos,tan->Tan,cot->Cot,sec->Sec,csc->Csc}]


(* ::Subsection::Closed:: *)
(*DeactivateTrig[u,x]*)


DeactivateTrig::usage = "u is a function of trig functions of a linear function of x.  DeactivateTrig[u,x] returns u with the trig functions replaced with inert trig functions.";
DeactivateTrig[(c_.+d_.*x_)^m_.*(a_.+b_.*trig_[e_.+f_.*x_])^n_.,x_] :=
  (c+d*x)^m*(a+b*DeactivateTrig[trig[e+f*x],x])^n /;
FreeQ[{a,b,c,d,e,f,m,n},x] && (TrigQ[trig] || HyperbolicQ[trig])


DeactivateTrig[u_,x_] :=
  UnifyInertTrigFunction[FixInertTrigFunction[DeactivateTrigAux[u,x],x],x]


DeactivateTrigAux[u_,x_] :=
  If[AtomQ[u],
    u,
  If[TrigQ[u] && LinearQ[u[[1]],x],
    With[{v=ExpandToSum[u[[1]],x]},
    Switch[Head[u],
	  Sin, ReduceInertTrig[sin,v],
	  Cos, ReduceInertTrig[cos,v],
	  Tan, ReduceInertTrig[tan,v],
	  Cot, ReduceInertTrig[cot,v],
	  Sec, ReduceInertTrig[sec,v],
	  Csc, ReduceInertTrig[csc,v]]],
  If[HyperbolicQ[u] && LinearQ[u[[1]],x],
    With[{v=ExpandToSum[I*u[[1]],x]},
    Switch[Head[u],
	  Sinh, -I*ReduceInertTrig[sin,v],
	  Cosh, ReduceInertTrig[cos,v],
	  Tanh, -I*ReduceInertTrig[tan,v],
	  Coth, I*ReduceInertTrig[cot,v],
	  Sech, ReduceInertTrig[sec,v],
	  Csch, I*ReduceInertTrig[csc,v]]],
  Map[Function[DeactivateTrigAux[#,x]],u]]]]


(* ::Subsection::Closed:: *)
(*FixInertTrigFunction[u,x]*)


Clear[FixInertTrigFunction]

FixInertTrigFunction[a_*u_,x_] :=
  a*FixInertTrigFunction[u,x] /;
FreeQ[a,x]

FixInertTrigFunction[u_.*(a_*(b_+v_))^n_,x_] :=
  FixInertTrigFunction[u*(a*b+a*v)^n,x] /;
FreeQ[{a,b,n},x] && Not[FreeQ[v,x]]


FixInertTrigFunction[csc[v_]^m_.*(c_.*sin[w_])^n_.,x_] :=
  sin[v]^(-m)*(c*sin[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[sec[v_]^m_.*(c_.*cos[w_])^n_.,x_] :=
  cos[v]^(-m)*(c*cos[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[cot[v_]^m_.*(c_.*tan[w_])^n_.,x_] :=
  tan[v]^(-m)*(c*tan[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[tan[v_]^m_.*(c_.*cot[w_])^n_.,x_] :=
  cot[v]^(-m)*(c*cot[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[cos[v_]^m_.*(c_.*sec[w_])^n_.,x_] :=
  sec[v]^(-m)*(c*sec[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[sin[v_]^m_.*(c_.*csc[w_])^n_.,x_] :=
  csc[v]^(-m)*(c*csc[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]


FixInertTrigFunction[sec[v_]^m_.*(c_.*sin[w_])^n_.,x_] :=
  cos[v]^(-m)*(c*sin[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[csc[v_]^m_.*(c_.*cos[w_])^n_.,x_] :=
  sin[v]^(-m)*(c*cos[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[cos[v_]^m_.*(c_.*tan[w_])^n_.,x_] :=
  sec[v]^(-m)*(c*tan[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[sin[v_]^m_.*(c_.*cot[w_])^n_.,x_] :=
  csc[v]^(-m)*(c*cot[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[sin[v_]^m_.*(c_.*sec[w_])^n_.,x_] :=
  csc[v]^(-m)*(c*sec[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[cos[v_]^m_.*(c_.*csc[w_])^n_.,x_] :=
  sec[v]^(-m)*(c*csc[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]


FixInertTrigFunction[cot[v_]^m_.*(c_.*sin[w_])^n_.,x_] :=
  tan[v]^(-m)*(c*sin[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[tan[v_]^m_.*(c_.*cos[w_])^n_.,x_] :=
  cot[v]^(-m)*(c*cos[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[csc[v_]^m_.*(c_.*tan[w_])^n_.,x_] :=
  sin[v]^(-m)*(c*tan[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[sec[v_]^m_.*(c_.*cot[w_])^n_.,x_] :=
  cos[v]^(-m)*(c*cot[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[cot[v_]^m_.*(c_.*sec[w_])^n_.,x_] :=
  tan[v]^(-m)*(c*sec[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]

FixInertTrigFunction[tan[v_]^m_.*(c_.*csc[w_])^n_.,x_] :=
  cot[v]^(-m)*(c*csc[w])^n /;
FreeQ[{c,n},x] && IntegerQ[m]


FixInertTrigFunction[sec[v_]^m_.*sec[w_]^n_.,x_] :=
  cos[v]^(-m)*cos[w]^(-n) /;
IntegersQ[m,n]

FixInertTrigFunction[csc[v_]^m_.*csc[w_]^n_.,x_] :=
  sin[v]^(-m)*sin[w]^(-n) /;
IntegersQ[m,n]


FixInertTrigFunction[u_*tan[v_]^m_.*(a_+b_.*sin[w_])^n_.,x_] :=
  sin[v]^m/cos[v]^m*FixInertTrigFunction[u*(a+b*sin[w])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]

FixInertTrigFunction[u_*cot[v_]^m_.*(a_+b_.*sin[w_])^n_.,x_] :=
  cos[v]^m/sin[v]^m*FixInertTrigFunction[u*(a+b*sin[w])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]

FixInertTrigFunction[u_*tan[v_]^m_.*(a_+b_.*cos[w_])^n_.,x_] :=
  sin[v]^m/cos[v]^m*FixInertTrigFunction[u*(a+b*cos[w])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]

FixInertTrigFunction[u_*cot[v_]^m_.*(a_+b_.*cos[w_])^n_.,x_] :=
  cos[v]^m/sin[v]^m*FixInertTrigFunction[u*(a+b*cos[w])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]


FixInertTrigFunction[cot[v_]^m_.*(a_.+b_.*(c_.*sin[w_])^p_.)^n_.,x_] :=
  tan[v]^(-m)*(a+b*(c*sin[w])^p)^n /;
FreeQ[{a,b,c,n,p},x] && IntegerQ[m]

FixInertTrigFunction[tan[v_]^m_.*(a_.+b_.*(c_.*cos[w_])^p_.)^n_.,x_] :=
  cot[v]^(-m)*(a+b*(c*cos[w])^p)^n /;
FreeQ[{a,b,c,n,p},x] && IntegerQ[m]


FixInertTrigFunction[u_.*(c_.*sin[v_]^n_.)^p_.*w_,x_] :=
  (c*sin[v]^n)^p*FixInertTrigFunction[u*w,x] /;
FreeQ[{c,p},x] && PowerOfInertTrigSumQ[w,sin,x]

FixInertTrigFunction[u_.*(c_.*cos[v_]^n_.)^p_.*w_,x_] :=
  (c*cos[v]^n)^p*FixInertTrigFunction[u*w,x] /;
FreeQ[{c,p},x] && PowerOfInertTrigSumQ[w,cos,x]

FixInertTrigFunction[u_.*(c_.*tan[v_]^n_.)^p_.*w_,x_] :=
  (c*tan[v]^n)^p*FixInertTrigFunction[u*w,x] /;
FreeQ[{c,p},x] && PowerOfInertTrigSumQ[w,tan,x]

FixInertTrigFunction[u_.*(c_.*cot[v_]^n_.)^p_.*w_,x_] :=
  (c*cot[v]^n)^p*FixInertTrigFunction[u*w,x] /;
FreeQ[{c,p},x] && PowerOfInertTrigSumQ[w,cot,x]

FixInertTrigFunction[u_.*(c_.*sec[v_]^n_.)^p_.*w_,x_] :=
  (c*sec[v]^n)^p*FixInertTrigFunction[u*w,x] /;
FreeQ[{c,p},x] && PowerOfInertTrigSumQ[w,sec,x]

FixInertTrigFunction[u_.*(c_.*csc[v_]^n_.)^p_.*w_,x_] :=
  (c*csc[v]^n)^p*FixInertTrigFunction[u*w,x] /;
FreeQ[{c,p},x] && PowerOfInertTrigSumQ[w,csc,x]


FixInertTrigFunction[u_.*sec[v_]^n_.*w_,x_] :=
  cos[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,cos,x] && IntegerQ[n]

FixInertTrigFunction[u_.*csc[v_]^n_.*w_,x_] :=
  sin[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,sin,x] && IntegerQ[n]

FixInertTrigFunction[u_.*sec[v_]^n_.*w_,x_] :=
  cos[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,sin,x] && IntegerQ[n]

FixInertTrigFunction[u_.*csc[v_]^n_.*w_,x_] :=
  sin[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,cos,x] && IntegerQ[n]


FixInertTrigFunction[u_.*cot[v_]^n_.*w_,x_] :=
  tan[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,tan,x] && IntegerQ[n]

FixInertTrigFunction[u_.*cos[v_]^n_.*w_,x_] :=
  sec[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,tan,x] && IntegerQ[n]

FixInertTrigFunction[u_.*cos[v_]^n_*w_,x_] :=
  sec[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,tan,x] && IntegerQ[n]

FixInertTrigFunction[u_.*csc[v_]^n_.*w_,x_] :=
  sin[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,tan,x] && IntegerQ[n]


FixInertTrigFunction[u_.*tan[v_]^n_.*w_,x_] :=
  cot[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,cot,x] && IntegerQ[n]

FixInertTrigFunction[u_.*sin[v_]^n_.*w_,x_] :=
  csc[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,cot,x] && IntegerQ[n]

FixInertTrigFunction[u_.*sin[v_]^n_.*w_,x_] :=
  csc[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,cot,x] && IntegerQ[n]

FixInertTrigFunction[u_.*sec[v_]^n_.*w_,x_] :=
  cos[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,cot,x] && IntegerQ[n]


FixInertTrigFunction[u_.*cos[v_]^n_.*w_,x_] :=
  sec[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,sec,x] && IntegerQ[n]

FixInertTrigFunction[u_.*cot[v_]^n_.*w_,x_] :=
  tan[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,sec,x] && IntegerQ[n]

FixInertTrigFunction[u_.*csc[v_]^n_.*w_,x_] :=
  sin[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,sec,x] && IntegerQ[n]


FixInertTrigFunction[u_.*sin[v_]^n_.*w_,x_] :=
  csc[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,csc,x] && IntegerQ[n]

FixInertTrigFunction[u_.*tan[v_]^n_.*w_,x_] :=
  cot[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,csc,x] && IntegerQ[n]

FixInertTrigFunction[u_.*sec[v_]^n_.*w_,x_] :=
  cos[v]^(-n)*FixInertTrigFunction[u*w,x] /;
PowerOfInertTrigSumQ[w,csc,x] && IntegerQ[n]


FixInertTrigFunction[u_.*tan[v_]^m_.*(a_.*sin[v_]+b_.*cos[v_])^n_.,x_] :=
  sin[v]^m*cos[v]^(-m)*FixInertTrigFunction[u*(a*sin[v]+b*cos[v])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]

FixInertTrigFunction[u_.*cot[v_]^m_.*(a_.*sin[v_]+b_.*cos[v_])^n_.,x_] :=
  cos[v]^m*sin[v]^(-m)*FixInertTrigFunction[u*(a*sin[v]+b*cos[v])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]

FixInertTrigFunction[u_.*sec[v_]^m_.*(a_.*sin[v_]+b_.*cos[v_])^n_.,x_] :=
  cos[v]^(-m)*FixInertTrigFunction[u*(a*sin[v]+b*cos[v])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]

FixInertTrigFunction[u_.*csc[v_]^m_.*(a_.*sin[v_]+b_.*cos[v_])^n_.,x_] :=
  sin[v]^(-m)*FixInertTrigFunction[u*(a*sin[v]+b*cos[v])^n,x] /;
FreeQ[{a,b,n},x] && IntegerQ[m]


FixInertTrigFunction[f_[v_]^m_.*(A_.+B_.*g_[v_]+C_.*g_[v_]^2),x_] :=
  g[v]^(-m)*(A+B*g[v]+C*g[v]^2) /;
FreeQ[{A,B,C},x] && IntegerQ[m] && (InertReciprocalQ[f,g] || InertReciprocalQ[g,f])

FixInertTrigFunction[f_[v_]^m_.*(A_.+C_.*g_[v_]^2),x_] :=
  g[v]^(-m)*(A+C*g[v]^2) /;
FreeQ[{A,C},x] && IntegerQ[m] && (InertReciprocalQ[f,g] || InertReciprocalQ[g,f])


FixInertTrigFunction[f_[v_]^m_.*(A_.+B_.*g_[v_]+C_.*g_[v_]^2)*(a_.+b_.*g_[v_])^n_.,x_] :=
  g[v]^(-m)*(A+B*g[v]+C*g[v]^2)*(a+b*g[v])^n /;
FreeQ[{a,b,A,B,C,n},x] && IntegerQ[m] && (InertReciprocalQ[f,g] || InertReciprocalQ[g,f])

FixInertTrigFunction[f_[v_]^m_.*(A_.+C_.*g_[v_]^2)*(a_.+b_.*g_[v_])^n_.,x_] :=
  g[v]^(-m)*(A+C*g[v]^2)*(a+b*g[v])^n /;
FreeQ[{a,b,A,C,n},x] && IntegerQ[m] && (InertReciprocalQ[f,g] || InertReciprocalQ[g,f])


FixInertTrigFunction[u_,x_] := u


PowerOfInertTrigSumQ[u_,func_,x_] :=
  MatchQ[u, (a_.+b_.*(c_.*func[w_])^n_.)^p_. /; FreeQ[{a,b,c,n,p},x] && Not[EqQ[a,0] && (IntegerQ[p] || EqQ[n,1])]] || 
  MatchQ[u, (a_.+b_.*(d_.*func[w_])^p_.+c_.*(d_.*func[w_])^q_.)^n_. /; FreeQ[{a,b,c,d,n,p,q},x]]


(* ::Subsection::Closed:: *)
(*ReduceInertTrig[func,a,b,x]*)


ReduceInertTrig[func_,m_.*(n_.*Pi+u_.)+v_.] :=
  ReduceInertTrig[func,m*n,m*u+v] /;
RationalQ[m,n]

ReduceInertTrig[func_,m_.*Complex[0,mz_]*(n_.*Complex[0,nz_]*Pi+u_.)+v_.] :=
  ReduceInertTrig[func,-m*mz*n*nz,m*mz*I*u+v] /;
RationalQ[m,mz,n,nz]

ReduceInertTrig[func_,u_] :=
  func[u]


ReduceInertTrig::usage = "func is an inert function and m is rational  ReduceInertTrig[func,m_,u_] returns func[m*Pi+u] with m reduced 0<=m<1/2.";
ReduceInertTrig[func_,m_,u_] :=
  If[m<0,
    If[m>=-1/4,
      func[m*Pi+u],
    Switch[func,
	  sin, -ReduceInertTrig[sin,-m,-u],
	  cos, ReduceInertTrig[cos,-m,-u],
	  tan, -ReduceInertTrig[tan,-m,-u],
	  cot, -ReduceInertTrig[cot,-m,-u],
	  sec, ReduceInertTrig[sec,-m,-u],
	  csc, -ReduceInertTrig[csc,-m,-u]]],
  If[m>=2,
    ReduceInertTrig[func,Mod[m,2],u],
  If[m>=1,
    Switch[func,
	  sin, -ReduceInertTrig[sin,m-1,u],
	  cos, -ReduceInertTrig[cos,m-1,u],
	  tan, ReduceInertTrig[tan,m-1,u],
	  cot, ReduceInertTrig[cot,m-1,u],
	  sec, -ReduceInertTrig[sec,m-1,u],
	  csc, -ReduceInertTrig[csc,m-1,u]],
  If[m>=1/2,
    Switch[func,
	  sin, ReduceInertTrig[cos,m-1/2,u],
	  cos, -ReduceInertTrig[sin,m-1/2,u],
	  tan, -ReduceInertTrig[cot,m-1/2,u],
	  cot, -ReduceInertTrig[tan,m-1/2,u],
	  sec, -ReduceInertTrig[csc,m-1/2,u],
	  csc, ReduceInertTrig[sec,m-1/2,u]],
  func[m*Pi+u]]]]] /;
RationalQ[m]


(* ::Subsection::Closed:: *)
(*UnifyInertTrigFunction[u,x]*)


Clear[UnifyInertTrigFunction]


UnifyInertTrigFunction[a_*u_,x_] :=
  a*UnifyInertTrigFunction[u,x] /;
FreeQ[a,x]


(* ::Subsubsection:: *)
(*Cosine to sine*)


(* ::Subsubsection::Closed:: *)
(*1.0 (a sin)^m (b trg)^n*)


(* ::Text:: *)
(*(a Cos[e+f x])^m (b Csc[e+f x])^n == (a Sin[e+Pi/2+f x])^m (-b Sec[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.*cos[e_.+f_.*x_])^m_.*(b_.*csc[e_.+f_.*x_])^n_.,x_] :=
  (a*sin[e+Pi/2+f*x])^m*(-b*sec[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,m,n},x]


(* ::Text:: *)
(*(a Cos[e+f x])^m (b Sec[e+f x])^n == (a Sin[e+Pi/2+f x])^m (b Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.*cos[e_.+f_.*x_])^m_.*(b_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (a*sin[e+Pi/2+f*x])^m*(b*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*1.1.1 (a+b sin)^n*)


(* ::Text:: *)
(*(a+b Cos[e+f x])^n == (a+b Sin[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^n_.,x_] :=
  (a+b*sin[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,n},x]


(* ::Subsubsection::Closed:: *)
(*1.1.2 (g cos)^p (a+b sin)^m*)


(* ::Text:: *)
(*(g Sin[e+f x])^p (a+b Cos[e+f x])^m == (g Cos[e-Pi/2+f x])^p (a-b Sin[e-Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*sin[e_.+f_.*x_])^p_.*(a_+b_.*cos[e_.+f_.*x_])^m_.,x_] :=
  (g*cos[e-Pi/2+f*x])^p*(a-b*sin[e-Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Text:: *)
(*(g Csc[e+f x])^p (a+b Cos[e+f x])^m == (g Sec[e-Pi/2+f x])^p (a-b Sin[e-Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*csc[e_.+f_.*x_])^p_.*(a_+b_.*cos[e_.+f_.*x_])^m_.,x_] :=
  (g*sec[e-Pi/2+f*x])^p*(a-b*sin[e-Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Subsubsection::Closed:: *)
(*1.1.3 (g tan)^p (a+b sin)^m*)


(* ::Text:: *)
(*(g Cot[e+f x])^p (a+b Cos[e+f x])^m == (-g Tan[e-Pi/2+f x])^p (a-b Sin[e-Pi/2+f x])^m*)


(* ::Text:: *)
(*(g Cot[e+f x])^p (a+b Cos[e+f x])^m == (-g Tan[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*cot[e_.+f_.*x_])^p_.*(a_+b_.*cos[e_.+f_.*x_])^m_.,x_] :=
  If[True,
    (-g*tan[e-Pi/2+f*x])^p*(a-b*sin[e-Pi/2+f*x])^m,
  (-g*tan[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m] /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Text:: *)
(*(g Tan[e+f x])^p (a+b Cos[e+f x])^m == (-g Cot[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*tan[e_.+f_.*x_])^p_.*(a_+b_.*cos[e_.+f_.*x_])^m_.,x_] :=
  (-g*cot[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Subsubsection::Closed:: *)
(*1.2.1 (a+b sin)^m (c+d sin)^n*)


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (c+d Cos[e+f x])^n == (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.,x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,m,n},x]


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (c+d Sec[e+f x])^n == (a+b Sin[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*1.2.2 (g cos)^p (a+b sin)^m (c+d sin)^n*)


(* ::Text:: *)
(*(g Sin[e+f x])^p (a+b Cos[e+f x])^m (c+d Cos[e+f x])^n == (g Cos[e-Pi/2+f x])^p (a-b Sin[e-Pi/2+f x])^m (c-d Sin[e-Pi/2+f x])^n*)


(* ::Text:: *)
(*(g Sin[e+f x])^p (a+b Cos[e+f x])^m (c+d Cos[e+f x])^n == (-g Cos[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*sin[e_.+f_. x_])^p_.*(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.,x_] :=
  If[IntegerQ[2*p] && p<0 && IntegerQ[2*n],
    (g*cos[e-Pi/2+f*x])^p*(a-b*sin[e-Pi/2+f*x])^m*(c-d*sin[e-Pi/2+f*x])^n,
  (-g*cos[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n] /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Text:: *)
(*(g Csc[e+f x])^p (a+b Cos[e+f x])^m (c+d Cos[e+f x])^n == (g Sec[e-Pi/2+f x])^p (a-b Sin[e-Pi/2+f x])^m (c-d Sin[e-Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*csc[e_.+f_.*x_])^p_.*(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.,x_] :=
  (g*sec[e-Pi/2+f*x])^p*(a-b*sin[e-Pi/2+f*x])^m*(c-d*sin[e-Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Subsubsection::Closed:: *)
(*1.2.3 (g sin)^p (a+b sin)^m (c+d sin)^n*)


(* ::Text:: *)
(*(g Cos[e+f x])^p (a+b Cos[e+f x])^m (c+d Cos[e+f x])^n == (g Sin[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*cos[e_.+f_.*x_])^p_.*(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.,x_] :=
  (g*sin[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Text:: *)
(*(g Cos[e+f x])^p (a+b Cos[e+f x])^m (c+d Sec[e+f x])^n == (g Sin[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*cos[e_.+f_.*x_])^p_.*(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (g*sin[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Text:: *)
(*(g Sec[e+f x])^p (a+b Cos[e+f x])^m (c+d Cos[e+f x])^n == (g Csc[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*sec[e_.+f_.*x_])^p_.*(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.,x_] :=
  (g*csc[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Text:: *)
(*(g Sec[e+f x])^p (a+b Cos[e+f x])^m (c+d Sec[e+f x])^n == (g Csc[e+Pi/2+f x])^p (a+b Sin[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*sec[e_.+f_.*x_])^p_.*(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (g*csc[e+Pi/2+f*x])^p*(a+b*sin[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Subsubsection::Closed:: *)
(*1.3.1 (a+b sin)^m (c+d sin)^n (A+B sin)*)


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (c+d Cos[e+f x])^n (A+B Cos[e+f x]) == (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n (A+B Sin[e+Pi/2+f x])*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.*(A_.+B_.*cos[e_.+f_.*x_]),x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n*(A+B*sin[e+Pi/2+f*x]) /;
FreeQ[{a,b,c,d,e,f,A,B,m,n},x]


(* ::Subsubsection::Closed:: *)
(*1.4.1 (a+b sin)^m (A+B sin+C sin^2)*)


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (A+B Cos[e+f x]+C Cos[e+f x]^2) == (a+b Sin[e+Pi/2+f x])^m (A+B Sin[e+Pi/2+f x]+C Sin[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(A_.+B_.*cos[e_.+f_.*x_]+C_.*cos[e_.+f_.*x_]^2),x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(A+B*sin[e+Pi/2+f*x]+C*sin[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,c,e,f,A,B,C,m},x]


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (A+C Cos[e+f x]^2) == (a+b Sin[e+Pi/2+f x])^m (A+C Sin[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(A_.+C_.*cos[e_.+f_.*x_]^2),x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(A+C*sin[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,c,e,f,A,C,m},x]


(* ::Subsubsection::Closed:: *)
(*1.4.2 (a+b sin)^m (c+d sin)^n (A+B sin+C sin^2)*)


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (c+d Cos[e+f x])^n (A+B Cos[e+f x]+C Cos[e+f x]^2) == (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n (A+B Sin[e+Pi/2+f x]+C Sin[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.*(A_.+B_.*cos[e_.+f_.*x_]+C_.*cos[e_.+f_.*x_]^2),x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n*(A+B*sin[e+Pi/2+f*x]+C*sin[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,c,d,e,f,A,B,C,m,n},x]


(* ::Text:: *)
(*(a+b Cos[e+f x])^m (c+d Cos[e+f x])^n (A+C Cos[e+f x]^2) == (a+b Sin[e+Pi/2+f x])^m (c+d Sin[e+Pi/2+f x])^n (A+C Sin[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_])^m_.*(c_.+d_.*cos[e_.+f_.*x_])^n_.*(A_.+C_.*cos[e_.+f_.*x_]^2),x_] :=
  (a+b*sin[e+Pi/2+f*x])^m*(c+d*sin[e+Pi/2+f*x])^n*(A+C*sin[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,c,d,e,f,A,C,m,n},x]


(* ::Subsubsection::Closed:: *)
(*1.7 (d trig)^m (a+b (c sin)^n)^p*)


(* ::Text:: *)
(*(a+b (c Cos[e+f x])^n)^p == (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_,x_] :=
  (a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,e,f,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Cos[e+f x])^m (a+b (c Cos[e+f x])^n)^p == (d Sin[e+Pi/2+f x])^m (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*cos[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_.,x_] :=
  (d*sin[e+Pi/2+f*x])^m*(a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Sin[e+f x])^m (a+b (c Cos[e+f x])^n)^p == (-d Cos[e+Pi/2+f x])^m (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*sin[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*cos[e+Pi/2+f*x])^m*(a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Cot[e+f x])^m (a+b (c Cos[e+f x])^n)^p == (-d Tan[e+Pi/2+f x])^m (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*cot[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*tan[e+Pi/2+f*x])^m*(a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Tan[e+f x])^m (a+b (c Cos[e+f x])^n)^p == (-d Cot[e+Pi/2+f x])^m (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*tan[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*cot[e+Pi/2+f*x])^m*(a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Csc[e+f x])^m (a+b (c Cos[e+f x])^n)^p == (-d Sec[e+Pi/2+f x])^m (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*csc[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*sec[e+Pi/2+f*x])^m*(a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Sec[e+f x])^m (a+b (c Cos[e+f x])^n)^p == (d Csc[e+Pi/2+f x])^m (a+b (c Sin[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*sec[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cos[e_.+f_.*x_])^n_)^p_.,x_] :=
  (d*csc[e+Pi/2+f*x])^m*(a+b*(c*sin[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(a+b Cos[e+f x]^n)^m (A+B Cos[e+f x]^n) == (a+b Sin[e+Pi/2+f x]^n)^m (A+B Sin[e+Pi/2+f x]^n)*)


UnifyInertTrigFunction[(a_.+b_.*cos[e_.+f_.*x_]^n_)^m_.*(A_.+B_.*cos[e_.+f_.*x_]^n_),x_] :=
  (a+b*sin[e+Pi/2+f*x]^n)^m*(A+B*sin[e+Pi/2+f*x]^n) /;
FreeQ[{a,b,e,f,A,B,m,n},x] && Not[EqQ[a,0] && IntegerQ[m]]


(* ::Subsubsection:: *)
(*Cotangent to tangent*)


(* ::Subsubsection::Closed:: *)
(*2.0 (a trg)^m (b tan)^n*)


(* ::Text:: *)
(*(a Cos[e+f x])^m (b Cot[e+f x])^n == (a Sin[e+Pi/2+f x])^m (-b Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.*cos[e_.+f_.*x_])^m_.*(b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (a*sin[e+Pi/2+f*x])^m*(-b*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,m,n},x]


(* ::Text:: *)
(*(a Sin[e+f x])^m (b Cot[e+f x])^n == (a Cos[e-Pi/2+f x])^m (-b Tan[e-Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.*sin[e_.+f_.*x_])^m_.*(b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (a*cos[e-Pi/2+f*x])^m*(-b*tan[e-Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,m,n},x]


(* ::Text:: *)
(*(a Csc[e+f x])^m (b Cot[e+f x])^n == (a Sec[e-Pi/2+f x])^m (-b Tan[e-Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.*csc[e_.+f_.*x_])^m_.*(b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (a*sec[e-Pi/2+f*x])^m*(-b*tan[e-Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,m,n},x]


(* ::Text:: *)
(*(a Sec[e+f x])^m (b Cot[e+f x])^n == (a Csc[e+Pi/2+f x])^m (-b Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.*sec[e_.+f_.*x_])^m_.*(b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (a*csc[e+Pi/2+f*x])^m*(-b*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*2.1.1 (a+b tan)^n*)


(* ::Text:: *)
(*(a+b Cot[e+f x])^n == (a-b Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (a-b*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,n},x]


(* ::Subsubsection::Closed:: *)
(*2.1.2 (d sec)^m (a+b tan)^n*)


(* ::Text:: *)
(*(d Csc[e+f x])^m (a+b Cot[e+f x])^n == (d Sec[e-Pi/2+f x])^m (a-b Tan[e-Pi/2+f x])^n*)


UnifyInertTrigFunction[(d_.*csc[e_.+f_.*x_])^m_.*(a_+b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (d*sec[e-Pi/2+f*x])^m*(a-b*tan[e-Pi/2+f*x])^n /;
FreeQ[{a,b,d,e,f,m,n},x]


(* ::Text:: *)
(*(d Sin[e+f x])^m (a+b Cot[e+f x])^n == (d Cos[e-Pi/2+f x])^m (a-b Tan[e-Pi/2+f x])^n*)


UnifyInertTrigFunction[(d_.*sin[e_.+f_.*x_])^m_.*(a_+b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (d*cos[e-Pi/2+f*x])^m*(a-b*tan[e-Pi/2+f*x])^n /;
FreeQ[{a,b,d,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*2.1.3 (d sin)^m (a+b tan)^n*)


(* ::Text:: *)
(*(d Cos[e+f x])^m (a+b Cot[e+f x])^n == (d Sin[e+Pi/2+f x])^m (a-b Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(d_.*cos[e_.+f_.*x_])^m_.*(a_+b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (d*sin[e+Pi/2+f*x])^m*(a-b*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,d,e,f,m,n},x]


(* ::Text:: *)
(*(d Sec[e+f x])^m (a+b Cot[e+f x])^n == (d Csc[e+Pi/2+f x])^m (a-b Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(d_.*sec[e_.+f_.*x_])^m_.*(a_+b_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (d*csc[e+Pi/2+f*x])^m*(a-b*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,d,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*2.2.1 (a+b tan)^m (c+d tan)^n*)


(* ::Text:: *)
(*(a+b Cot[e+f x])^m (c+d Cot[e+f x])^n == (a-b Tan[e+Pi/2+f x])^m (c-d Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^m_.*(c_.+d_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (a-b*tan[e+Pi/2+f*x])^m*(c-d*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*2.2.3 (g tan)^p (a+b tan)^m (c+d tan)^n*)


(* ::Text:: *)
(*(g Cot[e+f x])^p (a+b Cot[e+f x])^m (c+d Cot[e+f x])^n == (-g Tan[e+Pi/2+f x])^p (a-b Tan[e+Pi/2+f x])^m (c-d Tan[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*cot[e_.+f_.*x_])^p_.*(a_.+b_.*cot[e_.+f_.*x_])^m_.*(c_.+d_.*cot[e_.+f_.*x_])^n_.,x_] :=
  (-g*tan[e+Pi/2+f*x])^p*(a-b*tan[e+Pi/2+f*x])^m*(c-d*tan[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Text:: *)
(*(g Cot[e+f x])^p (a+b Cot[e+f x])^m (c+d Tan[e+f x])^n == (-g Tan[e+Pi/2+f x])^p (a-b Tan[e+Pi/2+f x])^m (c-d Cot[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*cot[e_.+f_.*x_])^p_.*(a_.+b_.*cot[e_.+f_.*x_])^m_.*(c_.+d_.*tan[e_.+f_.*x_])^n_.,x_] :=
  (-g*tan[e+Pi/2+f*x])^p*(a-b*tan[e+Pi/2+f*x])^m*(c-d*cot[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Subsubsection::Closed:: *)
(*2.3.1 (a+b tan)^m (c+d tan)^n (A+B tan)*)


(* ::Text:: *)
(*(a+b Cot[e+f x])^m (c+d Cot[e+f x])^n (A+B Cot[e+f x]) == (a-b Tan[e+Pi/2+f x])^m (c-d Tan[e+Pi/2+f x])^n (A-B Tan[e+Pi/2+f x])*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^m_.*(c_.+d_.*cot[e_.+f_.*x_])^n_.*(A_.+B_.*cot[e_.+f_.*x_]),x_] :=
  (a-b*tan[e+Pi/2+f*x])^m*(c-d*tan[e+Pi/2+f*x])^n*(A-B*tan[e+Pi/2+f*x]) /;
FreeQ[{a,b,c,d,e,f,A,B,m,n},x]


(* ::Subsubsection::Closed:: *)
(*2.4.1 (a+b tan)^m (A+B tan+C tan^2)*)


(* ::Text:: *)
(*(a+b Cot[e+f x])^m (A+B Cot[e+f x]+C Cot[e+f x]^2) == (a-b Tan[e+Pi/2+f x])^m (A-B Tan[e+Pi/2+f x]+C Tan[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^m_.*(A_.+B_.*cot[e_.+f_.*x_]+C_.*cot[e_.+f_.*x_]^2),x_] :=
  (a-b*tan[e+Pi/2+f*x])^m*(A-B*tan[e+Pi/2+f*x]+C*tan[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,e,f,A,B,C,m},x]


(* ::Text:: *)
(*(a+b Cot[e+f x])^m (A+C Cot[e+f x]^2) == (a-b Tan[e+Pi/2+f x])^m (A+C Tan[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^m_.*(A_.+C_.*cot[e_.+f_.*x_]^2),x_] :=
  (a-b*tan[e+Pi/2+f*x])^m*(A+C*tan[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,e,f,A,C,m},x]


(* ::Subsubsection::Closed:: *)
(*2.4.2 (a+b tan)^m (c+d tan)^n (A+B tan+C tan^2)*)


(* ::Text:: *)
(*(a+b Cot[e+f x])^m (c+d Cot[e+f x])^n (A+B Cot[e+f x]+C Cot[e+f x]^2) == *)
(*		(a-b Tan[e+Pi/2+f x])^m (c-d Tan[e+Pi/2+f x])^n (A-B Tan[e+Pi/2+f x]+C Tan[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^m_.*(c_.+d_.*cot[e_.+f_.*x_])^n_.*(A_.+B_.*cot[e_.+f_.*x_]+C_.*cot[e_.+f_.*x_]^2),x_] :=
  (a-b*tan[e+Pi/2+f*x])^m*(c-d*tan[e+Pi/2+f*x])^n*(A-B*tan[e+Pi/2+f*x]+C*tan[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,c,d,e,f,A,B,C,m,n},x]


(* ::Text:: *)
(*(a+b Cot[e+f x])^m (c+d Cot[e+f x])^n (A+C Cot[e+f x]^2) == (a-b Tan[e+Pi/2+f x])^m (c-d Tan[e+Pi/2+f x])^n (A+C Tan[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*cot[e_.+f_.*x_])^m_.*(c_.+d_.*cot[e_.+f_.*x_])^n_.*(A_.+C_.*cot[e_.+f_.*x_]^2),x_] :=
  (a-b*tan[e+Pi/2+f*x])^m*(c-d*tan[e+Pi/2+f*x])^n*(A+C*tan[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,c,d,e,f,A,C,m,n},x]


(* ::Subsubsection::Closed:: *)
(*2.7 trig^m (a+b (c tan)^n)^p*)


(* ::Text:: *)
(*(a+b (c Cot[e+f x])^n)^p == (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_,x_] :=
  (a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,e,f,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Cos[e+f x])^m (a+b (c Cot[e+f x])^n)^p == (d Sin[e+Pi/2+f x])^m (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*cos[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_.,x_] :=
  (d*sin[e+Pi/2+f*x])^m*(a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Sin[e+f x])^m (a+b (c Cot[e+f x])^n)^p == (-d Cos[e+Pi/2+f x])^m (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*sin[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*cos[e+Pi/2+f*x])^m*(a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Cot[e+f x])^m (a+b (c Cot[e+f x])^n)^p == (-d Tan[e+Pi/2+f x])^m (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*cot[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*tan[e+Pi/2+f*x])^m*(a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Tan[e+f x])^m (a+b (c Cot[e+f x])^n)^p == (-d Cot[e+Pi/2+f x])^m (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*tan[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*cot[e+Pi/2+f*x])^m*(a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Csc[e+f x])^m (a+b (c Cot[e+f x])^n)^p == (-d Sec[e+Pi/2+f x])^m (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*csc[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*sec[e+Pi/2+f*x])^m*(a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Sec[e+f x])^m (a+b (c Cot[e+f x])^n)^p == (d Csc[e+Pi/2+f x])^m (a+b (-c Tan[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*sec[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*cot[e_.+f_.*x_])^n_)^p_.,x_] :=
  (d*csc[e+Pi/2+f*x])^m*(a+b*(-c*tan[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Subsubsection:: *)
(*Cosecant to secant*)


(* ::Subsubsection::Closed:: *)
(*3.1.1 (a+b sec)^n*)


(* ::Text:: *)
(*(a+b Sec[e+f x])^n == (a+b Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (a+b*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,e,f,n},x]


(* ::Subsubsection::Closed:: *)
(*3.1.2 (d sec)^n (a+b sec)^m*)


(* ::Text:: *)
(*(g Sec[e+f x])^p (a+b Sec[e+f x])^m == (g Csc[e+Pi/2+f x])^p (a+b Csc[e+Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*sec[e_.+f_.*x_])^p_.*(a_+b_.*sec[e_.+f_.*x_])^m_.,x_] :=
  (g*csc[e+Pi/2+f*x])^p*(a+b*csc[e+Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Subsubsection::Closed:: *)
(*3.1.3 (d sin)^n (a+b sec)^m*)


(* ::Text:: *)
(*(g Sin[e+f x])^p (a+b Sec[e+f x])^m == (g Cos[e-Pi/2+f x])^p (a-b Csc[e-Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*sin[e_.+f_.*x_])^p_.*(a_+b_.*sec[e_.+f_.*x_])^m_.,x_] :=
  (g*cos[e-Pi/2+f*x])^p*(a-b*csc[e-Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Text:: *)
(*(g Csc[e+f x])^p (a+b Sec[e+f x])^m == (g Sec[e-Pi/2+f x])^p (a-b Csc[e-Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*csc[e_.+f_.*x_])^p_.*(a_+b_.*sec[e_.+f_.*x_])^m_.,x_] :=
  (g*sec[e-Pi/2+f*x])^p*(a-b*csc[e-Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Subsubsection::Closed:: *)
(*3.1.4 (d tan)^n (a+b sec)^m*)


(* ::Text:: *)
(*(g Tan[e+f x])^p (a+b Sec[e+f x])^m == (-g Cot[e+Pi/2+f x])^p (a+b Csc[e+Pi/2+f x])^m*)


UnifyInertTrigFunction[(g_.*tan[e_.+f_.*x_])^p_.*(a_+b_.*sec[e_.+f_.*x_])^m_.,x_] :=
  (-g*cot[e+Pi/2+f*x])^p*(a+b*csc[e+Pi/2+f*x])^m /;
FreeQ[{a,b,e,f,g,m,p},x]


(* ::Subsubsection::Closed:: *)
(*3.2.1 (a+b sec)^m (c+d sec)^n*)


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (c+d Sec[e+f x])^n == (a+b Csc[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,m,n},x]


(* ::Subsubsection::Closed:: *)
(*3.2.2 (g sec)^p (a+b sec)^m (c+d sec)^n*)


(* ::Text:: *)
(*(g Sec[e+f x])^p (a+b Sec[e+f x])^m (c+d Sec[e+f x])^n == (g Csc[e+Pi/2+f x])^p (a+b Csc[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*sec[e_.+f_.*x_])^p_.*(a_.+b_.*sec[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (g*csc[e+Pi/2+f*x])^p*(a+b*csc[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Text:: *)
(*(g Cos[e+f x])^p (a+b Sec[e+f x])^m (c+d Sec[e+f x])^n == (g Sin[e+Pi/2+f x])^p (a+b Csc[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n*)


UnifyInertTrigFunction[(g_.*cos[e_.+f_.*x_])^p_.*(a_.+b_.*sec[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.,x_] :=
  (g*sin[e+Pi/2+f*x])^p*(a+b*csc[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n /;
FreeQ[{a,b,c,d,e,f,g,m,n,p},x]


(* ::Subsubsection::Closed:: *)
(*3.3.1 (a+b sec)^m (d sec)^n (A+B sec)*)


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (d Sec[e+f x])^n (A+B Sec[e+f x]) == (a+b Csc[e+Pi/2+f x])^m (d Csc[e+Pi/2+f x])^n (A+B Csc[e+Pi/2+f x])*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(d_.*sec[e_.+f_.*x_])^n_.*(A_.+B_.*sec[e_.+f_.*x_]),x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(d*csc[e+Pi/2+f*x])^n*(A+B*csc[e+Pi/2+f*x]) /;
FreeQ[{a,b,d,e,f,A,B,m,n},x]


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (c+d Sec[e+f x])^n (A+B Sec[e+f x])^p == (a+b Csc[e+Pi/2+f x])^m (c+d Csc[e+Pi/2+f x])^n (A+B Csc[e+Pi/2+f x])^p*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(c_.+d_.*sec[e_.+f_.*x_])^n_.*(A_.+B_.*sec[e_.+f_.*x_])^p_.,x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(c+d*csc[e+Pi/2+f*x])^n*(A+B*csc[e+Pi/2+f*x])^p /;
FreeQ[{a,b,c,d,e,f,A,B,m,n,p},x]


(* ::Subsubsection::Closed:: *)
(*3.4.1 (a+b sec)^m (A+B sec+C sec^2)*)


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (A+B Sec[e+f x]+C Sec[e+f x]^2) == (a+b Csc[e+Pi/2+f x])^m (A+B Csc[e+Pi/2+f x]+C Csc[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(A_.+B_.*sec[e_.+f_.*x_]+C_.*sec[e_.+f_.*x_]^2),x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(A+B*csc[e+Pi/2+f*x]+C*csc[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,e,f,A,B,C,m},x]


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (A+B Sec[e+f x]+C Sec[e+f x]^2) == (a+b Csc[e+Pi/2+f x])^m (A+C Csc[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(A_.+C_.*sec[e_.+f_.*x_]^2),x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(A+C*csc[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,e,f,A,C,m},x]


(* ::Subsubsection::Closed:: *)
(*3.4.2 (a+b sec)^m (d sec)^n (A+B sec+C sec^2)*)


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (d Sec[e+f x])^n (A+B Sec[e+f x]+C Sec[e+f x]^2) == *)
(*		(a+b Csc[e+Pi/2+f x])^m (d Csc[e+Pi/2+f x])^n (A+B Csc[e+Pi/2+f x]+C Csc[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(d_.*sec[e_.+f_.*x_])^n_.*(A_.+B_.*sec[e_.+f_.*x_]+C_.*sec[e_.+f_.*x_]^2),x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(d*csc[e+Pi/2+f*x])^n*(A+B*csc[e+Pi/2+f*x]+C*csc[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,d,e,f,A,B,C,m,n},x]


(* ::Text:: *)
(*(a+b Sec[e+f x])^m (d Sec[e+f x])^n (A+C Sec[e+f x]^2) == (a+b Csc[e+Pi/2+f x])^m (d Csc[e+Pi/2+f x])^n (A+C Csc[e+Pi/2+f x]^2)*)


UnifyInertTrigFunction[(a_.+b_.*sec[e_.+f_.*x_])^m_.*(d_.*sec[e_.+f_.*x_])^n_.*(A_.+C_.*sec[e_.+f_.*x_]^2),x_] :=
  (a+b*csc[e+Pi/2+f*x])^m*(d*csc[e+Pi/2+f*x])^n*(A+C*csc[e+Pi/2+f*x]^2) /;
FreeQ[{a,b,d,e,f,A,C,m,n},x]


UnifyInertTrigFunction[u_,x_] := u


(* ::Subsubsection::Closed:: *)
(*3.7 (d trig)^m (a+b (c sec)^n)^p*)


(* ::Text:: *)
(*(a+b (c Csc[e+f x])^n)^p == (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_,x_] :=
  (a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,e,f,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Cos[e+f x])^m (a+b (c Csc[e+f x])^n)^p == (d Sin[e+Pi/2+f x])^m (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*cos[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_.,x_] :=
  (d*sin[e+Pi/2+f*x])^m*(a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Sin[e+f x])^m (a+b (c Csc[e+f x])^n)^p == (-d Cos[e+Pi/2+f x])^m (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*sin[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*cos[e+Pi/2+f*x])^m*(a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Cot[e+f x])^m (a+b (c Csc[e+f x])^n)^p == (-d Tan[e+Pi/2+f x])^m (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*cot[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*tan[e+Pi/2+f*x])^m*(a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Tan[e+f x])^m (a+b (c Csc[e+f x])^n)^p == (-d Cot[e+Pi/2+f x])^m (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*tan[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*cot[e+Pi/2+f*x])^m*(a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Csc[e+f x])^m (a+b (c Csc[e+f x])^n)^p == (-d Sec[e+Pi/2+f x])^m (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*csc[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_.,x_] :=
  (-d*sec[e+Pi/2+f*x])^m*(a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[n,2] && EqQ[p,1]] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Text:: *)
(*(d Sec[e+f x])^m (a+b (c Csc[e+f x])^n)^p == (d Csc[e+Pi/2+f x])^m (a+b (-c Sec[e+Pi/2+f x])^n)^p*)


UnifyInertTrigFunction[(d_.*sec[e_.+f_.*x_])^m_.*(a_.+b_.*(c_.*csc[e_.+f_.*x_])^n_)^p_.,x_] :=
  (d*csc[e+Pi/2+f*x])^m*(a+b*(-c*sec[e+Pi/2+f*x])^n)^p /;
FreeQ[{a,b,c,d,e,f,m,n,p},x] && Not[EqQ[a,0] && IntegerQ[p]]


(* ::Subsection::Closed:: *)
(*KnownTrigIntegrandQ[u,x]*)


KnownSineIntegrandQ[u_,x_Symbol] :=
  KnownTrigIntegrandQ[{sin,cos},u,x]


KnownTangentIntegrandQ[u_,x_Symbol] :=
  KnownTrigIntegrandQ[{tan},u,x]


KnownCotangentIntegrandQ[u_,x_Symbol] :=
  KnownTrigIntegrandQ[{cot},u,x]


KnownSecantIntegrandQ[u_,x_Symbol] :=
  KnownTrigIntegrandQ[{sec,csc},u,x]


KnownTrigIntegrandQ[list_,u_,x_Symbol] :=
  u===1 || 
  MatchQ[u,(a_.+b_.*func_[e_.+f_.*x])^m_. /; MemberQ[list,func] && FreeQ[{a,b,e,f,m},x]] || 
  MatchQ[u,(a_.+b_.*func_[e_.+f_.*x])^m_.*(A_.+B_.*func_[e_.+f_.*x]) /; MemberQ[list,func] && FreeQ[{a,b,e,f,A,B,m},x]] || 
  MatchQ[u,(A_.+C_.*func_[e_.+f_.*x]^2) /; MemberQ[list,func] && FreeQ[{e,f,A,C},x]] || 
  MatchQ[u,(A_.+B_.*func_[e_.+f_.*x]+C_.*func_[e_.+f_.*x]^2) /; MemberQ[list,func] && FreeQ[{e,f,A,B,C},x]] || 
  MatchQ[u,(a_.+b_.*func_[e_.+f_.*x])^m_.*(A_.+C_.*func_[e_.+f_.*x]^2) /; MemberQ[list,func] && FreeQ[{a,b,e,f,A,C,m},x]] || 
  MatchQ[u,(a_.+b_.*func_[e_.+f_.*x])^m_.*(A_.+B_.*func_[e_.+f_.*x]+C_.*func_[e_.+f_.*x]^2) /; MemberQ[list,func] && FreeQ[{a,b,e,f,A,B,C,m},x]]


(* ::Section::Closed:: *)
(*Inert inverse hyperbolic functions*)


(* ::Subsection::Closed:: *)
(*DeactivateInverseHyperbolic[u,x]*)


(* DeactivateInverseHyperbolic::usage = "DeactivateInverseHyperbolic[u,x] returns u with inverse trig and hyperbolic functions replaced with inert inverse hyperbolic functions."; *)
(* DeactivateInverseHyperbolic[u_,x_] :=
  If[AtomQ[u],
    u,
  If[Length[u]==1,
    With[{v=DeactivateInverseHyperbolic[u[[1]],x]},
    Switch[Head[u],
	  ArcSin, -I*arcsinh[I*v],
	  ArcCos, Pi/2+I*arcsinh[I*x],
	  ArcTan, -I*arctanh[I*v],
	  ArcCot, I*arccoth[I*v],
	  ArcSec, Pi/2-I*arccsch[I*v],
	  ArcCsc, I*arccsch[I*v],
	  ArcSinh, arcsinh[v],
	  ArcCosh, arccosh[v],
	  ArcTanh, arctanh[v],
	  ArcCoth, arccoth[v],
	  ArcSech, arcsech[v],
	  ArcCsch, arccsch[v],
      _, Head[u]v]],
  Map[Function[DeactivateInverseHyperbolic[#,x]],u]]] *)


(* ::Section::Closed:: *)
(*Derivative divides function*)


PiecewiseLinearQ::usage = "If the derivative of u wrt x is a constant wrt x, PiecewiseLinearQ[u,x] returns True; else it returns False.";
PiecewiseLinearQ[u_,v_,x_Symbol] :=
  PiecewiseLinearQ[u,x] && PiecewiseLinearQ[v,x]

PiecewiseLinearQ[u_,x_Symbol] :=
  LinearQ[u,x] (* && Not[MonomialQ[u,x]] *) || 
  MatchQ[u,Log[c_.*F_^(v_)] /; FreeQ[{F,c},x] && LinearQ[v,x]] || 
  MatchQ[u,F_[G_[v_]] /; LinearQ[v,x] && MemberQ[{
	{ArcTanh,Tanh},{ArcTanh,Coth},{ArcCoth,Coth},{ArcCoth,Tanh},
	{ArcTan,Tan},{ArcTan,Cot},{ArcCot,Cot},{ArcCot,Tan}
   },{F,G}]]


Divides::usage = "If u divided by y is free of x, Divides[y,u,x] returns the quotient; else it returns False.";
Divides[y_,u_,x_Symbol] :=
  With[{v=Simplify[u/y]},
  If[FreeQ[v,x],
    v,
  False]]


DerivativeDivides::usage = "If y not equal to x, y is easy to differentiate wrt x, and u divided by the derivative of y is free of x, DerivativeDivides[y,u,x] returns the quotient; else it returns False.";
DerivativeDivides[y_,u_,x_Symbol] :=
  If[MatchQ[y,a_.*x /; FreeQ[a,x]],
    False,
  If[If[PolynomialQ[y,x], PolynomialQ[u,x] && Exponent[u,x]==Exponent[y,x]-1, EasyDQ[y,x]],
    Module[{v=Block[{$ShowSteps=False}, ReplaceAll[D[y,x],Sinc[z_]->Sin[z]/z]]},
    If[EqQ[v,0],
      False,
    v=Simplify[u/v];
    If[FreeQ[v,x],
      v,
    False]]],
  False]]


EasyDQ::usage = "If u is easy to differentiate wrt x, EasyDQ[u,x] returns True; else it returns False.";
EasyDQ[u_.*x_^m_.,x_Symbol] :=
  EasyDQ[u,x] /;
FreeQ[m,x]

EasyDQ[u_,x_Symbol] :=
  If[AtomQ[u] || FreeQ[u,x] || Length[u]==0,
    True,
  If[CalculusQ[u],
    False,
  If[Length[u]==1,
    EasyDQ[u[[1]],x],
  If[BinomialQ[u,x] || ProductOfLinearPowersQ[u,x],
    True,
  If[RationalFunctionQ[u,x] && RationalFunctionExponents[u,x]==={1,1},
    True,
  If[ProductQ[u],
    If[FreeQ[First[u],x],
      EasyDQ[Rest[u],x],
    If[FreeQ[Rest[u],x],
      EasyDQ[First[u],x],
    False]],
  If[SumQ[u],
    EasyDQ[First[u],x] && EasyDQ[Rest[u],x],
  If[Length[u]==2,
    If[FreeQ[u[[1]],x],
      EasyDQ[u[[2]],x],
    If[FreeQ[u[[2]],x],
      EasyDQ[u[[1]],x],
    False]],
  False]]]]]]]]


ProductOfLinearPowersQ::usage = "ProductOfLinearPowersQ[u,x] returns True iff u is a product of factors of the form v^n where v is linear in x.";
ProductOfLinearPowersQ[u_,x_Symbol] :=
  FreeQ[u,x] ||
  MatchQ[u, v_^n_. /; LinearQ[v,x] && FreeQ[n,x]] || 
  ProductQ[u] && ProductOfLinearPowersQ[First[u],x] && ProductOfLinearPowersQ[Rest[u],x]


(* ::Section::Closed:: *)
(*Simplest nth root function*)


(* ::Subsection::Closed:: *)
(*Rt[u,n]*)


Rt::usage = "Rt[u,n] returns the simplest nth root of u.";
Rt[u_,n_Integer] :=
  RtAux[TogetherSimplify[u],n]


(* ::Subsection::Closed:: *)
(*NthRoot[u,n]*)


NthRoot[u_,n_] := u^(1/n)


(* ::Subsection::Closed:: *)
(*TrigSquare[u]*)


TrigSquare::usage = "If u is an expression of the form a-a*Sin[z]^2 or a-a*Cos[z]^2, TrigSquare[u] returns Cos[z]^2 or Sin[z]^2 respectively, else it returns False.";
TrigSquare[u_] :=
  If[SumQ[u],
    With[{lst=SplitSum[Function[SplitProduct[TrigSquareQ,#]],u]},
    If[Not[AtomQ[lst]] && EqQ[lst[[1,2]]+lst[[2]],0],
      If[Head[lst[[1,1]][[1]]]===Sin,
        lst[[2]]*Cos[lst[[1,1]][[1,1]]]^2,
      lst[[2]]*Sin[lst[[1,1]][[1,1]]]^2],
    False]],
  False]


(* ::Section::Closed:: *)
(*Simplest nth root helper functions*)


(* ::Subsection::Closed:: *)
(*RtAux[u,n]*)


RtAux[u_,n_] :=
  If[PowerQ[u],
    u[[1]]^(u[[2]]/n),
  If[ProductQ[u],
    Module[{lst},
    lst=SplitProduct[Function[GtQ[#,0]],u];
    If[ListQ[lst],
      RtAux[lst[[1]],n]*RtAux[lst[[2]],n],
    lst=SplitProduct[Function[LtQ[#,0]],u];
    If[ListQ[lst],
      If[EqQ[lst[[1]],-1],
        With[{v=lst[[2]]},
        If[PowerQ[v] && LtQ[v[[2]],0],
          1/RtAux[-v[[1]]^(-v[[2]]),n],
        If[ProductQ[v],
          If[ListQ[SplitProduct[SumBaseQ,v]],
            lst=SplitProduct[AllNegTermQ,v];
            If[ListQ[lst],
              RtAux[-lst[[1]],n]*RtAux[lst[[2]],n],
            lst=SplitProduct[NegSumBaseQ,v];
            If[ListQ[lst],
              RtAux[-lst[[1]],n]*RtAux[lst[[2]],n],
            lst=SplitProduct[SomeNegTermQ,v];
            If[ListQ[lst],
              RtAux[-lst[[1]],n]*RtAux[lst[[2]],n],
            lst=SplitProduct[SumBaseQ,v];
            RtAux[-lst[[1]],n]*RtAux[lst[[2]],n]]]],
          lst=SplitProduct[AtomBaseQ,v];
          If[ListQ[lst],
            RtAux[-lst[[1]],n]*RtAux[lst[[2]],n],
          RtAux[-First[v],n]*RtAux[Rest[v],n]]],
        If[OddQ[n],
          -RtAux[v,n],
        NthRoot[u,n]]]]],
      RtAux[-lst[[1]],n]*RtAux[-lst[[2]],n]],
    lst=SplitProduct[AllNegTermQ,u];
    If[ListQ[lst] && ListQ[SplitProduct[SumBaseQ,lst[[2]]]],
      RtAux[-lst[[1]],n]*RtAux[-lst[[2]],n],
    lst=SplitProduct[NegSumBaseQ,u];
    If[ListQ[lst] && ListQ[SplitProduct[NegSumBaseQ,lst[[2]]]],
      RtAux[-lst[[1]],n]*RtAux[-lst[[2]],n],
    Map[Function[RtAux[#,n]],u]]]]]],
  With[{v=TrigSquare[u]},
  If[Not[AtomQ[v]],
    RtAux[v,n],
  If[OddQ[n] && LtQ[u,0],
    -RtAux[-u,n],
  If[ComplexNumberQ[u],
    With[{a=Re[u],b=Im[u]},
    If[Not[IntegerQ[a] && IntegerQ[b]] && IntegerQ[a/(a^2+b^2)] && IntegerQ[b/(a^2+b^2)],
(* Basis: a+b*I==1/(a/(a^2+b^2)-b/(a^2+b^2)*I) *)
      1/RtAux[a/(a^2+b^2)-b/(a^2+b^2)*I,n],
    NthRoot[u,n]]],
  If[OddQ[n] && NegQ[u] && PosQ[-u],
    -RtAux[-u,n],
  NthRoot[u,n]]]]]]]]


(* ::Subsection::Closed:: *)
(*Factor base predicates*)


AtomBaseQ::usage = "If u is an atom or an atom raised to an odd degree, AtomBaseQ[u] returns True; else it returns False.";
AtomBaseQ[u_] :=
  AtomQ[u] || PowerQ[u] && OddQ[u[[2]]] && AtomBaseQ[u[[1]]]


SumBaseQ::usage = "If u is an sum or a sum raised to an odd degree, SumBaseQ[u] returns True; else it returns False.";
SumBaseQ[u_] :=
  SumQ[u] || PowerQ[u] && OddQ[u[[2]]] && SumBaseQ[u[[1]]]


NegSumBaseQ::usage = "If u is a sum or a sum raised to an odd degree whose lead term has a negative form, NegSumBaseQ[u] returns True; else it returns False.";
NegSumBaseQ[u_] :=
  SumQ[u] && NegQ[First[u]] || PowerQ[u] && OddQ[u[[2]]] && NegSumBaseQ[u[[1]]]


AllNegTermQ::usage = "If all terms of u have a negative form, AllNegTermQ[u] returns True; else it returns False.";
AllNegTermQ[u_] :=
  If[PowerQ[u] && OddQ[u[[2]]],
    AllNegTermQ[u[[1]]],
  If[SumQ[u],
    NegQ[First[u]] && AllNegTermQ[Rest[u]],
  NegQ[u]]]


SomeNegTermQ::usage = "If some term of u has a negative form, SomeNegTermQ[u] returns True; else it returns False.";
SomeNegTermQ[u_] :=
  If[PowerQ[u] && OddQ[u[[2]]],
    SomeNegTermQ[u[[1]]],
  If[SumQ[u],
    NegQ[First[u]] || SomeNegTermQ[Rest[u]],
  NegQ[u]]]


(* ::Subsection::Closed:: *)
(*TrigSquareQ[u]*)


TrigSquareQ::usage = "If u is an expression of the form Sin[z]^2 or Cos[z]^2, TrigSquareQ[u] returns True, else it returns False.";
TrigSquareQ[u_] :=
  PowerQ[u] && EqQ[u[[2]],2] && MemberQ[{Sin,Cos},Head[u[[1]]]]


(* ::Subsection::Closed:: *)
(*SplitProduct[func,u]*)


SplitProduct::usage = "If func[v] is True for a factor v of u, SplitProduct[func,u] returns {v, u/v} where v is the first such factor; else it returns False.";
SplitProduct[func_,u_] :=
  If[ProductQ[u],
    If[func[First[u]],
      {First[u], Rest[u]},
    With[{lst=SplitProduct[func,Rest[u]]},
    If[AtomQ[lst],
      False,
    {lst[[1]],First[u]*lst[[2]]}]]],
  If[func[u],
    {u, 1},
  False]]


(* ::Subsection::Closed:: *)
(*SplitSum[func,u]*)


SplitSum::usage = "If func[v] is nonatomic for a term v of u, SplitSum[func,u] returns {func[v], u-v} where v is the first such term; else it returns False.";
SplitSum[func_,u_] :=
  If[SumQ[u],
    If[Not[AtomQ[func[First[u]]]],
      {func[First[u]], Rest[u]},
    With[{lst=SplitSum[func,Rest[u]]},
    If[AtomQ[lst],
      False,
    {lst[[1]],First[u]+lst[[2]]}]]],
  If[Not[AtomQ[func[u]]],
    {func[u], 0},
  False]]


(* ::Section::Closed:: *)
(*IntSum*)


IntSum::usage = "If u is free of x or of the form c*(a+b*x)^m, IntSum[u,x] returns the antiderivative of u wrt x; else it returns d*Int[v,x] where d*v=u and d is free of x.";
IntSum[u_,x_Symbol] :=
  Simp[FreeTerms[u,x]*x,x] + IntTerm[NonfreeTerms[u,x],x]


IntTerm::usage = "If u is of the form c*(a+b*x)^m, IntTerm[u,x] returns the antiderivative of u wrt x; else it returns d*Int[v,x] where d*v=u and d is free of x.";
IntTerm[u_,x_Symbol] :=
  Map[Function[IntTerm[#,x]],u] /;
SumQ[u]

IntTerm[c_.*v_^m_.,x_Symbol] :=
  With[{u=Cancel[v]},
  If[EqQ[m,-1],
    Simp[c*Log[RemoveContent[u,x]]/Coeff[u,x,1],x],
  If[EqQ[m,1] && EqQ[c,1] && SumQ[u],
    IntSum[u,x],
  Simp[c*u^(m+1)/(Coeff[u,x,1]*(m+1)),x]]]] /;
FreeQ[{c,m},x] && LinearQ[v,x]

IntTerm[u_,x_Symbol] :=
  Star[FreeFactors[u,x], Int[NonfreeFactors[u,x],x]]


(* ::Section:: *)
(*Fix integration rules functions*)


(* ::Subsection::Closed:: *)
(*RuleName[name]*)


$RuleNameList={};


RuleName[name_] :=
 (AppendTo[$RuleNameList,name]; Null)


(* ::Subsection::Closed:: *)
(*FixIntRules[rulelist]*)


ClearAll[FixIntRules,FixIntRule,FixRhsIntRule]


FixIntRules[] :=
  (DownValues[Int]=FixIntRules[DownValues[Int]]; Null)


FixIntRules[rulelist_] := Block[{Int, Subst, Simp, Star},
  SetAttributes[{Int, Subst, Simp, Star},HoldAll];
  Map[Function[FixIntRule[#,#[[1,1,2,1]]]], rulelist]]


(* ::Subsection::Closed:: *)
(*FixIntRule[rule]*)


FixIntRule[rule_] :=
  If[AtomQ[rule[[1,1,-1]]],
    FixIntRule[rule,rule[[1,1,-1]]],
  If[Head[rule[[1,1,-1]]]===Pattern && AtomQ[rule[[1,1,-1,1]]],
    FixIntRule[rule,rule[[1,1,-1,1]]],
  Print["Invalid integration rule: ",rule[[1,1,-1]]]]]


(* ::Subsection::Closed:: *)
(*FixIntRule[rule,x]*)


FixIntRule[RuleDelayed[lhs_,F_[G_[list_,F_[u_+v_,test2_]],test1_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list,F[u+v,test2]],test1]],{{2,1,2,1,1}->FixRhsIntRule[u,x],{2,1,2,1,2}->FixRhsIntRule[v,x]}] /;
F===Condition && (G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,G_[list_,F_[u_+v_,test2_]]],x_] :=
  ReplacePart[RuleDelayed[lhs,G[list,F[u+v,test2]]],{{2,2,1,1}->FixRhsIntRule[u,x],{2,2,1,2}->FixRhsIntRule[v,x]}] /;
F===Condition && (G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,F_[G_[list_,u_+v_],test_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list,u+v],test]],{{2,1,2,1}->FixRhsIntRule[u,x],{2,1,2,2}->FixRhsIntRule[v,x]}] /;
F===Condition && (G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,G_[list_,u_+v_]],x_] :=
  ReplacePart[RuleDelayed[lhs,G[list,u+v]],{{2,2,1}->FixRhsIntRule[u,x],{2,2,2}->FixRhsIntRule[v,x]}] /;
(G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,F_[u_+v_,test_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[u+v,test]],{{2,1,1}->FixRhsIntRule[u,x],{2,1,2}->FixRhsIntRule[v,x]}] /;
F===Condition

FixIntRule[RuleDelayed[lhs_,u_+v_],x_] :=
  ReplacePart[RuleDelayed[lhs,u+v],{{2,1}->FixRhsIntRule[u,x],{2,2}->FixRhsIntRule[v,x]}]


FixIntRule[RuleDelayed[lhs_,F_[G_[list1_,F_[H_[list2_,u_],test2_]],test1_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list1,F[H[list2,u],test2]],test1]],{2,1,2,1,2}->FixRhsIntRule[u,x]] /;
F===Condition && (G===With || G===Module || G===Block) && (H===With || H===Module || H===Block)

FixIntRule[RuleDelayed[lhs_,F_[G_[list1_,H_[list2_,u_]],test1_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list1,H[list2,u]],test1]],{2,1,2,2}->FixRhsIntRule[u,x]] /;
F===Condition && (G===With || G===Module || G===Block) && (H===With || H===Module || H===Block)

FixIntRule[RuleDelayed[lhs_,F_[G_[list_,F_[H_[str1_,str2_,str3_,J_[u_]],test2_]],test1_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list,F[H[str1,str2,str3,J[u]],test2]],test1]],{2,1,2,1,4,1}->FixRhsIntRule[u,x]] /;
F===Condition && (G===With || G===Module || G===Block) && H===ShowStep && J===Hold

FixIntRule[RuleDelayed[lhs_,F_[G_[list_,F_[u_,test2_]],test1_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list,F[u,test2]],test1]],{2,1,2,1}->FixRhsIntRule[u,x]] /;
F===Condition && (G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,G_[list_,F_[u_,test2_]]],x_] :=
  ReplacePart[RuleDelayed[lhs,G[list,F[u,test2]]],{2,2,1}->FixRhsIntRule[u,x]] /;
F===Condition && (G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,F_[G_[list_,u_],test_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[G[list,u],test]],{2,1,2}->FixRhsIntRule[u,x]] /;
F===Condition && (G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,G_[list_,u_]],x_] :=
  ReplacePart[RuleDelayed[lhs,G[list,u]],{2,2}->FixRhsIntRule[u,x]] /;
(G===With || G===Module || G===Block)

FixIntRule[RuleDelayed[lhs_,F_[u_,test_]],x_] :=
  ReplacePart[RuleDelayed[lhs,F[u,test]],{2,1}->FixRhsIntRule[u,x]] /;
F===Condition

FixIntRule[RuleDelayed[lhs_,u_],x_] :=
  ReplacePart[RuleDelayed[lhs,u],{2}->FixRhsIntRule[u,x]]


(* ::Subsection::Closed:: *)
(*FixRhsIntRule[rhs,x]*)


SetAttributes[FixRhsIntRule,HoldAll];

FixRhsIntRule[u_+v_,x_] :=
  FixRhsIntRule[u,x]+FixRhsIntRule[v,x]

FixRhsIntRule[u_-v_,x_] :=
  FixRhsIntRule[u,x]-FixRhsIntRule[v,x]

FixRhsIntRule[-u_,x_] :=
  -FixRhsIntRule[u,x]

FixRhsIntRule[u_,x_] :=
  If[MemberQ[{Int, Unintegrable, CannotIntegrate, Subst, Simp}, Head[Unevaluated[u]]],
    u,
  Simp[u,x]]

